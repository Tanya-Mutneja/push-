'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1443:function(C,O,c){C=c(0);var l=c(16),e=c(45),a=c(5),h=c(115),m=c(149),v=c(791),u=c(216),n=c(619),x=c(2),A=c(386),H=c(23),E=c(44),L=c(243),M=c(1),F=c(1507);class J{constructor(P,S){this.iEj=P;this.Kz=S}J(P){return this.iEj.Py(P,this.Kz)}}Object(C.a)(J,"PropertyMergeStrategies",null,[]);var I=c(1566),K=c(1526);class N extends K.a{constructor(){super();this.OSc=this.eVd=this.Fn=null;this.h1d=0}get xea(){return"Property"}EAb(){this.detail.Z("Type",
this.xea);this.detail.Z("ComplexMerger",null!=this.Fn?this.Fn:-1);this.detail.Z("Strategy",null!=this.eVd?this.eVd:-1);this.detail.Z("ClassId",null!=this.OSc?this.OSc:-1);this.detail.Z("PropId",this.h1d);return this.detail}}Object(C.a)(N,"PropertyMergeFailureDetail",K.a,[]);c.d(O,"a",function(){return G});class G{constructor(P=null){this.eYg=this.Wb=null;this.YSb=P||this.RIc()}get Fn(){return 1}get Lhb(){return this.YSb}RIc(){return[Object(E.a)(this,this.Dfo,"tryPreProcessFavoredRevision"),Object(E.a)(this,
this.Ezk,"cloneObjectAndRemoveNeededProperties"),Object(E.a)(this,this.ufo,"tryMergeNodeInternal")]}get Kz(){return 5}get j1d(){return this.eYg||(this.eYg=new J(this.nk(),this.Kz))}dB(P,S){const W=P.Rg.value.Ef;m.a.instance.Sa(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",W.id,W.Qc);P.ap.logger.Tg(Object.assign(new N,{Fn:this.Fn,OSc:W.Qc,h1d:S}));return!1}G7f(P){const S=P.Rg.value;m.a.instance.Sa(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",S.Ef.id,S.Ef.Qc);for(let W=0;W<this.Lhb.length;W++)if(!(0,this.Lhb[W])(P))return m.a.instance.Sa(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",S.Ef.id,S.Ef.Qc,W),P.ap.logger.OTd("GraphNodeComplexMerge.GetMergeFunctions()",W),this.ozm(P),P.Lk=null,!1;m.a.instance.Sa(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",S.Ef.id,S.Ef.Qc);
return!0}ozm(P){P.xag||(P.xag=!0,I.a(P.Rg.value.qu,"Base",1),I.a(P.Rg.value.Ef,"Favored",1),I.a(P.an.value.Ef,"Conflict",1))}Dfo(P){const S=P.Rg.value,W=this.j1d;if(!S.XW)return!0;let X=!0;S.Qna.forEach((Y,ca)=>{if(!ca.XW||P.zg.contains(Y))return!0;ca=W.J(Y);if(5===ca){const ha=S.qu.Qc;m.a.instance.Sa(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ha,Y,ca);P.ap.logger.Tg(Object.assign(new N,
{Fn:this.Fn,OSc:ha,h1d:Y,eVd:ca}));return X=!1}6===ca&&P.GOf.add(Y);return!0});return X}Ezk(P){P.Lk=P.Rg.value.Ef.OG();const S=P.GOf,W=P.Lk;S&&S.forEach(X=>{W.removeProperty(v.a.yW(X));return!0});return!0}ufo(P){const S=P.an.value,W=S.qu.Qc,X=this.j1d;let Y=!0;S.Qna.forEach((ca,ha)=>{const ra=X.J(ca);Y=this.vfo(P,ha,ca,ra);Y||(P.Lk=null,m.a.instance.Sa(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",W,ca,ra),P.ap.logger.Tg(Object.assign(new N,{Fn:this.Fn,
OSc:W,h1d:ca,eVd:ra})));return Y});return Y}vfo(P,S,W,X){const Y=P.Lk;if(!S.XW&&8!==X||2===X||7===X||P.zg.contains(W))return!0;if(5===X)return!1;if(4===X||3===X){let ca;if(({value:ca}=P.Rg.value.Qna.Bc(W)).returnValue&&ca.XW)return 4!==X;X=0}8===X&&(X=0);if(0===X){if(!S.isDeleted)return P=v.a.yW(W),(G.wso(S,W,P)||G.OWn())&&Y.jwa(P,S.newValue),!0;X=6}return 6===X?(Y.removeProperty(v.a.yW(W)),!0):1===X?this.dB(P,W):!1}NJm(P,S,W,X,Y,ca){P=P||new u.a;S=S||new u.a;W=W||new u.a;var ha=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
P.length,S.length,W.length),ra=P.length<=S.length&&P.length<=W.length;this.Qfi()&&ra&&m.a.instance.Sa(541181455,1,1,ha);if(!ra&&this.Ydi(ca.runtime.Wb))return null;if(this.Qfi())for(ha=0;ha<P.length;ha++){ra=P.mg(ha);var sa=S.mg(ha);let oa=W.mg(ha);ra=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ra,sa,oa,ha,P.length);m.a.instance.Sa(541181457,1,1,ra)}if(this.Ydi(ca.runtime.Wb))for(ca=
0;ca<P.length;ca++)if(ha=P.mg(ca),ra=S.mg(ca),sa=W.mg(ca),!X(ha,ra)||!X(ha,sa))return null;P=P.L3();X=new n.a;ca=P.length;for(ha=ca;ha<S.length;ha++)ra=S.mg(ha),P.add(ra),X.add(ra);for(;ca<W.length;ca++)S=W.mg(ca),X.contains(S)?m.a.instance.Sa(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",S):(P.add(S),Y(S));return P}Qfi(){return!!x.AFrameworkApplication.K&&x.AFrameworkApplication.K.$("LogMPALErrors")}Ydi(P){if(!P)return!1;
P.jkf(1000008);return P.NBb(1000008)}Kmm(P){if(!P)return!1;P.jkf(1000009);return P.NBb(1000009)}ssi(P,S,W,X){return F.a(P,S,W,X)}fDa(P,S,W){P=P||new u.a;S=S||new u.a;W=W||new u.a;const X=P.iG(),Y=S.iG(),ca=W.iG();P=G.filter(P,ha=>Y.contains(ha)&&ca.contains(ha));P.iG();P.IA(P.length,G.filter(S,ha=>!X.contains(ha)));P.IA(P.length,G.filter(W,ha=>!X.contains(ha)&&!Y.contains(ha)));return P}GJm(P,S){const W=v.a.yW(S),X=P.$d;var Y=X.getPropertyObjectIds(P.Rg.value.qu,W),ca=X.getPropertyObjectIds(P.Rg.value.Ef,
W);const ha=X.getPropertyObjectIds(P.an.value.Ef,W);Y=this.fDa(Y,ca,ha);ca=P.Lk;0<Y.length?X.setPropertyObjectIds(ca,W,Y):ca.removeProperty(W);P.zg.add(S)}Cbb(P,S,W){P.hasProperty(W)?S.jwa(W,P.dQ(W)):S.removeProperty(W)}vwn(P,S){var W=S.Nj();for(const X of W)S.removeProperty(X);W=P.Nj();for(const X of W)S.jwa(X,P.dQ(X))}wvf(P,S,W,X,Y){S=P.getPropertyInt32(S,Y);W=P.getPropertyInt32(W,Y);W=null!=S&&null!=W?Math.max(S,W):null!=W?W:null!=S?S:null;null!=W?P.setPropertyInt32(X,Y,W):X.removeProperty(Y)}RWe(P,
S,W,X,Y,ca){S=P(S,Y);W=P(W,Y);P=P(X,Y);X=S.iG();let ha=!1;ca&&(ha=ca(S,W,P));ha?(ca=!0,X=!1):(ca=X.Vrh(W),X=X.Vrh(P));m.a.instance.Sa(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",v.a.yb(Y),S.Fq(),W.Fq(),P.Fq(),ca,X);return{YBc:P,v_a:ca,q_a:X}}zvk(P,S,W,X,Y){let ca;S=P(S,Y);W=P(W,Y);P=P(X,Y);X=this.Sii(S,W);ca=this.Sii(S,P);m.a.instance.Sa(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
v.a.yb(Y),S.Fq(),W.Fq(),P.Fq(),X,ca);return{YBc:P,v_a:X,q_a:ca}}Sii(P,S){if(!P&&!S)return!0;if(!P||!S)return!1;if(!P.count&&!S.count)return!0;let W=!1;S.forEach((X,Y)=>W=P.ub(X)&&Y==P.J(X));return W}nk(){let P;P=this.Kmm(this.Wb)?G.yMj.value:G.xMj.value;const S=new A.a(0);for(let W=0;W<P.length;W++)S.Z(P[W],7);return S}static dea(){return new G}static get instance(){return G._instance.value}static OWn(){return H.a.instance.Pa("Box4.IFeatureHelper").isFeatureEnabled(80)}static wso(P,S,W){if(void 0!==
P.newValue&&null!==P.newValue||M.a.xgi(W.type))return!0;G.CAm(P,S,W);return!1}static CAm(P,S,W){W=W.type===M.a.string;S=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",S);W||(S+=String.format(" [NewValue: {0}] [OldValue: {1}]",P.newValue,P.oldValue));m.a.instance.Sa(19145822,1,2,S)}static sAf(P,S,W){const X=v.a.yb(W),Y=P.$d;var ca=Y.getPropertyObjectIds(P.Rg.value.qu,W);const ha=Y.getPropertyObjectIds(P.Rg.value.Ef,W);var ra=Y.getPropertyObjectIds(P.an.value.Ef,W);ra=G.uQl(ra,
P.ap.runtime.ufc);S=S.fDa(ca,ha,ra);ca=P.Lk;0<S.length?Y.setPropertyObjectIds(ca,W,S):ca.removeProperty(W);P.zg.add(X);return!0}static uQl(P,S){const W=new u.a;P.forEach(X=>{S.contains(X,(Y,ca)=>Y.equals(ca))||W.add(X);return!0});return W}static filter(P,S){const W=new u.a;P.forEach(X=>{S(X)&&W.add(X);return!0});return W}static Jwl(){return[v.a.yb(l.a.n7e),v.a.yb(l.a.lastModifiedTime),v.a.yb(l.a.yK),v.a.yb(l.a.xJb),v.a.yb(l.a.JVf),v.a.yb(e.a.MSc),v.a.yb(a.a.lwd),v.a.yb(a.a.qcb),v.a.yb(h.a.IVi)]}static Kwl(){return[v.a.yb(l.a.n7e),
v.a.yb(l.a.lastModifiedTime),v.a.yb(l.a.yK),v.a.yb(l.a.xJb),v.a.yb(l.a.JVf),v.a.yb(e.a.MSc),v.a.yb(a.a.lwd),v.a.yb(h.a.IVi)]}}G._instance=new L.a(G.dea);G.xMj=new L.a(G.Jwl);G.yMj=new L.a(G.Kwl);Object(C.a)(G,"GraphNodeComplexMerge",null,[1889])},1444:function(C,O,c){c.r(O);C=c(0);var l=c(123),e=c(1463),a=c(1450),h=c(1570),m=c(1571);class v{constructor(n,x){this.f8a=!1;this.Pfa=null;if(!n)throw Error.argumentNull("annotations");if(!n.p8b(x))throw Error.argument("structTypeID","Invalid struct type ID");
this.Sv=n;this.x9b=this.Sv.xWh(x);this.aYj=x}get NXb(){return this.Sv}get isReadOnly(){return this.f8a}get pQa(){return this.aYj}Vdb(n){if(0>n||n>=this.x9b)throw Error.argument("iField","Invalid field index");return this.Pfa&&null!=this.Pfa[n]?this.Pfa[n]:this.Sv.$_h(this.pQa,n)}CYf(n,x){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>n||n>=this.x9b)throw Error.argument("iField","Invalid field index");if(!this.Sv.g7b(this.Sv.wBb(this.pQa,
n),x))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Pfa||(this.Pfa=Array(this.x9b)))[n]=x}Zba(){const {Annotations:n}=c(1444);let x="[";if(this.Pfa){let A=!0;for(let H=0;H<this.x9b;++H){if(null==this.Pfa[H])continue;const E=this.Sv.wBb(this.pQa,H);if(n.Nmb(E,this.Pfa[H],this.Sv.$_h(this.pQa,H)))continue;A?A=!1:x+=", ";x+=this.Sv.a0h(this.pQa,H);x+="=";const L=this.Sv.Zba(E,this.Pfa[H]);E===n.h8?(x+='"',x+=e.a.h8e(L),x+='"'):x+=L}}return x+"]"}isEqual(n){const {Annotations:x}=
c(1444);if(this===n)return!0;if(!n||this.Sv!==n.NXb||this.pQa!==n.pQa)return!1;for(let A=0;A<this.x9b;++A)if(!x.Nmb(this.Sv.wBb(this.pQa,A),this.Vdb(A),n.Vdb(A)))return!1;return!0}clone(){const n=new v(this.Sv,this.pQa);this.Pfa&&(n.Pfa=Array.clone(this.Pfa));return n}CS(){return this.isReadOnly?this.clone():this}Ixf(){const {Annotations:n}=c(1444);if(!this.isReadOnly&&(this.f8a=!0,this.Pfa))for(let x=0;x<this.x9b;++x){const A=this.Pfa[x];null!=A&&n.uFb(A)}}toString(){return this.Zba()}}Object(C.a)(v,
"StructValue",null,[1264,1262]);c.d(O,"Annotations",function(){return u});class u{constructor(n,x){if(!n)throw Error.argumentNull("initData");if(!x)throw Error.argumentNull("objectFetcher");this.pFm=x.L0k;let A=0;var H=x.Hdb(n.J(A));++A;this.mzf=new h.a(new m.a(H));this.fEj=n.J(A);++A;this.Ypi=Array(this.qBd);this.zRc=Array(this.qBd);this.Ehb=Array(this.qBd);for(H=0;H<this.qBd;++H){this.Ypi[H]=x.nE(n.J(A));++A;this.zRc[H]=n.J(A);++A;var E=n.J(A);++A;this.Ehb[H]=Array(E);for(var L=0;L<E;++L)this.Ehb[H][L]=
x.nE(n.J(A)),++A}this.$Xj=n.J(A);++A;this.Dqi=Array(this.w1c);this.wUd=Array(this.w1c);this.xUd=Array(this.w1c);this.vUd=Array(this.w1c);for(H=0;H<this.w1c;++H)for(this.Dqi[H]=x.nE(n.J(A)),++A,E=n.J(A),++A,this.wUd[H]=Array(E),this.xUd[H]=Array(E),this.vUd[H]=Array(E),L=0;L<E;++L)this.wUd[H][L]=x.nE(n.J(A)),++A,this.xUd[H][L]=n.J(A),++A,this.vUd[H][L]=({ffa:A}=this.MKa(this.xUd[H][L],n,A,null,null,null)).returnValue,u.uFb(this.vUd[H][L]);this.Zxj=n.J(A);++A;this.Ryf=Array(this.lYb);this.Syf=Array(this.lYb);
this.Qyf=Array(this.lYb);for(H=0;H<this.lYb;++H)this.Ryf[H]=x.nE(n.J(A)),++A,this.Syf[H]=n.J(A),++A,this.Qyf[H]=({ffa:A}=this.MKa(this.Syf[H],n,A,null,null,null)).returnValue,u.uFb(this.Qyf[H])}vHc(n){for(let x=0;x<this.lYb;++x)if(this.Ryf[x]===n)return x;return-1}KNh(n){if(!this.m8b(n))throw Error.argument("attrID","Invalid attribute ID");return this.Ryf[n]}getAttributeType(n){if(!this.m8b(n))throw Error.argument("attrID","Invalid attribute ID");return this.Syf[n]}wBb(n,x){if(!this.p8b(n))throw Error.argument("structTypeID",
"Invalid struct type ID");n=this.xUd[u.x1c(n)];if(0>x||x>=n.length)throw Error.argument("iField","Invalid field index");return n[x]}Zba(n,x){if(!this.Vuf(n))throw Error.argument("typeID","Invalid type ID");if(!this.g7b(n,x))throw Error.argument("value","Value is not of the correct type");switch(n){case u.h8:return x;case u.Fwa:return x?"True":"False";case u.wFa:case u.Roa:return x.toString();case u.HU:return x.Zba();default:if(!u.xH(n)&&u.r3c(n)){n=u.Z7e(n);const E=this.Ehb[n].length;switch(this.zRc[n]){case 0:return this.Ehb[n][x];
case 1:if(x){var A="";for(var H=1;H<E;++H)x&1<<H-1&&(0<A.length&&(A+=" & "),A+=this.Ehb[n][H]);return A}return this.Ehb[n][0];case 2:A="";for(H=0;H<E;++H)x&1<<H&&(0<A.length&&(A+=" & "),A+=this.Ehb[n][H]);return A;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.zRc[n]);}}else return x.Zba()}}Vuf(n){switch(n){case u.h8:case u.Fwa:case u.wFa:case u.Roa:case u.HU:return!0;default:return u.xH(n)?this.Vuf(u.QYa(n)):u.r3c(n)?this.Wom(n):this.p8b(n)}}Wom(n){n=u.Z7e(n);return 0<=
n&&n<this.Ypi.length}p8b(n){n=u.x1c(n);return 0<=n&&n<this.Dqi.length}m8b(n){return 0<=n&&n<this.lYb}g7b(n,x){if(null==x)return!1;switch(n){case u.h8:return"string"===typeof x;case u.Fwa:return"boolean"===typeof x;case u.wFa:return"number"===typeof x;case u.Roa:return"number"===typeof x;case u.HU:return Object(l.a)(1261,x);default:if(u.xH(n))return Object(l.a)(1263,x)&&x.b3===u.QYa(n);if(u.r3c(n)){if("number"!==typeof x)return!1;n=u.Z7e(n);const A=this.Ehb[n].length;switch(this.zRc[n]){case 0:return 0<=
x&&x<A;case 1:return!(x&-1<<A-1);case 2:return!!x&&!(x&-1<<A);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.zRc[n]);}}else return Object(l.a)(1264,x)&&x.pQa===n}}get lYb(){return this.Zxj}get qBd(){return this.fEj}get w1c(){return this.$Xj}rkl(n){if(!this.m8b(n))throw Error.argument("attrID","Invalid attribute ID");return this.Qyf[n]}xWh(n){if(!this.p8b(n))throw Error.argument("structTypeID","Invalid struct type ID");return this.wUd[u.x1c(n)].length}a0h(n,x){if(!this.p8b(n))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.wUd[u.x1c(n)][x]}$_h(n,x){if(!this.p8b(n))throw Error.argument("structTypeID","Invalid struct type ID");n=this.vUd[u.x1c(n)];if(0>x||x>=n.length)throw Error.argument("iField","Invalid field index");return n[x]}MKa(n,x,A,H,E,L){if(!x)throw Error.argumentNull("initData");if(u.xH(n)){var M=x.J(A);++A;n=u.QYa(n);var F=new a.a(this,n);for(var J=0;J<M;++J)Array.add(F.items,({ffa:A}=this.MKa(n,x,A,H,E,L)).returnValue);return{returnValue:F,ffa:A}}switch(n){case u.h8:return{returnValue:(H||
this.mzf).nE(x.J(A++)),ffa:A};case u.Fwa:return{returnValue:1===x.J(A++),ffa:A};case u.wFa:return{returnValue:x.J(A++),ffa:A};case u.Roa:return{returnValue:(E||this.pFm)[x.J(A++)],ffa:A};case u.HU:n=x.J(A++);M=new e.a(this);for(F=0;F<n;++F)J=x.J(A),++A,L&&(J=L[J]),M.jy(J,({ffa:A}=this.MKa(this.getAttributeType(J),x,A,H,E,L)).returnValue);return{returnValue:M,ffa:A};default:if(u.r3c(n))return{returnValue:x.J(A++),ffa:A};if(u.fgj(n)){M=x.J(A++);F=new v(this,n);for(J=0;J<M;++J){const I=x.J(A);++A;F.CYf(I,
({ffa:A}=this.MKa(this.wBb(n,I),x,A,H,E,L)).returnValue)}return{returnValue:F,ffa:A}}throw Error.argument("typeID","Invalid type ID");}}static r3c(n){return 16<=(n&16383)&&16384!==(n&16384)&&32768!==(n&32768)}static fgj(n){return 16<=(n&16383)&&16384===(n&16384)&&32768!==(n&32768)}static xH(n){return 32768===(n&32768)}static Yzl(n){if(u.xH(n))throw Error.argument("nonListTypeID","Non-list type ID required");return n|32768}static QYa(n){if(!u.xH(n))throw Error.argument("listTypeID","List type ID required");
return n&-32769}static Nmb(n,x,A){switch(n){case u.h8:case u.Fwa:case u.wFa:case u.Roa:return x===A;case u.HU:return x.isEqual(A);default:return u.xH(n)?x.isEqual(A):u.r3c(n)?x===A:x.isEqual(A)}}static uFb(n){Object(l.a)(1262,n)&&n.Ixf()}static CS(n){return Object(l.a)(1262,n)?n.CS():n}static Z7e(n){return n-16}static x1c(n){return(n&-16385)-16}}u.h8=1;u.Fwa=2;u.wFa=3;u.Roa=5;u.HU=9;Object(C.a)(u,"Annotations",null,[1265])},1447:function(C,O,c){C=c(0);var l=c(282);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(C.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(C.a)(a,"InsightsParameters",null,[]);var h=c(1648),m=c(1649),v=c(1650),u=c(1651),n=c(2),x=c(1492),A=c(1503),H=c(36),E=c(15),L=c(17),M=c(28);c.d(O,"a",function(){return F});class F{static get Tof(){return"Insights_16x16x32"}static get mal(){return"Find_16x16x32"}static get JEi(){return"-Parameterized"}static get T1f(){return"Parameterized"}static get jce(){return"bTryQuery"}static get N7f(){return"TellMeSuggestion_"}static get Gfj(){return"bTryQueryAlternate"}static get p5f(){return"MenuTellMe"}static get m6m(){const J=
{},I=[];Array.add(I,{Term:{PeopleType:"Person"}});J.And=I;return J}static E1e(J){return J+F.JEi}static getParameter(J){let I="",K="";if(J)for(let N=0;N<J.lIh;++N)"Type"===J.tef(N)?I=J.getValue(N):"Value"===J.tef(N)&&(K=J.getValue(N));return new l.a(I,K)}static Zxb(J){J=Object.assign(new a,{neighborhood:J,mentionStart:0,mentionLength:J.length});return H.c(J)}static Ewh(J,I,K){J=Object.assign(new e,{displayName:J,email:I,userId:K});return H.c(J)}static bXa(J,I,K=null){J=Object.assign(new A.a,{neighborhood:J,
mentionStart:0,mentionLength:J?J.length:0});I=Object.assign(new x.a,{selection:J,userIntent:null,entryPoint:I,launchData:K});return H.c(I)}static KAn(J,I){return F.bXa(J,F.LAn(I))}static LAn(J){switch(J){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static zei(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static jEb(){const J=n.AFrameworkApplication.K?
n.AFrameworkApplication.K.lb("SovereignEnvironmentName"):null;return!!J&&0<J.length}static isEnterpriseUser(){const J=n.AFrameworkApplication.K?n.AFrameworkApplication.K.lb("HostAuthType"):null;return!!J&&"aad"===J.toLowerCase()||"external"===J&&F.zqf()}static R_f(J){return J.Y9n&&!F.jEb()}static lii(){const J=n.AFrameworkApplication.K?n.AFrameworkApplication.K.lb("UiHostIntegrationType"):"";return!!n.AFrameworkApplication.K&&"UnifiedUiHostTeams"===J&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Q_f(J){return J.BQa&&J.w9k&&(J.e2c||J.c2c||J.Sgb)&&!F.lii()&&F.isEnterpriseUser()&&!F.jEb()}static OCa(){return n.AFrameworkApplication.K?n.AFrameworkApplication.z3a||n.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):n.AFrameworkApplication.z3a}static YW(J){return!J||F.Oii(J.Ig)}static Oii(J){return!J||!J.trim().length}static q7f(J){if(!J)return 0;const I=Math.pow(10,5);return Math.round(J*I)/I}static cbo(){var J=new Date;return J?new Date(J.getUTCFullYear(),J.getUTCMonth(),J.getUTCDate(),
J.getUTCHours(),J.getUTCMinutes(),J.getUTCSeconds(),J.getUTCMilliseconds()):null}static jjf(J){J=new Date(J);return(F.cbo().getTime()-J.getTime())/1E3}static wji(J){const {InsightsMenuItemFactory:I}=c(1647);switch(J){case h.a.Flf:case m.a.TJh:case I.M$h:case v.a.mvi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return J.startsWith(F.jce)||
J.startsWith(F.N7f)||J.startsWith(F.Gfj)||J.startsWith("PeopleSuggestion")||J.startsWith("FileSuggestion")||J.startsWith("FindInDocumentSuggestion")||J.startsWith("NotesSuggestion")||J.startsWith("OnenoteNotesSuggestion")||J.startsWith("SmartLookupFromTellMe")||J.startsWith("GetHelpFromTellMe")||J.startsWith("GetHelpWithDescriptionFromTellMe")||J.startsWith("AddinSuggestion")||J.startsWith("OfficeScripts")?!0:!1}static Mef(J,I){const K=[];Array.add(K,new u.a(400,J));Array.add(K,new u.a(200,I));J=
{};J.parts=K;return JSON.stringify(J)}static Fdb(J){const I=J.indexOf("<b0>"),K=J.lastIndexOf("</b0>"),N=[];Array.add(N,new u.a(400,J.substring(0,I)));Array.add(N,new u.a(600,J.substring(I+4,K)));Array.add(N,new u.a(400,J.substring(K+5,J.length)));J={};J.parts=N;return JSON.stringify(J)}static x1h(J){const I=F.jjf(J);return 60>I?CommonUIStrings.l_TimeSince_SecsAgo:3600>I?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(I/60).toString()):86400>I?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(I/3600).toString()):172800>I?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(J)).localeFormat("MMMM dd, yyyy"))}static Inl(J){const I=Array(J.length);for(let K=0;K<J.length;K++)I[K]=J[K].commandId;return I}static zqf(){if("Dev Box"===n.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse"))return!0;let J=n.AFrameworkApplication.K.lb("UserPrincipalName");J=M.c(J)?"":L.a.mh(J);const I=n.AFrameworkApplication.K.Hv("TellMeIntEnabledForFeatureCrew")?
n.AFrameworkApplication.K.NB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(I,J)&&"inner"===n.AFrameworkApplication.K.lb("Microsoft365Ring")}static Fwl(J){switch(J.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static maa(){return E.a.L2&&!E.a.yp}}F.ybe=9E5;Object(C.a)(F,"TellMeUtils",null,[])},1449:function(C,O,c){c.r(O);C=c(0);var l=c(44),e=c(123),a=c(64),h=c(1582),m=c(222);class v{constructor(tb,Kb,Ib,Wa,vc,Lc){this.groupType=tb;this.resultType=
Kb;this.E3f=Ib;this.z6=Wa;this.k5e=vc;this.resultIndex=Lc}}Object(C.a)(v,"ClickLoggingInfo",null,[]);const u=tb=>{const Kb=[];for(;tb;)Array.add(Kb,"{ContextId:"+tb.contextId+", IsGraphNodeContext:"+tb.Xk+"}"),tb=tb.rk;Kb.reverse();return"{"+Kb.join(", ")+"}"};class n{constructor(){this.kma=this.sessionId=null}}Object(C.a)(n,"CorrelationRecord",null,[1148]);var x=c(1470);class A{constructor(tb,Kb){this.Id=null;this.TimeStamp=0;this.Id=tb;this.TimeStamp=Kb}}Object(C.a)(A,"MRUControl",null,[]);var H=
c(1572),E=c(1568),L=c(1447),M=c(2),F=c(1336);class J{constructor(tb,Kb){this.MNj=10;this.g5=[];this.sya=[];this.LMg=this.KMg=!1;this.isc=this.hsc="";this.VSb=Kb;this.qc=tb;this.CNg=tb.hq}UHc(){!this.KMg&&this.CNg&&this.qc&&E.a.Vfi()&&(this.hsc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.qc.application,this.g5=this.zOh(),this.KMg=!0);return this.g5}qHl(){!this.LMg&&this.CNg&&this.qc&&E.a.Vfi()&&(this.isc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.qc.application,this.sya=this.zOh(!0),this.LMg=!0);
return this.sya}Wnm(tb){return tb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===tb||"TryOfficeUpsell"===tb}fqf(tb){return this.uam(tb)||this.Wnm(tb)||L.a.wji(tb)?!1:!0}rza(tb){tb=tb.ControlId;this.fqf(tb)&&(tb=this.gTf(tb),this.Fsn(tb),this.gGm(),Array.insert(this.g5,0,new A(tb,Date.now())),this.hsc.length&&(tb=JSON.stringify(this.g5),F.a.instance.setItem(this.hsc,tb)))}YH(tb){this.fGm();Array.insert(this.sya,0,new A(H.a[tb],Date.now()));this.isc.length&&(tb=JSON.stringify(this.sya),F.a.instance.setItem(this.isc,
tb))}zOh(tb=!1){if(!this.g5.length){var Kb=tb?F.a.instance.getItem(this.isc):F.a.instance.getItem(this.hsc);if(!Kb||""===Kb)return tb?this.sya:this.g5;let Ib=null;try{Ib=JSON.parse(Kb)}catch(Wa){this.Kxk(tb),Ib=null}if(!Ib||!Ib.length||10<Ib.length)return tb?this.sya:this.g5;Kb=0;for(const Wa of Ib)if(tb||this.qc.jRd(Wa.Id)&&this.fqf(Wa.Id))if(tb?Array.insert(this.sya,Kb++,Wa):Array.insert(this.g5,Kb++,Wa),Kb===this.VSb)break}return tb?this.sya:this.g5}uZe(tb){tb=this.gTf(tb);for(const Kb of this.g5)if(Kb.Id===
tb)return!0;return!1}Kxk(tb=!1){F.a.instance.setItem(tb?this.isc:this.hsc,"")}Gcm(tb){tb=this.gTf(tb.ControlId);return this.fqf(tb)?this.uZe(tb):!1}Fsn(tb){if(0<this.g5.length){let Kb=0;for(const Ib of this.g5){if(Ib.Id===tb){Array.removeAt(this.g5,Kb);break}Kb++}}}gTf(tb){return"Excel"===this.qc.application&&tb.startsWith("m_excelWebRenderer_ewaCtl_")?tb.substr(26,tb.length):tb}gGm(){this.g5.length===this.VSb&&Array.removeAt(this.g5,this.g5.length-1)}fGm(){this.sya.length===this.MNj&&Array.removeAt(this.sya,
this.sya.length-1)}uam(tb){tb=tb.split("|");let Kb="";if(6<=tb.length)Kb=tb[0];else if(3<=tb.length){if("3"===tb[0])return!0;Kb=tb[1]}return Kb.startsWith("WA")}static createInstance(tb){let Kb=3;M.AFrameworkApplication.K&&(Kb=M.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3));return new J(tb,Kb)}}Object(C.a)(J,"MruControlsManager",null,[1147]);class I{constructor(tb){this.Dsb=tb}fea(tb,Kb){let Ib;return tb.cC&&(Ib=this.Dsb[tb.value])?Ib.fea(tb,Kb):(Ib=this.zPh(tb.value))?Ib.fea(Ib.CLm,
Kb):null}gFl(tb,Kb){if(tb=this.Dsb[tb])for(const Ib of Kb)if(Kb=L.a.getParameter(Ib),Kb.key===tb.$Kf)return Kb.value;return null}aPm(tb){(tb=this.zPh(tb))&&tb.YOm()}zPh(tb){const Kb=tb.indexOf(L.a.JEi);return 0<Kb?this.Dsb[tb.substring(0,Kb)]:null}}Object(C.a)(I,"ParameterizedCommandManager",null,[1146]);var K=c(1478);class N{constructor(tb,Kb){this.Ig=tb;this.zjb=Kb}}Object(C.a)(N,"TellMeQuery",null,[]);var G=c(1569);class P{constructor(tb,Kb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=tb;
this.TimeElapsedSinceClick=Kb}}Object(C.a)(P,"CommandClickedEvent",null,[]);var S=c(28);class W{constructor(tb,Kb){this.eQj=tb;this.Qqa=Kb}resultsUpdated(tb){this.eQj(S.c(tb.query)?"":tb.query.Ig,tb.Vn,tb.attributes,this.Qqa,tb.B7b)}}Object(C.a)(W,"ResultsUpdatedCallback",null,[1145]);var X=c(77);class Y{constructor(tb,Kb){this.menuModel=tb;this.LTi=Kb}}Object(C.a)(Y,"GeneratedMenuModel",null,[]);class ca{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=
null}}Object(C.a)(ca,"MenuModel",null,[]);class ha{constructor(tb,Kb,Ib){this.qc=tb;this.Dsb=Kb;this.nda=Ib}Dhl(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449);let vc=0;const Lc=new ca,Gb=[];let pc="";Lc.sections=[];let Fc=new X.a;const ob=!!this.qc&&this.qc.$_a;var Fb=!!this.qc&&this.qc.$kb||M.AFrameworkApplication.ta.Rb.$kb;for(const Jb of tb){tb=0;ob||(Fc=new X.a);const Yb=new X.a;let tc=Jb.displayName;for(const Ec of Jb.results){if(0<=Ec.value.indexOf(L.a.T1f)){if(Ec.cC){var gb=this.Dsb[Ec.value];if(gb&&
Ec.value.endsWith(L.a.T1f)){if("FindParameterized"!==Ec.value&&!Fb){const Vc=[];Vc.push(appChrome.actions.setControlLabel(Ec.value,gb.CGd(Ec)));Vc.push(appChrome.actions.setButtonCommandValueId(Ec.value,gb.Icf(Ec)));appChrome.api.dispatch(Vc)}gb=Ec.value.replace(L.a.T1f,"");Fc.remove(gb)?tb--:Yb.add(gb);Fc.add(Ec.value);tb++}}}else switch(Ec.type){case 5:Yb.contains(Ec.value)||(Fc.add(Ec.value),tb++);break;case 7:Fc.add(Ec.cC);tb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:Fc.add(Ec.value),
tb++}13===Jb.groupType&&(tc=L.a.OCa()?0<Kb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Kb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Kb));21===Jb.groupType&&(tc=CommonUIStrings.l_LearningUILiveText)}vc+=tb;""!==tc&&0<tb&&(pc+=" , "+tb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+tc+" , ");0<Fc.count&&!ob&&(tb=appChrome.api.menuSection(Fc.toArray(),Jb.displayName,null,K.a[Jb.groupType]),Gb.push(tb))}Fb=
null;0<vc&&(Fb=0<Kb.length?1!==vc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,vc,Kb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Kb):1!==vc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,vc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,ob?(Kb=appChrome.api.menuSection(Fc.toArray(),"",null,null),Gb.push(Kb)):Fb+=pc);Ib&&(this.qc.KBa?Wa.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Fb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Fb)));Lc.sections=Gb;return new Y(Lc,vc,[])}static get V6e(){return ha.hEg||(ha.hEg=new Y(Object.assign(new ca,{sections:[]}),0,[]))}}ha.hEg=null;Object(C.a)(ha,"TellMeMenuDefintionGenerator",null,[]);var ra;(function(tb){tb[tb.TellMeControlActivated=0]="TellMeControlActivated";tb[tb.TellMeQueryExecuted=1]="TellMeQueryExecuted";tb[tb.TellMeResultsRendered=2]="TellMeResultsRendered";tb[tb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(ra||
(ra={}));Object(C.b)("PerformanceMarker",ra);var sa;(function(tb){tb[tb.TellMeTimeToRender=0]="TellMeTimeToRender";tb[tb.TellMeSessionLength=1]="TellMeSessionLength";tb[tb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(sa||(sa={}));Object(C.b)("PerformanceMeasure",sa);class oa{mark(tb){window.performance.mark(ra[tb])}measure(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449);try{window.performance.measure(sa[tb],ra[Kb],ra[Ib])}catch(vc){Wa.instance.Xe.onError("TellMePerformance:Measure","error measuring "+
sa[tb])}}dyf(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449);Wa.instance.Xe.nyf(Kb,Ib,tb,this.GAl(tb))}lyk(){var tb=[0,1,2,3];for(const Kb of tb)window.performance.clearMarks(ra[Kb])}clearMeasures(tb){for(const Kb of tb)window.performance.clearMeasures(sa[Kb])}GAl(tb){let Kb=0;(tb=this.hjl(tb))&&0<tb.length&&(Kb=tb[tb.length-1].duration);return Kb}hjl(tb){return window.performance.getEntriesByName(sa[tb],"measure")}}Object(C.a)(oa,"TellMePerformance",null,[]);var ka=c(1510),ia=c(1509),La=c(36);class va{constructor(tb){this.$Yj=
tb}fHb(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449);Wa.instance.Xe.l7(Kb,ia.a.Kbc,tb.data.Df.toString(),Math.round(window.performance.now()-Ib),ia.a.Kbc,!0,ka.a.vMa);tb=La.b(tb.data.Ie);Kb=-1;tb.Index&&(Kb=tb.Index);Wa.instance.Xe.PCm(Kb,this.$Yj)}SGb(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449);Wa.instance.Xe.l7(Kb,ia.a.Kbc,tb.data.Df.toString(),Math.round(window.performance.now()-Ib),ia.a.Kbc,!1,ka.a.vMa)}wHl(tb){if(tb&&""!==tb.trim()){const Ib=window.performance.now(),Wa=M.AFrameworkApplication.obj;var Kb=
{};Kb.Text=tb;Kb.IsFileHash="false";Kb=La.c(Kb);M.AFrameworkApplication.af.Mj(Wa,2,Kb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,vc=>{this.fHb(vc,tb.length,Ib)},vc=>{this.SGb(vc,tb.length,Ib)},null,null,!1,4E3,6E3)}}}Object(C.a)(va,"TellMeQueryIndexCallback",null,[]);var Ga=c(1451);class Oa{constructor(tb,Kb,Ib){this.xml=tb;this.LTi=Kb;this.CZk=Ib}}Object(C.a)(Oa,"GeneratedMenuXml",null,[]);var Za=c(1648),ja=c(17);class ba{constructor(tb,Kb){this.Q8c=tb||{};this.NTa=Kb}get mJb(){return 5}fea(tb,
Kb=null){return this.NTa.fea(tb,Kb)||this.Amk(tb.value)}Amk(tb){return ba.NUe(tb,this.Q8c[tb]||null)}static NUe(tb,Kb=null){tb=String.format('<ClonedControl Id="{0}" ',tb);for(let vc in Kb){var Ib=vc,Wa=Kb[vc];Wa=Wa?ja.a.Ff(Wa.toString()):"";tb+=String.format('{0}="{1}" ',Ib,Wa)}return tb+"/>"}}Object(C.a)(ba,"CommandMenuItemFactory",null,[1142]);var qa=c(236);class Ma{constructor(){this.$Ej=CommonUIStrings.l_FindInDocumentText}get mJb(){return 8}fea(tb){var Kb=tb.cC;tb=ja.a.Ff(tb.value);const Ib=
ja.a.Ff(Kb);Kb=ja.a.Ff(String.format(this.$Ej,Kb));return this.Ugl(tb,Ib,Kb)}Ugl(tb,Kb,Ib){return qa.a(tb,"1540292897",Ib,L.a.mal,null,Kb,Ib,null,null)}}Object(C.a)(Ma,"FindInDocumentMenuItemFactory",null,[1142]);var Ia=c(1649),wa=c(1647),za=c(1650);class pa{get mJb(){return 7}fea(tb){const Kb=Object(a.a)(G.a,tb);return this.Mhl(ja.a.Ff(tb.value),Kb.id)}Mhl(tb,Kb){return qa.a(Kb,"1404166600",tb,null,null,tb,tb,null,null)}}Object(C.a)(pa,"TryQueryMenuItemFactory",null,[1142]);class Ba{constructor(tb){this.L4=
[];this.qc=tb}ftl(tb){for(const Kb of this.L4)if(Kb.mJb===tb)return Kb;return null}ha(tb){this.L4.push(tb)}Umn(tb){this.ha(new ba(this.qc.IGk,tb));this.ha(new za.a(this.qc.XNm));this.ha(new Za.a(this.qc.HFn,this.qc.GFn,this.qc.h$n,this.qc.FZl,this.qc.WVn));this.ha(new wa.InsightsMenuItemFactory);this.ha(new Ma);this.ha(new Ia.a);this.ha(new pa)}}Object(C.a)(Ba,"MenuItemFactoryRegistry",null,[]);var Ra=c(1452);class fb{constructor(tb,Kb){this.qc=tb;this.ORg=new Ba(this.qc);this.ORg.Umn(Kb)}Ehl(tb,
Kb){let Ib=0;const Wa=[],vc=[];for(const Gb of tb){tb=L.a.p5f;var Lc=[];for(const pc of Gb.results){const Fc=this.ORg.ftl(pc.type).fea(pc,Kb);tb=L.a.p5f;Lc.push(Fc);if(13===pc.type||14===pc.type)tb="Menu32";17===pc.type&&(tb="MenuTellMeExtended");pc.groupType=Gb.groupType;vc.push(Object(a.a)(Ra.a,pc))}Ib=Ib?Ib:Lc.length;Lc=qa.d("TellMeDropdownControls",Lc);tb=qa.h("TellMeDropdownMenuSection",Lc,tb,Gb.displayName);Wa.push(tb)}Kb=qa.i(Wa,"LookupDropdownMenu");return new Oa(Kb,Ib,vc)}static get IAd(){return fb.iEg||
(fb.iEg=new Oa(qa.i([],"LookupDropdownMenu"),0,[]))}}fb.iEg=null;Object(C.a)(fb,"TellMeXmlGenerator",null,[]);class Va{}Va.rMm="MRU";Va.test="Test";Object(C.a)(Va,"ActionType",null,[]);var ib=c(1495),Xa;(function(tb){tb[tb.Service=0]="Service";tb[tb.Local=1]="Local";tb[tb.MRU=2]="MRU";tb[tb.TestResult=3]="TestResult";tb[tb.Unknown=4]="Unknown"})(Xa||(Xa={}));Object(C.b)("SubResultType",Xa);var qb=c(78);class rb{constructor(tb,Kb,Ib,Wa,vc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=tb;this.IsEnabled=Kb;this.ResultType=H.a[Ib];this.SubResultType=Xa[Wa];this.OptionalData=vc?qb.a.toJSON(vc):null}}Object(C.a)(rb,"ResultInfo",null,[]);var nb=c(99),Tb=c(139),Zb=c(247);class Hb{constructor(tb,Kb=null){this.cdd="TellMeWAC.";this.JRj=tb;this.YZj=Kb}yEa(tb,Kb,Ib){Kb=nb.a.WJ(Kb);tb=nb.a.z1e(tb,this.JRj,this.YZj,Ib,Kb);Tb.a.yEa(tb,this.cdd)}xEa(tb,Kb,Ib=0){Kb=nb.a.WJ(Kb);Tb.a.xEa(Object.assign(new Zb.a,{name:tb,dataFields:Kb,durationMs:Ib}),
this.cdd)}}Object(C.a)(Hb,"TellMeOtelLogger",null,[1167]);var Sa=c(121);class ua{constructor(tb,Kb,Ib,Wa,vc,Lc,Gb){this.i5=this.s9=this.Rzg=null;this.Nnb=tb;this.oPb=Kb;this.KIa=Ib;this.e8a=Wa;this.fTa=vc;this.DLj=Lc;this.i5=Gb?Gb:new Hb(this.e8a?m.CuiHelper.S1f:m.CuiHelper.Lae)}get hq(){return this.e8a}get Vna(){return this.KIa}A7d(tb){this.Rzg=tb;switch(tb){case Ga.a.contextMenu:this.s9=Ga.a.contextMenu;break;default:this.s9=Ga.a.tellMe}}pjk(tb,Kb){this.KIa.kma||(this.KIa.kma=Sa.a.create().toString(),
this.yni(tb,!0,Kb))}TEh(tb,Kb=!0){this.KIa.kma&&this.bzm(tb,Kb);this.e8a&&appChrome.api.updateTellMeCorrelationId("");this.KIa.kma=null}yni(tb,Kb,Ib){const {TellMeActor:Wa}=c(1449),vc=this.c6(x.a.h_a);vc[ib.a.culture]=this.oPb;vc[ib.a.appName]=this.Nnb;vc[ib.a.context]=tb;vc[ib.a.zQd]=this.fTa;vc[ib.a.Snm]=this.DLj;vc[ib.a.Dmm]=Ib;vc[ib.a.Wgm]=Kb;vc[ib.a.contentType]=Wa.instance.tyd;this.i5.yEa(x.a.h_a,vc,this.Rzg);this.e8a&&appChrome.api.updateTellMeCorrelationId(this.KIa.kma)}bzm(tb,Kb){const Ib=
this.c6(x.a.cDb);Ib[ib.a.n1k]=tb;Ib[ib.a.Vgm]=Kb;this.i5.xEa(x.a.cDb,Ib)}OCm(tb,Kb,Ib){let Wa=0;!Ib&&0<tb.length&&(Wa=tb.trim().split(" ").length);const vc=this.c6(x.a.query);vc[ib.a.query]="!";vc[ib.a.pIb]=Kb;vc[ib.a.RJi]=tb.length;vc[ib.a.yki]=Ib;vc[ib.a.Jxo]=Wa;this.i5.yEa(x.a.query,vc,this.s9)}JAm(tb,Kb,Ib,Wa,vc,Lc,Gb,pc=null){const Fc=this.c6(x.a.latency);Fc[ib.a.culture]=this.oPb;Fc[ib.a.RJi]=tb;Fc[ib.a.jgj]=Kb;Fc[ib.a.statusCode]=Ib;Fc[ib.a.service]=vc;Fc[ib.a.isSuccess]=Lc;Fc[ib.a.Yrm]=Gb;
pc&&(Fc[ib.a.Abo]=pc);this.i5.xEa(x.a.latency,Fc,Wa)}nyf(tb,Kb,Ib,Wa){const vc=this.c6(x.a.performance);vc[ib.a.culture]=this.oPb;vc[ib.a.tjk]=ra[tb];vc[ib.a.A3k]=ra[Kb];vc[ib.a.D6m]=sa[Ib];this.i5.xEa(x.a.performance,vc,Wa)}ZCm(tb,Kb){var {TellMeActor:Ib}=c(1449);const {CommandResultsUtility:Wa}=c(1485);if(tb.results.length){var vc=this.c6(x.a.vRi);vc[ib.a.z6]=Kb.toString();vc[ib.a.groupType]=K.a[tb.groupType];16===tb.groupType&&(vc[ib.a.fmm]=Ib.instance.u4c);Kb=[];Ib=[];var Lc=[];for(const Gb of tb.results)vc[ib.a.resultType]||
(vc[ib.a.resultType]=H.a[Gb.type]),tb={},25===Gb.type&&(tb.AssetId=Gb.ZH),Ib.push(Wa.tNc(Gb.value)),Kb.push(Gb.value),Lc.push(new rb(Gb.value,Wa.tNc(Gb.value),Gb.type,Gb.A$i,tb));0<Kb.length&&(vc[ib.a.NAn]="{"+Kb.join(", ")+"}",vc[ib.a.f3k]="{"+Ib.join(", ")+"}",vc[ib.a.IAn]=La.c(Lc));this.i5.yEa(x.a.vRi,vc,this.s9)}}oil(tb,Kb){if(4===tb)return Va.rMm;switch(Kb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return H.a[Kb]}zym(tb,
Kb,Ib,Wa,vc){const Lc=this.c6(x.a.click);Lc[ib.a.jgj]=tb;Lc[ib.a.F4m]=Kb;Lc[ib.a.commandId]=Ib;Lc[ib.a.Qda]=Wa;Lc[ib.a.actionType]=this.oil(vc.groupType,vc.resultType);Lc[ib.a.resultType]=H.a[vc.resultType];Lc[ib.a.E3f]=Xa[vc.E3f];Lc[ib.a.groupType]=K.a[vc.groupType];Lc[ib.a.z6]=vc.z6.toString();Lc[ib.a.k5e]=vc.k5e.toString();Lc[ib.a.resultIndex]=vc.resultIndex.toString();this.i5.yEa(x.a.click,Lc,this.s9)}Fym(tb,Kb){this.KIa.kma||(this.KIa.kma=Sa.a.create().toString(),this.yni("",!1,Kb));Kb=this.c6(x.a.Hsh);
Kb[ib.a.pIb]=tb;this.i5.xEa(x.a.Hsh,Kb)}Tni(tb,Kb,Ib){if(tb){if(Ib)for(let Wa in Ib)tb[Wa]=Ib[Wa];this.i5.xEa(x.a.events,tb,Kb)}}Faa(tb,Kb,Ib=null){const Wa=this.c6(x.a.events);Wa[ib.a.event]=tb;this.Tni(Wa,Math.round(Kb),Ib)}B0a(tb,Kb,Ib=null){const Wa=this.c6(x.a.events);Wa[ib.a.event]=x.a.error;Wa[ib.a.module]=tb;Wa[ib.a.errorMessage]=Kb;Wa[ib.a.message]=Kb;this.Tni(Wa,Math.round(window.performance.now()),Ib)}xym(tb){const Kb=this.c6(x.a.Qph);Kb[ib.a.value]=tb;Kb[ib.a.b3d]=this.e8a;this.i5.yEa(x.a.Qph,
Kb,this.s9)}Rxm(tb){const Kb=this.c6(x.a.Z7g);Kb[ib.a.value]=tb;Kb[ib.a.b3d]=this.e8a;this.i5.yEa(x.a.Z7g,Kb,this.s9)}Bzm(tb){const Kb=this.c6(x.a.HIh);Kb[ib.a.value]=tb;Kb[ib.a.b3d]=this.e8a;this.i5.yEa(x.a.HIh,Kb,this.s9)}MCm(tb){const Kb=this.c6(x.a.hJi);Kb[ib.a.value]=tb;Kb[ib.a.b3d]=this.e8a;this.i5.yEa(x.a.hJi,Kb,this.s9)}cym(tb){const Kb=this.c6(x.a.ZYi);Kb[ib.a.value]=tb;this.i5.yEa(x.a.ZYi,Kb,this.s9)}QCm(tb,Kb){const Ib=this.c6(x.a.MJi);Ib[ib.a.Kbc]=tb;Kb&&(Ib[ib.a.kma]=Kb);this.i5.xEa(x.a.MJi,
Ib)}c6(tb){return{["SessionID"]:this.KIa.sessionId,["CorrelationID"]:this.KIa.kma,["Time"]:(new Date).getTime(),["Event"]:tb,["Scenario"]:this.s9}}}Object(C.a)(ua,"UsageLogger",null,[1144]);var Fa=c(57),Pa=c(1604),Ea=c(1188),lb=c(80),zb=c(27),Xb=c(225),ub=c(377),Pb=c(15),yc=c(593),bc=c(62),Ka=c(13);c.d(O,"TellMeActor",function(){return Bb});class Bb{constructor(){this.NTa=this.f1=this.Ub=this.Oa=this.GO=this.uy=this.Hb=this.ga=this.Xe=this.KJ=this.qze=this.t7g=this.Sqa=this.qc=null;this.nSb=!1;this.Yke=
[];this.Nzg=[];this.DSg=[];this.ESg=[];this.ANg=!1;this.cPb=this.nda=null;this.fqc=this.fTa=!1;this.rgd=!0;this.WY=this.apc=this.THg=this.Gze=this.oSg=null;this.aY=[];this.D6a=this.HPb=this.Exa=null;this.HRb=!1;this.zze=0;this.EOb=null;this.Qqa=-1;this.QRg=0;this.mqc=!1;this.d7a=null;this.b6g=!1;this.Vt=null}get tyd(){return this.GO?this.GO.contentType:Bb.unknown}get actions(){return this.aY}set actions(tb){this.aY=tb}JId(){return this.Xe?this.Xe.Vna.kma:null}QN(){return this.qc}get hLm(){return this.rgd}get Nto(){return this.oSg}performance(){return this.KJ}get u4c(){return this.b6g}set u4c(tb){this.b6g=
tb}nG(tb){const Kb=window.performance.now();this.nda&&!S.c(tb)&&(this.nda(tb),this.Xe.Yz(x.a.nG,window.performance.now()-Kb))}initialize(tb,Kb=null,Ib=null,Wa=null,vc=null,Lc=null,Gb=null,pc=null,Fc=null,ob=null,Fb=null){const {InteractionLogger:gb}=c(1826),{GroupsPlacementInfo:Jb}=c(1822),{AggregatorResultsProvider:Yb}=c(1671);this.qc=tb;this.fTa=!!M.AFrameworkApplication.ta&&M.AFrameworkApplication.ta.Rb.Q7b;this.Xe=Wa;if(!Wa){Wa=new n;Wa.sessionId=M.AFrameworkApplication.userSessionId;const tc=
yc.a.qg(M.AFrameworkApplication.lcid)||yc.a.XMc;this.Xe=new gb(new ua(this.qc.application,tc.name,Wa,this.qc.hq,this.fTa,tb.BQa,null),this.qc.PGk,this.qc)}this.NTa=new I(this.qc.parameterData);this.t7g=Ib||new fb(this.qc,this.NTa);this.nda=Gb;this.qze=this.qze||new ha(this.qc,this.qc.parameterData,Gb);this.Ub=Fa.FocusManager.instance();this.f1=J.createInstance(this.qc);this.THg=new Jb(tb);this.ga=vc||M.AFrameworkApplication.ya;this.Hb=Lc||M.AFrameworkApplication.uc;this.uy=Fc;this.Sqa=Kb;this.Vt=
Fb;this.KJ=new oa;Fc?Fc.execute(tc=>{tc.isFeatureEnabled(Bb.X9n,!0).then(Ec=>{const {AggregatorResultsProvider:Vc}=c(1671);this.mqc=Ec;this.Sqa=this.Sqa||Vc.createInstance(this.f1,this.qc,this.NTa,this.mqc);return null})}):(this.mqc=!0,this.Sqa=this.Sqa||Yb.createInstance(this.f1,this.qc,this.NTa,this.mqc));this.Oa=pc;this.Exa=fb.IAd;this.oSg=new Promise(tc=>{this.Gze=tc});ob&&ob.execute(tc=>{this.GO=tc});this.qc.hq&&L.a.lii()&&(tb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.qc.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(tb,tb)))}Vb(){this.$6j()}kon(tb){this.apc=tb}$6j(){this.ga.gb(Ka.a.tellMe,bc.a.frame,Object(l.a)(this,this.tellMe,"tellMe"),96);this.ga.gb(Ka.a.o5f,bc.a.frame,Object(l.a)(this,this.Kjh,"cacheAsyncMenuRefreshFunction"),96);this.ga.gb(Ka.a.t5f,bc.a.frame,Object(l.a)(this,this.koi,"logItemExecuted"),96);this.ga.gb(Ka.a.w5f,bc.a.frame,Object(l.a)(this,this.Jni,"logControlDeactivation"),96);this.ga.gb(Ka.a.v5f,bc.a.frame,Object(l.a)(this,
this.foi,"logInputFocus"),96);this.ga.gb(Ka.a.r5f,bc.a.frame,Object(l.a)(this,this.h_a,"interactionBegin"),96);this.ga.gb(Ka.a.y5f,bc.a.frame,Object(l.a)(this,this.h_a,"interactionBegin"),96);this.ga.gb(Ka.a.u5f,bc.a.frame,Object(l.a)(this,this.eoi,"logInputBlur"),96);this.ga.gb(Ka.a.x5f,bc.a.frame,Object(l.a)(this,this.Ini,"logControlActivated"),96);this.ga.gb(Ka.a.d2c,bc.a.frame,Object(l.a)(this,this.LKh,"focusSearchBox"),96);this.ga.gb(Ka.a.n5f,bc.a.frame,Object(l.a)(this,this.Irh,"constructLiveNotificationForMenu"),
96);this.ga.gb(Ka.a.z5f,bc.a.frame,Object(l.a)(this,this.Qof,"insertTryQuery"),96);this.ga.gb(Ka.a.Mwf,bc.a.frame,Object(l.a)(this,this.Qof,"insertTryQuery"),96);this.ga.gb(Ka.a.p9e,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.q9e,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.r9e,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.s9e,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.t9e,
bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.HJf,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.IJf,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.JJf,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.HLf,bc.a.frame,Object(l.a)(this,this.d_a,"insertMention"),96);this.ga.gb(Ka.a.ILf,bc.a.frame,Object(l.a)(this,this.d_a,"insertMention"),96);this.ga.gb(Ka.a.JLf,bc.a.frame,Object(l.a)(this,
this.d_a,"insertMention"),96);this.ga.gb(Ka.a.q5f,bc.a.frame,Object(l.a)(this,this.JCi,"openFeedback"),96);this.ga.gb(Ka.a.A5f,bc.a.frame,Object(l.a)(this,this.wOa,"openOrInsertUrl"),96);this.ga.gb(Ka.a.gQe,bc.a.frame,Object(l.a)(this,this.VRd,"launchAddin"),96);this.ga.gb(Ka.a.hQe,bc.a.frame,Object(l.a)(this,this.VRd,"launchAddin"),96);this.ga.gb(Ka.a.iQe,bc.a.frame,Object(l.a)(this,this.VRd,"launchAddin"),96);this.ga.gb(Ka.a.eLb,bc.a.frame,Object(l.a)(this,this.eLb,"showTellMeCoachmark"),96);this.ga.gb(Ka.a.lwf,
bc.a.frame,Object(l.a)(this,this.Hli,"launchAddinStore"),96)}pmn(tb){this.rgd=!1;const Kb=window.performance.now();tb.x0a.isCompleted?(this.rgd=!0,this.Gze(!0)):tb.VV(()=>{this.rgd=!0;this.Gze(!0);this.Xe.Yz(x.a.qVk,window.performance.now()-Kb)});this.Zmn(tb)}Zmn(tb){ub.a.rXc(Object(l.a)(this,this.g5e,"dispatcher"));ub.a.sFc([new Xb.a(Ka.a.tellMe,bc.a.frame,96),new Xb.a(Ka.a.o5f,bc.a.frame,96),new Xb.a(Ka.a.t5f,bc.a.frame,96),new Xb.a(Ka.a.w5f,bc.a.frame,96),new Xb.a(Ka.a.v5f,bc.a.frame,96),new Xb.a(Ka.a.r5f,
bc.a.frame,96),new Xb.a(Ka.a.y5f,bc.a.frame,96),new Xb.a(Ka.a.u5f,bc.a.frame,96),new Xb.a(Ka.a.x5f,bc.a.frame,96),new Xb.a(Ka.a.d2c,bc.a.frame,96),new Xb.a(Ka.a.n5f,bc.a.frame,96),new Xb.a(Ka.a.z5f,bc.a.frame,96),new Xb.a(Ka.a.Mwf,bc.a.frame,96),new Xb.a(Ka.a.p9e,bc.a.frame,96),new Xb.a(Ka.a.q9e,bc.a.frame,96),new Xb.a(Ka.a.r9e,bc.a.frame,96),new Xb.a(Ka.a.s9e,bc.a.frame,96),new Xb.a(Ka.a.t9e,bc.a.frame,96),new Xb.a(Ka.a.HJf,bc.a.frame,96),new Xb.a(Ka.a.IJf,bc.a.frame,96),new Xb.a(Ka.a.JJf,bc.a.frame,
96),new Xb.a(Ka.a.HLf,bc.a.frame,96),new Xb.a(Ka.a.ILf,bc.a.frame,96),new Xb.a(Ka.a.JLf,bc.a.frame,96),new Xb.a(Ka.a.q5f,bc.a.frame,96),new Xb.a(Ka.a.A5f,bc.a.frame,96),new Xb.a(Ka.a.gQe,bc.a.frame,96),new Xb.a(Ka.a.hQe,bc.a.frame,96),new Xb.a(Ka.a.iQe,bc.a.frame,96),new Xb.a(Ka.a.eLb,bc.a.frame,96),new Xb.a(Ka.a.lwf,bc.a.frame,96)],tb)}g5e(tb,Kb,Ib,Wa,vc){if(Kb.contextId===bc.a.frame)switch(tb){case Ka.a.tellMe:return this.tellMe(tb,Kb,Ib,Wa,vc);case Ka.a.o5f:return this.Kjh(tb,Kb,Ib,Wa,vc);case Ka.a.t5f:return this.koi(tb,
Kb,Ib,Wa,vc);case Ka.a.w5f:return this.Jni(tb,Kb,Ib,Wa,vc);case Ka.a.v5f:return this.foi(tb,Kb,Ib,Wa,vc);case Ka.a.r5f:return this.h_a(tb,Kb,Ib,Wa,vc);case Ka.a.y5f:return this.tAn(Ib);case Ka.a.u5f:return this.eoi(tb,Kb,Ib,Wa,vc);case Ka.a.x5f:return this.Ini(tb,Kb,Ib,Wa,vc);case Ka.a.d2c:return this.LKh(tb,Kb,Ib,Wa,vc);case Ka.a.n5f:return this.Irh(tb,Kb,Ib,Wa,vc);case Ka.a.z5f:case Ka.a.Mwf:return this.Qof(tb,Kb,Ib,Wa,vc);case Ka.a.p9e:case Ka.a.q9e:case Ka.a.r9e:case Ka.a.s9e:case Ka.a.t9e:case Ka.a.HJf:case Ka.a.IJf:case Ka.a.JJf:case Ka.a.A5f:return this.wOa(tb,
Kb,Ib,Wa,vc);case Ka.a.HLf:case Ka.a.ILf:case Ka.a.JLf:return this.d_a(tb,Kb,Ib,Wa,vc);case Ka.a.q5f:return this.JCi(tb,Kb,Ib,Wa,vc);case Ka.a.gQe:case Ka.a.hQe:case Ka.a.iQe:return this.VRd(tb,Kb,Ib,Wa,vc);case Ka.a.eLb:return this.eLb(tb,Kb,Ib,Wa,vc);case Ka.a.lwf:return this.Hli(tb,Kb,Ib,Wa,vc)}return 2}LKh(tb,Kb,Ib){if(1===Ib)return 32;this.P1i();tb=!1;(this.qc.BQa||this.fTa)&&(Kb=document.getElementById("SearchButton"))&&Kb.click();if(!this.qc.BQa&&this.fTa)for(Kb=document.getElementsByClassName("ms-suiteux-search-box"),
Ib=0;Ib<Kb.length;Ib++){const Wa=Kb[Ib].querySelector("input[type=search]");Wa&&(tb=Fa.FocusManager.IK(Wa))}else tb=Fa.FocusManager.IK($get(this.qc.hq?m.CuiHelper.S1f:m.CuiHelper.Lae));this.fqc=!0;return tb?32:8}Qof(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.P1i();tb=vc.CommandValueId;Kb=this.qc.hq?m.CuiHelper.S1f:m.CuiHelper.Lae;this.qc.hq&&!S.c(vc[Ea.a.m3a])&&(vc[Ea.a.m3a]=!1);if(tb){if(this.qc.hq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(tb)),
this.d7a=[19],32;if(vc=$get(Kb))vc.value=tb}return Fa.FocusManager.IK($get(Kb))?32:8}P1i(){this.Ub.zK(this.qc.BQa||this.fTa?this.qc.eCb:this.qc.F2a,!1)}fil(tb,Kb){switch(tb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Kb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Kb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Kb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Kb)}return Kb}Irh(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;tb=this.Exa?this.Exa.LTi:0;vc.Value=1!==tb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,tb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.Exa)for(const Lc of this.Exa.CZk)vc=Object(e.a)(G.a,Lc)?Lc.id:ja.a.replaceAll(Lc.value,'"',""),(vc=$get(vc+"-"+L.a.p5f))&&zb.a.Jq(vc,zb.a.Eda,ja.a.Ff(this.fil(Lc.groupType,
vc.innerText)));return 32}Kjh(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.EOb=new lb.a(2,1,0,()=>{vc[Pa.a.Callback]()},97);this.Exa&&this.Hb.fc(this.EOb);return 32}koi(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;vc.CloseAllMenus&&(tb=void 0===vc.ParentControlId||null===vc.ParentControlId?"<NA>":vc.ParentControlId,
Kb=this.cPb?this.cPb[vc.ControlId]:null,!Kb&&this.cPb&&"<NA>"!==tb&&(Kb=this.cPb[tb]),Kb||(Kb=this.nSb&&this.f1.Gcm(vc),Kb=this.KWk(Kb,vc.ControlId),Kb=new v(Kb,28,4,-1,-1,-1),this.Xe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+vc.ControlId+" determined group:"+K.a[Kb.groupType])),this.Xe.GSm(vc.ControlId,tb,vc.CommandId,vc.CloseAllMenus,Kb),this.NTa.aPm(vc.ControlId),vc.Location!==Ga.a.contextMenu&&(this.f1.rza(vc),this.f1.YH(Kb.resultType),this.qc.y8d&&this.Sqa.M4j(vc.CommandId)));
return 32}Jni(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;E.a.Unm()&&(new va(this.JId())).wHl(this.HPb);tb=this.HPb;Kb=this.Qqa;Ib=this.Xe.q9c;if(S.c(vc))return this.Xe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;vc=vc.UILocation;tb&&0<tb.length&&this.mqc&&L.a.R_f(this.qc)&&this.qc.VQd&&19!==vc&&Kb>Ib&&!this.qc.uO&&(this.Xe.pyf(tb),this.Xe.qYf(Kb));this.Xe.gzn();this.qc.Jde&&19!==vc&&(this.KJ.mark(3),this.KJ.measure(1,0,3),this.KJ.measure(2,2,3),this.KJ.dyf(0,1,2),this.KJ.dyf(2,
2,3),this.KJ.dyf(1,0,3),this.KJ.lyk(),this.KJ.clearMeasures([0,2,1]));this.Xe.nTm(window.performance.now()-this.zze);this.qc.hq&&(this.D6a=null,this.Xe.fva());this.fqc=this.HRb=!1;this.HPb="";return 32}foi(tb,Kb,Ib){if(1===Ib)return 32;this.Xe.yib(u(Kb),this.fqc);return 32}eoi(tb,Kb,Ib){if(1===Ib)return 32;this.Xe.fva();this.HRb=!1;return 32}Ini(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;this.WY=null;vc&&(this.WY=vc);this.qc.Jde&&(S.c(this.WY)||this.WY.Location!==Ga.a.contextMenu)&&this.KJ.mark(0);this.Xe.A7d(S.c(this.WY)||
S.c(this.WY.Location)?Ga.a.unknown:this.WY.Location);this.Xe.mTm(this.QRg,this.fqc);this.HRb||this.m1a();return 32}Wuh(tb,Kb){const Ib=[],Wa=Date.now();for(let vc of tb)tb=(Wa-vc.timeStamp)/1E3,tb=L.a.q7f(tb),Array.add(Ib,new P(Kb?vc.commandId:vc.controlId,tb));return Ib}Dvh(tb=!1){var Kb=tb?this.f1.qHl():this.f1.UHc();tb=[];const Ib=Date.now();for(const Wa of Kb)Kb=(Ib-Wa.TimeStamp)/1E3,Kb=L.a.q7f(Kb),Array.add(tb,new P(Wa.Id,Kb));return tb}m1a(){if(!this.HRb){this.nSb=this.HRb=!0;""!==this.qc.OWf&&
M.AFrameworkApplication.Vl(this.qc.OWf);if(!this.ANg){this.ANg=!0;const tb={};tb.IsMLREnabled=this.qc.wim;tb.IsReactRibbonEnabled=this.qc.hq;tb.IsSharedHeaderEnabled=!!M.AFrameworkApplication.ta&&M.AFrameworkApplication.ta.Rb.KI;tb.IsSearchUxEnabled=this.fTa;tb.IsTellMeInHeaderEnabled=this.qc.BQa;tb.IsGoLocalEnv=L.a.zei();tb.IsSovereignEnvironment=L.a.jEb();tb.IsTellMeServiceResultsEnabled=L.a.R_f(this.qc);tb.IsSubstrateProviderEnabled=L.a.Q_f(this.qc);tb.ShouldFetchTokens=!!M.AFrameworkApplication.ta&&
M.AFrameworkApplication.ta.Rb.LKb;tb.IsSerpletEnabled=L.a.OCa();tb.FirstOnClickTimeInMS=Math.round(window.performance.now());tb.IsHeaderHidden=M.AFrameworkApplication.hideHeader||M.AFrameworkApplication.jQ;tb.IsSearchInHeaderHidden=M.AFrameworkApplication.hLc;void 0!==window.performance.timing&&null!==window.performance.timing&&(tb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));tb.IsFindWithMatchesEnabled=this.qc.KCd;tb.HelpShowsTopSearchResult=this.qc.p0c;tb.HelpShowsNumberOfMatches=
this.qc.o0c;M.AFrameworkApplication.K&&(tb.UiHost=M.AFrameworkApplication.K.lb("UiHostIntegrationType"));this.Xe.tDm(JSON.stringify(tb))}this.Yke=this.Wuh(h.a.instance.G2b(),!1);this.Nzg=this.Wuh(h.a.instance.xdb(),!0);this.DSg=this.Dvh();this.ESg=this.Dvh(!0);this.Xe.m1a()}}h_a(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Pb.a.kOc)return 32;this.zze=window.performance.now();this.m1a();tb=new W(Object(l.a)(this,
this.iva,"onRequestCompleted"),0);this.Qqa++;this.Xe.beginQuery("",this.Qqa,this.nSb);this.Exa=fb.IAd;this.D6a=ha.V6e;if(this.Sqa)Bb.instance.actions=[],this.Sqa.MI(new N("",this.Qqa),tb,this.qc.hq);else this.Xe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.EOb&&this.Hb.fc(this.EOb);return 32}tAn(tb){if(1===tb)return 32;this.Ub.RQ(this.qc.BQa||this.fTa?this.qc.eCb:this.qc.F2a,!1);return 32}tellMe(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:TellMe",
"actiondata comes null"),16;this.WY=vc;this.Xe.A7d(S.c(this.WY.Location)?Ga.a.unknown:this.WY.Location);tb=this.WY.Value;this.qc.hq||tb&&""!==tb.trim()?(!this.D6a&&this.qc.hq&&(this.Xe.yib(u(Kb),this.fqc),this.m1a()),this.R6k(tb,this.WY.Location),this.WY.PopulationXML=this.Exa.xml):this.nSb?this.WY.PopulationXML=this.Exa.xml:(this.WY.PopulationXML=fb.IAd.xml,this.D6a=ha.V6e,this.HPb="");return 32}R6k(tb,Kb){this.zze=window.performance.now();this.qc.Jde&&Kb!==Ga.a.contextMenu&&this.KJ.mark(1);this.qc.hq&&
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(tb));tb&&0<tb.trim().length&&(this.nSb=!1);this.qc.v5k();Kb=S.c(Kb)?Ga.a.tellMe:Kb;if(tb!==this.HPb||this.qc.hq){this.Qqa++;this.Xe.beginQuery(tb,this.Qqa,this.nSb);const Ib=new N(tb,this.Qqa),Wa=new W(Object(l.a)(this,this.iva,"onRequestCompleted"),this.Qqa);this.Exa=fb.IAd;this.D6a=ha.V6e;if(this.Sqa)Bb.instance.actions=[],this.Sqa.MI(Ib,Wa,this.qc.hq,Kb,this.d7a),this.d7a=null;else this.Xe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.QRg=this.Qqa;this.HPb=tb}}mmo(tb){if(this.qc.hq){var Kb=appChrome.selectors.getActiveControlStates();if(Kb=Object(a.a)(Object,Kb[tb.value])){tb.label=Kb.label;let Ib=null;"description"in Kb&&(Ib=Kb.description);Ib&&Object.getType(Ib)===String?tb.description=Ib:"secondaryText"in Kb?tb.description=Kb.secondaryText:"fullDescriptionLabel"in Kb&&(tb.description=Kb.fullDescriptionLabel)}}}e8m(tb){this.cPb={};let Kb=0,Ib=0;for(const Wa of tb){tb=0;for(const vc of Wa.results)this.cPb[vc.value]=
new v(vc.groupType,vc.type,vc.A$i,Kb,tb,Ib),tb++,Ib++,vc.label||5!==vc.type||this.mmo(vc);0<tb&&Kb++}}yac(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(tb=vc.CommandValueId)&&window.open(tb,"_blank");return 32}d_a(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:InsertMention","actiondata comes null"),16;tb=vc.UILocation;let Lc;vc=vc.CommandValueId;try{Lc=La.a(vc)}catch(Gb){return this.Xe.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return S.c(Lc)?(this.Xe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):S.c(this.apc)?(this.Xe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==tb?(this.Xe.onError("TellMeActor:InsertMention","location "+tb+" is unexpected"),16):this.apc.d_a(Lc.displayName,Lc.email,Lc.userId)?32:(this.Xe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}wOa(tb,Kb,Ib,Wa,vc){return 1===Ib?32:
S.c(vc)?(this.Xe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===vc.UILocation?this.Q8l(Ib,vc):this.yac(tb,Kb,Ib,Wa,vc)}JCi(tb,Kb,Ib,Wa,vc){if(1===Ib)return 32;if(S.c(vc))return this.Xe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Vt&&this.Vt.execute(Lc=>{Lc.iQa("TellMeSurvey",null)});return 32}Q8l(tb,Kb){if(1===tb)return 32;if(S.c(Kb))return this.Xe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(S.c(this.apc))return this.Xe.onError("TellMeActor:InsertUrl",
"_iInsertContentHandler comes null"),16;tb=Kb.CommandValueId;return S.c(tb)?(this.Xe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.apc.insertHtmlText(tb)?32:(this.Xe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}iva(tb,Kb,Ib,Wa,vc){Ib=window.performance.now();this.e8m(Kb);this.Xe.MNn(Kb);this.qc.hq?(this.D6a=this.qze.Dhl(Kb,tb,vc),this.qc.KBa?(this.aY.push(appChrome.actions.updateTellMeSearchResults(this.D6a.menuModel,tb,vc)),appChrome.api.dispatch(this.aY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.D6a.menuModel,
tb,vc)),this.qc.Jde&&this.HRb&&(S.c(this.WY)||this.WY.Location!==Ga.a.contextMenu)&&(this.KJ.mark(2),this.KJ.measure(0,1,2))):this.Exa=this.t7g.Ehl(Kb,this.Xe.Vna);this.EOb&&this.Hb.fc(this.EOb);vc={};vc.GroupsCount=Kb.length;vc.QueryID=Wa;vc.QueryLength=tb.length;this.Xe.Yz(x.a.GOk,window.performance.now()-Ib,vc)}KWk(tb,Kb){return Kb.startsWith(this.qc.hq?L.a.N7f:L.a.jce)?5:tb?4:"bSearchHelp"===Kb||Kb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Kb||Kb.startsWith("SmartLookupFromTellMe")?13:Kb===
this.qc.I9e?2:0}YH(tb,Kb){this.Sqa&&this.Sqa.YH(tb,Kb)}Hli(tb,Kb,Ib,Wa,vc){return this.ga.Xb(Ka.a.WRd,2,vc)}VRd(tb,Kb,Ib,Wa,vc){({AddinResultsProvider:tb}=c(1580));vc=vc.CommandValueId;if(S.b(vc))return this.Xe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!tb.Mvb[vc])return this.Xe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+vc+" doesn't not exist in entitlements"),16;tb=c(1580).AddinResultsProvider.Mvb[vc];Kb={};Kb.solutionId=tb.id;Kb.version=tb.appVersion;Kb.storeType=
tb.storeType;Kb.storeId=tb.storeId;Kb.assetId=tb.assetId;Kb.assetStoreId=tb.assetStoreId;Kb.displayName=tb.displayName;Kb.targetType=tb.targetType;Kb.height=tb.height;Kb.width=tb.width;tb=this.ga.Xb(Ka.a.Dof,2,Kb);if(32!==tb)this.Xe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+tb+". AssetId: "+vc);return tb}eLb(){if(!S.c(this.Vt))for(let tb of h.a.instance.xdb()){if("ShowContextMenuWithFloatie"===tb.commandId)return this.Vt.execute(Kb=>{Kb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(tb.commandId&&-1===tb.commandId.indexOf("Tab"))break}return 8}static get instance(){return Bb._instance||(Bb._instance=new Bb)}}Bb._instance=null;Bb.X9n="mso_tellMeService";Bb.unknown="Unknown";Object(C.a)(Bb,"TellMeActor",null,[])},1450:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(1463);class e{constructor(a,h){this.f8a=!1;const {Annotations:m}=c(1444);if(!a)throw Error.argumentNull("annotations");if(!a.Vuf(h))throw Error.argument("memberTypeID","Invalid type ID");
if(m.xH(h))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Sv=a;this.XNj=h;this.So=[]}get NXb(){return this.Sv}get isReadOnly(){return this.f8a}get b3(){return this.XNj}get items(){return this.So}Zba(){const {Annotations:a}=c(1444);let h="[";for(let m=0,v=this.items.length;m<v;++m){0<m&&(h+=", ");const u=this.Sv.Zba(this.b3,this.items[m]);this.b3===a.h8?(h+='"',h+=l.a.h8e(u),h+='"'):h+=u}return h+"]"}isEqual(a){const {Annotations:h}=c(1444);if(this===a)return!0;if(!a||
a.NXb!==this.Sv||a.b3!==this.b3||a.items.length!==this.items.length)return!1;for(let m=0;m<this.items.length;++m)if(!h.Nmb(this.b3,this.items[m],a.items[m]))return!1;return!0}clone(){const a=new e(this.Sv,this.b3);Array.addRange(a.items,this.items);return a}CS(){return this.isReadOnly?this.clone():this}Ixf(){const {Annotations:a}=c(1444);if(!this.isReadOnly){this.f8a=!0;for(const h of this.items)a.uFb(h)}}toString(){return this.Zba()}}Object(C.a)(e,"ListValue",null,[1263,1262])},1451:function(C,O,
c){c.d(O,"a",function(){return l});C=c(0);class l{}l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(C.a)(l,"TellMeScenario",null,[])},1452:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a,h=null,m=null,v=4,u=-99999,n=0){this.ZH="";this.Drd=-1;this.value=e;this.type=a;this.A$i=v;this.label=this.cC=h;this.groupType=27;this.description=m;this.score=u;this.count=n}}Object(C.a)(l,"ResultBinding",null,[])},1455:function(C,O,c){c.d(O,"a",function(){return l});
C=c(0);class l{constructor(e){this.attributes=null;this.query=e;this.Vn=[]}kw(e){this.Vn.push(e)}IPi(e){const a=[];for(const h of this.Vn)h.groupType!==e&&a.push(h);this.Vn.length!==a.length&&(this.Vn=a)}get B7b(){return!1}}Object(C.a)(l,"SimpleResultsUpdatedEventArgs",null,[1120])},1456:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e=27,a=""){this.St=[];this.groupType=e;this.displayName=a}get results(){return this.St}Ez(e){e.groupType=this.groupType;Array.add(this.results,
e)}WSf(e=1){if(this.results.length>=e)for(let a=0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(C.a)(l,"SimpleResultGroup",null,[1121])},1463:function(C,O,c){C=c(0);class l{constructor(a,h){this.sab=a;this.value=h}}Object(C.a)(l,"AttrValuePair",null,[]);c.d(O,"a",function(){return e});class e{constructor(a){this.f8a=!1;if(!a)throw Error.argumentNull("annotations");this.Sv=a;this.lX=[]}get NXb(){return this.Sv}get isReadOnly(){return this.f8a}get Xkf(){return 0<this.lX.length}mq(a){if(!this.Sv.m8b(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const h of this.lX)if(a===h.sab)return a=h.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}jy(a,h){var {Annotations:m}=c(1444);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Sv.m8b(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Sv.g7b(this.Sv.getAttributeType(a),h))throw Error.argument("value","Value is not of the correct type for the specified attribute");m.uFb(h);
for(m=0;m<this.lX.length;++m){const v=this.lX[m];if(a===v.sab){v.value=h;return}}Array.add(this.lX,new l(a,h))}gPa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Sv.m8b(a))throw Error.argument("attributeID","Invalid attribute ID");for(let h=0;h<this.lX.length;++h)if(a===this.lX[h].sab){Array.removeAt(this.lX,h);break}}GDd(a){if(!a)throw Error.argumentNull("action");for(const h of this.lX)a(h.sab,h.value)}clone(){const a=new e(this.Sv);
a.PWa(this);return a}PWa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.NXb!==this.Sv)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.lX);a.GDd((h,m)=>{this.jy(h,m)})}Zba(){const {Annotations:a}=c(1444);let h="[",m=!0;for(const v of this.lX){m?m=!1:h+=", ";h+=this.Sv.KNh(v.sab);h+="=";const u=this.Sv.getAttributeType(v.sab),n=this.Sv.Zba(u,v.value);u===a.h8?(h+=
'"',h+=e.h8e(n),h+='"'):h+=n}return h+"]"}isEqual(a){const {Annotations:h}=c(1444);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Sv!==a.NXb||this.Xkf!==a.Xkf)return!1;let m=0,v=null,u=!1;a.GDd((n,x)=>{++m;if(!u){var A=-1;for(let H=0,E=this.lX.length;H<E;++H)if(this.lX[H].sab===n){A=H;break}0>A?u=!0:(v||(v=Array(this.lX.length)),v[A]=x)}});if(this.lX.length!==m||u)return!1;for(let n=0,x=this.lX.length;n<x;++n)if(!h.Nmb(this.Sv.getAttributeType(this.lX[n].sab),this.lX[n].value,
v[n]))return!1;return!0}CS(){return this.isReadOnly?this.clone():this}Ixf(){const {Annotations:a}=c(1444);if(!this.isReadOnly){this.f8a=!0;for(const h of this.lX)a.uFb(h.value)}}toString(){return this.Zba()}static h8e(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(C.a)(e,"FeatureBundle",null,[1261,1262])},1470:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}l.click="Click";l.h_a="InteractionBegin";l.cDb="InteractionEnd";l.Hsh="ControlActivated";
l.query="Query";l.MJi="QueryIndexRecorded";l.Qph="Clicks";l.Z7g="ActionEvents";l.HIh="FilteredActionEvents";l.ZYi="SessionContext";l.latency="Latency";l.performance="Performance";l.vRi="RenderedResults";l.events="Events";l.GOk="CreateResultsMenu";l.nG="UpdateRibbonControls";l.MAn="ResultsAggregation";l.MI="IssueQuery";l.IBk="CommandSuggestions";l.error="Error";l.vxf="LoadModelData";l.qVk="DepsResolveTime";l.iLm="ModelDataWaitTime";l.timedOut="TimedOut";l.$$j="AddinQueryCommandReady";l.Fil="GetAddinEntitlements";
l.hJi="ProviderMRUEvents";l.Y2k="EnableAddinSearchCommands";Object(C.a)(l,"EventNames",null,[])},1474:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(){this.jzf=null;this.Haa=this.lzf=0}Daf(e,a,h){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>h||h>e.length)throw Error.argumentOutOfRange("length");if(a+h>e.length)throw Error.argument("Invalid start-length range");this.jzf=e;this.lzf=a;this.Haa=h}rdb(e,
a,h){this.Daf(e.jzf,e.lzf+a,h)}J(e){if(0>e||e>=this.Haa)throw Error.argumentOutOfRange("index");return this.jzf[this.lzf+e]}get count(){return this.Haa}static a1e(e){const a=new l;a.Daf(e,0,e.length);return a}}Object(C.a)(l,"ReadOnlyList",null,[1279])},1478:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.Addin=24]="Addin";e[e.OfficeScript=25]="OfficeScript";e[e.AddinStoreEntry=26]="AddinStoreEntry";e[e.None=27]="None";e[e.MergedActions=28]="MergedActions";e[e.MergedScopedSearches=29]="MergedScopedSearches";e[e.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(l||(l={}));Object(C.b)("ResultGroupType",l)},1483:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1526);class l extends c.a{constructor(){super();
this.info=this.kj=this.eventId=null}get xea(){return"Misc"}EAb(){this.detail.Z("Type",this.xea);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.kj);this.detail.Z("Info",this.info);return this.detail}}Object(C.a)(l,"BasicMergeFailureDetail",c.a,[])},1484:function(C,O,c){c.d(O,"a",function(){return h});C=c(0);var l=c(619),e=c(791),a=c(1498);class h{constructor(m,v=!0){this.gm=v&&m?m.OG():m;this.hWb=new l.a}sB(m){this.hWb.add(e.a.yb(m))}aSn(m){this.hWb=m}wsi(m){this.gm&&(new a.a(this.gm,
m)).Qna.forEach((v,u)=>{u.XW&&!this.hWb.contains(v)&&(this.hWb.add(v),u.isDeleted?(u=this.gm,u.hasProperty(e.a.yW(v))&&u.removeProperty(e.a.yW(v))):this.gm.jwa(e.a.yW(v),u.newValue));return!0})}}Object(C.a)(h,"PartialMergeResult",null,[])},1485:function(C,O,c){c.r(O);c.d(O,"CommandResultsUtility",function(){return x});C=c(0);var l=c(1495),e=c(1470),a=c(1496),h=c(1452),m=c(1456),v=c(1449),u=c(1447),n=c(2);class x{static B3c(A,H){if(H&&H.hq){const E={};for(const L of A)H.jRd(L)&&(E[L]=appChrome.selectors.getModelType(L));
v.TellMeActor.instance.nG(E)}}static i$n(A){return A.startsWith("btnTellMeOfficeAddIn")}static tNc(A){const H=v.TellMeActor.instance.QN();return!!H&&H.hq&&!appChrome.selectors.isControlDisabled(A)}static ITd(A,H,E,L){if(v.TellMeActor.instance.Xe&&A){const M=[];for(const F of A)M.push(String.format('{{"Id":"{0}","Score":{1}}}',F.commandId,F.score));A={};A[l.a.suggestions]="[{"+M.join(",")+"}]";A[l.a.yki]=H;A[l.a.groupType]=E;A[l.a.provider]=L;v.TellMeActor.instance.Xe.Yz(e.a.IBk,window.performance.now(),
A)}}static vpl(A,H){const E=[],L=[];for(const M of H){H=M.commandId;let F=M;M.commandId in A&&(H=A[M.commandId],F=new a.a(H,M.score));Array.contains(L,H)||(E.push(F),L.push(H))}return E}static $Hd(A,H,E,L,M,F,J,I){E.kdf&&(H=x.vpl(E.kdf,H));var K=u.a.Inl(H);x.B3c(K,E);var N=[],G=[];K=[];const P=new m.a(J);J=16===J||18===J||7===J||4===J?n.AFrameworkApplication.K?n.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3):3:0===J||17===J?5:0;for(const S of H)if(!x.Ecm(S.commandId)){H=x.i$n(S.commandId);
if(E.jRd(S.commandId)&&!H){if(u.a.wji(S.commandId))continue;H=null;M&&F&&(H=M.gFl(S.commandId,F));x.tNc(S.commandId)?Array.add(N,new h.a(S.commandId,5,H,null,I,S.score)):Array.add(G,new h.a(S.commandId,5,H,null,I,S.score))}else E.Wvb&&H&&L&&Array.add(K,S.commandId.substr(21));if(N.length+K.length>=J)break}E=0;for(M=0;M<N.length&&E<J;M++,E++)P.Ez(N[M]);for(N=0;N<G.length&&E<J;N++,E++)P.Ez(G[N]);for(G=0;G<K.length&&E<J;G++,E++)L.zPo(A,K[G],P);return P}static Ecm(A){x.Xgh||(n.AFrameworkApplication.K&&
n.AFrameworkApplication.K.Hv("TellMeControlPredictionBlockList")&&n.AFrameworkApplication.K.NB("TellMeControlPredictionBlockList").forEach(H=>{Array.add(x.Wgh,H.toLowerCase())}),x.Xgh=!0);return Array.contains(x.Wgh,A.toLowerCase())}static Xpf(A){return 2<A.length&&";"===A.charAt(0)&&";"===A.charAt(A.length-1)&&!!n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static BPh(A){const H=new m.a(0);var E=A.split(";");A=v.TellMeActor.instance.QN();for(const L of E)if(0<L.length){E=L.split(":");const M=2===E.length?E[0]:L;if(!A.jRd(M))break;if(1===E.length)E=new h.a(M,5,null,null,1),H.Ez(E);else if(2===E.length)E=new h.a(M,5,E[1],null,1),H.Ez(E);else break}return H}static s4j(A,H,E){if(!(H&&H.results&&A&&A.results&&A.results.length))return{returnValue:!1,zOe:A,nPe:H};const L=[];for(var M of H.results)Array.add(L,M.value);M=0;const F=0<H.results.length?H.results[0].score:
0;for(const J of A.results)if(J.score>E&&!Array.contains(L,J.value)&&x.tNc(J.value)&&(0<F&&(J.score=F),Array.insert(H.results,M,J),M++),2===M)break;return 0<M?(E=H.results.length-5,0<E&&H.WSf(E),{returnValue:!0,zOe:A,nPe:H}):{returnValue:!1,zOe:A,nPe:H}}}x.Xgh=!1;x.Wgh=[];Object(C.a)(x,"CommandResultsUtility",null,[])},1494:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{static Sao(e){return e.toString().charCodeAt(0)}static snm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static Yeh(e,
a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static Xeh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.FRi(e);a=l.FRi(a);return e===a}static FRi(e){return e.replace(l.NRc," ")}static wlb(e,a,h){return e.substring(a,a+h)}}l.NRc=RegExp("\u00a0","g");Object(C.a)(l,"CharUtils",null,[])},1495:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}l.appName="AppName";l.Qda="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.kma="CorrelationID";l.F4m="ParentUiElement";l.query="Input";l.pIb="QueryID";l.RJi="QueryLength";l.Kbc="QueryIndex";l.NAn="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.jgj="UiElement";l.b3d="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.Abo="TokenAcquired";l.Yrm="LatencyType";l.groupName="GroupName";
l.z6="GroupIndex";l.groupType="GroupType";l.IAn="ResultInfoList";l.resultType="ResultType";l.E3f="SubResultType";l.Vgm="IsInputBlur";l.Wgm="IsInputFocus";l.Dmm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.n1k="DwellTime";l.yki="IsZeroTerm";l.Jxo="WordsCount";l.zQd="IsSearchUxEnabled";l.Snm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.k5e="DisplayIndex";l.f3k="EnableList";l.provider="Provider";l.contentType="ContentType";l.fmm="IsSelectionBased";l.tjk="BeginPerformanceMarker";
l.A3k="EndPerformanceMarker";l.D6m="PerformanceMeasure";Object(C.a)(l,"Columns",null,[])},1496:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(C.a)(l,"CommandSuggestion",null,[])},1498:function(C,O,c){C=c(0);var l=c(386),e=c(791),a=c(243),h=c(44);class m{constructor(u,n,x){this.XSj=u;this.oPj=n;this.JOj=x;this.mue=new a.a(Object(h.a)(this,this.Mvk,"checkIfDifferent"))}get ujb(){return this.XSj}get oldValue(){return this.oPj}get newValue(){return this.JOj}get Vfb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get XW(){return this.Vfb||this.isDeleted||this.mue.value}Mvk(){return this.Vfb||this.isDeleted?!0:!e.a.dfh(this.ujb,this.oldValue,this.newValue)}}Object(C.a)(m,"PropertyDiff",null,[]);c.d(O,"a",function(){return v});class v{constructor(u,n){this.lPj=u;this.GOj=n;this.mue=new a.a(()=>this.DNc());this.ZSj=
new a.a(Object(h.a)(this,this.f6k,"evaluatePropertyDiffs"))}get qu(){return this.lPj}get Ef(){return this.GOj}get Vfb(){return!!this.Ef&&!this.qu}get isDeleted(){return!this.Ef&&!!this.qu}get XW(){return this.Vfb||this.isDeleted||this.mue.value}get Qna(){return this.ZSj.value}DNc(u=null){let n=!1;this.Qna.forEach((x,A)=>{n=A.XW&&(!u||7!==u.J(x));return!n});return n}f6k(){const u=new l.a;var n=this.Ef,x=this.qu;if(this.Vfb){x=n.Nj();for(var A=0;A<x.length;A++){var H=x[A];u.Z(e.a.yb(H),new m(H,null,
n.dQ(H)))}}else if(this.isDeleted)for(n=x.Nj(),A=0;A<n.length;A++)H=n[A],u.Z(e.a.yb(H),new m(H,x.dQ(H),null));else{A=x.Nj();for(H=0;H<A.length;H++){var E=A[H],L=e.a.yb(E),M=x.dQ(E);const F=n.hasProperty(E)?n.dQ(E):null;u.Z(L,new m(E,M,F))}A=n.Nj();for(H=0;H<A.length;H++)E=A[H],x.hasProperty(E)||(L=e.a.yb(E),M=n.dQ(E),u.Z(L,new m(E,null,M)))}return u}}Object(C.a)(v,"MergeableObjectDiff",null,[])},1507:function(C,O,c){c.d(O,"b",function(){return m});c.d(O,"a",function(){return u});var l=c(216),e=c(386),
a=c(619),h=c(1639);const m=(x,A,H)=>{const E=v(x,A,H);let L=0,M=0,F=0,J=new h.a;const I=new l.a;for(let K=0;K<E.length;K++){const N=E.mg(K+1);J.Rrd(x.mg(L));J.Urd(A.mg(M));J.Zrd(H.mg(F));L++;M++;for(F++;L<x.length&&(!N||!N.equals(x.mg(L)));)J.Rrd(x.mg(L)),L++;for(;M<A.length&&(!N||!N.equals(A.mg(M)));)J.Urd(A.mg(M)),M++;for(;F<H.length&&(!N||!N.equals(H.mg(F)));)J.Zrd(H.mg(F)),F++;I.add(J);J=new h.a}for(;L<x.length;)J.Rrd(x.mg(L)),L++;for(;M<A.length;)J.Urd(A.mg(M)),M++;for(;F<H.length;)J.Zrd(H.mg(F)),
F++;J.isEmpty||I.add(J);return I},v=(x,A,H)=>{const E=new l.a,L=A.iG(),M=H.iG();x.forEach(F=>{L.contains(F)&&M.contains(F)&&E.add(F);return!0});return E},u=(x,A,H)=>{x=x||new l.a;A=A||new l.a;H=H||new l.a;const E=new l.a,L=new e.a(0),M=new a.a;for(var F=0;F<x.length;F++){var J=x.mg(F);L.Z(J,F)}for(x=F=0;F<A.length&&x<H.length;){J=A.mg(F);let I=H.mg(x),K=L.Py(J,-1),N=L.Py(I,-1);-1===K?(n(M,E,J),F++):-1===N?(n(M,E,I),x++):K===N?(n(M,E,J),F++,x++):K<N?F++:x++}for(;F<A.length;F++)J=A.mg(F),-1===L.Py(J,
-1)&&n(M,E,J);for(;x<H.length;x++)A=H.mg(x),-1===L.Py(A,-1)&&n(M,E,A);return E},n=(x,A,H)=>{x.contains(H)||(A.add(H),x.add(H))}},1508:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(59);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(C.a)(e,"LcsUpdateHint",null,[1304,69])},1509:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Kbc="QueryIndex";l.pbj="TellMeRanker";l.qbj="TellMeRankerLogging";Object(C.a)(l,
"Services",null,[])},1510:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}l.vMa="HttpRequest";l.provider="Provider";Object(C.a)(l,"LatencyTypes",null,[])},1513:function(C,O,c){C=c(0);var l=c(16),e=c(5),a=c(216),h=c(149),m=c(200),v=c(59),u=c(619),n=c(44),x=c(249),A=c(1526);class H extends A.a{constructor(){super();this.uJb=null}get xea(){return"CreateMergeBlock"}EAb(){this.detail.Z("Type",this.xea);this.detail.Z("Revision",this.uJb);return this.detail}}Object(C.a)(H,"CreateMergeBlockFailureDetail",
A.a,[]);var E=c(1564),L=c(1566),M=c(1638),F=c(1527),J=c(1484),I=c(1692);c.d(O,"a",function(){return K});class K{static Pxd(N,G,P,S,W,X,Y){let ca;ca="";const ha=new a.a;for(let sa=0;sa<P.length;sa++){var ra=void 0;let oa;ra=E.a.Npl(G,P.J(sa),S,W,X,Y,N);if(!ra)return{returnValue:null,P0a:ca};({rAf:oa,P0a:ra}=ra.HVh());if(!oa)return{returnValue:null,P0a:ca};ca+=ra;ha.IA(ha.length,oa)}return{returnValue:ha,P0a:ca}}static Gvh(N,G,P,S,W,X,Y,ca){let ha,ra,sa,oa,ka,ia;ia=ka=oa=sa=ra=ha=null;({P0a:oa,returnValue:ha}=
K.Pxd(G,La=>N.runtime.lk.J(La),P,1,X,Y,ca));if(!ha)return h.a.instance.Sa(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),N.logger.Tg(Object.assign(new H,{uJb:"Base"})),{returnValue:!1,TJ:ha,bGc:ra,v3c:sa,Ksd:oa,lCd:ka,Dce:ia};({P0a:ka,returnValue:ra}=K.Pxd(G,La=>N.runtime.du.J(La)||N.runtime.lk.J(La),S,2,X,Y,ca));if(!ra)return h.a.instance.Sa(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
N.logger.Tg(Object.assign(new H,{uJb:"Favored"})),{returnValue:!1,TJ:ha,bGc:ra,v3c:sa,Ksd:oa,lCd:ka,Dce:ia};({P0a:ia,returnValue:sa}=K.Pxd(G,La=>N.runtime.nq.J(La)||N.runtime.lk.J(La),W,4,X,Y,ca));return sa?{returnValue:!0,TJ:ha,bGc:ra,v3c:sa,Ksd:oa,lCd:ka,Dce:ia}:(h.a.instance.Sa(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),N.logger.Tg(Object.assign(new H,{uJb:"Unfavored"})),{returnValue:!1,
TJ:ha,bGc:ra,v3c:sa,Ksd:oa,lCd:ka,Dce:ia})}static Nph(N,G=!1){const P=new a.a;let S=0;for(;S<N.length;){var W=N.J(S);if(1===W.type||4===W.type||2===W.type)P.add(W),S++;else if(3===W.type){let Y="";Y+=W.character;S++;let ca=W.dNa,ha=!1;for(;S<N.length;S++){var X=N.J(S);3===X.type?W.runId===X.runId&&W.uI.equals(X.uI)&&(W.U$===X.U$||W.PBa===X.PBa)&&W.wE.Tz(X.wE)&&(!G||W.Bt&&W.Bt.equals(X.Bt))?(Y+=X.character,X.dNa&&(ca=!0)):ha=!0:ha=!0;if(ha){W=new I.a(null,W.source,W.Cj,W.Dg,W.runId,W.uI,Y,W.aib,!0,
ca,W.U$,W.PBa,W.QOa,W.wE,W.Bt);P.add(W);break}}}}h.a.instance.Sa(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Fq());return P}static ABk(N,G=!1){const P=new a.a;let S=0;for(;S<N.length;){var W=N.J(S);if(1===W.type||4===W.type||2===W.type)P.add(W),S++;else if(3===W.type){let Y=W.character.toString();S++;let ca=W.dNa;for(;S<N.length;S++){var X=N.J(S);if(3===X.type&&K.$Vn(W,X,G))Y+=X.character,X.dNa&&(ca=!0);else break}W=new I.a(null,W.source,W.Cj,W.Dg,
W.runId,W.uI,Y,W.aib,!0,ca,W.U$,W.PBa,W.QOa,W.wE,W.Bt);P.add(W)}}h.a.instance.Sa(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Fq());return P}static $Vn(N,G,P){return N.runId===G.runId&&N.uI.equals(G.uI)&&(N.U$===G.U$||N.PBa===G.PBa)&&N.wE.Tz(G.wE)&&(!P||!!N.Bt&&N.Bt.equals(G.Bt))}static RPn(N,G,P,S,W,X,Y,ca,ha,ra,sa,oa,ka,ia,La,va){N.setPropertyString(P.gm,l.a.mo,W);N.setPropertyUint32(P.gm,e.a.Nc,S);N.setPropertyUint32s(P.gm,e.a.Iq,X);N.setPropertyUint32s(P.gm,
e.a.gt,Y);N.setPropertyObjectIds(P.gm,l.a.wn,ha);N.hasProperty(P.gm,e.a.mj)&&N.setPropertyUint32(P.gm,e.a.mj,K.lhl());G&&G(10)&&N.setPropertyObjectIds(P.gm,e.a.$u,va);S=!1;for(W=0;W<ra.length;W++)if(ra.J(W)){S=!0;break}S&&N.setPropertyBools(P.gm,e.a.nEf,ra);K.uqk(G,N,P,sa,oa,ka,ia);K.vqk(N,P,La);P.sB(l.a.mo);P.sB(e.a.Nc);P.sB(e.a.Iq);P.sB(e.a.gt);P.sB(l.a.wn);P.sB(e.a.nEf);P.sB(l.a.km);P.sB(l.a.olb);P.sB(e.a.gMa);P.sB(e.a.SDa);P.sB(l.a.Wua);P.sB(e.a.$u);N.hasProperty(P.gm,e.a.mj)&&P.sB(e.a.mj);0<
ca.length?N.setPropertyUint32s(P.gm,l.a.km,ca):P.gm.removeProperty(l.a.km)}static uqk(N,G,P,S,W,X,Y){if(N(105)){N=S.contains(!0,(ca,ha)=>ha);K.wZf(G,P,l.a.Wua,N?S:null);K.wZf(G,P,l.a.olb,K.kTi(S,W));K.wZf(G,P,e.a.gMa,K.kTi(S,X));S=!1;for(W=0;W<Y.length;W++)0!==Y.J(W)&&(S=!0);S?G.setPropertyUint32s(P.gm,e.a.SDa,Y):P.gm.removeProperty(e.a.SDa)}}static vqk(N,G,P){const S=Y=>Y;var W=Object(n.a)(N,N.setPropertyBools,"setPropertyBools");K.WJa(G,P.Lfb,S,W,e.a.lCa);K.WJa(G,P.Zbb,S,W,e.a.lea);K.WJa(G,P.T1a,
S,W,e.a.RDa);W=Y=>0<Y.length;var X=Object(n.a)(N,N.setPropertyStrings,"setPropertyStrings");K.WJa(G,P.Kfb,W,X,e.a.mCa);K.WJa(G,P.Ybb,W,X,e.a.GAa);K.WJa(G,P.ojb,W,X,e.a.mFa);W=Y=>!!Y;X=Object(n.a)(N,N.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");K.WJa(G,P.Mfb,W,X,e.a.nCa);K.WJa(G,P.pXa,W,X,e.a.HAa);K.WJa(G,P.qjb,W,X,e.a.nFa);P.T1a.any(S)?K.WJa(G,P.pjb,()=>!0,Object(n.a)(N,N.setPropertyObjectIds,"setPropertyObjectIds"),e.a.Dwa):G.gm.removeProperty(e.a.Dwa)}static kTi(N,G){const P=
new a.a;let S=!1;for(let W=0;W<N.length;W++){const X=G.J(W)&&!N.J(W);P.add(X);S=X||S}return S?P:null}static wZf(N,G,P,S){S?N.setPropertyBools(G.gm,P,S):G.gm.removeProperty(P)}static lhl(){return m.a.ZF()}static EWh(N,G){return N.runtime.du.Py(G,N.runtime.lk.J(G)||N.runtime.nq.get(G))}static SIc(N,G,P,S,W){let X;X=new a.a;const Y=!!P&&P(10);if(N.runtime.Wb.isFeatureEnabled(79)){var ca=K.ABk(S,Y);var ha=K.Nph(S,Y);ca.length!==ha.length&&N.runtime.Wb.Lt(79)}else ca=K.Nph(S,Y);ha=0;let ra="",sa=new a.a,
oa=new a.a,ka=new a.a,ia=new a.a,La=new a.a,va=new a.a,Ga=new a.a,Oa=new a.a,Za=new a.a;const ja=new M.a;let ba=new a.a;var qa=ca.J(ca.length-1);if(2!==qa.type&&4!==qa.type)return h.a.instance.Sa(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",qa.type),N.logger.Tg(Object.assign(new F.a,{kj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",qa.type)})),{returnValue:!1,
F_d:X};var Ma=0;for(qa=0;qa<ca.length;qa++){var Ia=ca.J(qa),wa=null;if(1===Ia.type||3===Ia.type)wa=Ia,ra+=wa.text;else if(4===Ia.type){Ia=K.EWh(N,Ia.Cj);Ia=new J.a(Ia);X.add(Ia);continue}wa?(sa.add(wa.runId),oa.add(wa.Dg),Ma+=wa.text.length,ka.add(Ma),ia.add(wa.uI),La.add(wa.aib),va.add(wa.dNa),Ga.add(wa.U$),Oa.add(wa.PBa),Za.add(wa.QOa),ja.Lfb.add(wa.wE.ZXl),ja.Zbb.add(wa.wE.BXl),ja.T1a.add(wa.wE.yYl),ja.Kfb.add(wa.wE.insertion.author),ja.Ybb.add(wa.wE.deletion.author),ja.ojb.add(wa.wE.QDa.author),
ja.Mfb.add(wa.wE.insertion.iSc),ja.pXa.add(wa.wE.deletion.iSc),ja.qjb.add(wa.wE.QDa.iSc),ja.pjb.add(wa.wE.QDa.tNf),Y&&ba.add(wa.Bt)):sa.length||(sa.add(0),oa.add(0),ka.add(0),ia.add(v.a.nil),La.add(!1),va.add(!1),Ga.add(!1),Oa.add(!1),Za.add(0),ja.Lfb.add(!1),ja.Zbb.add(!1),ja.T1a.add(!1),ja.Kfb.add(""),ja.Ybb.add(""),ja.ojb.add(""),ja.Mfb.add(0),ja.pXa.add(0),ja.qjb.add(0),ja.pjb.add(v.a.nil));if(2===Ia.type){Ma=Ia;Ia=Ma.Nc;ka.nF(ka.length-1);wa=W.J(ha);if(!wa)return h.a.instance.Sa(17044307,1,2,
"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",ha,W.length,S.length,qa,ca.length),N.logger.Tg(Object.assign(new F.a,{kj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),h.a.instance.Aha(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",W.Fq()),h.a.instance.Aha(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
S.Fq()),h.a.instance.Aha(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ca.Fq()),{returnValue:!1,F_d:X};if(wa=K.EWh(N,wa))wa=new J.a(wa.OG()),K.RPn(G,P,wa,Ma.Nc,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za,ja,ba),X.add(wa);h.a.instance.Sa(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ma.Cj,Ia,sa.Fq(),oa.Fq(),
ka.Fq(),va.Fq(),Ga.Fq(),Oa.Fq(),ia.Fq(),"",Za.Fq());ha++;ra="";sa=new a.a;oa=new a.a;ka=new a.a;ia=new a.a;La=new a.a;va=new a.a;Ga=new a.a;Oa=new a.a;Za=new a.a;ja.reset();Ma=0;ba=new a.a}}return{returnValue:!0,F_d:X}}static zzn(N,G){const P=N.runtime.Um.J(x.a.KK),S=G.getPropertyObjectIds(P.gm,e.a.c0);for(let W=0;W<S.length;W++)N.runtime.Um.remove(S.J(W));G.setPropertyObjectIds(P.gm,e.a.c0,new a.a);G.setPropertyString(P.gm,e.a.TQa,v.a.nil.toString());P.sB(e.a.c0);P.sB(e.a.TQa)}static m6l(N,G){if(N.runtime.Um.ub(x.a.KK))return null;
const P=new J.a(N.runtime.lk.J(x.a.KK).OG());G.setPropertyString(P.gm,e.a.TQa,N.output.bM.last().id.toString());G.setPropertyObjectIds(P.gm,e.a.c0,new a.a);P.sB(e.a.c0);P.sB(e.a.TQa);N.runtime.Um.Z(x.a.KK,P);return P}static bgf(N){const G=new a.a;N.forEach(P=>{G.add(P.id);return!0});return G}static p9b(N,G,P,S){let W=0;P.forEach(X=>{L.a(X,G+W++,1);393230===X.Qc&&N.getPropertyObjectIds(X,l.a.wn).forEach(Y=>{S.add(Y);return!0});return!0})}static nzm(N,G){const P=new u.a;let S=0;G.forEach(W=>{if(P.contains(W))return!0;
P.add(W);if(({index:S}=K.Yxf("BaseFormatting_",S,W,X=>N.runtime.lk.J(X))).returnValue||({index:S}=K.Yxf("FavoredFormatting_",S,W,X=>N.runtime.du.J(X))).returnValue||({index:S}=K.Yxf("ConflictingFormatting_",S,W,X=>N.runtime.nq.J(X))).returnValue)return!0;S++;return!0})}static Yxf(N,G,P,S){if(P=S(P))if(L.a(P,N+G,1),1179649===P.Qc)return G++,{returnValue:!0,index:G};return{returnValue:!1,index:G}}static M5e(N){return!!N.runtime.lk.J(x.a.KK)}static WJa(N,G,P,S,W){G.any(P)?(S(N.gm,W,G),N.sB(W)):N.gm.removeProperty(W)}static s1i(N,
G){const P=new a.a;P.add(0);const S=N?N.length:0;for(let W=0;W<S;W++)P.insert(W+1,N.mg(W));P.insert(P.length,G);return P}}Object(C.a)(K,"ParagraphMergeUtils",null,[])},1524:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(216);class e{constructor(a,h,m){this.nm=null;this.Fl=a;this.source=h;this.Cj=m}get type(){return this.Fl}get N3a(){return!1}get Kfm(){return 1===(this.source&1)}get Lfm(){return 2===(this.source&2)}get Mfm(){return 4===(this.source&4)}W2(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.bll(),this.u2b())}bll(){let a="";this.Kfm&&(a+="Base");this.Lfm&&(a+="FavoredUpdate");this.Mfm&&(a+="UnfavoredUpdate");return a}u2b(){return""}Tz(a){return this.type===a.type}j1c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(C.a)(e,"AMergeBlock",null,[76,77])},1525:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1524);class l extends c.a{constructor(e,a,h){super(2,e,a);this.Nc=h}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Nc,this.Cj)}u2b(){return"Eop"}clone(){return new l(this.source,this.Cj,this.Nc)}Tz(e,a,h,m=!1,v=!0){return super.Tz(e,a,h,m)?v?e.Nc===this.Nc:e.Cj===this.Cj&&e.Nc===this.Nc:!1}get length(){return 1}}Object(C.a)(l,"EopMergeBlock",c.a,[])},1526:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(386);class e{constructor(){this.detail=new l.a}}Object(C.a)(e,"AMergeFailureDetail",null,[1909])},1527:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1483);class l extends c.a{constructor(){super()}get xea(){return"ParagraphMerge"}}
Object(C.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1528:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1483);class l extends c.a{constructor(){super()}get xea(){return"RdOpLcs"}}Object(C.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1529:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1483);class l extends c.a{constructor(){super()}get xea(){return"TableMerge"}}Object(C.a)(l,"TableMergeFailureDetail",c.a,[])},1532:function(C,O,c){C=c(0);class l{constructor(){this.D2c=this.vMc=
null;this.Yzf=this.score=this.PRc=0}fLf(E,L,M){this.score=E.J(L);++L;this.vMc=E.J(L)?M.Bla(E.J(L)):null;++L;this.D2c=E.J(L)?M.Bla(E.J(L)):null;++L;this.PRc=E.J(L);++L;this.Yzf=E.J(L);++L;return L}}Object(C.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(E,L,M,F,J){this.edb=E;this.count=L;this.fDd=M;this.IN=F;this.depth=J}}Object(C.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1578),h=c(1656);class m{constructor(E=null,L=0,M=0,F=0){this.XZj=E||new h.a;this.gta=L;this.IN=M;this.depth=
F}get Z3(){return this.XZj}getKey(){return this.Z3.Zw.toString()+":"+this.gta.toString()}}Object(C.a)(m,"TrieBookmark",null,[]);class v{constructor(E,L){this.RNa=E;this.dzf=L}ZEm(E){if(null==E)throw Error.argumentNull("prefix");let L={};var M=L[""]=new m;this.PLd(M,L);for(M=0;M<E.length;++M){const F=E.charCodeAt(M),J={};for(let I in L)this.Qak(F,L[I],J);L=J}return this.mdo(L)}PLd(E,L){if(!(E.IN>=this.dzf)&&(E=new m(a.a.QXe(E.Z3),E.gta,E.IN+1,E.depth),E.Z3.DE&a.a.o5a&&(E.gta+=1),this.RNa.nMb(E.Z3))){E.depth+=
1;let M=!0;for(;M;)v.kde(E,L),this.PLd(E,L),E.gta+=this.RNa.K2b(E.Z3,!0)+(E.Z3.DE&a.a.o5a?1:0),M=this.RNa.Y2c(E.Z3)}}Qak(E,L,M){L.IN+1<=this.dzf&&(L.IN+=1,v.kde(L,M),--L.IN);L.Z3.DE&a.a.o5a&&(L.gta+=1);if(this.RNa.nMb(L.Z3)){L.depth+=1;let F=!0;for(;F;)L.Z3.nNb===E?(v.kde(L,M),this.PLd(L,M)):L.IN+1<=this.dzf&&(L.IN+=1,v.kde(L,M),this.PLd(L,M),--L.IN),L.gta+=this.RNa.K2b(L.Z3,!0)+(L.Z3.DE&a.a.o5a?1:0),F=this.RNa.Y2c(L.Z3)}}mdo(E){const L=[];for(var M in E){const F=E[M];if(!F.Z3.Zw)continue;const J=
!!(F.Z3.DE&a.a.o5a),I=this.RNa.K2b(F.Z3,!1)+(J?1:0);Array.add(L,new e(F.gta,I,J,F.IN,F.depth))}L.sort((F,J)=>{let I=F.edb-J.edb;return I||(I=-(F.count-J.count))?I:I=F.depth-J.depth});if(2>L.length)return L;E=[];for(M=0;M<L.length;)M+=v.Wdj(M,L,E);return E}static kde(E,L){const M=E.getKey();M in L?(L=L[M],L.IN=Math.min(L.IN,E.IN)):L[M]=new m(a.a.QXe(E.Z3),E.gta,E.IN,E.depth)}static Wdj(E,L,M){const F=L[E];let J=F.edb;const I=J+F.count;let K=1,N=F.fDd;for(;E+K<L.length&&L[E+K].edb<I;){const G=L[E+K];
G.edb>J&&(Array.add(M,new e(J,G.edb-J,N,F.IN,F.depth)),N=!1);K+=v.Wdj(E+K,L,M);J=G.edb+G.count}J<I&&Array.add(M,new e(J,I-J,N,F.IN,F.depth));return K}}Object(C.a)(v,"ErrorTolerantTrieLookupEngine",null,[1331]);class u extends l{constructor(E,L,M){super();this.A8h=this.ECi=!1;this.oGh=null;if(E){var F=0;try{F=this.fLf(E,F,L);this.ECi=1===E.J(F);++F;this.A8h=1===E.J(F);++F;const J=E.J(F);this.oGh=this.Y4m(M,J)}catch(J){throw Error.argument("initData");}}}Y4m(E,L){return new v(E,L)}}Object(C.a)(u,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class n extends l{constructor(E,L){super();this.query=this.name=null;if(E){this.annotations=L.annotations;var M=0;try{M=this.fLf(E,M,L),this.name=L.nE(E.J(M)),++M,this.query=L.aK(E.J(M))}catch(F){throw Error.argument("initData");}}}}Object(C.a)(n,"QueryTokenStringGeneratorInit",l,[]);class x extends l{constructor(E,L){super();if(E)try{this.fLf(E,0,L)}catch(M){throw Error.argument("initData");}}}Object(C.a)(x,"SurfaceStringTokenStringGeneratorInit",l,[]);var A=c(1474);c.d(O,"a",function(){return H});
class H{constructor(E){this.Uyf=E}get vMc(){return this.Uyf.vMc}get D2c(){return this.Uyf.D2c}get PRc(){return this.Uyf.PRc}static create(E,L,M){const {SurfaceStringTokenStringGenerator:F}=c(1784),{QueryTokenStringGenerator:J}=c(1785),{FuzzyMatchTokenStringGenerator:I}=c(1786);let K=0;try{if(E.J(K)!==H.zwb)throw Error.argument("initData","Input does not represent a token string generator");++K;const N=E.J(K);++K;const G=new A.a;G.rdb(E,K,E.count-K);switch(N){case F.iAc:return new F(new x(G,L));case J.iAc:return new J(new n(G,
L));case I.iAc:return new I(new u(G,L,M));default:throw Error.argument("initData");}}catch(N){throw Error.argument("initData");}}static J$g(E,L,M,F,J,I){E=E.Fbo.getId(L,null);if(0>E)return++I,I;H.K$g(E,M,F,J);return I}static K$g(E,L,M,F){Array.add(F.v3f,E);Array.add(F.k$i,L);++F.Ngc[M]}}H.zwb=1099767983;Object(C.a)(H,"TokenStringGenerator",null,[1302])},1563:function(C,O,c){c.d(O,"a",function(){return a});C=c(0);var l=c(216);O=c(1524);var e=c(1494);class a extends O.a{constructor(h,m,v){super(h,m,
v)}b3n(h){let m;m=null;if(!this.text||!this.N3a||0>=h||h>=this.length)return{returnValue:!1,L8i:m};m=new l.a;const v=this.clone();v.a0c(e.a.wlb(this.text,0,h));const u=this.clone();u.a0c(e.a.wlb(this.text,h,this.length-h));m.add(v);m.add(u);return{returnValue:!0,L8i:m}}W2(){return!0}get length(){return this.text.length}}Object(C.a)(a,"ATextMergeBlock",O.a,[])},1564:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(149);class e{mRe(a,h){return a+("[Block: "+h+"] ")}static Npl(a,h,m,v,
u,n,x){const {ParagraphMergeBlockCreator:A}=c(1827),{TableMergeBlockCreator:H}=c(1831);if(393230===h.Qc)return new A(a,h,m,u,n,v(10),x);if(393250===h.Qc)return new H(h,m);l.a.instance.Sa(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",h.Qc);return null}}Object(C.a)(e,"MergeBlockCreator",null,[])},1565:function(C,O,c){c.d(O,"a",function(){return h});C=c(0);var l=c(5),e=c(59);O=c(1563);var a=c(1498);class h extends O.a{constructor(m,v,u,n,x,A,H,E,L,M,F,J,I,K){super(v,
u,n);this.Dg=x;this.runId=A;this.aib=E;this.PFj=H;this.Rhe=m;this.dNa=L;this.U$=M;this.PBa=F;this.QOa=J;this.wE=I;this.Bt=K}get Oyc(){return this.Rhe}get uI(){return this.PFj}get Yzb(){return this.Oyc(this.uI)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Dg,this.runId,this.aib,this.Cj,this.uI.toString(),this.Bt?this.Bt.toString():"NULL")}Tz(m,v,u,n=!1){if(!super.Tz(m,v,u,n))return!1;if(n)return!0;
if(!this.wE.Tz(m.wE)||this.Bt&&!this.Bt.equals(m.Bt))return!1;if(this.uI.equals(m.uI)||this.uI.equals(e.a.nil)||m.uI.equals(e.a.nil))return!0;m=new a.a(this.Yzb,m.Yzb);v=v.ivh(this.Yzb,u);return m.DNc(v.j1d)?!1:!0}get Fam(){return this.W2()&&"\ufffc"===this.text&&this.Yzb?this.Yzb.hasProperty(l.a.Gq)||1179725!==this.Yzb.Qc?!0:!1:!1}}Object(C.a)(h,"AUserRunMergeBlock",O.a,[])},1566:function(C,O,c){c.d(O,"a",function(){return e});var l=c(149);const e=(a,h,m=4)=>{a?l.a.instance.Aha(4273285,m,4,h,a.w2c()):
l.a.instance.Sa(4293845,m,1,h,"{0}: Node was null.",h)}},1567:function(C,O,c){c.d(O,"e",function(){return v});c.d(O,"a",function(){return u});c.d(O,"d",function(){return n});c.d(O,"b",function(){return x});c.d(O,"c",function(){return A});var l=c(5),e=c(16),a=c(59),h=c(1006),m=c(1507);const v=(L,M,F)=>{const J=new h.a;let I=a.a.nil;M=J.getPropertyObjectId(M,l.a.Glb);M.equals(a.a.nil)||(L=L.runtime.lk.J(M),F&&(L=F.Py(M,L)),L&&(I=J.getPropertyObjectId(L,l.a.Glb)));return I},u=(L,M,F,J,I)=>{const K=new h.a;
let N=null;var G=K.getPropertyObjectId(F,l.a.Glb);G!==a.a.nil&&(N=L.runtime.lk.J(G),M&&(N=M.Py(G,N)));if(N){G=K.getPropertyObjectIds(N,e.a.$e);for(I=0;I<G.length&&!G.J(I).equals(F.id);I++);I===G.length&&(I=-1)}F=v(L,F,M);if(!F.equals(a.a.nil)&&(L=L.runtime.lk.J(F),M&&(L=M.Py(F,L)),L)){M=K.getPropertyObjectIds(L,e.a.$e);for(J=0;J<M.length&&!M.J(J).equals(N.id);J++);J===M.length&&(J=-1)}return{rowIndex:J,BZb:I}},n=(L,M,F,J,I)=>{var K=new h.a;let N=null;var G=L.runtime.lk.J(F);M&&(G=M.Py(F,G));if(!G)return null;
G=K.getPropertyObjectIds(G,e.a.$e);F=null;J<G.length&&(J=G.J(J),F=L.runtime.lk.J(J),M&&(F=M.Py(J,F)));F&&(K=K.getPropertyObjectIds(F,e.a.$e),I<K.length&&(I=K.J(I),N=L.runtime.lk.J(I),M&&(N=M.Py(I,N))));return N},x=(L,M,F)=>{let J,I;I=J=-1;const K=(new h.a).getPropertyObjectId(F,l.a.Glb);var N=v(L,F,M);if(N.equals(a.a.nil)||K.equals(a.a.nil))return{rowIndex:J,BZb:I};M=L.runtime.H4f;var G=M.J(N);if(!G){G=H(L,N);if(!G)return{rowIndex:J,BZb:I};M.Z(N,G)}for(N=0;N<G.length;N++)if(G.J(N).equals(K)){J=N;
break}G=M.J(K);if(!G){G=E(L,K);if(!G)return{rowIndex:J,BZb:I};M.Z(K,G)}for(L=0;L<G.length;L++)if(G.J(L).equals(F.id)){I=L;break}return{rowIndex:J,BZb:I}},A=(L,M,F,J)=>{if(0>F||0>J)return a.a.nil;new h.a;const I=L.runtime.H4f;let K=I.J(M);if(!K){K=H(L,M);if(!K)return a.a.nil;I.Z(M,K)}if(F<K.length)M=K.J(F);else return a.a.nil;F=I.J(M);if(!F){F=E(L,M);if(!F)return a.a.nil;I.Z(M,F)}if(J<F.length)L=F.J(J);else return a.a.nil;return L},H=(L,M)=>{var F=new h.a;const J=L.runtime.lk.J(M);if(J){var I=L.runtime.du.Py(M,
J);L=L.runtime.nq.Py(M,J);M=F.getPropertyObjectIds(J,e.a.$e);I=F.getPropertyObjectIds(I,e.a.$e);F=F.getPropertyObjectIds(L,e.a.$e);return M.Jp(I,(K,N)=>K.equals(N))?F:M.Jp(F,(K,N)=>K.equals(N))?I:m.a(M,I,F,(K,N)=>K.equals(N))}return(I=L.runtime.du.J(M))?F.getPropertyObjectIds(I,e.a.$e):(I=L.runtime.nq.J(M))?F.getPropertyObjectIds(I,e.a.$e):null},E=(L,M)=>{var F=new h.a;const J=L.runtime.lk.J(M);if(J){var I=L.runtime.du.Py(M,J);L=L.runtime.nq.Py(M,J);M=F.getPropertyObjectIds(J,e.a.$e);I=F.getPropertyObjectIds(I,
e.a.$e);F=F.getPropertyObjectIds(L,e.a.$e);return M.Jp(I,(K,N)=>K.equals(N))?F:M.Jp(F,(K,N)=>K.equals(N))?I:null}return(I=L.runtime.du.J(M))?F.getPropertyObjectIds(I,e.a.$e):(I=L.runtime.nq.J(M))?F.getPropertyObjectIds(I,e.a.$e):null}},1568:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(1447);c=c(2);class e{static Unm(){return!l.a.zei()&&!l.a.jEb()&&e.isFeatureEnabled(0)}static Lii(){return e.isFeatureEnabled(1)}static Vfi(){return e.isFeatureEnabled(2)}static isFeatureEnabled(a){return!!(e.GEj&
1<<a)}}e.GEj=c.AFrameworkApplication.K?c.AFrameworkApplication.K.rc("TellMeFeatureConfigValue",0):0;Object(C.a)(e,"TellMeFeatureAvailability",null,[])},1569:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1452);class l extends c.a{constructor(e,a,h,m,v=null){super(e,a,v,null,h);this.id=m}}Object(C.a)(l,"TryQueryResultBinding",c.a,[])},1570:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e){this.Bb=e}get e1a(){return this.Bb.e1a}get a7n(){return 4!==this.Bb.style}get c7n(){return!0}get trie(){return this.Bb.trie}getId(e,
a){if(!this.a7n)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.Hwl(e,a);default:throw Error.notImplemented();}}nE(e){if(!this.c7n)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.e1a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.QLl(e);case 4:return this.PLl(e);default:throw Error.notImplemented();}}Hwl(e,a){e=this.Bb.trie.vpi(e,
0,e.length,a);if(!e.succeeded)return-1;if(0>e.ahc||e.ahc>=this.Bb.e1a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Z2c?this.Bb.XWc.hy(this.Bb.Z2c+4*e.ahc,4):e.ahc}QLl(e){if(this.Bb.Z2c){let a=0;for(;a<this.Bb.e1a&&this.Bb.XWc.hy(this.Bb.Z2c+4*a,4)!==e;++a);if(a>=this.Bb.e1a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.Z_h(a)}return this.Bb.trie.Z_h(e)}PLl(e){const a=this.Bb.XWc.hy(this.Bb.h$i+4*e,4);e=
this.Bb.XWc.hy(this.Bb.i$i+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const h=Array(a);for(let m=0;m<a;++m)h[m]=({N0l:e}=this.Cin(e)).returnValue;return String.fromCharCode.apply(null,h)}Cin(e){let a=0;for(let h=0;3>h;++h){const m=this.Bb.XWc.J(this.Bb.Dmh+e)^182;++e;a|=(m&127)<<7*h;if(!(m&128))break}return{returnValue:a,N0l:e}}}Object(C.a)(l,"StringTable",null,[1277])},1571:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(1578);
class e{constructor(a){this.trie=null;this.Dmh=this.h$i=this.i$i=this.Z2c=0;if(a){this.XWc=a;var h=0;if(a.hy(h,4)!==e.zwb)throw Error.argument("bytes","Input does not represent a string table");h+=4;this.e1a=a.hy(h,4);h+=4;this.style=a.hy(h,4);h+=4;switch(this.style){case 0:const m=1===a.hy(h,4);h+=4;m||(this.Z2c=h,h+=4*this.e1a);a.hy(h,4);this.trie=this.y5m(a,h+4);break;case 4:this.i$i=h;this.h$i=h+=4*this.e1a;h+=4*this.e1a;a.hy(h,4);this.Dmh=h+4;break;default:throw Error.argument("bytes");}}}y5m(a,
h){return new l.a(a,h)}}e.zwb=1025118440;Object(C.a)(e,"StringTableInit",null,[])},1572:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";
e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=
24]="Template";e[e.Addin=25]="Addin";e[e.OfficeScript=26]="OfficeScript";e[e.AddinStoreEntry=27]="AddinStoreEntry";e[e.Unknown=28]="Unknown"})(l||(l={}));Object(C.b)("ResultType",l)},1575:function(C,O,c){C=c(0);var l=c(5),e=c(619),a=c(149),h=c(216),m=c(59),v=c(386),u=c(64),n;(function(Sa){Sa[Sa.none=0]="none";Sa[Sa.mergeConflict=1]="mergeConflict";Sa[Sa.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Sa[Sa.failedToApplyHints=3]="failedToApplyHints";Sa[Sa.validateUpdateHintsAreComplete=
4]="validateUpdateHintsAreComplete";Sa[Sa.other=5]="other"})(n||(n={}));Object(C.b)("ParagraphMergeUsingHintsFailureReason",n);var x=c(1006),A=c(249),H=c(885);const E=Sa=>{const ua=new h.a;Sa.forEach(Fa=>{ua.add(Fa);return!0});return ua};var L=c(1525),M=c(1507),F=c(1528);const J=(Sa,ua)=>{if(Sa.length!==ua.length)return!1;for(let Fa=0;Fa<Sa.length;Fa++)Sa.J(Fa).nm=ua.J(Fa),ua.J(Fa).nm=Sa.J(Fa);return!0},I=(Sa,ua,Fa)=>{let Pa,Ea,lb;Pa=0;Ea=!1;lb=0;var zb;if(!({idx:zb}=S(Sa,ua)).returnValue)return a.a.instance.Sa(18969440,
1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",ua,Sa.Fq()),{returnValue:!1,sKc:Pa,Xhb:Ea,ASc:lb};if(!Fa&&2===Sa.J(zb).type)return{returnValue:!0,sKc:zb,Xhb:Ea,ASc:lb};if(!Sa.J(zb).W2())return a.a.instance.Sa(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",zb,Fa,Sa.Fq()),{returnValue:!1,sKc:Pa,Xhb:Ea,ASc:lb};let Xb=!1,ub=0;for(;zb<Sa.length&&Sa.J(zb).Cj.equals(ua);zb++){if(Fa===
ub){Xb=!0;break}if(Fa>ub&&Fa<ub+Sa.J(zb).length){Ea=Xb=!0;lb=Fa-ub;break}ub+=Sa.J(zb).length}Xb||Fa!==ub||(Xb=!0);Xb&&(Pa=zb);return{returnValue:Xb,sKc:Pa,Xhb:Ea,ASc:lb}},K=(Sa,ua,Fa)=>{let Pa,Ea,lb;lb=Ea=0;Pa=!1;let zb=0,Xb=!1;for(;Ea<Sa.length;Ea++){if(ua===zb){Xb=!0;break}if(ua>zb&&ua<zb+Sa.J(Ea).length){Pa=Xb=!0;lb=ua-zb;break}zb+=Sa.J(Ea).length}Xb||ua!==zb||(Xb=!0);Xb||(Sa=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Sa.length,zb,ua),a.a.instance.Sa(573178201,
1,2,Sa),Fa.Tg(Object.assign(new F.a,{eventId:"8k6fz",info:Sa})));return{returnValue:Xb,Xhb:Pa,Vgh:Ea,Ugh:lb}},N=(Sa,ua,Fa)=>{let Pa;if(Sa.J(ua).W2()&&({L8i:Pa}=Sa.J(ua).b3n(Fa)).returnValue)return Sa.IA(ua+1,Pa),Sa.nF(ua),!0;a.a.instance.Sa(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",ua,Fa,Sa.Fq());return!1},G=(Sa,ua,Fa)=>{let Pa,Ea;if(!({sKc:Fa,Xhb:Ea,ASc:Pa}=I(Sa,ua,Fa)).returnValue)return{returnValue:!1,index:0};if(!Ea)return{returnValue:!0,
index:Fa};if(N(Sa,Fa,Pa))return{returnValue:!0,index:Fa+1};a.a.instance.Sa(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",ua,Pa,Sa.Fq());return{returnValue:!1,index:0}},P=(Sa,ua,Fa)=>{let Pa;if(!({Xhb:Pa,Vgh:ua,Ugh:Fa}=K(Sa,ua,Fa)).returnValue)return{returnValue:!1,index:0};if(!Pa)return{returnValue:!0,index:ua};if(N(Sa,ua,Fa))return{returnValue:!0,index:ua+1};a.a.instance.Sa(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",
Fa,Sa.Fq());return{returnValue:!1,index:0}},S=(Sa,ua)=>{let Fa;Fa=0;for(let Pa=0;Pa<Sa.length;Pa++)if(Sa.J(Pa).Cj.equals(ua))return Fa=Pa,{returnValue:!0,idx:Fa};a.a.instance.Sa(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",ua,Sa.Fq());return{returnValue:!1,idx:Fa}},W=(Sa,ua)=>{let Fa;Fa=-1;for(let Pa=ua;Pa<Sa.length;Pa++)if(2===Sa.J(Pa).type)return Fa=Pa,{returnValue:!0,vea:Fa};a.a.instance.Sa(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",
ua,Sa.Fq());return{returnValue:!1,vea:Fa}},X=(Sa,ua,Fa)=>{let Pa;Pa=-1;for(let Ea=Fa;Ea<Sa.length;Ea++)if(2===Sa.J(Ea).type&&Sa.J(Ea).Cj.equals(ua))return Pa=Ea,{returnValue:!0,vea:Pa};a.a.instance.Sa(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",ua,Fa,Sa.Fq());return{returnValue:!1,vea:Pa}},Y=(Sa,ua)=>{let Fa;Fa=0;var Pa;if(!({idx:Pa}=S(Sa,ua)).returnValue)return a.a.instance.Sa(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",
ua,Sa),{returnValue:!1,length:Fa};for(;Pa<Sa.length;Pa++)if(6!==Sa.J(Pa).type){if(2===Sa.J(Pa).type)return{returnValue:!0,length:Fa};a.a.instance.shipAssertTag(17342617,1,Sa.J(Pa).W2(),"We found something other than text with type "+Sa.J(Pa).type);a.a.instance.shipAssertTag(17877021,1,Sa.J(Pa).Cj.equals(ua),"Unexpected GraphNodeId {0} for ParaId {1}",Sa.J(Pa).Cj,ua);Fa+=Sa.J(Pa).length}a.a.instance.Sa(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",ua,Sa);return{returnValue:!1,
length:Fa}},ca=Sa=>{const ua=new h.a;for(let Fa=0;Fa<Sa.length;Fa++)ua.add(Sa.J(Fa).clone());return ua};var ha=c(1527),ra=c(1494);class sa{constructor(Sa,ua,Fa=null,Pa=null){this.Cj=Sa;this.type=ua;this.text=Fa;this.Nc=Pa}isEqual(Sa){return Sa.Cj.equals(this.Cj)&&this.type===Sa.type&&this.Nc===Sa.Nc&&ra.a.Xeh(this.text,Sa.text)}toString(){let Sa=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Cj,this.Nc,this.type);this.text&&(Sa+=String.format(" [TextLength: {0}]",this.text.length));
return Sa}}Object(C.a)(sa,"MergeBlockValidationState",null,[]);var oa=c(123),ka=c(928),ia=c(851),La=c(552),va=c(497),Ga=c(927),Oa=c(850),Za=c(1483),ja=c(1646),ba;(function(Sa){Sa[Sa.base=1]="base";Sa[Sa.favoredUpdate=2]="favoredUpdate";Sa[Sa.unfavoredUpdate=4]="unfavoredUpdate";Sa[Sa.min=1]="min";Sa[Sa.max=7]="max"})(ba||(ba={}));Object(C.b)("MergeBlockSource",ba);class qa{constructor(Sa,ua,Fa,Pa){this.Dg=Sa;this.cp=ua;this.Jsd=Fa;this.d4c=Pa}}Object(C.a)(qa,"MergedListBlocksWithUpdatedFormattingIds",
null,[]);var Ma=c(1524);class Ia extends Ma.a{constructor(Sa,ua){super(6,Sa,ua);this.Nc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Cj)}u2b(){return"Selection"}clone(){return new Ia(this.source,this.Cj)}Tz(){return!1}get length(){return 0}}Object(C.a)(Ia,"SelectionMergeBlock",Ma.a,[]);var wa;(function(Sa){Sa[Sa.success=0]="success";Sa[Sa.selfSplit=1]="selfSplit";Sa[Sa.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Sa[Sa.unexpected=3]="unexpected"})(wa||(wa=
{}));Object(C.b)("SplitTwinListResult",wa);var za=c(1563);class pa extends za.a{constructor(Sa,ua,Fa,Pa){super(5,Sa,ua);this._text=null;this.a0c(Fa);this.A_j=Pa}get text(){return this._text}a0c(Sa){this._text=Sa}get I3c(){return this.A_j}clone(){return new pa(this.source,this.Cj,this.text,this.I3c)}get N3a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(C.a)(pa,"UpdateHintTextMergeBlock",za.a,[]);class Ba{constructor(Sa,ua,Fa,Pa){this.e1=
!1;this.G9a=new v.a;this.ge=Sa;this.F5g=Pa;this.vyg=Fa;this._base=ua;this.fne=ca(ua);if(!J(this.base,this.Me))throw a.a.instance.Sa(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Sa.logger.Tg(Object.assign(new Za.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Me(){return this.fne}get mergeConflict(){return this.e1}YRe(Sa,ua){switch(Sa.type){case 1:return this.Cek(Sa,ua);case 2:return this.yRe(Sa,ua);case 3:return this.ufk(Sa,
ua);case 4:return this.Tek(Sa);case 5:return this.Tdk(Sa,ua);case 6:return this.wRe(Sa);default:return!1}}XRe(Sa,ua){switch(Sa.type){case 1:return this.CRe(Sa,ua);case 2:return this.xRe(Sa,ua);case 3:return this.tfk(Sa,ua);case 4:return this.Sek(Sa);case 5:return this.Sdk(Sa,ua);case 6:return this.vRe(Sa);default:return{returnValue:!1,Qt:null}}}Cek(Sa,ua){let Fa;const Pa=({hfa:Fa}=this.PEa(Sa.Dg,ua,!1,Sa.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Sa(590202197,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ba[ua],wa[Pa]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.e1=!1;ua=new pa(ua,Sa.Dg,Sa.text,Sa.id);this.qof(Sa,Fa,ua);return!0}yRe(Sa,ua){let Fa,Pa=({hfa:Fa}=this.PEa(Sa.Dg,ua,!1,Sa.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Sa(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",
ba[ua],wa[Pa]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Ea;({hfa:Ea,returnValue:Pa}=this.PEa(Sa.Dg,ua,!1,Sa.cp+Sa.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Sa(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ba[ua],wa[Pa]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),
!1;this.e1=!1;this.u3e(Sa,Fa,Ea);return!0}ufk(Sa,ua){let Fa;const Pa=({Emf:Fa}=this.UTh(Sa,ua,!1)).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Sa(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ba[ua],wa[Pa]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.e1=!1;ua=new L.a(ua,Sa.yt,Sa.zra);this.qof(Sa,Fa,ua);return!0}Tek(Sa){let ua;if(!({ULd:ua}=this.VTh(Sa,
this.Me,"Derived")).returnValue)return!1;this.u3e(Sa,ua,ua+1);return!0}Tdk(Sa,ua){let Fa;if(!({qAf:ua,Dmf:Fa}=this.GVh(Sa,!1,ua)).returnValue)return!1;this.qof(Sa,Fa,ua);return!0}wRe(Sa){let ua;if(!({TLd:ua}=this.LTh(Sa,this.Me,"Derived")).returnValue)return!1;this.u3e(Sa,ua,ua+1);return!0}feh(Sa,ua,Fa){const Pa=({hfa:ua}=this.PEa(Sa,Fa,!1,ua,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Pa&&1!==Pa)return 3!==Pa&&(a.a.instance.Sa(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",
ba[Fa],wa[Pa]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.e1=!1;Sa=new Ia(Fa,Sa);this.Me.insert(ua,Sa);return!0}CRe(Sa,ua){var Fa=null;if(Ba.Mdi(Sa.text.length))return{returnValue:!1,Qt:Fa};let Pa,Ea,lb;var zb=({hfa:Pa,Pta:Ea,bea:lb}=this.PEa(Sa.Dg,ua,!0,Sa.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==zb&&2!==zb)return 3!==zb&&(a.a.instance.Sa(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",
ba[ua],wa[zb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Qt:Fa};this.e1=!1;({vea:zb}=W(this.Me,Ea));zb=this.Me.J(zb).Cj;Fa=new pa(ua,Sa.Dg,Sa.text,Sa.id);ua=new pa(ua,zb,Sa.text,Sa.id);Fa.nm=ua;ua.nm=Fa;this.base.insert(Pa,Fa);this.Me.insert(Ea,ua);Fa=new h.a;Fa.add(new va.a(zb,lb,Sa.text,Sa.id,Sa.iu));return{returnValue:!0,Qt:Fa}}xRe(Sa,ua){let Fa;Fa=null;if(Ba.Mdi(Sa.text.length))return{returnValue:!1,Qt:Fa};let Pa;var Ea,
lb=({hfa:Pa,Pta:zb,bea:Ea}=this.PEa(Sa.Dg,ua,!0,Sa.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==lb){if(2!==lb)return 3!==lb&&(a.a.instance.Sa(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ba[ua],wa[lb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Qt:Fa};var zb=0;for({idx:Ea}=S(this.base,Sa.Dg);Ea<this.base.length&&zb<
Sa.cp;Ea++)zb+=this.base.J(Ea).length;zb-=this.base.J(Ea-1).length;({Pta:zb,bea:Ea,returnValue:lb}=this.PEa(Sa.Dg,ua,!0,zb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==lb)return 3!==lb&&(a.a.instance.Sa(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ba[ua],wa[lb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Qt:Fa};this.e1=
!1}var Xb,ub;({hfa:Xb,Pta:ub,bea:Pb,returnValue:lb}=this.PEa(Sa.Dg,ua,!0,Sa.cp+Sa.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==lb){if(2!==lb)return 3!==lb&&(a.a.instance.Sa(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ba[ua],wa[lb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Qt:Fa};var Pb=0;for({idx:ub}=S(this.base,Sa.Dg);ub<
this.base.length&&Pb<Sa.cp+Sa.text.length;ub++)Pb+=this.base.J(ub).length;({Pta:ub,bea:Pb,returnValue:lb}=this.PEa(Sa.Dg,ua,!0,Pb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==lb)return 3!==lb&&(a.a.instance.Sa(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ba[ua],wa[lb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Qt:Fa};this.e1=
!1}ua="";Fa=new h.a;for(--ub;ub>=zb;ub--)if(6!==this.Me.J(ub).type)if(this.Me.J(ub).nm)ua=this.Me.J(ub).text+ua,this.Me.nF(ub);else{if(5===this.Me.J(ub).type)lb=Pb-ua.length;else if(2===this.Me.J(ub).type){if(lb=0,!({length:Pb}=Y(this.Me,this.Me.J(ub).Cj)).returnValue)return a.a.instance.Sa(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Qt:Fa}}else return a.a.instance.Sa(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Qt:Fa};if(!({vea:yc}=W(this.Me,ub+1)).returnValue)return a.a.instance.Sa(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Qt:Fa};var yc=this.Me.J(yc).Cj;Fa.add(new La.DeleteTextUpdateHint(yc,
lb,ua));ua=""}for(--Xb;Xb>=Pa;Xb--)this.base.nF(Xb);if(!({vea:yc}=W(this.Me,zb)).returnValue)return a.a.instance.Sa(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Qt:Fa};yc=this.Me.J(yc).Cj;ua&&ua.length&&Fa.add(new La.DeleteTextUpdateHint(yc,Ea,ua,Sa.id,Sa.iu));return{returnValue:!0,Qt:Fa}}tfk(Sa,ua){var Fa=null;let Pa,Ea,lb;var zb=({Emf:Pa,V7h:Ea,bea:lb}=
this.UTh(Sa,ua,!0)).returnValue;if(0!==zb)return 3!==zb&&(a.a.instance.Sa(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ba[ua],wa[zb]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Qt:Fa};var Xb;if(!({vea:Xb}=W(this.Me,Ea)).returnValue)return a.a.instance.Sa(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,Qt:Fa};zb=this.Me.J(Xb).Cj;const ub=this.Me.J(Xb).Nc;let Pb,yc,bc;({yt:Xb,K5:Pb,zra:yc,R9:bc}=this.XBl(Sa,Xb));this.ymh(this.Me,Xb,Pb,bc,Ea);Fa=new L.a(ua,Sa.yt,Sa.zra);ua=new L.a(ua,Xb,yc);Fa.nm=ua;ua.nm=Fa;this.base.insert(Pa,Fa);this.Me.insert(Ea,ua);Fa=new h.a;Fa.add(new Oa.a(zb,ub,lb,Xb,yc,Pb,bc,Sa.id,Sa.iu));return{returnValue:!0,Qt:Fa}}Sek(Sa){let ua;ua=null;let Fa,Pa;var Ea;if(!({ULd:Fa}=this.VTh(Sa,this.base,"Base")).returnValue)return{returnValue:!1,Qt:ua};if(!this.base.J(Fa).nm||
!({vea:Pa}=X(this.Me,this.base.J(Fa).nm.Cj,0)).returnValue)return a.a.instance.Sa(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.e1=!0,{returnValue:!1,Qt:ua};if(!({vea:Ea}=W(this.Me,Pa+1)).returnValue)return a.a.instance.Sa(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.e1=!0,{returnValue:!1,Qt:ua};let lb,zb,Xb,ub,Pb,yc;({R0a:Ea,S0a:Xb,fEf:lb,ENm:ub,mNm:zb,nNm:Pb}=this.jql(Sa,Pa,Ea));if(!({length:yc}=Y(this.Me,Ea)).returnValue)return{returnValue:!1,Qt:ua};this.xmh(this.Me,Ea,Xb,Pa);this.Me.nF(Pa);this.base.nF(Fa);ua=new h.a;ua.add(new Ga.MergeParagraphUpdateHint(lb,ub,yc,zb,Pb,Ea,Xb,Sa.id,Sa.iu));return{returnValue:!0,Qt:ua}}Sdk(Sa,ua){var Fa=null;let Pa,Ea,lb;
if(!({qAf:lb,Dmf:Pa}=this.GVh(Sa,!0,ua)).returnValue)return{returnValue:!1,Qt:Fa};if(!({lfb:Ea}=this.HIc(this.base,this.Me,Pa,!0)).returnValue)return a.a.instance.Sa(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,Qt:Fa};if(0<Ea&&2!==this.Me.J(Ea-1).type)return a.a.instance.Sa(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.ge.logger.Tg(Object.assign(new ja.a,
{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.e1=!0,{returnValue:!1,Qt:Fa};let zb;if(!({yt:zb}=this.SMh(Ea)).returnValue)return{returnValue:!1,Qt:Fa};ua=new L.a(ua,Sa.Dg,Sa.Nc);Fa=lb;Fa.nm=ua;ua.nm=Fa;this.base.insert(Pa,lb);this.Me.insert(Ea,ua);Fa=new h.a;Fa.add(new ka.AddParagraphUpdateHint(Sa.Dg,Sa.Nc,zb,Sa.id,Sa.iu));return{returnValue:!0,Qt:Fa}}vRe(Sa){let ua;ua=null;let Fa;var Pa;if(!({TLd:Pa}=this.LTh(Sa,this.base,"Base")).returnValue)return{returnValue:!1,Qt:ua};if(!this.base.J(Pa).nm||
!this.base.J(Pa).nm.Cj.equals(Sa.Dg))return a.a.instance.Sa(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.e1=!0,{returnValue:!1,Qt:ua};if(!({lfb:Fa}=this.HIc(this.base,this.Me,Pa,!0)).returnValue)return a.a.instance.Sa(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,Qt:ua};if(0<Fa&&2!==this.Me.J(Fa).type)return a.a.instance.Sa(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.e1=!0,{returnValue:!1,Qt:ua};const Ea=this.Me.J(Fa).Cj,lb=this.Me.J(Fa).Nc;this.Me.nF(Fa);this.base.nF(Pa);({yt:Pa}=this.SMh(Fa));0<Fa&&6===this.Me.J(Fa-1).type&&this.R8m(Fa-1,Pa);ua=new h.a;ua.add(new ia.a(Ea,lb,Pa,Sa.id,
Sa.iu));return{returnValue:!0,Qt:ua}}eeh(Sa,ua,Fa){let Pa;var Ea=({hfa:ua,Pta:Pa}=this.PEa(Sa,Fa,!0,ua,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Ea)return 3!==Ea&&(a.a.instance.Sa(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ba[Fa],wa[Ea]),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({vea:Ea}=W(this.Me,Pa));Ea=this.Me.J(Ea).Cj;
Sa=new Ia(Fa,Sa);Fa=new Ia(Fa,Ea);Sa.nm=Fa;Fa.nm=Sa;this.base.insert(ua,Sa);this.Me.insert(Pa,Fa);return!0}jql(Sa,ua,Fa){let Pa,Ea,lb;Pa=Sa.R0a.equals(Sa.Dg)?this.Me.J(ua).Cj:this.Me.J(Fa).Cj;Sa=Sa.S0a===Sa.Nc?this.Me.J(ua).Nc:this.Me.J(Fa).Nc;Ea=this.Me.J(ua).Cj;ua=this.Me.J(ua).Nc;lb=this.Me.J(Fa).Cj;Fa=this.Me.J(Fa).Nc;return{R0a:Pa,S0a:Sa,fEf:Ea,ENm:ua,mNm:lb,nNm:Fa}}XBl(Sa,ua){let Fa;var Pa=Sa.Dg.equals(Sa.yt)?Sa.K5:Sa.yt;const Ea=Sa.Nc===Sa.zra?Sa.R9:Sa.zra;Sa.Dg.equals(Sa.yt)?Fa=this.Me.J(ua).Cj:
(Fa=Pa,Pa=this.Me.J(ua).Cj);Sa.Nc===Sa.zra?(Sa=this.Me.J(ua).Nc,ua=Ea):(Sa=Ea,ua=this.Me.J(ua).Nc);return{yt:Fa,K5:Pa,zra:Sa,R9:ua}}zmh(Sa,ua,Fa,Pa){for(;Pa<Sa.length;Pa++){if(!Sa.J(Pa).W2()&&6!==Sa.J(Pa).type&&2!==Sa.J(Pa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Sa.J(Pa).type);break}Sa.J(Pa).Cj=ua;if(2===Sa.J(Pa).type){Sa.J(Pa).Nc=Fa;break}}}ymh(Sa,ua,Fa,Pa,Ea){this.zmh(Sa,Fa,Pa,Ea);Ba.Amh(Sa,ua,Ea)}xmh(Sa,ua,Fa,Pa){this.zmh(Sa,ua,Fa,Pa+1);Ba.Amh(Sa,ua,Pa)}VTh(Sa,
ua,Fa){let Pa,Ea=-1;if(!({vea:Pa}=X(ua,Sa.Dg,0)).returnValue)return a.a.instance.Sa(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Fa+"for GraphNodeId "+Sa.Dg),{returnValue:!1,ULd:Pa};if(!({vea:Ea}=W(ua,Pa+1)).returnValue||!ua.J(Ea).Cj.equals(Sa.K5))return a.a.instance.Sa(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Pa+1+" in "+Fa+" of length "+ua.length),{returnValue:!1,ULd:Pa};this.xmh(ua,Sa.R0a,Sa.S0a,Pa);return{returnValue:!0,ULd:Pa}}UTh(Sa,ua,Fa){let Pa;
const Ea=Fa?this.base:this.Me,lb=Fa?"Base":"Derived",zb=({hfa:ua,Pta:Fa,bea:Pa}=this.PEa(Sa.Dg,ua,Fa,Sa.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===zb||2===zb)return a.a.instance.Sa(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+lb),{returnValue:zb,Emf:ua,V7h:Fa,bea:Pa};this.ymh(Ea,Sa.yt,Sa.K5,Sa.R9,ua);return{returnValue:zb,Emf:ua,V7h:Fa,bea:Pa}}LTh(Sa,ua,Fa){return({idx:Sa}=S(ua,Sa.Dg)).returnValue?2!==ua.J(Sa).type?(a.a.instance.Sa(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
Fa),{returnValue:!1,TLd:-1}):{returnValue:!0,TLd:Sa}:(a.a.instance.Sa(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Fa),{returnValue:!1,TLd:-1})}R8m(Sa,ua){var Fa=this.Me.J(Sa);if(ua){let Pa;({vea:Pa}=X(this.Me,ua,0));Fa=Fa.clone();Fa.Cj=ua;this.Me.nF(Sa);this.Me.insert(Pa,Fa)}else this.Me.length>Sa&&(this.Me.J(Sa+1).W2()||2===this.Me.J(Sa+1).type)&&(Fa.Cj=this.Me.J(Sa+1).Cj)}GVh(Sa,ua,Fa){var Pa=ua?this.base:this.Me;ua=ua?"Base":"Derived";Fa=new L.a(Fa,Sa.Dg,Sa.Nc);if(Sa.yt){if(!({vea:Pa}=
X(Pa,Sa.yt,0)).returnValue)return a.a.instance.Sa(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Sa.yt,ua),{returnValue:!1,qAf:Fa,Dmf:Pa};Pa+=1}else Pa=0;return{returnValue:!0,qAf:Fa,Dmf:Pa}}SMh(Sa){let ua;ua=null;let Fa=Sa-1;if(-1===Fa)return{returnValue:!0,yt:ua};6===this.Me.J(Fa).type&&Fa--;if(2===this.Me.J(Fa).type||4===this.Me.J(Fa).type)return ua=this.Me.J(Fa).Cj,{returnValue:!0,yt:ua};a.a.instance.Sa(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Me.J(Sa-1).type);return{returnValue:!1,yt:ua}}HIc(Sa,ua,Fa,Pa){let Ea,lb=!0;Ea=-1;if(Fa>Sa.length)return a.a.instance.Sa(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,lfb:Ea};if(Fa<Sa.length){if(-1<Fa&&Fa<Sa.length&&!Sa.J(Fa).nm){lb=!1;for(var zb=Fa+1;zb<Sa.length;zb++)if(Sa.J(zb).nm){Fa=zb;lb=!0;break}}if(!lb)return{returnValue:!1,lfb:Ea};lb=!1;for(zb=0;Sa.J(Fa)&&zb<ua.length;zb++)if(ua.J(zb).nm===Sa.J(Fa)){Ea=zb;lb=!0;break}if(!lb)return{returnValue:!1,
lfb:Ea}}else Ea=ua.length;if(0<Ea&&Pa&&!ua.J(Ea-1).nm){for(Sa=Ea-1;0<=Sa&&!ua.J(Sa).nm;Sa--);Ea=Sa+1;6===ua.J(Ea).type&&5!==this.ge.input.source&&Ea++}return{returnValue:!0,lfb:Ea}}PEa(Sa,ua,Fa,Pa,Ea,lb){let zb;var Xb;let ub;var Pb=this.base;let yc=this.Me,bc=!1;Fa||(Pb=this.Me,yc=this.base);ub=Xb=zb=0;let Ka,Bb,tb=0;if(!({sKc:Pa,Xhb:Ka,ASc:Bb}=I(Pb,Sa,Pa)).returnValue)return a.a.instance.Sa(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,hfa:zb,Pta:Xb,bea:ub};0<=Pa&&Pa<Pb.length&&!Pb.J(Pa).nm&&Ka&&!Ea&&(a.a.instance.Sa(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",lb),this.e1=!0,tb=ua===Pb.J(Pa).source?1:2,bc=!0);Ea&&!Pb.J(Pa)&&Pa--;Ea&&Ka&&!Pb.J(Pa).nm&&(Ka=!1,Bb=0);if(!Fa&&!({idx:Sa}=S(yc,Sa)).returnValue&&!Ka)return{returnValue:0,hfa:Pa,Pta:Xb,bea:ub};if(!({lfb:Sa}=this.HIc(Pb,yc,Pa,Fa&&!Ka)).returnValue&&!bc&&(ua=
!1,1===this.F5g&&0<Pa&&!Bb&&(Pa--,{lfb:Sa,returnValue:ua}=this.HIc(Pb,yc,Pa,Fa&&!Ka),ua&&(Pa++,Sa<yc.length-1?Sa++:ua=!1)),!ua))return a.a.instance.Sa(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.ge.logger.Tg(Object.assign(new ja.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.e1=!0,{returnValue:3,hfa:zb,Pta:Xb,bea:ub};if(Ka&&(!N(Pb,Pa,Bb)||!bc&&!N(yc,Sa,Bb)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,hfa:zb,Pta:Xb,bea:ub};zb=Pa;Xb=Sa;Ka&&(zb=Pa+1,bc||(Xb=Pb.J(Pa),Fa=yc.J(Sa),Xb.nm=Fa,Fa.nm=Xb,Pb=Pb.J(Pa+1),Xb=yc.J(Sa+1),Pb.nm=Xb,Xb.nm=Pb,Xb=Sa+1));if(Xb>=yc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Xb+" secondaryList length was "+yc.length),{returnValue:3,hfa:zb,Pta:Xb,bea:ub};
for(Pb=0;Pb<Xb;Pb++)yc.J(Pb).Cj.equals(yc.J(Xb).Cj)&&(ub+=yc.J(Pb).length);return{returnValue:tb,hfa:zb,Pta:Xb,bea:ub}}u3e(Sa,ua,Fa){this.vyg.contains(Sa.id)&&this.G9a.Z(Sa.id,new h.a);for(--Fa;Fa>=ua;Fa--)this.vyg.contains(Sa.id)?this.G9a.J(Sa.id).insert(this.G9a.J(Sa.id).length,this.Me.J(Fa)):this.Me.J(Fa).nm&&(this.Me.J(Fa).nm.nm=null),this.Me.nF(Fa)}qof(Sa,ua,Fa){if(this.G9a.ub(Sa.iu)){const Pa=this.G9a.J(Sa.iu);for(let Ea=0;Ea<Pa.length;Ea++)Pa.J(Ea).Cj=Fa.Cj,Object(oa.a)(L.a,Fa)&&Object(oa.a)(L.a,
Pa.J(Ea))&&(Pa.J(Ea).Nc=Fa.Nc);this.Me.IA(ua,this.G9a.J(Sa.iu));this.G9a.remove(Sa.iu)}else this.Me.insert(ua,Fa)}sPl(Sa){let ua,Fa;Fa=ua=-1;if(!Sa.nm)return{returnValue:!1,m0b:ua,Q3e:Fa};var Pa;let Ea=0,lb=!1;if(!({idx:Pa}=S(this.Me,Sa.nm.Cj)).returnValue)return{returnValue:!1,m0b:ua,Q3e:Fa};for(;Pa<this.Me.length;Pa++){if(Sa.nm===this.Me.J(Pa)){ua=Pa;Fa=Ea;lb=!0;break}Ea+=this.Me.J(Pa).length}return{returnValue:lb,m0b:ua,Q3e:Fa}}M9e(Sa){let ua;ua=new h.a;let Fa=0,Pa=0;for(;Fa<Sa.length;){if(Pa>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,vhc:ua};if(Sa.J(Fa).length>this.base.J(Pa).length){if(!N(Sa,Fa,this.base.J(Pa).length))return a.a.instance.Sa(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Fa,this.base.J(Pa).length),{returnValue:!1,vhc:ua}}else if(Sa.J(Fa).length<this.base.J(Pa).length){var Ea=
!!this.base.J(Pa).nm,lb=0;if(Ea&&!({lfb:lb}=this.HIc(this.base,this.Me,Pa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Pa),{returnValue:!1,vhc:ua};if(!N(this.base,Pa,Sa.J(Fa).length)||Ea&&!N(this.Me,lb,Sa.J(Fa).length))return a.a.instance.Sa(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,vhc:ua};if(Ea){Ea=this.base.J(Pa);var zb=this.Me.J(lb);Ea.nm=zb;zb.nm=Ea;Ea=this.base.J(Pa+1);lb=this.Me.J(lb+1);Ea.nm=lb;lb.nm=Ea}}if(this.base.J(Pa).nm&&5!==this.base.J(Pa).type&&this.base.J(Pa).W2()&&(lb=this.base.J(Pa),Ea=Sa.J(Fa),!lb.uI.equals(Ea.uI)||!lb.wE.Tz(Ea.wE))){let Xb;if(!({m0b:zb,Q3e:Xb}=this.sPl(this.base.J(Pa))).returnValue)return{returnValue:!1,vhc:ua};ua.add(new qa(this.Me.J(zb).Cj,Xb,lb,Ea))}Fa++;Pa++}return{returnValue:!0,vhc:ua}}static Amh(Sa,ua,Fa){for(--Fa;0<=
Fa;Fa--){if(!Sa.J(Fa).W2()&&6!==Sa.J(Fa).type){a.a.instance.shipAssertTag(17311187,1,2===Sa.J(Fa).type||4===Sa.J(Fa).type,"Found merge block of type "+Sa.J(Fa).type);break}Sa.J(Fa).Cj=ua}}static Mdi(Sa){return Sa?!1:(a.a.instance.Sa(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(C.a)(Ba,"ParagraphMergeUsingHintsTwinList",null,[1894]);var Ra=c(1644),fb=c(1645),Va=c(1641),ib=c(1643),Xa=c(1642);class qb{constructor(Sa,ua,
Fa,Pa){this.cp=Sa;this.length=ua;this.Jsd=Fa;this.d4c=Pa}}Object(C.a)(qb,"UpdateFormattingIdsPosInfo",null,[]);class rb{constructor(Sa,ua,Fa){this.e1=!1;this.G9a=new v.a;this.ge=Sa;this.F5g=Fa;this._base=ua;this.fne=ca(ua);if(!J(this.base,this.Me))throw a.a.instance.Sa(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Sa.logger.Tg(Object.assign(new F.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Me(){return this.fne}get mergeConflict(){return this.e1}YRe(Sa,
ua){switch(Sa.type){case 11:return this.Aek(Sa,ua);case 8:return this.yRe(Sa,ua);case 10:return this.wRe(Sa);default:return!1}}XRe(Sa,ua){switch(Sa.type){case 11:return this.zek(Sa,ua);case 8:return this.xRe(Sa,ua);case 10:return this.vRe(Sa);default:return{returnValue:!1,Qt:null}}}feh(){a.a.instance.Sa(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}eeh(){a.a.instance.Sa(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}M9e(Sa){let ua;ua=new h.a;let Fa=0,Pa=0,Ea=0;for(;Fa<Sa.length;){if(Pa>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,c4c:ua};if(Sa.J(Fa).length>this.base.J(Pa).length){if(!N(Sa,Fa,this.base.J(Pa).length))return a.a.instance.Sa(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,c4c:ua}}else if(Sa.J(Fa).length<this.base.J(Pa).length&&!this.D3a(Ea+Sa.J(Fa).length,!0).returnValue)return a.a.instance.Sa(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,c4c:ua};if(this.base.J(Pa).nm&&5!==this.base.J(Pa).type&&this.base.J(Pa).W2()){const lb=this.base.J(Pa),zb=Sa.J(Fa);if(!lb.uI.equals(zb.uI)||!lb.wE.Tz(zb.wE)){let Xb,ub;if(({m0b:Xb,eAh:ub}=this.tPl(this.base.J(Pa))).returnValue)ua.add(new qb(ub,this.Me.J(Xb).length,lb,zb));else return a.a.instance.Sa(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,c4c:ua}}}Ea+=this.base.J(Pa).length;Fa++;Pa++}return{returnValue:!0,c4c:ua}}Aek(Sa,ua){let Fa;if(!({IAa:Fa}=this.D3a(Sa.cp,!0)).returnValue)return a.a.instance.Sa(574433300,1,2,"ApplyInsertTextHintToDerived"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Ea=0;Ea<Sa.FZ.length;Ea++)switch(Sa.FZ.J(Ea).type){case 7:var Pa=Sa.FZ.J(Ea);this.Me.insert(Fa,new pa(ua,null,Pa.text,Pa.id));break;case 9:Pa=Sa.FZ.J(Ea);this.Me.insert(Fa,new L.a(ua,Pa.Dg,Pa.Nc));break;default:return a.a.instance.Sa(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}yRe(Sa,ua){let Fa,Pa;if(!({IAa:Fa}=this.D3a(Sa.cp,!0)).returnValue||!({IAa:Pa}=this.D3a(Sa.cp+
Sa.text.length,!1)).returnValue)return a.a.instance.Sa(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Sa=Pa;Sa>=Fa;Sa--)this.Me.J(Sa).source!==ua&&this.czd(this.Me,Sa);return!0}wRe(Sa){let ua;if(!({IAa:ua}=this.D3a(Sa.cp,!0)).returnValue)return a.a.instance.Sa(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.y3e(this.Me,Sa,ua);return!0}zek(Sa,ua){let Fa;Fa=null;let Pa,Ea;if(!({jwb:Pa,IAa:Ea}=this.D3a(Sa.cp,!0)).returnValue)return a.a.instance.Sa(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Qt:Fa};var lb=this.mdf(this.Me,Ea-1);lb=new Xa.a(lb);for(let zb=0;zb<Sa.FZ.length;zb++)switch(Sa.FZ.J(zb).type){case 7:lb.FZ.add(this.CRe(Sa.FZ.J(zb),ua,Pa,Ea));break;
case 9:lb.FZ.add(this.Bek(Sa.FZ.J(zb),ua,Pa,Ea));break;default:return a.a.instance.Sa(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Qt:Fa}}Fa=new h.a;Fa.add(lb);return{returnValue:!0,Qt:Fa}}CRe(Sa,ua,Fa,Pa){const Ea=new pa(ua,Sa.Dg,Sa.text,Sa.id);ua=new pa(ua,Sa.Dg,Sa.text,Sa.id);Ea.nm=ua;ua.nm=Ea;this.base.insert(Fa,Ea);this.Me.insert(Pa,ua);Fa=new ib.a(Sa.Dg,Sa.text);Fa.id=Sa.id;return Fa}Bek(Sa,
ua,Fa,Pa){const Ea=new L.a(ua,Sa.Dg,Sa.Nc);ua=new L.a(ua,Sa.Dg,Sa.Nc);Ea.nm=ua;ua.nm=Ea;this.base.insert(Fa,Ea);this.Me.insert(Pa,ua);return new Va.a(Sa.Dg,Sa.Nc)}xRe(Sa){let ua;ua=new h.a;let Fa;var Pa;let Ea;if(!({jwb:Fa,IAa:Pa}=this.D3a(Sa.cp,!0)).returnValue||!({jwb:Ea,IAa:lb}=this.D3a(Sa.cp+Sa.text.length,!1)).returnValue)return a.a.instance.Sa(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,Qt:ua};for(Sa=lb;Sa>=Pa;Sa--)if(this.Me.J(Sa).nm){var lb=Sa;ua.add(({vNm:Sa}=this.R$k(Sa,Pa)).returnValue);this.czd(this.Me,Sa,lb)}for(Pa=Ea;Pa>=Fa;Pa--)this.czd(this.base,Pa);return{returnValue:!0,Qt:ua}}vRe(Sa){let ua;ua=null;let Fa,Pa;if(!({jwb:Fa,IAa:Pa}=this.D3a(Sa.cp,!0)).returnValue)return a.a.instance.Sa(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Qt:ua};
if(!this.y3e(this.base,Sa,Fa))return a.a.instance.Sa(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Qt:ua};this.y3e(this.Me,Sa,Pa)&&(ua=new h.a,ua.add(new Ra.a(this.mdf(this.Me,Pa-1),Sa.Dg,Sa.Nc)));return{returnValue:!0,Qt:ua}}D3a(Sa,ua){var Fa;var Pa=Fa=-1;let Ea,lb;if(!({Xhb:lb,Vgh:Sa,Ugh:Ea}=K(this.base,Sa,this.ge.logger)).returnValue)return{returnValue:!1,jwb:Fa,
IAa:Pa};const zb=Sa>=this.base.length;zb&&Sa--;if(this.base.J(Sa).nm){const Xb=this.obl(this.Me,this.base.J(Sa));if(lb){if(0>Xb||!N(this.base,Sa,Ea)||!N(this.Me,Xb,Ea))return a.a.instance.Sa(575706444,1,2,"SplitTwinListAndFindIdx"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,jwb:Fa,IAa:Pa};Fa=this.base.J(Sa);Pa=this.Me.J(Xb);Fa.nm=Pa;Pa.nm=Fa;Fa=this.base.J(Sa+1);Pa=this.Me.J(Xb+1);Fa.nm=Pa;Pa.nm=Fa;Fa=ua?Sa+1:Sa;Pa=ua?Xb+1:Xb}else ua?(Fa=
zb?Sa+1:Sa,Pa=zb?Xb+1:Xb):(Fa=zb?Sa:Sa-1,Pa=zb?Xb:Xb-1)}else if(lb){if(N(this.base,Sa,Ea))Fa=ua?Sa+1:Sa;else return a.a.instance.Sa(575706445,1,2,"SplitTwinListAndFindIdx"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,jwb:Fa,IAa:Pa};ua?(Pa=({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!1)).returnValue?Pa+1:0,Pa=Pa>=this.Me.length?this.Me.length-1:Pa):(Pa=({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!0)).returnValue?Pa-1:this.Me.length-1,Pa=0>Pa?0:Pa)}else ua?
(({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!0)).returnValue||(({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!1)).returnValue?Pa+=1:(Pa=zb?this.Me.length-1:0,Pa=0>Pa?0:Pa)),Fa=zb?Sa+1:Sa):(({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!1)).returnValue||(({uCb:Pa}=this.J1b(this.base,this.Me,Sa,!0)).returnValue?--Pa:(Pa=Sa?this.Me.length-1:0,Pa=0>Pa?0:Pa)),Fa=zb?Sa:Sa-1);return{returnValue:!0,jwb:Fa,IAa:Pa}}J1b(Sa,ua,Fa,Pa){let Ea=null;if(Pa)for(;Fa<Sa.length;Fa++){if(Sa.J(Fa).nm){Ea=Sa.J(Fa).nm;break}}else for(;0<=
Fa;Fa--)if(Sa.J(Fa).nm){Ea=Sa.J(Fa).nm;break}if(Ea)for(Sa=0;Sa<ua.length;Sa++)if(ua.J(Sa)===Ea)return ua=Sa,{returnValue:!0,uCb:ua};return{returnValue:!1,uCb:-1}}obl(Sa,ua){for(let Fa=0;Fa<Sa.length;Fa++)if(Sa.J(Fa).nm===ua)return Fa;return-1}czd(Sa,ua,Fa=-1){for(Fa=0>Fa?ua:Fa;Fa>=ua;Fa--)Sa.J(Fa).nm&&(Sa.J(Fa).nm.nm=null),Sa.nF(Fa)}mdf(Sa,ua){let Fa=0;for(;0<=ua;ua--)Fa+=Sa.J(ua).length;return Fa}MNl(Sa){Sa=Object(u.a)(za.a,Sa);Sa||(a.a.instance.Sa(575706448,1,2,"GetTextBlock"),this.ge.logger.Tg(Object.assign(new F.a,
{kj:"GetTextBlock",eventId:"8ujvq"})));return Sa}R$k(Sa,ua){let Fa="";for(;Sa>=ua&&this.Me.J(Sa).nm&&2!==this.Me.J(Sa).type;)Fa=this.MNl(this.Me.J(Sa)).text+Fa,Sa--;ua=0>Sa?0:this.mdf(this.Me,Sa);Sa+=1;return{returnValue:new fb.a(ua,Fa),vNm:Sa}}tPl(Sa){let ua,Fa,Pa=!1;Fa=ua=0;if(!Sa.nm)return{returnValue:!1,m0b:ua,eAh:Fa};for(ua=0;ua<this.Me.length;ua++){if(this.Me.J(ua).nm===Sa){Pa=!0;break}Fa+=this.Me.J(ua).length}return{returnValue:Pa,m0b:ua,eAh:Fa}}y3e(Sa,ua,Fa){Fa=Fa===Sa.length?--Fa:Fa;Fa>Sa.length-
1&&(a.a.instance.Sa(571757957,1,2,"DeleteEopInList: Idx out of range"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Sa.J(Fa).type){const Pa=Sa.J(Fa);if(Pa.Cj!==ua.Dg||Pa.Nc!==ua.Nc)return!1;this.czd(Sa,Fa);return!0}return!1}}Object(C.a)(rb,"ParagraphMergeUsingHintsTwinListLcs",null,[1894]);var nb=c(1513),Tb=c(1484),Zb=c(1640);c.d(O,"a",function(){return Hb});class Hb{constructor(Sa,ua,Fa,Pa,Ea,lb,zb=null,Xb=null,ub=null){this.dP=this.rra=this.fHa=this.rpa=
null;this._initialized=!1;this.ge=Sa;this.EE=ua;this.dza=Pa;this.Txa=Fa;this.Vpa=Ea;this.Vie=new e.a;for(Sa=0;Sa<this.EE.length;Sa++)this.Vie.add(this.EE.J(Sa).id);this.kFg=new e.a;for(Sa=0;Sa<this.Txa.length;Sa++)this.kFg.add(this.Txa.J(Sa).id);this.s5g=new e.a;for(Sa=0;Sa<this.dza.length;Sa++)this.s5g.add(this.dza.J(Sa).id);this.Pg=lb;this.XLe=zb||H.a.instance;this.JH=Xb;this.MV=ub;this.brb=1===(this.JH&&this.MV&&1===this.JH.DFa&&1===this.MV.DFa?1:0);this.Upa=0}get wVf(){return 1!==this.Upa}l6l(){var Sa=
!0;if(this.JH&&this.MV)return Sa;if(this.JH||this.MV)return a.a.instance.Sa(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.ge.runtime.du.ub(A.a.KK)&&(Sa=this.ge.runtime.du.J(A.a.KK),Sa=this.T$f(Sa,this.ge.runtime.dAa.id,"favored")&&({updateHints:this.JH}=this.G9h(Sa,this.Vie,this.kFg,this.ge.runtime.du,"favored")).returnValue);Sa&&this.ge.runtime.nq.ub(A.a.KK)&&
(Sa=this.ge.runtime.nq.J(A.a.KK),Sa=this.T$f(Sa,this.ge.runtime.dAa.id,"unfavored")&&({updateHints:this.MV}=this.G9h(Sa,this.Vie,this.s5g,this.ge.runtime.nq,"unfavored")).returnValue);this.JH=this.JH?this.JH:new Zb.a(new h.a,0);this.MV=this.MV?this.MV:new Zb.a(new h.a,0);Sa&&this.ge.input.l5b&&(Sa=this.ge.input.U3.last().RYa(A.a.KK),Sa=this.T$f(Sa,this.ge.input.U3.last().N1.id,"alreadyMerged"));return Sa}v4l(){const Sa=new e.a;if(this.brb)return Sa;const ua=this.JH?this.JH.updateHints.L3():new h.a;
let Fa=0;for(;Fa<ua.length-1;){const Pa=ua.J(Fa);let Ea,lb=!1;for(Ea=Fa+1;Ea<ua.length;Ea++){const zb=ua.J(Ea);if(Pa.lfi(zb)){Sa.add(Pa.id);ua.nF(Ea);ua.nF(Fa);lb=!0;break}}lb||Fa++}return Sa}T$f(Sa,ua,Fa){Sa=this.Pg.getPropertyString(Sa,l.a.TQa);Sa=m.a.Pf(Sa);return ua.equals(Sa)?!0:(this.w_c(2),a.a.instance.Sa(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.ge.runtime.dAa.id,
Sa,Fa),!1)}G9h(Sa,ua,Fa,Pa,Ea){let lb;lb=new Zb.a(new h.a,0);Sa=this.Pg.getPropertyObjectIds(Sa,l.a.c0).L3();for(let Xb=0;Xb<Sa.length;Xb++){if(!Pa.ub(Sa.J(Xb)))return a.a.instance.Sa(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Sa.J(Xb),Ea),{returnValue:!1,updateHints:lb};const ub=Pa.J(Sa.J(Xb));var zb=m.a.Pf(this.Pg.getPropertyString(ub,l.a.Gha));if(ua.contains(zb)||Fa.contains(zb)){zb=this.XLe.bKc(ub);
if(!zb)return a.a.instance.Sa(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",ub.id,Ea),{returnValue:!1,updateHints:lb};lb.updateHints.add(zb)}}0<Sa.length&&a.a.instance.Sa(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Ea,Sa.Fq(),lb.updateHints.Fq());return{returnValue:!0,updateHints:lb}}x5l(){return({TJ:this.rpa,
bGc:this.fHa,v3c:this.rra}=nb.a.Gvh(this.ge,this.Pg,this.EE,this.Txa,this.dza,this.Vpa,!0,!0)).returnValue?!0:!1}i6l(Sa){const ua=nb.a.Pxd(this.Pg,Fa=>this.ge.runtime.lk.J(Fa),this.EE,1,this.Vpa,!0,!0).returnValue;if(!ua)return a.a.instance.Sa(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.dP=this.brb?new rb(this.ge,ua,1):new Ba(this.ge,ua,Sa,this.JH?this.JH.DFa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.l6l()||!this.x5l())return!1;const Sa=this.v4l();return this.i6l(Sa)?!0:!1}IVh(Sa){const ua=new h.a;let Fa="";for(let Pa=0;Pa<Sa.length;Pa++){const Ea=Sa.J(Pa);Ea.W2()?Fa+=Sa.J(Pa).text:2===Ea.type?(ua.add(new sa(Ea.Cj,Ea.type,Fa,Ea.Nc)),Fa=""):4===Ea.type&&(ua.add(new sa(Ea.Cj,Ea.type)),Fa="")}return ua}validateUpdateHintsAreComplete(Sa,ua,Fa){ua=this.IVh(ua);Sa=this.IVh(Sa);let Pa=ua.length===Sa.length;if(Pa)for(let Ea=0;Ea<ua.length;Ea++)if(!ua.J(Ea).isEqual(Sa.J(Ea))){Pa=!1;break}Pa||
(this.w_c(4),a.a.instance.Sa(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Fa,Sa.Fq(),ua.Fq()));return Pa}Leh(Sa,ua,Fa){(ua=({B4a:Sa}=this.Zfk(Sa,ua,Fa)).returnValue)||this.w_c(this.dP.mergeConflict?1:3);return{returnValue:ua,B4a:Sa}}Zfk(Sa,ua,Fa){let Pa;Pa=new h.a;let Ea=!0;var lb=0;let zb=null,Xb=this.JH?this.JH.updateHints.length:0;for(var ub=0;ub<Xb&&Ea;ub++)zb=this.JH.updateHints.J(ub),
lb<this.MV.updateHints.length&&zb.id.equals(this.MV.updateHints.J(lb).id)&&5!==this.ge.input.source?({returnValue:Ea}=this.dP.XRe(zb,2),lb++):Ea=this.dP.YRe(zb,2);if(!Ea)return a.a.instance.Sa(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",zb.toString()),{returnValue:!1,B4a:Pa};if(!this.validateUpdateHintsAreComplete(this.dP.Me,this.fHa,"Favored"))return{returnValue:!1,B4a:Pa};if(Sa&&1===this.ge.input.c3&&!this.dP.feh(ua,Fa,2))return a.a.instance.Sa(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
ua,Fa),{returnValue:!1,B4a:Pa};Ea=!0;ub=new h.a;for(Xb=this.MV?this.MV.updateHints.length:0;lb<Xb&&Ea;lb++){zb=this.MV.updateHints.J(lb);let Pb;({Qt:Pb,returnValue:Ea}=this.dP.XRe(zb,4));Ea&&Pb&&ub.IA(ub.length,Pb)}return Ea?this.validateUpdateHintsAreComplete(this.dP.base,this.rra,"Unfavored")?Sa&&2===this.ge.input.c3&&!this.dP.eeh(ua,Fa,4)?(a.a.instance.Sa(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",ua,Fa),{returnValue:!1,B4a:Pa}):{returnValue:!0,
B4a:ub}:{returnValue:!1,B4a:Pa}:(a.a.instance.Sa(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",zb.id,zb.type),{returnValue:!1,B4a:Pa})}JAl(){let Sa,ua=0;let Fa=0,Pa=m.a.nil;for(Sa=new v.a;Fa<this.dP.base.length;){const zb=this.dP.base.J(Fa);Pa.equals(zb.Cj)||(ua=0,Pa=zb.Cj);if(5===zb.type){var Ea=ua+zb.length;var lb=void 0;let Xb;const ub=ca(this.rra);if(!({index:lb}=G(ub,zb.Cj,ua)).returnValue||!({index:Xb}=G(ub,zb.Cj,Ea)).returnValue)return a.a.instance.Sa(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",zb.I3c),{returnValue:!1,ksi:Sa};for(Ea=new h.a;lb<Xb;lb++)Ea.add(ub.J(lb));Sa.Z(zb.I3c,Ea)}ua+=zb.length;Fa++}return{returnValue:!0,ksi:Sa}}KAl(){let Sa;Sa=new v.a;let ua=0;for(let Pa=0;Pa<this.dP.base.length;Pa++){const Ea=this.dP.base.J(Pa);if(5===Ea.type){var Fa=void 0;let lb;const zb=ca(this.rra);if(!({index:Fa}=P(zb,ua,this.ge.logger)).returnValue||!({index:lb}=
P(zb,ua+Ea.length,this.ge.logger)).returnValue)return a.a.instance.Sa(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,lsi:Sa};const Xb=new h.a;for(;Fa<lb;Fa++)Xb.add(zb.J(Fa));Sa.Z(Ea.I3c,Xb)}ua+=Ea.length}return{returnValue:!0,lsi:Sa}}Uek(Sa){let ua;ua=new h.a;let Fa;if(this.brb){if(!({lsi:Fa}=this.KAl()).returnValue)return{returnValue:!1,gSc:ua}}else if(!({ksi:Fa}=this.JAl()).returnValue)return{returnValue:!1,gSc:ua};let Pa;Pa=this.brb?
new rb(this.ge,ca(this.fHa),1):new Ba(this.ge,ca(this.fHa),new e.a,this.JH?this.JH.DFa:0);for(var Ea=0;Ea<Sa.length;Ea++)if(!Pa.YRe(Sa.J(Ea),4))return{returnValue:!1,gSc:ua};for(Sa=Pa.Me.length-1;0<=Sa;Sa--)5===Pa.Me.J(Sa).type&&(Ea=Pa.Me.J(Sa).I3c,Pa.Me.nF(Sa),Pa.Me.IA(Sa,Fa.J(Ea)));this.brb&&(this.vyh(Pa.Me),this.vyh(this.dP.Me));if(!this.validateUpdateHintsAreComplete(this.dP.Me,Pa.Me,"Merged"))return{returnValue:!1,gSc:ua};ua=Pa.Me;return{returnValue:!0,gSc:ua}}vyh(Sa){const ua=new v.a;for(let Fa=
Sa.length-1;0<=Fa;Fa--){const Pa=Object(u.a)(L.a,Sa.J(Fa));Pa&&(ua.ub(Pa.Nc)?ua.J(Pa.Nc).source!==Pa.source&&Sa.nF(Fa):ua.add(Pa.Nc,Pa))}}Yfk(Sa){let ua;if(!({c4c:ua}=this.dP.M9e(ca(this.rra))).returnValue)return!1;for(let Pa=0;Pa<ua.length;Pa++){const Ea=ua.J(Pa);let lb,zb;if(!({index:lb}=P(Sa,Ea.cp,this.ge.logger)).returnValue||!({index:zb}=P(Sa,Ea.cp+Ea.length,this.ge.logger)).returnValue)return a.a.instance.Sa(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.ge.logger.Tg(Object.assign(new F.a,
{kj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Fa=!1;for(let Xb=lb;Xb<zb&&!Fa;Xb++)Fa=!Ea.Jsd.uI.equals(Sa.J(Xb).uI);if(!Fa){for(Fa=lb;Fa<zb;Fa++)Sa.nF(lb);Sa.insert(lb,Ea.d4c)}}return!0}Xfk(Sa){let ua;if(!({vhc:ua}=this.dP.M9e(ca(this.rra))).returnValue)return!1;for(let Ea=0;Ea<ua.length;Ea++){var Fa=ua.J(Ea);let lb,zb;if(({index:lb}=G(Sa,Fa.Dg,Fa.cp)).returnValue&&({index:zb}=G(Sa,Fa.Dg,Fa.cp+Fa.d4c.length)).returnValue){var Pa=!1;for(let Xb=lb;Xb<zb&&!Pa;Xb++)Pa=!Fa.Jsd.uI.equals(Sa.J(Xb).uI)||
!Fa.Jsd.wE.Tz(Sa.J(Xb).wE);if(Pa){if(this.JH&&1===this.JH.DFa||this.MV&&1===this.MV.DFa)return!1}else{for(Pa=lb;Pa<zb;Pa++)Sa.nF(lb);Sa.insert(lb,Fa.d4c)}}else if(Fa=Fa.d4c.Fam,a.a.instance.Sa(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Fa),Fa||this.JH&&1===this.JH.DFa||this.MV&&1===this.MV.DFa)return!1}return!0}wFl(Sa){let ua,Fa;Fa=new h.a;ua=this.ge.runtime.Um.J(A.a.KK);let Pa;({yAf:Pa}=Hb.nNh(this.ge,
this.Pg));const Ea=new h.a;for(let zb=0;zb<Sa.length;zb++){if(Pa.contains(Sa.J(zb).id,(ub,Pb)=>ub.equals(Pb)))continue;if(this.ge.runtime.Um.ub(Sa.J(zb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Sa.J(zb).id),{returnValue:!1,H_d:ua,G_d:Fa};Ea.add(Sa.J(zb).id);var lb=Sa.J(zb).VYa();const Xb=new Tb.a(lb);lb=lb.Nj();for(const ub of lb)Xb.sB(ub);Fa.add(Xb)}Sa=this.Pg.getPropertyObjectIds(ua.gm,l.a.c0);Sa.IA(Sa.length,Ea);this.Pg.setPropertyObjectIds(ua.gm,
l.a.c0,Sa);return{returnValue:!0,H_d:ua,G_d:Fa}}IFd(Sa){return String.format("Name: {0}, Message: {1}, Stack: {2}",Sa.name,Sa.message,Sa.stack)}w_c(Sa){0===this.Upa&&(this.Upa=Sa)}hhc(){let Sa;Sa=null;let ua,Fa;var Pa;try{if({Um:Sa,H_d:ua,G_d:Fa,returnValue:Pa}=this.seo(),Pa){if(ua&&Fa){this.ge.runtime.Um.Z(ua.gm.id,ua);for(Pa=0;Pa<Fa.length;Pa++){const Xb=Fa.J(Pa);this.ge.runtime.Um.Z(Xb.gm.id,Xb)}const Ea=ua.gm,lb=this.Pg.getPropertyObjectIds(Ea,l.a.c0),zb=this.Pg.getPropertyString(Ea,l.a.TQa);
a.a.instance.Sa(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",lb.Fq(),zb)}else a.a.instance.Sa(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Um:Sa}}}catch(Ea){a.a.instance.Sa(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.IFd(Ea))}this.w_c(5);a.a.instance.Sa(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Upa,this.wVf);this.C0a();this.JH&&1===this.JH.DFa&&this.ge.logger.Tg(Object.assign(new ha.a,{eventId:"bc04c",kj:"ParagraphMergeUsingHints.TryDoMerge",info:n[this.Upa]+"/LCS"}));return{returnValue:!1,Um:Sa}}seo(){let Sa,ua,Fa;Fa=ua=Sa=null;let Pa;Pa=this.initialize();this.ge.logger.ZT("PMUH Initialize");let Ea=null;Pa=Pa&&({B4a:Ea}=this.Leh(!1,m.a.nil,0)).returnValue;this.ge.logger.ZT("PMUH ApplyUpdateHints");let lb=new h.a;Pa=Pa&&({gSc:lb}=this.Uek(Ea)).returnValue;this.ge.logger.ZT("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
Pa=this.brb?Pa&&this.Yfk(lb):Pa&&this.Xfk(lb);this.ge.logger.ZT("PMUH ApplyUnfavoredFormattingChanges");this.brb&&!this.zBn(lb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.ge.logger.Tg(Object.assign(new F.a,{kj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Pa=!1);const zb=this.qHd(lb);Pa=Pa&&({F_d:Sa}=nb.a.SIc(this.ge,this.Pg,this.Vpa,lb,zb)).returnValue;this.ge.logger.ZT("PMUH GetMergeableObjectsFromMergeBlocks");this.JH&&1===this.JH.DFa&&this.MV&&1===this.MV.DFa||(Pa=
Pa&&({H_d:ua,G_d:Fa}=this.wFl(E(Ea))).returnValue,this.ge.logger.ZT("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Pa,mergeConflict:!!this.dP&&this.dP.mergeConflict,Um:Sa,H_d:ua,G_d:Fa}}qHd(Sa){const ua=new h.a;for(let Fa=0;Fa<Sa.length;Fa++)2===Sa.J(Fa).type&&ua.add(Sa.J(Fa).Cj);return ua}ief(Sa){const ua=new h.a;for(let Fa=0;Fa<Sa.length;Fa++)2===Sa.J(Fa).type&&ua.add(Sa.J(Fa));return ua}zBn(Sa){var ua=this.ief(this.rpa),Fa=this.ief(this.fHa),Pa=this.ief(this.rra),Ea=this.qHd(ua),
lb=this.qHd(Fa),zb=this.qHd(Pa);lb=M.b(Ea,lb,zb);Ea=new h.a;for(zb=0;zb<lb.length;zb++)Ea.IA(Ea.length,lb.J(zb).qbl());lb=this.vbl(Sa);ua=this.rbl(lb,Ea,ua,Fa,Pa);Fa=0;Pa=new e.a;for(Ea=0;Ea<Sa.length;Ea++)if(lb=Sa.J(Ea),2===lb.type)if(Pa.contains(lb.Cj))if(Fa<ua.length)Sa.nF(Ea),Sa.insert(Ea,ua.J(Fa)),Fa++;else return!1;else Pa.add(lb.Cj);0<Sa.length&&2!==Sa.J(Sa.length-1).type&&Fa<ua.length&&Sa.insert(Sa.length,ua.J(Fa));return!0}vbl(Sa){const ua=new e.a;for(let Fa=0;Fa<Sa.length;Fa++)2===Sa.J(Fa).type&&
ua.add(Sa.J(Fa).Cj);return ua}rbl(Sa,ua,Fa,Pa,Ea){const lb=new h.a;for(let zb=0;zb<ua.length;zb++){const Xb=ua.J(zb);if(!Sa.contains(Xb)){let ub;(({block:ub}=this.D9e(Pa,Xb)).returnValue||({block:ub}=this.D9e(Ea,Xb)).returnValue||({block:ub}=this.D9e(Fa,Xb)).returnValue)&&ub&&lb.add(ub)}}return lb}D9e(Sa,ua){for(let Fa=0;Fa<Sa.length;Fa++)if(2===Sa.J(Fa).type&&Sa.J(Fa).Cj===ua)return Sa=Sa.J(Fa),{returnValue:!0,block:Sa};return{returnValue:!1,block:null}}C0a(){const Sa=new h.a;nb.a.p9b(this.Pg,"BaseObjects_",
this.EE,Sa);nb.a.p9b(this.Pg,"FavoredObjects_",this.Txa,Sa);nb.a.p9b(this.Pg,"ConflictObjects_",this.dza,Sa)}urk(){let Sa,ua;Sa=m.a.nil;ua=-1;let Fa=0;for(let Pa=0;Pa<this.dP.Me.length;Pa++){const Ea=this.dP.Me.J(Pa);if(Ea.W2())Fa+=Ea.length;else if(6!==Ea.type)Fa=0;else return Sa=Ea.Cj,ua=Fa,{returnValue:!0,objectId:Sa,cp:ua}}a.a.instance.Sa(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Sa,cp:ua}}F3c(Sa,ua){let Fa,Pa;Pa=ua;Fa=Sa;try{let Ea=
this.initialize();if(Ea=(Ea=Ea&&this.Leh(!0,Sa,ua).returnValue)&&({objectId:Fa,cp:Pa}=this.urk()).returnValue)return a.a.instance.Sa(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Fa,Pa),{returnValue:!0,C2a:Fa,aoa:Pa}}catch(Ea){a.a.instance.Sa(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.IFd(Ea))}this.w_c(5);a.a.instance.Sa(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Upa,this.wVf);this.C0a();return{returnValue:!1,C2a:Fa,aoa:Pa}}static nNh(Sa,ua){let Fa;Fa=new h.a;if(!Sa.input.l5b)return{returnValue:!0,yAf:Fa};Sa=Sa.input.U3.last().RYa(A.a.KK);Fa=ua.getPropertyObjectIds(Sa,l.a.c0);return{returnValue:!0,yAf:Fa}}static u9m(Sa){if(!nb.a.M5e(Sa))return!0;const ua=new x.a;Sa.runtime.Um.Z(A.a.KK,nb.a.m6l(Sa,ua));return!0}static c9m(Sa){if(!Sa.runtime.Um.ub(A.a.KK)||!Sa.runtime.nq.ub(A.a.KK))return!0;const ua=new x.a,Fa=Sa.runtime.Um.J(A.a.KK);var Pa=ua.getPropertyString(Fa.gm,
l.a.TQa);if(m.a.Pf(Pa).equals(m.a.nil))return!0;Pa=ua.getPropertyObjectIds(Fa.gm,l.a.c0);const Ea=ua.getPropertyObjectIds(Sa.runtime.nq.J(A.a.KK),l.a.c0);let lb;({yAf:lb}=Hb.nNh(Sa,ua));for(let zb=0;zb<Ea.length;zb++)Pa.contains(Ea.J(zb),(Xb,ub)=>Xb.equals(ub))||lb.contains(Ea.J(zb),(Xb,ub)=>Xb.equals(ub))||(Pa.add(Ea.J(zb)),Sa.runtime.Um.Z(Ea.J(zb),new Tb.a(Sa.runtime.nq.J(Ea.J(zb)).OG())));ua.setPropertyObjectIds(Fa.gm,l.a.c0,Pa);return!0}}Object(C.a)(Hb,"ParagraphMergeUsingHints",null,[1865])},
1578:function(C,O,c){C=c(0);class l{constructor(u){this.$ui=u;this.succeeded=!1;this.ahc=u?u.ahc:0;this.Nnm=!1;this.length=this.k9n=0}}Object(C.a)(l,"TrieResult",null,[]);class e{constructor(u,n,x){this.Ghb=new l(null);this.xFm=u;this.BRc=n;this.Xpi=n+x-1}get result(){return this.Ghb}$Vh(){let u;return this.BRc<=this.Xpi?(u=this.xFm.charAt(this.BRc),++this.BRc,{returnValue:!0,ch:u}):{returnValue:!1,ch:"\x00"}}cSf(u,n,x){u&&(this.Ghb.Nnm=!0,this.Ghb.k9n=n);this.Ghb.length=this.BRc;this.Ghb.succeeded=
!0;this.Ghb.ahc=x;this.BRc!==this.Xpi+1&&(this.Ghb=new l(this.Ghb))}}Object(C.a)(e,"LookUpStringVisitor",null,[1300]);var a=c(1656);class h{constructor(){this.emh=this.Ejh=this.Gjh=this.Djh=this.Fjh=this.jVe=this.hVe=this.lVe=this.gVe=0}}Object(C.a)(h,"TRIESTATS",null,[]);class m{constructor(){this.symbol=this.YSc=0}}Object(C.a)(m,"TrieSymbol",null,[]);c.d(O,"a",function(){return v});class v{constructor(u,n){this.Z2=null;this.qUd=this.lqi=this.jqi=this.nqi=this.fqi=this.mqi=this.kqi=this.oqi=this.gqi=
0;this.VI=u;if(u.hy(n,4)!==v.zwb)throw Error.argument("Input does not represent a trie");n+=4;this.Zpi=1===u.hy(n,4);n+=4;this.uFm=1===u.hy(n,4);n+=4;this.qFm=u.hy(n,4);n+=4;if(u.hy(n,4)){u=n+4;this.Z2=this.Lin(u);this.gqi=n=u+v.Qpk;this.oqi=n+=v.Atd*(this.Z2.gVe+(this.Z2.gVe%2?1:0));this.kqi=n+=v.Atd*(this.Z2.lVe+(this.Z2.lVe%2?1:0));this.mqi=n+=v.Atd*(this.Z2.hVe+(this.Z2.hVe%2?1:0));this.fqi=n+=v.Atd*(this.Z2.jVe+(this.Z2.jVe%2?1:0));this.nqi=n+=v.nVe*this.Z2.Djh;this.jqi=n+=v.oVe*this.Z2.Gjh;
this.lqi=n+=v.oVe*this.Z2.Ejh;n+=v.oVe*this.Z2.Fjh;if(n!==u+this.Z2.emh)throw Error.argument("Corrupted trie binary");this.qUd=n}else this.Z2=null}vpi(u,n,x,A){u=new e(u,n,x);this.Cmj(u,A);return u.result}Z_h(u){if(this.Zpi)if(u)--u;else return"";if(!this.Z2)throw Error.argument("Invalid trieID");const n=new a.a;n.DE=0;this.nMb(n);const x=[];for(;;){if(n.DE&v.o5a)if(u)--u;else return Array.add(x,n.nNb),String.fromCharCode.apply(null,x);const A=!!(n.DE&v.jge),H=this.K2b(n,!0);if(A||u<H){if(Array.add(x,
n.nNb),!this.nMb(n))throw Error.argument("Invalid trieID");}else if(u-=H,!this.Y2c(n))throw Error.argument("Invalid trieID");}}Cmj(u,n){let x=0;this.Zpi&&(u.cSf(this.uFm,this.qFm,0),++x);if(this.Z2){var A=new a.a;A.DE=0;if(this.nMb(A))for(;;){var H=void 0;if(!({ch:H}=u.$Vh()).returnValue)break;n&&(H=n(H));H=H.toString().charCodeAt(0);let E=!1;for(;!E;){const L=!!(A.DE&v.o5a);if(A.nNb===H){if(E=!0,L&&u.cSf(!!(A.DE&v.Zfg),A.Aae,x),!this.nMb(A))return}else if(x+=this.K2b(A,!0),!this.Y2c(A))return;L&&
++x}}}}nMb(u){if(!u.DE)return this.i7f(u),!0;if(!(u.DE&v.ige))return!1;u.xMa=0;u.Zw=u.kfb;this.i7f(u);return!0}Y2c(u){if(u.DE&v.jge)return!1;this.i7f(u);return!0}K2b(u,n){return u.DE&v.Yfg?u.ztd:u.DE&v.ige?!n&&u.DE&v.jge?this.Apl(u):1:0}Apl(u){u=v.QXe(u);if(!this.nMb(u))return 0;let n=0;do u.DE&v.o5a&&++n,n+=this.K2b(u,!1);while(this.Y2c(u));return n}i7f(u){u.DE||(u.xMa=0,u.Zw=this.qUd);var n=this.Lyd(this.gqi,u.Zw),x=n.symbol;u.Zw+=n.YSc;n=this.VI.hy(this.fqi+v.nVe*x,v.nVe);u.nNb=n&65535;u.DE=n>>
16;u.DE&v.Yfg&&(u.ztd=this.lSk(u));u.DE&v.Zfg&&(n=this.Lyd(this.oqi,u.Zw),x=n.symbol,u.Zw+=n.YSc,u.Aae=this.VI.hy(this.nqi+4*x,4));u.DE&v.fuj?(u.kfb=this.qUd+((this.VI.J(u.Zw)<<8|this.VI.J(u.Zw+1))<<8|this.VI.J(u.Zw+2)),u.Zw+=3):u.DE&v.guj?(u.kfb=u.Zw,u.xMa=u.kfb):u.DE&v.huj?(n=this.Lyd(this.kqi,u.Zw),x=n.symbol,u.Zw+=n.YSc,u.kfb=this.qUd+this.VI.hy(this.jqi+4*x,4)):u.DE&v.ige&&(n=this.Lyd(this.mqi,u.Zw),x=n.symbol,u.Zw+=n.YSc,u.xMa||(u.xMa=u.Zw),u.xMa+=this.VI.hy(this.lqi+4*x,4),u.kfb=u.xMa)}Lyd(u,
n){const x=new m;let A=0;for(;;){A+=this.VI.J(n);++n;++x.YSc;const H=this.VI.hy(u,2);if(A<H)break;x.symbol+=H;A-=H;u+=2;A<<=8}x.symbol+=A;return x}lSk(u){let n=this.VI.J(u.Zw);192<=n?(n=(n&63)<<15|(this.VI.J(u.Zw+1)&127)<<8,n|=this.VI.J(u.Zw+2),u.Zw+=3):128<=n?(n=(n&127)<<8|this.VI.J(u.Zw+1),u.Zw+=2):u.Zw+=1;return n}Lin(u){const n=new h;n.gVe=this.VI.hy(u+12,2);n.lVe=this.VI.hy(u+14,2);n.hVe=this.VI.hy(u+16,2);n.jVe=this.VI.hy(u+18,2);n.Fjh=this.VI.hy(u+24,4);n.Djh=this.VI.hy(u+28,4);n.Gjh=this.VI.hy(u+
32,4);n.Ejh=this.VI.hy(u+36,4);n.emh=this.VI.hy(u+40,4);return n}static QXe(u){const n=new a.a;n.nNb=u.nNb;n.DE=u.DE;n.ztd=u.ztd;n.Zw=u.Zw;n.kfb=u.kfb;n.xMa=u.xMa;n.Aae=u.Aae;return n}}v.zwb=1654263084;v.Qpk=48;v.Atd=2;v.oVe=4;v.nVe=4;v.o5a=1;v.jge=2;v.Yfg=4;v.Zfg=8;v.ige=16;v.guj=64;v.huj=128;v.fuj=256;Object(C.a)(v,"Trie",null,[1295])},1580:function(C,O,c){c.r(O);C=c(0);c(1451);var l=c(1470);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(C.a)(e,"AppsForOfficeStoreType",null,[]);
var a=c(1449),h=c(2),m=c(80),v=c(13);class u{constructor(){this.FIe=0}fPf(M,F){this.FIe=window.performance.now();this.bRa(()=>{const J=window.performance.now(),I={},K=h.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);F.bak&&(I.callback=N=>{M(N,e.marketPlace,J)},K&&(I.storeType=e.marketPlace),h.AFrameworkApplication.ya.Xb(v.a.nIb,2,I));F.cak&&(I.callback=N=>{M(N,e.privateCatalog,J)},K?I.storeType=e.privateCatalog:h.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",
!0)?I.storeType=10:I.storeType=e.privateCatalog,h.AFrameworkApplication.ya.Xb(v.a.nIb,2,I))},0,()=>{if(a.TellMeActor.instance.Xe)a.TellMeActor.instance.Xe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.FIe)+" ms")})}bRa(M,F=0,J=null){2!==h.AFrameworkApplication.ya.processAction(v.a.nIb,1)?(a.TellMeActor.instance.Xe&&a.TellMeActor.instance.Xe.Yz(l.a.$$j,window.performance.now()-this.FIe),M()):F<u.xIm?h.AFrameworkApplication.uc.fc(new m.a(2,
1,u.Pto,()=>{this.bRa(M,F+1,J)})):J&&J()}static get instance(){u._instance||(u._instance=new u);return u._instance}}u._instance=null;u.xIm=20;u.Pto=500;Object(C.a)(u,"AddinEntitlementsQuery",null,[]);class n{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Fvf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(C.a)(n,"AddinInfo",null,[]);var x=c(1452),A=c(1456),H=c(1455),
E=c(1447);c.d(O,"AddinResultsProvider",function(){return L});class L{constructor(M){this.qc=M;this.YUm=(F,J,I)=>{if(F){const K=F.errorCode;if(a.TellMeActor.instance.Xe){const N={};N.StoreType=J;N.ErrorCode=K;N.AddinCount=F.value?F.value.length:0;a.TellMeActor.instance.Xe.Yz(l.a.Fil,window.performance.now()-I,N)}if(0===K&&F.value){L.Mvb=L.Mvb||{};F=F.value;for(const N of F)F=new n,F.displayName=N[0],F.id=N[1],F.description=N[2],F.targetType=N[3],F.appVersion=4<N.length?N[4]:"",F.assetId=5<N.length?
N[5]:"",F.assetStoreId=6<N.length?N[6]:"",F.width=7<N.length?N[7]:0,F.height=8<N.length?N[8]:0,F.iconUrl=9<N.length?N[9]:"",F.providerName=10<N.length?N[10]:"",F.storeId=11<N.length?N[11]:"",F.storeType=12<N.length?N[12]:"",this.qc.bXi&&(F.Fvf=this.qyl(F)),L.Mvb[F.id]=F,0<F.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+F.id,F.iconUrl)}}};u.instance.fPf(this.YUm,this.qc)}IL(){return"Add-ins"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(M,F,J,I,K=null){J=new H.a(M);K&&!Array.contains(K,
24)||E.a.YW(M)||(K=new A.a(24),K.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Sxl(M.Ig,K),J.kw(K));F.resultsUpdated(J)}Sxl(M,F){if((M=this.FFn(M))&&0<M.length){let J=0;M.forEach(I=>{if(!(3<++J)){var K="AddinSuggestion"+J,N={};N["default"]=0<I.iconUrl.length?"AddinIcon_"+I.id:"AppForOfficeLogo_20";var G=[];G.push(appChrome.actions.setControlLabel(K,I.displayName));G.push(appChrome.actions.setControlIconSet(K,N));G.push(appChrome.actions.setCompoundButtonCommandValueId(K,I.id));G.push(appChrome.actions.updateCompoundButtonDescription(K,
I.description));h.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(N=window.performance.now(),G.push(appChrome.actions.updateControlEnabledDisabledState(K,!1)),a.TellMeActor.instance.Xe&&a.TellMeActor.instance.Xe.Yz(l.a.Y2k,window.performance.now()-N));appChrome.api.dispatch(G);K=new x.a(K,25,void 0,void 0,1);K.ZH=Telemetry.PrivacyRules.GetPrivacyCompliantId(I.id,I.storeType,I.assetId,null,null,I.storeId);F.Ez(K)}})}}FFn(M){if(!L.Mvb)return null;
const F=[],J=L.Mvb;for(let K in J){var I=J[K];I&&(this.qc.bXi?L.CHm(M,I)&&Array.add(F,I):0<=I.displayName.toLowerCase().indexOf(M.toLowerCase())?Array.add(F,I):this.qc.Wlm&&0<=I.description.toLowerCase().indexOf(M.toLowerCase())&&Array.add(F,I))}return F}qyl(M){const F=L.O8i(M.displayName);this.qc.aak&&Array.addRange(F,L.O8i(M.description));return F}static CHm(M,F){if(!F.Fvf)return!1;for(const J of M.split(" ")){M=!1;for(const I of F.Fvf)if(I.toLowerCase().startsWith(J.toLowerCase())){M=!0;break}if(!M)return!1}return!0}static O8i(M){const F=
[];for(const J of M.split(" ")){M=0;for(let I=0;I<J.length;I++){const K=J.charAt(I);K.toString().toUpperCase()===K.toString()&&I>M&&(Array.add(F,J.substring(M,I)),M=I)}Array.add(F,J.substring(M,J.length));M&&Array.add(F,J.substring(0,J.length))}return F}}L.Mvb=null;Object(C.a)(L,"AddinResultsProvider",null,[1143])},1638:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(216);class e{constructor(){this.pjb=this.qjb=this.pXa=this.Mfb=this.ojb=this.Ybb=this.Kfb=this.T1a=this.Zbb=this.Lfb=
null;this.reset()}reset(){this.Lfb=new l.a;this.Zbb=new l.a;this.T1a=new l.a;this.Kfb=new l.a;this.Ybb=new l.a;this.ojb=new l.a;this.Mfb=new l.a;this.pXa=new l.a;this.pXa=new l.a;this.qjb=new l.a;this.pjb=new l.a}xso(a){return this.oMa(this.Lfb,a)&&this.oMa(this.Zbb,a)&&this.oMa(this.T1a,a)&&this.oMa(this.Kfb,a)&&this.oMa(this.Ybb,a)&&this.oMa(this.ojb,a)&&this.oMa(this.Mfb,a)&&this.oMa(this.pXa,a)&&this.oMa(this.qjb,a)&&this.oMa(this.pjb,a)}oMa(a,h){return!a||!a.length||a.length===h}}Object(C.a)(e,
"MergeableTrackedChangesProperties",null,[])},1639:function(C,O,c){c.d(O,"a",function(){return a});C=c(0);var l=c(216),e=c(619);class a{constructor(){this.hGa=new l.a;this.eHa=new l.a;this.sJa=new l.a}get hwb(){return this.hGa}get c9e(){return this.eHa}get tmb(){return this.sJa}get isEmpty(){return!this.hGa.length&&!this.eHa.length&&!this.sJa.length}get Wzf(){return Math.max(Math.max(this.hGa.length,this.eHa.length),this.sJa.length)}get WKm(){return Math.min(Math.min(this.hGa.length,this.eHa.length),
this.sJa.length)}Rrd(h){this.hGa.add(h)}Urd(h){this.eHa.add(h)}Zrd(h){this.sJa.add(h)}qbl(){const h=new e.a,m=new l.a;let v=0;for(;v<this.hGa.length||v<this.eHa.length||v<this.sJa.length;)v<this.hGa.length&&!h.contains(this.hGa.J(v))&&(m.add(this.hGa.J(v)),h.add(this.hGa.J(v))),v<this.eHa.length&&!h.contains(this.eHa.J(v))&&(m.add(this.eHa.J(v)),h.add(this.eHa.J(v))),v<this.sJa.length&&!h.contains(this.sJa.J(v))&&(m.add(this.sJa.J(v)),h.add(this.sJa.J(v))),v++;return m}}Object(C.a)(a,"ObjectCollection",
null,[])},1640:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a){this.DFa=a;this.updateHints=e}}Object(C.a)(l,"UpdateHintCollection",null,[])},1641:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1508);class l extends c.a{constructor(e,a){super();this.Dg=e;this.Nc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Dg,this.Nc)}}Object(C.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1642:function(C,
O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(216);c=c(1508);class e extends c.a{constructor(a){super();this.FZ=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let h=0;h<this.FZ.length;h++)a+=String.format("({0}), ",this.FZ.J(h).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(C.a)(e,"LcsInsertUpdateHint",c.a,[])},1643:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1508);class l extends c.a{constructor(e,a){super();this.text=a;this.Dg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Dg,this.text)}}Object(C.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1644:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1508);class l extends c.a{constructor(e,a,h){super();this.cp=e;this.Dg=a;this.Nc=h}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Dg,this.Nc)}}Object(C.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1645:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1508);class l extends c.a{constructor(e,
a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(C.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1646:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);c=c(1483);class l extends c.a{constructor(){super()}get xea(){return"Conflict"}}Object(C.a)(l,"ConflictMergeFailureDetail",c.a,[])},1647:function(C,O,c){c.r(O);c.d(O,"InsightsMenuItemFactory",function(){return h});C=c(0);var l=c(1447),e=c(236),
a=c(17);class h{constructor(m=null){this.iJj=m||CommonUIStrings.l_InsightsButtonText}get mJb(){return 10}fea(m){var v=m.cC;m=l.a.OCa()?l.a.bXa(v,1):l.a.Zxb(v);v=String.format(this.iJj,v);return this.dhl(m,v)}dhl(m,v){return e.a(h.M$h,l.a.OCa()?"1914896509":"3317204163",a.a.Ff(v),l.a.Tof,null,a.a.Ff(m),a.a.Ff(v),null,null)}}h.M$h="bInsights";Object(C.a)(h,"InsightsMenuItemFactory",null,[1142])},1648:function(C,O,c){c.d(O,"a",function(){return a});C=c(0);var l=c(236),e=c(17);class a{constructor(h,m,
v,u,n){this.vGe=h;this.uGe=m;this.dZj=v;this.NHj=u;this.HJg=n}get mJb(){return 4}fea(h,m=null){m=m.sessionId+"|"+m.kma+"|"+h.cC;if(this.HJg||this.NHj){let v=this.HJg||e.a.cA(CommonUIStrings.l_HelpTooltip)===e.a.cA(h.cC.trim());if(this.dZj&&2<h.cC.length){const u=h.cC;";"===u.charAt(0)&&";"===u.charAt(u.length-1)&&u.substring(1,u.length-1)===a.Flf&&(v=!0)}h=v?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,h.cC);return this.GMh(m,e.a.Ff(h),v)}return this.GMh(m,
e.a.Ff(String.format(CommonUIStrings.l_TextWithQuotation,h.cC)),!1)}GMh(h,m,v){return l.a(a.Flf,v?this.uGe:this.vGe,m,"OfficeAssistant_16x16x32","A0",e.a.Ff(h),m,null,null)}}a.Flf="bSearchHelp";Object(C.a)(a,"AssistanceMenuItemFactory",null,[1142])},1649:function(C,O,c){c.d(O,"a",function(){return m});C=c(0);var l=c(2),e=c(236),a=c(95),h=c(17);class m{get mJb(){return 13}fea(){return m.Ymk()}static Ymk(){return e.b(m.TJh,"798637440",h.a.Ff(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.pr,
a.getImageClass("Info_32x32x32"),null,null,h.a.Ff(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,h.a.Ff(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}m.TJh="bTellMeFirstRun";Object(C.a)(m,"FirstRunMenuItemFactory",null,[1142])},1650:function(C,O,c){c.d(O,"a",function(){return h});C=c(0);var l=c(2),e=c(236),a=c(17);class h{constructor(m=null,v=null){this.gTg=m;this.SOj=v||CommonUIStrings.l_LookupNoResultsDescription}get mJb(){return 14}fea(m){m=String.format(this.SOj,
m.cC);return this.Ynk(m)}Ynk(m){return e.b(h.mvi,"798637440",a.a.Ff(CommonUIStrings.l_LookupNoResultsTitle),this.gTg?l.AFrameworkApplication.pr:null,this.gTg,null,null,a.a.Ff(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Ff(m),null,null)}}h.mvi="lookupNoResults";Object(C.a)(h,"NoCommandsFoundMenuItemFactory",null,[1142])},1651:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(C.a)(l,
"LabelFormatted",null,[])},1652:function(C,O,c){c.d(O,"a",function(){return v});C=c(0);c(1451);var l=c(1452),e=c(1456),a=c(1455),h=c(1447),m=c(17);class v{constructor(u){this.qc=u}IL(){return"Assistance"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:this.qc.dUc?3:2}MI(u,n,x=!1,A,H=null){A=new a.a(u);if((!H||Array.contains(H,8))&&!h.a.YW(u)){H=new e.a(8);if(x){x=m.a.cA(CommonUIStrings.l_HelpTooltip)===m.a.cA(u.Ig.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
u.Ig);const E=[];this.qc.$_a&&(this.qc.G8d||E.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),x=this.rWh(u.Ig));const L="||"+u.Ig;E.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",x));E.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",L));appChrome.api.dispatch(E);u=new l.a("GetHelpFromTellMe",4,u.Ig,null,1)}else u=new l.a("bSearchHelp",4,u.Ig,null,1);H.Ez(u);H.displayName=CommonUIStrings.l_HelpButtonTitle;A.kw(H)}n.resultsUpdated(A)}Meb(u,
n=null){const x=new e.a(8),A=m.a.cA(CommonUIStrings.l_HelpTooltip)===m.a.cA(u.Ig.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,u.Ig);for(let E=0;E<n.length&&2>E;E++){var H=void 0;H=[];let L="GetHelpWithDescriptionFromTellMe"+(E+1).toString(),M=4;if(this.qc.o0c)H.push(appChrome.actions.setControlLabel(L,A)),H.push(appChrome.actions.setCompoundButtonCommandValueId(L,u.Ig)),H.push(appChrome.actions.updateCompoundButtonDescription(L,this.pjf(n.length)));
else if(this.qc.p0c){let F=this.I1h(n[E]);L="GetHelpFromTellMe"+(E+1).toString();this.qc.$_a&&(F=this.rWh(F));M=9;H.push(appChrome.actions.setControlLabel(L,F));H.push(appChrome.actions.setButtonCommandValueId(L,this.IOl(n[E])))}appChrome.api.dispatch(H);H=new l.a(L,M,null,null,0);H.label=this.I1h(n[E]);H.description=this.HOl(n[E]);x.Ez(H);if(this.qc.p0c)break}x.displayName=CommonUIStrings.l_HelpButtonTitle;return x}pjf(u){return 1===u?String.format(CommonUIStrings.l_SearchResultText,u):String.format(CommonUIStrings.l_SearchResultsText,
u)}rWh(u){return this.qc.juf?h.a.Mef(u,CommonUIStrings.l_HelpScopedButtonText):u+CommonUIStrings.l_HelpScopedButtonText}I1h(u){return u.name?u.name:""}HOl(u){return u.description?u.description:""}IOl(u){return u.id?"AssetID="+u.id:""}}Object(C.a)(v,"AssistanceResultsProvider",null,[1143])},1653:function(C,O,c){c.d(O,"a",function(){return u});C=c(0);c(1451);var l=c(1452),e=c(1456),a=c(1455),h=c(1449),m=c(1447),v=c(1506);class u{constructor(n){this.qc=n}IL(){return"Image"}FW(){return 0===this.qc.Nv?
0:1===this.qc.Nv?1:3===this.qc.Nv?3:2}MI(n,x,A,H,E=null){A=new a.a(n);(!E||Array.contains(E,19))&&m.a.YW(n)&&this.qc.uO&&this.Meb(n,A,1);x.resultsUpdated(A)}Meb(n,x,A,H=null){var E=[];let L;h.TellMeActor.instance.QN()&&h.TellMeActor.instance.QN().$_a?(L=this.qc.juf?m.a.Mef(n.Ig,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):n.Ig+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.qc.G8d||E.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
L=this.qc.uO?m.a.YW(n)?this.qc.oab?m.a.Fdb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.qc.oab?m.a.Fdb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,n.Ig)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,n.Ig):this.qc.Mec?CommonUIStrings.l_TellMeImageSuggestionButtonText:n.Ig+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.qc.KBa?(h.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
L)),E=m.a.bXa(n.Ig,9,Object.assign(new v.a,{landingTab:"Image"})),h.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",E))):(E.push(appChrome.actions.setControlLabel("ImageForSearch",L)),n=m.a.bXa(n.Ig,9,Object.assign(new v.a,{landingTab:"Image"})),E.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",n)),appChrome.api.dispatch(E));A=new l.a("ImageForSearch",12,null,null,A);H&&(A.score=H.ConfidenceScore);H=new e.a(19,this.qc.Mec?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);H.Ez(A);x.kw(H)}}Object(C.a)(u,"ImageResultsProvider",null,[1143])},1654:function(C,O,c){c.d(O,"a",function(){return v});C=c(0);c(1451);var l=c(1452),e=c(1456),a=c(1455),h=c(1447),m=c(2);class v{constructor(u){this.qc=u}IL(){return"Template"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:3}MI(u,n){u=new a.a(u);n.resultsUpdated(u)}Meb(u,n,x){var A=[];let H;H=this.qc.uO?this.qc.oab?h.a.Fdb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,u.Ig)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
u.Ig):String.format(CommonUIStrings.l_TellMeTemplateButtonText,u.Ig);A.push(appChrome.actions.setControlLabel("TemplateForSearch",H));A.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(m.AFrameworkApplication.K.lb("TellMeTemplateProviderURL"),m.AFrameworkApplication.uiCulture,u.Ig)));appChrome.api.dispatch(A);u=new e.a(23);u.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;A=new l.a("TemplateForSearch",24,null,null,0);A.label=x[0].Title?x[0].Title:"";A.description=
x[0].Description?x[0].Description:"";u.Ez(A);n.kw(u)}}Object(C.a)(v,"TemplateResultsProvider",null,[1143])},1655:function(C,O,c){c.d(O,"a",function(){return x});C=c(0);c(1451);var l=c(1485),e=c(1452),a=c(1456),h=c(1455),m=c(1569),v=c(1449),u=c(1447),n=c(17);class x{constructor(A,H,E,L){this.f1=A;this.A$a=H;this.d5g=L;this.jFj=E;this.qc=v.TellMeActor.instance.QN()}IL(){return"EmptyQuery"}FW(){return 1===this.qc.Nv?1:0}MI(A,H,E=!1,L,M=null){L=new h.a(A);if((!M||Array.contains(M,5)||Array.contains(M,
6)||Array.contains(M,4))&&u.a.YW(A)){this.f1.UHc().length||!this.jFj||this.d5g||(A=new a.a(6),M=new e.a(null,13,void 0,void 0,1),A.Ez(M),L.kw(A));A=new a.a(4);if(0<this.f1.UHc().length){A.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.f1.UHc();var F=[];for(var J of M)F.push(J.Id);l.CommandResultsUtility.B3c(F,this.qc);for(var I of M)l.CommandResultsUtility.tNc(I.Id)&&A.Ez(new e.a(I.Id,5,null,null,2));L.kw(A)}if(this.d5g&&0<this.A$a.length&&this.f1.UHc().length<x.maxResults){J=new a.a(5);
J.displayName=CommonUIStrings.l_TellMeTryQueryTitle;I=x.maxResults-A.results.length;A=[];for(M=0;M<this.A$a.length&&M<I;++M){if(E){F=u.a.N7f+(M+1);const K=this.A$a[M].key,N=n.a.replaceAll(K,'"',"");A.push(appChrome.actions.setControlLabel(F,K));A.push(appChrome.actions.setButtonCommandValueId(F,N));F=new m.a(K,7,0,N,F)}else F=new m.a(this.A$a[M].key,7,0,this.A$a[M].value);J.Ez(F)}0<A.length&&appChrome.api.dispatch(A);L.kw(J)}}H.resultsUpdated(L)}}x.maxResults=5;Object(C.a)(x,"EmptyQueryResultsProvider",
null,[1143])},1656:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(){this.Aae=this.xMa=this.kfb=this.Zw=this.ztd=this.DE=this.nNb=0}}Object(C.a)(l,"TRIESCAN",null,[])},1671:function(C,O,c){c.r(O);var l=c(0),e=c(1451),a=c(1495),h=c(1470),m=c(1580);class v{constructor(cb,Eb){this.dxa=cb;this.Hk=Eb}resultsUpdated(cb){this.dxa.lQn(this.Hk,cb)}}Object(l.a)(v,"AggregatorResultsProviderCallback",null,[1145]);var u=c(1456),n=c(1455);class x{constructor(cb){this.kpa=null;this.qc=
cb;this.qc.Wvb&&(this.kpa=null)}IL(){return"AppsForOffice"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec,Cc,Pc=null){ec=new n.a(cb);if(!Pc||Array.contains(Pc,1))Pc=new u.a(1),this.kpa.ZDo(Pc,cb.Ig),ec.kw(Pc);Eb.resultsUpdated(ec)}}Object(l.a)(x,"AppsForOfficeRecommendationResultsProvider",null,[1143]);var A=c(1652),H=c(1444),E=c(1463),L=c(123);class M{constructor(cb,Eb){this.Bb=cb;this.tFm=Eb}isMatch(cb,Eb){if(!Object(L.a)(1261,cb))throw Error.argument("objToTest","Expected feature bundle");
let ec;return({value:ec}=cb.mq(this.Bb.Rra)).returnValue?this.Bb.V$f.isMatch(ec,Eb):this.tFm}}Object(l.a)(M,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1278]);class F{constructor(cb,Eb){this.Bb=cb;this.$yf=Eb}isMatch(cb){if(!Object(L.a)(1261,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.$yf^cb.mq(this.Bb.Rra).returnValue)}}Object(l.a)(F,"AnnotatedWithAnnotationFilter",null,[1278]);class J{constructor(cb){this.Bb=cb}isMatch(cb,Eb){if(!Object(L.a)(1264,cb))throw Error.argument("objToTest",
"Expected struct value");return this.Bb.V$f.isMatch(cb.Vdb(this.Bb.oLa),Eb)}}Object(l.a)(J,"FieldValueMatchesStructFilter",null,[1278]);class I{constructor(cb,Eb){cb&&(this.oLa=cb.J(0),this.V$f=Eb.Bla(cb.J(1)))}}Object(l.a)(I,"FieldValueMatchesStructFilterInit",null,[]);class K{constructor(cb){this.$yf=cb}isMatch(cb){if(!Object(L.a)(1261,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.$yf^cb.Xkf)}}Object(l.a)(K,"HasAnnotationsAnnotationFilter",null,[1278]);class N{constructor(cb,
Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb){if(!Object(L.a)(1263,cb))throw Error.argument("objToTest","Expected list value");switch(this.e7){case 0:for(const ec of cb.items)if(this.Bb.filter.isMatch(ec,Eb))return!0;return!1;case 1:for(const ec of cb.items)if(!this.Bb.filter.isMatch(ec,Eb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(N,"ItemTestListFilter",null,[1278]);class G{constructor(cb){this.Bb=cb}isMatch(cb,Eb){if(!Object(L.a)(1263,cb))throw Error.argument("objToTest",
"Expected list value");return this.Bb.filter.isMatch(cb.items.length,Eb)}}Object(l.a)(G,"LengthMatchesListFilter",null,[1278]);class P{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb,ec=null){let Cc=0===this.e7;for(const Pc of this.Bb.Bnh)if((Cc=Pc.isMatch(cb,Eb,ec))?1===this.e7:0===this.e7)return Cc;2===this.e7&&(Cc=!Cc);return Cc}}Object(l.a)(P,"NonterminalFilter",null,[1278]);class S{constructor(cb,Eb){if(cb){var ec=cb.J(0);this.Bnh=Array(ec);for(let Cc=0;Cc<ec;++Cc)this.Bnh[Cc]=Eb.Bla(cb.J(1+
Cc))}}}Object(l.a)(S,"NonterminalFilterInit",null,[]);class W{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected number value");let ec=this.Bb.number;if(this.Bb.query){Eb=this.Bb.query.at(null,Eb);if("number"!==typeof Eb)throw Error.invalidOperation("Query did not return number");ec+=Eb}switch(this.e7){case 0:return cb===ec;case 1:return cb<ec;case 2:return cb<=ec;case 3:return cb>ec;case 4:return cb>=ec;default:throw Error.notImplemented();
}}}Object(l.a)(W,"NumberFilter",null,[1278]);class X{constructor(cb,Eb){cb&&(this.number=cb.J(0),this.query=cb.J(1)?Eb.aK(cb.J(1)):null)}}Object(l.a)(X,"NumberFilterInit",null,[]);class Y{constructor(cb,Eb,ec){this.MFd=this.ltl;this.zFm=cb;this.cqi=Eb;this.bqi=ec}wWe(cb){this.cqi=cb}ltl(cb){if(!cb)throw Error.argument("name","Invalid named feature bundle reference");const Eb=cb.substr(1);return 1===cb.charCodeAt(0)&&Eb===this.zFm?this.cqi:this.bqi?this.bqi.MFd(cb):null}}Object(l.a)(Y,"SimpleNamedFeatureBundleResolver",
null,[1297]);class ca{constructor(cb){this.Bb=cb}isMatch(cb,Eb){if(!Object(L.a)(1261,cb))throw Error.argument("objToTest","Expected feature bundle");cb=this.Bb.query.at(null,new Y(this.Bb.Yde,cb,Eb));if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(ca,"PredicateAnnotationFilter",null,[1278]);class ha{constructor(cb,Eb){cb&&(this.Yde=Eb.nE(cb.J(0)),this.query=Eb.aK(cb.J(1)))}}Object(l.a)(ha,"PredicateAnnotationFilterInit",null,[]);class ra{constructor(cb){this.Bb=
cb}isMatch(cb,Eb){if("boolean"!==typeof cb)throw Error.argument("objToTest","Expected bool value");Eb=this.Bb.query.at(null,Eb);if("boolean"!==typeof Eb)throw Error.invalidOperation("Query did not return bool");return cb===Eb}}Object(l.a)(ra,"QueryBooleanFilter",null,[1278]);class sa{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");Eb=this.Bb.query.at(null,Eb);if("number"!==typeof Eb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.e7){case 0:return cb===Eb;case 1:return 0!==(cb&Eb);case 2:return cb===(cb&Eb);case 3:return Eb===(cb&Eb);default:throw Error.notImplemented();}}}Object(l.a)(sa,"QueryEnumFilter",null,[1278]);class oa{constructor(cb,Eb){cb&&(this.SPd=1===cb.J(0),this.query=Eb.aK(cb.J(1)))}}Object(l.a)(oa,"QueryEnumFilterInit",null,[]);class ka{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb){if(!Object(L.a)(1263,cb))throw Error.argument("objToTest","Expected list value");Eb=this.Bb.query.at(null,
Eb);if(!Object(L.a)(1263,Eb))throw Error.invalidOperation("Query did not return list value");if(cb.b3!==Eb.b3)return!1;switch(this.e7){case 0:return H.Annotations.Nmb(H.Annotations.Yzl(cb.b3),cb,Eb);case 1:for(const ec of cb.items)for(const Cc of Eb.items)if(H.Annotations.Nmb(cb.b3,ec,Cc))return!0;return!1;case 2:for(const ec of cb.items)for(const Cc of Eb.items)if(!H.Annotations.Nmb(cb.b3,ec,Cc))return!1;return!0;case 3:for(const ec of Eb.items)for(const Cc of cb.items)if(!H.Annotations.Nmb(cb.b3,
ec,Cc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ka,"QueryListFilter",null,[1278]);class ia{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb,Eb){if("string"!==typeof cb)throw Error.argument("objToTest","Expected string");Eb=this.Bb.query.at(null,Eb);if("string"!==typeof Eb)throw Error.invalidOperation("Query did not return string");this.Bb.Rpf&&(cb=cb.toUpperCase(),Eb=Eb.toUpperCase());switch(this.e7){case 0:return cb===Eb;case 1:return 0<=cb.indexOf(Eb);case 2:return cb.startsWith(Eb);
case 3:return cb.endsWith(Eb);case 4:return 0<=Eb.indexOf(cb);case 5:return Eb.startsWith(cb);case 6:return Eb.endsWith(cb);default:throw Error.notImplemented();}}}Object(l.a)(ia,"QueryStringFilter",null,[1278]);class La{constructor(cb,Eb){cb&&(this.query=Eb.aK(cb.J(0)),this.Rpf=1===cb.J(1))}}Object(l.a)(La,"QueryStringFilterInit",null,[]);class va{constructor(cb){this.Bb=cb}isMatch(cb,Eb){if(!Object(L.a)(1264,cb))throw Error.argument("objToTest","Expected struct value");Eb=this.Bb.query.at(null,
Eb);if(!Object(L.a)(1264,Eb))throw Error.invalidOperation("Query did not return struct value");return cb.isEqual(cb)}}Object(l.a)(va,"QueryStructFilter",null,[1278]);class Ga{constructor(cb){this.Bb=cb}isMatch(cb,Eb){cb=this.Bb.query.at(null,Eb);if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(Ga,"QueryWhereConstraintFilter",null,[1278]);class Oa{constructor(cb){this.Bb=cb}isMatch(cb){if("string"!==typeof cb)throw Error.argument("objToTest",
"Expected string");return this.Bb.yRf.test(cb)}}Object(l.a)(Oa,"RegexStringFilter",null,[1278]);class Za{constructor(cb,Eb){cb&&(this.yRf=Eb.M3b(cb.J(0)))}}Object(l.a)(Za,"RegexStringFilterInit",null,[]);class ja{constructor(cb,Eb){cb&&(this.filter=Eb.Bla(cb.J(0)))}}Object(l.a)(ja,"SingleFilterFilterInit",null,[]);class ba{constructor(cb,Eb){cb&&(this.query=Eb.aK(cb.J(0)))}}Object(l.a)(ba,"SingleQueryFilterInit",null,[]);class qa{constructor(cb){this.Bb=cb}isMatch(cb){if("boolean"!==typeof cb)throw Error.argument("objToTest",
"Expected bool value");return cb===this.Bb.value}}Object(l.a)(qa,"StoredValueBooleanFilter",null,[1278]);class Ma{constructor(cb){cb&&(this.value=1===cb.J(0))}}Object(l.a)(Ma,"StoredValueBooleanFilterInit",null,[]);class Ia{constructor(cb,Eb){this.Bb=cb;this.e7=Eb}isMatch(cb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");switch(this.e7){case 0:return this.Bb.SPd?this.Bb.value?!!(cb&this.Bb.value):!cb:cb===this.Bb.value;case 1:return this.Bb.SPd?(cb&this.Bb.value)===
this.Bb.value:32>cb&&(1<<cb&this.Bb.value)===this.Bb.value;case 2:return this.Bb.SPd?!!(cb&this.Bb.value):32>cb&&!!(1<<cb&this.Bb.value);default:throw Error.notImplemented();}}}Object(l.a)(Ia,"StoredValueEnumFilter",null,[1278]);class wa{constructor(cb){cb&&(this.SPd=1===cb.J(0),this.value=cb.J(1))}}Object(l.a)(wa,"StoredValueEnumFilterInit",null,[]);class za{constructor(){this.E4m=null;this.mVe=this.tCb=0}}Object(l.a)(za,"WHEREConstraintData",null,[]);class pa{constructor(cb){this.Bb=cb}isMatch(cb,
Eb){if(!Object(L.a)(za,cb))throw Error.argument("objToTest","Expected WHERE constraint data");let ec=-1,Cc=-1;const Pc=cb.E4m;switch(this.Bb.eWe){case 4:ec=Pc.DGc;Cc=Pc.h2f;break;case 5:ec=cb.tCb;Cc=Pc.DGc-cb.tCb;break;case 6:ec=Pc.DGc+Pc.h2f;Cc=cb.tCb+cb.mVe-ec;break;case 1:case 2:case 3:let jd=!1;for(let pe=Pc.REo;pe;pe=pe.next)if(this.Bb.fro===pe.name){jd=!0;1===this.Bb.eWe?(ec=pe.DGc,Cc=pe.h2f):2===this.Bb.eWe?(ec=cb.tCb,Cc=pe.DGc-cb.tCb):(ec=pe.DGc+pe.h2f,Cc=cb.tCb+cb.mVe-ec);break}if(!jd)return!1;
break;case 7:ec=cb.tCb;Cc=cb.mVe;break;default:throw Error.notImplemented();}return null!==this.Bb.D3n.SHo(Pc.tOo,ec,Cc,ec,!0,2,Eb)}}Object(l.a)(pa,"SubSreWhereConstraintFilter",null,[1278]);class Ba{constructor(cb,Eb){if(cb){var ec=Eb.nE(cb.J(0));this.eWe=ec.charCodeAt(0);this.fro=ec.substr(1);this.D3n=Eb.rJl(cb.J(1))}}}Object(l.a)(Ba,"SubSreWhereConstraintFilterInit",null,[]);class Ra{constructor(cb){this.Bb=cb}isMatch(cb,Eb,ec=null){if(!Object(L.a)(1261,cb))throw Error.argument("objToTest","Expected feature bundle");
if(null==ec)throw Error.argumentNull("parentTextForSpan");if(this.Bb.Bch&&!this.Bb.Bch.isMatch(cb,Eb))return!1;if(this.Bb.M5f){let Cc;if(({value:Cc}=cb.mq(this.Bb.z2n)).returnValue){if(!this.Bb.M5f.isMatch(Cc,Eb))return!1}else{let Pc,jd;if(!({value:Pc}=cb.mq(this.Bb.l8i)).returnValue||!({value:jd}=cb.mq(this.Bb.k8i)).returnValue||0>Pc||0>jd||Pc+jd>ec.length||!this.Bb.M5f.isMatch(ec.substr(Pc,jd),Eb))return!1}}if(this.Bb.h9i){let Cc;if(!({value:Cc}=cb.mq(this.Bb.l8i)).returnValue||!this.Bb.h9i.isMatch(Cc,
Eb))return!1}if(this.Bb.kmi){let Cc;if(!({value:Cc}=cb.mq(this.Bb.k8i)).returnValue||!this.Bb.kmi.isMatch(Cc,Eb))return!1}return!0}}Object(l.a)(Ra,"TextSpanFilter",null,[1278]);class fb{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.l8i=cb.J(0),this.k8i=cb.J(1),this.z2n=cb.J(2),this.M5f=cb.J(3)?Eb.Bla(cb.J(3)):null,this.Bch=cb.J(4)?Eb.Bla(cb.J(4)):null,this.h9i=cb.J(5)?Eb.Bla(cb.J(5)):null,this.kmi=cb.J(6)?Eb.Bla(cb.J(6)):null)}}Object(l.a)(fb,"TextSpanFilterInit",null,[]);class Va{constructor(cb,
Eb){cb&&(this.annotations=Eb.annotations,this.Rra=cb.J(0),this.V$f=cb.J(1)?Eb.Bla(cb.J(1)):null)}}Object(l.a)(Va,"ValueFilterAnnotationFilterInit",null,[]);var ib=c(1474);class Xa{Bla(cb,Eb){const ec=cb.J(0),Cc=new ib.a;Cc.rdb(cb,1,cb.count-1);switch(ec){case 1:return new P(new S(Cc,Eb),0);case 2:return new P(new S(Cc,Eb),1);case 3:return new P(new S(Cc,Eb),2);case 101:return new Oa(new Za(Cc,Eb));case 103:return new ia(new La(Cc,Eb),0);case 104:return new ia(new La(Cc,Eb),1);case 105:return new ia(new La(Cc,
Eb),2);case 106:return new ia(new La(Cc,Eb),3);case 107:return new ia(new La(Cc,Eb),4);case 108:return new ia(new La(Cc,Eb),5);case 109:return new ia(new La(Cc,Eb),6);case 201:return new qa(new Ma(Cc));case 202:return new ra(new ba(Cc,Eb));case 301:return new W(new X(Cc,Eb),0);case 302:return new W(new X(Cc,Eb),1);case 303:return new W(new X(Cc,Eb),2);case 304:return new W(new X(Cc,Eb),3);case 305:return new W(new X(Cc,Eb),4);case 401:return new Ia(new wa(Cc),0);case 402:return new Ia(new wa(Cc),
1);case 403:return new Ia(new wa(Cc),2);case 404:return new sa(new oa(Cc,Eb),0);case 405:return new sa(new oa(Cc,Eb),1);case 406:return new sa(new oa(Cc,Eb),2);case 407:return new sa(new oa(Cc,Eb),3);case 501:return new J(new I(Cc,Eb));case 502:return new va(new ba(Cc,Eb));case 601:return new N(new ja(Cc,Eb),0);case 602:return new N(new ja(Cc,Eb),1);case 603:return new G(new ja(Cc,Eb));case 604:return new ka(new ba(Cc,Eb),0);case 605:return new ka(new ba(Cc,Eb),1);case 606:return new ka(new ba(Cc,
Eb),2);case 607:return new ka(new ba(Cc,Eb),3);case 701:return new K(!1);case 702:return new K(!0);case 703:return new F(new Va(Cc,Eb),!1);case 704:return new F(new Va(Cc,Eb),!0);case 705:return new M(new Va(Cc,Eb),!1);case 706:return new M(new Va(Cc,Eb),!0);case 707:return new ca(new ha(Cc,Eb));case 901:return new Ra(new fb(Cc,Eb));case 1002:return new Ga(new ba(Cc,Eb));case 1001:return new pa(new Ba(Cc,Eb));default:throw Error.argument("initData");}}}Object(l.a)(Xa,"FilterFactory",null,[1260]);
var qb=c(1450);class rb{constructor(cb){this.Bb=cb}get fD(){return this.Bb.fD}get D3(){return this.Bb.D3}get W$d(){return this.Bb.W$d}get vOd(){return this.Bb.vOd}load(cb,Eb){return this.at(cb,cb?new Y("root",cb,Eb):Eb)}store(cb,Eb,ec){this.Kfc(cb,Eb,cb?new Y("root",cb,ec):ec,null)}at(cb,Eb){if(!this.vOd&&!this.Bb.annotations.g7b(this.fD,cb))throw Error.argument("input","Input value not of expected type");let ec=this.Bb.ZJh;for(;ec;)cb=ec.load(cb,Eb),ec=ec.next;return cb}Kfc(cb,Eb,ec,Cc){if(!this.W$d)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.vOd&&!this.Bb.annotations.g7b(this.fD,cb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.g7b(this.D3,Eb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.ZJh.store(cb,Eb,ec,Cc)}static Bph(cb,Eb,ec,Cc){if(ec===Cc)return Eb;if(H.Annotations.xH(ec)&&H.Annotations.xH(Cc)){ec=H.Annotations.QYa(ec);Cc=H.Annotations.QYa(Cc);const Pc=new qb.a(cb,Cc);for(const jd of Eb.items)Array.add(Pc.items,rb.Bph(cb,jd,ec,Cc));return Pc}if(ec===
H.Annotations.wFa){if(Cc===H.Annotations.Roa)return Eb;if(Cc===H.Annotations.h8)return Eb.toString()}else if(ec===H.Annotations.Roa){if(Cc===H.Annotations.wFa)return Math.floor(Eb);if(Cc===H.Annotations.h8)return Eb.toString()}else if(ec===H.Annotations.h8){if(Cc===H.Annotations.wFa)return parseInt(Eb);if(Cc===H.Annotations.Roa)return parseFloat(Eb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(rb,"AnnotationQuery",null,[1281]);class nb{constructor(){this.D3=
this.fD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}UYa(cb){if(this.next)return{returnValue:this.next,SEa:cb};if(cb){const Eb=cb.Fsh;cb=cb.IHi;return{returnValue:Eb,SEa:cb}}return{returnValue:null,SEa:cb}}}Object(l.a)(nb,"AnnotationQueryStep",null,[1312]);class Tb extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=this.Bb.query.at(cb,Eb);if(H.Annotations.xH(this.fD)){var ec=H.Annotations.QYa(this.fD);let Pc=new qb.a(this.Bb.annotations,ec);if(H.Annotations.xH(this.Bb.query.D3)){if(cb.items.length!==
Eb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let jd=0,pe=cb.items.length;jd<pe;++jd)Array.add(Pc.items,this.Etd(cb.items[jd],Eb.items[jd],ec===H.Annotations.Roa))}else for(var Cc of cb.items)Array.add(Pc.items,this.Etd(Cc,Eb,ec===H.Annotations.Roa));return Pc}if(H.Annotations.xH(this.Bb.query.D3)){Cc=new qb.a(this.Bb.annotations,this.fD);for(ec of Eb.items)Array.add(Cc.items,this.Etd(cb,ec,this.fD===H.Annotations.Roa));return Cc}return this.Etd(cb,
Eb,this.fD===H.Annotations.Roa)}Etd(cb,Eb,ec){cb=this.UYb(cb,Eb);return ec?cb:Math.floor(cb)}}Object(l.a)(Tb,"NumericAnnotationQueryStep",nb,[]);class Zb extends Tb{constructor(cb){super(cb)}UYb(cb,Eb){return cb+Eb}}Object(l.a)(Zb,"AddAnnotationQueryStep",Tb,[]);class Hb extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){if(this.fD===H.Annotations.Fwa&&this.Bb.query.D3===H.Annotations.Fwa){let Pc;if(({result:Pc}=this.nlh(cb)).returnValue)return Pc}if(H.Annotations.xH(this.fD)){var ec=new qb.a(this.Bb.annotations,
H.Annotations.Fwa);Eb=this.Bb.query.at(cb,Eb);if(H.Annotations.xH(this.Bb.query.D3)){if(cb.items.length!==Eb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Pc=0,jd=cb.items.length;Pc<jd;++Pc)Array.add(ec.items,this.UBc(Eb.items[Pc],cb.items[Pc]))}else for(var Cc of cb.items)Array.add(ec.items,this.UBc(Eb,Cc));return ec}Cc=this.Bb.query.at(cb,Eb);if(H.Annotations.xH(this.Bb.query.D3)){Eb=new qb.a(this.Bb.annotations,H.Annotations.Fwa);for(ec of Cc.items)Array.add(Eb.items,
this.UBc(ec,cb));return Eb}return this.UBc(Cc,cb)}}Object(l.a)(Hb,"BinaryBooleanAnnotationQueryStep",nb,[]);class Sa extends Hb{constructor(cb){super(cb)}nlh(cb){return{returnValue:!cb,result:!1}}UBc(cb,Eb){return cb&&Eb}}Object(l.a)(Sa,"AndAnnotationQueryStep",Hb,[]);class ua{constructor(cb){cb&&(this.annotations=cb)}}Object(l.a)(ua,"AnnotationsOnlyQueryStepInit",null,[]);class Fa extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=this.Bb.query.at(cb,Eb);cb=cb.clone();H.Annotations.xH(this.Bb.query.D3)?
Array.addRange(cb.items,Eb.items):Array.add(cb.items,Eb);return cb}}Object(l.a)(Fa,"AppendAnnotationQueryStep",nb,[]);class Pa extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){if(this.fD===H.Annotations.HU)return this.QFc(cb,Eb);const ec=new qb.a(this.Bb.annotations,H.Annotations.HU);for(const Cc of cb.items)Array.add(ec.items,this.QFc(Cc,Eb));return ec}QFc(cb,Eb){const ec=new E.a(this.Bb.annotations);ec.PWa(cb);cb=new E.a(this.Bb.annotations);this.Bb.script.eLa(null,new Y("Input",ec,new Y("Output",
cb,Eb)));return cb}}Object(l.a)(Pa,"ApplyAnnotationQueryStep",nb,[]);class Ea extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){if(this.fD===H.Annotations.HU)return Eb=this.QFc(cb,Eb),Eb.mq(this.Bb.zch).returnValue||new qb.a(this.Bb.annotations,H.Annotations.HU),Eb;const ec=new qb.a(this.Bb.annotations,H.Annotations.HU);for(const Cc of cb.items)if(cb=this.QFc(Cc,Eb),({value:cb}=cb.mq(this.Bb.zch)).returnValue)for(const Pc of cb.items)Array.add(ec.items,Pc);return ec}QFc(cb,Eb){const ec=new E.a(this.Bb.annotations);
ec.PWa(cb);cb=new E.a(this.Bb.annotations);this.Bb.script.eLa(null,new Y("Input",ec,new Y("Output",cb,Eb)));return cb}}Object(l.a)(Ea,"ApplyExpandAnnotationQueryStep",nb,[]);class lb{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.script=Eb.gAb(cb.J(0)),this.zch=cb.J(1))}}Object(l.a)(lb,"ApplyExpandQueryStepInit",null,[]);class zb{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.script=Eb.gAb(cb.J(0)))}}Object(l.a)(zb,"ApplyQueryStepInit",null,[]);class Xb extends nb{constructor(cb){super();
this.Bb=cb}load(cb){if(this.fD===H.Annotations.HU)return this.xTd(cb);const Eb=new qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Rra));for(const ec of cb.items)Array.add(Eb.items,this.xTd(ec));return Eb}store(cb,Eb,ec,Cc){if(this.fD===H.Annotations.HU){var Pc=Eb,jd=({SEa:Cc}=this.UYa(Cc)).returnValue;jd&&(Pc=jd.store(H.Annotations.CS(this.xTd(cb)),Eb,ec,Cc));cb.jy(this.Bb.Rra,Pc)}else{var pe=Eb;if(Pc=({SEa:Cc}=this.UYa(Cc)).returnValue){pe=new qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Rra));
for(jd of cb.items)Array.add(pe.items,this.xTd(jd));pe=Pc.store(pe,Eb,ec,Cc)}Eb=pe;if(Eb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ue=0,Od=cb.items.length;ue<Od;++ue)ec=cb.items[ue],ec.isReadOnly&&(ec=ec.clone(),cb.items[ue]=ec),ec.jy(this.Bb.Rra,Eb.items[ue])}return cb}xTd(cb){({value:cb}=cb.mq(this.Bb.Rra)).returnValue||(cb=this.Bb.annotations.rkl(this.Bb.Rra));return cb}}Object(l.a)(Xb,"AttrAnnotationQueryStep",nb,
[]);class ub{constructor(cb,Eb){cb&&(this.annotations=Eb,this.Rra=cb.J(0))}}Object(l.a)(ub,"AttrQueryStepInit",null,[]);class Pb extends nb{constructor(cb){super();this.Bb=cb}load(cb){const Eb=new E.a(this.Bb.annotations);Eb.PWa(cb);return this.Bb.module.execute(Eb)}}Object(l.a)(Pb,"CallModuleAnnotationQueryStep",nb,[]);class yc{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.module=Eb.ggf(cb.J(0)))}}Object(l.a)(yc,"CallModuleQueryStepInit",null,[]);class bc extends nb{constructor(cb){super();
this.Bb=cb}load(cb,Eb){if(H.Annotations.xH(this.fD)){var ec=this.Bb.query.at(cb,Eb);Eb=new qb.a(this.Bb.annotations,H.Annotations.h8);let jd="string"===typeof ec;for(var Cc of cb.items)if(jd)Array.add(Eb.items,Cc+ec);else for(var Pc of ec.items)Array.add(Eb.items,Cc+Pc);return Eb}Cc=this.Bb.query.at(cb,Eb);if("string"===typeof Cc)return cb+Cc;Pc=new qb.a(this.Bb.annotations,H.Annotations.h8);for(ec of Cc.items)Array.add(Pc.items,cb+ec);return Pc}}Object(l.a)(bc,"ConcatAnnotationQueryStep",nb,[]);
class Ka extends nb{constructor(cb){super();this.Bb=cb}load(cb){return rb.Bph(this.Bb.annotations,cb,this.fD,this.D3)}}Object(l.a)(Ka,"ConvertAnnotationQueryStep",nb,[]);class Bb extends nb{constructor(){super()}load(cb){return cb.items.length}}Object(l.a)(Bb,"CountAnnotationQueryStep",nb,[]);class tb extends Tb{constructor(cb){super(cb)}UYb(cb,Eb){return cb/Eb}}Object(l.a)(tb,"DivideAnnotationQueryStep",Tb,[]);class Kb extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=new Y(this.Bb.Yde,
null,Eb);for(const ec of cb.items)if(Eb.wWe(ec),this.Bb.query.at(ec,Eb))return!0;return!1}}Object(l.a)(Kb,"ExistsAnnotationQueryStep",nb,[]);class Ib extends Tb{constructor(cb){super(cb)}UYb(cb,Eb){return Math.pow(cb,Eb)}}Object(l.a)(Ib,"ExpAnnotationQueryStep",Tb,[]);class Wa{constructor(cb,Eb){cb&&(this.mLa=Eb.nE(cb.J(0)))}}Object(l.a)(Wa,"FeatureBundleNameQueryStepInit",null,[]);class vc extends nb{constructor(cb){super();this.Bb=cb}load(cb){if(H.Annotations.xH(this.fD)){const Eb=new qb.a(this.Bb.annotations,
this.Bb.annotations.wBb(H.Annotations.QYa(this.fD),this.Bb.oLa));for(const ec of cb.items)Array.add(Eb.items,ec.Vdb(this.Bb.oLa));return Eb}return cb.Vdb(this.Bb.oLa)}store(cb,Eb,ec,Cc){if(H.Annotations.xH(this.fD)){var Pc=Eb,jd=({SEa:Cc}=this.UYa(Cc)).returnValue;if(jd){Pc=new qb.a(this.Bb.annotations,this.Bb.annotations.wBb(H.Annotations.QYa(this.fD),this.Bb.oLa));for(var pe of cb.items)Array.add(Pc.items,pe.Vdb(this.Bb.oLa));Pc=jd.store(Pc,Eb,ec,Cc)}Eb=Pc;if(Eb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let ue=0,Od=cb.items.length;ue<Od;++ue)ec=cb.items[ue],ec.isReadOnly&&(ec=ec.clone(),cb.items[ue]=ec),ec.CYf(this.Bb.oLa,Eb.items[ue])}else jd=Eb,(pe=({SEa:Cc}=this.UYa(Cc)).returnValue)&&(jd=pe.store(H.Annotations.CS(cb.Vdb(this.Bb.oLa)),Eb,ec,Cc)),cb.CYf(this.Bb.oLa,jd);return cb}}Object(l.a)(vc,"FieldAnnotationQueryStep",nb,[]);class Lc{constructor(cb,Eb){cb&&(this.annotations=Eb,this.oLa=cb.J(0))}}Object(l.a)(Lc,"FieldQueryStepInit",null,[]);class Gb extends nb{constructor(cb){super();this.Bb=
cb}load(cb,Eb){for(const ec of cb.items)if(this.Bb.filter.isMatch(ec,Eb))return ec;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(cb,Eb,ec,Cc){let Pc=Eb,jd=-1;for(let ue=0,Od=cb.items.length;ue<Od;ue++)if(this.Bb.filter.isMatch(cb.items[ue],ec)){jd=ue;break}if(0>jd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const pe=({SEa:Cc}=this.UYa(Cc)).returnValue;pe&&(Pc=pe.store(H.Annotations.CS(cb.items[jd]),Eb,ec,Cc));
cb.items[jd]=Pc;return cb}}Object(l.a)(Gb,"FirstItemMatchingAnnotationQueryStep",nb,[]);class pc extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=new Y(this.Bb.Yde,null,Eb);for(const ec of cb.items)if(Eb.wWe(ec),!this.Bb.query.at(ec,Eb))return!1;return!0}}Object(l.a)(pc,"ForAllAnnotationQueryStep",nb,[]);class Fc extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){cb=Eb?Eb.MFd(this.Bb.mLa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.mLa+
'"');return cb}store(cb,Eb,ec,Cc){cb=ec?ec.MFd(this.Bb.mLa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.mLa+'"');let Pc=Eb;const jd=({SEa:Cc}=this.UYa(Cc)).returnValue;jd&&(Pc=jd.store(cb,Eb,ec,Cc));cb!==Pc&&cb.PWa(Pc);return cb}}Object(l.a)(Fc,"GetAnnotationQueryStep",nb,[]);class ob{constructor(cb,Eb){this.LBj=cb;this.CSj=Eb}get Fsh(){return this.LBj}get IHi(){return this.CSj}}Object(l.a)(ob,"AnnotationQueryStoreContinuation",null,[1313]);class Fb extends nb{constructor(cb){super();
this.Bb=cb}load(cb,Eb){return this.Bb.Rae.at(cb,Eb)?this.Bb.Iej.at(cb,Eb):this.Bb.hCd?this.Bb.hCd.at(cb,Eb):cb}store(cb,Eb,ec,Cc){var Pc=this.Bb.Rae.at(cb,ec);this.next&&(Cc=new ob(this.next,Cc));if(Pc)return this.Bb.Iej.Kfc(cb,Eb,ec,Cc);if(this.Bb.hCd)return this.Bb.hCd.Kfc(cb,Eb,ec,Cc);Pc=Eb;let jd=null;Cc&&(jd=Cc.Fsh,Cc=Cc.IHi);jd&&(Pc=jd.store(H.Annotations.CS(cb),Eb,ec,Cc));return Pc}}Object(l.a)(Fb,"IfAnnotationQueryStep",nb,[]);class gb{constructor(cb,Eb){cb&&(this.Rae=Eb.aK(cb.J(0)),this.Iej=
Eb.aK(cb.J(1)),this.hCd=cb.J(2)?Eb.aK(cb.J(2)):null)}}Object(l.a)(gb,"IfQueryStepInit",null,[]);class Jb{constructor(cb,Eb){cb&&(this.U2l=Eb.aK(cb.J(0)),this.Bki=Eb.aK(cb.J(1)))}}Object(l.a)(Jb,"IndexAndItemQueryStepInit",null,[]);class Yb extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){const ec=this.Bb.U2l.at(cb,Eb);Eb=this.Bb.Bki.at(cb,Eb);cb=cb.clone();if(0>ec||ec>cb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(H.Annotations.xH(this.Bb.Bki.D3))for(let Cc=
0;Cc<Eb.items.length;++Cc)Array.insert(cb.items,ec+Cc,Eb.items[Cc]);else Array.insert(cb.items,ec,Eb);return cb}}Object(l.a)(Yb,"InsertAtAnnotationQueryStep",nb,[]);class tc extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){return!(!Eb||!Eb.MFd(this.Bb.mLa))}}Object(l.a)(tc,"IsDefinedAnnotationQueryStep",nb,[]);class Ec extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=this.zI(cb,Eb);return cb.items[Eb]}store(cb,Eb,ec,Cc){const Pc=this.zI(cb,ec);let jd=Eb;const pe=({SEa:Cc}=this.UYa(Cc)).returnValue;
pe&&(jd=pe.store(H.Annotations.CS(cb.items[Pc]),Eb,ec,Cc));cb.items[Pc]=jd;return cb}zI(cb,Eb){Eb=this.Bb.query.at(cb,Eb);if(0>Eb||Eb>=cb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Eb}}Object(l.a)(Ec,"ItemAnnotationQueryStep",nb,[]);class Vc extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){const ec=new qb.a(this.Bb.annotations,H.Annotations.QYa(this.fD));for(const Cc of cb.items)this.Bb.filter.isMatch(Cc,Eb)&&Array.add(ec.items,Cc);return ec}}
Object(l.a)(Vc,"ItemsMatchingAnnotationQueryStep",nb,[]);class Hd extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){Eb=this.zI(cb,Eb);return cb.items[cb.items.length-Eb-1]}store(cb,Eb,ec,Cc){const Pc=this.zI(cb,ec);let jd=Eb;const pe=({SEa:Cc}=this.UYa(Cc)).returnValue;pe&&(jd=pe.store(H.Annotations.CS(cb.items[cb.items.length-Pc-1]),Eb,ec,Cc));cb.items[cb.items.length-Pc-1]=jd;return cb}zI(cb,Eb){Eb=this.Bb.query?this.Bb.query.at(cb,Eb):0;if(0>Eb||Eb>=cb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Eb}}Object(l.a)(Hd,"LastItemAnnotationQueryStep",nb,[]);class qd extends nb{constructor(cb){super();this.Bb=cb}load(cb){if(H.Annotations.xH(this.fD)){const Eb=new qb.a(this.Bb.annotations,H.Annotations.wFa);for(const ec of cb.items)Array.add(Eb.items,ec.length);return Eb}return cb.length}}Object(l.a)(qd,"LengthAnnotationQueryStep",nb,[]);class me extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){if(H.Annotations.xH(this.fD)){const ec=new qb.a(this.Bb.annotations,H.Annotations.Fwa);
for(const Cc of cb.items)Array.add(ec.items,this.Bb.filter.isMatch(Cc,Eb));return ec}return this.Bb.filter.isMatch(cb,Eb)}}Object(l.a)(me,"MatchesAnnotationQueryStep",nb,[]);class Zc extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){return this.Bb.filter.isMatch(cb,Eb)}}Object(l.a)(Zc,"MatchesAsListAnnotationQueryStep",nb,[]);class Dc extends Tb{constructor(cb){super(cb)}UYb(cb,Eb){return cb%Eb}}Object(l.a)(Dc,"ModuloAnnotationQueryStep",Tb,[]);class ud extends Tb{constructor(cb){super(cb)}UYb(cb,
Eb){return cb*Eb}}Object(l.a)(ud,"MultiplyAnnotationQueryStep",Tb,[]);class Ce extends nb{constructor(cb){super();this.Bb=cb}load(cb){if(H.Annotations.xH(this.fD)){const Eb=new qb.a(this.Bb.annotations,H.Annotations.Fwa);for(const ec of cb.items)Array.add(Eb.items,!ec);return Eb}return!cb}}Object(l.a)(Ce,"NotAnnotationQueryStep",nb,[]);class ee extends Hb{constructor(cb){super(cb)}nlh(cb){return{returnValue:cb,result:!0}}UBc(cb,Eb){return cb||Eb}}Object(l.a)(ee,"OrAnnotationQueryStep",Hb,[]);class Uf extends nb{constructor(cb){super();
this.Bb=cb}load(cb,Eb){const ec=this.Bb.b3f.at(cb,Eb);cb=this.Bb.DCc.at(cb,Eb);Eb=new qb.a(this.Bb.annotations,H.Annotations.wFa);for(let Cc=0;Cc<cb;++Cc)Array.add(Eb.items,ec+Cc);return Eb}}Object(l.a)(Uf,"RangeAnnotationQueryStep",nb,[]);class te{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.filter=Eb.Bla(cb.J(0)))}}Object(l.a)(te,"SingleFilterQueryStepInit",null,[]);class Fe{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.query=cb.J(0)?Eb.aK(cb.J(0)):null)}}Object(l.a)(Fe,
"SingleOptionalQueryQueryStepInit",null,[]);class Qf{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.query=Eb.aK(cb.J(0)))}}Object(l.a)(Qf,"SingleQueryQueryStepInit",null,[]);class id{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.b3f=Eb.aK(cb.J(0)),this.DCc=cb.J(1)?Eb.aK(cb.J(1)):null)}}Object(l.a)(id,"StartAndCountOrLengthQueryStepInit",null,[]);class Gg extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){let ec;({startIndex:Eb,length:ec}=this.qId(cb,Eb));const Cc=
new qb.a(this.Bb.annotations,cb.b3);for(let Pc=0;Pc<ec;++Pc)Array.add(Cc.items,cb.items[Eb+Pc]);return Cc}store(cb,Eb,ec,Cc){let Pc,jd;({startIndex:Pc,length:jd}=this.qId(cb,ec));var pe=Eb;const ue=({SEa:Cc}=this.UYa(Cc)).returnValue;if(ue){pe=new qb.a(this.Bb.annotations,cb.b3);for(let Od=0;Od<jd;++Od)Array.add(pe.items,cb.items[Pc+Od]);pe=ue.store(pe,Eb,ec,Cc)}Eb=pe;for(ec=0;ec<jd;++ec)Array.removeAt(cb.items,Pc);for(let Od=0,zf=Eb.items.length;Od<zf;++Od)Array.insert(cb.items,Pc+Od,Eb.items[Od]);
return cb}qId(cb,Eb){let ec;ec=this.Bb.b3f.at(cb,Eb);if(0>ec)throw Error.invalidOperation("Invalid start index in Sublist() query step");Eb=this.Bb.DCc?this.Bb.DCc.at(cb,Eb):cb.items.length-ec;if(0>Eb||ec+Eb>cb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:ec,length:Eb}}}Object(l.a)(Gg,"SublistAnnotationQueryStep",nb,[]);class ad extends nb{constructor(cb){super();this.Bb=cb}load(cb,Eb){if(H.Annotations.xH(this.fD)){const ec=
new qb.a(this.Bb.annotations,H.Annotations.h8);for(let Cc=0,Pc=cb.items.length;Cc<Pc;++Cc)Array.add(ec.items,this.k0h(cb.items[Cc],Eb));return ec}return this.k0h(cb,Eb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}k0h(cb,Eb){let ec;({startIndex:Eb,length:ec}=this.qId(cb,Eb));return cb.substr(Eb,ec)}qId(cb,Eb){let ec;ec=this.Bb.b3f.at(cb,Eb);if(0>ec)throw Error.invalidOperation("Invalid start index in Substring() query step");Eb=this.Bb.DCc?this.Bb.DCc.at(cb,
Eb):cb.length-ec;if(0>Eb||ec+Eb>cb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:ec,length:Eb}}}Object(l.a)(ad,"SubstringAnnotationQueryStep",nb,[]);class Kd extends Tb{constructor(cb){super(cb)}UYb(cb,Eb){return cb-Eb}}Object(l.a)(Kd,"SubtractAnnotationQueryStep",Tb,[]);class jh extends nb{constructor(cb){super();this.Bb=cb}load(cb){const Eb=new qb.a(this.Bb.annotations,H.Annotations.h8);for(let ec=0;ec<cb.length;++ec)Array.add(Eb.items,
cb.charAt(ec).toString());return Eb}}Object(l.a)(jh,"ToCharListAnnotationQueryStep",nb,[]);class Qe extends nb{constructor(cb){super();this.Bb=cb}load(cb){const Eb=new qb.a(this.Bb.annotations,this.fD);Array.add(Eb.items,cb);return Eb}}Object(l.a)(Qe,"ToListAnnotationQueryStep",nb,[]);class zc extends nb{constructor(cb){super();this.Bb=cb}load(){return this.Bb.value}}Object(l.a)(zc,"ValueAnnotationQueryStep",nb,[]);class uc{constructor(cb,Eb){if(cb){var ec=cb.J(0),Cc=1;this.value=({ffa:Cc}=Eb.MKa(ec,
cb,Cc,null,null,null)).returnValue;H.Annotations.uFb(this.value)}}}Object(l.a)(uc,"ValueQueryStepInit",null,[]);class Ed{constructor(cb,Eb){cb&&(this.Yde=Eb.nE(cb.J(0)),this.query=Eb.aK(cb.J(1)))}}Object(l.a)(Ed,"VarNameAndQueryQueryStepInit",null,[]);class Of{constructor(cb,Eb){this.aGg=null;if(cb){this.annotations=Eb.annotations;var ec=0;this.fD=cb.J(ec);++ec;this.D3=cb.J(ec);++ec;this.W$d=1===cb.J(ec);++ec;this.vOd=1===cb.J(ec);++ec;var Cc=cb.J(ec);++ec;if(Cc){var Pc=ec,jd=ec+Cc,pe=ec+2*Cc;ec+=
3*Cc;var ue=cb.count-ec,Od=null;for(let Tf=0;Tf<Cc;++Tf){var zf=ec+cb.J(pe+Tf);const dc=(Tf===Cc-1?ue:cb.J(pe+Tf+1))-cb.J(pe+Tf),Oi=new ib.a;Oi.rdb(cb,zf,dc);zf=Of.ZBl(cb.J(jd+Tf),Oi,Eb);zf.fD=cb.J(Pc+Tf);zf.D3=Tf===Cc-1?this.D3:cb.J(Pc+Tf+1);Od?Od.next=zf:this.aGg=zf;Od=zf}}}}get ZJh(){return this.aGg}static ZBl(cb,Eb,ec){switch(cb){case 1:return new Fc(new Wa(Eb,ec));case 2:return new tc(new Wa(Eb,ec));case 3:return new Xb(new ub(Eb,ec.annotations));case 4:return new vc(new Lc(Eb,ec.annotations));
case 5:return new Fb(new gb(Eb,ec));case 6:return new me(new te(Eb,ec));case 43:return new Zc(new te(Eb,ec));case 45:return new Pa(new zb(Eb,ec));case 49:return new Ea(new lb(Eb,ec));case 46:return new zc(new uc(Eb,ec.annotations));case 51:return new Pb(new yc(Eb,ec));case 52:return new Uf(new id(Eb,ec));case 53:return new Ka(new ua(ec.annotations));case 13:return new Ec(new Qf(Eb,ec));case 14:return new Hd(new Fe(Eb,ec));case 15:return new Bb;case 18:return new Gb(new te(Eb,ec));case 16:return new pc(new Ed(Eb,
ec));case 17:return new Kb(new Ed(Eb,ec));case 22:return new Yb(new Jb(Eb,ec));case 24:return new Fa(new Qf(Eb,ec));case 26:return new Gg(new id(Eb,ec));case 27:return new Vc(new te(Eb,ec));case 30:return new Qe(new ua(ec.annotations));case 31:return new ad(new id(Eb,ec));case 32:return new bc(new Qf(Eb,ec));case 47:return new qd(new ua(ec.annotations));case 48:return new jh(new ua(ec.annotations));case 34:return new Zb(new Qf(Eb,ec));case 35:return new Kd(new Qf(Eb,ec));case 36:return new ud(new Qf(Eb,
ec));case 37:return new tb(new Qf(Eb,ec));case 38:return new Dc(new Qf(Eb,ec));case 39:return new Ib(new Qf(Eb,ec));case 40:return new Sa(new Qf(Eb,ec));case 41:return new ee(new Qf(Eb,ec));case 42:return new Ce(new ua(ec.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Of,"AnnotationQueryInit",null,[]);class $b{constructor(cb){this.Bb=cb}execute(cb,Eb){this.eLa(cb,cb?new Y("root",cb,Eb):Eb)}eLa(cb,Eb){for(const ec of this.Bb.commands)Eb=ec.execute(cb,Eb)}}Object(l.a)($b,
"AnnotationScript",null,[1282]);class xc{constructor(cb){this.Bb=cb}execute(cb,Eb){const ec=this.Bb.P6l.at(cb,Eb),Cc=this.Bb.y2m.at(cb,Eb);this.Bb.script.eLa(cb,new Y("Input",ec,new Y("Output",Cc,Eb)));return Eb}}Object(l.a)(xc,"ApplyAnnotationScriptCommand",null,[1305]);class Yc{constructor(cb,Eb){cb&&(this.P6l=Eb.aK(cb.J(0)),this.y2m=Eb.aK(cb.J(1)),this.script=Eb.gAb(cb.J(2)))}}Object(l.a)(Yc,"ApplyScriptCommandInit",null,[]);class wd{constructor(cb){this.Bb=cb}execute(cb,Eb){const ec=this.Bb.jWf.at(cb,
Eb);this.Bb.hUd.Kfc(cb,ec,Eb,null);return Eb}}Object(l.a)(wd,"AssignAnnotationScriptCommand",null,[1305]);class le{constructor(cb){this.Bb=cb}execute(cb,Eb){const ec=this.Bb.hUd.at(cb,Eb);cb=this.Bb.jWf.at(cb,Eb);ec!==cb&&ec.PWa(cb);return Eb}}Object(l.a)(le,"CopyAnnotationScriptCommand",null,[1305]);class uf{constructor(cb){this.Bb=cb}execute(cb,Eb){let ec=this.Bb.lxf.at(cb,Eb);if(this.Bb.lxf.W$d){ec=H.Annotations.CS(ec);var Cc=new Y(this.Bb.mLa,null,Eb);for(let jd=0,pe=ec.items.length;jd<pe;++jd){var Pc=
this.NGh(cb,ec.items[jd],Cc);if(0>this.Bb.U4d)ec.items[jd]=Pc;else if(({value:Pc}=Pc.mq(this.Bb.U4d)).returnValue)ec.items[jd]=Pc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.lxf.Kfc(cb,ec,Eb,null)}else{Cc=new Y(this.Bb.mLa,null,Eb);for(let jd=0,pe=ec.items.length;jd<pe;++jd)this.NGh(cb,ec.items[jd],Cc)}return Eb}NGh(cb,Eb,ec){let Cc;0>this.Bb.U4d?Cc=H.Annotations.CS(Eb):(Cc=new E.a(this.Bb.annotations),Cc.jy(this.Bb.U4d,Eb));ec.wWe(Cc);
this.Bb.tkk.eLa(cb,ec);return Cc}}Object(l.a)(uf,"EnumerateAnnotationScriptCommand",null,[1305]);class yg{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.mLa=Eb.nE(cb.J(0)),this.lxf=Eb.aK(cb.J(1)),this.tkk=Eb.gAb(cb.J(2)),this.U4d=cb.J(3))}}Object(l.a)(yg,"EnumerateScriptCommandInit",null,[]);class pb{constructor(cb){this.Bb=cb}execute(cb,Eb){this.Bb.Rae.at(cb,Eb)?this.Bb.beo.eLa(cb,Eb):this.Bb.OHh&&this.Bb.OHh.eLa(cb,Eb);return Eb}}Object(l.a)(pb,"IfAnnotationScriptCommand",null,[1305]);
class Wb{constructor(cb,Eb){cb&&(this.Rae=Eb.aK(cb.J(0)),this.beo=Eb.gAb(cb.J(1)),this.OHh=cb.J(2)?Eb.gAb(cb.J(2)):null)}}Object(l.a)(Wb,"IfScriptCommandInit",null,[]);class Oc{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.hUd=Eb.aK(cb.J(0)),this.jWf=Eb.aK(cb.J(1)))}}Object(l.a)(Oc,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class nd{constructor(cb){this.Bb=cb}execute(cb,Eb){const ec=this.Bb.jWf.at(this.Bb.hUd.at(cb,Eb),Eb);this.Bb.hUd.Kfc(cb,ec,Eb,null);return Eb}}Object(l.a)(nd,
"ModifyAnnotationScriptCommand",null,[1305]);class ve{constructor(cb){this.Bb=cb}execute(cb,Eb){const ec=new E.a(this.Bb.annotations);this.Bb.query&&ec.PWa(this.Bb.query.at(cb,Eb));return Eb=new Y(this.Bb.mLa,ec,Eb)}}Object(l.a)(ve,"NewAnnotationScriptCommand",null,[1305]);class nf{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.mLa=Eb.nE(cb.J(0)),this.query=cb.J(1)?Eb.aK(cb.J(1)):null)}}Object(l.a)(nf,"NewScriptCommandInit",null,[]);class pf{constructor(cb){this.Bb=cb}execute(cb,Eb){cb=
this.Bb.query.at(cb,Eb);if(this.Bb.query.D3===H.Annotations.HU)cb.gPa(this.Bb.Rra);else for(const ec of cb.items)ec.gPa(this.Bb.Rra);return Eb}}Object(l.a)(pf,"RemoveAnnotationScriptCommand",null,[1305]);class Mg{constructor(cb,Eb){cb&&(this.annotations=Eb.annotations,this.query=Eb.aK(cb.J(0)),this.Rra=cb.J(1))}}Object(l.a)(Mg,"RemoveScriptCommandInit",null,[]);class Jg{constructor(cb,Eb){if(cb){var ec=0,Cc=cb.J(ec);++ec;if(Cc){var Pc=ec,jd=ec+Cc;ec+=2*Cc;var pe=cb.count-ec;this.commands=Array(Cc);
for(let ue=0;ue<Cc;++ue){const Od=ec+cb.J(jd+ue),zf=(ue===Cc-1?pe:cb.J(jd+ue+1))-cb.J(jd+ue),Tf=new ib.a;Tf.rdb(cb,Od,zf);this.commands[ue]=Jg.PBl(cb.J(Pc+ue),Tf,Eb)}}}}static PBl(cb,Eb,ec){switch(cb){case 1:return new wd(new Oc(Eb,ec));case 2:return new nd(new Oc(Eb,ec));case 3:return new pf(new Mg(Eb,ec));case 6:return new ve(new nf(Eb,ec));case 7:return new uf(new yg(Eb,ec));case 8:return new pb(new Wb(Eb,ec));case 9:return new le(new Oc(Eb,ec));case 10:return new xc(new Yc(Eb,ec));default:throw Error.argument("initData");
}}}Object(l.a)(Jg,"AnnotationScriptInit",null,[]);var rh=c(1578);class Tg{constructor(cb){this.q0=cb;this.wx=0}y7(){const cb=this.q0.hy(this.wx,4);this.wx+=4;return cb}get tzc(){return this.q0}get offset(){return this.wx}set offset(cb){this.wx=cb}}Object(l.a)(Tg,"ByteArrayReader",null,[]);class ak{constructor(){this.VI=null;this.hqi=this.Haa=0}J(cb){if(0>cb||cb>=this.Haa)throw Error.argumentOutOfRange("index");return this.VI.hy(this.hqi+4*cb,4)}get count(){return this.Haa}static xLk(cb,Eb,ec){const Cc=
new ak;Cc.VI=cb;Cc.hqi=Eb;Cc.Haa=ec;return Cc}}Object(l.a)(ak,"ReadOnlyListOverByteArray",null,[1279]);class ci{constructor(cb,Eb){this.aqi=this.$pi=!1;this.Sv=this.RNa=this.Pyf=this.dqi=null;try{this.Sv=Eb.annotations;const ec=Eb.Hdb(cb.J(0)),Cc=new Tg(ec);if(-914743053!==Cc.y7())throw Error.argument("Input does not represent a flat lexicon");this.$pi=1===Cc.y7();this.aqi=1===Cc.y7();const Pc=Cc.y7();Cc.offset+=Pc;const jd=Cc.y7();this.Pyf=ci.J4m(Cc,jd,this.Sv);const pe=Cc.y7();this.dqi=ci.$4m(Cc,
pe);const ue=Cc.y7();this.RNa=new rh.a(Cc.tzc,Cc.offset);Cc.offset+=ue}catch(ec){throw Error.argument("initData");}}get trie(){return this.RNa}jml(cb){return"i"===cb&&this.aqi?"\u0130":cb.toUpperCase()}Rpf(){return this.$pi}Hjl(cb){let Eb;Eb=new qb.a(this.Sv,H.Annotations.HU);if(1!==cb)if(0===cb)cb=new E.a(this.Sv),Array.add(Eb.items,cb);else if(cb&1073741824){cb=this.dqi[cb&-1073741825];for(let Cc=0;Cc<cb.length;++Cc){var ec=cb[Cc];ec=0===ec?new E.a(this.Sv):this.Pyf[ec-2];Array.add(Eb.items,ec)}}else Array.add(Eb.items,
this.Pyf[cb-2]);return{returnValue:!0,vtm:Eb}}static J4m(cb,Eb,ec){if(Eb%4)throw Error.argument("reader");const Cc=ak.xLk(cb.tzc,cb.offset,Eb/4);cb.offset+=Eb;cb=[];for(Eb=0;Eb<Cc.count;){const Pc=({ffa:Eb}=ec.MKa(H.Annotations.HU,Cc,Eb,null,null,null)).returnValue;Array.add(cb,Pc)}return cb}static $4m(cb,Eb){Eb=cb.offset+Eb;const ec=[];for(;cb.offset<Eb;){const Cc=cb.y7(),Pc=Array(Cc);for(let jd=0;jd<Cc;++jd){const pe=cb.y7();Pc[jd]=pe}Array.add(ec,Pc)}return ec}}Object(l.a)(ci,"RawFlatLexicon",
null,[1280]);var Af=c(1570),Ef=c(1571);class Ue{constructor(cb){if(null==cb)throw Error.argumentNull("base64String");const Eb=cb.length;if(Eb%4)throw Error.argument("base64String's length must be a multiple of 4");this.Haa=.75*Eb;this.FFb=Array(Math.ceil(this.Haa/4));cb.endsWith("==")?this.Haa-=2:cb.endsWith("=")&&--this.Haa;let ec=0;for(let Cc=0;Cc<Eb;Cc+=4){const Pc=Ue.E5d[cb.charCodeAt(Cc)-43]<<18|Ue.E5d[cb.charCodeAt(Cc+1)-43]<<12|Ue.E5d[cb.charCodeAt(Cc+2)-43]<<6|Ue.E5d[cb.charCodeAt(Cc+3)-43];
let jd=Pc>>16&255;this.FFb[Math.floor(ec/4)]|=jd<<ec%4*8;++ec;jd=Pc>>8&255;this.FFb[Math.floor(ec/4)]|=jd<<ec%4*8;++ec;jd=Pc&255;this.FFb[Math.floor(ec/4)]|=jd<<ec%4*8;++ec}}get length(){return this.Haa}J(cb){if(0>cb||cb>=this.Haa)throw Error.argumentOutOfRange("i");return this.sOh(cb)}hy(cb,Eb){if(0>cb||0>Eb||cb+Eb>this.Haa)throw Error.argument("Bad range");let ec=0;for(let Cc=0;Cc<Eb;++Cc)ec|=this.sOh(cb+Cc)<<8*Cc;return ec}Nin(cb,Eb){let ec=0,Cc=0,Pc=Math.floor(cb/8);for(cb%=8;Cc<Eb;){const jd=
8-cb>Eb-Cc?Eb-Cc:8-cb,pe=this.J(Pc);ec|=(pe>>cb&~(255<<jd))<<Cc;Cc+=jd;++Pc;cb=0}return ec}sOh(cb){return this.FFb[Math.floor(cb/4)]>>cb%4*8&255}}Ue.E5d=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Ue,"ByteArray",null,[]);class Df{constructor(cb,Eb,ec){this.jD=cb;this.vFm=Eb;this.yFm=ec;this.pqi=Array(cb.b?cb.b.length:
0);this.mzf=new Af.a(new Ef.a(this.Hdb(this.jD.s)));this.c7=Array(cb.t.length);this.ED=new H.Annotations(this.Edb(0),this)}get annotations(){return this.ED}get L0k(){return this.jD.d}mBl(){if(!(""in this.jD.m))throw Error.argument("name","Unrecognized module");return this.ggf(this.jD.m[""])}Hdb(cb){if(0>cb||!this.jD.b||cb>=this.jD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.pqi[cb]||(this.pqi[cb]=new Ue(this.jD.b[cb]))}nE(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.c7[cb]){const Eb=this.Edb(cb).J(0);this.c7[cb]=this.mzf.nE(Eb)}return this.c7[cb]}M3b(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.c7[cb]){var Eb=this.Edb(cb);const ec=this.nE(Eb.J(0));Eb=1===Eb.J(1);this.c7[cb]=new RegExp(ec,Eb?"i":"")}return this.c7[cb]}rJl(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}ggf(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not an NL module");return this.c7[cb]||(this.c7[cb]=this.yFm.FBl(this.Edb(cb),this))}aK(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.c7[cb]||(this.c7[cb]=new rb(new Of(this.Edb(cb),this)))}gAb(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.c7[cb]||(this.c7[cb]=new $b(new Jg(this.Edb(cb),this)))}Bla(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not a filter");return this.c7[cb]||(this.c7[cb]=
this.vFm.Bla(this.Edb(cb),this))}BHl(cb){if(1>cb||cb>=this.jD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.jD.t[cb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.c7[cb]||(this.c7[cb]=new ci(this.Edb(cb),this))}Edb(cb){const Eb=this.jD.n[cb];cb=(cb<this.jD.t.length-1?this.jD.n[cb+1]:this.jD.n.length)-Eb;if(0>Eb||0>cb||Eb+cb>this.jD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Eb+","+cb+")");const ec=new ib.a;
ec.Daf(this.jD.n,Eb,cb);return ec}}Object(l.a)(Df,"ObjectFetcher",null,[1259]);class Sf{constructor(cb,Eb,ec){if(!cb)throw Error.argumentNull("prediction");if(!Eb)throw Error.argumentNull("fieldNames");if(!ec)throw Error.argumentNull("values");if(Eb.length!==ec.length)throw Error.argument("values","fieldNames and values do not have same length");this.qSj=cb;this.GFb=Eb;this.FRc=ec}get prediction(){return this.qSj}get lIh(){return this.GFb.length}tef(cb){return 0<=cb&&cb<this.GFb.length?this.GFb[cb]:
null}getValue(cb){return 0<=cb&&cb<this.FRc.length?this.FRc[cb]:null}}Object(l.a)(Sf,"PredictionData",null,[]);class Se{constructor(cb,Eb){if(!cb)throw Error.argumentNull("predictions");if(!Eb)throw Error.argumentNull("tokenAttributes");this.BFm=cb;this.FFm=Eb}ohf(){return this.BFm}lNh(){return this.FFm}}Object(l.a)(Se,"PredictionDataWithTokenAttributes",null,[]);class Ii{constructor(cb,Eb){this.prediction=null;this.score=0;this.prediction=cb;this.score=Eb}}Object(l.a)(Ii,"PredictionWithScore",null,
[]);class hg{constructor(cb,Eb){if(!cb)throw Error.argumentNull("predictions");if(!Eb)throw Error.argumentNull("attributes");this.rSj=cb;this.ayj=Eb}ohf(){return this.rSj}lNh(){return this.ayj}}Object(l.a)(hg,"PredictionsWithTokenAttributes",null,[]);class Fg{constructor(cb,Eb,ec){if(!cb)throw Error.argumentNull("attributeName");if(!Eb)throw Error.argumentNull("fieldNames");if(!ec)throw Error.argumentNull("values");if(Eb.length!==ec.length)throw Error.argument("values","fieldNames and values do not have same length");
this.$xj=cb;this.GFb=Eb;this.FRc=ec}get attributeName(){return this.$xj}get lIh(){return this.GFb.length}tef(cb){return 0<=cb&&cb<this.GFb.length?this.GFb[cb]:null}getValue(cb){return 0<=cb&&cb<this.FRc.length?this.FRc[cb]:null}}Object(l.a)(Fg,"TokenAttributes",null,[]);var qf=c(44),Cg=c(687);class Hh{constructor(cb,Eb,ec,Cc,Pc){this.q5c=0;this.Fbg=null;this.r5c=this.Cic=0;this.$ee=this.vNb=this.hpa=this.Dic=null;this.Gbg=0;this.kAe=this.gB=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.kR=cb;this.voj=this.zoj=Eb;this.uoj=this.xoj=ec;this.o5c=this.woj=Cc;this.p5c=this.yoj=Pc}Aoj(){this.r5c=0;return this.Dbg}Dbg(){if(!(this.r5c<this.o5c))return this.Ebg;this.Dic=this.voj.items[this.r5c+this.uoj];this.hpa=new E.a(this.kR.Bb.annotations);1!==this.o5c&&this.kR.Bb.pNc||this.hpa.PWa(this.Dic);if(0<=this.kR.Bb.QVd){({value:this.vNb}=this.hpa.mq(this.kR.Bb.QVd)).returnValue?this.vNb=this.vNb.CS():this.vNb=new qb.a(this.kR.Bb.annotations,
H.Annotations.HU);this.$ee=this.p5c.items;this.Gbg=this.$ee.length;for(this.q5c=0;this.q5c<this.Gbg;++this.q5c)this.Fbg=this.$ee[this.q5c],Array.add(this.vNb.items,this.Fbg);this.hpa.jy(this.kR.Bb.QVd,this.vNb)}else 0<=this.kR.Bb.U1f?this.hpa.jy(this.kR.Bb.U1f,this.p5c.items[0]):0<=this.kR.Bb.WTe?this.hpa.jy(this.kR.Bb.WTe,!0):this.kR.Bb.Pgi?this.p5c.items[0].GDd((cb,Eb)=>this.hpa.jy(cb,Eb)):(this.hpa.PWa(this.p5c.items[0]),1!==this.o5c&&this.kR.Bb.pNc||(({value:this.Cic}=this.Dic.mq(this.kR.Bb.M1)).returnValue&&
this.hpa.jy(this.kR.Bb.M1,this.Cic),({value:this.Cic}=this.Dic.mq(this.kR.Bb.I5)).returnValue&&this.hpa.jy(this.kR.Bb.I5,this.Cic),this.Dic.mq(this.kR.Bb.uab).returnValue&&this.hpa.jy(this.kR.Bb.uab,this.Cic)));this.gB=this.hpa;this._state=2;return this.Coj}Ebg(){this._state=3}Boj(){this.r5c++;return this.Dbg}Coj(){return 1<this.o5c&&this.kR.Bb.pNc?this.Ebg:this.Boj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Hh(this.kR,this.zoj,this.xoj,this.woj,this.yoj)).getEnumerator()}[Symbol.iterator](){return Object(Cg.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.kAe=this.Aoj());for(;1===this._state;)this.kAe=this.kAe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.gB}}Object(l.a)(Hh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,71,81]);class aj{constructor(cb,Eb,ec){this.CRc=this.iqi=0;this.y9b=null;this.nzf=this.Vyf=this.w9b=this.oUd=this.Yyf=
0;this.pUd=!1;this.hzf=cb;this.pzf=Eb;this.AFm=ec}$Vh(){null===this.y9b&&({Hbj:this.y9b,O7h:this.Yyf,length:this.oUd,o8k:cb}=this.hzf.G1h(this.pzf.items[this.CRc],this.AFm),this.pUd=cb||this.pUd);if(this.w9b<this.oUd){var cb=this.y9b.charAt(this.Yyf+this.w9b);++this.w9b;return{returnValue:!0,ch:cb}}if(this.CRc===this.pzf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.CRc;this.w9b=0;this.y9b=null;return{returnValue:!0,ch:" "}}cSf(cb,Eb){this.w9b===this.oUd&&this.y9b&&(this.nzf=Eb,this.Vyf=
this.CRc-this.iqi+1)}tzn(cb){if(0>cb||cb>=this.pzf.items.length)throw Error.argumentOutOfRange("iToken");this.CRc=this.iqi=cb;this.y9b=null;this.Vyf=this.w9b=this.oUd=this.Yyf=0;this.nzf=-1;this.pUd=!1}oAl(){return{Opk:this.Vyf,Vqm:this.nzf,n8k:this.pUd}}}Object(l.a)(aj,"TriePrefixVisitor",null,[1300]);class df{constructor(cb){this.Bb=cb}execute(cb){if(!({value:ec}=cb.mq(this.Bb.SJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Eb;({value:Eb}=cb.mq(this.Bb.XVa)).returnValue||
(Eb=null);var ec=this.Qil(ec,Eb);cb=H.Annotations.CS(cb);cb.jy(this.Bb.SJa,ec);return cb}Qil(cb,Eb){let ec=null;const Cc=this.Bb.flatLexicon.trie,Pc=new aj(this,cb,Eb);let jd=null;this.Bb.flatLexicon.Rpf()&&(jd=Object(qf.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.jml,"getCaseInsensitiveForm"));let pe=0,ue;var Od;let zf;for(;pe<cb.items.length;){const Tf=cb.items[pe];Pc.tzn(pe);Cc.Cmj(Pc,jd);({Opk:ue,Vqm:Od,n8k:zf}=Pc.oAl());if(0<ue){({vtm:Od}=this.Bb.flatLexicon.Hjl(Od));for(let dc of this.nNk(cb,
pe,ue,Od)){1<ue&&this.Bb.pNc&&this.dOk(cb,Eb,pe,Tf,ue,zf,dc);if(!ec)for(ec=new qb.a(this.Bb.annotations,H.Annotations.HU),Od=0;Od<pe;++Od)Array.add(ec.items,cb.items[Od]);Array.add(ec.items,dc)}pe+=ue}else ec&&Array.add(ec.items,Tf),++pe}return ec||cb}dOk(cb,Eb,ec,Cc,Pc,jd,pe){if(jd)jd=!0;else if(this.Bb.vgi){jd=!1;var ue=-1;for(var Od=0;Od<Pc;Od++){var zf=cb.items[ec+Od];let Ci;var Tf=void 0;if(!({value:Ci}=zf.mq(this.Bb.M1)).returnValue||!({value:Tf}=zf.mq(this.Bb.I5)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Od){if(Ci>ue+1){jd=!0;break}if(0>ue||null===Eb||ue>=Eb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Eb.charAt(ue)){jd=!0;break}}ue=Ci+Tf}}else jd=!1;if(jd){Tf=new Sys.StringBuilder;for(jd=0;jd<Pc;++jd)({Hbj:ue,O7h:Od,length:zf}=this.G1h(cb.items[ec+jd],Eb)),0<jd&&Tf.append(" "),Tf.append(ue.substr(Od,zf));pe.jy(this.Bb.uab,Tf.toString())}cb=cb.items[ec+Pc-1];let dc,Oi;({value:Cc}=Cc.mq(this.Bb.M1)).returnValue&&
({value:dc}=cb.mq(this.Bb.M1)).returnValue&&({value:Oi}=cb.mq(this.Bb.I5)).returnValue?(pe.jy(this.Bb.M1,Cc),pe.jy(this.Bb.I5,dc+Oi-Cc)):(pe.gPa(this.Bb.M1),pe.gPa(this.Bb.I5))}nNk(cb,Eb,ec,Cc){return new Hh(this,cb,Eb,ec,Cc)}G1h(cb,Eb){let ec,Cc;if(({value:ec}=cb.mq(this.Bb.uab)).returnValue)Cc=!0,Eb=0,cb=ec.length;else{Cc=!1;if(null===Eb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");ec=Eb;if(!({value:Eb}=cb.mq(this.Bb.M1)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:cb}=cb.mq(this.Bb.I5)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Eb||0>cb||Eb+cb>ec.length)throw Error.argument("Token start/length values out of range","token");}return{Hbj:ec,O7h:Eb,length:cb,o8k:Cc}}}Object(l.a)(df,"FlatLexiconNLModule",null,[1283]);class ld{constructor(cb,Eb){this.WTe=this.QVd=this.U1f=this.uab=this.I5=this.M1=this.XVa=this.SJa=0;this.Pgi=this.vgi=this.pNc=!1;this.flatLexicon=null;this.annotations=Eb.annotations;
let ec=0;try{this.SJa=cb.J(ec),++ec,this.XVa=cb.J(ec),++ec,this.M1=cb.J(ec),++ec,this.I5=cb.J(ec),++ec,this.uab=cb.J(ec),++ec,this.U1f=cb.J(ec),++ec,this.QVd=cb.J(ec),++ec,this.WTe=cb.J(ec),++ec,this.pNc=1===cb.J(ec),++ec,this.vgi=1===cb.J(ec),++ec,this.Pgi=1===cb.J(ec),++ec,this.flatLexicon=Eb.BHl(cb.J(ec))}catch(Cc){throw Error.argument("initData");}}}Object(l.a)(ld,"FlatLexiconNLModuleInit",null,[]);class dj{constructor(){this.CLc=0;this.z9e=null;this.xZc=0}}Object(l.a)(dj,"FeatureGenStackRec",
null,[]);class Yh{constructor(cb){this.C6f=Array(cb);this.Ngc=Array(cb);this.v3f=[];this.k$i=[]}}Object(l.a)(Yh,"TokenStringLattice",null,[]);const Nl=(cb,Eb,ec)=>{for(let Cc=0;Cc<cb.length;Cc++)ec=Eb(ec,cb[Cc]);return ec},ij=(cb,Eb)=>{const ec=Array(cb.length);for(let Cc=0;Cc<cb.length;Cc++)ec[Cc]=Eb(cb[Cc]);return ec},ck=(cb,Eb)=>{Eb=Array(Math.min(Eb,cb.length));for(let ec=0;ec<Eb.length;ec++)Eb[ec]=cb[ec];return Eb},Mk=(cb,Eb)=>{const ec=[];for(const Cc of cb)Eb(Cc)&&Array.add(ec,Cc);return ec};
class Wf{constructor(cb,Eb){this.key=cb;this.value=Eb}}Object(l.a)(Wf,"KeyValuePair",null,[]);const cg=(cb,Eb)=>({returnValue:Eb in cb,value:cb[Eb]}),bl=cb=>{const Eb=[];for(let ec in cb){const Cc=new Wf(ec,cb[ec]);Array.add(Eb,Cc)}return Eb};class tl{constructor(cb){this.F1h=this.wOl;this.Bb=cb;this.sUd=this.ezf=this.fzf=0;for(const Eb of this.Bb.oCd)this.fzf=Math.max(this.fzf,Eb.RMf),this.ezf=Math.max(this.ezf,Eb.MMf),this.sUd=Math.max(this.sUd,Eb.klb.length)}get r$k(){return this.Bb.zbe.trie}execute(cb){if(!cb)throw Error.argumentNull("input");
let Eb,ec;({tokens:Eb,asm:ec}=this.xOl(cb));let Cc=null,Pc=null,jd={};if(this.Bb.TNc){Eb=H.Annotations.CS(Eb);for(var pe=0;pe<Eb.items.length;++pe)Eb.items[pe]=H.Annotations.CS(Eb.items[pe])}else({WHh:Pc,returnValue:Cc}=this.SWh(cb,jd));pe=Array(this.sUd);const ue=Array(this.sUd);for(var Od=0;Od<ue.length;++Od)ue[Od]=new dj;for(Od=-this.fzf;Od<Eb.items.length+this.ezf;++Od){let zf=null;this.Bb.TNc&&(zf=Eb.items[Od],jd={},{WHh:Pc,returnValue:Cc}=this.SWh(zf,jd));for(const Tf of this.Bb.oCd){if(0>Od&&
-Od>Tf.RMf||Od>=Eb.items.length&&Od-Eb.items.length+1>Tf.MMf)continue;let dc=!0;for(let Oi=0;Oi<Tf.klb.length;++Oi){const Ci=Od+Tf.klb[Oi];pe[Oi]=Ci;if(0>Ci?0>this.Bb.SMf:Ci>=Eb.items.length?0>this.Bb.NMf:!ec.Ngc[Ci]){dc=!1;break}}dc&&({$Qk:Cc,aRk:Pc}=this.$8l(Tf,ec,Cc,Pc,jd,ue,pe))}this.Bb.TNc&&(zf.jy(this.Bb.B_a?this.Bb.kYb:this.Bb.iYb,Cc),this.Bb.B_a&&zf.jy(this.Bb.jYb,Pc))}cb=H.Annotations.CS(cb);this.Bb.TNc?cb.jy(this.Bb.SJa,Eb):(cb.jy(this.Bb.B_a?this.Bb.kYb:this.Bb.iYb,Cc),this.Bb.B_a&&cb.jy(this.Bb.jYb,
Pc));return cb}xOl(cb){let Eb,ec;if(!cb||!({value:Eb}=cb.mq(this.Bb.SJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Cc;({value:Cc}=cb.mq(this.Bb.XVa)).returnValue||(Cc="");ec=new Yh(Eb.items.length);const Pc=Mk(this.Bb.E6f,jd=>!jd.vMc||jd.vMc.isMatch(cb,null));for(let jd=0;jd<Eb.items.length;++jd){const pe=Eb.items[jd];let ue=null;ec.C6f[jd]=ec.v3f.length;let Od=ec.Ngc[jd]=0;for(const zf of Pc)0<zf.PRc&&ec.Ngc[jd]+Od>=zf.PRc||zf.D2c&&!zf.D2c.isMatch(pe,
null)||({E2c:ue,hAc:Od}=zf.apply(this,pe,jd,ec,Cc,ue,Od))}return{tokens:Eb,asm:ec}}$8l(cb,Eb,ec,Cc,Pc,jd,pe){let ue=0;jd[0].CLc=-1;for(jd[0].z9e=cb.TUi;;){var Od=pe[ue],zf=0>Od||Od>=Eb.Ngc.length?1:Eb.Ngc[Od];let Oi=!1;for(;jd[ue].CLc<zf-1;){++jd[ue].CLc;var Tf=void 0,dc=void 0;0>Od?(Tf=this.Bb.SMf,dc=1):Od>=Eb.C6f.length?(Tf=this.Bb.NMf,dc=1):(dc=Eb.C6f[Od]+jd[ue].CLc,Tf=Eb.v3f[dc],dc=Eb.k$i[dc]);jd[ue].xZc=dc*(ue?jd[ue-1].xZc:cb.score);if(({value:Tf}=cg(jd[ue].z9e,Tf.toString())).returnValue){ue===
cb.klb.length-1?(Od=Tf,jd[ue].xZc&&(({value:zf}=cg(Pc,Od.toString())).returnValue||(zf=-1),0>zf&&(ec=H.Annotations.CS(ec),Array.add(ec.items,Od)),this.Bb.B_a&&(Cc=H.Annotations.CS(Cc),0>zf?Array.add(Cc.items,jd[ue].xZc):Cc.items[zf]+=jd[ue].xZc),0>zf&&(this.Bb.Zji||this.Bb.B_a)&&(Pc[Od.toString()]=ec.items.length-1))):(++ue,jd[ue].CLc=-1,jd[ue].z9e=Tf);Oi=!0;break}}if(!Oi&&(--ue,0>ue))break}return{$Qk:ec,aRk:Cc}}SWh(cb,Eb){let ec;if(({value:ec}=cb.mq(this.Bb.B_a?this.Bb.kYb:this.Bb.iYb)).returnValue)for(let Cc=
0;Cc<ec.items.length;++Cc)Eb[ec.items[Cc].toString()]=Cc;else ec=new qb.a(this.Bb.annotations,H.Annotations.wFa);if(this.Bb.B_a){if(({value:Eb}=cb.mq(this.Bb.jYb)).returnValue||(Eb=new qb.a(this.Bb.annotations,H.Annotations.Roa)),Eb.items.length!==ec.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.Zba(H.Annotations.HU,cb));}else Eb=null;return{returnValue:ec,WHh:Eb}}get Fbo(){return this.Bb.zbe}wOl(cb,
Eb){var ec;if(({value:ec}=Eb.mq(this.Bb.uab)).returnValue)cb=ec;else{if(!({value:ec}=Eb.mq(this.Bb.M1)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Eb}=Eb.mq(this.Bb.I5)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>ec||0>Eb||ec+Eb>cb.length)throw Error.argument("Token indices are out of range");cb=cb.substr(ec,Eb)}return cb}}Object(l.a)(tl,"NGramNLModule",null,[1283,1284]);class ki{constructor(cb){this.klb=null;this.score=this.MMf=this.RMf=
0;this.TUi=null;if(cb){var Eb=0;try{if(cb.J(Eb)!==ki.zwb)throw Error.argument("initData","Input does not represent a feature template");++Eb;const ec=cb.J(Eb);++Eb;this.klb=Array(ec);for(let Cc=0;Cc<ec;++Cc)this.klb[Cc]=cb.J(Eb),++Eb;this.RMf=cb.J(Eb);++Eb;this.MMf=cb.J(Eb);++Eb;this.score=cb.J(Eb);++Eb;this.TUi=({I7h:Eb}=ki.yLi(cb,Eb)).returnValue}catch(ec){throw Error.argument("initData");}}}static yLi(cb,Eb){const ec=cb.J(Eb);++Eb;const Cc={};for(let Pc=0;Pc<ec;++Pc){const jd=cb.J(Eb);++Eb;cb.J(Eb)?
Cc[jd.toString()]=({I7h:Eb}=ki.yLi(cb,Eb)).returnValue:(++Eb,Cc[jd.toString()]=cb.J(Eb),++Eb)}return{returnValue:Cc,I7h:Eb}}}ki.zwb=240803228;Object(l.a)(ki,"FeatureTemplate",null,[1301]);var ul=c(1532);class Cf{constructor(cb,Eb){this.B_a=this.Zji=this.TNc=!1;this.uab=this.I5=this.M1=this.SJa=this.XVa=this.jYb=this.kYb=this.iYb=0;this.zbe=null;this.NMf=this.SMf=0;this.oCd=this.E6f=null;if(cb){this.annotations=Eb.annotations;var ec=0;try{this.TNc=1===cb.J(ec);++ec;this.Zji=1===cb.J(ec);++ec;this.B_a=
1===cb.J(ec);++ec;this.iYb=cb.J(ec);++ec;this.kYb=cb.J(ec);++ec;this.jYb=cb.J(ec);++ec;this.XVa=cb.J(ec);++ec;this.SJa=cb.J(ec);++ec;this.M1=cb.J(ec);++ec;this.I5=cb.J(ec);++ec;this.uab=cb.J(ec);++ec;this.zbe=this.u5m(Eb.Hdb(cb.J(ec)));++ec;this.SMf=cb.J(ec);++ec;this.NMf=cb.J(ec);++ec;const Cc=cb.J(ec);++ec;this.E6f=Array(Cc);for(let jd=0;jd<Cc;++jd){const pe=cb.J(ec);++ec;const ue=this.zbe.trie,Od=new ib.a;Od.rdb(cb,ec,pe);this.E6f[jd]=this.x5m(Od,Eb,ue);ec+=pe}const Pc=cb.J(ec);++ec;this.oCd=Array(Pc);
for(Eb=0;Eb<Pc;++Eb){const jd=cb.J(ec);++ec;const pe=new ib.a;pe.rdb(cb,ec,jd);this.oCd[Eb]=this.a5m(pe);ec+=jd}}catch(Cc){throw Error.argument("initData");}}}u5m(cb){return new Af.a(new Ef.a(cb))}x5m(cb,Eb,ec){return ul.a.create(cb,Eb,ec)}a5m(cb){return new ki(cb)}}Object(l.a)(Cf,"NGramNLModuleInit",null,[]);class gm{constructor(cb){this.Bb=cb}execute(cb){if(!cb)throw Error.argumentNull("input");cb=cb.clone();this.Bb.script.execute(cb,null);return cb}}Object(l.a)(gm,"ScriptNLModule",null,[1283]);
class zd{constructor(cb,Eb){cb&&(this.script=Eb.gAb(cb.J(0)))}}Object(l.a)(zd,"ScriptNLModuleInit",null,[]);const dk=cb=>{cb=ij(cb,Eb=>Eb*Eb);return Math.sqrt(Nl(cb,(Eb,ec)=>Eb+ec,0))},Bj=cb=>Nl(cb,(Eb,ec)=>Eb>ec?Eb:ec,cb[0]);class tj{constructor(cb){this.Bb=cb}execute(cb){if(!cb)throw Error.argumentNull("input");var Eb=[],ec=[];this.UAk(cb,Eb,ec);this.oak(Eb,ec);const Cc={};for(let jd=0;jd<Eb.length;++jd){var Pc=Eb[jd];const pe=this.Bb.mai.J(Pc);Pc=this.Bb.nai.J(Pc);for(let ue=0;ue<Pc;++ue){const Od=
this.Bb.R5.J(this.Bb.Knh.J(pe+ue)),zf=this.Bb.Lnh.J(pe+ue);let Tf;({value:Tf}=cg(Cc,Od)).returnValue||(Tf=0);Cc[Od]=Tf+ec[jd]*zf}}ec=bl(Cc);ec.sort((jd,pe)=>{var ue=jd.value,Od=pe.value;(ue=-(ue>Od?1:ue<Od?-1:0))||(ue=jd.key.localeCompare(pe.key));return ue});Eb=new qb.a(this.Bb.annotations,H.Annotations.HU);for(const jd of ck(ec,this.Bb.OHm))ec=new E.a(this.Bb.annotations),ec.jy(this.Bb.Dhk,jd.key),ec.jy(this.Bb.Fhk,jd.value),Array.add(Eb.items,ec);cb.jy(this.Bb.Ehk,Eb);return cb}UAk(cb,Eb,ec){if(({value:cb}=
cb.mq(this.Bb.Chk)).returnValue){let Cc;if(({value:Cc}=cb.mq(this.Bb.kYb)).returnValue){let Pc;if(!({value:Pc}=cb.mq(this.Bb.jYb)).returnValue||Cc.items.length!==Pc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.Fvd(Cc,Pc,Eb,ec)}if(({value:Cc}=cb.mq(this.Bb.Hhk)).returnValue){let Pc;if(!({value:Pc}=cb.mq(this.Bb.Ihk)).returnValue||Cc.items.length!==Pc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.Fvd(Cc,Pc,Eb,ec)}({value:Cc}=cb.mq(this.Bb.iYb)).returnValue&&this.Fvd(Cc,null,Eb,ec);({value:Cc}=cb.mq(this.Bb.Ghk)).returnValue&&this.Fvd(Cc,null,Eb,ec)}}Fvd(cb,Eb,ec,Cc){for(let jd=0;jd<cb.items.length;++jd){var Pc=void 0;cb.b3===H.Annotations.h8?({value:Pc}=cg(this.Bb.BDh,cb.items[jd])).returnValue||(Pc=-1):(Pc=cb.items[jd],Pc=Pc>=this.Bb.OAf&&Pc<=this.Bb.rIm?this.Bb.zEf?this.Bb.zEf.J(Pc-this.Bb.OAf)-1:Pc-this.Bb.OAf:-1);if(0<=Pc){let pe;pe=Eb?Eb.items[jd]:1;0<pe&&(Array.add(ec,Pc),Array.add(Cc,
pe))}}}oak(cb,Eb){if(cb.length){switch(this.Bb.ken){case 0:break;case 1:for(var ec=0;ec<Eb.length;++ec)Eb[ec]=1+Math.log(Eb[ec]);break;case 2:ec=Bj(Eb);for(let Cc=0;Cc<Eb.length;++Cc)Eb[Cc]=.5+Eb[Cc]/ec*.5;break;case 3:for(ec=0;ec<Eb.length;++ec)Eb[ec]=1;break;default:throw Error.notImplemented();}if(this.Bb.nNd)for(ec=0;ec<Eb.length;++ec)Eb[ec]*=this.Bb.nNd.J(cb[ec]);cb=dk(Eb);for(ec=0;ec<Eb.length;++ec)Eb[ec]/=cb}}}Object(l.a)(tj,"TfIdfRankerNLModule",null,[1283]);class mk{constructor(cb,Eb=0){if(!cb)throw Error.argumentNull("byteArray");
this.tUd=Eb;if(604662927!==cb.hy(this.tUd+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.ej=cb.hy(this.tUd+4,4);this.Spi=cb.hy(this.tUd+8,4);this.oFm=cb}J(cb){if(0>cb||cb>=this.count)throw Error.argumentOutOfRange("index");return this.oFm.Nin(8*this.tUd+96+cb*this.Spi,this.Spi)}get count(){return this.ej}}Object(l.a)(mk,"CompactIntArray",null,[1279]);const Tm=(cb,Eb)=>{Eb=Array(Eb);for(let jd=0;jd<Eb.length;jd++){var ec=jd,Cc=cb.y7(),Pc=1===(Cc>>31&1)?-1:
1;const pe=Cc&8388607;Cc=Cc>>23&255;256===Cc+1?Pc=pe?Number.NaN:1===Pc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Cc?(Cc-=127,Pc=Pc*sm(pe,1)*Math.pow(2,Cc)):Pc=Pc*sm(pe,0)*Math.pow(2,-126);Eb[ec]=Pc}return Eb},sm=(cb,Eb)=>{let ec=0;for(let Cc=0;23>Cc;Cc++)ec+=(cb>>22-Cc&1)/Math.pow(2,Cc+1);return Eb+ec};class Xl{constructor(cb,Eb){this.zEf=null;this.cwi=0;this.nai=this.mai=this.nNd=null;this.bwi=0;this.Lnh=this.Knh=null;this.annotations=Eb.annotations;let ec=0;this.Ghk=cb.J(ec);++ec;this.iYb=
cb.J(ec);++ec;this.Hhk=cb.J(ec);++ec;this.Ihk=cb.J(ec);++ec;this.kYb=cb.J(ec);++ec;this.jYb=cb.J(ec);++ec;this.Chk=cb.J(ec);++ec;this.Ehk=cb.J(ec);++ec;this.Dhk=cb.J(ec);++ec;this.Fhk=cb.J(ec);++ec;var Cc=cb.J(ec);++ec;var Pc=Array(Cc);for(var jd=0;jd<Cc;++jd)Pc[jd]=Eb.nE(cb.J(ec)),++ec;this.R5=ib.a.a1e(Pc);this.OHm=cb.J(ec);++ec;this.ken=cb.J(ec);++ec;Cc=cb.J(ec);++ec;this.BDh={};for(Pc=0;Pc<Cc;++Pc){jd=Eb.nE(cb.J(ec));++ec;const pe=cb.J(ec);++ec;this.BDh[jd]=pe}this.OAf=cb.J(ec);++ec;this.rIm=cb.J(ec);
++ec;Cc=cb.J(ec);++ec;0<Cc&&(Cc=Eb.Hdb(cb.J(ec)),++ec,this.zEf=this.A_d(new Tg(Cc)));++ec;cb=Eb.Hdb(cb.J(ec));this.h5m(cb)}A_d(cb){return new mk(cb.tzc,cb.offset)}h5m(cb){try{const Eb=new Tg(cb);this.cwi=Eb.y7();1===Eb.y7()?this.nNd=ib.a.a1e(Tm(Eb,this.cwi)):this.nNd=null;const ec=Eb.y7();this.mai=this.A_d(Eb);Eb.offset+=ec;const Cc=Eb.y7();this.nai=this.A_d(Eb);Eb.offset+=Cc;this.bwi=Eb.y7();const Pc=Eb.y7();this.Knh=this.A_d(Eb);Eb.offset+=Pc;this.Lnh=ib.a.a1e(Tm(Eb,this.bwi))}catch(Eb){throw Error.argument("byteReader");
}}}Object(l.a)(Xl,"TfIdfRankerNLModuleInit",null,[]);class ni{constructor(cb,Eb,ec,Cc){this.dLf=cb;this.MJh=ec;this.tokens=Cc;this.Ika=Eb;this.Rdc=-1;this.o6d=0}}Object(l.a)(ni,"TokenizerData",null,[]);class uh{constructor(cb){this.Bb=cb}execute(cb){if(!cb)throw Error.argumentNull("input");if(!({value:Cc}=cb.mq(this.Bb.XVa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Eb;({value:Eb}=cb.mq(this.Bb.M1)).returnValue||(Eb=0);let ec;({value:ec}=
cb.mq(this.Bb.I5)).returnValue||(ec=Cc.length-Eb);if(0>Eb||Eb>Cc.length)throw Error.argument("input","Start index out of range");if(0>ec||ec>Cc.length)throw Error.argument("input","Length out of range");if(Eb+ec>Cc.length)throw Error.argument("input","Bad start-length range");var Cc=new ni(Cc,Eb,Eb+ec,new qb.a(this.Bb.annotations,H.Annotations.HU));this.Gbo(Cc);cb=cb.isReadOnly?cb.clone():cb;cb.jy(this.Bb.SJa,Cc.tokens);return cb}Gbo(cb){for(;cb.Ika<cb.MJh;){if(this.Bb.okf){var Eb=this.Bb.okf.vpi(cb.dLf,
cb.Ika,cb.MJh-cb.Ika,null);!Eb.succeeded&&Eb.$ui&&(Eb=Eb.$ui);if(Eb.succeeded){this.Tzi(cb,Eb.length,this.Bb.J3h);cb.Ika+=Eb.length;continue}}Eb=cb.dLf.substr(cb.Ika);let ec=-1,Cc=-1,Pc=-1;for(let jd=0;jd<this.Bb.u5d.length;++jd){const pe=this.Bb.u5d[jd].exec(Eb);pe&&0<pe[1].length&&(0>ec||pe[0].length>Cc)&&(ec=jd,Cc=pe[0].length,Pc=pe[1].length)}0<=ec?(this.Tzi(cb,Pc,this.Bb.dWf[ec]),cb.Ika+=Pc):cb.Ika+=1}}Tzi(cb,Eb,ec){if(this.Bb.tii)ec!==uh.Xpk&&(0>cb.Rdc&&(cb.Rdc=cb.Ika),cb.o6d=cb.Ika+Eb-cb.Rdc,
ec===uh.Wpk&&(0<=cb.Rdc&&0<cb.o6d&&(Eb=new E.a(this.Bb.annotations),Eb.jy(this.Bb.M1,cb.Rdc),Eb.jy(this.Bb.I5,cb.o6d),Eb.jy(this.Bb.KSe,uh.Ypk),Eb.jy(this.Bb.XVa,cb.dLf),Array.add(cb.tokens.items,Eb)),cb.Rdc=-1,cb.o6d=0));else{let Cc=new E.a(this.Bb.annotations);Cc.jy(this.Bb.M1,cb.Ika);Cc.jy(this.Bb.I5,Eb);Cc.jy(this.Bb.KSe,ec);Array.add(cb.tokens.items,Cc)}}}uh.Xpk="GAP";uh.Wpk="EOS_CHUNK";uh.Ypk="SENTENCE";Object(l.a)(uh,"TokenizerNLModule",null,[1283]);class yh{constructor(cb,Eb){this.I5=this.M1=
this.KSe=this.SJa=this.XVa=0;this.tii=!1;this.dWf=this.u5d=this.J3h=this.okf=null;if(cb){this.annotations=Eb.annotations;var ec=0;try{this.XVa=cb.J(ec);++ec;this.SJa=cb.J(ec);++ec;this.KSe=cb.J(ec);++ec;this.M1=cb.J(ec);++ec;this.I5=cb.J(ec);++ec;this.tii=1===cb.J(ec);++ec;var Cc=cb.J(ec);++ec;0<Cc&&(this.okf=Eb.ggf(Cc).r$k);this.J3h=cb.J(ec)?Eb.nE(cb.J(ec)):"";++ec;const Pc=cb.J(ec);++ec;this.u5d=Array(Pc);this.dWf=Array(Pc);for(Cc=0;Cc<Pc;++Cc)this.u5d[Cc]=new RegExp(Eb.nE(cb.J(ec))),++ec,this.dWf[Cc]=
Eb.nE(cb.J(ec)),++ec}catch(Pc){throw Error.argument("initData");}}}}Object(l.a)(yh,"TokenizerNLModuleInit",null,[]);class ll{constructor(cb){this.Bb=cb}execute(cb){if(!cb)throw Error.argumentNull("input");let Eb;if(!({value:Eb}=cb.mq(this.Bb.Ufh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const ec of this.Bb.L2f)Eb=ec.apply(Eb);cb=H.Annotations.CS(cb);cb.jy(this.Bb.Vfh,Eb);return cb}static WRe(cb,Eb){const ec=new Sys.StringBuilder;for(let Cc=
0;Cc<cb.length;++Cc)ec.append(Eb(cb.substr(Cc,1)));return ec.toString()}}Object(l.a)(ll,"TransliteratorNLModule",null,[1283]);class dn{constructor(cb){cb&&(this.style=cb.J(0))}apply(cb){return ll.WRe(cb,Eb=>dn.ouk(Eb,this.style))}static ouk(cb,Eb){switch(Eb){case 0:return cb.toLowerCase();case 1:return"I"===cb?"\u0131":cb.toLowerCase();case 2:return cb.toUpperCase();case 3:return"i"===cb?"\u0130":cb.toUpperCase();default:throw Error.invalidOperation();}}}dn.Awb=0;Object(l.a)(dn,"ChangeCaseTransliterationStage",
null,[1299]);class Gl{apply(cb){return ll.WRe(cb,Gl.ado)}static ado(cb){const Eb=cb.charCodeAt(0);return 65281<=Eb&&65374>=Eb?String.fromCharCode(Eb-65248):cb}}Gl.Awb=4;Object(l.a)(Gl,"LatinFullWidthToHalfWidthTransliterationStage",null,[1299]);class Ol{constructor(cb,Eb){cb&&(this.yRf=Eb.M3b(cb.J(0)),this.axn=Eb.nE(cb.J(1)))}apply(cb){return cb.replace(this.yRf,this.axn)}}Ol.Awb=1;Object(l.a)(Ol,"RegexReplaceTransliterationStage",null,[1299]);class Bg{constructor(cb,Eb){if(cb){var ec=cb.J(0),Cc=
Eb.nE(cb.J(1)),Pc=new mk(Eb.Hdb(cb.J(2)));cb=0>cb.J(3)?null:new mk(Eb.Hdb(cb.J(3)));this.O3f={};for(Eb=0;Eb<ec;++Eb)this.O3f[Cc.charAt(Eb).toString()]=Cc.substr(Pc.J(Eb),cb?cb.J(Eb):1)}}apply(cb){return ll.WRe(cb,Eb=>Eb in this.O3f?this.O3f[Eb]:Eb)}}Bg.Awb=2;Object(l.a)(Bg,"SingleCharSubstitutionsTransliterationStage",null,[1299]);class Ak{constructor(cb,Eb){this.Vfh=this.Ufh=0;this.L2f=null;if(cb){this.annotations=Eb.annotations;var ec=0;try{this.Ufh=cb.J(ec);++ec;this.Vfh=cb.J(ec);++ec;const Cc=
cb.J(ec);++ec;this.L2f=Array(Cc);for(let Pc=0;Pc<Cc;++Pc){const jd=cb.J(ec);++ec;const pe=cb.J(ec);++ec;const ue=new ib.a;ue.rdb(cb,ec,pe);ec+=pe;this.L2f[Pc]=this.t5m(jd,ue,Eb)}}catch(Cc){throw Error.argument("initData");}}}t5m(cb,Eb,ec){switch(cb){case dn.Awb:return new dn(Eb);case Ol.Awb:return new Ol(Eb,ec);case Bg.Awb:return new Bg(Eb,ec);case Gl.Awb:return new Gl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Ak,"TransliteratorNLModuleInit",
null,[]);class ek{FBl(cb,Eb){const ec=cb.J(0),Cc=new ib.a;Cc.rdb(cb,1,cb.count-1);switch(ec){case 0:return new gm(new zd(Cc,Eb));case 2:return new uh(new yh(Cc,Eb));case 3:return new tl(new Cf(Cc,Eb));case 5:return new df(new ld(Cc,Eb));case 9:return new ll(new Ak(Cc,Eb));case 10:return new tj(new Xl(Cc,Eb));default:throw Error.notImplemented();}}}Object(l.a)(ek,"NLModuleFactory",null,[1258]);class tg{constructor(cb){this.Upk=";";if(!cb)throw Error.argumentNull("resource");this.Qfa=new Df(cb,new Xa,
new ek);this.hzf=this.Qfa.mBl();this.Rpi=this.Qfa.annotations.vHc("Text.Text");this.Ppi=this.Qfa.annotations.vHc("Classification.Predictions");this.Tyf=this.Qfa.annotations.vHc("Classification.PredictionString");this.Qpi=this.Qfa.annotations.vHc("Classification.Probability");this.nFm=this.Qfa.annotations.vHc("NLMod.Tokens");if(0>this.Rpi||0>this.Ppi||0>this.Tyf||0>this.Qpi)throw Error.argument("resourceObj","Resource does not represent a ranker");}Mkl(){const cb=[];this.s8e(void 0,this.WNh(cb),null);
return cb}Okl(cb,Eb){const ec=[],Cc=[];this.s8e(cb,this.WNh(ec),(Pc,jd)=>{const pe=this.Qfa.annotations.KNh(Pc),ue=[],Od=[];Eb&&Eb.length&&-1===Array.indexOf(Eb,pe)||(Pc=this.Qfa.annotations.getAttributeType(Pc),this.JGi(Pc,jd,ue,Od),jd=new Fg(pe,ue,Od),Array.add(Cc,jd))});return new hg(ec,Cc)}Nkl(cb){const Eb=[];this.s8e(cb,ec=>{let Cc;if(({value:Cc}=ec.mq(this.Tyf)).returnValue){let Pc;({value:Pc}=ec.mq(this.Qpi)).returnValue&&Array.add(Eb,new Ii(Cc,Pc))}},null);return Eb}s8e(cb,Eb,ec){var Cc=new E.a(this.Qfa.annotations);
Cc.jy(this.Rpi,cb);cb=this.hzf.execute(Cc);if(({value:Cc}=cb.mq(this.Ppi)).returnValue)for(const Pc of Cc.items)Eb(Pc);if(ec&&({value:Eb}=cb.mq(this.nFm)).returnValue)for(const Pc of Eb.items)Pc.GDd(ec)}JGi(cb,Eb,ec,Cc){if(H.Annotations.xH(cb))for(var Pc of Eb.items)this.JGi(Eb.b3,Pc,ec,Cc);else if(H.Annotations.fgj(cb)){Pc=this.Qfa.annotations.xWh(cb);for(let jd=0;jd<Pc;jd++)Array.add(ec,this.Qfa.annotations.a0h(cb,jd)),Array.add(Cc,this.Qfa.annotations.Zba(this.Qfa.annotations.wBb(cb,jd),Eb.Vdb(jd)))}else Array.add(ec,
"VALUE"),Array.add(Cc,this.Qfa.annotations.Zba(cb,Eb))}WNh(cb){return Eb=>{let ec;({value:ec}=Eb.mq(this.Tyf)).returnValue&&Array.add(cb,this.hGl(ec))}}hGl(cb){const Eb=cb.indexOf(this.Upk);return 0>Eb?cb:cb.substring(0,Eb)}}Object(l.a)(tg,"Ranker",null,[]);var Be=c(1485),ai=c(1496),Zd=c(1452),Hf=c(1449),Mi=c(1447),de=c(2);class Fj{constructor(cb,Eb){this.mPg="";this.oEe=null;this.pEe=!1;this.kpa=null;this.cyj=["TellMe.TellMeParamCollection"];this.qc=cb;this.NTa=Eb;this.qc.Wvb&&(this.kpa=null)}get b2d(){if(!this.oEe&&
!this.pEe){let cb=null;try{cb=window.TellMeModel}catch(Eb){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("QueryRanker","TellMeModel not found. Exception: "+Eb)}if(cb){try{this.oEe=new tg(cb)}catch(Eb){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Eb)}this.pEe=!0}else if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("QueryRanker","Classifier model not found")}return this.oEe}IL(){return"Command"}FW(){return 0===
this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec=!1,Cc=e.a.tellMe,Pc=null){const jd=new n.a(cb);if((!Pc||Array.contains(Pc,0))&&!Mi.a.YW(cb)){if(!this.b2d&&this.pEe){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.qc.Wvb&&this.kpa&&this.kpa.initialize();if(Be.CommandResultsUtility.Xpf(cb.Ig)&&(Pc=Be.CommandResultsUtility.BPh(cb.Ig),0<Pc.results.length)){Pc.displayName=
"Classifier Debug";jd.kw(Pc);Eb.resultsUpdated(jd);return}Pc=cb?this.mPg=cb.Ig:this.mPg;if(de.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Pc=this.jGl(Pc);var pe=this.UEd(Pc.ohf());Pc=Pc.lNh()}else Pc=this.iGl(Pc),pe=this.Lnl(Pc),Pc=[];Be.CommandResultsUtility.ITd(pe,!1,"Classifier","TFIDF");pe=Be.CommandResultsUtility.$Hd(cb,pe,this.qc,this.kpa,this.NTa,Pc,0,1);0<pe.results.length&&Cc!==e.a.contextMenu&&(pe.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ec||pe.results.length||
this.qc.JZ||this.qc.z3a||(cb=new Zd.a("lookupNoResults",14,cb.Ig,null,1),pe.Ez(cb));0<pe.results.length&&jd.kw(pe);jd.attributes=Pc}Eb.resultsUpdated(jd)}ohf(){let cb=[];try{cb=this.b2d.Mkl()}catch(Eb){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("GetPredictions","Exception: "+Eb)}return cb}iGl(cb){let Eb=[];try{Eb=this.b2d.Nkl(cb)}catch(ec){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("GetPredictionsWithScore","Exception: "+ec)}return Eb}jGl(cb){try{return this.b2d.Okl(cb,
this.cyj)}catch(Eb){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("GetPredictionsWithTokenAttributes","Exception: "+Eb)}return new hg([],[])}UEd(cb){const Eb=[];if(cb)for(const ec of cb)Eb.push(new ai.a(ec,-99999));return Eb}Lnl(cb){const Eb=[];if(cb)for(const ec of cb)Eb.push(new ai.a(ec.prediction,ec.score));return Eb}}Object(l.a)(Fj,"CommandResultsProvider",null,[1143]);var kf=c(1655);class cf{constructor(cb){this.qc=cb}IL(){return"Feedback"}FW(){return 0===this.qc.Nv?0:1===
this.qc.Nv?1:2}MI(cb,Eb,ec,Cc,Pc=null){cb=new n.a(cb);if(!Pc||Array.contains(Pc,21))Pc=[],Pc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Pc),Pc=new u.a(22),Pc.displayName="",Pc.Ez(new Zd.a("TellMeFeedback",23,null,null,1)),cb.kw(Pc);Eb.resultsUpdated(cb)}}Object(l.a)(cf,"FeedbackResultsProvider",null,[1143]);class kc{constructor(cb,Eb,ec,Cc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=cb;this.CommandId=
Eb;this.CommandValueId=ec;this.InputText=Cc}}Object(l.a)(kc,"FindInDocumentProp",null,[]);var zh=c(1506),Bf=c(17);class si{constructor(cb){this.eze=2;this.Qrb=[];this.Q8a=[];this.qc=cb;si.bBa=cb.I9e;si.eJh="FindInDocumentSuggestion";si.XFi="FindInDocumentSuggestion3";this.Rxe=Object.assign(new zh.a,{landingTab:"Indoc",data:null});this.UVj=this.qc.$kb||!!de.AFrameworkApplication.ta&&de.AFrameworkApplication.ta.Rb.$kb}IL(){return"FindInDocument"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:3===this.qc.Nv?
this.qc.E7i?2:3:2}MI(cb,Eb,ec=!1,Cc,Pc=null){const jd=new n.a(cb);if(Pc&&!Array.contains(Pc,2))Eb.resultsUpdated(jd);else if(Array.clear(this.Qrb),Mi.a.YW(cb)){if(ec&&this.d5i()){ec=new u.a(2);ec.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Pc=1;Cc="";if(0<this.Q8a.length&&!this.qc.Mec)for(var pe of this.Q8a)if(""!==pe.Label.toLowerCase()){if(Pc>=this.eze)break;this.Rjj(ec,pe.Label,pe.CommandValueId,si.eJh+Pc,pe.InputText);Pc++}pe="";this.qc.uO?(jd.kw(ec),ec=new u.a(3),pe=this.qc.oab?
Mi.a.Fdb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):pe=CommonUIStrings.l_TellMeOpenFindPaneText;Cc=this.APh("");this.Rjj(ec,pe,Cc,si.XFi,"");jd.kw(ec)}Eb.resultsUpdated(jd)}else pe="",ec&&(ec=this.APh(cb.Ig),Cc=[],this.qc.$_a?(this.qc.G8d&&Cc.push(appChrome.actions.setControlIconSet(si.bBa,{"default":"FindInDocument_20"})),pe=this.qc.juf?Mi.a.Mef(cb.Ig,CommonUIStrings.l_FindInDocumentScopedButtonText):cb.Ig+CommonUIStrings.l_FindInDocumentScopedButtonText):
this.qc.uO?(pe=this.qc.oab?Mi.a.Fdb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,cb.Ig)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,cb.Ig),Cc.push(appChrome.actions.setControlIconSet(si.bBa,{"default":"FindInDocument_20"}))):pe=this.qc.Mec?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,cb.Ig),this.qc.KBa?(Hf.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(si.bBa,pe)),Hf.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(si.bBa,
ec))):(Cc.push(appChrome.actions.setControlLabel(si.bBa,pe)),Cc.push(appChrome.actions.setButtonCommandValueId(si.bBa,ec)),appChrome.api.dispatch(Cc)),this.G0i(pe,si.bBa,ec,cb.Ig)),this.qc.E7i?(pe=new Zd.a(si.bBa,8,cb.Ig),ec=new u.a(2),ec.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,ec.Ez(pe),jd.kw(ec),Eb.resultsUpdated(jd)):this.qc.PFd(cb.Ig).then(ue=>{const Od=new Zd.a(si.bBa,8,cb.Ig,null,1);Od.count=ue;ue=new u.a(2);ue.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ue.Ez(Od);
jd.kw(ue);Eb.resultsUpdated(jd)},ue=>{Hf.TellMeActor.instance.Xe.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+ue);ue=new Zd.a(si.bBa,8,cb.Ig,null,1);const Od=new u.a(2);Od.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Od.Ez(ue);jd.kw(Od);Eb.resultsUpdated(jd)})}d5i(){return!!this.qc&&this.qc.y8d}Rjj(cb,Eb,ec,Cc,Pc=null){const jd=[];Eb&&jd.push(appChrome.actions.setControlLabel(Cc,Eb));this.qc.uO&&jd.push(appChrome.actions.setControlIconSet(Cc,{"default":"FindInDocument_20"}));
jd.push(appChrome.actions.setButtonCommandValueId(Cc,ec));appChrome.api.dispatch(jd);this.G0i(Eb,Cc,ec,"");cb.Ez(new Zd.a(Cc,8,Pc,null,1,-99999))}APh(cb){return this.UVj?Mi.a.bXa(cb,15,this.Rxe):Bf.a.Ff(cb)}G0i(cb,Eb,ec,Cc){this.d5i()&&this.Qrb.length<this.eze&&(cb=new kc(cb,Eb,ec,Cc),Array.add(this.Qrb,cb))}rOn(cb){for(let Eb=0;Eb<this.Qrb.length;Eb++)if(this.Qrb[Eb].CommandId===cb){const ec=this.Qrb[Eb].Label;let Cc=!1;if(0<this.Q8a.length){let Pc=0;for(const jd of this.Q8a){if(jd.Label===ec){Array.removeAt(this.Q8a,
Pc);Cc=!0;break}Pc++}}!Cc&&this.Q8a.length>=this.eze-1&&Array.removeAt(this.Q8a,1);Array.insert(this.Q8a,0,this.Qrb[Eb])}}}si.bBa=null;si.eJh=null;si.XFi=null;Object(l.a)(si,"FindInDocumentResultsProvider",null,[1143]);var ag=c(1653);class Xg{constructor(cb){this.qc=cb}IL(){return"Insights"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec=!1,Cc,Pc=null){Cc=new n.a(cb);if(!Pc||Array.contains(Pc,13))if(this.pXn()||!Mi.a.YW(cb)){Pc=new u.a(13);var jd=""===cb.Ig.trim(),pe=jd?"SmartLookupFromTellMeZeroTerm":
"SmartLookupFromTellMe",ue=new Zd.a(pe,10,cb.Ig,null,1);ec&&(ec=null,Mi.a.OCa()?jd?jd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(jd=this.qc.Mec?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,cb.Ig),ec=Mi.a.bXa(cb.Ig,1)):(jd=String.format(CommonUIStrings.l_InsightsButtonText,cb.Ig),ec=Mi.a.Zxb(cb.Ig)),this.qc.KBa?(Hf.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(pe,jd)),ec&&Hf.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
ec))):(cb=[],cb.push(appChrome.actions.setControlLabel(pe,jd)),ec&&cb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ec)),appChrome.api.dispatch(cb)),ue.label=jd);Pc.Ez(ue);Cc.kw(Pc)}Eb.resultsUpdated(Cc)}pXn(){return Mi.a.OCa()&&this.qc.W9n}}Object(l.a)(Xg,"InsightsResultsProvider",null,[1143]);var Mf=c(1651);class li{constructor(cb){this.qc=cb}IL(){return"Learning"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec,Cc,Pc=null){ec=new n.a(cb);Pc&&!Array.contains(Pc,
21)||!Mi.a.YW(cb)||(Pc=[],Cc=this.qc.ftm,Pc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Cc)),Cc=li.Xul(Cc),Pc.push(appChrome.actions.setControlLabel("LearningForSearch",Cc)),appChrome.api.dispatch(Pc),cb=new Zd.a("LearningForSearch",22,cb.Ig,null,1),Pc=new u.a(21),Pc.Ez(cb),ec.kw(Pc));Eb.resultsUpdated(ec)}static Xul(cb){const Eb=[];Array.add(Eb,new Mf.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Eb,new Mf.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Eb,new Mf.a(600,cb));Array.add(Eb,new Mf.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));cb={};cb.parts=Eb;return JSON.stringify(cb)}}Object(l.a)(li,"LearningProvider",null,[1143]);var Kh=c(482);class Gj{constructor(cb,Eb){this.rSb=this.sWb=this.s9a=this.qgd=null;this.Lw=!1;this.$Sb=cb;this.iCj=Eb;cb&&this.xHh(cb)}fce(){this.$Sb.fce()&&this.xHh(this.$Sb)}sMl(cb){let Eb=[];var ec=[];cb=Gj.vOm(cb);var Cc="";Array.clear(ec);for(let Pc=0;Pc<cb.length;Pc++){const jd=cb.charAt(Pc);-1!==
" ".indexOf(jd)?(Cc.length&&Array.add(ec,Cc),Cc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(jd)?(Cc.length&&Array.add(ec,Cc),Cc=jd,Array.add(ec,Cc),Cc=""):Cc+=jd}Cc.length&&Array.add(ec,Cc);for(cb=0;cb<ec.length;cb++)Cc=this.Knl(ec[cb]),Cc=this.xHk(Cc),Eb=Gj.tJm(Eb,Cc);return Eb=this.I5j(Eb)}usf(){this.Lw||this.fce();return this.Lw}Kyd(cb){return this.qgd[cb.toString()]}I5j(cb){for(let Eb=0;Eb<cb.length;Eb++){const ec=this.s9a[Eb];if(cb[Eb].commandId!==this.Kyd(ec[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Cc;(Cc=cb[Eb]).score=Cc.score+ec[1]}return cb}xHk(cb){const Eb=[];for(var ec=0;ec<this.s9a.length;ec++)Eb.push(new ai.a(this.Kyd(this.s9a[ec][0]),-5));ec=new Kh.a;for(var Cc=0;Cc<cb.length;Cc++)ec.add(this.Kyd(cb[Cc][0]));for(Cc=0;Cc<Eb.length;Cc++){const jd=Eb[Cc];for(let pe=0;pe<cb.length;pe++){var Pc=cb[pe];const ue=this.Kyd(Pc[0]);Pc=Pc[1];if(ue===jd.commandId){jd.score=Pc;ec.remove(ue);break}}if(!ec.count)break}return Eb}Knl(cb){const Eb=1>cb.length;for(let pe=0;2>=pe;pe++){const ue=this.rSb;
for(let Od in ue){var ec=ue[Od],Cc=cb,Pc=Od;const zf=Pc.length+1,Tf=Array((Cc.length+1)*zf);for(var jd=0;jd<=Cc.length;jd++)Tf[jd*zf]=jd;for(jd=0;jd<=Pc.length;jd++)Tf[jd]=jd;for(jd=0;jd<Pc.length;jd++)for(let dc=0;dc<Cc.length;dc++)Tf[(dc+1)*zf+(jd+1)]=Cc.charAt(dc)===Pc.charAt(jd)?Tf[dc*zf+jd]:Math.min(Math.min(Tf[dc*zf+(jd+1)]+1,Tf[(dc+1)*zf+jd]+1),Tf[dc*zf+jd]+1);Cc=Tf[Cc.length*zf+Pc.length];if((!Cc||!Eb)&&Cc<=pe)return ec}}return this.sWb}xHh(cb){this.qgd=cb.fgf();this.s9a=cb.RGl();this.sWb=
cb.EPl();this.rSb=cb.syl();if(this.Lw=!!this.qgd&&!!this.s9a&&!!this.rSb&&!!this.sWb)this.Lw=0<this.s9a.length&&Gj.Dpf(this.s9a);this.Lw&&(this.Lw=0<this.sWb.length&&Gj.Dpf(this.sWb));this.Lw&&(this.rSb=Gj.tQl(this.rSb));this.Lw||(this.rSb=this.sWb=this.s9a=this.qgd=null)}JOl(cb){cb=this.sMl(cb);return this.f$k(cb,this.iCj)}f$k(cb,Eb){let ec=[];for(let Cc=0;Cc<cb.length;Cc++)cb[Cc].score>=Eb&&ec.push(cb[Cc]);ec.sort((Cc,Pc)=>Cc.score<Pc.score?1:Cc.score>Pc.score?-1:0);0<ec.length-10&&(ec=ec.slice(0,
10));return ec}static tJm(cb,Eb){if(!cb.length)return Eb;if(cb.length!==Eb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let ec=0;ec<cb.length;ec++){if(cb[ec].commandId!==Eb[ec].commandId)throw Error.create("Incorrect CommandId");let Cc;(Cc=cb[ec]).score=Cc.score+Eb[ec].score}return cb}static vOm(cb){return Bf.a.mh(cb)}static Dpf(cb){for(let Eb=0;Eb<cb.length;Eb++)if(2!==cb[Eb].length)return!1;return!0}static tQl(cb){const Eb={};for(let Pc in cb){var ec=
Pc,Cc=cb[Pc];const jd=Cc;jd.length&&Gj.Dpf(jd)&&(Eb[ec]=Cc)}return Eb}}Object(l.a)(Gj,"NaiveBayesClassifierModel",null,[]);class Hi{constructor(cb,Eb){this.kpa=null;this.qc=cb;this.bsc=new Gj(Eb,cb.GBl);this.qc.Wvb&&(this.kpa=null)}IL(){return"NBCommand"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec=!1,Cc=e.a.tellMe,Pc=null){const jd=new n.a(cb);if((!Pc||Array.contains(Pc,0))&&!Mi.a.YW(cb)){if(Be.CommandResultsUtility.Xpf(cb.Ig)&&(Pc=Be.CommandResultsUtility.BPh(cb.Ig),0<Pc.results.length)){Pc.displayName=
"Classifier Debug";jd.kw(Pc);Eb.resultsUpdated(jd);return}if(!this.bsc.usf()){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.qc.Wvb&&this.kpa&&this.kpa.initialize();Pc=this.bsc.JOl(cb.Ig);Be.CommandResultsUtility.ITd(Pc,!1,"Classifier","NaiveBayesian");Pc=Be.CommandResultsUtility.$Hd(cb,Pc,this.qc,this.kpa,null,null,0,1);0<Pc.results.length&&
Cc!==e.a.contextMenu&&(Pc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ec||Pc.results.length||this.qc.JZ||this.qc.z3a||(cb=new Zd.a("lookupNoResults",14,cb.Ig,null,1),Pc.Ez(cb));0<Pc.results.length&&jd.kw(Pc)}Eb.resultsUpdated(jd)}}Object(l.a)(Hi,"NaiveBayesCommandProvider",null,[1143]);class ch{constructor(){this.Mrb=null;this.Lw=!1;this.fce()}fce(){this.Lw||(this.Mrb=window.NBCRM)&&4===this.Mrb.length&&(this.Lw=!0);return this.Lw}RGl(){return this.Lw?this.Mrb[1]:null}EPl(){return this.Lw?
this.Mrb[2]:null}syl(){return this.Lw?this.Mrb[3][0]:null}fgf(){return this.Lw?this.Mrb[0][0]:null}}Object(l.a)(ch,"NaiveBayesModelAdapter",null,[1169]);var hm=c(212);class Wk{constructor(cb){this.qc=cb}IL(){return"OfficeScript"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb){const ec=new n.a(cb);if(!Mi.a.YW(cb)){cb=hm.d(cb.Ig);var Cc=new u.a(25);Cc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Cc=this.m$g(cb,Wk.eho,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Cc);Cc=this.m$g(cb,Wk.ngl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Cc);ec.kw(Cc)}Eb.resultsUpdated(ec)}m$g(cb,Eb,ec,Cc,Pc,jd){const pe=[];for(const ue of Eb)if(hm.a(cb,ue)){this.qc.KBa?(Hf.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ec,Pc)),Hf.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ec,Cc))):(pe.push(appChrome.actions.setControlLabel(ec,Pc)),pe.push(appChrome.actions.setButtonCommandValueId(ec,
Cc)),appChrome.api.dispatch(pe));jd.Ez(new Zd.a(ec,26,null,null,1));break}return jd}}Wk.eho="unhide row rows col cols column columns".split(" ");Wk.ngl=["freeze","selection","pane","panes"];Object(l.a)(Wk,"OfficeScriptsSamplesProvider",null,[1143]);var Pl=c(77),oh=c(282),Pi=c(1510),Qd=c(1478),Ql=c(1509),lg=c(36),Mj=c(121),bi=c(28);class vl{constructor(cb){this.eP=null;this.E0=-1;this.Zzf=14;this.bAf=12;this.attributes=this.JLe=this.query=null;this.B7b=!1;this.uUb=[];this.rg=de.AFrameworkApplication.af;
de.AFrameworkApplication.K&&(this.Zzf=de.AFrameworkApplication.K.rc("TellMeMaxTermedResults",this.Zzf),this.bAf=de.AFrameworkApplication.K.rc("TellMeMaxZeroTermResults",this.bAf));this.aU=cb}get Vn(){return this.uUb}get Hce(){return this.JLe}kw(cb){let Eb=!1;for(let ec=0;ec<this.Vn.length;ec++)if(27!==this.Vn[ec].groupType&&this.Vn[ec].groupType===cb.groupType){this.aPe(this.Vn[ec],cb);Eb=!0;break}Eb||this.Vn.push(cb)}aPe(cb,Eb){for(let ec=0;ec<Eb.results.length;ec++)cb.Ez(Eb.results[ec])}IPi(cb){const Eb=
[];for(const ec of this.Vn)ec.groupType!==cb&&Eb.push(ec);this.Vn.length!==Eb.length&&(this.uUb=Eb)}vsn(cb){let Eb=null,ec=null,Cc=null;for(let Pc=0;Pc<cb.length;Pc++){const jd=cb[Pc];if(jd&&jd.Vn&&jd.Vn.length)for(const pe of jd.Vn)if(17===pe.groupType||18===pe.groupType)Eb=pe;else if(0===pe.groupType||16===pe.groupType)ec=pe,Cc=jd}Eb&&ec&&0<ec.results.length&&(17===Eb.groupType&&({zOe:ec,nPe:Eb}=Be.CommandResultsUtility.s4j(ec,Eb,this.aU.QN()?this.aU.QN().lnl:-.6)),Cc.IPi(ec.groupType))}b2n(){new Pl.a;
this.b1c(this.aU.wqi)}vPc(cb,Eb){return this.query.Ig.length>this.aU.QN().xHl&&this.ukm(cb,Eb)||this.query.Ig.length>this.aU.QN().yHl&&this.enm(cb,Eb)?!0:!1}enm(cb,Eb){return cb&&cb.length&&Eb&&Eb.length?-1===Eb.toLowerCase().indexOf(cb.toLowerCase())?!1:!0:!1}ukm(cb,Eb){return cb&&cb.length&&Eb&&Eb.length?Eb.toLowerCase().startsWith(cb.toLowerCase()):!1}p$k(cb){const Eb=[];for(const ec of this.aU.QN().uO?this.Hce:this.Vn)cb.contains(ec.groupType)||Eb.push(ec);this.aU.QN().uO?this.JLe=Eb:this.uUb=
Eb}eoo(cb,Eb){const ec=[];for(const Cc of this.Vn){const Pc=Cc;if(13!==Pc.groupType){const jd=cb[Qd.a[Pc.groupType].toLowerCase()];let pe="False";jd<Eb&&(pe="True");Pc.displayName=Pc.displayName+" ("+pe+": "+jd+")"}ec.push(Pc)}this.uUb=ec}b1c(cb,Eb=!1,ec=null){if(this.aU.QN().uO){if(!Eb)for(this.JLe=Array(this.Vn.length),Eb=0;Eb<this.Vn.length;Eb++)this.Hce[Eb]=this.Vn[Eb];this.aU.Bqi.b1c(this.Vn,this.Hce,this.query,cb,ec)}else{for(ec=new Pl.a;this.Vn.length;){Eb=this.Vn.pop();const Cc=Qd.a[Eb.groupType].toLowerCase(),
Pc=cb[Cc];if(bi.c(Pc))throw Error.create("GroupId "+Cc+" missed from group SortingOrder");ec.add(new oh.a(Pc,Eb))}ec.Sc((Cc,Pc)=>Cc.key<Pc.key?-1:1);for(cb=0;cb<ec.count;cb++)Eb=ec.J(cb).value,this.Vn.push(Eb)}}c2n(){var cb=!1;let Eb=!1,ec=!1;for(let Pc=0;Pc<this.Vn.length;Pc++){var Cc=this.Vn[Pc];const jd=Cc.groupType;if(8===jd||15===jd||14===jd){Cc=Cc.results;for(let pe=0;pe<Cc.length;pe++){if(8===jd&&this.vPc(this.query.Ig,Cc[pe].label)){cb=!0;break}if(15===jd&&this.vPc(this.query.Ig,Cc[pe].label)){Eb=
!0;break}if(14===jd){if(this.vPc(this.query.Ig,Cc[pe].label)||this.vPc(this.query.Ig,Cc[pe].description)){ec=!0;break}const ue=Cc[pe].label.split(" ");for(const Od of ue)if(this.vPc(this.query.Ig,Od)){ec=!0;break}}}}}cb=this.aU.lJl(cb,Eb,ec);this.b1c(cb)}eHb(cb,Eb,ec,Cc,Pc,jd){if(Pc===this.eP){var pe=cb.data.Ie;Pc=null;try{Pc=lg.b(pe)}catch(Wg){Hf.TellMeActor.instance.Xe.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Wg);return}if("RankerResults"in Pc&&
Pc.RankerResults){this.Xza();var ue=Pc.RankerResults,Od=new Pl.a,zf=new Pl.a;pe=0;for(var Tf of ue){ue=Tf.ProviderId;var dc=Tf.Score;pe+=dc;Od.add(new oh.a(ue,dc))}Od.Sc((Bk,Ca)=>Bk.value>Ca.value?-1:1);dc=jd?jd.p_h:1E-6;Tf={};ue={};let Wg=0;for(var Oi=0;Oi<Od.count;Oi++){let Bk=parseInt(Od.J(Oi).key),Ca=Od.J(Oi).value/pe;1===Bk&&(ue.answer=Wg++,ue.entity=Wg++,ue.definition=Wg++,ue.wolframanswer=Wg++,Ca<dc&&(zf.add(9),zf.add(11),zf.add(10),zf.add(12)),Tf.answer=Ca,Tf.entity=Ca,Tf.definition=Ca,Tf.wolframanswer=
Ca);2===Bk&&(ue.assistance=Wg++,Ca<dc&&zf.add(8),Tf.assistance=Ca);3===Bk&&(ue.classifier=Wg++,ue.serviceclassifier=Wg++,Ca<dc&&(zf.add(0),zf.add(17)),Tf.classifier=Ca,Tf.serviceclassifier=Ca);4===Bk&&(ue.people=Wg++,Ca<dc&&zf.add(14),Tf.people=Ca);5===Bk&&(ue.document=Wg++,Ca<dc&&zf.add(15),Tf.document=Ca);6===Bk&&(ue.findindocument=Wg++,Ca<dc&&zf.add(2),Tf.findindocument=Ca);7===Bk&&(ue.notes=Wg++,Ca<dc&&zf.add(20),Tf.notes=Ca);8===Bk&&(ue.image=Wg++,Ca<dc&&zf.add(19),Tf.image=Ca)}Od=new Pl.a;Od.add("classifier");
Od.add("serviceclassifier");Od.add("appsforoffice");Od.add("addin");Od.add("findindocument");Od.add("assistance");Od.add("document");Od.add("people");Od.add("answer");Od.add("wolframanswer");Od.add("definition");Od.add("entity");Od.add("image");Od.add("template");Od.add("officescript");for(Oi=0;Oi<Od.count;Oi++)Od.J(Oi)in ue||(ue[Od.J(Oi)]=Wg++);ue.learning=Wg++;ue.insights=Wg++;ue.feedback=Wg++;jd&&jd.dgi&&this.eoo(Tf,dc);jd&&jd.egi&&this.p$k(zf);zf={};for(var Ci in Tf)zf[Ci]=Tf[Ci]*pe;this.b1c(ue,
!0,zf)}if(jd.FQd&&"Intents"in Pc&&Pc.Intents){Ci=Pc.Intents;for(var oi of Ci)if(this.Puf(oi)&&"Serplet"===oi.GroupType&&oi.ConfidenceScore>oi.ConfidenceThreshold){Ci=!1;Pc=0;if(jd.GQd){pe=new Zd.a("",28);for(zf=0;zf<this.Vn.length;zf++)if((Od=this.Vn[zf].results)&&0<Od.length){Pc=zf;pe=Od[0];break}2===pe.groupType&&(Ci=!0)}pe=new u.a(13);Ci&&jd.GQd&&(pe=new u.a(13,CommonUIStrings.l_TellMeWebTitle));zf=new Zd.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ig,null,0);Od=[];Tf=null;Tf=Mi.a.OCa()?
Mi.a.bXa(this.query.Ig,1):Mi.a.Zxb(this.query.Ig);Od.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Tf));Tf=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ig);Od.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Tf));appChrome.api.dispatch(Od);pe.Ez(zf);zf=[];if(Ci&&jd.GQd)for(zf.push(this.Vn[Pc]),zf.push(pe),Ci=Pc+1;Ci<this.Vn.length;Ci++)(Pc=this.Vn[Ci].results)&&0<Pc.length&&zf.push(this.Vn[Ci]);else for(zf.push(pe),
Ci=0;Ci<this.Vn.length;Ci++)(Pc=this.Vn[Ci].results)&&0<Pc.length&&zf.push(this.Vn[Ci]);this.uUb=zf}}if(jd.EPc&&!jd.uO){oi=Ci=-1;for(Pc=0;Pc<this.Vn.length;Pc++)switch(this.Vn[Pc].groupType){case 23:Ci=Pc;break;case 0:case 17:case 2:-1===oi&&(oi=Pc)}if(-1!==Ci){oi=-1===oi?0:Ci>oi?oi+1:oi;Ci=this.Vn[Ci];Pc=Array(this.Vn.length);pe=0;for(zf=0;zf<Pc.length;zf++)zf===oi?Pc[zf]=Ci:(23===this.Vn[pe].groupType&&pe++,Pc[zf]=this.Vn[pe],pe++);this.uUb=Pc}}Cc.resultsUpdated(this);Cc=Hf.TellMeActor.instance.Xe;
Cc.l7(Eb.length,"RankerInference",cb.data.Df.toString(),Math.round(window.performance.now()-ec),Ql.a.pbj,!0,Pi.a.vMa);this.B7b&&Cc&&(cb=this.query.zjb,Eb=Cc.q9c,jd.VQd&&cb>Eb&&!jd.uO&&(Cc.pyf(this.query.Ig),Cc.qYf(cb)))}}Puf(cb){if("GroupType"in cb&&cb.GroupType&&"ConfidenceScore"in cb&&"ConfidenceThreshold"in cb)return!0;Hf.TellMeActor.instance.Xe.onError("IsValidIntentGroup","Invalid intents found");return!1}RGb(cb,Eb,ec,Cc,Pc){Cc===this.eP&&(this.Xza(),Hf.TellMeActor.instance.Xe.l7(Eb.length,"RankerInference",
cb.data.Df.toString(),Math.round(window.performance.now()-ec),Ql.a.pbj,!1,Pi.a.vMa));Pc.resultsUpdated(this)}Xza(){-1!==this.E0&&(window.clearTimeout(this.E0),this.E0=-1)}d2n(cb){let Eb;Eb=this.aU.QN().uO?Hf.TellMeActor.instance.Xe.Aif(this.Hce,this.query.Ig):Hf.TellMeActor.instance.Xe.Aif(this.Vn,this.query.Ig);var ec=this.aU.QN().o_h;""!==ec&&(ec="_"+ec);let Cc="";this.aU.QN().PPd&&(Cc="RankerInference"+ec+",");this.aU.QN().FQd&&(Cc+="SerpletClassifier");","===Cc.charAt(Cc.length-1)&&(Cc=Cc.substring(0,
Cc.length-1));ec=Hf.TellMeActor.instance.Xe.c1h(Cc);const Pc=this.eP=Mj.a.create().toString();ec["Client-Request-Id"]=Pc;const jd=window.performance.now(),pe=this.aU.QN()?this.aU.QN().q_h:600;this.Xza();this.E0=window.setTimeout(()=>{if(Pc===this.eP){this.eP="";this.E0=-1;cb.resultsUpdated(this);const ue={};ue[a.a.provider]="Ranker";ue[a.a.pIb]=this.query.zjb;Hf.TellMeActor.instance.Xe.Yz(h.a.timedOut,pe,ue)}},pe);this.rg.Mj(Hf.TellMeActor.instance.Xe.d1h(),2,Eb,ec,!1,0,ue=>{this.eHb(ue,this.query.Ig,
jd,cb,Pc,this.aU.QN())},ue=>{this.RGb(ue,this.query.Ig,jd,Pc,cb)},null,null,!1,4E3,6E3)}Rdo(){var cb=0,Eb=new Pl.a,ec=this.aU.uqi,Cc=this.aU.vqi;for(var Pc=0;Pc<this.Vn.length;Pc++){var jd=this.Vn[Pc],pe=Qd.a[jd.groupType].toLowerCase(),ue=ec[pe];cb+=jd.results.length;jd.results.length>ue&&(pe=Cc[pe],bi.c(pe)||Eb.add(new oh.a(pe,jd)))}Cc=!this.query||""===this.query.Ig.trim();Pc=cb-(Cc?this.bAf:this.Zzf);if(!(0>=Pc)){Cc=window.performance.now();cb=cb.toString()+" total,"+Pc.toString()+" to remove.";
if(0<Eb.count)for(Eb.Sc((Od,zf)=>Od.key>zf.key?-1:1),jd=0;jd<Eb.count&&0<Pc;jd++){pe=Eb.J(jd).value;ue=Qd.a[pe.groupType].toLowerCase();let Od=pe.results.length-ec[ue];Od>Pc&&(Od=Pc);0<Od&&(pe.WSf(Od),cb+=ue+": "+Od.toString()+" results removed.",Pc-=Od)}if(0<Pc){cb+=Pc.toString()+" results left after trimming.";Eb=new Pl.a;ec=this.aU.zqi;for(jd=0;jd<this.Vn.length;jd++)pe=this.Vn[jd],ue=ec[Qd.a[pe.groupType].toLowerCase()],bi.c(ue)||Eb.add(new oh.a(ue,pe));Eb.Sc((Od,zf)=>Od.key<zf.key?-1:1);for(ec=
0;0<Pc;)jd=Eb.J(ec++).value,Pc>=jd.results.length?(Array.remove(this.Vn,jd),cb+=Qd.a[jd.groupType]+": "+jd.results.length.toString()+" results force removed.",Pc-=jd.results.length):(jd.WSf(Pc),cb+=Qd.a[jd.groupType]+": "+Pc.toString()+" results force removed.",Pc=0)}Hf.TellMeActor.instance.Xe&&(Eb={},Eb[a.a.message]=cb,Hf.TellMeActor.instance.Xe.Yz("ShowOptimal",window.performance.now()-Cc,Eb))}}}Object(l.a)(vl,"CombineResultsUpdatedEventArgs",null,[1120]);var kd=c(1568);class yf{constructor(cb,
Eb,ec,Cc=!1,Pc=""){this.PCe=this.sFe=!1;this.Ru=cb;this.utb=[];this.jYg=Eb.length;this.qc=Hf.TellMeActor.instance.QN();this.zed=Cc;this.Bja=Pc;this.MVb={};for(cb=0;cb<Eb.length;++cb)this.MVb[cb.toString()]=ec?0:Eb[cb].FW()}lQn(cb,Eb){Eb&&Eb.query&&Eb.query.zjb<Hf.TellMeActor.instance.Qqa||(this.utb[cb]=Eb,this.PCe?this.sFe=!0:(!this.qc||3!==this.qc.Nv||3!==this.MVb[cb.toString()]||this.fBh())&&this.yNd())}b6m(){this.PCe=!0}who(){this.PCe=!1;this.sFe&&(this.sFe=!1,this.yNd())}fBh(){if(this.utb.length<
this.jYg)return!1;for(let cb=0;cb<this.jYg;++cb)if(!this.utb[cb])return!1;return!0}yNd(){var cb=this.fBh();const Eb=window.performance.now(),ec=new vl(Hf.TellMeActor.instance.THg);ec.vsn(this.utb);for(var Cc=0;Cc<this.utb.length;++Cc){var Pc=this.utb[Cc];if(Pc&&Pc.Vn&&Pc.Vn.length&&(ec.query=Pc.query,Pc.attributes&&0<Pc.attributes.length&&(ec.attributes=Pc.attributes),Pc&&Pc.Vn&&(cb||this.Cwk(Cc,this.utb))))for(const jd of Pc.Vn)ec.kw(jd)}ec.Vn&&ec.Vn.length&&(ec.B7b=cb,this.qc&&this.qc.Pbe&&ec.Rdo(),
kd.a.Lii()&&(this.qc&&this.qc.Llm&&ec.query.Ig&&0<ec.query.Ig.length?ec.c2n():ec.b2n()),kd.a.Lii()&&this.qc&&(this.qc.PPd||this.qc.FQd)&&this.zed&&ec.query.Ig&&0<ec.query.Ig.length&&ec.B7b&&this.Bja!==e.a.contextMenu?(3===this.qc.Nv&&cb||this.Ru.resultsUpdated(ec),ec.d2n(this.Ru)):this.Ru.resultsUpdated(ec),cb=Hf.TellMeActor.instance.Xe,ec.B7b&&cb&&(Cc=ec.query.zjb,Pc=cb.q9c,ec.query.Ig&&0<ec.query.Ig.length&&this.zed&&this.qc.VQd&&this.Bja!==e.a.contextMenu&&Cc>Pc&&!this.qc.PPd&&!this.qc.uO&&(cb.pyf(ec.query.Ig),
cb.qYf(Cc)),cb.Yz(h.a.MAn,window.performance.now()-Eb)))}Cwk(cb,Eb){if(!(this.MVb&&cb.toString()in this.MVb)||Eb.length<=cb||!Eb[cb])return!1;if(!Eb[cb].Vn.length)return!0;const ec=this.MVb[cb.toString()];if(0===ec)return!0;const Cc=this.MVb;for(let jd in Cc){var Pc=Cc[jd];const pe=Number.parseInvariant(jd);if(pe!==cb&&Pc===ec&&!(Eb.length>pe&&Eb[pe]))return!1}return!0}}Object(l.a)(yf,"ResultsAggregator",null,[]);var Yd=c(1681);class Rj{constructor(){this.Hgc=this.Igc=this.Ggc=this.logCount=this.logRank=
this.invertedRank=0}c4j(cb,Eb){switch(cb){case 1:this.invertedRank=Eb;break;case 3:this.logRank=Eb;break;case 2:this.logCount=Eb;break;case 5:this.Ggc=Eb;break;case 4:this.Igc=Eb;break;case 6:this.Hgc=Eb}}}Object(l.a)(Rj,"CommandFeatures",null,[]);class fk{constructor(cb){this.pFg=0;this.kOj=cb;this.CAj={}}get modelId(){return this.kOj}get featureIntercept(){return this.pFg}get uBc(){return this.CAj}a3j(cb,Eb,ec){0===Eb?this.pFg=ec:(this.uBc[cb]||(this.uBc[cb]=new Rj),this.uBc[cb].c4j(Eb,ec))}}Object(l.a)(fk,
"CoefficientsModel",null,[]);const vg=(cb,Eb)=>Math.pow(10,-Eb/(60*Math.LN10/Math.LN2*cb));class Ie{constructor(cb,Eb){this.ej=1;this.fad=new Rj;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=cb?1/cb:0;this.features.logRank=2/Math.pow(2,cb);this.features.Ggc=vg(10,Eb);this.features.Igc=vg(2,Eb);this.features.Hgc=vg(1,Eb)}get count(){return this.ej}get features(){return this.fad}E8h(){this.ej=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}Sno(cb){const Eb=
2/Math.pow(2,cb);this.features.invertedRank=Math.max(this.features.invertedRank,cb?1/cb:0);this.features.logRank=Math.max(this.features.logRank,Eb)}spo(cb){const Eb=vg(10,cb),ec=vg(2,cb);cb=vg(1,cb);this.features.Ggc=Math.max(this.features.Ggc,Eb);this.features.Igc=Math.max(this.features.Igc,ec);this.features.Hgc=Math.max(this.features.Hgc,cb)}}Object(l.a)(Ie,"CommandModel",null,[]);class Gm{constructor(cb){this.$kc=null;if(!cb&&Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("PredictionEngine",
"IModelAdapter can't be null");this.$Sb=cb;this.pgd=this.vxf()}vxf(){const cb=this.$Sb.fBl(),Eb=this.$Sb.fgf();if(void 0===cb||null===cb||void 0===Eb||null===Eb)return!1;try{window.performance.now();this.$kc={};for(let ec=0;ec<cb.length;ec++){const Cc=cb[ec],Pc=Eb[Cc[0].toString()].trim(),jd=Cc[1],pe=0!==jd?Eb[Cc[2].toString()].trim():"",ue=Cc[3];Pc in this.$kc||(this.$kc[Pc]=new fk(Pc));this.$kc[Pc].a3j(pe,jd,ue)}}catch(ec){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("LoadModelData",
"Error Loading Suggestions Model: "+ec);return!1}return!0}chl(){const cb=this.$Sb.Kxl(),Eb={};if(!cb)return Eb;let ec=1;for(let Cc=0;Cc<cb.length;Cc++){const Pc=cb[Cc];Pc.Id in Eb?(Eb[Pc.Id].E8h(),Eb[Pc.Id].Sno(ec),Eb[Pc.Id].spo(Pc.TimeElapsedSinceClick)):Eb[Pc.Id]=new Ie(ec,Pc.TimeElapsedSinceClick);ec++}return Eb}usf(){this.pgd||(this.pgd=this.vxf());return this.pgd}gGl(){let cb=[];if(!this.pgd){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("GetPredictedCommands","IModelAdapter returned no data");
return cb}const Eb=this.chl(),ec=this.$kc;for(let Pc in ec){const jd=ec[Pc],pe=jd.modelId;let ue=0;for(let Od in Eb){var Cc=Od;const zf=Eb[Od].features;(Cc=Cc in jd.uBc?jd.uBc[Cc]:null)&&(ue+=zf.invertedRank*Cc.invertedRank+zf.logRank*Cc.logRank+zf.logCount*Cc.logCount+zf.Ggc*Cc.Ggc+zf.Igc*Cc.Igc+zf.Hgc*Cc.Hgc)}ue+=jd.featureIntercept;cb.push(new ai.a(pe,ue))}cb.sort((Pc,jd)=>Pc.score<jd.score?1:Pc.score>jd.score?-1:0);0<cb.length-10&&(cb=cb.slice(0,10));return cb}}Object(l.a)(Gm,"PredictionEngine",
null,[]);class ej{constructor(){this.o0g={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}UEd(cb,
Eb){return Eb&&"word"===Eb.application.toLowerCase()&&cb in this.o0g?this.o0g[cb]:[]}}Object(l.a)(ej,"SuggestionResultsUtility",null,[]);class Ph{constructor(cb,Eb,ec){this.qc=Eb;this.bsc=new Gm(cb);this.f1=ec;this.h3g=new ej}IL(){return"Suggestion"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:2}MI(cb,Eb,ec,Cc=e.a.tellMe,Pc=null){ec=new n.a(cb);Hf.TellMeActor.instance.u4c=!1;if((!Pc||Array.contains(Pc,16))&&Mi.a.YW(cb)){if(!this.bsc.usf()){if(Hf.TellMeActor.instance.Xe)Hf.TellMeActor.instance.Xe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.AQd()&&0<this.h3g.UEd(Hf.TellMeActor.instance.tyd,this.qc).length){const pe=this.h3g.UEd(Hf.TellMeActor.instance.tyd,this.qc);Pc=[];for(var jd of pe)this.qc.y8d&&"Find"===jd||Pc.push(new ai.a(jd,0));Hf.TellMeActor.instance.u4c=!0}else Pc=this.bsc.gGl();Be.CommandResultsUtility.ITd(Pc,!0,"Recommended","LRE");jd=[];for(const pe of Pc)this.f1&&this.f1.uZe(pe.commandId)||
jd.push(pe);cb=Be.CommandResultsUtility.$Hd(cb,jd,this.qc,null,null,null,16,1);0<cb.results.length&&Cc!==e.a.contextMenu&&(cb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<cb.results.length&&ec.kw(cb)}Eb.resultsUpdated(ec)}AQd(){return!!this.qc&&(this.qc.AQd||this.qc.Upm)}}Object(l.a)(Ph,"SuggestionResultsProvider",null,[1143]);class dg{Kxl(){return Hf.TellMeActor.instance.Yke}fBl(){return window.TellMeSuggestionModel}fgf(){return window.CoefficientModelIdMap}}Object(l.a)(dg,"SuggestionsModelAdapter",
null,[1168]);var Ll=c(1695),vf=c(1654);c.d(O,"AggregatorResultsProvider",function(){return Ae});class Ae{constructor(cb=!1){this.hUb={};this.hUb[e.a.tellMe]=[];this.hUb[e.a.contextMenu]=[];this.zed=cb}Aki(cb,Eb,ec,Cc,Pc=null){let jd;var pe=!1;switch(Cc){case e.a.contextMenu:jd=this.hUb[e.a.contextMenu];pe=!0;break;default:jd=this.hUb[e.a.tellMe]}Eb=new yf(Eb,jd,pe,this.zed,Cc);Eb.b6m();for(let ue=0;ue<jd.length;++ue){const Od=window.performance.now(),zf=new v(Eb,ue);(pe=Hf.TellMeActor.instance.QN())&&
pe.Dlk?window.setTimeout(()=>{jd[ue].MI(cb,zf,ec,Cc,Pc);if(Hf.TellMeActor.instance.Xe){const Tf={};Tf[a.a.provider]=jd[ue].IL();Tf[a.a.pIb]=cb.zjb;Hf.TellMeActor.instance.Xe.Yz(h.a.MI,window.performance.now()-Od,Tf)}},0):(jd[ue].MI(cb,zf,ec,Cc,Pc),Hf.TellMeActor.instance.Xe&&(pe={},pe[a.a.provider]=jd[ue].IL(),pe[a.a.pIb]=cb.zjb,Hf.TellMeActor.instance.Xe.Yz(h.a.MI,window.performance.now()-Od,pe)))}Eb.who()}IL(){return"Aggregator"}FW(){return 0}MI(cb,Eb,ec=!1,Cc=e.a.tellMe,Pc=null){if(Hf.TellMeActor.instance.hLm)this.Aki(cb,
Eb,ec,Cc,Pc);else{const jd=window.performance.now();Hf.TellMeActor.instance.Nto.then(()=>{Hf.TellMeActor.instance.Xe&&Hf.TellMeActor.instance.Xe.Yz(h.a.iLm,window.performance.now()-jd);this.Aki(cb,Eb,ec,Cc,Pc);return!0})}}YH(cb,Eb){this.hUb[Eb].push(cb)}M4j(cb){switch(cb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Eb=this.hUb[e.a.tellMe];for(const ec of Eb)if("FindInDocument"===ec.IL()){ec.rOn(cb);break}}}static createInstance(cb,Eb,ec,Cc){const Pc=
Cc&&Mi.a.R_f(Eb);var jd=Pc&&Eb.KJf;const pe=Eb.Auf&&!Mi.a.jEb(),ue=Eb.Hsf,Od=new Ae(Pc);if(Eb.qXn){var zf=new li(Eb);Od.YH(zf,e.a.tellMe)}zf=Eb.hq?de.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):de.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Tf=!zf&&de.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Od.YH(new kf.a(cb,Eb.Hfo,Tf,!1),e.a.tellMe);zf&&Od.YH(new Ph(new dg,Eb,cb),e.a.tellMe);cb=de.AFrameworkApplication.ta.Rb.xji?new Hi(Eb,new ch):
new Fj(Eb,ec);Od.YH(cb,e.a.contextMenu);(Pc&&Eb.LJf||jd)&&Od.YH(Ll.a.Vwh(Eb,!0),e.a.tellMe);Od.YH(cb,e.a.tellMe);!Eb.bJh||"Word"===Eb.application&&Eb.KCd||Od.YH(new si(Eb),e.a.tellMe);Eb.Wvb&&(jd=new x(Eb),Od.YH(jd,e.a.tellMe),Od.YH(jd,e.a.contextMenu));!Eb.dwb||Eb.p0c||Eb.o0c||Od.YH(new A.a(Eb),e.a.tellMe);Cc&&(Eb.JZ||Mi.a.OCa())&&(jd=new Xg(Eb),Od.YH(jd,e.a.tellMe),Od.YH(jd,e.a.contextMenu));Pc&&Od.YH(Ll.a.Vwh(Eb,!1),e.a.tellMe);Cc&&!Eb.Q3f&&Mi.a.Q_f(Eb)&&(Od.YH(new Yd.a(Eb),e.a.tellMe),Eb.I$i&&
Od.YH(new Yd.a(Eb),e.a.contextMenu));pe&&Od.YH(new cf(Eb),e.a.tellMe);(Eb.Rec||Eb.uO)&&Od.YH(new ag.a(Eb),e.a.tellMe);Eb.EPc&&Od.YH(new vf.a(Eb),e.a.tellMe);Cc&&Eb.MNd&&Od.YH(new m.AddinResultsProvider(Eb),e.a.tellMe);ue&&"Excel"===Eb.application&&Od.YH(new Wk(Eb),e.a.tellMe);return Od}}Object(l.a)(Ae,"AggregatorResultsProvider",null,[1143])},1674:function(C,O,c){C=c(0);var l=c(16),e=c(5),a=c(149),h=c(216),m=c(386),v=c(59),u=c(64),n=c(928),x=c(851),A=c(552);c(497);var H=c(1644),E=c(1645),L=c(1641),
M=c(1643),F=c(1642),J=c(927),I=c(850);class K{constructor(ka,ia,La){this.zgl=ka;this.Uik=ia;this.Euk=La}}Object(C.a)(K,"BacktraceAndMakeUpdateHintsInput",null,[]);var N=c(1494),G;(function(ka){ka[ka.EOP=0]="EOP";ka[ka.character=1]="character";ka[ka.embeddedMarker=2]="embeddedMarker"})(G||(G={}));Object(C.b)("LCSBlockType",G);class P{toString(){return String.format("[Type: {0}]",G[this.type])}}Object(C.a)(P,"ALCSBlock",null,[]);class S extends P{constructor(ka,ia){super();this.fke=ia;this.yCe=ka}get type(){return 1}get character(){return this.fke}get mv(){return this.yCe}Tz(ka){return 1===
ka.type&&N.a.Yeh(ka.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(C.a)(S,"CharacterLCSBlock",P,[]);class W extends P{constructor(ka,ia,La){super();this.yCe=ka;this.dNe=ia;this.crc=La}get type(){return 0}get Nc(){return this.dNe}get length(){return this.crc}get mv(){return this.yCe}Tz(ka){return 0!==ka.type?!1:ka.mv===this.mv&&ka.Nc===this.Nc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.mv.toString(),this.Nc,this.length)}}Object(C.a)(W,"EOPLCSBlock",P,[]);class X extends S{constructor(ka,ia,La){super(ka,"\ufffc");this.yNj=ia;this.Xad=La}get type(){return 2}get Wl(){return this.yNj}get Bj(){return this.Xad}Tz(ka){return 2!==ka.type?!1:ka.Wl===this.Wl&&this.Bj.equals(ka.Bj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.Wl,this.Bj)}}Object(C.a)(X,"EmbeddedMarkerLCSBlock",S,[]);class Y{constructor(ka,ia){this.x=ka;this.y=ia}equals(ka){return ka.x===
this.x&&ka.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(C.a)(Y,"IntPair",null,[981]);var ca=c(1527),ha=c(1513),ra=c(1528),sa=c(1640);c.d(O,"a",function(){return oa});class oa{constructor(ka,ia){this.Pg=ka;this.ge=ia}fxh(ka,ia,La,va,Ga,Oa,Za){return this.cQk(ka,ia,La,va,Ga,Oa,Za)}cQk(ka,ia,La,va,Ga,Oa,Za){let ja;ja=null;({returnValue:ka}=this.BGd(ka,ia));if(!ka)return a.a.instance.Sa(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.ge.logger.ZT("GetLCSBlocksFromObject"),
{returnValue:!1,updateHints:ja};({returnValue:La}=this.BGd(La,va));if(!La)return a.a.instance.Sa(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.ge.logger.ZT("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ja};this.ge.logger.ZT("GetLCSBlocksFromObject");ja=this.bQk(ka,La,Ga,Oa,Za);return ja?{returnValue:!0,updateHints:ja}:(a.a.instance.Sa(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ja})}SIh(ka,ia,La,va){({returnValue:ka}=this.BGd(ka,ia));
if(!ka)return-1;({returnValue:La}=this.BGd(La,va));if(!La)return-1;({C2e:La}=this.VIh(ka,La));return La}BGd(ka,ia){let La;const va=new h.a;La=new h.a;if(!ka.length)return a.a.instance.Sa(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.ge.logger.Tg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,$7e:La};for(let Za=0;Za<ka.length;Za++)if(this.ge.runtime.hG("GetLCSBlocksFromObject: paraObjs#"+Za),393230===ka.J(Za).Qc){const ja=this.Pg.getPropertyString(ka.J(Za),
l.a.mo),ba=this.Pg.getPropertyUint32(ka.J(Za),e.a.Nc);if(null==ba)return a.a.instance.Sa(594124835,1,2,"Abandoning LCS due to missing WordId"),this.ge.logger.Tg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,$7e:La};let qa=this.Pg.getPropertyUint32s(ka.J(Za),l.a.km);qa=ha.a.s1i(qa,ja.length);const Ma=this.Pg.getPropertyObjectIds(ka.J(Za),l.a.wn);let Ia;for(Ia=0;Ia<qa.length-1;Ia++){var Ga=ia(Ma.mg(Ia)),Oa=void 0;Oa=Ga?(Oa=this.Pg.getPropertyBool(Ga,l.a.e8))?
Oa:!1:!1;if(Oa)va.add(this.WKk(ka.J(Za).id,Ga));else for(Ga=qa.mg(Ia);Ga<qa.mg(Ia+1);Ga++)va.add(new S(ka.J(Za).id,N.a.charAt(ja,Ga)))}va.add(new W(ka.J(Za).id,ba,qa.J(Ia)));La.add(va.length-1)}else return a.a.instance.Sa(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ka.J(Za).Qc),this.ge.logger.Tg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,$7e:La};this.ge.runtime.hG("LCS: GetLCSBlocks for base");return{returnValue:va,
$7e:La}}WKk(ka,ia){const La=null==this.Pg.getPropertyInt32(ia,e.a.Gq)?0:this.Pg.getPropertyInt32(ia,e.a.Gq);return new X(ka,La,ia.id)}bQk(ka,ia,La,va,Ga){va=({C2e:La}=this.VIh(ka,ia,La,va,Ga)).returnValue;this.ge.logger.ZT("FindFurthestPaths");ka=new K(va,ka,ia);ka=new sa.a(this.Kik(ka,La),1);this.ge.logger.ZT("BacktraceAndMakeUpdateHints");return ka}VIh(ka,ia,La=-1,va=-1,Ga=-1){let Oa;if(-1===La||-1===va||-1===Ga)Ga=va=La=-1;Oa=-1;const Za=new m.a;Za.Z(new Y(-1,1),new Y(0,-1));if(-1!==La){Za.Z(new Y(0,
0),new Y(La,La));var ja=1}else ja=0,va=ka.length,Ga=ia.length;for(La=0;ja<=ka.length+ia.length;ja++){let ba=!1;for(let qa=-ja;qa<=ja;qa+=2){let Ma,Ia;qa===-ja?(Ma=Za.J(new Y(ja-1,qa+1)).x,Ia=Za.J(new Y(ja-1,qa+1)).y+1):qa===ja?(Ma=Za.J(new Y(ja-1,qa-1)).x+1,Ia=Za.J(new Y(ja-1,qa-1)).y):Za.J(new Y(ja-1,qa-1)).x>=Za.J(new Y(ja-1,qa+1)).x?(Ma=Za.J(new Y(ja-1,qa-1)).x+1,Ia=Za.J(new Y(ja-1,qa-1)).y):(Ma=Za.J(new Y(ja-1,qa+1)).x,Ia=Za.J(new Y(ja-1,qa+1)).y+1);for(;Ma<va&&Ia<Ga&&ka.J(Ma).Tz(ia.J(Ia));)Ma++,
Ia++;Za.Z(new Y(ja,qa),new Y(Ma,Ia));if(Ma===va&&Ia===Ga){ba=!0;Oa=ja;La=qa;break}}if(ba)break;this.ge.runtime.hG("LCS FindFurthestPaths")}if(La!==va-Ga)return{returnValue:null,C2e:Oa};Za.Z(new Y(Oa,La),new Y(va+1,Ga+1));a.a.instance.Sa(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ka.length,ia.length,Oa);return{returnValue:Za,C2e:Oa}}Kik(ka,ia){const La=ka.zgl,va=ka.Uik;ka=ka.Euk;const Ga=new h.a;let Oa=va.length,Za=ka.length;for(;0<Oa||
0<Za;){var ja=Oa-1,ba=Za-1;if(this.a6m(La,ia,Oa,Za)){ja=ka.J(ba);if(1===ja.type||2===ja.type)this.M8l(Ga,Oa,ja);else if(0===ja.type)this.m8l(Ga,Oa,ja);else return a.a.instance.Sa(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ja.type),this.ge.logger.Tg(Object.assign(new ra.a,{kj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Za--;ia--}else if(this.$5m(La,ia,Oa,Za)){ba=va.J(ja);if(1===ba.type||2===ba.type)this.fVk(Ga,ja,ba);else if(0===ba.type)this.LUk(Ga,ja,ba);else return a.a.instance.Sa(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",ba.type),this.ge.logger.Tg(Object.assign(new ra.a,{kj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Oa--;ia--}else if(Oa&&Za&&va.J(ja).Tz(ka.J(ba)))Oa--,Za--;else return a.a.instance.Sa(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.ge.logger.Tg(Object.assign(new ra.a,{kj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.ge.runtime.hG("LCS: CreateUpdateHintsFromLCSBlocks");return Ga}$5m(ka,ia,La,va){ia=
new Y(ia-1,La-va-1);return ka.ub(ia)&&ka.J(ia).x===La-1&&ka.J(ia).y===va}a6m(ka,ia,La,va){ia=new Y(ia-1,La-va+1);return ka.ub(ia)&&ka.J(ia).x===La&&ka.J(ia).y===va-1}addPara(ka,ia,La,va,Ga,Oa){var Za=null;La.block?Za=La.block.mv:0<=Ga&&0===ka.J(Ga).type&&(Za=ka.J(Ga).mv);La=ka=Oa.mv;if(va.IXb.contains(ka))for(Ga=0,ka=v.a.Pf("{00000000-0000-0000-0000-000000000000}{"+Ga+"}");va.IXb.contains(ka);)Ga++,ka=v.a.Pf("{00000000-0000-0000-0000-000000000000}{"+Ga+"}");Za=new n.AddParagraphUpdateHint(ka,Oa.Nc,
Za);Za.P1m=La;ia.updateHints.add(Za);va.mv=ka;va.Nc=Oa.Nc;va.IXb.add(ka);va.BOa=0}m8l(ka,ia,La){La=new L.a(La.mv,La.Nc);let va=!1;if(0<ka.length&&11===ka.mg(ka.length-1).type){const Ga=ka.mg(ka.length-1);Ga.cp===ia&&(va=!0,Ga.FZ.add(La))}va||(ia=new F.a(ia),ia.FZ.add(La),ka.add(ia))}splitPara(ka,ia,La,va,Ga,Oa,Za,ja){ka=this.Fal(Oa.mv,ka,ia,va);if(!ka)return!1;ia=new I.a(Oa.mv,Oa.Nc,Oa.BOa,ka.mv,ka.Nc,Za.mv,Za.Nc);La.updateHints.add(ia);Oa.Nc=ka.Nc;ka!==ja?(Ga.block=ka,Ga.uFo=Oa.BOa,Ga=new n.AddParagraphUpdateHint(ja.mv,
ja.Nc,ka.mv),La.updateHints.add(Ga),Oa.mv=ja.mv,Oa.Nc=ja.Nc,Oa.IXb.add(ja.mv),Oa.BOa=0):Oa.IXb.add(Za.mv);return!0}M8l(ka,ia,La){var va=!1;if(0<ka.length&&11===ka.mg(ka.length-1).type){const Ga=ka.mg(ka.length-1);Ga.cp===ia&&((va=Object(u.a)(M.a,Ga.FZ.J(Ga.FZ.length-1)))?va.text=La.character.toString()+va.text:Ga.FZ.add(new M.a(La.mv,La.character.toString())),va=!0)}va||(ia=new F.a(ia),ia.FZ.add(new M.a(La.mv,La.character.toString())),ka.add(ia))}deletePara(ka,ia,La,va,Ga,Oa){let Za=-1;for(let ja=
0;ja<Ga.length;ja++)if(Ga.J(ja)===Oa){0<ja&&(Za=ja-1);break}Oa=null;0<=Za&&(Oa=va.J(Ga.J(Za)));va=new x.a(La.mv,La.Nc,Oa?Oa.mv:null);ka.updateHints.add(va);Oa&&ia.mv.equals(La.mv)&&(ia.BOa=Oa.length,ia.mv=Oa.mv,ia.Nc=Oa.Nc);ia.IXb.remove(La.mv)}LUk(ka,ia,La){ia=new H.a(ia,La.mv,La.Nc);ka.add(ia)}mergePara(ka,ia,La){ka.updateHints.add(new J.MergeParagraphUpdateHint(La.mv,La.Nc,La.length,ia.mv,ia.Nc,La.mv,ia.Nc));ia.BOa=La.length;ia.IXb.remove(ia.mv);ia.mv=La.mv}deleteText(ka,ia,La){let va=!1;if(0<
ka.updateHints.length&&2===ka.updateHints.mg(ka.updateHints.length-1).type){const Ga=ka.updateHints.mg(ka.updateHints.length-1);Ga.Dg.equals(ia.mv)&&Ga.cp===ia.BOa&&(Ga.cp=ia.BOa-1,Ga.text=La.character.toString()+Ga.text,va=!0)}va||ka.updateHints.add(new A.DeleteTextUpdateHint(ia.mv,ia.BOa-1,La.character.toString()));--ia.BOa}fVk(ka,ia,La){let va=!1;if(0<ka.length&&8===ka.mg(ka.length-1).type){const Ga=ka.mg(ka.length-1);Ga.cp===ia+1&&(Ga.text=La.character.toString()+Ga.text,--Ga.cp,va=!0)}va||ka.add(new E.a(ia,
La.character.toString()))}Fal(ka,ia,La,va){for(;0<=va;){var Ga=ia.J(La.J(va));if(0!==Ga.type)break;if(Ga.mv.equals(ka))return Ga;va--}return null}}Object(C.a)(oa,"LCSUpdateHintGenerator",null,[])},1680:function(C,O,c){c.r(O);C=c(0);var l=c(16),e=c(5),a=c(149),h=c(386),m=c(619),v=c(216),u=c(59),n=c(44),x=c(1483);class A extends x.a{constructor(){super()}get xea(){return"ChildNodeListMerge"}}Object(C.a)(A,"ChildNodeListMergeFailureDetail",x.a,[]);class H{omb(Y,ca,ha){return ca.Py(Y,ha.J(Y))}dfj(Y,ca,
ha,ra){let sa;return({value:sa}=ca.Bc(Y)).returnValue||({value:sa}=ha.Bc(Y)).returnValue?sa:ra.J(Y)}}Object(C.a)(H,"ChildNodeListMergeUtils",null,[1900]);var E=c(1507),L=c(1694),M=c(1566);class F{constructor(Y,ca){this.classId=Y;this.ggo=ca}}Object(C.a)(F,"NodeChildrenTransformation",null,[]);var J=c(791),I=c(1498);class K{constructor(Y,ca,ha){this.bE=Y;this.Voa=ha;this.k6=ca}i1d(Y){let ca,ha;return({eJi:ca}=this.jfj(this.Voa,Y)).returnValue&&ca.XW||({eJi:ha}=this.jfj(this.k6,Y)).returnValue&&ha.XW}jfj(Y,
ca){let ha;return{returnValue:({value:ha}=(new I.a(this.bE,Y)).Qna.Bc(J.a.yb(ca))).returnValue,eJi:ha}}}Object(C.a)(K,"NodeTriplet",null,[]);var N=c(1639);class G{constructor(Y,ca,ha){this.ge=Y;this.Pg=ca;this.QV=ha;this.c3g=!0}get ap(){return this.ge}get $d(){return this.Pg}get Pwa(){return this.QV}get success(){return this.c3g}vFl(){a.a.instance.Sa(4220310,1,5,"Evaluating ParentObjects");const Y=new h.a;this.WUe(Y,ca=>this.ap.runtime.lk.J(ca));this.WUe(Y,ca=>this.Pwa.omb(ca,this.ap.runtime.du,this.ap.runtime.lk));
this.WUe(Y,ca=>this.Pwa.omb(ca,this.ap.runtime.nq,this.ap.runtime.lk));return Y}WUe(Y,ca){const ha=ca(c(1680).ChildNodeListMerge.XZd);this.$d.getPropertyObjectIds(ha,l.a.$e).forEach(ra=>{this.$d.getPropertyObjectIds(ca(ra),l.a.$e).forEach(sa=>{Y.ub(sa)&&!ra.equals(Y.J(sa))&&(this.c3g=!1,a.a.instance.Sa(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",sa,ra,Y.J(sa)));Y.Z(sa,ra);return!0});return!0})}}Object(C.a)(G,"OutlineGroupParentFinder",null,[]);var P=
c(1484),S=c(1529),W=c(1567);c.d(O,"ChildNodeListMerge",function(){return X});class X{constructor(Y,ca=null,ha=null,ra=null,sa=null){this.Pg=Y;this.p4m=ca||L.a.Dfj;this.kWd=ha||this.CCl();this.Pwa=ra||new H;this.osi=sa||this.LAl()}get $d(){return this.Pg}CCl(){return[new F(393227,Object(n.a)(this,this.c3m,"pageContentNodeThreewayChildMerge")),new F(1073872968,Object(n.a)(this,this.Bxo,"wordSectionNodeThreewayChildMerge")),new F(393241,Object(n.a)(this,this.OZd,"outlineElementContainerThreewayChildMerge")),
new F(393252,Object(n.a)(this,this.m8n,"tableCellThreewayChildMergev2")),new F(1074135125,Object(n.a)(this,this.OZd,"outlineElementContainerThreewayChildMerge")),new F(1074135123,Object(n.a)(this,this.OZd,"outlineElementContainerThreewayChildMerge")),new F(1074135127,Object(n.a)(this,this.OZd,"outlineElementContainerThreewayChildMerge"))]}LAl(){return[Object(n.a)(this,this.f$m,"prepareObjectGroupings"),Object(n.a)(this,this.fVl,"handleInterOutlineGroupMerge"),Object(n.a)(this,this.C6m,"performThreewayChildMerge")]}sJm(Y){let ca=
0;for(;ca<this.osi.length;ca++)if(!(0,this.osi[ca])(Y))return a.a.instance.Sa(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ca),Y.logger.OTd("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ca),!1;return!0}f$m(Y){const ca=new h.a,ha=new h.a,ra=new m.a;Y.runtime.du.forEach((sa,oa)=>X.cFi(oa,ca));Y.runtime.nq.forEach((sa,oa)=>X.cFi(oa,ha));for(let sa=0;sa<this.kWd.length;sa++){const oa=this.kWd[sa].classId;Y.runtime.bib.Z(oa,new h.a);ca.ub(oa)&&ca.J(oa).forEach(ka=>{var ia=
Y.runtime.lk.J(ka.id);ia&&(ia=new K(ia,ka,Y.runtime.nq.Py(ka.id,ia)),Y.runtime.bib.J(oa).add(ka.id,ia),ra.add(ka.id));return!0});ha.ub(oa)&&ha.J(oa).forEach(ka=>{if(ra.contains(ka.id))return!0;const ia=Y.runtime.lk.J(ka.id);ia&&Y.runtime.bib.J(oa).add(ka.id,new K(ia,ia,ka));return!0})}Y.runtime.hG("PrepareObjectGroupings");Y.logger.Mfa("PrepareObjectGroupings");return!0}C6m(Y){let ca=!0;for(let ha=0;ca&&ha<this.kWd.length;ha++){const ra=this.kWd[ha];Y.runtime.hG("Before function#"+ha);const sa=ra.classId;
Y.runtime.bib.J(sa).forEach((oa,ka)=>{Y.runtime.eKa.contains(ka.bE.id)||(ca=ra.ggo(Y,ka)&&ca);ca||(a.a.instance.Sa(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",sa,ka.bE.id),Y.logger.Tg(Object.assign(new A,{kj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ca});Y.runtime.hG("PerformThreewayChildMerge"+ha)}Y.logger.Mfa("PerformThreewayChildMerge");return ca}c3m(Y,ca){if(ca.i1d(l.a.$e)){var ha=this.$d.getPropertyObjectIds(ca.bE,l.a.$e);const ra=this.$d.getPropertyObjectIds(ca.k6,
l.a.$e);ca=this.$d.getPropertyObjectIds(ca.Voa,l.a.$e);ha=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ha.length,ra.length,ca.length,Y.input.source);a.a.instance.Sa(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ha);Y.logger.Tg(Object.assign(new A,{kj:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:ha}));return!1}return!0}Bxo(Y,ca){if(ca.i1d(l.a.$e)){const La=new m.a,va=new m.a,Ga=new m.a,Oa=
new m.a;var ha=this.$d.getPropertyObjectIds(ca.bE,l.a.$e),ra=ha.iG(),sa,oa=({Oth:sa}=this.nmj(ca.k6,ra,La,"Favored")).returnValue,ka=({Oth:ia}=this.nmj(ca.Voa,ra,va,"Unfavored")).returnValue;if(!oa||!ka)return ha=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ra.count,La.count,va.count,sa,ia),Y.logger.Tg(Object.assign(new A,{kj:"WordSectionNodeThreewayChildMerge",
info:ha})),!1;ha.forEach(Za=>{La.contains(Za)||Ga.add(Za);va.contains(Za)||Oa.add(Za);return!0});ca=ca.bE.OG();ra=new v.a;for(sa=0;sa<ha.length;sa++){var ia=ha.mg(sa);if(Ga.contains(ia)||Oa.contains(ia)){if(Y.runtime.eKa.add(ia),ra.length&&(oa=ra.mg(ra.length-1),oa=Y.runtime.bib.J(393241).J(oa),ka=Y.runtime.bib.J(393241).J(ia),oa&&ka))Ga.contains(ia)?Oa.contains(ia)||(oa.bE=oa.bE.OG(),oa.Voa=oa.Voa.OG(),this.Srd(oa.bE,ka.bE),this.Srd(oa.Voa,ka.Voa)):(oa.bE=oa.bE.OG(),oa.k6=oa.k6.OG(),this.Srd(oa.bE,
ka.bE),this.Srd(oa.k6,ka.k6))}else ra.add(ia)}this.$d.setPropertyObjectIds(ca,l.a.$e,ra);ha=new P.a(ca);ha.sB(l.a.$e);Y.runtime.Um.Z(ca.id,ha)}return!0}Srd(Y,ca){const ha=this.$d.getPropertyObjectIds(Y,l.a.$e);ca=this.$d.getPropertyObjectIds(ca,l.a.$e);const ra=ha.L3();ca.forEach(sa=>{ra.add(sa);return!0});this.$d.setPropertyObjectIds(Y,l.a.$e,ra)}nmj(Y,ca,ha,ra){let sa=0,oa=!0;this.$d.getPropertyObjectIds(Y,l.a.$e).forEach(ka=>{ca.contains(ka)?ha.add(ka):(oa=!1,a.a.instance.Sa(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",
ra,ka),sa++);return!0});return{returnValue:oa,Oth:sa}}fVl(Y){let ca=!0;Y.runtime.bib.J(393241).forEach((ha,ra)=>{if(this.fhm(ra)){a.a.instance.Sa(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ra.bE.id);let sa;const oa=new G(Y,this.$d,this.Pwa);if(({vDi:ha,Tnj:sa}=this.Eeo(Y,oa.vFl(),ra)).returnValue)return a.a.instance.Sa(4220303,1,4,"Merging WordSection {0} as a unit.",sa),ca=oa.success&&this.hKm(Y,sa,ha)&&ca,ca||(a.a.instance.Sa(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ra.bE.id,oa.success),Y.logger.Tg(Object.assign(new A,{kj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",oa.success)}))),ca}return!0});return ca}fhm(Y){if(!Y.i1d(l.a.$e))return!1;const ca=this.$d.getPropertyObjectIds(Y.bE,l.a.$e).J(0),ha=this.$d.getPropertyObjectIds(Y.k6,l.a.$e);Y=this.$d.getPropertyObjectIds(Y.Voa,l.a.$e);return!ha.contains(ca,(ra,sa)=>ra.equals(sa))||!Y.contains(ca,(ra,sa)=>ra.equals(sa))}Eeo(Y,ca,ha){ca=
ca.J(ha.bE.id);a.a.instance.Sa(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ha.bE.id,ca);if(Y.runtime.eKa.contains(ca))return a.a.instance.Sa(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",ca),{returnValue:!1,vDi:null,Tnj:ca};const ra=new N.a;ha=Y.runtime.lk.J(ca);this.$d.getPropertyObjectIds(ha,l.a.$e).forEach(sa=>
{ra.Rrd(sa);return!0});ha=this.Pwa.omb(ca,Y.runtime.du,Y.runtime.lk);this.$d.getPropertyObjectIds(ha,l.a.$e).forEach(sa=>{ra.Urd(sa);return!0});Y=this.Pwa.omb(ca,Y.runtime.nq,Y.runtime.lk);this.$d.getPropertyObjectIds(Y,l.a.$e).forEach(sa=>{ra.Zrd(sa);return!0});return{returnValue:!0,vDi:ra,Tnj:ca}}kNf(Y,ca,ha,ra,sa){let oa=!0;Y.forEach(ka=>{const ia=ca(ka);this.$d.getPropertyObjectIds(ia,l.a.$e).forEach(La=>{ha.add(La);if(ra.ub(La))return(oa=ra.J(La).equals(ka)&&oa)||a.a.instance.Sa(4273300,1,2,
"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",sa,La,ka,ra.J(La)),oa;ra.Z(La,ka);return!0});return!0});return oa}KDl(Y,ca){let ha,ra,sa,oa;ha=new v.a;ra=new v.a;sa=new v.a;oa=new h.a;const ka=Y.runtime.lk;return this.kNf(ca.hwb,ia=>ka.J(ia),ha,oa,"Base")&&this.kNf(ca.c9e,ia=>this.Pwa.omb(ia,Y.runtime.du,ka),ra,oa,"Favored")&&this.kNf(ca.tmb,ia=>this.Pwa.omb(ia,Y.runtime.nq,ka),sa,oa,"Unfavored")?{returnValue:!0,zgh:ha,QHh:ra,zgj:sa,
swi:oa}:{returnValue:!1,zgh:ha,QHh:ra,zgj:sa,swi:oa}}Abl(Y,ca,ha,ra){let sa=!0;const oa=Y.runtime.lk,ka=Y.runtime.du,ia=Y.runtime.nq,La=Y.runtime.Um,va=new v.a,Ga=new h.a;ha.forEach(Oa=>{const Za=ra.J(Oa);if(!Za)return a.a.instance.Sa(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Oa),Y.logger.Tg(Object.assign(new A,{kj:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),sa=!1;Za.equals(va.last())||(va.add(Za),Ga.add(Za,new v.a));Ga.J(Za).add(Oa);Y.runtime.eKa.add(Oa);
return!0});if(!sa)return!1;Ga.forEach((Oa,Za)=>{const ja=this.Pwa.dfj(Oa,ka,ia,oa).OG();this.$d.setPropertyObjectIds(ja,l.a.$e,Za);La.Z(Oa,new P.a(ja));La.J(Oa).sB(l.a.$e);Y.runtime.eKa.add(Oa);return sa});ha=this.Pwa.dfj(ca,ka,ia,oa).OG();this.$d.setPropertyObjectIds(ha,l.a.$e,va);La.Z(ca,new P.a(ha));La.J(ca).sB(l.a.$e);Y.runtime.eKa.add(ca);return sa}hKm(Y,ca,ha){let ra,sa;if(!({zgh:oa,QHh:ra,zgj:sa,swi:ha}=this.KDl(Y,ha)).returnValue)return!1;var oa=E.b(oa,ra,sa);oa=this.dKf(Y,oa);return!!oa&&
this.Abl(Y,ca,oa,ha)}OZd(Y,ca){return this.qDi(Y,ca)}qDi(Y,ca){if(ca.i1d(l.a.$e)){var ha=this.HDl(ca);ha=this.dKf(Y,ha);if(!ha)return a.a.instance.Sa(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.bE.id),Y.logger.Tg(Object.assign(new A,{kj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),M.a(ca.bE,"OutlineElementContainerThreewayChildMerge_Base",1),
M.a(ca.k6,"OutlineElementContainerThreewayChildMerge_Favored",1),M.a(ca.Voa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ra=this.$d.getPropertyObjectIds(ca.bE,l.a.$e);const sa=ha.iG();ra.forEach(oa=>{sa.contains(oa)||(oa=this.$d.getPropertyObjectIds(ca.bE,l.a.gI),0<oa.length&&Y.runtime.JKf.add(oa.J(0)));return!0});ra=ca.k6.OG();this.$d.setPropertyObjectIds(ra,l.a.$e,ha);Y.runtime.Um.Z(ra.id,new P.a(ra));Y.runtime.Um.J(ra.id).sB(l.a.$e)}return!0}sEb(Y){if(!Y)return a.a.instance.Sa(573957964,
1,2,"Feature helper is null"),!1;Y.Lt(112);return Y.isFeatureEnabled(112)}m8n(Y,ca){if(!this.sEb(Y.runtime.Wb))return this.D4f(Y,ca);var ha=ca.bE.id,ra=W.e(Y,ca.bE,null);if(ra.equals(u.a.nil))return a.a.instance.Sa(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ha),Y.logger.Tg(Object.assign(new S.a,{info:"Table node ID could not be found for table cell"})),!1;var sa=Y.runtime.nxb.J(ra);if(sa&&(sa=sa.J(ha)))if(sa.gg)ca=ca.k6.OG(),ca.removeProperty(l.a.$e),this.$d.setPropertyBool(ca,
e.a.ghostCell,!0),null!=sa.colSpan?this.$d.setPropertyUint32(ca,e.a.colSpan,sa.colSpan):ca.removeProperty(e.a.colSpan),Y.runtime.Um.Z(ca.id,new P.a(ca)),Y.runtime.Um.J(ca.id).sB(l.a.$e),Y.runtime.Um.J(ca.id).sB(e.a.ghostCell),Y.runtime.Um.J(ca.id).sB(e.a.colSpan);else{let oa,ka;({Hsd:ra,jCd:oa,Bce:ka}=this.Ozl(Y,ca,sa,ra));if(!oa.length&&!ka.length)return a.a.instance.Sa(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ha),Y.logger.Tg(Object.assign(new S.a,
{info:"A non-ghost cell does not have OE nodes on either side"})),!1;oa.length?ka.length?(ha=E.b(ra,oa,ka),ha=this.dKf(Y,ha)):ha=oa:ha=ka;if(!ha)return a.a.instance.Sa(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.bE.id),Y.logger.Tg(Object.assign(new A,{kj:"TableCellThreewayChildMergev2",eventId:"8n426"})),M.a(ca.bE,"TableCellThreewayChildMergev2_Base",1),M.a(ca.k6,"TableCellThreewayChildMergev2_Favored",
1),M.a(ca.Voa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ca=ca.k6.OG();this.$d.setPropertyObjectIds(ca,l.a.$e,ha);ca.removeProperty(e.a.ghostCell);ha=sa.rowSpan;sa=sa.colSpan;null!=ha&&null!=sa&&(1<ha||1<sa)?(this.$d.setPropertyUint32(ca,e.a.rowSpan,ha),this.$d.setPropertyUint32(ca,e.a.colSpan,sa)):(ca.removeProperty(e.a.rowSpan),ca.removeProperty(e.a.colSpan));Y.runtime.Um.Z(ca.id,new P.a(ca));Y.runtime.Um.J(ca.id).sB(l.a.$e);Y.runtime.Um.J(ca.id).sB(e.a.ghostCell);Y.runtime.Um.J(ca.id).sB(e.a.rowSpan);
Y.runtime.Um.J(ca.id).sB(e.a.colSpan)}else return this.D4f(Y,ca);Y.logger.Mfa("TableCellThreewayChildMergev2");return!0}Ozl(Y,ca,ha,ra){let sa,oa;({Hsd:ca,jCd:sa,Bce:oa}=this.tRh(ca));ca||(ca=new v.a);sa||(sa=new v.a);oa||(oa=new v.a);var ka=ca.iG(),ia=sa.iG(),La=oa.iG(),va=ha.KWd;if(va)for(var Ga=0;Ga<va.length;Ga++){var Oa=va.J(Ga),Za=Y.runtime.lk.J(Oa);!ka.contains(Oa)&&Za&&(ka.add(Oa),ca.add(Oa));!ia.contains(Oa)&&Y.runtime.du.Py(Oa,Za)&&(ia.add(Oa),sa.add(Oa));!La.contains(Oa)&&Y.runtime.nq.Py(Oa,
Za)&&(La.add(Oa),oa.add(Oa))}Y.logger.Mfa("OENodesAddedToChildrenList");if(va=ha.Wjf)for(Ga=0;Ga<va.length;Ga++)if(Oa=va.J(Ga),Za=Y.runtime.lk.J(Oa)){var ja=this.$d.getPropertyObjectIds(Za,l.a.$e);if(ja)for(var ba=0;ba<ja.length;ba++){var qa=ja.J(ba);ka.contains(qa)||(ka.add(qa),ca.add(qa))}ja=Y.runtime.du.Py(Oa,Za);if(ja=this.$d.getPropertyObjectIds(ja,l.a.$e))for(ba=0;ba<ja.length;ba++)qa=ja.J(ba),ia.contains(qa)||(ia.add(qa),sa.add(qa));Oa=Y.runtime.nq.Py(Oa,Za);if(Oa=this.$d.getPropertyObjectIds(Oa,
l.a.$e))for(Za=0;Za<Oa.length;Za++)ja=Oa.J(Za),La.contains(ja)||(La.add(ja),oa.add(ja))}Y.logger.Mfa("GhostCellOENodesAddedToChildrenList");if(ha=ha.AEf)for(ka=0;ka<ha.length;ka++)if(ia=ha.J(ka),ia=Y.runtime.nxb.J(ra).J(ia))if(ia=ia.KWd){ia=ia.iG();La=new v.a;for(va=0;va<ca.length;va++)ia.contains(ca.J(va))||La.add(ca.J(va));ca=La;La=new v.a;for(va=0;va<sa.length;va++)ia.contains(sa.J(va))||La.add(sa.J(va));sa=La;La=new v.a;for(va=0;va<oa.length;va++)ia.contains(oa.J(va))||La.add(oa.J(va));oa=La}Y.logger.Mfa("NonGhostCellsOENodesRemovedFromChildrenList");
return{Hsd:ca,jCd:sa,Bce:oa}}D4f(Y,ca){let ha=ca.k6.hasProperty(l.a.$e),ra=ca.Voa.hasProperty(l.a.$e);ha&&(ha=!!this.$d.getPropertyObjectIds(ca.k6,l.a.$e).length);ra&&(ra=!!this.$d.getPropertyObjectIds(ca.Voa,l.a.$e).length);if(ha!==ra)if(this.Bnm(Y.runtime.Wb))Y.logger.wni(Object.assign(new S.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return Y.logger.Tg(Object.assign(new S.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.qDi(Y,ca)}HDl(Y){let ca,
ha;({Hsd:Y,jCd:ca,Bce:ha}=this.tRh(Y));return E.b(Y,ca,ha)}dKf(Y,ca){a.a.instance.Sa(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ca.length);const ha=new v.a;let ra=!0;ca.forEach(sa=>{if(!sa)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),Y.logger.Tg(Object.assign(new A,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ra=!1;if(1===sa.WKm&&1===sa.Wzf){const ja=sa.hwb.J(0),ba=sa.c9e.J(0),qa=sa.tmb.J(0);if(ja&&ja.equals(ba)&&ja.equals(qa))return ha.add(ja),
!0;if(1!==ca.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ja,ba,qa,ca.length),Y.logger.Tg(Object.assign(new A,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ra=!1}const oa=new h.a,ka=new v.a,ia=new v.a,La=new v.a,va=new v.a,Ga=new v.a,Oa=new v.a,Za=Y.runtime.lk;sa.hwb.forEach(ja=>ra=this.bOf(Y,
ja,ba=>Za.J(ba),ka,va,oa,"Base"));if(!ra)return a.a.instance.Sa(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),Y.logger.Tg(Object.assign(new A,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;sa.c9e.forEach(ja=>ra=this.bOf(Y,ja,ba=>this.Pwa.omb(ba,Y.runtime.du,Za),ia,Ga,oa,"Favored"));if(!ra)return a.a.instance.Sa(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),Y.logger.Tg(Object.assign(new A,
{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;sa.tmb.forEach(ja=>ra=this.bOf(Y,ja,ba=>this.Pwa.omb(ba,Y.runtime.nq,Za),La,Oa,oa,"Unfavored"));if(!ra)return a.a.instance.Sa(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),Y.logger.Tg(Object.assign(new A,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;Y.runtime.Wb&&Y.runtime.Wb.NBb(1000005)&&(Ga.length&&this.J8k(Ga,Y.runtime.du)?(this.I$g(Ga,Y,ha,oa),
this.drd(Y,oa,Oa)):this.I$g(Oa,Y,ha,oa));if(ka.length){sa=null;if(!({Um:sa}=this.p4m(Y,ka,ia,La,sa)).returnValue||!sa)return ra=!1;sa.forEach(ja=>{0<ja.hWb.count&&Y.runtime.Um.Z(ja.gm.id,ja);ha.add(oa.J(ja.gm.id));return!0})}return!0});return ra?ha:null}J8k(Y,ca){for(let ha=0;ha<Y.length;ha++)if(ca.get(Y.mg(ha).id))return!0;return!1}drd(Y,ca,ha){ha.length&&(ha.forEach(ra=>{Y.runtime.ufc.add(ra.id);Y.runtime.ufc.add(ca.J(ra.id));return!0}),L.a.drd(Y,this.$d,ha.J(0)))}I$g(Y,ca,ha,ra){Y.forEach(sa=>
{const oa=new P.a(sa.OG());ca.runtime.Um.Z(sa.id,oa);ha.add(ra.J(sa.id));return!0})}bOf(Y,ca,ha,ra,sa,oa,ka){var ia=ha(ca);if(!ia)return a.a.instance.Sa(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ka,ca),Y.logger.Tg(Object.assign(new A,{kj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",ka)})),!1;const La=this.$d.getPropertyObjectIds(ia,l.a.gI);if(!La||!La.length)return a.a.instance.Sa(4285058,1,1,
"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ka,ca),Y.logger.Tg(Object.assign(new A,{kj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ka)})),M.a(ia,"ProcessOutlineElement_"+ka,1),!1;ia=La.mg(0);ha=ha(ia);if(!ha)return a.a.instance.Sa(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ka,ia,ca),Y.logger.Tg(Object.assign(new A,{kj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ka)})),!1;if((ka=this.$d.getPropertyString(ha,e.a.AM))&&""!==ka&&Y.runtime.Wb&&(Y.runtime.Wb.jkf(1000005),Y.runtime.Wb.NBb(1000005)))return sa.add(ha),oa.add(ia,ca),Y.runtime.eKa.add(ia),!0;ra.add(ha);oa.add(ia,ca);Y.runtime.eKa.add(ia);return!0}tRh(Y){let ca,ha;ca=this.$d.getPropertyObjectIds(Y.bE,l.a.$e);ha=this.$d.getPropertyObjectIds(Y.k6,l.a.$e);Y=this.$d.getPropertyObjectIds(Y.Voa,l.a.$e);
return{Hsd:ca,jCd:ha,Bce:Y}}Bnm(Y){if(!Y)return a.a.instance.Sa(51422868,1,2,"Feature Helper is null"),!1;Y.Lt(111);return Y.isFeatureEnabled(111)}static cFi(Y,ca){ca.ub(Y.Qc)||ca.Z(Y.Qc,new v.a);ca.J(Y.Qc).add(Y);return!0}}X.XZd=u.a.Pf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(C.a)(X,"ChildNodeListMerge",null,[1866])},1681:function(C,O,c){C=c(0);var l=c(1451),e=c(1560),a=c(1495),h=c(1470),m=c(1510);class v{constructor(Y,ca){this.DimensionValue=this.DimensionName=null;this.DimensionName=
Y;this.DimensionValue=ca}}Object(C.a)(v,"Dimension",null,[]);class u{constructor(Y,ca,ha,ra,sa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Y;this.Query=ca;this.From=ha;this.Size=ra;sa&&(this.Filter=sa)}}Object(C.a)(u,"EntityRequest",null,[]);class n{constructor(Y){this.QueryString=null;this.QueryString=Y}}Object(C.a)(n,"Query",null,[]);var x=c(1452);class A{constructor(Y,ca){this.Dimensions=this.Name=null;this.Name=Y;this.Dimensions=ca}}Object(C.a)(A,"Scenario",
null,[]);var H=c(1456),E=c(1455);class L{constructor(Y,ca,ha,ra){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Y;this.TimeZone=ca;this.Cvid=ha;this.Scenario=ra}}Object(C.a)(L,"SubstrateBody",null,[]);var M=c(1509),F=c(1449),J=c(1447),I=c(2),K=c(1623),N=c(1622),G=c(1506),P=c(36),S=c(17),W=c(121);c.d(O,"a",function(){return X});class X{constructor(Y){this.Ysc=this.P9a=this.Pgd=this.Inc=this.Ktc=0;this.mTg=this.aXg=this.eP=null;this.nrb=0;this.E0=-1;this.twc="";this.rg=
I.AFrameworkApplication.af;this.qc=Y;this.$md=this.Bif();this.yGe=new e.a;this.zRg=this.qc.Pbe?3:2;this.S3g=this.qc.Pbe&&this.qc.A6i?5:3;this.u7g=this.qc.y8d?2:3;this.v7g=1;this.Vfd=this.qc.BWh;this.k2g=this.qc.Nmm;this.Juc=Y.F_h;I.AFrameworkApplication.K&&(this.aXg=I.AFrameworkApplication.K.lb("AppCatalogUrl")+I.AFrameworkApplication.K.lb("SearchPersonaPhotoBaseUrl"))}IL(){return"Substrate"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:3}MI(Y,ca,ha,ra=l.a.tellMe,sa=null){const oa=new E.a(Y);if(!sa||
Array.contains(sa,14)||Array.contains(sa,15)||Array.contains(sa,20))if(!this.nrb||window.performance.now()-this.nrb>=J.a.ybe)if(ha=this.yGe.i0h())this.nrb=window.performance.now(),ha.then(ka=>{ka&&""!==ka?(this.twc=ka,""!==this.eP&&this.h0h(Y,ra,this.twc,ca,sa)):(F.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ca.resultsUpdated(oa))},ka=>{F.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+
ka);ca.resultsUpdated(oa)});else{if(F.TellMeActor.instance.Xe)F.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ca.resultsUpdated(oa)}else this.twc&&""!==this.twc?this.h0h(Y,ra,this.twc,ca,sa):(ca.resultsUpdated(oa),F.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ca.resultsUpdated(oa)}Ncc(){this.P9a=this.Ysc=this.Pgd=this.Inc=this.Ktc=0}h0h(Y,ca,ha,ra,sa){this.Ncc();const oa=new E.a(Y),ka=this.eP=
W.a.create().toString();this.Xza();this.E0=window.setTimeout(()=>{if(ka===this.eP){this.eP="";this.E0=-1;ra.resultsUpdated(oa);const va={};va[a.a.provider]=this.IL();va[a.a.pIb]=Y.zjb;F.TellMeActor.instance.Xe.Yz(h.a.timedOut,this.Juc,va)}},this.Juc);const ia={"Content-Type":"application/json",Accept:"application/json"};ia.Authorization="Bearer "+ha;ia["X-Office-Version"]=I.AFrameworkApplication.buildVersion;ia["X-Office-Application"]=I.AFrameworkApplication.K.lb("Application");ia["X-Office-Platform"]=
"WAC";ia["X-TellMe-SessionId"]=F.TellMeActor.instance.JId();ia["X-TellMe-Culture"]=I.AFrameworkApplication.uiCulture;ia["X-TellMe-ProcessSessionId"]=I.AFrameworkApplication.userSessionId;ia["Client-Request-Id"]=ka;const La=window.performance.now();this.rg.Mj(this.lMl(),2,this.mMl(Y.Ig,this.qc.application,F.TellMeActor.instance.JId(),J.a.YW(Y)),ia,!1,0,va=>{this.eHb(va,Y,ra,ka,La,ca,sa)},va=>{this.RGb(va,Y,ra,ka,La)},null,null,!1,4E3,6E3)}Xza(){-1!==this.E0&&(window.clearTimeout(this.E0),this.E0=-1)}eHb(Y,
ca,ha,ra,sa,oa,ka){F.TellMeActor.instance.Xe.l7(ca.Ig.length,this.$md.join(","),Y.data.Df.toString(),Math.round(window.performance.now()-sa),M.a.substrate,!0,m.a.vMa);const ia=J.a.YW(ca),La=new E.a(ca);if(ra===this.eP){this.Xza();Y=P.b(Y.data.Ie);if(Y.Groups){Y=Y.Groups;for(const va of Y)"People"===va.Type&&this.qc.e2c&&(ka?Array.contains(ka,14):1)?(Y=this.MXh(va.Suggestions,ia,oa),0<Y.results.length&&La.kw(Y)):"File"===va.Type&&this.qc.c2c&&(ka?Array.contains(ka,15):1)?(Y=this.WRh(va.Suggestions,
ia,oa),0<Y.results.length&&La.kw(Y)):"Notes"===va.Type&&this.qc.Sgb&&oa!==l.a.contextMenu&&(ka?Array.contains(ka,20):1)&&(Y=this.wWh(va.Suggestions,ia,ca),0<Y.results.length&&La.kw(Y))}ha.resultsUpdated(La);F.TellMeActor.instance.Xe.l7(ca.Ig.length,this.$md.join(","),"",Math.round(window.performance.now()-sa),"",!0,m.a.provider)}else ha.resultsUpdated(La)}wWh(Y,ca,ha){const ra=new H.a(20);ra.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const sa of Y)this.hpm(sa)&&(Y=sa.NotesType,Y=S.a.mh(Y),
Y=this.PCl(Y,sa.LastModifiedTime,sa.BodyPreview,sa.Subject,ca,ha,sa))&&(Y.groupType=20,ra.Ez(Y));return ra}MXh(Y,ca,ha){const ra=new H.a(14);ra.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const oa of Y)if(this.ipm(oa)){var sa=oa.Id.split("@")[0];Y=oa.EmailAddresses[0];let ka=oa.Type;if(void 0===ka||null===ka)ka="User";if(sa=this.IFl(ka,oa.DisplayName,oa.JobTitle,Y,sa,ha,ca))sa.description=Y,Y=oa.JobTitle,"Department"in oa&&"CompanyName"in oa&&(Y+="@"+oa.Department+"@"+oa.CompanyName),
sa.ZH=Y,ra.Ez(sa)}return ra}WRh(Y,ca,ha){const ra=new H.a(15);ra.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ka of Y)if(this.Yom(ka)){var sa=ka.FileName;Y=ka.FileExtension;const ia=sa.length>Y.length?sa.substr(0,sa.length-Y.length-1):ka.Title;var oa=void 0;Y=0;"DateCreated"in ka?(Y=J.a.jjf(ka.DateCreated),oa=J.a.x1h(ka.DateCreated),oa=String.format(CommonUIStrings.l_CreatedTimeFormatString,ka.Author,oa)):oa=ka.Author;const La=ka.AccessUrl+"?web=1",va=S.a.xLc(La);sa=String.format('<a href="{0}">{1}</a>',
va,S.a.GZ(sa));if(ha!==l.a.contextMenu||S.a.$W(La))if(sa=this.xtl(ia,ha===l.a.contextMenu?sa:La,oa,ka.FileExtension,ka.Text,ca))sa.description=ka.Author,sa.Drd=Y,ra.Ez(sa)}return ra}RGb(Y,ca,ha,ra,sa){ra===this.eP&&(this.Xza(),F.TellMeActor.instance.Xe.l7(ca.Ig.length,this.$md.join(","),Y.data.Df.toString(),Math.round(window.performance.now()-sa),M.a.substrate,!1,m.a.vMa));Y=new E.a(ca);ha.resultsUpdated(Y)}IFl(Y,ca,ha,ra,sa,oa,ka){ka=ka?this.v7g:this.zRg;if(!window.LPC&&!J.a.zqf()||this.Ktc===ka)return null;
this.Ktc+=1;ka="PeopleSuggestion"+this.Ktc.toString();var ia=this.aXg+"?size=1&accountName="+ra;Y=Object.assign(new K.a,{PersonaType:Y,Smtp:ra,ProfilePictureUrl:ia,AadObjectId:sa});const La=Object.assign(new N.a,{identifiers:Y,displayName:ca});Y=oa===l.a.contextMenu;this.qc.KBa?(F.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(ka,La,ca,ha)),oa===l.a.contextMenu&&(ha=J.a.Ewh(ca,ra,sa),F.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ka,ha))),
F.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ka,Y))):(ia=[],ia.push(appChrome.actions.setPersonaButtonCoauthor(ka,La,ca,ha)),oa===l.a.contextMenu&&(ha=J.a.Ewh(ca,ra,sa),ia.push(appChrome.actions.setButtonCommandValueId(ka,ha))),ia.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ka,Y)),appChrome.api.dispatch(ia));return new x.a(ka,11,ca,ra,0)}PCl(Y,ca,ha,ra,sa,oa,ka){if(sa&&!this.qc.Bji||this.Pgd===this.Vfd||this.Ysc===this.Vfd||
this.P9a===this.Vfd)return null;var ia=null;this.Pgd+=1;sa="";const La=[],va={};ka.type="Notes";this.mTg=Object.assign(new G.a,{landingTab:"Notes",data:ka});oa=J.a.bXa(oa.Ig,33,this.mTg);if("onenotepagepreviews"===Y){if(!("ClickthroughUrl"in ka&&ka.ClickthroughUrl)||""===ka.ClickthroughUrl)return null;this.Ysc+=1;sa="OnenoteNotesSuggestion"+this.Ysc.toString();va["default"]="SaveAsonetoc2_20";ia=ka.ClickthroughUrl;La.push(appChrome.actions.setControlIconSet(sa,va));La.push(appChrome.actions.setCompoundButtonCommandValueId(sa,
ia));ia=new x.a(sa,19,null,null,0)}else if("stickynote"===Y){if(!this.k2g)return null;this.P9a+=1;sa="NotesSuggestion"+this.P9a.toString();va["default"]="ShowAllNotes_20";La.push(appChrome.actions.setControlIconSet(sa,va));La.push(appChrome.actions.setCompoundButtonCommandValueId(sa,oa));ia=new x.a(sa,21,null,null,0)}else if("samsung"===Y){if(!this.k2g)return null;this.P9a+=1;sa="NotesSuggestion"+this.P9a.toString();va["default"]="CategoryCollapsed_20";La.push(appChrome.actions.setControlIconSet(sa,
va));La.push(appChrome.actions.setCompoundButtonCommandValueId(sa,oa));ia=new x.a(sa,20,null,null,0)}""!==sa&&(Y=J.a.x1h(ca),Y=String.format(CommonUIStrings.l_LastModifiedString,Y),ia.label=ra,ia.Drd=J.a.jjf(ca),La.push(appChrome.actions.setControlLabel(sa,ra)),La.push(appChrome.actions.updateCompoundButtonDescription(sa,Y)),La.push(appChrome.actions.setControlCustomTooltip(sa,ha)),appChrome.api.dispatch(La));return ia}xtl(Y,ca,ha,ra,sa,oa){if(this.Inc===(oa?this.u7g:this.S3g))return null;this.Inc+=
1;oa="FileSuggestion"+this.Inc.toString();const ka=[],ia={};ia["default"]=J.a.Fwl(ra);this.qc.KBa?(F.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(oa,Y)),F.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(oa,ia)),F.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(oa,ha)),F.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(oa,ca)),F.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(oa,
sa))):(ka.push(appChrome.actions.setControlLabel(oa,Y)),ka.push(appChrome.actions.setControlIconSet(oa,ia)),ka.push(appChrome.actions.updateCompoundButtonDescription(oa,ha)),ka.push(appChrome.actions.setCompoundButtonCommandValueId(oa,ca)),ka.push(appChrome.actions.setControlCustomTooltip(oa,sa)),appChrome.api.dispatch(ka));return new x.a(oa,6,Y,ha,0)}Bif(){const Y=[];this.qc.e2c&&Array.add(Y,"People");this.qc.c2c&&Array.add(Y,"File");this.qc.Sgb&&Array.add(Y,"Notes");return Y}mMl(Y,ca,ha,ra){var sa=
new n(Y);Y=new u("File",sa,0,ra?this.u7g:this.S3g,null);ra=new u("People",sa,0,ra?this.v7g:this.zRg,J.a.m6m);sa=new u("Notes",sa,0,this.Vfd,null);ca=new v("app",ca.toLowerCase());var oa=[];Array.add(oa,ca);ca=new A("tellmesearch",oa);oa=[];this.qc.c2c&&Array.add(oa,Y);this.qc.e2c&&Array.add(oa,ra);this.qc.Sgb&&Array.add(oa,sa);ha=new L(oa,"UTC",ha,ca);return P.c(ha)}lMl(){let Y=this.qc.z6n;this.qc.Sgb&&(Y+="?&setflight=NotesFrom3S");""!==this.qc.j0h&&(Y=Y+"&"+this.qc.j0h);return Y}ipm(Y){return"DisplayName"in
Y&&"Id"in Y&&"EmailAddresses"in Y&&!!Y.Id&&!!Y.EmailAddresses}Yom(Y){return"FileExtension"in Y&&!!Y.FileExtension&&"FileName"in Y&&!!Y.FileName&&""!==Y.FileName&&"AccessUrl"in Y&&!!Y.AccessUrl&&""!==Y.AccessUrl}hpm(Y){return"Id"in Y&&!!Y.Id&&"NotesType"in Y&&!!Y.NotesType&&"Subject"in Y&&!!Y.Subject&&""!==Y.Subject}}Object(C.a)(X,"SubstrateResultsProvider",null,[1143])},1682:function(C,O,c){C=c(0);var l=c(46),e=c(5),a=c(16),h=c(149),m=c(83),v=c(151),u=c(216),n=c(619),x=c(59),A=c(386),H=c(2),E=c(1407),
L=c(754);class M{constructor(ka,ia=0){this.p0e=null;this.oLf=0;this.bM=ka;this.OJm=ia}}Object(C.a)(M,"GraphMergerResponse",null,[]);var F=c(44),J=c(1),I=c(160),K=c(710),N=c(1483),G=c(1526);class P extends G.a{constructor(){super();this.V8i=null;this.enj=!1}get xea(){return"Crash"}EAb(){this.detail.Z("Type",this.xea);this.detail.Z("Trace",this.ceo(this.V8i));this.detail.Z("Continue",this.enj);return this.detail}ceo(ka){ka=ka.split("\n");const ia=4<ka.length?4:ka.length,La=new Sys.StringBuilder;for(let va=
0;va<ia;va++)va===ia-1?La.append(String.format("{0}...",ka[va])):La.append(String.format("{0}\n",ka[va]));return La.toString()}}Object(C.a)(P,"CrashMergeFailureDetail",G.a,[]);var S=c(1824),W=c(1498),X=c(1575),Y=c(1484);class ca{constructor(){this.Gkk=new A.a;this.ECk=new A.a;this.QFk=new A.a}}Object(C.a)(ca,"RangeMarkers",null,[]);class ha{constructor(){this.colSpan=this.rowSpan=null;this.gg=!1;this.kre=new u.a;this.qAe=new u.a;this.JAe=new u.a}get Wjf(){return this.kre.L3()}set Wjf(ka){ka||(this.kre=
new u.a);this.kre=ka.L3()}get AEf(){return this.qAe.L3()}set AEf(ka){ka||(this.qAe=new u.a);this.qAe=ka.L3()}get KWd(){return this.JAe.L3()}set KWd(ka){ka||(this.JAe=new u.a);this.JAe=ka.L3()}}Object(C.a)(ha,"TableCellStructureInfo",null,[]);var ra=c(1529),sa=c(1567);c.d(O,"a",function(){return oa});class oa{constructor(){this.uJd=0;this.NHg=this.B7a=this.YSb=this.Pg=this.XZg=this.wUb=null;this.xRg=0;this.lOg=50;this.oFg=this.ezg=null}get pUi(){return this.wUb}get KBn(){return this.XZg}get $d(){return this.Pg}get Lhb(){return this.YSb}get D3h(){return this.B7a}get MSl(){return this.NHg}get K9b(){return this.xRg}get Cnh(){return this.ezg}get cGc(){return this.oFg}Q9b(ka,
ia,La,va,Ga,Oa,Za){La=this.VMk(ka,ia,va,Ga,Oa,Za,this.cGc);va=0;const ja=La.runtime.C8d;let ba=null;try{this.iBm(ja,La,Za,ka,ia,Ga,Oa);for(ka=1;va<this.Lhb.length;va++)if(!(0,this.Lhb[va])(La)){ka=2;La.logger.OTd("GraphMerger.GetMergeFunctions()",va);break}return ba=new M(La.output.bM,ka)}catch(qa){const Ma=!La.output.timeout;La.output.crash=Ma;const Ia=this.IFd(qa),wa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ma?"Crashed":"Timed Out",La.input.XFb,!!La.output.bM,
Ia);Ma?(h.a.instance.Sa(4051608,1,1,"MergeChanges Crash. [Error: {0}]",wa),La.logger.Tg(Object.assign(new P,{V8i:Ia,enj:!!La.output.bM}))):h.a.instance.Sa(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",wa);if(La.output.bM)return ba=new M(La.output.bM,2);throw qa;}finally{La.output.succeeded?this.fBm(ja,La,va):La.output.timeout?this.hBm(La,va):La.output.crash?La.output.bM?this.gBm(La,va):this.eBm(La,va):this.dBm(La,va);La.logger.cBm();h.a.instance.Aha(42350232,1,La.output.succeeded?4:2,"MergeLogger",
La.logger.OAl());La.logger.MRc.p5h()&&h.a.instance.Aha(559015903,1,2,"MarkerInfo",La.logger.MRc.toString());if(La.runtime.Wb&&La.runtime.Wb.isFeatureEnabled(76))try{this.Uxm(La)}catch(qa){h.a.instance.Sa(571619421,1,4,"Error logging references: {0}",qa.toString())}this.NCm(La);ba.oLf|=(La.output.succeeded?2:1)<<2*(Za-1);if(ba)try{ba.p0e=this.N9m(La)}catch(qa){h.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",qa)}}}NCm(ka){if(!ka.output.succeeded){ka=ka.output.timeout?"Timeout":
ka.logger.nJi?ka.logger.nJi.xea:"Unknown";const ia=new I.a;m.Health.instance.recordQosError(ka,["MergeFailure"],!0,!0,!1,!1,ia)}}Uxm(ka){const ia=Ga=>{const Oa=this.mBa()-ka.input.mQa>this.K9b;if(0<this.K9b&&Oa)throw h.a.instance.Sa(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ga),v.a.invalidOperation(Ga);};let La=ka.runtime.du.keys,va=Ga=>ka.runtime.du.J(Ga);this.Lxf(ka,ia,La,va,"Favored");La=ka.runtime.nq.keys;va=Ga=>ka.runtime.nq.J(Ga);this.Lxf(ka,ia,La,va,"Unfavored");
La=ka.runtime.Um.keys;va=Ga=>{const Oa=ka.runtime.Um.J(Ga);return Oa?Oa.gm:ka.runtime.du.J(Ga)};this.Lxf(ka,ia,La,va,"Merged")}Lxf(ka,ia,La,va,Ga){var Oa=new u.a;const Za=new u.a;for(let ja=0;ja<La.length;ja++){ia("LogAddedAndDeletedNodes");const ba=va(La.J(ja));if(4325465===ba.Qc)continue;const qa=ka.runtime.lk.J(ba.id);qa&&this.Vxm(Oa,Za,ba,qa)}this.qoi(Za,ja=>ka.runtime.lk.J(ja),ia);this.qoi(Oa,va,ia);ia=new Sys.StringBuilder;for(La=0;La<Oa.length;La++)ia.append(Oa.J(La).toString()+",");Oa=new Sys.StringBuilder;
for(La=0;La<Za.length;La++)Oa.append(Za.J(La).toString()+",");h.a.instance.Aha(571619423,1,4,Ga+" revision: Added references",ia.toString());h.a.instance.Aha(571619424,1,4,Ga+" revision: Deleted references",Oa.toString())}Vxm(ka,ia,La,va){const Ga=La.Nj();for(let Za=0;Za<Ga.length;Za++){const ja=Ga[Za];if(this.wbi(ja)){var Oa=this.$d.getPropertyObjectIds(La,ja);this.$zm(ka,ia,va,ja,Oa)}else this.Bgi(ja)&&(Oa=this.$d.getPropertyObjectId(La,ja),this.Zzm(ka,ia,va,ja,Oa))}}qoi(ka,ia,La){La("LogNestedReferences");
La=new u.a;const va=new n.a;for(let Ga=0;Ga<ka.length;Ga++){const Oa=ka.J(Ga);this.lyf(Oa,La,va,ia)}for(ia=0;ia<La.length;ia++)ka.add(La.J(ia))}lyf(ka,ia,La,va){const Ga=va(ka);if(Ga){const Za=Ga.Nj();for(let ja=0;ja<Za.length;ja++){var Oa=Za[ja];if(this.wbi(Oa)){Oa=this.$d.getPropertyObjectIds(Ga,Oa);for(let ba=0;ba<Oa.length;ba++)La.contains(Oa.J(ba))||(ia.add(Oa.J(ba)),La.add(Oa.J(ba)),this.lyf(Oa.J(ba),ia,La,va))}else this.Bgi(Oa)&&(Oa=this.$d.getPropertyObjectId(Ga,Oa),La.contains(Oa)||(ia.add(Oa),
La.add(Oa),this.lyf(ka,ia,La,va)))}}}$zm(ka,ia,La,va,Ga){if(this.$d.hasProperty(La,va)){La=this.$d.getPropertyObjectIds(La,va);const Oa=La.iG();va=Ga.iG();for(let Za=0;Za<Ga.length;Za++)Oa.contains(Ga.J(Za))||ka.add(Ga.J(Za));for(ka=0;ka<La.length;ka++)va.contains(La.J(ka))||ia.add(La.J(ka))}else for(ia=0;ia<Ga.length;ia++)ka.add(Ga.J(ia))}Zzm(ka,ia,La,va,Ga){Ga&&(this.$d.hasProperty(La,va)?(La=this.$d.getPropertyObjectId(La,va),Ga.equals(La)||(ka.add(Ga),ia.add(La))):ka.add(Ga))}bBm(ka){h.a.instance.Sa(4535064,
1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ka.input.XFb,ka.output.crash,ka.output.timeout)}iBm(ka,ia,La,va,Ga,Oa,Za){if(ka){ka=va.length?va.mg(va.length-1):null;var ja=Ga.length?Ga.mg(Ga.length-1):null;La=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",ia.input.XFb,va.length,ka?
ka.id:x.a.nil,ka?ka.N1?ka.N1.id:x.a.nil:x.a.nil,Ga.length,ja?ja.id:x.a.nil,ja?ja.N1?ja.N1.id:x.a.nil:x.a.nil,Oa,Za,this.K9b,La);switch(ia.input.source){case 5:h.a.instance.Sa(51663493,1,4,La);break;default:h.a.instance.Sa(4051606,1,4,La)}}}fBm(ka,ia,La){if(ka)switch(ka=this.hIc(ia,La,"Succeeded"),ia.input.source){case 5:h.a.instance.Sa(51663494,1,4,ka);break;default:h.a.instance.Sa(4059162,1,4,ka)}}hBm(ka,ia){ia=this.hIc(ka,ia,"Timeout");switch(ka.input.source){case 5:h.a.instance.Sa(51663495,1,4,
ia);break;default:h.a.instance.Sa(4059163,1,2,ia)}}dBm(ka,ia){ia=this.hIc(ka,ia,"Rejection");switch(ka.input.source){case 5:h.a.instance.Sa(51663496,1,4,ia);break;default:h.a.instance.Sa(4059164,1,2,ia)}}gBm(ka,ia){ia=this.hIc(ka,ia,"Crash - Rejection");switch(ka.input.source){case 5:h.a.instance.Sa(51663497,1,4,ia);break;default:h.a.instance.Sa(4059165,1,2,ia)}}eBm(ka,ia){ia=this.hIc(ka,ia,"Crash - Failed");switch(ka.input.source){case 5:h.a.instance.Sa(51663498,1,4,ia);break;default:h.a.instance.Sa(4059166,
1,2,ia)}}hIc(ka,ia,La){const va=ka.output.bM,Ga=va&&va.length?va.mg(va.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ka.input.XFb,La,this.mBa()-ka.input.mQa,ia,va?va.length:0,Ga?Ga.id:x.a.nil,Ga?Ga.N1?Ga.N1.id:x.a.nil:x.a.nil,ka.input.source)}VMk(ka,ia,La,va,Ga,Oa,Za){const ja=new S.a,ba=ja.input;ba.U3=ka;ba.Zwa=ia;ba.Xl=La;ba.c3=va;ba.l5b=Ga;ba.source=
Oa;ba.cGc=Za;ba.mQa=this.mBa();ja.logger.lRn(ba.mQa);ka=ja.runtime;ka.v0c=h.a.instance.T7(1,5);ka.C8d=h.a.instance.T7(1,4);let qa="";ka.hG=Ma=>{if(this.K9b){var Ia=this.mBa()-ba.mQa,wa=Ia>this.K9b;qa+=String.format(" ({0}: {1})",Ma,Ia);wa&&(ja.output.timeout=!0,Ma=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ba.XFb,this.K9b,Ma,Ia,qa),h.a.instance.Sa(528061012,1,2,Ma),this.fao(Ma))}};return ja}RIc(){return[Object(F.a)(this,
this.U1m,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.Xgm,"isInputValid"),Object(F.a)(this,this.D5l,"initializeOutputMergeState"),Object(F.a)(this,this.DMd,"initializeRuntimeMergeState"),X.a.u9m,Object(F.a)(this,this.t9m,"preProcessTableStructure"),Object(F.a)(this.Cnh,this.Cnh.sJm,"mergeChildNodeLists"),Object(F.a)(this,this.zfo,"tryObjectMerge"),X.a.c9m,Object(F.a)(this,this.v$k,"finalizeObjectMerge"),Object(F.a)(this,this.oso,"validateMarkers"),Object(F.a)(this,this.P4j,"addMergeResultsToOutput")]}U1m(ka){const ia=
ka.input.U3;ka=ka.output;return ia?ia.length?!0:(h.a.instance.Sa(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ka.bM=ia,ka.succeeded=!0,!1):(h.a.instance.Sa(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ka.bM=ia,ka.succeeded=!0,!1)}Xgm(ka){var ia=ka.input;const La=ia.U3,va=ia.Zwa,Ga=ia.Xl,Oa=ia.c3;ia=ia.l5b;ka=ka.output;if(!va||!va.length)return h.a.instance.Sa(42350233,1,5,"IsInputValid: No local changes to merge."),
ka.bM=La,ka.succeeded=!0,!1;let Za=!0;if(2!==Oa&&1!==Oa)return ka.bM=La,!1;Ga&&Ga!==x.a.nil||(Za=!1);La.length<(ia?2:1)&&(h.a.instance.Sa(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",ia),Za=!1);Za||(ka.bM=2===Oa?La:va);return Za}DMd(ka){var ia=ka.input,La=ia.U3,va=ia.Zwa,Ga=ia.c3,Oa;let Za;({K$n:Oa,kyo:Za,dAa:ia}=this.Oyl(ka,La,va,ia.l5b));if(!ia)return h.a.instance.Sa(4273301,1,
2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",Oa.id,Za.id),ka.logger.Tg(Object.assign(new N.a,{kj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.Poi(Oa,La.length,"TheirChanges"),this.Poi(Za,va.length,"YourChanges"),ka.output.bM=2===Ga?La:va,!1;ka.runtime.dAa=ia;({$go:La,K8k:va}=this.aXk(Ga,Oa,Za));({aho:ia,L8k:Ga,Yik:Oa}=this.iBl(ka,La,va,ia));ka.runtime.lk=Oa;ka.runtime.nq=ia;ka.runtime.du=
Ga;ka.runtime.Um=new A.a;ka.runtime.kCd=va.id;ka.runtime.Cce=La.id;ka.runtime.bib=new A.a;ka.runtime.eKa=new n.a;ka.runtime.p3e=new A.a;ka.runtime.nxb=new A.a;ka.runtime.H4f=new A.a;ka.runtime.a3d=new ca;ka.runtime.gVd=new u.a;ka.runtime.JKf=new n.a;ka.runtime.ufc=new u.a;ka.runtime.Wb=ka.input.cGc(ka);ka.runtime.Wb.brd(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.j$n);ka.runtime.Wb.brd(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",
l.a.gbo);ka.runtime.Wb.brd(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.t8k);ka.runtime.Wb.brd(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.Mrn);ka.runtime.J9h=!0;H.AFrameworkApplication.K&&(this.lOg=H.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}Poi(ka,ia,La){const va=new u.a;for(;ka;)va.add(ka),ka=ka.N1;const Ga=new Sys.StringBuilder;Ga.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
La,ia,va.length));let Oa=va.length,Za=0;va.forEach(ja=>({N7h:Oa,rpi:Za}=this.C6j(Ga,ja,va,Oa,Za)).returnValue);h.a.instance.Sa(4273302,1,4,Ga.toString())}C6j(ka,ia,La,va,Ga){ka.append(String.format(" [{0} {1} {2}]",va,ia.tua?"S":"B",ia.id));va--;Ga++;return 50<Ga&&La.length!==Ga?(ka.append(" ...Truncated."),{returnValue:!1,N7h:va,rpi:Ga}):{returnValue:!0,N7h:va,rpi:Ga}}Oyl(ka,ia,La,va){ia=ia.mg(ia.length-1-(va?1:0));La=La.mg(La.length-1);va=ia.Ndb(La);ka.runtime.hG("GetCommonBase");ka.logger.Mfa("GetCommonBase");
return{K$n:ia,kyo:La,dAa:va}}iBl(ka,ia,La,va){let Ga,Oa;({result:Ga}=ia.R9b(va));ka.runtime.hG("GetUnfavoredChanges");ka.logger.Mfa("GetUnfavoredChanges");({result:Oa}=La.R9b(va));5===ka.input.source&&(ka.runtime.O8k=K.a.hZh(La),ka.runtime.cho=K.a.hZh(ia));ka.runtime.hG("GetFavoredChanges");ka.logger.Mfa("GetFavoredChanges");ia=new E.a(Object(F.a)(va,va.RYa,"getMergeableObject"));ka.runtime.hG("GetModifiedObjects");ka.logger.Mfa("GetModifiedObjects");return{aho:Ga,L8k:Oa,Yik:ia}}aXk(ka,ia,La){2===
ka?(ka=ia,ia=La):ka=La;return{$go:ia,K8k:ka}}D5l(ka){const ia=ka.input,La=ia.U3,va=ia.Zwa;ka.output.bM=(2===ia.c3?La:va).L3();ka.runtime.hG("InitializeOutputMergeState");ka.logger.Mfa("InitializeOutputMergeState");return!0}P4j(ka){var ia=ka.input.Xl;const La=ka.runtime.Um,va=ka.output.bM;ia=this.WMk(ka,va.mg(va.length-1),ia,x.a.create());this.W9k(ka,ia,La);va.add(ia);return ka.output.succeeded=!0}WMk(ka,ia,La,va){ka.runtime.C8d&&h.a.instance.Sa(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
La,va);ka=this.KBn(va);ka.vjk(ia,La);return ka}W9k(ka,ia,La){ka.runtime.C8d&&h.a.instance.Sa(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",La.count);La.forEach((va,Ga)=>{ia.f6j(Ga.gm);return!0})}sEb(ka){if(!ka)return h.a.instance.Sa(573957952,1,2,"Feature helper is null"),!1;ka.Lt(112);return ka.isFeatureEnabled(112)}t9m(ka){if(!this.sEb(ka.runtime.Wb))return!0;const ia=ka.runtime.du,La=ka.runtime.nq,va=ka.runtime.lk;let Ga=!0;ia.forEach((Oa,Za)=>{393252===Za.Qc&&(Ga=this.cHi(ka,
Oa,Za,va,ia));return Ga});if(!Ga)return!1;La.forEach((Oa,Za)=>{393252===Za.Qc&&(Ga=this.cHi(ka,Oa,Za,va,La));return Ga});ka.logger.Mfa("PreProcessTableStructure");return Ga}cHi(ka,ia,La,va,Ga){const Oa=null==this.$d.getPropertyBool(La,e.a.ghostCell)?!1:this.$d.getPropertyBool(La,e.a.ghostCell),Za=null==this.$d.getPropertyUint32(La,e.a.rowSpan)?1:this.$d.getPropertyUint32(La,e.a.rowSpan),ja=null==this.$d.getPropertyUint32(La,e.a.colSpan)?1:this.$d.getPropertyUint32(La,e.a.colSpan);if(Oa)return!0;var ba=
va.J(ia);if(ba){va=null==this.$d.getPropertyBool(ba,e.a.ghostCell)?!1:this.$d.getPropertyBool(ba,e.a.ghostCell);var qa=null==this.$d.getPropertyUint32(ba,e.a.rowSpan)?1:this.$d.getPropertyUint32(ba,e.a.rowSpan);var Ma=null==this.$d.getPropertyUint32(ba,e.a.colSpan)?1:this.$d.getPropertyUint32(ba,e.a.colSpan);va=va!==Oa;qa=qa!==Za;Ma=Ma!==ja}else Ma=qa=va=!0;const Ia=sa.e(ka,La,Ga);if(Ia.equals(x.a.nil))return h.a.instance.Sa(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",
ia),ka.logger.Tg(Object.assign(new ra.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let wa=ka.runtime.nxb.J(Ia);wa||(ka.runtime.nxb.Z(Ia,new A.a),wa=ka.runtime.nxb.J(Ia));let za=wa.J(ia),pa=new u.a;const Ba=new u.a,Ra=new u.a;va&&(za||(pa=this.$d.getPropertyObjectIds(La,a.a.$e)));if(qa||Ma)if(za){if(za.gg)return h.a.instance.Sa(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),ka.logger.Tg(Object.assign(new ra.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),
!1;if(null!=za.rowSpan&&Za!==za.rowSpan||null!=za.colSpan&&ja!==za.colSpan)return h.a.instance.Sa(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ka.logger.Tg(Object.assign(new ra.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var fb;({rowIndex:La,BZb:fb}=sa.b(ka,Ga,La));if(-1===La||-1===fb)return h.a.instance.Sa(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",ia),ka.logger.Tg(Object.assign(new ra.a,
{info:"Table cell location could not be found"})),!1;for(var Va=La;Va<La+Za;Va++)for(var ib=fb;ib<fb+ja;ib++){var Xa=sa.c(ka,Ia,Va,ib);if(Xa.equals(x.a.nil))return h.a.instance.Sa(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),ka.logger.Tg(Object.assign(new ra.a,{info:"Ghost cell not found in the table bounds"})),!1;var qb=Ga.Py(Xa,ka.runtime.lk.J(Xa));if(!qb)return h.a.instance.Sa(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),
ka.logger.Tg(Object.assign(new ra.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!Xa.equals(ia)){if(null==this.$d.getPropertyBool(qb,e.a.ghostCell)||!this.$d.getPropertyBool(qb,e.a.ghostCell))return h.a.instance.Sa(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),ka.logger.Tg(Object.assign(new ra.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var rb=wa.J(Xa);if(rb)return h.a.instance.Sa(573957958,
1,4,"The ghost cell is already merged with some other cells in the other revision"),ka.logger.Tg(Object.assign(new ra.a,{info:"Ghost cell is already merged with some other cell"})),!1;Ba.add(Xa);rb=new ha;rb.gg=!0;qb=this.$d.getPropertyUint32(qb,e.a.colSpan);null!=qb&&(rb.colSpan=qb);wa.Z(Xa,rb)}}if(ba&&(null==this.$d.getPropertyBool(ba,e.a.ghostCell)||!this.$d.getPropertyBool(ba,e.a.ghostCell))&&(Ga=null==this.$d.getPropertyUint32(ba,e.a.rowSpan)?1:this.$d.getPropertyUint32(ba,e.a.rowSpan),La=null==
this.$d.getPropertyUint32(ba,e.a.colSpan)?1:this.$d.getPropertyUint32(ba,e.a.colSpan),Ga>Za||La>ja)){Va=fb=-1;({rowIndex:fb,BZb:Va}=sa.a(ka,null,ba,fb,Va));if(-1===fb||-1===Va)return h.a.instance.Sa(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",ia),ka.logger.Tg(Object.assign(new ra.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ba=Ba.iG();for(ib=fb;ib<fb+Ga;ib++)for(Xa=Va;Xa<Va+La;Xa++){rb=
sa.d(ka,null,Ia,ib,Xa);if(!rb)return h.a.instance.Sa(573957960,1,2,"Table cell could not be found within table bounds"),ka.logger.Tg(Object.assign(new ra.a,{info:"Ghost cell not found in the table bounds"})),!1;rb.id.equals(ia)||ba.contains(rb.id)||Ra.add(rb.id)}}}!za&&(va||qa||Ma)&&(h.a.instance.Sa(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",ia),za=new ha,za.rowSpan=Za,za.colSpan=ja,za.gg=Oa,za.KWd=pa,za.Wjf=Ba,za.AEf=Ra,wa.add(ia,za));
return!0}zfo(ka){return this.zfj(ka,!1)}v$k(ka){return this.zfj(ka,!0)}zfj(ka,ia){const La=ka.runtime,va=La.lk,Ga=La.du,Oa=ia?La.p3e:La.nq,Za=La.Um;let ja=!0;const ba=ka.runtime.v0c;let qa=0,Ma=0,Ia=0;Oa.forEach((wa,za)=>{ba&&h.a.instance.Sa(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",wa,za.Qc,ia);Ma++;this.lOg===Ma&&(qa++,ka.runtime.hG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",qa,Ia,ia)),Ma=0);if(ka.runtime.Wb&&ka.runtime.Wb.NBb(1000005)&&
ka.runtime.ufc.contains(za.id,(Ra,fb)=>Ra.equals(fb))||this.p1n(za.Qc))return!0;if(!ia&&this.ITk(za.Qc,ka.runtime.Wb))return La.p3e.Z(wa,za),!0;var pa=Ga.get(wa);if(!pa)return Za.ub(wa)?Za.J(wa).wsi(za):Za.Z(wa,new Y.a(za,!1)),!0;if(!va.J(wa)&&!this.gKm(pa.Qc)){var Ba=!!ka.input.U3&&!!ka.input.U3.last()&&ka.input.U3.last().Q2(wa);const Ra=!!ka.input.Zwa&&!!ka.input.Zwa.last()&&ka.input.Zwa.last().Q2(wa),fb=new W.a(pa,za);if(!fb.XW)return Za.Z(wa,new Y.a(pa,!1)),!0;h.a.instance.Sa(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
wa,za.Qc,ia,Ba,Ra,!fb.XW,ka.input.source);ka.logger.Tg(Object.assign(new N.a,{kj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ja=!1}Ba=Za.Py(wa,new Y.a(va.J(wa)));({Lk:pa,returnValue:ja}=this.MSl.merge(ka,this.D3h,this.$d,Ba,pa,za));Ia++;ja&&(ka.runtime.hG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",wa,za.Qc,Ia,qa,ia)),pa&&(Za.ub(pa.gm.id)?Za.J(pa.gm.id).wsi(pa.gm):Za.Z(pa.gm.id,pa)));return ja});ka.logger.Mfa("ObjectMerge");ba&&
h.a.instance.Sa(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Oa.count,Ia,ia);return ja}oso(ka){try{for(let ia=0;ia<ka.runtime.gVd.length;ia++){const La=ka.runtime.gVd.J(ia);if(ka.runtime.Um.J(La)){if(!this.gim(ka,La))return!1}else h.a.instance.Sa(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ka.runtime.hG("Validate markers taking too long")}}catch(ia){h.a.instance.Sa(559535579,1,2,"ValidateMerge threw an exception: {0}",ia)}return ka.logger.MRc.p5h()?
!1:!0}EXn(ka){return 38===ka||39===ka||40===ka||41===ka||44===ka||45===ka||33===ka||34===ka?!1:!0}AAl(ka){switch(ka){case 38:case 39:case 40:case 41:return e.a.pe;case 44:case 45:return e.a.Wsd;case 33:case 34:return e.a.Rj}return L.CommonProperties.nil}nso(ka,ia){const La=this.$d.getPropertyUint32(ka,e.a.Gq);if(!La||this.EXn(La))return!0;ka=this.$d.getPropertyObjectId(ka,this.AAl(La));return oa.c3b(ia,ka)?!0:(ia.logger.MRc.pNd=La,!1)}gim(ka,ia){if(ka.runtime.JKf.contains(ia))return!1;if(ia=oa.c3b(ka,
ia)){ia=this.$d.getPropertyObjectIds(ia,a.a.wn);for(let La=0;La<ia.length;La++){const va=oa.c3b(ka,ia.mg(La));if(va&&!this.nso(va,ka))return!1}}return!0}p1n(ka){switch(ka){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}ITk(ka,ia){let La=!1;if(1074135145===ka)return!0;ia&&ia.Lt(132);ia&&ia.isFeatureEnabled(132)&&1074135153===ka&&(La=!0);return La}gKm(ka){switch(ka){case 1074135162:return!0}return!1}bPk(ka,ia){const La=new u.a,va=new u.a,Ga=
new u.a;var Oa=ka.runtime.dAa;const Za=Oa?Oa.id:x.a.nil;this.mxf(Oa).forEach(ja=>{La.add(ia(ja));return!0});Oa=ka.input.U3.mg(ka.input.U3.length-1);this.mxf(Oa,Za).forEach(ja=>{va.add(ia(ja));return!0});ka=ka.input.Zwa.mg(ka.input.Zwa.length-1);this.mxf(ka,Za).forEach(ja=>{Ga.add(ia(ja));return!0});return{Wik:La,L$n:va,lyo:Ga}}mxf(ka,ia=null){const La=new u.a;ia||(ia=x.a.nil);for(;ka&&!ia.equals(ka.id);)La.add(ka),ka=ka.N1;La.reverse();return La}b7n(ka){const ia=3===this.uJd;let La=!1;!ka.output.succeeded&&
(2===this.uJd||ka.output.crash&&1===this.uJd)&&(La=!0);let va=!1;ka.input.U3&&0<ka.input.U3.length&&(ia||La)&&ka.runtime.du&&ka.runtime.lk&&ka.runtime.Wb&&(va=ka.runtime.Wb.isFeatureEnabled(50));return va}wbi(ka){return 9===J.a.uBb(J.a.Gaf(ka))}Bgi(ka){return 8===J.a.uBb(J.a.Gaf(ka))}static ovl(ka){return ka.output.crash?2:ka.output.succeeded?3:1}static c3b(ka,ia){if(!ia||ia===x.a.nil)return null;const La=ka.runtime.Um.J(ia);return La?La.gm:ka.runtime.lk.J(ia)}}oa.tJd=x.a.Pf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(C.a)(oa,"GraphMergerBase",null,[1378])},1692:function(C,O,c){C=c(0);var l=c(216),e=c(1565),a=c(151),h=c(1494);class m extends e.a{constructor(u,n,x,A,H,E,L,M,F,J,I,K,N,G){super(u,3,n,x,A,H,E,M,F,J,I,K,N,G);this.fke=L}get character(){return this.fke}get text(){return this.character.toString()}a0c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}u2b(){return"CharRun"}clone(){return new m(this.Oyc,this.source,this.Cj,this.Dg,this.runId,this.uI,this.character,
this.aib,this.dNa,this.U$,this.PBa,this.QOa,this.wE,this.Bt)}Tz(u,n,x,A=!1){return super.Tz(u,n,x,A)?u.character===this.character?!0:h.a.Yeh(u.character,this.character):!1}}Object(C.a)(m,"CharRunMergeBlock",e.a,[]);c.d(O,"a",function(){return v});class v extends e.a{constructor(u,n,x,A,H,E,L,M,F,J,I,K,N,G,P){super(u,1,n,x,A,H,E,M,J,I,K,N,G,P);this._text=L;this.pJe=F}get text(){return this._text}a0c(u){this._text=u}get N3a(){return this.pJe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.pJe)}u2b(){return"TextRun"}clone(){return new v(this.Oyc,this.source,this.Cj,this.Dg,this.runId,this.uI,this._text,this.aib,this.pJe,this.dNa,this.U$,this.PBa,this.QOa,this.wE,this.Bt)}Tz(u,n,x,A=!1){return super.Tz(u,n,x,A)?h.a.Xeh(this._text,u._text):!1}j1c(){const u=new l.a;for(let x=0;x<this.text.length;x++){var n=h.a.charAt(this._text,x);if(h.a.snm(h.a.Sao(n))){let A="";A+=n;n=h.a.charAt(this._text,++x);A+=n;n=new v(this.Oyc,this.source,this.Cj,this.Dg,this.runId,this.uI,
A,this.aib,!1,this.dNa,this.U$,this.PBa,this.QOa,this.wE,this.Bt);u.add(n)}else n=new m(this.Oyc,this.source,this.Cj,this.Dg,this.runId,this.uI,n,this.aib,this.dNa,this.U$,this.PBa,this.QOa,this.wE,this.Bt),u.add(n)}return u}}Object(C.a)(v,"TextRunMergeBlock",e.a,[])},1693:function(C,O,c){C=c(0);var l=c(982),e=c(16),a=c(386),h=c(216),m=c(59);c(791);var v=c(619),u=c(149),n=c(151),x=c(1006),A;(function(F){F[F.none=0]="none";F[F.browser=1]="browser";F[F.serverPutChanges=2]="serverPutChanges";F[F.syncDiff=
3]="syncDiff";F[F.docxMerge=4]="docxMerge";F[F.undo=5]="undo"})(A||(A={}));Object(C.b)("GraphMergeSource",A);var H=c(1680),E=c(1507),L=c(1674);c.d(O,"a",function(){return M});class M{constructor(F){this.mA=new x.a;this.bP=new a.a;this.z4g=new a.a(0);this.J6c=new h.a;this.ZIg=new h.a;this.LSg=new h.a;this.WPg=new h.a;this.URg="";this.BSa=null;this.Gr=this.txe=0;this.gid=new a.a(0);this.Fpe=this.tWg=this.afd=0;const {MarkerValidation:J}=c(1782);this._state=F;this.zNj=new J}get MRc(){return this.zNj}get nJi(){return this.BSa}lRn(F){this.txe=
F}OTd(F,J){this.URg=String.format("{0}-{1}",F,J)}r7d(F){this.Wxk();this.Fpe=F}hZf(){this.Fpe=0}Wxk(){this.BSa&&this.J6c.add(this.BSa);this.BSa=null}Tg(F){this.BSa||(this.BSa=F);switch(this.Fpe){case 1:this.ZIg.add(F);break;case 2:this.LSg.add(F);break;case 3:this.WPg.add(F);break;default:this.BSa&&this.J6c.add(F)}}wni(F){this.J6c.add(F)}cBm(){this.Gr=this.mBa();this.Mfa("MergeEnd")}Mfa(F){const J=this.mBa();this.z4g.Z(F,J-this.txe);this.txe=J}oPn(){this.afd=this.mBa();this.tWg++}ZT(F){const J=this.mBa();
let I;({value:I}=this.gid.Bc(F)).returnValue?(I+=J-this.afd,this.gid.Z(F,I)):this.gid.Z(F,J-this.afd);this.afd=J}OAl(){this.bP.Z("Id",this._state.input.XFb.toString());this.bP.Z("Source",A[this._state.input.source]);this.bP.Z("Base",M.Ywa(this.Fkl()));this.bP.Z("Favored",M.Ywa(this.xZh(!0)));this.bP.Z("Unfavored",M.Ywa(this.xZh(!1)));this.bP.Z("NodesRolledBackIfFailed",M.Ywa(this.HCl()));if(!this._state.output.succeeded){let F,J,I,K,N;({Zik:F,M8k:J,bho:I,djk:K,dho:N}=this.A$k(this._state.runtime));
this.bP.Z("CharactersLost",this.Sml(F,J,I));this.bP.Z("CharactersLostInComments",this.Qnl());this.bP.Z("CharactersLostInTables",this.zjl(N,K))}this.bP.Z("FuncStep",this.URg);this.bP.Z("FailureDetail",M.Ywa(this.EAb()));this.bP.Z("FailDetailHints",this.KFd(this.ZIg));this.bP.Z("FailDetailNaiveMerge",this.KFd(this.LSg));this.bP.Z("FailDetailLcs",this.KFd(this.WPg));this.bP.Z("ExtraDetails",this.KFd(this.J6c));this.bP.Z("Timeline",M.Ywa(this.z4g));this.bP.Z("ParagraphMergesCount",this.tWg);this.bP.Z("ParagraphMergeDurations",
M.Ywa(this.gid));this.bP.Z("MarkerInfo",M.Ywa(this.MRc.WQh()));this.bP.Z("Result",M.Ywa(this.QAl()));return JSON.stringify(M.Ywa(this.bP))}mBa(){return(new Date).getTime()}Fkl(){const F=new a.a,J=this._state.input.Zwa,I=this._state.runtime.dAa?this._state.runtime.dAa.id:m.a.nil;let K=!1,N=0;for(;N<J.length;N++)if(J.J(N).id.equals(I)){K=!0;break}F.Z("LastId",I.toString());F.Z("Length",K?N+1:-1);return F}xZh(F){const J=new a.a;if(0===this._state.input.c3)return null;F=F?2===this._state.input.c3?this._state.input.U3:
this._state.input.Zwa:2===this._state.input.c3?this._state.input.Zwa:this._state.input.U3;J.Z("FirstId",F.J(0).id.toString());J.Z("LastId",F.length?F.J(F.length-1).id.toString():null);J.Z("Length",F.length);return J}HCl(){if(!this._state.runtime.J9h)return null;const F=this._state.runtime.nq,J=new a.a(0);F.forEach((I,K)=>{({value:I}=J.Bc(K.Qc.toString()));J.Z(K.Qc.toString(),I+1);return!0});return J}Sml(F,J,I){let K=null,N=null,G=null;const P=this._state.runtime.nq;let S=0;try{G=new L.a(this.mA,this._state);
K=E.b(F,J,I);N=new v.a;for(F=0;F<K.length;F++)if(!K.J(F).hwb.Jp(K.J(F).tmb,(W,X)=>W.equals(X))){const W=this.iBh(K.J(F),G);S+=W;N.add(K.J(F))}K&&P.forEach((W,X)=>{if(393230===X.Qc){X=null;for(let Y=0;Y<K.length;Y++)if(!N.contains(K.J(Y))&&K.J(Y).tmb.contains(W,(ca,ha)=>ca===ha)){X=K.J(Y);break}X&&(W=this.iBh(X,G),N.add(X),S+=W)}return!0});return S}catch(W){return u.a.instance.Sa(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}A$k(F){let J,I,K,N,G;F.hG=S=>{if(750<this.mBa()-this._state.input.mQa)throw u.a.instance.Sa(579190991,
1,2,"Timed out while calculating characters lost: {0}",S),n.a.invalidOperation(S);};J=new h.a;I=new h.a;K=new h.a;N=new h.a;const P=new h.a;G=new h.a;try{if(F.lk){const S=F.lk.J(H.ChildNodeListMerge.XZd);let W,X;W=F.du.J(H.ChildNodeListMerge.XZd)||S;X=F.nq.J(H.ChildNodeListMerge.XZd)||S;this.B9e(S,Y=>F.lk.J(Y),J,N);this.B9e(W,Y=>F.du.J(Y)||F.lk.J(Y),I,P);this.B9e(X,Y=>F.nq.J(Y)||F.lk.J(Y),K,G)}}catch(S){u.a.instance.Sa(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+S.toString())}return{Zik:J,
M8k:I,bho:K,djk:N,dho:G}}zjl(F,J){try{let K=0;const N=this._state.runtime;var I=S=>N.nq.J(S)||N.lk.J(S);const G=new v.a,P=this.kbl(F,N,I,G);for(F=0;F<P.count;F++){let S=P.keys.J(F);const W=P.J(S);if(!G.contains(S)){let X=this.v0h(N,I,G,S,W);if(-1!==X)K+=X;else return u.a.instance.Sa(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(I=0;I<J.length;I++){let S=J.J(0);if(!G.contains(S)){let W=this.LId(N.lk.J(S));if(-1===W)return u.a.instance.Sa(573089734,1,2,
"Error calculating characters lost in table deleted from base"),-1;K+=W}}return K}catch(K){return u.a.instance.Sa(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+K.toString()),-1}}v0h(F,J,I,K,N){F.hG("GetTableCharactersLost");let G=0;N=this.mA.getPropertyObjectIds(N,e.a.$e);for(let Y=0;Y<N.length;Y++){var P=J(N.J(Y));P=this.mA.getPropertyObjectIds(P,e.a.$e);for(let ca=0;ca<P.length;ca++){var S=J(P.J(ca));if(F.lk.J(N.J(Y))&&F.lk.J(P.J(ca))){var W=F.lk.J(P.J(ca));if(!W)return u.a.instance.Sa(573089737,
1,2,"Base cell unexpectedly null"),-1;S=this.mA.getPropertyObjectIds(W,e.a.$e);var X=F.du.J(P.J(ca))||F.lk.J(P.J(ca));X=this.mA.getPropertyObjectIds(X,e.a.$e);W=this.mA.getPropertyObjectIds(W,e.a.$e);S=E.b(S,X,W);for(W=0;W<S.length;W++){X=S.J(W);const ha=this.iNl(F,J,I,X);if(-1===ha)return u.a.instance.Sa(573089738,1,2,"Error getting characters lost for parition {0}",X.toString()),-1;G+=ha}}else{W=this.QNl(J,S,I);if(-1===W)return u.a.instance.Sa(573089736,1,2,"Error getting text length of cell {0}",
S.id.toString()),-1;G+=W}}}I.add(K);return G}iNl(F,J,I,K){let N=0;var G=new h.a,P=new h.a;const S=new a.a;new a.a;for(var W=0;W<K.hwb.length;W++){var X=F.lk.J(K.hwb.J(W));X=this.mA.getPropertyObjectIds(X,e.a.gI);if(1!==X.length)return u.a.instance.Sa(573089739,1,2,"Unexpected number of ContentNodes: {0}",X.length),-1;var Y=F.lk.J(X.J(0));393230===Y.Qc?G.add(Y):393250===Y.Qc&&S.add(X.J(0),Y)}for(W=0;W<K.tmb.length;W++){X=J(K.tmb.J(W));X=this.mA.getPropertyObjectIds(X,e.a.gI);if(1!==X.length)return u.a.instance.Sa(573089740,
1,2,"Unexpected number of ContentNodes: {0}",X.length),-1;Y=J(X.J(0));if(393230===Y.Qc)P.add(Y);else if(393250===Y.Qc){Y=this.v0h(F,J,I,X.J(0),Y);if(-1===Y)return u.a.instance.Sa(573089741,1,2,"Error diffing table {0}",X.J(0).toString()),-1;N+=Y}}W=new L.a(this.mA,this._state);if(0<G.length&&0<P.length){G=W.SIh(G,ca=>F.lk.J(ca),P,ca=>J(ca));if(-1===G)return u.a.instance.Sa(573089742,1,2,"Problem diffing parition {0} with LCS",K.toString()),-1;N+=G}else if(0<G.length)for(K=0;K<G.length;K++)N+=this.mA.getPropertyString(G.J(K),
e.a.mo).length+1;else if(0<P.length)for(K=0;K<P.length;K++)N+=this.mA.getPropertyString(P.J(K),e.a.mo).length+1;for(K=0;K<S.count;K++)if(G=S.keys.J(K),!I.contains(G)){P=this.LId(S.J(G));if(-1===P)return u.a.instance.Sa(573089743,1,2,"Error getting length of table {0}",G.toString()),-1;N+=P}return N}QNl(F,J,I){let K=0;J=this.mA.getPropertyObjectIds(J,e.a.$e);for(let P=0;P<J.length;P++){var N=F(J.J(P));N=this.mA.getPropertyObjectIds(N,e.a.gI);if(1!==N.length)return u.a.instance.Sa(573089744,1,2,"Unexpected number of ContentNodes: {0}",
N.length),-1;var G=F(N.J(0));if(393230===G.Qc)K+=this.mA.getPropertyString(G,e.a.mo).length+1;else if(393250===G.Qc){G=this.LId(G);if(-1===G)return u.a.instance.Sa(573089745,1,2,"Problem finding text length of table {0}",N.J(0).toString()),-1;K+=G;I.add(N.J(0))}}return K}LId(F){this._state.runtime.hG("GetTextLengthOfTable");let J=0;const I=S=>this._state.runtime.nq.J(S)||this._state.runtime.lk.J(S);F=this.mA.getPropertyObjectIds(F,e.a.$e);for(let S=0;S<F.length;S++){var K=I(F.J(S));K=this.mA.getPropertyObjectIds(K,
e.a.$e);for(let W=0;W<K.length;W++){var N=I(K.J(W));N=this.mA.getPropertyObjectIds(N,e.a.$e);for(let X=0;X<N.length;X++){var G=I(N.J(X));G=this.mA.getPropertyObjectIds(G,e.a.gI);if(1!==G.length)return u.a.instance.Sa(573089746,1,2,"Unexpected number of ContentNodes: {0}",G.length),-1;var P=I(G.J(0));if(393230===P.Qc)J+=this.mA.getPropertyString(P,e.a.mo).length+1;else if(393250===P.Qc){P=this.LId(P);if(-1===P)return u.a.instance.Sa(573089747,1,2,"Error finding the text length of table {0}",G.J(0)),
-1;J+=P}}}}return J}kbl(F,J,I,K){const N=new a.a;for(let G=0;G<F.length;G++){let P=!1;J.nq.J(F.J(G))&&(P=!0);const S=I(F.J(G)),W=this.mA.getPropertyObjectIds(S,e.a.$e);if(!P)for(let X=0;X<W.length;X++)if(J.nq.J(W.J(X))){P=!0;break}P?N.add(F.J(G),S):K.add(F.J(G))}return N}iBh(F,J){return this.hBh(F.hwb,F.tmb,J)}hBh(F,J,I){const K=new h.a;for(var N=0;N<F.length;N++)K.add(this._state.runtime.lk.J(F.J(N)));F=new h.a;for(N=0;N<J.length;N++)F.add(this._state.runtime.nq.J(J.J(N))||this._state.runtime.lk.J(J.J(N)));
return I.SIh(K,G=>this._state.runtime.lk.J(G),F,G=>this._state.runtime.nq.J(G)||this._state.runtime.lk.J(G))}B9e(F,J,I,K){if(393227===F.Qc){F=this.mA.getPropertyObjectIds(F,e.a.$e);for(let N=0;N<F.length;N++){const G=this.mA.getPropertyObjectIds(J(F.J(N)),e.a.$e);for(let P=0;P<G.length;P++){const S=this.mA.getPropertyObjectIds(J(G.J(P)),e.a.$e);for(let W=0;W<S.length;W++){const X=this.mA.getPropertyObjectIds(J(S.J(W)),e.a.gI);if(1!==X.length)return;const Y=J(X.J(0));393230===Y.Qc?I.add(X.J(0)):393250===
Y.Qc?K.add(X.J(0)):u.a.instance.Sa(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[Y.Qc])}}}}}C9e(F,J){F=this.mA.getPropertyObjectIds(F,e.a.$e);const I=new h.a;for(let K=0;K<F.length;K++){const N=this.mA.getPropertyObjectIds(J(F.J(K)),e.a.gI);if(1!==N.length)return null;I.add(N.J(0))}return I}Qnl(){let F=0;const J=this._state.runtime,I=J.nq,K=G=>J.nq.J(G)||J.lk.J(G);let N=null;J.hG=G=>{if(750<this.mBa()-this._state.input.mQa)throw u.a.instance.Sa(573089749,1,2,"Timed out while calculating comment characters lost: {0}",
G),n.a.invalidOperation(G);};try{I.forEach((G,P)=>{if(1074135127===P.Qc){G=this.C9e(P,K);var S=J.lk.J(P.id);if(S)S=this.C9e(S,X=>J.lk.J(X)),N||(N=new L.a(this.mA,this._state)),F+=this.hBh(S,G,N);else for(S=0;S<G.length;S++)F+=this.mA.getPropertyString(J.nq.J(G.J(S)),e.a.mo).length+1}if(1074135126===P.Qc&&(G=this.mA.getPropertyObjectIds(P,e.a.$e).iG(),P=J.lk.J(P.id)))for(P=this.mA.getPropertyObjectIds(P,e.a.$e),S=0;S<P.length;S++)if(!G.contains(P.J(S))){var W=J.lk.J(P.J(S));W=this.C9e(W,X=>J.lk.J(X));
for(let X=0;X<W.length;X++)F+=this.mA.getPropertyString(J.lk.J(W.J(X)),e.a.mo).length+1}return!0})}catch(G){return u.a.instance.Sa(573089750,1,2,"Exception in GetCommentCharactersLost: "+G.toString()),-1}return F}EAb(){return this.BSa?this.BSa.EAb():null}KFd(F){const J=new h.a;F.forEach(I=>{J.add(M.Ywa(I.EAb()));return!0});return J.toArray()}QAl(){const F=new a.a;F.Z("Succeeded",this._state.output.succeeded);F.Z("Timeout",this._state.output.timeout);F.Z("Crash",this._state.output.crash);F.Z("MergedRevisions",
this._state.output.bM?this._state.output.bM.length:-1);F.Z("Duration",this.Gr-this._state.input.mQa);return F}static Ywa(F){if(!F)return null;const J={};F.forEach((I,K)=>{J[I.toString()]=K;return!0});return J}}Object(C.a)(M,"MergeLogger",null,[])},1694:function(C,O,c){C=c(0);var l=c(243),e=c(16),a=c(5),h=c(115),m=c(791),v=c(149),u=c(216),n=c(386),x=c(1443);class A{constructor(L,M,F){this.position=L;this.leader=M;this.val=F}equals(L){return this.position===L.position&&this.leader===L.leader&&this.val===
L.val}toString(){return this.position.toString()}}Object(C.a)(A,"TabStop",null,[]);var H=c(1783);c.d(O,"a",function(){return E});class E extends x.a{constructor(){super()}get Fn(){return 20}get Kz(){return 0}nk(){const L=super.nk();L.Z(m.a.yb(e.a.mo),1);L.Z(m.a.yb(e.a.wn),1);L.Z(m.a.yb(e.a.km),1);L.Z(m.a.yb(a.a.gt),1);L.Z(m.a.yb(a.a.Iq),1);L.Z(m.a.yb(a.a.Nc),1);L.Z(m.a.yb(e.a.olb),1);L.Z(m.a.yb(a.a.gMa),1);L.Z(m.a.yb(a.a.SDa),1);L.Z(m.a.yb(e.a.Wua),1);L.Z(m.a.yb(a.a.lCa),1);L.Z(m.a.yb(a.a.lea),1);
L.Z(m.a.yb(a.a.mCa),1);L.Z(m.a.yb(a.a.GAa),1);L.Z(m.a.yb(a.a.nCa),1);L.Z(m.a.yb(a.a.HAa),1);L.Z(m.a.yb(a.a.RDa),1);L.Z(m.a.yb(a.a.mFa),1);L.Z(m.a.yb(a.a.nFa),1);L.Z(m.a.yb(a.a.Dwa),1);L.Z(m.a.yb(a.a.$u),1);L.Z(m.a.yb(a.a.Yy),1);L.Z(m.a.yb(a.a.Zy),1);L.Z(m.a.yb(a.a.Uv),1);L.Z(m.a.yb(h.a.sK),6);L.Z(m.a.yb(h.a.cRa),6);L.Z(m.a.yb(a.a.axb),7);L.Z(m.a.yb(h.a.sK),6);L.Z(m.a.yb(a.a.L7i),2);L.Z(m.a.yb(h.a.xFk),2);L.Z(m.a.yb(h.a.b4m),2);L.Z(m.a.yb(a.a.Ygc),2);L.Z(m.a.yb(a.a.T2c),2);L.Z(m.a.yb(a.a.mMb),2);L.Z(m.a.yb(a.a.imb),
2);L.Z(m.a.yb(a.a.U2c),2);L.Z(m.a.yb(a.a.V2c),2);L.Z(m.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);return L}dB(L,M){if(M===m.a.yb(e.a.mo)||M===m.a.yb(e.a.wn)||M===m.a.yb(e.a.km)||M===m.a.yb(a.a.gt)||M===m.a.yb(a.a.Iq)||M===m.a.yb(a.a.Nc)||M===m.a.yb(e.a.olb)||M===m.a.yb(a.a.gMa)||M===m.a.yb(a.a.SDa)||M===m.a.yb(e.a.Wua)||M===m.a.yb(a.a.lCa)||M===m.a.yb(a.a.lea)||M===m.a.yb(a.a.mCa)||M===m.a.yb(a.a.GAa)||M===m.a.yb(a.a.nCa)||M===m.a.yb(a.a.HAa)||M===m.a.yb(a.a.RDa)||M===m.a.yb(a.a.mFa)||
M===m.a.yb(a.a.nFa)||M===m.a.yb(a.a.Dwa)||M===m.a.yb(a.a.$u)||M===m.a.yb(a.a.AM)){var F=L.an.value.qu,J=L.an.value.Ef;M=L.Rg.value.Ef;if(L.ap.runtime.eKa.contains(F.id))return v.a.instance.Sa(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",F.id),!0;if(L.ap.runtime.Wb.NBb(1000005)&&this.w1n(L,M,J))return L.Lk=M.OG(),E.H9g(L),E.drd(L.ap,L.$d,J),!0;const I=new u.a;I.add(F);F=new u.a;F.add(J);J=new u.a;J.add(M);if(!({Um:M}=
E.Dfj(L.ap,I,J,F)).returnValue)return L.xag=!0,L.Lk=null,!1;E.H9g(L);L.Lk=M.mg(0).gm;return!0}return M===m.a.yb(a.a.Yy)||M===m.a.yb(a.a.Zy)||M===m.a.yb(a.a.Uv)?(this.oeo(L),L.zg.add(m.a.yb(a.a.Yy)),L.zg.add(m.a.yb(a.a.Zy)),L.zg.add(m.a.yb(a.a.Uv)),!0):!1}w1n(L,M,F){M=L.$d.getPropertyString(M,a.a.AM);L=L.$d.getPropertyString(F,a.a.AM);return M||L?!0:!1}oeo(L){const M=L.$d,F=L.Lk;var J=L.an.value.Ef,I=L.Rg.value.Ef;L=this.Bdf(L.an.value.qu,M);I=this.Bdf(I,M);J=this.Bdf(J,M);({jKm:J,kKm:L,lKm:I}=this.SAl(L,
I,J));J.length?(M.setPropertyUint32s(F,a.a.Uv,J),M.setPropertyUint32s(F,a.a.Yy,L),M.setPropertyUint32s(F,a.a.Zy,I)):this.zrn(F)}Bdf(L,M){const F=M.getPropertyUint32s(L,a.a.Uv),J=M.getPropertyUint32s(L,a.a.Yy);L=M.getPropertyUint32s(L,a.a.Zy);M=new u.a;if(!F)return M;for(let I=0;I<F.length;++I)M.add(new A(F.J(I),J.J(I),L.J(I)));return M}SAl(L,M,F){({kDi:M,lDi:N,mDi:K}=this.GQh(L,M));let J,I;({kDi:F,lDi:J,mDi:I}=this.GQh(L,F));L=this.iUl(L,N,K,J,I);var K=this.hUl(L,M,F);L=new u.a;M=new u.a;var N=new u.a;
for(F=0;F<K.length;++F)L.add(K.J(F).position),M.add(K.J(F).leader),N.add(K.J(F).val);return{jKm:L,kKm:M,lKm:N}}GQh(L,M){let F,J,I;F=new u.a;J=new n.a;I=new n.a;let K,N;for(K=N=0;K<L.length&&N<M.length;)L.J(K).position===M.J(N).position?(L.J(K).equals(M.J(N))||I.Z(L.J(K).position,M.J(N)),++K,++N):L.J(K).position<M.J(N).position?(J.Z(L.J(K).position,L.J(K)),++K):(F.add(M.J(N)),++N);for(;K<L.length;)J.Z(L.J(K).position,L.J(K)),++K;for(;N<M.length;)F.add(M.J(N)),++N;return{kDi:F,lDi:J,mDi:I}}iUl(L,M,
F,J,I){const K=new u.a;for(let N=0;N<L.length;++N){const G=L.J(N).position;M.ub(G)||(F.ub(G)?K.add(F.J(G)):J.ub(G)||(I.ub(G)?K.add(I.J(G)):K.add(L.J(N))))}return K}hUl(L,M,F){M=this.usi(M,F);return this.usi(L,M)}usi(L,M){const F=new u.a;let J,I;for(J=I=0;J<L.length&&I<M.length;)L.J(J).position<=M.J(I).position?(F.add(L.J(J)),L.J(J).position===M.J(I).position&&++I,++J):F.add(M.J(I++));for(;J<L.length;)F.add(L.J(J++));for(;I<M.length;)F.add(M.J(I++));return F}zrn(L){L.removeProperty(a.a.Uv);L.removeProperty(a.a.Yy);
L.removeProperty(a.a.Zy)}static nh(){return new E}static get instance(){return E.Og.value}static H9g(L){L.zg.add(m.a.yb(e.a.mo));L.zg.add(m.a.yb(e.a.wn));L.zg.add(m.a.yb(e.a.km));L.zg.add(m.a.yb(a.a.gt));L.zg.add(m.a.yb(a.a.Iq));L.zg.add(m.a.yb(a.a.Nc));L.zg.add(m.a.yb(e.a.olb));L.zg.add(m.a.yb(a.a.gMa));L.zg.add(m.a.yb(a.a.SDa));L.zg.add(m.a.yb(e.a.Wua));L.zg.add(m.a.yb(a.a.lCa));L.zg.add(m.a.yb(a.a.lea));L.zg.add(m.a.yb(a.a.mCa));L.zg.add(m.a.yb(a.a.GAa));L.zg.add(m.a.yb(a.a.nCa));L.zg.add(m.a.yb(a.a.HAa));
L.zg.add(m.a.yb(a.a.RDa));L.zg.add(m.a.yb(a.a.mFa));L.zg.add(m.a.yb(a.a.nFa));L.zg.add(m.a.yb(a.a.Dwa));L.zg.add(m.a.yb(a.a.$u));L.zg.add(m.a.yb(a.a.AM))}static Dfj(L,M,F,J){return(new H.a(L,M,F,J)).hhc()}static drd(L,M,F){F=M.getPropertyObjectIds(F,e.a.wn);for(let I=0;I<F.length;I++){var J=L.runtime.nq.J(F.mg(I));if(J&&(J=M.getPropertyObjectId(J,a.a.pe))){L.runtime.ufc.add(J);break}}}}E.Og=new l.a(E.nh);Object(C.a)(E,"ParagraphNodeComplexMerge",x.a,[])},1695:function(C,O,c){C=c(0);var l=c(77),e=
c(1451),a=c(1560),h=c(1495),m=c(1470),v=c(1510),u=c(1452),n=c(1456),x=c(1455),A=c(1449),H=c(1447);class E{constructor(X){this.qc=X;this.$md=this.Bif()}IL(){return"Add-ins"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:3}MI(X,Y){X=new x.a(X);Y.resultsUpdated(X)}Meb(X,Y,ca){let ha;ha=this.qc.uO?new n.a(26):new n.a(24);ha.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ca&&this.h0n(X.Ig,Y,ha)}h0n(X,Y,ca){const ha=[];let ra;ra=this.qc.Z$l?this.qc.uO&&this.qc.oab?H.a.Fdb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,X):this.qc.$$l?this.qc.uO&&this.qc.oab?H.a.Fdb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,X):this.qc.uO&&this.qc.oab?H.a.Fdb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,X)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,X);this.qc.KBa?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
ra)),A.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",X))):(ha.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ra)),ha.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",X)),appChrome.api.dispatch(ha));ca.Ez(new u.a("LaunchAddinDialogFromTellMe",27));Y.kw(ca)}Bif(){const X=[];this.qc.MNd&&Array.add(X,"Addin");return X}}Object(C.a)(E,"AddinStoreResultsProvider",null,[1143]);var L=c(1652),M=c(1485),
F=c(1496),J=c(1653),I=c(1681),K=c(1654),N=c(1509),G=c(2),P=c(36),S=c(121);c.d(O,"a",function(){return W});class W{constructor(X,Y,ca){this.Rvc=this.gmd=this.hmd=this.fmd=!1;this.eP=null;this.E0=-1;this.Bja=this.rwc=null;this.Iwc="";this.nrb=0;this.qc=X;const ha=H.a.OCa();this.d7a=Y||[];this.rg=G.AFrameworkApplication.af;this.G1g=X.LJf;this.imd=X.KJf;this.DHe=ha&&this.PKb();this.EHe=ha&&this.QKb();this.HWj=ha&&this.RKb();this.GHe=this.TKb();this.I1g=this.Rec();X.Q3f&&H.a.Q_f(X)&&(this.rwc=new I.a(X),
this.fmd=X.c2c,this.hmd=X.e2c,this.gmd=X.Sgb,this.Rvc=this.fmd&&this.gD("File")||this.hmd&&this.gD("People")||this.gmd&&this.gD("Notes"));this.emd=this.dXn();this.lmd=X.dUc;this.FHe=this.wXn();this.F1g=this.cXn();this.u8=this.INl();this.Awg=new L.a(X);this.DIj=new J.a(X);this.bZj=new K.a(X);this.Pwj=new E(X);this.Juc=ca;this.yGe=new a.a;this.lmd&&(this.Awg=new L.a(X))}gD(X){return Array.contains(this.d7a,X)?!0:!1}IL(){return"TellMeService"}FW(){return 0===this.qc.Nv?0:1===this.qc.Nv?1:this.gD("Command")||
this.gD("Recommended")?2:3}FNl(X){let Y="";if(!X&&this.gD("Command")&&this.qc.wsf){Y+="CommandSearch_DLIS,";var ca=this.qc.tbj;0<ca.length&&(Y+=ca+",")}X&&this.gD("Recommended")&&this.imd&&(ca=this.qc.ubj,0<ca.length&&(Y+=ca+","));!X&&this.gD("Help")&&(X=this.qc.sbj,0<X.length&&(Y+=X+","));0<Y.length&&(Y=Y.substr(0,Y.length-1));return Y}MI(X,Y,ca,ha=e.a.tellMe,ra=null){const sa=new x.a(X);ca=H.a.YW(X);if(this.Rvc&&(!this.nrb||window.performance.now()-this.nrb>=H.a.ybe)){var oa=this.yGe.JNl();if(oa)this.nrb=
window.performance.now(),oa.then(va=>{this.Iwc=va},va=>{A.TellMeActor.instance.Xe.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+va)});else if(A.TellMeActor.instance.Xe)A.TellMeActor.instance.Xe.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var ka=this.Rvc&&!!this.Iwc;oa=ka||ca&&this.gD("Recommended")&&this.imd;ka=ka||!ca&&(this.G1g&&this.gD("Command")||this.DHe&&this.gD("Answer")||this.EHe&&this.gD("Definition")||this.I1g&&this.gD("Image")||
this.lmd&&this.gD("Help")||this.GHe&&this.gD("WolframAnswer")||this.FHe&&this.gD("Template")||this.F1g&&this.gD("Addin"));if(oa||ka)if(this.Bja=ha,ha={"Content-Type":"application/json",Accept:"application/json"},ha["X-Office-Version"]=G.AFrameworkApplication.buildVersion,ha["X-Office-Application"]=G.AFrameworkApplication.K.lb("Application"),ha["X-Office-Platform"]="WAC",ha["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.lb("LoggableUserId")||"",ha["X-TellMe-SessionId"]=A.TellMeActor.instance.JId(),
this.Iwc&&(ha.Authorization="Bearer "+this.Iwc),oa=this.FNl(ca),0<oa.length&&(ha["X-TellMe-Flights"]=oa),oa=[],!ca&&this.gD("Answer")&&this.DHe&&(ra?Array.contains(ra,9):1)&&Array.add(oa,"Answer"),!ca&&this.gD("Command")&&this.G1g&&!M.CommandResultsUtility.Xpf(X.Ig)&&(ra?Array.contains(ra,17):1)&&Array.add(oa,"Command"),!ca&&this.gD("Definition")&&this.EHe&&(ra?Array.contains(ra,10):1)&&Array.add(oa,"Definition"),!ca&&this.gD("Help")&&this.lmd&&(ra?Array.contains(ra,8):1)&&Array.add(oa,"Help"),!ca&&
this.gD("WolframAnswer")&&this.GHe&&(ra?Array.contains(ra,12):1)&&Array.add(oa,"WolframAnswer"),ca&&this.gD("Recommended")&&this.imd&&!A.TellMeActor.instance.u4c&&(ra?Array.contains(ra,18):1)&&Array.add(oa,"Recommended"),!ca&&this.gD("Image")&&this.I1g&&(ra?Array.contains(ra,19):1)&&Array.add(oa,"Image"),this.Iwc&&this.Rvc&&(ra?Array.contains(ra,14)||Array.contains(ra,15)||Array.contains(ra,20):1)&&(this.rwc.Ncc(),this.fmd&&this.gD("File")&&Array.add(oa,"File"),this.hmd&&this.gD("People")&&Array.add(oa,
"People"),this.gmd&&this.gD("Notes")&&Array.add(oa,"Notes")),!ca&&this.gD("Template")&&this.FHe&&(ra?Array.contains(ra,23):1)&&Array.add(oa,"Template"),!ca&&this.gD("Addin")&&this.F1g&&(ra?Array.contains(ra,24):1)&&Array.add(oa,"Addin"),oa.length){ha["X-TellMe-SuggestionTypes"]=oa.join(",");ha["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;ha["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;var ia=this.eP=S.a.create().toString();ha["Client-Request-Id"]=ia;var La=window.performance.now();
this.Xza();this.E0=window.setTimeout(()=>{if(ia===this.eP){this.eP="";this.E0=-1;Y.resultsUpdated(sa);const va={};va[h.a.provider]=this.IL();va[h.a.pIb]=X.zjb;A.TellMeActor.instance.Xe.Yz(m.a.timedOut,this.Juc,va)}},this.Juc);this.rg.Mj(this.u8,2,this.HNl(X.Ig),ha,!1,0,va=>{this.eHb(va,X,Y,ia,La,ra)},va=>{this.RGb(va,X,Y,ia,La)},null,null,!1,4E3,6E3)}else A.TellMeActor.instance.Xe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),Y.resultsUpdated(sa);else Y.resultsUpdated(sa)}Xza(){-1!==
this.E0&&(window.clearTimeout(this.E0),this.E0=-1)}eHb(X,Y,ca,ha,ra,sa){const oa=new x.a(Y);if(ha===this.eP){this.Xza();A.TellMeActor.instance.Xe.l7(Y.Ig.length,this.d7a.join(","),X.data.Df.toString(),Math.round(window.performance.now()-ra),N.a.tellMe,!0,v.a.vMa);ha=X.data.Ie;X=null;try{X=P.b(ha)}catch(Oa){A.TellMeActor.instance.Xe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Oa);return}ha=H.a.YW(Y);if("Groups"in X&&X.Groups){var ka=X.Groups;for(var ia of ka)if("GroupType"in
ia&&"Suggestions"in ia&&ia.Suggestions)if("Commands"===ia.GroupType&&(sa?Array.contains(sa,17):1)||"Recommended"===ia.GroupType&&(sa?Array.contains(sa,18):1)){var La=(ka="Recommended"===ia.GroupType)?"DLIS":"NaiveBayes";"Source"in ia&&ia.Source&&(La=ia.Source);var va=ia.Suggestions;new l.a;var Ga=[];for(const Oa of va)this.Som(Oa)&&(va=Oa.Type,("Command"===va||ka&&"Recommended"===va)&&Ga.push(new F.a(Oa.CommandId,Oa.Score)));M.CommandResultsUtility.ITd(Ga,!Y.Ig.trim().length,ia.GroupType,La);La=A.TellMeActor.instance.f1;
va=[];for(const Oa of Ga)ka&&La&&La.uZe(Oa.commandId)||va.push(Oa);Ga=M.CommandResultsUtility.$Hd(Y,va,this.qc,null,null,null,ka?18:17,0);0<Ga.results.length&&(this.Bja!==e.a.contextMenu&&(Ga.displayName=ka?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),oa.kw(Ga))}else if("Answer"===ia.GroupType){va=ia.Suggestions;ka=null;Ga=2147483647;La="";for(const Oa of va)if(this.Rom(Oa))if(La=Oa.Type,va=this.OHd(La),"Answer"===La&&this.DHe){ka=this.twh(La,Oa,Y.Ig);break}else va&&
va<Ga&&(Ga=va,ka=this.twh(La,Oa,Y.Ig));Ga=H.a.KAn(Y.Ig,La);ka&&(sa?Array.contains(sa,ka.type):1)&&(La=[],this.emd?this.qc.KBa?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ka.value,ka.cC)),A.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ka.value,ka.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ka.value,Ga))):(La.push(appChrome.actions.setControlLabel(ka.value,ka.cC)),La.push(appChrome.actions.updateCompoundButtonDescription(ka.value,
ka.description)),La.push(appChrome.actions.setCompoundButtonCommandValueId(ka.value,Ga)),appChrome.api.dispatch(La)):this.qc.KBa?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ka.value,ka.cC+" - "+ka.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ka.value,Ga))):(La.push(appChrome.actions.setControlLabel(ka.value,ka.cC+" - "+ka.description)),La.push(appChrome.actions.setButtonCommandValueId(ka.value,Ga)),appChrome.api.dispatch(La)),
Ga=this.hPk(ka.type),Ga.Ez(ka),oa.kw(Ga))}else"Help"===ia.GroupType&&ia.Suggestions.length&&(sa?Array.contains(sa,8):1)?this.lmd&&(ka=this.Awg.Meb(Y,ia.Suggestions))&&0<ka.results.length&&oa.kw(ka):"Template"===ia.GroupType&&(sa?Array.contains(sa,23):1)?(ka=ia.Suggestions)&&0<ka.length&&this.bZj.Meb(Y,oa,ka):"Addin"===ia.GroupType&&(sa?Array.contains(sa,24):1)?(ka=ia.Suggestions)&&0<ka.length&&this.Pwj.Meb(Y,oa,ka):"Substrate"===ia.GroupType&&this.Rvc&&"Type"in ia&&("File"===ia.Type&&this.fmd&&(sa?
Array.contains(sa,15):1)?(ka=this.rwc.WRh(ia.Suggestions,ha,this.Bja))&&0<ka.results.length&&oa.kw(ka):"People"===ia.Type&&this.hmd&&(sa?Array.contains(sa,14):1)?(ka=this.rwc.MXh(ia.Suggestions,ha,this.Bja))&&0<ka.results.length&&oa.kw(ka):"Notes"===ia.Type&&this.gmd&&(sa?Array.contains(sa,14):1)&&(ka=this.rwc.wWh(ia.Suggestions,ha,Y))&&0<ka.results.length&&oa.kw(ka));else A.TellMeActor.instance.Xe.onError("OnSuccessCallBack","GroupType"in ia?"Invalid group suggestions found for "+ia.GroupType:"Invalid group found")}if(X.Intents){ia=
X.Intents;for(const Oa of ia)this.Puf(Oa)&&("Image"===Oa.GroupType&&Oa.ConfidenceScore>Oa.ConfidenceThreshold&&(sa?Array.contains(sa,19):1)?this.DIj.Meb(Y,oa,0,Oa):"Commands"===Oa.GroupType&&Oa.ConfidenceScore<Oa.ConfidenceThreshold&&(sa?Array.contains(sa,17):1)&&(ia=new n.a(17),oa.kw(ia)))}ca.resultsUpdated(oa);A.TellMeActor.instance.Xe.l7(Y.Ig.length,this.d7a.join(","),"",Math.round(window.performance.now()-ra),"",!0,v.a.provider)}}RGb(X,Y,ca,ha,ra){const sa=new x.a(Y);ha===this.eP&&(this.Xza(),
A.TellMeActor.instance.Xe.l7(Y.Ig.length,this.d7a.join(","),X.data.Df.toString(),Math.round(window.performance.now()-ra),N.a.tellMe,!1,v.a.vMa));ca.resultsUpdated(sa)}OHd(X){switch(X){case "Entity":return this.HWj?3:0;case "Definition":return this.EHe?5:0;case "WolframAnswer":return this.GHe?2:0;default:return 0}}twh(X,Y,ca){switch(X){case "Answer":return new u.a(this.emd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===Y.Title?ca:Y.Title,Y.Description,0);case "Entity":return new u.a(this.emd?
"AnswerForSearch":"AnswerForSearchSingleLine",2,""===Y.Title?ca:Y.Title,Y.Description,0);case "Definition":return new u.a(this.emd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===Y.Title?ca:Y.Title,Y.Description,0);case "WolframAnswer":return new u.a("WolframForSearch",3,""===Y.Title?ca:Y.Title,Y.Description,0);default:return null}}hPk(X){switch(X){case 0:return new n.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new n.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new n.a(10,
CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new n.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new n.a(19,this.qc.Mec?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}Rom(X){return"Type"in X&&!!X.Type&&""!==X.Type&&"Description"in X&&!!X.Description&&""!==X.Description}Som(X){return"Type"in X&&!!X.Type&&""!==X.Type&&"CommandId"in X&&!!X.CommandId&&""!==X.CommandId&&"Score"in X&&!!X.Score}Puf(X){if("GroupType"in X&&X.GroupType&&"ConfidenceScore"in
X&&"ConfidenceThreshold"in X)return!0;A.TellMeActor.instance.Xe.onError("IsValidIntentGroup","Invalid intents found");return!1}HNl(X){const Y=H.a.Oii(X),ca={};ca.Query=X;Y&&this.imd&&(ca.CommandClickedEvents=A.TellMeActor.instance.Yke,ca.CommandActionEvents=A.TellMeActor.instance.Nzg,ca.TellMeCommandClickMruEvents=A.TellMeActor.instance.DSg,ca.ContentType=A.TellMeActor.instance.tyd);this.FHe&&(X={},X.Application=this.qc.application,ca.TemplateInfo=X);return P.c(ca)}PKb(){return!!this.qc&&this.qc.PKb||
!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Rb.PKb}QKb(){return!!this.qc&&this.qc.QKb||!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Rb.QKb}RKb(){return!!this.qc&&this.qc.RKb||!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Rb.RKb}TKb(){return!!this.qc&&this.qc.TKb||!!G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Rb.TKb}Rec(){return!!this.qc&&(this.qc.Rec||this.qc.uO)}dXn(){return!!this.qc&&!this.qc.$_a}wXn(){return!!this.qc&&this.qc.EPc}cXn(){return!!this.qc&&
this.qc.aam&&this.qc.Y$l}yji(){return!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}zji(){return!!G.AFrameworkApplication.K&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}INl(){if(!G.AFrameworkApplication.K)return"";if(this.zji())return G.AFrameworkApplication.K.lb("TellMeServiceProdEndpointForSearch");if(this.yji())return G.AFrameworkApplication.K.lb("TellMeServiceEdogEndpointForSearch");
if(H.a.zqf())return G.AFrameworkApplication.K.lb("TellMeServiceIntEndpointForSearch");let X=G.AFrameworkApplication.K.lb("TellMeServiceSearchEndpoint");X&&""!==X||(X=G.AFrameworkApplication.rbj);return X}static Vwh(X,Y){if(Y)return new W(X,["Command","Recommended"],X.itl);Y=H.a.OCa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");return new W(X,Y,X.F_h)}}Object(C.a)(W,"TellMeServiceProvider",
null,[1143])},1782:function(C,O,c){c.r(O);c.d(O,"MarkerValidation",function(){return a});C=c(0);var l=c(386),e=c(1693);class a{constructor(){this.pNd=this.xai=this.wai=this.vai=0}WQh(){const h=new l.a(0);h.Z("InvalidBookmarks",this.vai);h.Z("InvalidComments",this.wai);h.Z("InvalidContentControls",this.xai);0!==this.pNd&&h.Z("InvalidMarkerType",this.pNd);return h}p5h(){return 0<this.vai||0<this.wai||0<this.xai||0!==this.pNd?!0:!1}toString(){return JSON.stringify(e.a.Ywa(this.WQh()))}}Object(C.a)(a,
"MarkerValidation",null,[])},1783:function(C,O,c){c.d(O,"a",function(){return v});C=c(0);var l=c(149),e=c(1006),a=c(249),h=c(1575),m=c(1513);class v{constructor(u,n,x,A,H=null,E=null,L=null,M=null){this.ge=u;this.EE=n;this.Txa=x;this.dza=A;this.aOj=H;this.FEj=E;this.p_j=L;this.Vpa=M||this.$_e()}$_e(){return u=>!!this.ge.runtime.Wb&&this.ge.runtime.Wb.isFeatureEnabled(u)}jLk(){return()=>this.ge.runtime.Wb}M5e(){return!!this.ge.runtime.lk.J(a.a.KK)}e8i(){let u;if(1===this.ge.input.source||2===this.ge.input.source)u=
83;else if(4===this.ge.input.source||3===this.ge.input.source)u=38;else if(5===this.ge.input.source)u=126;else return!1;return this.M5e()&&this.Vpa(u)}g$i(u,...n){return String.format.apply(null,[u].concat(n))}sHd(u){const {ParagraphMerge:n}=c(1825);let x=this.ge,A=this.Txa,H=this.dza;u||(x=this.aOj||this.ge,A=this.FEj||A,H=this.p_j||H);var E=m.a.bgf(this.EE);const L=m.a.bgf(A),M=m.a.bgf(H);E=this.g$i("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
x.input.source,x.runtime.dAa.id,x.runtime.kCd,x.runtime.Cce,E.Fq(),L.Fq(),M.Fq());return u?{returnValue:new h.a(x,this.EE,A,H,this.$_e(),new e.a),Fq:E}:{returnValue:new n(x,this.EE,A,H,this.$_e(),this.jLk(),new e.a),Fq:E}}hhc(){this.ge.logger.oPn();var u=this.e8i();var n=({Fq:A}=this.sHd(u)).returnValue;l.a.instance.Sa(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",u,A);this.ge.logger.ZT("ParagraphMergeSelector initialization");u?this.ge.logger.r7d(1):this.ge.logger.r7d(2);
let x=({Um:n}=n.hhc()).returnValue;this.ge.logger.hZf();var A=!x;u=!!this.ge.runtime.lk.J(a.a.KK)&&(u&&!x||!u);A&&({Fq:A,returnValue:n}=this.sHd(!1),{Um:n,returnValue:x}=n.hhc(),l.a.instance.Sa(18994390,1,x?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",x,A));u&&(A=new e.a,m.a.zzn(this.ge,A));this.ge.logger.ZT("ParagraphMergeSelector finalization");return{returnValue:x,Um:n}}F3c(u,n){let x,A,H;const E=this.e8i()&&this.Vpa(127);let L=({Fq:H}=this.sHd(E)).returnValue,M=({C2a:x,
aoa:A}=L.F3c(u,n)).returnValue;l.a.instance.Sa(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",E,H);E&&!M&&L.wVf&&({Fq:H,returnValue:L}=this.sHd(!1),{C2a:x,aoa:A,returnValue:M}=L.F3c(u,n),l.a.instance.Sa(18994392,1,M?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",M,H));return{returnValue:M,C2a:x,aoa:A}}}Object(C.a)(v,"ParagraphMergeSelector",null,[1865])},1784:function(C,O,c){c.r(O);c.d(O,"SurfaceStringTokenStringGenerator",
function(){return e});C=c(0);var l=c(1532);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,h,m,v,u,n,x){null==n&&(n=a.F1h(u,h));x=l.a.J$g(a,n,this.Bb.score,m,v,x);return{E2c:n,hAc:x}}}e.iAc=0;Object(C.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1785:function(C,O,c){c.r(O);c.d(O,"QueryTokenStringGenerator",function(){return a});C=c(0);var l=c(1532),e=c(1444);class a extends l.a{constructor(h){super(h);this.Bb=h}apply(h,m,v,u,n,x,A){m=this.Bb.query.load(m,null);n=0;let H=null;this.Bb.query.D3===
e.Annotations.Fwa?m&&(H=this.Bb.name):((H=this.Bb.name)&&(H+="_"),H+=this.Bb.annotations.Zba(this.Bb.query.D3,m));null!=H&&(n=l.a.J$g(h,H,this.Bb.score,v,u,n));return{E2c:x,hAc:A+n}}}a.iAc=1;Object(C.a)(a,"QueryTokenStringGenerator",l.a,[])},1786:function(C,O,c){c.r(O);c.d(O,"FuzzyMatchTokenStringGenerator",function(){return e});C=c(0);var l=c(1532);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,h,m,v,u,n,x){null==n&&(n=a.F1h(u,h));a=this.Bb.oGh.ZEm(n);if(this.Bb.ECi)for(var A of a)if(!A.IN&&
A.fDd)return{E2c:n,hAc:x};A=0;for(const H of a)if(H.IN&&!({kVe:A}=this.Neh(H,!0,m,v,A)).returnValue)return{E2c:n,hAc:x};if(this.Bb.A8h)for(const H of a)if(!({kVe:A}=this.Neh(H,!1,m,v,A)).returnValue)break;return{E2c:n,hAc:x}}Neh(a,h,m,v,u){let n;h?(h=0,n=a.fDd?1:0):(h=a.fDd?1:0,n=a.count-h);for(let x=0;x<n;++x)if(l.a.K$g(a.edb+h+x,this.Bb.score,m,v),++u,0<this.Bb.Yzf&&u>=this.Bb.Yzf)return{returnValue:!1,kVe:u};return{returnValue:!0,kVe:u}}}e.iAc=2;Object(C.a)(e,"FuzzyMatchTokenStringGenerator",l.a,
[])},1815:function(C,O,c){C=c(0);var l=c(5),e=c(45),a=c(243),h=c(1443);class m extends h.a{constructor(){super()}get Fn(){return 2}get Kz(){return 7}static nh(){return new m}static get instance(){return m.Og.value}}m.Og=new a.a(m.nh);Object(C.a)(m,"AppBindingNodeComplexMerge",h.a,[]);var v=c(16),u=c(791),n=c(149),x=c(1484);class A extends h.a{constructor(){super()}get Fn(){return 3}get Kz(){return 7}nk(){const Gb=super.nk();Gb.Z(u.a.yb(v.a.WT),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(v.a.WT)){const ob=
Gb.Lk;var Fc=Gb.$d;n.a.instance.Sa(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ob.id,ob.Qc,pc);pc=Fc.getPropertyMilliseconds(Gb.Rg.value.Ef,v.a.WT);Fc=Fc.getPropertyMilliseconds(Gb.an.value.Ef,v.a.WT);pc<Fc&&this.rol(Gb);Gb.zg.add(u.a.yb(v.a.WT));return!0}n.a.instance.Sa(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}rol(Gb){this.vwn(Gb.an.value.Ef,
Gb.Lk);this.Qcf(Gb,l.a.hRe);this.Qcf(Gb,l.a.Tch);this.Qcf(Gb,l.a.Ich)}Qcf(Gb,pc){var Fc=Gb.$d,ob=Gb.Lk;if(Fc.hasProperty(ob,pc)&&(pc=Fc.getPropertyObjectIds(ob,pc))&&pc.length)for(Fc=Gb.ap.runtime.nq,Gb=Gb.ap.runtime.Um,ob=0;ob<pc.length;ob++){const Fb=pc.J(ob);if(!Fc.ub(Fb))continue;const gb=Fc.J(Fb).OG();Gb.add(Fb,new x.a(gb,!1))}}static nh(){return new A}static get instance(){return A.Og.value}}A.Og=new a.a(A.nh);Object(C.a)(A,"AppNodeComplexMerge",h.a,[]);class H extends h.a{constructor(){super()}get Fn(){return 4}get Kz(){return 7}static nh(){return new H}static get instance(){return H.Og.value}}
H.Og=new a.a(H.nh);Object(C.a)(H,"AppPropNodeComplexMerge",h.a,[]);class E extends h.a{constructor(){super()}get Fn(){return 5}get Kz(){return 7}static nh(){return new E}static get instance(){return E.Og.value}}E.Og=new a.a(E.nh);Object(C.a)(E,"AppRefNodeComplexMerge",h.a,[]);var L=c(386),M=c(619),F=c(216),J=c(17);class I{constructor(Gb,pc){this.id=Gb;this.S3n=pc}}Object(C.a)(I,"IdAndTime",null,[]);class K extends h.a{constructor(){super()}get Fn(){return 6}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.QVa),
1);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.QVa)){const Fc=Gb.Lk,ob=Gb.$d;n.a.instance.Sa(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fc.id,Fc.Qc,pc);pc=ob.getPropertyObjectIds(Gb.Rg.value.qu,l.a.QVa);const Fb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.QVa),gb=ob.getPropertyObjectIds(Gb.an.value.Ef,l.a.QVa);pc=this.hJm(Gb,pc,Fb,gb);0<pc.length?ob.setPropertyObjectIds(Fc,l.a.QVa,pc):Fc.removeProperty(l.a.QVa);Gb.zg.add(u.a.yb(l.a.QVa));
return!0}n.a.instance.Sa(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}hJm(Gb,pc,Fc,ob){const Fb=this.fDa(pc,Fc,ob),gb=pc.iG(),Jb=Fc.iG(),Yb=ob.iG();pc=h.a.filter(Fb,Vc=>!gb.contains(Vc)&&Jb.contains(Vc));Fc=h.a.filter(Fb,Vc=>!gb.contains(Vc)&&Yb.contains(Vc));if(!pc.length||!Fc.length)return Fb;const tc=new L.a;pc.forEach(Vc=>{const Hd=new I(Vc,this.HNh(Gb,Vc,!1));this.DNh(Gb,Vc,!1).forEach(qd=>
{tc.add(qd,Hd);return!0});return!0});const Ec=new M.a;Fc.forEach(Vc=>{const Hd=this.HNh(Gb,Vc,!0);this.DNh(Gb,Vc,!0).forEach(qd=>tc.ub(qd)?(Ec.add(tc.J(qd).S3n>=Hd?Vc:tc.J(qd).id),!1):!0);return!0});return h.a.filter(Fb,Vc=>!Ec.contains(Vc))}HNh(Gb,pc,Fc){return(pc=this.zta(Gb,pc,Fc))?Gb.$d.getPropertyMilliseconds(pc,v.a.WT):0}zta(Gb,pc,Fc){Gb=Fc?Gb.ap.runtime.nq:Gb.ap.runtime.du;return Gb.ub(pc)?Gb.J(pc):null}DNh(Gb,pc,Fc){const ob=new F.a,Fb=new M.a,gb=Gb.$d;pc=this.zta(Gb,pc,Fc);var Jb=this.ZYh(gb,
pc);if(Jb)for(ob.add(Jb),Fb.add(Jb),pc=gb.getPropertyObjectIds(pc,l.a.hRe),Jb=0;pc&&Jb<pc.length;Jb++){const Yb=this.ZYh(gb,this.zta(Gb,pc.J(Jb),Fc));if(!Yb)break;Fb.contains(Yb)||(ob.add(Yb),Fb.add(Yb))}return ob}ZYh(Gb,pc){if(!Gb.hasProperty(pc,l.a.gab)||!Gb.hasProperty(pc,l.a.RXb)||!Gb.hasProperty(pc,l.a.SXb))return null;const Fc=Gb.getPropertyString(pc,l.a.gab),ob=Gb.getPropertyString(pc,l.a.RXb);Gb=Gb.getPropertyString(pc,l.a.SXb);return J.a.cA(Fc+";"+ob+";"+Gb)}static nh(){return new K}static get instance(){return K.Og.value}}
K.Og=new a.a(K.nh);Object(C.a)(K,"AppsNodeComplexMerge",h.a,[]);class N extends h.a{constructor(){super()}get Fn(){return 36}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.$8f),1);Gb.Z(u.a.yb(l.a.tZf),1);return Gb}dB(Gb,pc){n.a.instance.Sa(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",pc);if(pc===u.a.yb(l.a.$8f)||pc===u.a.yb(l.a.tZf)){const gb=u.a.yW(pc);var Fc=Gb.Rg.value.Ef,ob=Gb.an.value.Ef;const Jb=Gb.Lk;var Fb=Gb.$d.getPropertyStrings(Gb.Rg.value.qu,gb);Fc=Gb.$d.getPropertyStrings(Fc,
gb);ob=Gb.$d.getPropertyStrings(ob,gb);Fb=this.fDa(Fb,Fc,ob);Gb.$d.setPropertyStrings(Jb,gb,Fb);Gb.zg.add(pc);return!0}return!1}static nh(){return new N}static get instance(){return N.Og.value}}N.Og=new a.a(N.nh);Object(C.a)(N,"AutoSaveParametersNodeComplexMerge",h.a,[]);class G extends h.a{constructor(){super()}get Fn(){return 44}nk(){const Gb=super.nk();Gb.Z(u.a.yb(v.a.$e),1);return Gb}dB(Gb,pc){const Fc=Gb.ap.runtime.Wb;if(pc===u.a.yb(v.a.$e))return n.a.instance.Sa(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Gb.Lk.id,Gb.Lk.Qc,pc),Fc.Lt(132),Fc.isFeatureEnabled(132)?this.kJm(Gb,pc):this.GJm(Gb,pc),!0;n.a.instance.Sa(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}kJm(Gb,pc){const Fc=u.a.yW(pc),ob=Gb.$d;var Fb=ob.getPropertyObjectIds(Gb.Rg.value.qu,Fc),gb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,Fc),Jb=ob.getPropertyObjectIds(Gb.an.value.Ef,Fc);Jb=G.CPl(Gb,gb,Jb);Fb=this.fDa(Fb,gb,
Jb);gb=Gb.Lk;0<Fb.length?ob.setPropertyObjectIds(gb,Fc,Fb):gb.removeProperty(Fc);Gb.zg.add(pc)}static nh(){return new G}static get instance(){return G.Og.value}static CPl(Gb,pc,Fc){const ob=new F.a,Fb=new L.a;pc.forEach(gb=>{const Jb=Gb.ap.runtime.du.J(gb);Jb&&Fb.add(Jb.dQ(l.a.Rs).toString(),gb);return!0});Fc.forEach(gb=>{var Jb=Gb.ap.runtime.nq.J(gb);Jb?(Jb=Jb.dQ(l.a.Rs).toString(),Fb.ub(Jb)&&Fb.get(Jb)!==gb?n.a.instance.Sa(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
ob.add(gb)):ob.add(gb);return!0});return ob}}G.Og=new a.a(G.nh);Object(C.a)(G,"BookmarkContainerNodeComplexMerge",h.a,[]);class P extends h.a{constructor(){super()}get Fn(){return 41}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.qwb),1);Gb.Z(u.a.yb(l.a.Rs),1);return Gb}dB(Gb,pc){return pc===u.a.yb(l.a.qwb)?(Gb.zg.add(u.a.yb(l.a.qwb)),!0):pc===u.a.yb(l.a.Rs)?(Gb.zg.add(u.a.yb(l.a.Rs)),!0):!1}lf(Gb){return Gb&&Gb.length?!1:!0}static nh(){return new P}static get instance(){return P.Og.value}}P.Og=new a.a(P.nh);
Object(C.a)(P,"BookmarkNodeComplexMerge",h.a,[]);class S extends h.a{constructor(){super();this.kOd=!1}get Fn(){return 7}nk(){const Gb=super.nk();Gb.Z(u.a.yb(v.a.$e),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(v.a.$e)){const Fb=Gb.Lk,gb=Gb.$d;var Fc=Gb.ap.runtime.Wb;Fc&&(this.kOd=Fc.isFeatureEnabled(77));n.a.instance.Sa(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fb.id,Fb.Qc,pc);pc=gb.getPropertyObjectIds(Gb.Rg.value.qu,v.a.$e);
Fc=gb.getPropertyObjectIds(Gb.Rg.value.Ef,v.a.$e);var ob=gb.getPropertyObjectIds(Gb.an.value.Ef,v.a.$e);pc=this.uJm(pc,Fc,ob);if(this.kOd&&0<pc.length){Fc=new Sys.StringBuilder;for(ob=0;ob<pc.length;ob++)Fc.append(pc.J(ob).toString()+",");n.a.instance.Sa(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Fb.id,Fc.toString())}0<pc.length?gb.setPropertyObjectIds(Fb,v.a.$e,pc):Fb.removeProperty(v.a.$e);Gb.zg.add(u.a.yb(v.a.$e));return!0}n.a.instance.Sa(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Gb.Rg.value.Ef.id,pc);return!1}uJm(Gb,pc,Fc){const ob=new F.a,Fb=new L.a(0);this.U9k(Gb,Fc,ob,Fb);return this.RWk(pc,Fb,ob)}U9k(Gb,pc,Fc,ob){Gb=Gb||new F.a;pc=pc||new F.a;Gb.forEach(Fb=>{ob.Z(Fb,1);return!0});pc.forEach(Fb=>{ob.Bc(Fb).returnValue?ob.Z(Fb,2):(ob.Z(Fb,0),Fc.add(Fb));return!0})}RWk(Gb,pc,Fc){Gb=Gb||new F.a;const ob=new F.a,Fb=new F.a,gb=new F.a;Gb.forEach(Jb=>{let Yb=!0,tc;({value:tc}=pc.Bc(Jb)).returnValue&&(0===tc?pc.Z(Jb,2):1===tc&&(Yb=!1));Yb?ob.add(Jb):this.kOd&&Fb.add(Jb);return!0});
Fc.forEach(Jb=>{let Yb=!1,tc;({value:tc}=pc.Bc(Jb)).returnValue?0===tc&&(Yb=!0,pc.Z(Jb,2)):n.a.instance.Sa(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Jb);Yb?ob.add(Jb):this.kOd&&gb.add(Jb);return!0});this.Moi(Fb,"Favored");this.Moi(gb,"Unfavored");return ob}Moi(Gb,pc){if(Gb.length){var Fc=new Sys.StringBuilder;for(let ob=0;ob<Gb.length;ob++)Fc.append(Gb.J(ob).toString()+",");n.a.instance.Sa(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",pc,Fc.toString())}}static nh(){return new S}static get instance(){return S.Og.value}}S.Og=new a.a(S.nh);Object(C.a)(S,"CommentContentNodeComplexMerge",h.a,[]);class W extends h.a{constructor(){super()}get Fn(){return 8}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.a$),3);Gb.Z(u.a.yb(l.a.hE),3);Gb.Z(u.a.yb(l.a.EBc),2);Gb.Z(u.a.yb(l.a.commentId),2);Gb.Z(u.a.yb(l.a.Cqh),2);Gb.Z(u.a.yb(l.a.aAa),2);Gb.Z(u.a.yb(l.a.qKa),1);Gb.Z(u.a.yb(l.a.Xeb),
1);Gb.Z(u.a.yb(l.a.agb),1);Gb.Z(u.a.yb(l.a.T5),1);Gb.Z(u.a.yb(l.a.NF),1);Gb.Z(u.a.yb(l.a.DBc),2);Gb.Z(u.a.yb(l.a.Lvd),2);Gb.Z(u.a.yb(l.a.GZb),2);Gb.Z(u.a.yb(l.a.AYe),2);Gb.Z(u.a.yb(l.a.uL),1);Gb.Z(u.a.yb(v.a.$e),0);Gb.Z(u.a.yb(l.a.QG),0);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.uL)){var Fc=Gb.$d.getPropertyString(Gb.an.value.Ef,l.a.uL);this.lf(Fc)?Gb.Lk.removeProperty(l.a.uL):Gb.Lk.jwa(l.a.uL,Fc);return!0}if(pc!==u.a.yb(l.a.qKa)&&pc!==u.a.yb(l.a.Xeb)&&pc!==u.a.yb(l.a.agb)&&pc!==u.a.yb(l.a.NF)&&pc!==
u.a.yb(l.a.T5))return!1;var ob=Gb.Rg.value.Ef,Fb=Gb.an.value.Ef;Fc=Gb.Lk;if(pc===u.a.yb(l.a.qKa)){ob=Gb.$d.getPropertyString(ob,l.a.qKa);Fb=Gb.$d.getPropertyString(Fb,l.a.qKa);Fb=this.lf(ob)?Fb:this.lf(Fb)?ob:null;if(this.lf(Fb))return!0;Gb.$d.setPropertyString(Fc,l.a.qKa,Fb);Gb.zg.add(u.a.yb(l.a.qKa));return!0}if(pc===u.a.yb(l.a.agb))return ob=Gb.$d.getPropertyBool(ob,l.a.agb),Fb=Gb.$d.getPropertyBool(Fb,l.a.agb),ob=null!=ob?ob:!1,ob=(null!=Fb?Fb:!1)||ob,Gb.$d.setPropertyBool(Fc,l.a.agb,ob),Gb.zg.add(u.a.yb(l.a.agb)),
!0;if(pc===u.a.yb(l.a.Xeb)){ob=Gb.$d.getPropertyBool(ob,l.a.Xeb);Fb=Gb.$d.getPropertyBool(Fb,l.a.Xeb);if(ob===Fb)return!0;ob=null!=ob?ob:!1;ob=(null!=Fb?Fb:!1)||ob;Gb.$d.setPropertyBool(Fc,l.a.Xeb,ob);return!0}if(pc===u.a.yb(l.a.NF)){ob=Gb.$d.getPropertyBool(ob,l.a.NF);Fb=Gb.$d.getPropertyBool(Fb,l.a.NF);if(ob===Fb)return!0;ob=null!=ob?ob:!1;ob=(null!=Fb?Fb:!1)||ob;Gb.$d.setPropertyBool(Fc,l.a.NF,ob);Gb.zg.add(u.a.yb(l.a.NF));return!0}if(pc===u.a.yb(l.a.T5)){pc=Gb.ap.runtime.Wb;pc.Lt(15);if(!pc.isFeatureEnabled(15))return!1;
ob=Gb.$d.getPropertyString(ob,l.a.T5);Fb=Gb.$d.getPropertyString(Fb,l.a.T5);if(ob===Fb)return!0;Gb.$d.setPropertyString(Fc,l.a.T5,Fb||ob);Gb.zg.add(u.a.yb(l.a.T5));return!0}return!1}lf(Gb){return Gb&&Gb.length?!1:!0}static nh(){return new W}static get instance(){return W.Og.value}}W.Og=new a.a(W.nh);Object(C.a)(W,"CommentNodeComplexMerge",h.a,[]);class X extends h.a{constructor(){super()}get Fn(){return 46}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.contentControlNode),1);Gb.Z(u.a.yb(v.a.lastModifiedTime),
0);Gb.Z(u.a.yb(l.a.hCc),2);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.contentControlNode))return n.a.instance.Sa(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gb.Lk.id,Gb.Lk.Qc,pc),h.a.sAf(Gb,this,l.a.contentControlNode);n.a.instance.Sa(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}static nh(){return new X}static get instance(){return X.Og.value}}
X.Og=new a.a(X.nh);Object(C.a)(X,"ContentControlContainerNodeComplexMerge",h.a,[]);var Y=c(59),ca=c(1682);class ha extends h.a{constructor(){super()}get Fn(){return 37}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.V5),1);Gb.Z(u.a.yb(l.a.cmb),1);Gb.Z(u.a.yb(l.a.Ewd),2);Gb.Z(u.a.yb(l.a.WZb),2);Gb.Z(u.a.yb(l.a.contentControlNode),1);Gb.Z(u.a.yb(l.a.I6),1);Gb.Z(u.a.yb(l.a.Yda),1);Gb.Z(u.a.yb(l.a.$Zb),1);Gb.Z(u.a.yb(l.a.ZZb),1);Gb.Z(u.a.yb(l.a.vbb),1);Gb.Z(u.a.yb(l.a.ubb),1);Gb.Z(u.a.yb(l.a.LZe),2);Gb.Z(u.a.yb(l.a.iCc),
1);Gb.Z(u.a.yb(l.a.Fwd),1);Gb.Z(u.a.yb(l.a.U5),1);this.Wb.isFeatureEnabled(26)&&(Gb.Z(u.a.yb(l.a.L6),2),Gb.Z(u.a.yb(l.a.Esa),2),Gb.Z(u.a.yb(l.a.Pka),2),Gb.Z(u.a.yb(l.a.K2),1),Gb.Z(u.a.yb(l.a.ima),1),Gb.Z(u.a.yb(l.a.jma),1));return Gb}dB(Gb,pc){var Fc=Gb.Rg.value.Ef,ob=Gb.an.value.Ef;const Fb=Gb.Lk;if(pc===u.a.yb(l.a.contentControlNode))return h.a.sAf(Gb,this,l.a.contentControlNode);if(pc===u.a.yb(l.a.I6)){pc=Gb.$d.getPropertyBool(Fc,l.a.I6);ob=Gb.$d.getPropertyBool(ob,l.a.I6);if(null!=pc&&pc||null!=
ob&&ob)Gb.$d.setPropertyBool(Fb,l.a.I6,!0),Gb.zg.add(u.a.yb(l.a.I6));return!0}if(pc===u.a.yb(l.a.Yda))return pc=Gb.$d.getPropertyBool(Fc,l.a.Yda),ob=Gb.$d.getPropertyBool(ob,l.a.Yda),Gb.$d.setPropertyBool(Fb,l.a.Yda,null!=pc&&!!pc&&null!=ob&&!!ob),Gb.zg.add(u.a.yb(l.a.Yda)),!0;if(pc===u.a.yb(l.a.$Zb))return pc=Gb.$d.getPropertyUint32(ob,l.a.$Zb),null!=pc&&(Gb.$d.setPropertyUint32(Fb,l.a.$Zb,pc),Gb.zg.add(u.a.yb(l.a.$Zb))),!0;if(pc===u.a.yb(l.a.ZZb)||pc===u.a.yb(l.a.vbb)||pc===u.a.yb(l.a.ubb))return(ob=
Gb.$d.getPropertyString(ob,u.a.yW(pc)))&&0<ob.length&&(Gb.$d.setPropertyString(Fb,u.a.yW(pc),ob),Gb.zg.add(pc)),!0;if(pc===u.a.yb(l.a.iCc)||pc===u.a.yb(l.a.Fwd)){Fc=Gb.$d.getPropertyObjectId(Fc,u.a.yW(pc));if(ca.a.c3b(Gb.ap,Fc))return!0;if((ob=Gb.$d.getPropertyObjectId(ob,u.a.yW(pc)))&&ob!==Y.a.nil)return Gb.$d.setPropertyObjectId(Fb,u.a.yW(pc),ob),Gb.zg.add(pc),!0;Fb.removeProperty(u.a.yW(pc));Gb.zg.add(pc);return!0}if(pc===u.a.yb(l.a.U5)){Fc=Gb.$d.getPropertyObjectId(Fc,l.a.U5);if((Fc=ca.a.c3b(Gb.ap,
Fc))&&Gb.$d.getPropertyObjectIds(Fc,l.a.contentControlNode).iG().contains(Gb.Lk.id))return!0;ob=Gb.$d.getPropertyObjectId(ob,l.a.U5);return(Fc=ca.a.c3b(Gb.ap,ob))&&Gb.$d.getPropertyObjectIds(Fc,l.a.contentControlNode).iG().contains(Gb.Lk.id)?(Gb.$d.setPropertyObjectId(Fb,l.a.U5,ob),Gb.zg.add(pc),!0):!1}if(pc===u.a.yb(l.a.V5))return pc=Gb.$d.getPropertyBool(ob,l.a.V5),null==pc||pc||(Gb.$d.setPropertyBool(Fb,l.a.V5,!1),Gb.zg.add(u.a.yb(l.a.V5))),!0;if(pc===u.a.yb(l.a.cmb)){pc=Gb.$d.getPropertyObjectId(Fc,
l.a.cmb);ob=Gb.$d.getPropertyObjectId(ob,l.a.cmb);if(pc&&!pc.equals(ob))return!1;if(pc=pc||ob)Gb.$d.setPropertyObjectId(Fb,l.a.cmb,pc),Gb.zg.add(u.a.yb(l.a.cmb));return!0}!this.Wb.isFeatureEnabled(26)||pc!==u.a.yb(l.a.K2)&&pc!==u.a.yb(l.a.ima)&&pc!==u.a.yb(l.a.jma)||n.a.instance.Sa(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",pc);return!1}static nh(){return new ha}static get instance(){return ha.Og.value}}ha.Og=new a.a(ha.nh);
Object(C.a)(ha,"ContentControlNodeComplexMerge",h.a,[]);class ra extends h.a{constructor(){super()}get Fn(){return 10}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.customXmlPartNode),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.customXmlPartNode)){pc=Gb.Lk;const ob=Gb.$d;var Fc=ob.getPropertyObjectIds(Gb.Rg.value.qu,l.a.customXmlPartNode);const Fb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.customXmlPartNode),gb=ob.getPropertyObjectIds(Gb.an.value.Ef,l.a.customXmlPartNode);Fc=this.zJm(Fc,Fb,gb);0<Fc.length?
ob.setPropertyObjectIds(pc,l.a.customXmlPartNode,Fc):pc.removeProperty(l.a.customXmlPartNode);Gb.zg.add(u.a.yb(l.a.customXmlPartNode));return!0}return!1}zJm(Gb,pc,Fc){return this.fDa(Gb,pc,Fc)}static nh(){return new ra}static get instance(){return ra.Og.value}}ra.Og=new a.a(ra.nh);Object(C.a)(ra,"CustomXmlPartContainerNodeComplexMerge",h.a,[]);class sa extends h.a{constructor(){super()}get Fn(){return 9}get Kz(){return 0}static nh(){return new sa}static get instance(){return sa.Og.value}}sa.Og=new a.a(sa.nh);
Object(C.a)(sa,"CustomXmlPartNodeComplexMerge",h.a,[]);class oa extends h.a{constructor(){super()}get Fn(){return 29}get Kz(){return 3}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.embeddedFontNode),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.embeddedFontNode)){pc=Gb.$d;var Fc=pc.getPropertyObjectIds(Gb.Rg.value.qu,l.a.embeddedFontNode),ob=pc.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.embeddedFontNode);const Fb=pc.getPropertyObjectIds(Gb.an.value.Ef,l.a.embeddedFontNode);Fc=this.fDa(Fc,ob,Fb);ob=Gb.Lk;0<Fc.length?
pc.setPropertyObjectIds(ob,l.a.embeddedFontNode,Fc):ob.removeProperty(l.a.embeddedFontNode);Gb.zg.add(u.a.yb(l.a.embeddedFontNode));return!0}return!1}static nh(){return new oa}static get instance(){return oa.Og.value}}oa.Og=new a.a(oa.nh);Object(C.a)(oa,"EmbeddedFontContainerNodeComplexMerge",h.a,[]);class ka extends h.a{constructor(){super()}get Fn(){return 30}get Kz(){return 3}static nh(){return new ka}static get instance(){return ka.Og.value}}ka.Og=new a.a(ka.nh);Object(C.a)(ka,"EmbeddedFontNodeComplexMerge",
h.a,[]);class ia extends h.a{constructor(){super()}get Fn(){return 11}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.n6),4);Gb.Z(u.a.yb(l.a.iYa),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.iYa)){const Fc=Gb.Lk,ob=Gb.$d;n.a.instance.Sa(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fc.id,Fc.Qc,pc);pc=ob.getPropertyObjectIds(Gb.Rg.value.qu,l.a.iYa);const Fb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.iYa),gb=ob.getPropertyObjectIds(Gb.an.value.Ef,
l.a.iYa);pc=this.ssi(pc,Fb,gb,(Jb,Yb)=>Jb.equals(Yb));0<pc.length?ob.setPropertyObjectIds(Fc,l.a.iYa,pc):Fc.removeProperty(l.a.iYa);Gb.zg.add(u.a.yb(l.a.iYa));return!0}n.a.instance.Sa(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}static nh(){return new ia}static get instance(){return ia.Og.value}}ia.Og=new a.a(ia.nh);Object(C.a)(ia,"FootnoteEndnoteContainerNodeComplexMerge",
h.a,[]);class La extends h.a{constructor(){super()}get Fn(){return 12}get Kz(){return 3}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.ola),1);return Gb}dB(Gb,pc){const Fc=Gb.Lk,ob=Gb.$d;if(pc===u.a.yb(l.a.ola)){let Fb=-1;n.a.instance.Sa(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fc.id,Fc.Qc,pc);const gb=ob.getPropertyInt32(Gb.Rg.value.Ef,l.a.ola),Jb=ob.getPropertyInt32(Gb.an.value.Ef,l.a.ola);null!=gb&&-1!==gb?Fb=gb:null!=Jb&&
(Fb=Jb);ob.setPropertyInt32(Fc,l.a.ola,Fb);Gb.zg.add(pc);return!0}n.a.instance.Sa(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.qu.id,pc);return!1}static nh(){return new La}static get instance(){n.a.instance.Sa(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return La.Og.value}}La.Og=new a.a(La.nh);Object(C.a)(La,"FootnoteEndnoteNodeComplexMerge",h.a,[]);class va extends h.a{constructor(){super()}get Fn(){return 47}nk(){const Gb=
super.nk();Gb.Z(u.a.yb(l.a.glossaryPageContentNode),1);return Gb}dB(Gb,pc){return pc===u.a.yb(l.a.glossaryPageContentNode)?(n.a.instance.Sa(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gb.Lk.id,Gb.Lk.Qc,pc),h.a.sAf(Gb,this,l.a.glossaryPageContentNode)):!1}static nh(){return new va}static get instance(){return va.Og.value}}va.Og=new a.a(va.nh);Object(C.a)(va,"GlossaryPageManifestNodeComplexMerge",h.a,[]);class Ga extends h.a{constructor(){super()}get Fn(){return 13}get Kz(){return 3}nk(){const Gb=
super.nk();Gb.Z(u.a.yb(l.a.Sga),4);return Gb}static nh(){return new Ga}static get instance(){return Ga.Og.value}}Ga.Og=new a.a(Ga.nh);Object(C.a)(Ga,"HeaderFooterContainerNodeComplexMerge",h.a,[]);class Oa extends h.a{constructor(){super()}get Fn(){return 14}get Kz(){return 3}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.runId),3);Gb.Z(u.a.yb(l.a.Nc),3);Gb.Z(u.a.yb(l.a.lbi),3);Gb.Z(u.a.yb(l.a.BT),1);Gb.Z(u.a.yb(e.a.HZ),1);Gb.Z(u.a.yb(v.a.imageAltText),1);Gb.Z(u.a.yb(l.a.PW),1);Gb.Z(u.a.yb(v.a.eba),1);
Gb.Z(u.a.yb(e.a.T4a),1);Gb.Z(u.a.yb(l.a.NVa),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(v.a.imageAltText)||pc===u.a.yb(l.a.PW)||pc===u.a.yb(l.a.BT)||pc===u.a.yb(l.a.QW)||pc===u.a.yb(v.a.jfb)||pc===u.a.yb(v.a.eba)||pc===u.a.yb(e.a.HZ)||pc===u.a.yb(e.a.T4a)||pc===u.a.yb(l.a.NVa)){const ob=Gb.Lk;var Fc=Gb.$d;n.a.instance.Sa(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ob.id,ob.Qc,pc);const Fb=Fc.getPropertyInt32(Gb.Rg.value.Ef,e.a.HZ);Fc=Fc.getPropertyInt32(Gb.an.value.Ef,
e.a.HZ);if(null!=Fb&&(0===Fb||2===Fb))return!0;if(null!=Fc&&(0===Fc||2===Fc))return pc=Gb.an.value.Ef,this.Cbb(pc,ob,v.a.imageAltText),this.Cbb(pc,ob,l.a.PW),this.Cbb(pc,ob,l.a.QW),pc.hasProperty(l.a.BT)&&this.Cbb(pc,ob,l.a.BT),this.Cbb(pc,ob,v.a.jfb),this.Cbb(pc,ob,v.a.eba),this.Cbb(pc,ob,e.a.HZ),this.Cbb(pc,ob,e.a.T4a),Gb.zg.add(u.a.yb(v.a.imageAltText)),Gb.zg.add(u.a.yb(l.a.PW)),Gb.zg.add(u.a.yb(l.a.QW)),Gb.zg.add(u.a.yb(l.a.BT)),Gb.zg.add(u.a.yb(v.a.jfb)),Gb.zg.add(u.a.yb(v.a.eba)),Gb.zg.add(u.a.yb(e.a.HZ)),
Gb.zg.add(u.a.yb(e.a.T4a)),Gb.zg.add(u.a.yb(l.a.NVa)),!0}n.a.instance.Sa(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.qu.id,pc);return!1}static nh(){return new Oa}static get instance(){return Oa.Og.value}}Oa.Og=new a.a(Oa.nh);Object(C.a)(Oa,"ImageNodeComplexMerge",h.a,[]);class Za extends h.a{constructor(){super()}get Fn(){return 40}get Kz(){return 0}static nh(){return new Za}static get instance(){return Za.Og.value}}
Za.Og=new a.a(Za.nh);Object(C.a)(Za,"IntelligenceAnnotationNodeComplexMerge",h.a,[]);class ja extends h.a{constructor(){super()}get Fn(){return 32}get Kz(){return 0}static nh(){return new ja}static get instance(){return ja.Og.value}}ja.Og=new a.a(ja.nh);Object(C.a)(ja,"IntelligenceContentLocatorNodeComplexMerge",h.a,[]);class ba extends h.a{constructor(){super()}get Fn(){return 34}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.Ofb),1);return Gb}dB(Gb,pc){const Fc=Gb.Lk,ob=Gb.$d;if(pc===
u.a.yb(l.a.Ofb)){pc=ob.getPropertyObjectIds(Gb.Rg.value.qu,l.a.Ofb);const Fb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.Ofb),gb=ob.getPropertyObjectIds(Gb.an.value.Ef,l.a.Ofb);pc=this.fDa(pc,Fb,gb);ob.setPropertyObjectIds(Fc,l.a.Ofb,pc);Gb.zg.add(u.a.yb(l.a.Ofb));return!0}return!1}static nh(){return new ba}static get instance(){return ba.Og.value}}ba.Og=new a.a(ba.nh);Object(C.a)(ba,"IntelligenceRegionNodeComplexMerge",h.a,[]);class qa extends h.a{constructor(){super()}get Fn(){return 35}get Kz(){return 0}static nh(){return new qa}static get instance(){return qa.Og.value}}
qa.Og=new a.a(qa.nh);Object(C.a)(qa,"IntelligenceRejectionNodeComplexMerge",h.a,[]);class Ma extends h.a{constructor(){super()}get Fn(){return 39}get Kz(){return 0}static nh(){return new Ma}static get instance(){return Ma.Og.value}}Ma.Og=new a.a(Ma.nh);Object(C.a)(Ma,"IntelligenceReviewedNodeComplexMerge",h.a,[]);class Ia extends h.a{constructor(){super()}get Fn(){return 33}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.PMc),1);Gb.Z(u.a.yb(l.a.fNd),1);Gb.Z(u.a.yb(l.a.Wof),1);Gb.Z(u.a.yb(l.a.Yof),
1);return Gb}dB(Gb,pc){const Fc=Gb.Lk,ob=Gb.$d;if(pc===u.a.yb(l.a.PMc)||pc===u.a.yb(l.a.fNd)||pc===u.a.yb(l.a.Wof)||pc===u.a.yb(l.a.Yof)){pc=pc===u.a.yb(l.a.PMc)?l.a.PMc:l.a.fNd;var Fb=ob.getPropertyObjectIds(Gb.Rg.value.qu,pc);const gb=ob.getPropertyObjectIds(Gb.Rg.value.Ef,pc),Jb=ob.getPropertyObjectIds(Gb.an.value.Ef,pc);Fb=this.fDa(Fb,gb,Jb);ob.setPropertyObjectIds(Fc,pc,Fb);Gb.zg.add(u.a.yb(pc));return!0}return!1}static nh(){return new Ia}static get instance(){return Ia.Og.value}}Ia.Og=new a.a(Ia.nh);
Object(C.a)(Ia,"IntelligenceRootNodeComplexMerge",h.a,[]);class wa extends h.a{constructor(){super()}get Fn(){return 42}get Kz(){return 0}static nh(){return new wa}static get instance(){return wa.Og.value}}wa.Og=new a.a(wa.nh);Object(C.a)(wa,"IntelligenceSettingNodeComplexMerge",h.a,[]);class za extends h.a{constructor(){super()}get Fn(){return 45}get Kz(){return 0}static nh(){return new za}static get instance(){return za.Og.value}}za.Og=new a.a(za.nh);Object(C.a)(za,"IntelligenceWorkflowNodeComplexMerge",
h.a,[]);class pa extends h.a{constructor(){super()}get Fn(){return 15}get Kz(){return 3}static nh(){return new pa}static get instance(){return pa.Og.value}}pa.Og=new a.a(pa.nh);Object(C.a)(pa,"NumberListNodeComplexMerge",h.a,[]);var Ba=c(115);class Ra extends h.a{constructor(){super()}get Fn(){return 16}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.Vvb),1);Gb.Z(u.a.yb(Ba.a.HYe),7);Gb.Z(u.a.yb(Ba.a.FYe),7);return Gb}dB(Gb,pc){const Fc=Gb.Lk,ob=Gb.$d;if(pc===u.a.yb(l.a.Vvb))return this.wvf(ob,
Gb.Rg.value.Ef,Gb.an.value.Ef,Fc,l.a.Vvb),Gb.zg.add(pc),!0;n.a.instance.Sa(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.qu.id,pc);return!1}static nh(){return new Ra}static get instance(){return Ra.Og.value}}Ra.Og=new a.a(Ra.nh);Object(C.a)(Ra,"OutlineElementNodeComplexMerge",h.a,[]);class fb extends h.a{constructor(){super()}get Fn(){return 17}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.Vvb),1);
Gb.Z(u.a.yb(l.a.Uka),1);Gb.Z(u.a.yb(Ba.a.tI),1);Gb.Z(u.a.yb(Ba.a.O8b),1);Gb.Z(u.a.yb(Ba.a.mga),8);return Gb}dB(Gb,pc){const Fc=Gb.Lk,ob=Gb.$d;if(pc===u.a.yb(l.a.Vvb))return this.wvf(ob,Gb.Rg.value.Ef,Gb.an.value.Ef,Fc,l.a.Vvb),Gb.zg.add(pc),!0;if(pc===u.a.yb(l.a.Uka)){var Fb=ob.getPropertyBool(Gb.Rg.value.Ef,l.a.Uka),gb=ob.getPropertyBool(Gb.an.value.Ef,l.a.Uka);ob.setPropertyBool(Fc,l.a.Uka,null==Fb?!1:Fb&&null==gb?!1:gb);Gb.zg.add(pc);return!0}if(pc===u.a.yb(Ba.a.O8b))return this.wvf(ob,Gb.Rg.value.Ef,
Gb.an.value.Ef,Fc,Ba.a.O8b),Gb.zg.add(pc),!0;if(pc===u.a.yb(Ba.a.tI))return Fb=ob.getPropertyBool(Gb.Rg.value.Ef,Ba.a.tI),gb=ob.getPropertyBool(Gb.an.value.Ef,Ba.a.tI),ob.setPropertyBool(Fc,Ba.a.tI,null==Fb?!0:Fb||null==gb?!0:gb),Gb.zg.add(pc),!0;n.a.instance.Sa(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.qu.id,pc);return!1}static nh(){return new fb}static get instance(){return fb.Og.value}}fb.Og=
new a.a(fb.nh);Object(C.a)(fb,"OutlineGroupNodeComplexMerge",h.a,[]);var Va=c(46),ib=c(44);class Xa extends h.a{constructor(){super()}get Fn(){return 18}get Kz(){return 2}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.TKd),3);Gb.Z(u.a.yb(v.a.Waa),this.Kz);Gb.Z(u.a.yb(l.a.$s),1);Gb.Z(u.a.yb(l.a.G9),1);Gb.Z(u.a.yb(l.a.p3),1);Gb.Z(u.a.yb(l.a.xQ),1);Gb.Z(u.a.yb(l.a.zp),1);Gb.Z(u.a.yb(Va.a.yQ),1);Gb.Z(u.a.yb(Va.a.x$b),1);return Gb}dB(Gb,pc){const Fc=Gb.$d;if(Gb.ap.runtime.Wb.isFeatureEnabled(72)){var ob=Gb.ap.runtime.Wb.isFeatureEnabled(131),
Fb=this.YUh(ob),gb=this.bVh(ob);if(pc===u.a.yb(l.a.$s)||pc===u.a.yb(l.a.p3)||pc===u.a.yb(Fb)||pc===u.a.yb(l.a.zp)||pc===u.a.yb(gb))return this.$fo(Fc,Gb,ob)}else if(pc===u.a.yb(l.a.$s)||pc===u.a.yb(l.a.zp)){({YBc:pc,v_a:ob,q_a:Fb}=this.RWe(Object(ib.a)(Fc,Fc.getPropertyUint32s,"getPropertyUint32s"),Gb.Rg.value.qu,Gb.Rg.value.Ef,Gb.an.value.Ef,l.a.$s,null));if(!Fb&&!ob)return n.a.instance.Sa(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Gb.Rg.value.Ef.id,u.a.yb(l.a.$s)),!0;let Jb,Yb;({YBc:gb,v_a:Jb,q_a:Yb}=this.RWe(Object(ib.a)(Fc,Fc.getPropertyObjectIds,"getPropertyObjectIds"),Gb.Rg.value.qu,Gb.Rg.value.Ef,Gb.an.value.Ef,l.a.zp,null));if(!Jb&&!Yb)return n.a.instance.Sa(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Gb.Rg.value.Ef.id,u.a.yb(l.a.zp)),!0;const tc=Jb&&!Yb;if((ob&&!Fb)!==tc)return n.a.instance.Sa(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Gb.Rg.value.Ef.id,u.a.yb(l.a.$s),u.a.yb(l.a.zp)),!1;tc&&(Fc.setPropertyObjectIds(Gb.Lk,l.a.zp,gb),Fc.setPropertyUint32s(Gb.Lk,l.a.$s,pc));n.a.instance.Sa(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Gb.Rg.value.Ef.id,u.a.yb(l.a.$s),ob,Fb,u.a.yb(l.a.zp),Jb,Yb);Gb.zg.add(u.a.yb(l.a.zp));Gb.zg.add(u.a.yb(l.a.$s));
return!0}n.a.instance.Sa(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}Q5h(Gb,pc,Fc,ob){let Fb;({YBc:pc,v_a:ob,q_a:Fb}=this.RWe(pc,Fc.Rg.value.qu,Fc.Rg.value.Ef,Fc.an.value.Ef,Gb,ob));return Fb||ob?{returnValue:!0,fZe:pc,v_a:ob,q_a:Fb}:(n.a.instance.Sa(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Fc.Rg.value.Ef.id.toString(),u.a.yb(Gb)),{returnValue:!1,fZe:pc,v_a:ob,q_a:Fb})}V4h(Gb,pc,Fc,ob,Fb){let gb;let Jb,Yb,tc,Ec;({fZe:gb,v_a:Vc,q_a:Jb,returnValue:tc}=this.Q5h(Gb,Object(ib.a)(Fc,Fc.getPropertyUint32s,"getPropertyUint32s"),ob,null));({fZe:Fc,v_a:Fb,q_a:Yb,returnValue:Ec}=this.Q5h(pc,Object(ib.a)(Fc,Fc.getPropertyObjectIds,"getPropertyObjectIds"),ob,Fb));var Vc=Vc&&!Jb;return tc&&Ec?Vc!==(Fb&&!Yb)?(n.a.instance.Sa(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
ob.Rg.value.Ef.id.toString(),u.a.yb(Gb),u.a.yb(pc)),{returnValue:2,nwd:gb,mwd:Fc,Cae:Vc}):{returnValue:0,nwd:gb,mwd:Fc,Cae:Vc}:{returnValue:1,nwd:gb,mwd:Fc,Cae:Vc}}Pqf(Gb){let pc=!0;Gb.forEach(Fc=>Fc!==Y.a.nil?pc=!1:!0);return pc}atl(Gb,pc,Fc){return this.Pqf(Gb)&&this.Pqf(pc)&&this.Pqf(Fc)?!0:!1}$fo(Gb,pc,Fc){const ob=this.YUh(Fc);Fc=this.bVh(Fc);let Fb,gb,Jb,Yb,tc,Ec;var Vc=({nwd:Yb,mwd:tc,Cae:gb}=this.V4h(ob,l.a.zp,Gb,pc,null)).returnValue;if(2===Vc||1===Vc)return!0;({nwd:Jb,mwd:Ec,Cae:Fb,returnValue:Vc}=
this.V4h(l.a.$s,l.a.p3,Gb,pc,Object(ib.a)(this,this.atl,"getExtendedGuidEquivalence")));if(2===Vc||1===Vc)return!0;let Hd;({YBc:Vc,v_a:qd,q_a:Hd}=this.zvk(Object(ib.a)(Gb,Gb.getPropertyDictionary,"getPropertyDictionary"),pc.Rg.value.qu,pc.Rg.value.Ef,pc.an.value.Ef,Fc));if(!Hd&&!qd)return n.a.instance.Sa(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",pc.Rg.value.Ef.id.toString(),u.a.yb(Fc)),!0;var qd=qd&&!Hd;
if(Fb!==gb||Fb!==qd)return n.a.instance.Sa(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",pc.Rg.value.Ef.id.toString(),u.a.yb(l.a.$s),u.a.yb(ob),u.a.yb(Fc),gb,Fb,qd),!0;Fb&&(Gb.setPropertyObjectIds(pc.Lk,l.a.zp,tc),Gb.setPropertyUint32s(pc.Lk,ob,Yb),Gb.setPropertyObjectIds(pc.Lk,
l.a.p3,Ec),Gb.setPropertyUint32s(pc.Lk,l.a.$s,Jb),Gb.setPropertyDictionary(pc.Lk,Fc,Vc));n.a.instance.Sa(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",pc.Rg.value.Ef.id.toString(),gb,Fb,qd);pc.zg.add(u.a.yb(ob));pc.zg.add(u.a.yb(l.a.zp));pc.zg.add(u.a.yb(l.a.$s));pc.zg.add(u.a.yb(l.a.p3));pc.zg.add(u.a.yb(Fc));return!0}YUh(Gb){return Gb?Va.a.x$b:l.a.G9}bVh(Gb){return Gb?Va.a.yQ:
l.a.xQ}static nh(){return new Xa}static get instance(){return Xa.Og.value}}Xa.Og=new a.a(Xa.nh);Object(C.a)(Xa,"PageContentNodeComplexMerge",h.a,[]);class qb extends h.a{constructor(){super()}get Fn(){return 19}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.DEa),1);Gb.Z(u.a.yb(l.a.appsNode),2);Gb.Z(u.a.yb(l.a.customXmlPartContainerNode),2);Gb.Z(u.a.yb(l.a.intelligenceRootNode),1);return Gb}dB(Gb,pc){const Fc=Gb.$d;if(pc===u.a.yb(l.a.DEa)){var ob=Fc.getPropertyObjectIds(Gb.Rg.value.qu,l.a.DEa),Fb=Fc.getPropertyObjectIds(Gb.Rg.value.Ef,
l.a.DEa),gb=Fc.getPropertyObjectIds(Gb.an.value.Ef,l.a.DEa);if((ob=this.NJm(ob,Fb,gb,(Jb,Yb)=>Jb.equals(Yb),Jb=>{let Yb;({value:Yb}=Gb.ap.runtime.nq.Bc(Jb)).returnValue?Gb.ap.runtime.Um.Z(Jb,new x.a(Yb,!1)):n.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Gb.ap))&&0<ob.length)return Fc.setPropertyObjectIds(Gb.Lk,l.a.DEa,ob),Gb.zg.add(u.a.yb(l.a.DEa)),!0}if(pc===u.a.yb(l.a.intelligenceRootNode))return ob=
Fc.getPropertyObjectIds(Gb.Rg.value.qu,l.a.intelligenceRootNode),Fb=Fc.getPropertyObjectIds(Gb.Rg.value.Ef,l.a.intelligenceRootNode),gb=Fc.getPropertyObjectIds(Gb.an.value.Ef,l.a.intelligenceRootNode),ob=this.fDa(ob,Fb,gb),Fc.setPropertyObjectIds(Gb.Lk,l.a.intelligenceRootNode,ob),Gb.zg.add(pc),!0;n.a.instance.Sa(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}static nh(){return new qb}static get instance(){return qb.Og.value}}
qb.Og=new a.a(qb.nh);Object(C.a)(qb,"PageManifestNodeComplexMerge",h.a,[]);class rb extends h.a{constructor(){super()}get Fn(){return 43}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.Pja),0);Gb.Z(u.a.yb(l.a.HHb),0);Gb.Z(u.a.yb(l.a.kEb),0);Gb.Z(u.a.yb(l.a.Wla),1);Gb.Z(u.a.yb(l.a.sessionId),3);Gb.Z(u.a.yb(l.a.buildVersion),3);Gb.Z(u.a.yb(l.a.gX),1);Gb.Z(u.a.yb(l.a.uei),1);Gb.Z(u.a.yb(l.a.Ju),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(l.a.gX)||pc===u.a.yb(l.a.uei)||pc===u.a.yb(l.a.Ju)){var Fc=Gb.an.value.Ef,ob=
Gb.Rg.value.Ef,Fb=u.a.yW(pc);ob=Gb.$d.getPropertyBool(ob,Fb);Fc=Gb.$d.getPropertyBool(Fc,Fb);Gb.$d.setPropertyBool(Gb.Lk,Fb,null==ob?!1:ob&&null==Fc?!1:Fc);Gb.zg.add(pc);return!0}if(pc===u.a.yb(l.a.Wla)){pc=Gb.$d;Fc=Gb.Rg.value.qu;ob=Gb.an.value.Ef;Fb=Gb.Rg.value.Ef;Fc=Fc?pc.getPropertyObjectId(Fc,l.a.Wla):null;ob=ob?pc.getPropertyObjectId(ob,l.a.Wla):null;Fb=Fb?pc.getPropertyObjectId(Fb,l.a.Wla):null;n.a.instance.Sa(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Fc?Fc.toString():"NULL",ob?ob.toString():"NULL",Fb?Fb.toString():"NULL");if(ob){if(Fb&&ob.equals(Fb))return Gb.zg.add(u.a.yb(l.a.Wla)),pc.setPropertyObjectId(Gb.Lk,l.a.Wla,ob),!0;if(ca.a.tJd.equals(ob))return Gb.zg.add(u.a.yb(l.a.Wla)),pc.setPropertyObjectId(Gb.Lk,l.a.Wla,ca.a.tJd),!0}if(Fb&&ca.a.tJd.equals(Fb))return Gb.zg.add(u.a.yb(l.a.Wla)),pc.setPropertyObjectId(Gb.Lk,l.a.Wla,ca.a.tJd),!0;n.a.instance.Sa(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Fc?Fc.toString():"NULL",ob?ob.toString():"NULL",Fb?Fb.toString():"NULL")}return!1}static nh(){return new rb}static get instance(){return rb.Og.value}}rb.Og=new a.a(rb.nh);Object(C.a)(rb,"PageMetadataNodeComplexMerge",h.a,[]);var nb=c(1694),Tb=c(106);class Zb extends h.a{constructor(){super()}get Fn(){return 31}nk(){const Gb=super.nk();Gb.Z(u.a.yb(Tb.a.Rv),1);Gb.Z(u.a.yb(l.a.listID),3);Gb.Z(u.a.yb(l.a.listLevel),1);Gb.Z(u.a.yb(l.a.we),3);Gb.Z(u.a.yb(l.a.vYb),3);Gb.Z(u.a.yb(l.a.runId),3);Gb.Z(u.a.yb(l.a.tBd),
3);Gb.Z(u.a.yb(v.a.fontColor),3);Gb.Z(u.a.yb(l.a.vrh),3);Gb.Z(u.a.yb(l.a.Nc),1);Gb.Z(u.a.yb(Tb.a.eOd),3);Gb.Z(u.a.yb(Tb.a.ivf),3);Gb.Z(u.a.yb(Tb.a.mOc),3);Gb.Z(u.a.yb(l.a.Bel),3);Gb.Z(u.a.yb(Ba.a.bhj),3);for(let pc=0;pc<Zb.r0a.length;pc++)Gb.Z(Zb.r0a[pc],1);return Gb}dB(Gb,pc){var Fc=Gb.$d;const ob=Gb.Lk;var Fb=Gb.ap.runtime.Wb.isFeatureEnabled(130);u.a.yW(pc);if(pc===u.a.yb(l.a.Nc)){Fc=Gb.$d.getPropertyInt32(Gb.an.value.Ef,l.a.Nc);if(null==Fc||!Fc)return!0;Gb.$d.setPropertyInt32(ob,l.a.Nc,Fc);Gb.zg.add(pc);
return!0}if(pc===u.a.yb(Tb.a.Rv)){Fb=Fc.getPropertyUint32(Gb.Rg.value.Ef,Tb.a.Rv);const gb=Fc.getPropertyUint32(Gb.an.value.Ef,Tb.a.Rv);if(null!=Fb&&null!=gb&&Fb===gb)return Fc.setPropertyUint32(ob,Tb.a.Rv,Fb),Gb.zg.add(pc),!0;if(null==Fb&&null==gb)return ob.removeProperty(Tb.a.Rv),Gb.zg.add(u.a.yb(Tb.a.Rv)),!0;if(null!=Fb&&null==gb)return Fc.setPropertyUint32(ob,Tb.a.Rv,Fb),Gb.zg.add(pc),!0;if(null==Fb&&null!=gb)return Fc.setPropertyUint32(ob,Tb.a.Rv,gb),Gb.zg.add(pc),!0}else{if(pc===u.a.yb(l.a.listLevel))return this.tfo(Fc,
Gb);if(pc===u.a.yb(e.a.paragraphStyle)){if(Fb)return this.wfj(Gb)}else if(Array.contains(Zb.r0a,pc))return this.wfj(Gb)}return!1}wfj(Gb){let pc=!0,Fc=!0,ob,Fb;({Lem:pc,dcm:Fc,N8k:ob,uEk:Fb}=this.Avk(Gb));n.a.instance.Sa(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Gb.Rg.value.Ef.id.toString(),pc,Fc);return pc&&!Fc?(this.gti(Fb,Gb),!0):pc?!1:(this.gti(ob,Gb),!0)}Avk(Gb){let pc,Fc,ob,Fb;const gb=
Gb.an.value;let Jb;const Yb=Gb.Rg.value;let tc;Fc=pc=!0;ob=new L.a;Fb=new L.a;for(let Ec=0;Ec<Zb.r0a.length;Ec++){const Vc=Zb.r0a[Ec],Hd=({value:Jb}=gb.Qna.Bc(Vc)).returnValue;({value:tc}=Yb.Qna.Bc(Vc)).returnValue&&(pc=this.ifj(Gb.Rg,ob,tc,Vc)&&pc);Hd&&(Fc=this.ifj(Gb.an,Fb,Jb,Vc)&&Fc)}return{Lem:pc,dcm:Fc,N8k:ob,uEk:Fb}}ifj(Gb,pc,Fc,ob){const Fb=u.a.yW(ob);Gb=Gb.value.Ef;pc.Z(ob,Gb.hasProperty(Fb)?Gb.dQ(Fb):null);return!Fc.XW}gti(Gb,pc){const Fc=pc.Lk;for(let Fb=0;Fb<Zb.r0a.length;Fb++){var ob=
Zb.r0a[Fb];const gb=u.a.yW(ob);(ob=Gb.J(ob))?Fc.jwa(gb,ob):Fc.removeProperty(gb)}for(Gb=0;Gb<Zb.r0a.length;Gb++)pc.zg.add(Zb.r0a[Gb]);n.a.instance.Sa(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",pc.Rg.value.Ef.id.toString())}tfo(Gb,pc){const Fc=pc.Lk,ob=Gb.getPropertyInt32(pc.Rg.value.Ef,l.a.listLevel),Fb=Gb.getPropertyInt32(pc.an.value.Ef,l.a.listLevel);return null!=ob&&null!=Fb&&ob===Fb?(Gb.setPropertyInt32(Fc,l.a.listLevel,ob),pc.zg.add(u.a.yb(l.a.listLevel)),
!0):null==ob&&null==Fb?(Fc.removeProperty(l.a.listLevel),pc.zg.add(u.a.yb(l.a.listLevel)),!0):null!=ob&&null==Fb?(Gb.setPropertyInt32(Fc,l.a.listLevel,ob),pc.zg.add(u.a.yb(l.a.listLevel)),!0):null==ob&&null!=Fb?(Gb.setPropertyInt32(Fc,l.a.listLevel,Fb),pc.zg.add(u.a.yb(l.a.listLevel)),!0):!1}static nh(){return new Zb}static get instance(){return Zb.Og.value}}Zb.Og=new a.a(Zb.nh);Zb.r0a=[u.a.yb(l.a.fe),u.a.yb(l.a.ht),u.a.yb(v.a.h3),u.a.yb(l.a.Daa),u.a.yb(l.a.Vr),u.a.yb(l.a.xr),u.a.yb(v.a.jX),u.a.yb(l.a.kTe),
u.a.yb(v.a.font),u.a.yb(Ba.a.zhb),u.a.yb(e.a.paragraphStyle)];Object(C.a)(Zb,"PersistablePropertySetComplexMerge",h.a,[]);class Hb extends h.a{constructor(){super()}get Fn(){return 21}get Kz(){return 0}static nh(){return new Hb}static get instance(){return Hb.Og.value}}Hb.Og=new a.a(Hb.nh);Object(C.a)(Hb,"RevisionMetadataNodeComplexMerge",h.a,[]);class Sa extends h.a{constructor(){super()}get Fn(){return 48}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.PHi),3);return Gb}static nh(){return new Sa}static get instance(){return Sa.Og.value}}
Sa.Og=new a.a(Sa.nh);Object(C.a)(Sa,"ShadowNumberListNodeComplexMerge",h.a,[]);class ua extends h.a{constructor(){super()}get Fn(){return 22}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.languageHint),7);Gb.Z(u.a.yb(l.a.POc),2);return Gb}static nh(){return new ua}static get instance(){return ua.Og.value}}ua.Og=new a.a(ua.nh);Object(C.a)(ua,"SharedPersistablePropertySetComplexMerge",h.a,[]);class Fa extends h.a{constructor(){super()}get Fn(){return 38}get Kz(){return 3}static nh(){return new Fa}static get instance(){return Fa.Og.value}}
Fa.Og=new a.a(Fa.nh);Object(C.a)(Fa,"StylePropertySetComplexMerge",h.a,[]);var Pa=c(1529),Ea=c(1567);class lb extends h.a{constructor(){super()}get Fn(){return 23}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(v.a.$e),4);Gb.Z(u.a.yb(l.a.rowSpan),1);Gb.Z(u.a.yb(l.a.colSpan),1);Gb.Z(u.a.yb(l.a.ghostCell),1);Gb.Z(u.a.yb(Va.a.vMerge),1);Gb.Z(u.a.yb(Va.a.gridSpan),1);Gb.Z(u.a.yb(l.a.k4a),2);Gb.Z(u.a.yb(l.a.jmb),2);Gb.Z(u.a.yb(l.a.$Ea),2);Gb.Z(u.a.yb(l.a.Glb),5);return Gb}sEb(Gb){if(!Gb)return n.a.instance.Sa(573957923,
1,2,"Feature helper is null"),!1;Gb.Lt(112);return Gb.isFeatureEnabled(112)}rK(Gb){if(!Gb)return n.a.instance.Sa(540120285,1,2,"Feature helper is null"),!1;Gb.Lt(113);return Gb.isFeatureEnabled(113)}dB(Gb,pc){Gb.ap.runtime.hG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+pc);var Fc=pc===u.a.yb(l.a.rowSpan)||pc===u.a.yb(l.a.colSpan)||pc===u.a.yb(l.a.ghostCell);this.rK(Gb.ap.runtime.Wb)&&(Fc=Fc||pc===u.a.yb(Va.a.vMerge)||pc===u.a.yb(Va.a.gridSpan));if(!this.sEb(Gb.ap.runtime.Wb))return!Fc;
var ob=Gb.an.value.qu,Fb=Ea.e(Gb.ap,ob,null);if(Fb.equals(Y.a.nil))return n.a.instance.Sa(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ob.id),Gb.ap.logger.Tg(Object.assign(new Pa.a,{info:"Table node ID could not be found for table cell"})),!1;var gb=Gb.ap.runtime.nxb.J(Fb).J(ob.id);if(!gb)return!Fc;ob=Gb.Lk;Fb=Gb.$d;if(pc===u.a.yb(l.a.ghostCell))return Fb.setPropertyBool(ob,l.a.ghostCell,gb.gg),Gb.zg.add(u.a.yb(l.a.ghostCell)),!0;if(pc===u.a.yb(l.a.rowSpan))return pc=
gb.rowSpan,gb=gb.colSpan,null!=pc&&null!=gb&&(1<pc||1<gb)?Fb.setPropertyUint32(ob,l.a.rowSpan,pc):ob.removeProperty(l.a.rowSpan),Gb.zg.add(u.a.yb(l.a.rowSpan)),!0;if(pc===u.a.yb(l.a.colSpan))return pc=gb.rowSpan,Fc=gb.colSpan,gb=gb.gg,null!=pc&&null!=Fc&&(1<pc||1<Fc)?Fb.setPropertyUint32(ob,l.a.colSpan,Fc):gb&&null!=Fc?Fb.setPropertyUint32(ob,l.a.colSpan,Fc):ob.removeProperty(l.a.colSpan),Gb.zg.add(u.a.yb(l.a.colSpan)),!0;n.a.instance.Sa(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",
pc);Gb.ap.logger.Tg(Object.assign(new Pa.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!Fc}static nh(){return new lb}static get instance(){return lb.Og.value}}lb.Og=new a.a(lb.nh);Object(C.a)(lb,"TableCellNodeComplexMerge",h.a,[]);class zb extends h.a{constructor(){super()}get Fn(){return 24}sEb(Gb){if(!Gb)return n.a.instance.Sa(573845782,1,2,"Feature helper is null"),!1;Gb.Lt(112);return Gb.isFeatureEnabled(112)}get Kz(){return 0}nk(){const Gb=
super.nk();Gb.Z(u.a.yb(v.a.$e),1);Gb.Z(u.a.yb(v.a.L_),1);Gb.Z(u.a.yb(v.a.swa),1);Gb.Z(u.a.yb(l.a.bgc),1);Gb.Z(u.a.yb(l.a.c8),1);Gb.Z(u.a.yb(l.a.k4a),2);Gb.Z(u.a.yb(l.a.jmb),2);Gb.Z(u.a.yb(l.a.$Ea),2);return Gb}dB(Gb,pc){Gb.ap.runtime.hG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+pc);if(pc===u.a.yb(v.a.$e)||pc===u.a.yb(v.a.L_)||pc===u.a.yb(l.a.bgc)||pc===u.a.yb(l.a.c8)||pc===u.a.yb(v.a.swa)){const Fb=Gb.Lk;var Fc=Gb.$d;n.a.instance.Sa(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Fb.id,Fb.Qc,pc);if(this.b_k(Gb))return!1;var ob=Fc.getPropertyObjectIds(Gb.Rg.value.qu,v.a.$e);const gb=Fc.getPropertyObjectIds(Gb.Rg.value.Ef,v.a.$e),Jb=Fc.getPropertyObjectIds(Gb.an.value.Ef,v.a.$e);ob=this.ssi(ob,gb,Jb,(Yb,tc)=>Yb.equals(tc));if(0<ob.length)return Fc.setPropertyObjectIds(Fb,v.a.$e,ob),Fc.setPropertyInt32(Fb,v.a.swa,ob.length),this.sEb(Gb.ap.runtime.Wb)&&({value:pc}=Gb.an.value.Qna.Bc(u.a.yb(v.a.L_)),{value:Fc}=Gb.Rg.value.Qna.Bc(u.a.yb(v.a.L_)),pc.XW?Fb.jwa(v.a.L_,pc.newValue):
Fb.jwa(v.a.L_,Fc.newValue)),Gb.zg.add(u.a.yb(v.a.$e)),Gb.zg.add(u.a.yb(v.a.L_)),Gb.zg.add(u.a.yb(v.a.swa)),Gb.zg.add(u.a.yb(l.a.bgc)),Gb.zg.add(u.a.yb(l.a.c8)),!0}n.a.instance.Sa(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}b_k(Gb){const pc=Gb.an.value,Fc=Gb.Rg.value;let ob,Fb;({value:ob}=pc.Qna.Bc(u.a.yb(v.a.L_)));({value:Fb}=Fc.Qna.Bc(u.a.yb(v.a.L_)));return ob.XW||Fb.XW?ob.XW&&Fb.XW?(n.a.instance.Sa(4273304,
1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",ob.oldValue,Fb.newValue,ob.newValue),Gb.ap.logger.Tg(Object.assign(new Pa.a,{kj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):zb.$Bh(Gb.ap,ob,Fc,"BaseConflict")||zb.$Bh(Gb.ap,Fb,pc,"BaseFavored")?!0:!1:!1}static nh(){return new zb}static get instance(){return zb.Og.value}static $Bh(Gb,pc,Fc,ob){return pc.XW&&({value:pc}=Fc.Qna.Bc(u.a.yb(v.a.$e)),
pc.XW)?(n.a.instance.Sa(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",ob),Gb.logger.Tg(Object.assign(new Pa.a,{kj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}zb.Og=new a.a(zb.nh);Object(C.a)(zb,"TableNodeComplexMerge",h.a,[]);class Xb extends h.a{constructor(){super()}get Fn(){return 25}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.Nc),3);Gb.Z(u.a.yb(v.a.$e),4);Gb.Z(u.a.yb(l.a.k4a),
2);Gb.Z(u.a.yb(l.a.jmb),2);Gb.Z(u.a.yb(l.a.$Ea),2);Gb.Z(u.a.yb(Va.a.O4f),2);Gb.Z(u.a.yb(Va.a.N4f),2);Gb.Z(u.a.yb(l.a.Glb),5);return Gb}static nh(){return new Xb}static get instance(){return Xb.Og.value}}Xb.Og=new a.a(Xb.nh);Object(C.a)(Xb,"TableRowNodeComplexMerge",h.a,[]);class ub extends h.a{constructor(){super()}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.C9n),2);Gb.Z(u.a.yb(v.a.$e),1);return Gb}dB(Gb,pc){if(pc===u.a.yb(v.a.$e)){const ob=Gb.Lk,Fb=Gb.$d;n.a.instance.Sa(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
ob.id,ob.Qc,pc);var Fc=Fb.getPropertyObjectIds(Gb.Rg.value.qu,v.a.$e);const gb=Fb.getPropertyObjectIds(Gb.Rg.value.Ef,v.a.$e),Jb=Fb.getPropertyObjectIds(Gb.an.value.Ef,v.a.$e);if(Fc=this.YJm(Fc,gb,Jb))return 0<Fc.length?Fb.setPropertyObjectIds(ob,v.a.$e,Fc):ob.removeProperty(v.a.$e),Gb.zg.add(u.a.yb(v.a.$e)),!0}n.a.instance.Sa(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Gb.Rg.value.Ef.id,pc);return!1}YJm(Gb,pc,
Fc){const ob=new L.a(0);Gb.forEach(gb=>{ob.Z(gb,0);return!0});pc.forEach(gb=>{ob.ub(gb)?ob.Z(gb,1):ob.Z(gb,3);return!0});Fc.forEach(gb=>{let Jb;({value:Jb}=ob.Bc(gb)).returnValue?1===Jb?ob.Z(gb,5):3===Jb?(n.a.instance.Sa(42754253,1,2,"TaskNode was found added by both sides of merge"),ob.Z(gb,3)):ob.Z(gb,2):ob.Z(gb,4);return!0});const Fb=new F.a;ob.forEach((gb,Jb)=>{0!==Jb&&2!==Jb&&1!==Jb&&Fb.add(gb);return!0});return Fb}static nh(){return new ub}static get instance(){return ub.Og.value}}ub.Og=new a.a(ub.nh);
Object(C.a)(ub,"TaskContentNodeComplexMerge",h.a,[]);class Pb{equals(Gb,pc){return Gb&&pc?Gb.UserId===pc.UserId&&Gb.Provider===pc.Provider&&Gb.DisplayName===pc.DisplayName&&Gb.Email===pc.Email:!Gb&&!pc}cK(){return 0}}Object(C.a)(Pb,"CommentTaskPersonComparer",null,[141]);class yc{equals(Gb,pc){return Gb&&pc?Gb.startDate?Gb.endDate?Gb.startDate.getTime()===pc.startDate.getTime()&&Gb.endDate.getTime()===pc.endDate.getTime():!pc.endDate:!pc.startDate:!Gb&&!pc}cK(){return 0}}Object(C.a)(yc,"CommentTaskScheduleEqualityComparer",
null,[141]);class bc{equals(Gb,pc){if(!Gb||!pc)return!Gb&&!pc;if(!Gb.extensions&&!pc.extensions)return!0;if(!Gb.extensions||!pc.extensions||Gb.extensions.count!==pc.extensions.count)return!1;let Fc=!0;Gb.extensions.forEach((ob,Fb)=>{let gb;return({value:gb}=pc.extensions.Bc(ob)).returnValue&&Fb===gb?!0:Fc=!1});return Fc}cK(){return 0}}Object(C.a)(bc,"ExtensionListEqualityComparer",null,[141]);class Ka{K5k(Gb,pc){return Gb&&pc?Gb.recordId===pc.recordId&&Ka.Zzg.equals(Gb.user,pc.user)&&Ka.Zzg.equals(Gb.assignee,
pc.assignee)&&Gb.type===pc.type&&Gb.title===pc.title&&Gb.priority===pc.priority&&Gb.isLossy===pc.isLossy&&Gb.completion===pc.completion&&Gb.commentId===pc.commentId&&Gb.time===pc.time&&Ka.SAj.equals(Gb.schedule,pc.schedule):!Gb&&!pc}equals(Gb,pc){return this.K5k(Gb,pc)}cK(){return 0}}Ka.Zzg=new Pb;Ka.SAj=new yc;new bc;Object(C.a)(Ka,"HistoryRecordEqualityComparer",null,[141]);var Bb=c(1918),tb=c(1498);class Kb extends h.a{constructor(Gb){super();this.kJa=Gb}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.SLb),
5);Gb.Z(u.a.yb(l.a.taskId),2);Gb.Z(u.a.yb(l.a.p9n),2);Gb.Z(u.a.yb(l.a.t9n),2);Gb.Z(u.a.yb(l.a.wwa),1);return Gb}G7f(Gb){if(!Gb.an.value.qu&&!Gb.Rg.value.qu){const pc=Gb.Rg.value.Ef.OG();pc.removeProperty(l.a.wwa);const Fc=Gb.Rg.value.Ef,ob=Gb.an.value.Ef;Gb.Rg=new a.a(()=>new tb.a(pc,Fc));Gb.an=new a.a(()=>new tb.a(pc,ob))}return super.G7f(Gb)}dB(Gb,pc){if(pc!==u.a.yb(l.a.wwa))return n.a.instance.Sa(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Gb.Rg.value.Ef.id,pc),!1;const Fc=Gb.Lk,ob=Gb.$d;n.a.instance.Sa(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fc.id,Fc.Qc,pc);pc=ob.getPropertyString(Gb.Rg.value.qu,l.a.wwa);const Fb=ob.getPropertyString(Gb.Rg.value.Ef,l.a.wwa),gb=ob.getPropertyString(Gb.an.value.Ef,l.a.wwa);pc=this.XJm(pc,Fb,gb);if(!pc)return!1;0<pc.length?ob.setPropertyString(Fc,l.a.wwa,pc):Fc.removeProperty(l.a.wwa);Gb.zg.add(u.a.yb(l.a.wwa));return!0}XJm(Gb,
pc,Fc){Gb=this.kJa.n0b(Gb);pc=this.kJa.n0b(pc);Fc=this.kJa.n0b(Fc);if(!Kb.nhi(Gb,pc))return n.a.instance.Sa(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Kb.nhi(Gb,Fc))return n.a.instance.Sa(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;Fc=Kb.BBk(Gb.length,pc,Fc);return this.kJa.FXf(Fc)}static nh(){const Gb=new Bb.a;return new Kb(Gb)}static get instance(){return Kb.Og.value}static BBk(Gb,pc,Fc){const ob=new F.a;for(let Fb=
0;Fb<pc.length;Fb++)ob.add(pc.J(Fb));for(;Gb<Fc.length;Gb++)ob.add(Fc.J(Gb));return ob}static nhi(Gb,pc){const Fc=Gb.length;if(Fc>pc.length)return!1;for(let ob=0;ob<Fc;ob++)if(!Kb.THj.equals(pc.J(ob),Gb.J(ob)))return pc.J(ob).recordId===Gb.J(ob).recordId&&n.a.instance.Sa(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Kb.Og=new a.a(Kb.nh);Kb.THj=new Ka;Object(C.a)(Kb,"TaskSingleNodeComplexMerge",h.a,[]);class Ib extends h.a{constructor(){super()}get Fn(){return 26}nk(){const Gb=
super.nk();Gb.Z(u.a.yb(v.a.$e),1);return Gb}dB(Gb,pc){const Fc=v.a.$e;if(pc===u.a.yb(Fc)){pc=Gb.Lk;const Fb=Gb.$d;var ob=Fb.getPropertyObjectIds(Gb.Rg.value.qu,Fc);const gb=Fb.getPropertyObjectIds(Gb.Rg.value.Ef,Fc),Jb=Fb.getPropertyObjectIds(Gb.an.value.Ef,Fc);ob=this.dKm(ob,gb,Jb);Fb.setPropertyObjectIds(pc,Fc,ob);Gb.zg.add(u.a.yb(Fc));return!0}return!1}dKm(Gb,pc,Fc){return this.fDa(Gb,pc,Fc)}static nh(){return new Ib}static get instance(){return Ib.Og.value}}Ib.Og=new a.a(Ib.nh);Object(C.a)(Ib,
"VectorClockContainerNodeComplexMerge",h.a,[]);class Wa extends h.a{constructor(){super()}get Fn(){return 27}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.ZX),1);return Gb}dB(Gb,pc){const Fc=l.a.ZX;if(pc===u.a.yb(Fc)){pc=Gb.Lk;const ob=Gb.$d,Fb=ob.getPropertyUint32(Gb.Rg.value.Ef,Fc)||0,gb=ob.getPropertyUint32(Gb.an.value.Ef,Fc)||0;ob.setPropertyUint32(pc,Fc,this.FAl(Fb,gb));Gb.zg.add(u.a.yb(Fc));return!0}return!1}FAl(Gb,pc){return Gb>pc?Gb:pc}static nh(){return new Wa}static get instance(){return Wa.Og.value}}
Wa.Og=new a.a(Wa.nh);Object(C.a)(Wa,"VectorClockNodeComplexMerge",h.a,[]);class vc extends h.a{constructor(){super()}get Fn(){return 28}get Kz(){return 0}nk(){const Gb=super.nk();Gb.Z(u.a.yb(l.a.tCh),3);Gb.Z(u.a.yb(l.a.Nc),3);Gb.Z(u.a.yb(l.a.P_k),5);Gb.Z(u.a.yb(l.a.Bsi),5);Gb.Z(u.a.yb(l.a.Sga),5);return Gb}static nh(){return new vc}static get instance(){return vc.Og.value}}vc.Og=new a.a(vc.nh);Object(C.a)(vc,"WordSectionNodeComplexMerge",h.a,[]);c.d(O,"a",function(){return Lc});class Lc{ivh(Gb,pc){switch(Gb.Qc){case 131073:return Gb.hasProperty(l.a.imageType)||
Gb.hasProperty(e.a.HZ)?this.Po(Oa.instance,pc):this.Po(Zb.instance,pc);case 1074135140:return this.Po(m.instance,pc);case 1074135137:return this.Po(A.instance,pc);case 1074135139:return this.Po(H.instance,pc);case 1074135138:return this.Po(E.instance,pc);case 1074135136:return this.Po(K.instance,pc);case 1074135157:return this.Po(N.instance,pc);case 1074135152:return this.Po(G.instance,pc);case 1074135153:return this.Po(P.instance,pc);case 1074135126:return this.Po(S.instance,pc);case 1074135127:return this.Po(W.instance,
pc);case 1074135145:return this.Po(ha.instance,pc);case 1074135144:return this.Po(X.instance,pc);case 1074135142:return this.Po(ra.instance,pc);case 1074135143:return this.Po(sa.instance,pc);case 1074135163:return this.Po(oa.instance,pc);case 1074135164:return this.Po(ka.instance,pc);case 1074135124:return this.Po(ia.instance,pc);case 1074135125:return this.Po(La.instance,pc);case 1074135122:return this.Po(Ga.instance,pc);case 393233:return this.Po(Oa.instance,pc);case 1073872970:return this.Po(Oa.instance,
pc);case 1074135170:return this.Po(Za.instance,pc);case 1074135168:return this.Po(ja.instance,pc);case 1074135166:return this.Po(ba.instance,pc);case 1074135167:return this.Po(qa.instance,pc);case 1074135169:return this.Po(Ma.instance,pc);case 1074135165:return this.Po(Ia.instance,pc);case 393234:return this.Po(pa.instance,pc);case 393229:return this.Po(Ra.instance,pc);case 393241:return this.Po(fb.instance,pc);case 393227:return this.Po(Xa.instance,pc);case 131120:return this.Po(rb.instance,pc);
case 393271:return this.Po(qb.instance,pc);case 393230:return this.Po(nb.a.instance,pc);case 131140:return this.Po(Hb.instance,pc);case 1179649:return this.Po(ua.instance,pc);case 1073872969:return this.Po(Fa.instance,pc);case 393252:return this.Po(lb.instance,pc);case 393250:return this.Po(zb.instance,pc);case 393251:return this.Po(Xb.instance,pc);case 1074135154:return this.Po(Ib.instance,pc);case 1074135161:return this.Po(ub.instance,pc);case 1074135162:return this.Po(Kb.instance,pc);case 1074135155:return this.Po(Wa.instance,
pc);case 1073872968:return this.Po(vc.instance,pc);case 1074135172:return this.Po(za.instance,pc);case 1074135171:return this.Po(wa.instance,pc);case 1074135149:return this.Po(va.instance,pc);case 1074135151:return this.Po(Sa.instance,pc)}return this.Po(h.a.instance,pc)}Po(Gb,pc){Gb.Wb=pc?pc():null;return Gb}}Object(C.a)(Lc,"GraphNodeComplexMergeFactory",null,[1868])},1822:function(C,O,c){c.r(O);C=c(0);var l=c(1478),e=c(77),a=c(282),h=c(64),m=c(1456);class v{constructor(F,J,I,K=0){this.R3h=F;this.groupType=
J;this.rkf=K;this.WYc=I}}Object(C.a)(v,"SortingGroup",null,[]);class u{constructor(F,J,I,K){this.order=F;this.z6=J;this.hTl=I;this.groupType=K}}Object(C.a)(u,"SortingProp",null,[]);var n=c(1449),x=c(1451),A=c(1447),H=c(28);class E{constructor(F,J){this.yqi={};this.xqi={};this.tqi=this.Eqi=1;this.ajh(F,J)}e2n(F,J,I){var K=A.a.YW(I)?this.yqi:this.xqi;I=new e.a;for(var N of J)J=Object(h.a)(u,K[l.a[N.groupType].toLowerCase()]),H.c(J)||I.add(new a.a(J,N));I.Sc((P,S)=>P.key.order<S.key.order?-1:1);Array.clear(F);
N=n.TellMeActor.instance.WY;for(J=0;J<I.count;){K=I.J(J).key.z6;var G=I.J(J).value;const P=new m.a(I.J(J).key.groupType);H.c(N)||N.Location===x.a.contextMenu||(P.displayName=I.J(J).key.hTl);for(const S of G.results)P.Ez(S);for(G=++J;G<I.count&&I.J(G).key.z6===K;)this.aPe(P,I.J(G).value),G=++J;F.push(P)}}Coo(F,J){this.tqi=this.Eqi=1;this.ajh(F,J)}ajh(F,J){this.a8i(F);for(var I=0;I<F.length;I++){let K=F[I];for(const N of K.WYc)this.q4j(N,I,K.R3h,K.groupType)}this.a8i(J);for(F=0;F<J.length;F++){I=J[F];
for(const K of I.WYc)this.p4j(K,F,I.R3h,I.groupType)}}a8i(F){F.sort((J,I)=>Object(h.a)(v,J).rkf>Object(h.a)(v,I).rkf?-1:1)}q4j(F,J,I,K){this.yqi[l.a[F].toLowerCase()]=new u(this.Eqi++,J,I,K)}p4j(F,J,I,K){this.xqi[l.a[F].toLowerCase()]=new u(this.tqi++,J,I,K)}aPe(F,J){for(let I=0;I<J.results.length;I++)F.Ez(J.results[I])}}Object(C.a)(E,"BaseGroupingSorter",null,[]);class L{constructor(){this.zUd=[new v(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new v(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new v(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new v("",13,[13]),new v("",22,[22])];this.uUd=[new v(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new v(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new v(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new v("",13,[13]),new v("",22,[22])];this.eqi=new E(this.zUd,this.uUd)}b1c(F,J,I,K=null,N=null){let G=!1;if(K){for(const P of A.a.YW(I)?
this.zUd:this.uUd)this.Ohn(P,K);G=!0}if(N){for(const P of A.a.YW(I)?this.zUd:this.uUd)this.Doo(J,P,N);G=!0}G&&this.eqi.Coo(this.zUd,this.uUd);this.eqi.e2n(F,J,I)}Ohn(F,J){const I=new e.a;for(var K of F.WYc){const N=J[l.a[K].toLowerCase()];I.add(new a.a(H.c(N)?Number.MAX_VALUE:N,K))}if(I.count){I.Sc((N,G)=>N.key<G.key?-1:1);J=Array(I.count);for(K=0;K<I.count;K++)J[K]=I.J(K).value;F.WYc=J}}Doo(F,J,I){let K=0;for(const N of J.WYc)if(l.a[N].toLowerCase()in I&&I[l.a[N].toLowerCase()])for(const G of F)if(G.groupType===
N){K+=I[l.a[N].toLowerCase()];break}J.rkf=K}}Object(C.a)(L,"SimplifiedGroupingSorter",null,[]);c.d(O,"GroupsPlacementInfo",function(){return M});class M{constructor(F){this.wqi={};this.uqi={};this.vqi={};this.zqi={};this.kzf={};this.Aqi=this.HFm=this.CFm=this.EFm=1;this.Bqi=null;this.iD=F;this.Rok();this.y8m();this.uok();this.nnk();F.uO&&(this.Bqi=new L)}XH(F){this.wqi[l.a[F].toLowerCase()]=this.EFm++}nL(F,J){this.uqi[l.a[F].toLowerCase()]=J}CJa(F){this.vqi[l.a[F].toLowerCase()]=this.CFm++}C1(F){this.zqi[l.a[F].toLowerCase()]=
this.HFm++}$D(F){this.kzf[l.a[F].toLowerCase()]=this.Aqi++}Rok(){const F=!!this.iD&&this.iD.$_a,J=!!this.iD&&this.iD.dUc,I=!!this.iD&&this.iD.Sgb,K=!!this.iD&&this.iD.Auf&&!A.a.jEb(),N=!!this.iD&&this.iD.EPc,G=!!this.iD&&this.iD.MNd,P=!!this.iD&&this.iD.Hsf;this.XH(4);this.XH(18);this.XH(16);this.XH(7);this.XH(17);this.XH(0);this.XH(1);P&&this.XH(25);N&&this.XH(23);F||this.XH(2);F&&!J||this.XH(8);this.XH(15);I&&this.XH(20);this.XH(14);this.XH(9);this.XH(12);this.XH(10);this.XH(11);F&&this.XH(2);F&&
!J&&this.XH(8);this.XH(19);G&&this.XH(24);this.XH(21);this.XH(13);K&&this.XH(22)}y8m(){this.nL(21,1);this.nL(4,3);this.nL(18,3);this.nL(16,3);this.nL(7,3);this.nL(17,5);this.nL(0,5);this.nL(1,1);this.nL(25,2);this.nL(2,1);this.nL(8,2);this.nL(15,3);this.nL(14,2);this.nL(24,3);this.nL(9,1);this.nL(12,1);this.nL(10,1);this.nL(11,1);this.nL(19,1);this.nL(23,1);this.nL(13,1);this.nL(20,2);this.nL(22,1)}uok(){this.CJa(4);this.CJa(0);this.CJa(17);this.CJa(7);this.CJa(16);this.CJa(18);this.CJa(15);this.CJa(20);
this.CJa(8);this.CJa(14)}nnk(){this.C1(14);this.C1(10);this.C1(12);this.C1(9);this.C1(11);this.C1(20);this.C1(15);this.C1(8);this.C1(2);this.C1(1);this.C1(24);this.C1(7);this.C1(18);this.C1(16);this.C1(17);this.C1(0);this.C1(4)}qzn(){this.kzf={};this.Aqi=1}lJl(F,J,I){this.qzn();const K=!!this.iD&&this.iD.$_a,N=!!this.iD&&this.iD.dUc,G=!!this.iD&&this.iD.Sgb,P=!!this.iD&&this.iD.Auf&&!A.a.jEb(),S=!!this.iD&&this.iD.EPc,W=!!this.iD&&this.iD.MNd,X=!!this.iD&&this.iD.Hsf;F=F&&N;this.$D(4);this.$D(18);
this.$D(16);this.$D(7);this.$D(17);this.$D(0);this.$D(1);X&&this.$D(25);S&&this.$D(23);K&&!N||!F||this.$D(8);J&&this.$D(15);K||this.$D(2);W&&this.$D(24);I&&this.$D(14);K&&!N||F||this.$D(8);J||this.$D(15);G&&this.$D(20);I||this.$D(14);this.$D(9);this.$D(12);this.$D(10);this.$D(11);K&&this.$D(2);K&&!N&&this.$D(8);this.$D(19);this.$D(21);this.$D(13);P&&this.$D(22);return this.kzf}QN(){return this.iD}}Object(C.a)(M,"GroupsPlacementInfo",null,[])},1824:function(C,O,c){C=c(0);var l=c(1693),e=c(59);class a{constructor(){this.source=
0;this.Xl=this.Zwa=this.U3=null;this.c3=0;this.l5b=!1;this.mode=this.mQa=0;this.cGc=null;this.XFb=e.a.create()}}Object(C.a)(a,"InputState",null,[]);class h{constructor(){this.timeout=this.succeeded=this.crash=!1;this.bM=null}}Object(C.a)(h,"OutputState",null,[]);class m{constructor(){this.J9h=this.C8d=this.v0c=!1;this.Wb=this.gVd=this.JKf=this.a3d=this.H4f=this.nxb=this.eKa=this.hG=this.bib=this.ufc=this.cho=this.O8k=this.Um=this.p3e=this.nq=this.du=this.lk=this.Cce=this.kCd=this.dAa=null}}Object(C.a)(m,
"RuntimeState",null,[]);c.d(O,"a",function(){return v});class v{constructor(){this.input=new a;this.runtime=new m;this.output=new h;this.logger=new l.a(this)}}Object(C.a)(v,"MergeState",null,[])},1825:function(C,O,c){c.r(O);C=c(0);var l=c(619),e=c(216),a=c(149),h=c(123),m=c(1565),v=c(1646),u=c(1674),n=c(5),x=c(1815);class A{constructor(I,K){this.start=I;this.end=K}}Object(C.a)(A,"MergeDiffIdx",null,[]);class H{constructor(I,K,N,G=!1,P=null,S=null,W=!0){this.V9c=this.U9c=this.TCg=this.Wrc=0;this.uWb=
this.Uie=null;this.B7a=P||new x.a;this.Pg=N;this.rpa=I.L3();this.H_j=K.L3();this.IO=new A(0,0);this.tS=new A(0,0);this.Nse=G;this.gpc=W;this.Wpa=S;this.Kqk();this.wOn()}get TJ(){return this.rpa}get mJ(){return this.H_j}get Vy(){return this.Wrc}get Lz(){return this.TCg}get Hsa(){return this.U9c}get Qka(){return this.V9c}get OXk(){const I=new e.a;for(let K=this.Uie.start;K<this.Uie.end;K++)I.add(this.TJ.mg(K));return I}get H4e(){const I=new e.a;for(let K=this.uWb.start;K<this.uWb.end;K++)I.add(this.mJ.mg(K));
return I}L5e(I){if(this.Lz<I.Lz){if(this.Lz+this.Hsa>I.Lz)return!0}else if(this.Lz>I.Lz){if(I.Lz+I.Hsa>this.Lz)return!0}else if(2===this.Vy&&3===I.Vy||3===this.Vy&&2===I.Vy||2===this.Vy&&2===I.Vy||3===this.Vy&&3===I.Vy)return!0;return!1}DRi(I,K,N,G){I.nF(K);I.IA(K,N);return G+=N.length-1}z8i(I,K,N,G,P){let S=this.TJ.mg(I),W=this.mJ.mg(K);if(!S||!W||!S.N3a&&!W.N3a)return{returnValue:!1,Hza:G,CFa:P};let X=new e.a,Y=new e.a;S.N3a&&(X=S.j1c(),S=X.mg(N?0:X.length-1));W.N3a&&(Y=W.j1c(),W=Y.mg(N?0:Y.length-
1));if(!S.Tz(W,this.B7a,this.Wpa,this.Nse,this.gpc))return{returnValue:!1,Hza:G,CFa:P};X.length&&(G=this.DRi(this.TJ,I,X,G));Y.length&&(P=this.DRi(this.mJ,K,Y,P));return{returnValue:!0,Hza:G,CFa:P}}eal(I,K,N,G,P,S){for(;P<=N&&S<=G;){const W=I.mg(P),X=K.mg(S);if(!W.Tz(X,this.B7a,this.Wpa,this.Nse,this.gpc))break;this.IO.start+=W.length;this.tS.start+=X.length;P++;S++}return{jTe:P,S8f:S}}cal(I,K,N,G,P,S){for(;P>=N&&S>=G;){const W=I.mg(P),X=K.mg(S);if(!W.Tz(X,this.B7a,this.Wpa,this.Nse,this.gpc))return{returnValue:!0,
Hza:P,CFa:S};P--;S--}return{returnValue:!1,Hza:P,CFa:S}}dal(I,K,N,G){let P=!1;do({jTe:I,S8f:K}=this.eal(this.TJ,this.mJ,N,G,I,K)),{Hza:N,CFa:G,returnValue:P}=this.z8i(I,K,!0,N,G);while(P);return{jTe:I,S8f:K,Hza:N,CFa:G}}bal(I,K,N,G){let P=!1;do{if(!({Hza:N,CFa:G}=this.cal(this.TJ,this.mJ,I,K,N,G)).returnValue)break;({Hza:N,CFa:G,returnValue:P}=this.z8i(N,G,!1,N,G))}while(P);return{Hza:N,CFa:G}}Kqk(){var I=0,K=0,N=this.TJ.length-1,G=this.mJ.length-1;0<=N&&this.TJ.mg(N);0<=G&&this.mJ.mg(G);({jTe:I,
S8f:K,Hza:N,CFa:G}=this.dal(I,K,N,G));if(I<N||K<G)({Hza:N,CFa:G}=this.bal(I,K,N,G));N++;G++;this.Uie=new A(I,N);this.uWb=new A(K,G);this.IO.end=this.IO.start;this.tS.end=this.tS.start;for(var P=I;P<N;P++){var S=this.TJ.mg(P);this.IO.end+=S.length}for(P=K;P<G;P++)S=this.mJ.mg(P),this.tS.end+=S.length;a.a.instance.Sa(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",I,N,K,G);a.a.instance.Sa(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.IO.start,this.IO.end,this.tS.start,this.tS.end);this.IO.start<=this.IO.end&&this.tS.start<=this.tS.end&&(I=this.TJ.mg(I),K=this.mJ.mg(K),P=this.TJ.mg(N),S=this.mJ.mg(G),N=this.TJ.mg(N-1),G=this.mJ.mg(G-1),a.a.instance.Sa(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",I,P,K,S,N,G))}wOn(){this.TCg=this.IO.start;this.U9c=this.V9c=0;this.IO.start===this.IO.end&&this.tS.start===
this.tS.end?this.Wrc=0:this.IO.start===this.IO.end&&this.tS.start<this.tS.end?(this.Wrc=1,this.V9c=this.tS.end-this.tS.start):this.tS.start===this.tS.end&&this.IO.start<this.IO.end?(this.Wrc=2,this.U9c=this.IO.end-this.IO.start):(this.Wrc=3,this.U9c=this.IO.end-this.IO.start,this.V9c=this.tS.end-this.tS.start);a.a.instance.Sa(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Vy,this.Lz,this.Hsa,this.Qka)}mim(I,K){return I.W2()&&
K.W2()?I.runId===K.runId&&I.Dg===K.Dg:!1}knm(I){if(!I.W2()||"\ufffc"!==I.text)return!1;I=I.Yzb;return I?I.hasProperty(n.a.Rj)||I.hasProperty(n.a.Wsd)||I.hasProperty(n.a.n6e)||I.hasProperty(n.a.n6)||I.hasProperty(n.a.imageType)||I.hasProperty(n.a.lNa)||I.hasProperty(n.a.oEb)||I.hasProperty(n.a.Gq)&&(I=this.Pg.getPropertyInt32(I,n.a.Gq))&&(36===I||35===I||24===I||23===I||33===I||34===I||44===I||45===I||42===I||43===I)?!0:!1:!1}uOc(I){return I.W2()&&!this.knm(I)}rsk(){if(2===this.Vy)return!1;var I=this.uWb.start;
if(!I)return!1;let K=null;for(var N=this.uWb.start;N<this.uWb.end;N++){const G=this.mJ.mg(N);if(this.uOc(G)){K=G;break}}if(!K)return!1;--I;for(N=this.mJ.mg(I);N&&!this.uOc(N);)I--,N=this.mJ.mg(I);return N&&this.mim(N,K)?!0:!1}PSh(I){const K=new e.a;for(let N=0;N<I.length;N++)I.J(N).N3a?K.IA(K.length,I.J(N).j1c()):K.insert(K.length,I.J(N));return K}oim(){if(3!==this.Vy||this.Hsa!==this.Qka)return!1;const I=this.PSh(this.OXk),K=this.PSh(this.H4e);if(I.length!==K.length)return!1;for(let N=0;N<I.length;N++)if(!I.J(N).Tz(K.J(N),
this.B7a,this.Wpa,!0,this.gpc))return!1;return!0}nim(){if(0!==this.Vy&&3!==this.Vy||this.TJ.length!==this.mJ.length)return!1;let I=!1;for(let K=0;K<this.TJ.length;K++){if(!this.TJ.J(K).Tz(this.mJ.J(K),this.B7a,this.Wpa,!0,this.gpc))return!1;if(3===this.TJ.J(K).type||1===this.TJ.J(K).type){const N=this.TJ.J(K),G=this.mJ.J(K);I=N.runId!==G.runId||N.Dg!==G.Dg||I}}return I}}Object(C.a)(H,"MergeBlockDiff",null,[]);var E=c(1527);class L{constructor(I,K){this.id=I;this.index=K}}Object(C.a)(L,"ParagraphStartIndex",
null,[]);var M=c(1575),F=c(1513);c.d(O,"ParagraphMerge",function(){return J});class J{constructor(I,K,N,G,P,S,W){this.vUb=this.zsb=this.Do=this.Hw=null;this.Ah=!1;this.t5g=this.lFg=this.cxg=this.rra=this.fHa=this.rpa=null;this.ge=I;this.EE=K;this.dza=G;this.Txa=N;this.Vpa=P;this.Wpa=S;this.Pg=W}gZh(I){const K=new l.a;I.TJ.forEach(N=>{2===N.type&&K.add(N.Cj);return!0});I.mJ.forEach(N=>{2===N.type&&K.remove(N.Cj);return!0});return K}JVh(I){const K=new e.a;I.mJ.forEach(N=>{2===N.type&&K.add(N.Cj);return!0});
return K}jrh(I){const K=new e.a;let N=0,G=0;I.mJ.forEach(P=>{2===P.type&&(K.add(new L(P.Cj,N<I.Lz?N:N<I.Lz+I.Qka?I.Lz:N-I.Qka+I.Hsa)),N=G);G+=P.length;return!0});return K}XDk(I,K){var N=this.jrh(I);const G=this.jrh(K);I=this.gZh(I);const P=this.gZh(K);K=new e.a;const S=new l.a;let W=0;for(let X=0;X<N.length;X++){const Y=N.J(X);if(W<G.length){let ca=G.J(W);for(;W<G.length&&ca.index<=Y.index;){if(ca.id.equals(Y.id)){W++;break}I.contains(ca.id)||S.contains(ca.id)||(K.add(ca.id),S.add(ca.id));W++;ca=
G.J(W)}}P.contains(Y.id)||(K.add(Y.id),S.add(Y.id))}for(;W<G.length;)N=G.J(W),I.contains(N.id)||S.contains(N.id)||(K.add(N.id),S.add(N.id)),W++;return K}initialize(){if(this.Ah){const I=!!this.Hw&&!!this.Do;this.ge.logger.Tg(Object.assign(new E.a,{kj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return I}this.Ah=!0;if(!({TJ:this.rpa,bGc:this.fHa,v3c:this.rra,Ksd:this.cxg,lCd:this.lFg,Dce:this.t5g}=F.a.Gvh(this.ge,this.Pg,this.EE,this.Txa,this.dza,this.Vpa,!1,!1)).returnValue)return!1;
this.Hw=new H(this.rpa,this.fHa,this.Pg,void 0,void 0,this.Wpa);this.Do=new H(this.rpa,this.rra,this.Pg,void 0,void 0,this.Wpa);a.a.instance.Sa(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Hw.Hsa,this.Hw.Qka,this.Do.Hsa,this.Do.Qka));return!0}rFa(){a.a.instance.Sa(593826836,1,4,"Attempting to merge with LCS");let I=!1;const K=new u.a(this.Pg,this.ge);let N=null,G=null;var P=null;const S=X=>this.ge.runtime.lk.J(X),
W=X=>this.ge.runtime.nq.J(X)||this.ge.runtime.lk.J(X);this.Hw=new H(this.rpa,this.fHa,this.Pg,void 0,void 0,this.Wpa,!1);this.Do=new H(this.rpa,this.rra,this.Pg,void 0,void 0,this.Wpa,!1);({updateHints:N}=K.fxh(this.EE,S,this.Txa,X=>this.ge.runtime.du.J(X)||this.ge.runtime.lk.J(X),this.Hw.Lz,this.Hw.Lz+this.Hw.Hsa,this.Hw.Lz+this.Hw.Qka)).returnValue&&({updateHints:G}=K.fxh(this.EE,S,this.dza,W,this.Do.Lz,this.Do.Lz+this.Do.Hsa,this.Do.Lz+this.Do.Qka)).returnValue&&(I=!0);I||(a.a.instance.Sa(593826835,
1,2,"Failed to create update hints with LCS"),I=!1);I&&(P=new M.a(this.ge,this.EE,this.Txa,this.dza,X=>this.ge.runtime.Wb?this.ge.runtime.Wb.isFeatureEnabled(X):!1,this.Pg,null,N,G),({Um:P}=P.hhc()).returnValue||(a.a.instance.Sa(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.ge.logger.Tg(Object.assign(new E.a,{kj:"TryLCSMerge",eventId:"9zrqs"})),I=!1));a.a.instance.Sa(593826833,1,I?4:2,"TryLCSMerge: [Success: {0}]",I);return{returnValue:I,Um:P}}hhc(){let I;I=null;if(!this.initialize())return this.ge.logger.ZT("ParagraphMerge Initialize"),
this.C0a(),{returnValue:!1,Um:I};this.ge.logger.ZT("ParagraphMerge Initialize");let K;this.ge.logger.r7d(2);let N=({rFa:K}=this.p_k()).returnValue;N=N&&({Um:I,rFa:K}=this.SIc(this.ge,this.Pg,this.Vpa,this.vUb,this.zsb)).returnValue;this.ge.logger.hZf();if(!N){this.ge.logger.ZT("ParagraphMerge DoMergeInteral");if(K){this.ge.logger.r7d(3);({Um:I,returnValue:N}=this.rFa());this.ge.logger.hZf();if(N)return{returnValue:!0,Um:I};this.C0a();return{returnValue:!1,Um:I}}this.C0a();return{returnValue:!1,Um:I}}if(!({Um:I,
rFa:K}=this.SIc(this.ge,this.Pg,this.Vpa,this.vUb,this.zsb)).returnValue)return this.ge.logger.ZT("ParagraphMerge DoMergeInteral"),this.C0a(),{returnValue:!1,Um:I};this.ge.logger.ZT("ParagraphMerge DoMergeInteral");return{returnValue:!0,Um:I}}SIc(){let I;if(!({F_d:I}=F.a.SIc(this.ge,this.Pg,this.Vpa,this.vUb,this.zsb)).returnValue)return this.ge.logger.ZT("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.C0a(),{returnValue:!1,Um:I,rFa:!0};this.ge.logger.ZT("ParagraphMerge GetMergeableObjectsFromMergeBlocks");
return{returnValue:!0,Um:I,rFa:!1}}C0a(I=!1){a.a.instance.Aha(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+I+"] BaseRevisionMergeBlocksList: {0}",this.cxg);a.a.instance.Aha(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.lFg);a.a.instance.Aha(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.t5g);I=new e.a;F.a.p9b(this.Pg,"BaseObjects_",this.EE,I);F.a.p9b(this.Pg,"FavoredObjects_",this.Txa,I);F.a.p9b(this.Pg,"ConflictObjects_",this.dza,I);F.a.nzm(this.ge,I)}tkh(I){let K,N;N=K=0;
if(0===this.Hw.Vy)K=this.Do.Lz;else if(1===this.Hw.Vy)K=this.Do.Lz<this.Hw.Lz?this.Do.Lz:this.Do.Lz===this.Hw.Lz?I||1!==this.Do.Vy?this.Do.Lz+this.Hw.Qka:this.Do.Lz:this.Do.Lz+this.Hw.Qka;else if(2===this.Hw.Vy||3===this.Hw.Vy)K=this.Do.Lz<=this.Hw.Lz?this.Do.Lz:this.Do.Lz+(this.Hw.Qka-this.Hw.Hsa);if(2===this.Do.Vy||3===this.Do.Vy)N=K+this.Do.Hsa;return{A3h:K,DSl:N}}gJh(I,K){let N;N=0;if(!K)return{returnValue:!0,SSc:N};let G=0,P=0;for(;G<I.length;){let S;for(let W=G;W<I.length;W++){G=W;S=I.J(W);
const X=S.length;P+=X;if(!(P<K)){if(P>K)if(S.N3a)I.nF(G),I.IA(G,S.j1c()),P-=X;else return a.a.instance.Sa(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",K),this.ge.logger.Tg(Object.assign(new E.a,{kj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,SSc:N};break}}if(P===K)return G++,N=G,{returnValue:!0,SSc:N}}a.a.instance.Sa(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",
K);this.ge.logger.Tg(Object.assign(new E.a,{kj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,SSc:N}}Cfk(I,K,N){let G=0;var P=0,S=!1;const W=this.Do.H4e.L3();if(this.Do.rsk())for(--K;0<=K;K--){let X=I.J(K);if(this.Do.uOc(X)){P=I.J(K);G=P.runId;P=P.Dg;S=!0;break}}S||((P=I.J(N))&&this.Do.uOc(P)?(G=P.runId,P=P.Dg):P=G=0);for(I=0;I<W.length;I++)N=W.J(I),N.W2()&&(S=N,this.Do.uOc(N)?(S.runId=G,S.Dg=P):(S.runId=0,S.Dg=0));return W}Egi(I){if(2===I.length){const K=1===I.J(0).type?I.J(0):
null;I=2===I.J(1).type;if(K&&I&&""===K.text)return!0}return!1}p_k(){const I=this.Hw.nim();if(!I&&0===this.Hw.Vy)return this.vUb=this.Do.mJ.L3(),this.zsb=this.JVh(this.Do),{returnValue:!0,rFa:!1};if(0===this.Do.Vy)return this.vUb=this.Hw.mJ.L3(),this.zsb=this.JVh(this.Hw),{returnValue:!0,rFa:!1};(this.Egi(this.Hw.mJ)||this.Egi(this.Do.mJ))&&this.ge.logger.wni(Object.assign(new E.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!I){var K=this.Hw.L5e(this.Do);K&&this.Vpa(55)&&(a.a.instance.Sa(17326359,
1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Hw=new H(this.rpa,this.fHa,this.Pg,!0,void 0,this.Wpa),this.Do=new H(this.rpa,this.rra,this.Pg,!0,void 0,this.Wpa),K=this.Hw.L5e(this.Do));if(K)return a.a.instance.Sa(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.ge.logger.Tg(Object.assign(new v.a,{kj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,
rFa:!0}}var N;K=0;this.zsb=this.XDk(this.Hw,this.Do);({A3h:N,DSl:P}=this.tkh(!1));const G=this.Hw.mJ.L3();if(!({SSc:N}=this.gJh(G,N)).returnValue||(2===this.Do.Vy||3===this.Do.Vy)&&!({SSc:K}=this.gJh(G,P)).returnValue)return{returnValue:!1,rFa:!1};if(2===this.Do.Vy||3===this.Do.Vy){this.Ydc(G,K);this.Ydc(G,N-1);var P=null;for(var S=K-1;S>=N;S--)2===G.J(S).type&&(P=G.J(S)),G.nF(S);0<G.length&&(S=G.J(G.length-1),2!==S.type&&4!==S.type&&P&&(this.ge.runtime.Wb.Lt(79),this.ge.runtime.Wb.isFeatureEnabled(79)&&
(G.add(P),this.zsb.add(P.Cj))));a.a.instance.Sa(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",K-N-1,N)}if(1===this.Do.Vy||3===this.Do.Vy)P=this.Do.H4e,I&&(P=this.Cfk(G,N,K)),this.Ydc(G,N-1),this.Ydc(G,N),this.Ydc(P,0),this.Ydc(P,P.length-1),G.IA(N,P),a.a.instance.Sa(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",N,I,P.Fq());this.vUb=G;return{returnValue:!0,rFa:!1}}Ydc(I,K){0>K||K>=I.length||(I=I.J(K),
Object(h.a)(m.a,I)&&(I.dNa=!0))}F3c(I,K){let N;N=K;if(!this.initialize())return{returnValue:!1,C2a:I,aoa:N};if(this.Do.L5e(this.Hw))return this.C0a(!0),this.ge.logger.Tg(Object.assign(new v.a,{kj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,C2a:I,aoa:N};if(0===this.Do.Vy||3===this.Do.Vy&&this.Do.oim())return{returnValue:!0,C2a:I,aoa:K};let G;({A3h:G}=this.tkh(!0));K<G||K===G&&(1!==this.Do.Vy||1===this.Do.Vy&&1===this.Hw.Vy&&K===this.Hw.Lz+this.Hw.Qka)?N=K:(N=K+this.Do.Qka-this.Do.Hsa,N<
G&&(N=G));return{returnValue:!0,C2a:I,aoa:N}}}Object(C.a)(J,"ParagraphMerge",null,[1865])},1826:function(C,O,c){c.r(O);C=c(0);var l=c(1582),e=c(1510),a=c(1478),h=c(1695),m=c(1509);class v{constructor(M="",F="",J="",I=-99999,K=-1,N=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=F?F:"";this.Type=J?J:"";this.Score=I;this.Age=K;this.Count=N}}Object(C.a)(v,"Suggestion",null,[]);class u{constructor(M,F){this.GroupType=this.Suggestions=null;
this.Suggestions=M;this.GroupType=F}}Object(C.a)(u,"SuggestionGroup",null,[]);class n{}n.help="help";n.answer="answer";n.commands="commands";n.aJn="servicecommands";n.template="template";Object(C.a)(n,"SuggestionGroupType",null,[]);var x=c(1449),A=c(1447),H=c(2),E=c(36);c.d(O,"InteractionLogger",function(){return L});class L{constructor(M,F,J){this.woe=0;this.VJe=this.Wqc=null;this.xd=M;this.ZHe=this.Mle=this.jte=!1;this.PBj=F;this.rg=H.AFrameworkApplication.af;this.qc=J;this.q9c=this.ECe=0}get Vna(){return this.xd.Vna}A7d(M){this.xd.A7d(M)}Noi(){if(this.Wqc){var M=
0;for(const F of this.Wqc)this.xd.ZCm(F,M++);this.Wqc=null}}beginQuery(M,F,J){this.xd.OCm(M,F,J)}yib(M,F){this.xd.pjk(M,F);this.jte=!0;this.ZHe=!1}fva(){this.jte=!1;this.Mle||(this.Noi(),this.xd.TEh(this.woe))}PCm(M,F){this.xd.QCm(M,F)}GSm(M,F,J,I,K){for(const N of this.PBj)if(M.startsWith(N)){this.ZHe=!0;break}this.xd.zym(M,F,J,I,K)}nTm(M){this.Mle=!1;this.woe=M;this.jte||this.ZHe||(this.Noi(),this.xd.TEh(this.woe,!1))}mTm(M,F){this.xd.Fym(M,F);this.Mle=!0}Xaf(M,F){if(!M.count)return"";let J="";
const I=Date.now();for(let K of M)M=(I-K.timeStamp)/1E3,M=A.a.q7f(M),0<J.length&&(J+=";"),J+=F?K.commandId:K.controlId,J+=":",J+=M.toString();return J}m1a(){var M=this.Xaf(l.a.instance.G2b(),!1);0<M.length&&this.xd.xym(M);M=this.Xaf(l.a.instance.xdb(),!0);0<M.length&&this.xd.Rxm(M);M=this.Xaf(l.a.instance.Jnc,!0);0<M.length&&this.xd.Bzm(M);M=x.TellMeActor.instance.ESg;0<M.length&&this.xd.MCm(E.c(M))}tDm(M){this.xd.cym(M)}l7(M,F,J,I,K,N,G,P=null){this.xd.JAm(M,F,J,I,K,N,G,P)}nyf(M,F,J,I){this.xd.nyf(M,
F,J,I)}Yz(M,F,J=null){this.xd.Faa(M,F,J)}onError(M,F,J=null){this.xd.B0a(M,F,J)}MNn(M){this.Wqc=M}pMl(M){const F=[];if(!M)return F;for(let J=0;J<M.length;J++){const I=a.a[M[J].groupType].toLowerCase(),K=[],N=M[J].results;if(N){for(let G=0;G<N.length;G++)"findindocument"===I?Array.add(K,new v("","",I,N[G].score,N[G].Drd,N[G].count)):Array.add(K,new v(N[G].label,N[G].description,I,N[G].score,N[G].Drd,N[G].count));"answer"===I||"definition"===I||"wolframanswer"===I||"entity"===I?Array.add(F,new u(K,
n.answer)):"classifier"===I||"appsforoffice"===I?Array.add(F,new u(K,n.commands)):"serviceclassifier"===I?Array.add(F,new u(K,n.aJn)):"assistance"===I?Array.add(F,new u(K,n.help)):("document"===I||"people"===I||"findindocument"===I||"notes"===I||"image"===I||"template"===I)&&Array.add(F,new u(K,I))}}return F}Aif(M,F){const J={};J.Query=F;J.SuggestionGroups=E.c(this.pMl(M));return E.c(J)}c1h(M){const F={"Content-Type":"application/json",Accept:"application/json"};F["X-Office-Version"]=H.AFrameworkApplication.buildVersion;
F["X-Office-Application"]=H.AFrameworkApplication.K.lb("Application");F["X-Office-Platform"]="WAC";F["X-TellMe-SqmUserId"]=H.AFrameworkApplication.K.lb("LoggableUserId")||"";F["X-TellMe-SessionId"]=this.xd.Vna.kma;F["X-TellMe-SuggestionTypes"]="Ranker";F["X-TellMe-Culture"]=H.AFrameworkApplication.uiCulture;F["X-TellMe-ProcessSessionId"]=H.AFrameworkApplication.userSessionId;F["X-TellMe-Flights"]=M;F["X-TellMe-PartialQueryIndex"]=this.ECe;return F}eHb(M,F,J){this.l7(F.length,"RankerLogging",M.data.Df.toString(),
Math.round(window.performance.now()-J),m.a.qbj,!0,e.a.vMa)}RGb(M,F,J){this.l7(F.length,"RankerLogging",M.data.Df.toString(),Math.round(window.performance.now()-J),m.a.qbj,!1,e.a.vMa)}d1h(){this.VJe||(this.VJe=new h.a(this.qc,null,6E3));return this.VJe.u8}pyf(M){const F=this.Aif(this.Wqc,M),J=this.c1h("RankerLogging"),I=window.performance.now();this.rg.Mj(this.d1h(),2,F,J,!1,0,K=>{this.eHb(K,M,I)},K=>{this.RGb(K,M,I)},null,null,!1,4E3,6E3);this.ECe++}gzn(){this.ECe=0}qYf(M){this.q9c=M}}Object(C.a)(L,
"InteractionLogger",null,[])},1827:function(C,O,c){c.r(O);C=c(0);var l=c(16),e=c(5),a=c(149),h=c(216),m=c(59),v=c(1638),u=c(1564),n=c(1525),x=c(1513);class A{constructor(M,F,J=null){this.author=M;this.iSc=F;this.tNf=J||m.a.nil}Tz(M){return M?this.author===M.author&&this.iSc===M.iSc&&this.tNf===M.tNf:!1}}Object(C.a)(A,"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(M,F,J){this.insertion=M||H.S6e;this.deletion=F||H.S6e;this.QDa=J||H.S6e}get ZXl(){return 0<this.insertion.author.length}get BXl(){return 0<
this.deletion.author.length}get yYl(){return 0<this.QDa.author.length}Tz(M){return M?this.insertion.Tz(M.insertion)&&this.deletion.Tz(M.deletion)&&this.QDa.Tz(M.QDa):!1}}H.S6e=new A("",0);Object(C.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var E=c(1692);c.d(O,"ParagraphMergeBlockCreator",function(){return L});class L extends u.a{constructor(M,F,J,I,K,N,G){super();this.maxValue=Number.MAX_VALUE;this.nA=new v.a;this.MOb=null;this.dN=0;this.RLg=!1;this.Vrc="";this.Rhe=M;this.xs=F;this.Ut=J;this.mXj=
I;this.Sad=K;this.bLg=N;this.Pg=G;if(this.Pg.hasProperty(this.xs,l.a.mo))if(this.Pg.hasProperty(this.xs,e.a.Nc))if(this.Pg.hasProperty(this.xs,e.a.Iq))if(this.Pg.hasProperty(this.xs,e.a.gt))if(this.Pg.hasProperty(this.xs,l.a.wn))if(this.h1=this.Pg.getPropertyString(this.xs,l.a.mo),this.dNe=this.Pg.getPropertyUint32(this.xs,e.a.Nc),this.Kr=this.Pg.getPropertyUint32s(this.xs,e.a.Iq),this.aid=this.Pg.getPropertyUint32s(this.xs,e.a.gt),this.Cqe=this.Pg.getPropertyObjectIds(this.xs,l.a.wn),this.h1||""===
this.h1)if(this.h1.length||1!==this.Cqe.length||(this.Kr.length||(this.Kr.add(0),a.a.instance.Sa(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.aid.length||(this.aid.add(0),a.a.instance.Sa(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.KOj=this.zEd(this.xs,e.a.nEf,this.Kr.length),this.Gtc=this.zEd(this.xs,l.a.Wua,this.Kr.length),this.pja=this.zEd(this.xs,l.a.olb,this.Kr.length),this.Eia=
this.zEd(this.xs,e.a.gMa,this.Kr.length),this.bja=this.xPl(this.xs,e.a.SDa,this.Kr.length),this.Y3l(),M=this.Pg.hasProperty(this.xs,l.a.km)?this.Pg.getPropertyUint32s(this.xs,l.a.km):new h.a,this.Ukd=x.a.s1i(M,this.h1.length),this.Kr.length!==this.aid.length)a.a.instance.Sa(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",F.id);else if(this.Kr.length!==this.Cqe.length)a.a.instance.Sa(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",
F.id);else{this.bLg&&(this.Pg.hasProperty(this.xs,e.a.$u)?this.MOb=this.Pg.getPropertyObjectIds(this.xs,e.a.$u):(a.a.instance.Sa(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",F.id),this.MOb=this.oZ(this.Kr.length,m.a.nil)),this.Kr.length!==this.MOb.length&&(a.a.instance.Sa(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",F.id,this.Kr.length,this.MOb.length),this.MOb=this.oZ(this.Kr.length,
m.a.nil)));if(this.Kr.length!==this.Gtc.length||this.Kr.length!==this.pja.length||this.Kr.length!==this.Eia.length||this.Kr.length!==this.bja.length)this.Kr.length===this.Gtc.length||this.Sad||a.a.instance.Sa(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",F.id,this.Kr.length,this.Gtc.length),this.Kr.length===this.pja.length||this.Sad||a.a.instance.Sa(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",
F.id,this.Kr.length,this.pja.length),this.Kr.length===this.Eia.length||this.Sad||a.a.instance.Sa(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",F.id,this.Kr.length,this.Eia.length),this.Kr.length===this.bja.length||this.Sad||a.a.instance.Sa(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",
F.id,this.Kr.length,this.bja.length),M=this.Pg.getPropertyBool(this.xs,l.a.BZe),a.a.instance.Sa(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",F.id,K,null==M?!1:M),this.Gtc=this.oZ(this.Kr.length,!0),this.pja=this.oZ(this.Kr.length,!1),this.Eia=this.oZ(this.Kr.length,!1),this.bja=this.oZ(this.Kr.length,0),this.Pg.setPropertyBool(this.xs,l.a.BZe,!1);this.nA.xso(this.Kr.length)?(this.Ukd.length!==this.Kr.length+1&&a.a.instance.Sa(3993801,
1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",F.id,this.Kr.length,this.Ukd.length),this.NLj=!0):a.a.instance.Sa(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",F.id)}else a.a.instance.Sa(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",
F.id);else a.a.instance.Sa(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id)}Y3l(){this.Pg.hasProperty(this.xs,e.a.lCa)?this.nA.Lfb=this.Pg.getPropertyBools(this.xs,e.a.lCa):
this.nA.Lfb=this.oZ(this.Kr.length,!1);this.Pg.hasProperty(this.xs,e.a.lea)?this.nA.Zbb=this.Pg.getPropertyBools(this.xs,e.a.lea):this.nA.Zbb=this.oZ(this.Kr.length,!1);this.Pg.hasProperty(this.xs,e.a.mCa)?this.nA.Kfb=this.Pg.getPropertyStrings(this.xs,e.a.mCa):this.nA.Kfb=this.oZ(this.Kr.length,"");this.Pg.hasProperty(this.xs,e.a.GAa)?this.nA.Ybb=this.Pg.getPropertyStrings(this.xs,e.a.GAa):this.nA.Ybb=this.oZ(this.Kr.length,"");this.Pg.hasProperty(this.xs,e.a.nCa)?this.nA.Mfb=this.Pg.getPropertyListOfMilliseconds(this.xs,
e.a.nCa):this.nA.Mfb=this.oZ(this.Kr.length,0);this.Pg.hasProperty(this.xs,e.a.HAa)?this.nA.pXa=this.Pg.getPropertyListOfMilliseconds(this.xs,e.a.HAa):this.nA.pXa=this.oZ(this.Kr.length,0);this.Pg.hasProperty(this.xs,e.a.RDa)?this.nA.T1a=this.Pg.getPropertyBools(this.xs,e.a.RDa):this.nA.T1a=this.oZ(this.Kr.length,!1);this.Pg.hasProperty(this.xs,e.a.mFa)?this.nA.ojb=this.Pg.getPropertyStrings(this.xs,e.a.mFa):this.nA.ojb=this.oZ(this.Kr.length,"");this.Pg.hasProperty(this.xs,e.a.nFa)?this.nA.qjb=this.Pg.getPropertyListOfMilliseconds(this.xs,
e.a.nFa):this.nA.qjb=this.oZ(this.Kr.length,0);this.Pg.hasProperty(this.xs,e.a.Dwa)?this.nA.pjb=this.Pg.getPropertyObjectIds(this.xs,e.a.Dwa):this.nA.pjb=this.oZ(this.Kr.length,m.a.nil)}zEd(M,F,J){return this.Pg.hasProperty(M,F)?this.Pg.getPropertyBools(M,F):this.oZ(J,!1)}xPl(M,F,J){return this.Pg.hasProperty(M,F)?this.Pg.getPropertyUint32s(M,F):this.oZ(J,0)}oZ(M,F){const J=new h.a;for(let I=0;I<M;I++)J.add(F);return J}PNl(M){const F=this.Ukd.mg(M);M=this.Ukd.mg(M+1);return this.h1.substring(F,M)}YVh(){if(this.RLg)return null;
var M=this.dN<this.Kr.length?this.Kr.mg(this.dN):this.maxValue;if(M===this.maxValue||this.mXj&&!this.h1.length)return this.RLg=!0,M=new n.a(this.Ut,this.xs.id,this.dNe),this.Vrc=this.mRe(this.Vrc,M.toString()),M;const F=this.aid.mg(this.dN),J=this.Cqe.mg(this.dN),I=this.KOj.mg(this.dN),K=this.Gtc.mg(this.dN),N=this.pja.mg(this.dN),G=this.Eia.mg(this.dN),P=this.bja.mg(this.dN),S=this.bLg?this.MOb.mg(this.dN):null;var W=null;this.nA.Lfb.mg(this.dN)&&(W=new A(this.nA.Kfb.mg(this.dN)||"",this.nA.Mfb.mg(this.dN)));
var X=null;this.nA.Zbb.mg(this.dN)&&(X=new A(this.nA.Ybb.mg(this.dN)||"",this.nA.pXa.mg(this.dN)));var Y=null;this.nA.T1a.mg(this.dN)&&(Y=new A(this.nA.ojb.mg(this.dN)||"",this.nA.qjb.mg(this.dN),this.nA.pjb.mg(this.dN)));W=new H(W,X,Y);X=this.PNl(this.dN);this.dN++;Y=X.startsWith("\ufddfHYPERLINK ");M=new E.a(this.Rhe,this.Ut,this.xs.id,F,M,J,X,I,!Y,K,N,G,P,W,S);this.Vrc=this.mRe(this.Vrc,M.toString());return M}HVh(){let M;M=null;var F="";if(!this.NLj)return{rAf:M,P0a:F};if(F=this.YVh())M=new h.a,
M.add(F);for(;F=this.YVh();)M.add(F);F=this.Vrc;return{rAf:M,P0a:F}}}Object(C.a)(L,"ParagraphMergeBlockCreator",u.a,[])},1831:function(C,O,c){c.r(O);C=c(0);var l=c(216),e=c(1564),a=c(1524);class h extends a.a{constructor(v,u){super(4,v,u)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Cj)}u2b(){return"Table"}clone(){return new h(this.source,this.Cj)}Tz(v,u,n,x=!1){return super.Tz(v,u,n,x)?this.Cj.equals(v.Cj):!1}get length(){return 1}}Object(C.a)(h,"TableMergeBlock",
a.a,[]);c.d(O,"TableMergeBlockCreator",function(){return m});class m extends e.a{constructor(v,u){super();this.lxg=new h(u,v.id)}HVh(){let v;v=new l.a;v.add(this.lxg);return{rAf:v,P0a:this.mRe("",this.lxg.toString())}}}Object(C.a)(m,"TableMergeBlockCreator",e.a,[])},1909:function(C,O,c){c.r(O);var l=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},e=c(0),a=c(44),h=c(70);class m extends Sys.EventArgs{constructor(Q,xa){super();this.cbe=Q;this.actualValue=xa}}Object(e.a)(m,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var v=c(32);class u{constructor(){this.mPb=[];this.WAg=this.cme=0;this.Hh=null;this.sa=new h.a}init(Q,xa,jb){this.Hh=Q;this.cme=xa;this.WAg=jb;this.Hh.lrd(Object(a.a)(this,this.LGb,"onCpuMeterFrameAvailable"));
this.U8j(Object(a.a)(this,this.QIk,"cpuPercentThresholdExceeded"))}LGb(Q,xa){xa.FSc&&(Array.enqueue(this.mPb,xa.FSc.CP),this.mPb.length>this.WAg&&(Array.dequeue(this.mPb),this.fvk()))}fvk(){var Q=this.mPb.length;let xa=0;for(let jb=0;jb<Q;jb++){const Nb=Array.dequeue(this.mPb);xa+=Nb;Array.enqueue(this.mPb,Nb)}Q=xa/Q;Q>this.cme&&this.sa.raiseEvent("CPTTE",new m(this.cme,Q))}QIk(Q,xa){v.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.Dxd(xa.cbe,xa.actualValue))}U8j(Q){this.sa.addHandler("CPTTE",
Q)}Dxd(Q,xa){const jb={};jb.ThresholdValue=Q;jb.ActualValue=xa;return jb}}Object(e.a)(u,"CpuMeterMonitor",null,[1728]);var n=c(433);class x{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(x,"ProfileInformation",null,[]);var A=c(7),H=c(29),E=c(200),L=c(78);class M{constructor(Q=0,xa=0){this.wqb=!1;this.Spb={};this.Jfd=Q;this.bgd=xa;this.GLe=0;H.a.addHandler(window.self,A.a.Xbh,()=>{this.wqb=!0});H.a.addHandler(window.self,A.a.Ybh,()=>{this.wqb=!1})}$bh(Q,xa,jb){const Nb=M.generateKey(xa,jb);
Nb in this.Spb?xa=this.Spb[Nb]:(xa=new x,xa.S=jb?1:0,this.Spb[Nb]=xa,this.GLe++);xa.C++;xa.M=Q>xa.M?Q:xa.M;xa.T+=Q}yza(Q,xa){this.$bh(Q,xa,!1);this.wqb&&this.$bh(Q,xa,!0)}getData(){if(0<this.bgd&&this.GLe>this.bgd)return this.Xpl();const Q=0<this.Jfd,xa={},jb=this.Spb;for(let Bc in jb){var Nb=Bc;const gd=jb[Bc];this.aVi(gd);Q&&gd.T>=this.Jfd&&(xa[Nb]=gd)}return Q?L.a.lf(xa)?null:xa:this.Spb}Xpl(){var Q=0<this.Jfd,xa=[];const jb=this.Spb;for(let Nb in jb){const Bc={key:Nb,value:jb[Nb]};let gd=Bc.value;
(!Q||gd.T>=this.Jfd)&&Array.add(xa,Bc)}if(xa.length>this.bgd)xa.sort((Nb,Bc)=>Bc.value.T-Nb.value.T),xa=xa.slice(0,this.bgd);else if(!xa.length)return null;Q={};for(const Nb of xa)xa=Nb.value,this.aVi(xa),Q[Nb.key]=xa;return Q}aVi(Q){Q.M=E.a.qU(Q.M,0);Q.T=E.a.qU(Q.T,0)}reset(){this.Spb={};this.GLe=0}static generateKey(Q,xa){return xa?Q+" [it]":Q}}Object(e.a)(M,"FunctionCallAggregator",null,[944]);var F=c(2),J=c(1201);class I{}Object(e.a)(I,"CpuMeterFrame",null,[]);class K extends Sys.EventArgs{constructor(Q){super();
this.FSc=Q}}Object(e.a)(K,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class N{}Object(e.a)(N,"MiniTaskItemInfo",null,[]);class G{}Object(e.a)(G,"TaskItemInfo",null,[]);var P=c(1010),S=c(1361),W=c(199);class X{constructor(Q,xa,jb,Nb,Bc){this.$tb=0;this.NY=null;this.Ykd=this.G2g=0;this.H_g=!1;this.FQb=0;this.bqc=!1;this.Eqa=null;this.bdd=0;this.YAe=new h.a;this.Gnd=[];this.wy=Q;this.Tye=xa;this.Iqe=jb;this.fRg=Nb;F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.D8b();this.qEj=Bc;this.Jqe=new M(100);this.uNj=P.a.vF(1,5,new S.a)}lrd(Q){this.YAe.addHandler("OnCpuMeterFrameAvailable",Q)}pTf(Q){this.YAe.removeHandler("OnCpuMeterFrameAvailable",Q)}sjb(Q,xa,jb,Nb=null){jb=Nb?Nb.priority:7;const Bc=this.wy();this.start(xa,jb);try{Q()}finally{this.stop(xa,Nb),Q=this.wy()-Bc,this.fRg.track(Q,xa)}}Qd(Q,xa){const jb=this.wy();try{Q()}finally{Q=this.wy()-jb,this.Iqe.yza(Q,xa),0<this.$tb&&this.Jqe.yza(Q,xa),this.fRg.track(Q,xa)}}eJf(Q){const xa=new G;xa.TN=Q.Gyf;
xa.TP=Q.priority;this.WKi(1,xa)}F9b(Q){this.bdd|=Q}start(Q,xa){if(!this.$tb){this.Jqe.reset();const jb=this.eki(Q);jb&&this.JUd(1);this.NY=new G;this.NY.TN=Q;this.NY.TP=xa;this.NY.ST=(new Date).toISOString();this.NY.STS=E.a.qU(this.wy(),2);jb?this.NY.UI=1:this.tim(Q)?this.NY.UI=2:this.NY.UI=0}this.$tb++}JUd(Q){this.FQb|=Q}Vud(Q=!0,xa=0){this.FQb=Q?0:this.FQb&~xa}stop(Q,xa=null){let jb;this.$tb--;0>=this.$tb&&this.NY&&(jb=this.wy()-this.NY.STS,this.Ykd+=jb,this.Tye.yza(jb,Q),this.eki(Q)&&this.Vud(!1,
1),this.NY.TRT=E.a.qU(jb,2),xa&&(this.NY.TQT=E.a.qU(xa.agn,2),this.NY.TDT=E.a.qU(xa.gli,2)),this.qEj&&(this.WKi(0,this.NY),this.Cxn()),this.$tb=0);0<=Q.indexOf(J.a.pgo)&&this.F9b(2);0<=Q.indexOf(J.a.IRi)&&this.F9b(4);1===(this.FQb&1)&&this.F9b(1);2===(this.FQb&2)&&this.F9b(8)}Cxn(){var Q=this.NY.TRT;if(750<Q){let jb=this.Jqe.getData();if(jb){const Nb={};for(let Bc in jb){var xa=jb[Bc];const gd=Bc;gd.startsWith("SiOp_")||gd.endsWith("[it]")||(Nb[gd]=Math.round(100*xa.T/Q))}jb=Nb}Q=Object.assign(new N,
{B:this.NY.STS,T:Q,S:jb});this.uNj.track(Q,this.NY.TN)}}T1n(){var Q=this.wy()-this.G2g,xa=E.a.qU(this.Ykd/Q*100,2);Q=new I;Q.CP=xa;Q.II=this.bdd;xa=this.Tye.getData();L.a.count(xa)&&(Q.LRT=xa);xa=this.Iqe.getData();L.a.count(xa)&&(Q.FP=xa);this.YAe.raiseEvent("OnCpuMeterFrameAvailable",new K(Q));this.f9i()}f9i(){this.Tye.reset();this.Iqe.reset();this.Ykd=this.$tb=0;this.G2g=this.wy();this.bdd=0;this.NY=null}run(){this.H_g?this.T1n():(this.f9i(),this.H_g=!0);this.Eqa?this.Eqa(Object(a.a)(this,this.run,
"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}Dqd(Q,xa,jb){const Nb=Array(2);Nb[0]=xa;Nb[1]=jb;this.Gnd[Q]||(this.Gnd[Q]=[]);this.Gnd[Q].push(Nb)}WKi(Q,xa){Q=this.Gnd[Q];if(!W.a.lf(Q))for(let Nb=0;Nb<Q.length;Nb++){var jb=Q[Nb];const Bc=jb[0];jb=jb[1];Bc&&!Bc(xa)||jb(xa)}}D8b(){if(!this.bqc){const Q=window.setTimeout;this.Eqa=(xa,jb)=>Q(xa,jb);this.bqc=!0}}eki(Q){return Q.startsWith("key")||Q.startsWith("input")}tim(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}
Object(e.a)(X,"CpuMeter",null,[104]);class Y{constructor(Q){this.Dlc=null;this.Vo=new n.a;this.wy=Q}initialize(Q,xa,jb,Nb=!1){this.Dlc||(this.Dlc=new X(this.wy,Q,xa,jb,Nb),this.Vo.Eg(this.Dlc));return this.Dlc}}Object(e.a)(Y,"CpuMeterProvider",null,[1727]);var ca=c(179),ha=c(157);class ra{constructor(Q=1){this.JC=[];this.O9c=[];this.ej=Q}oal(){let Q=0;for(let xa=0;xa<this.JC.length;xa++)this.JC[xa]<this.JC[Q]&&(Q=xa);return Q}yza(Q,xa){Q=E.a.qU(Q,2);if(this.JC.length<this.ej)Array.add(this.JC,Q),
Array.add(this.O9c,xa);else{var jb=this.oal();Q>this.JC[jb]&&(this.JC[jb]=Q,this.O9c[jb]=xa)}}getData(){return this.JC.length?{["Vals"]:this.JC,["Desc"]:this.O9c}:null}reset(){this.JC=[];this.O9c=[]}}Object(e.a)(ra,"MaxDataAggregator",null,[944]);var sa=c(37),oa=c(23);class ka{get name(){return"Common.App.CpuMeter"}zc(Q){Q.register(Y,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Zd(()=>new Y(sa.a.kf));Q.register(u,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Zd(()=>
new u)}init(){const Q=F.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const xa=oa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ha.a.instance.Yyc.continueWith(()=>{ka.H4l(Q,xa)})}}dispose(){}static H4l(Q,xa){const jb=P.a.vF(10,5,new M(Q.rc("TaskManagerLoggingThreshold",0),Q.rc("CpuMeterMaximumEntriesToLog",0)));xa=xa.initialize(new ra(5),new M,jb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));xa.run();Q.$("CpuMeterMonitorIsEnabled")&&oa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(xa,
Q.aQ("CpuMeterAverageCpuPercentThreshold",80),Q.rc("CpuMeterRollingAverageFramesCount",15));v.b(16827671,306,50,"Initializing CpuMeter")}static main(){ca.a.instance.Pc(new ka)}}Object(e.a)(ka,"CpuMeterPackage",null,[1,2]);var ia=c(8),La=c(83),va=c(1035),Ga=c(1016),Oa=c(15),Za=c(1362);class ja{constructor(){this.Kqa=this.Djc=null;this.IWb=!0;this.lqc=!1}zc(Q){F.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1673,"Common.IEventTimingMeter").singleInstance().Zd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=
new Ga.a(F.AFrameworkApplication.K.rc("EventTimingMeterEventSamplingPercent",0)/100);Q=new va.a(Object(a.a)(Q,Q.l3a,"shouldBeInSample"));const xa=P.a.vF(16,1,Q);this.Kqa=new Za.a("TypingDuration-SlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.aQ("AshaVetoForTypingThresholdInMS",150),F.AFrameworkApplication.K.aQ("AshaVetoForTypingThresholdPercentile",95),this.IWb);(this.lqc=!Oa.a.T_a)&&F.AFrameworkApplication.FK(()=>{this.XWe()});this.Djc=jb=>{jb=jb.rawEvent.detail;for(const Nb of jb)xa.track(Nb,
"EventTimingData"),"false"!==Nb.metadata.altPressed.toString()||"false"!==Nb.metadata.ctrlPressed.toString()||"false"!==Nb.metadata.repeat.toString()||"CharacterKey"!==Nb.metadata.key.toString()&&"Space"!==Nb.metadata.key.toString()||!this.lqc||this.Kqa.Fva(Nb.timeToRequestAnimationFrameMs)};H.a.addHandler(window.self,A.a.Wbh,this.Djc)}dispose(){this.Djc&&(H.a.removeHandler(window.self,A.a.Wbh,this.Djc),this.Djc=null)}XWe(){this.Kqa.ZOa();this.Kqa.ADi&&(ia.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),
La.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){ca.a.instance.Pc(new ja)}}Object(e.a)(ja,"EventTimingMeterPackage",null,[1,2]);var ba=c(77),qa=c(64),Ma=c(36);class Ia{constructor(Q,xa,jb,Nb=null,Bc=null){this.cL=Q;this.poc=xa;this.koc=jb;this.oXg=Nb;this.Stc=Bc}MBd(Q){const xa=new Sys.StringBuilder(this.cL.fZc);xa.append("RoamingServiceHandler.ashx?action=");xa.append("getFirstRunExperienceSettings");xa.append("&");xa.append(this.vhf(Q));
xa.append("&");xa.append(F.AFrameworkApplication.ym);F.AFrameworkApplication.af.Mj(xa.toString(),1,null,null,!0,2,Object(a.a)(this,this.bZa,"getRequestSuccessCallback"),Object(a.a)(this,this.FBa,"getRequestFailureCallback"),null)}v1b(Q){var xa=new Sys.StringBuilder(this.cL.fZc);xa.append("RoamingServiceHandler.ashx?action=");xa.append("saveFirstRunExperienceSettings");xa.append("&");xa.append(F.AFrameworkApplication.ym);xa=xa.toString();Q=Ma.c(Q);F.AFrameworkApplication.af.Mj(xa,2,Q,null,!0,4,Object(a.a)(this,
this.f9m,"postRequestSuccessCallback"),Object(a.a)(this,this.Lna,"postRequestFailureCallback"),null)}bZa(Q){let xa=!1,jb=null;try{if(0<Q.data.Ie.length){const Nb=Object(qa.a)(Object,Ma.a(Q.data.Ie)),Bc=Nb?Nb[this.cL.eRe]:null;Bc&&(jb=Object(qa.a)(Object,Ma.a(Bc.toString())))}xa=!0}catch(Nb){this.FBa(null)}xa&&this.poc&&this.poc(Q.data,jb)}FBa(Q){this.koc&&this.koc(Q?Q.data:null)}f9m(Q){this.oXg&&this.oXg(Q?Q.data:null)}Lna(Q){this.Stc&&this.Stc(Q?Q.data:null)}vhf(Q){const xa=new Sys.StringBuilder("requestedsettings=");
for(let jb=0;jb<Q.count;jb++)xa.append(Q.J(jb)),jb<Q.count-1&&xa.append(";");return xa.toString()}}Object(e.a)(Ia,"FirstRunExperienceRequestHandler",null,[]);var wa=c(204);class za{constructor(){this.Snc=this.Bad=this.cL=null}HZn(Q){Q?(this.cL=Q,this.qim()&&(ia.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new ba.a,Q.add(this.cL.eRe),this.Bad=new Ia(this.cL,Object(a.a)(this,this.bZa,"getRequestSuccessCallback"),Object(a.a)(this,
this.FBa,"getRequestFailureCallback"),null,Object(a.a)(this,this.Lna,"postRequestFailureCallback")),this.Bad.MBd(Q)),(this.cL.Cji||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Y0f()):ia.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}qim(){try{if(this.cL.Cji)return!0;if(!F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||F.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;
if(this.cL.fdm||this.cL.h8b||F.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=F.AFrameworkApplication.K.lb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){ia.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}YVi(Q){const xa={},jb={};jb.FREDisplayedDate=(new Date).toUTCString();jb.VersionDisplayed=Q;jb.RemindMeLater=!1;xa[this.cL.eRe]=Ma.c(jb);ia.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.Bad&&this.Bad.v1b(xa)}bZa(Q,xa){Q=Q?+Q.HS-+Q.gH:-1;Q>this.cL.OUi?ia.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.cL.OUi):xa?this.DYn(xa)?(ia.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.cL.Rsi),this.Y0f()):(this.f5e(!1),
ia.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ia.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Y0f())}FBa(Q){this.f5e(!1);ia.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.Df:-1)}Lna(Q){ia.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
Q?Q.Df:-1)}Y0f(){this.f5e(!0);var Q=oa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?this.Y5i(Q):(ia.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=oa.a.instance.$a("Common.ISystemInitiatedFeedback"))?Q.execute(xa=>{this.Y5i(xa)}):ia.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Y5i(Q){if(Q){var xa=this.cL.ldl;
xa&&(F.AFrameworkApplication.Vl(xa),F.AFrameworkApplication.a7(xa));ia.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",xa);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Snc=Object(a.a)(this,this.BUm,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Snc,!0),window.addEventListener("FRELaunchedEvent",this.Snc,!0)):(ia.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.YVi(this.cL.currentVersion))}else ia.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}BUm(Q){if(Q){var xa=Q.detail;Q=Q.type;var jb=this.cL&&this.cL.Ukh?this.cL.Ukh.split("-")[0]:null;if("FRELaunchedEvent"===Q||jb&&xa&&xa.id&&-1!==xa.id.indexOf(jb))xa.success&&(ia.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.YVi(this.cL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Snc,
!0),window.removeEventListener("FRELaunchedEvent",this.Snc,!0))}}DYn(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.cL.Rsi)return!0}else if(F.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.cL.currentVersion)return ia.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}f5e(Q){F.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
wa.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(e.a)(za,"FirstRunExperienceLauncher",null,[1669]);class pa{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}zc(Q){this.W=Q;this.W.register(1669,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Zd(()=>new za)}init(){}dispose(){}static main(){ca.a.instance.Pc(new pa)}}Object(e.a)(pa,"FirstRunExperienceLauncherPackage",null,[1,2]);class Ba{constructor(){this.y=this.x=0}}Object(e.a)(Ba,
"HammerPoint",null,[]);var Ra=c(13);class fb{constructor(Q,xa,jb,Nb,Bc){this.nPg=this.WSa=this.Ocd=1;this.Rod=this.lxc=this.jVa=0;this.lAe=this.AGa=null;this.Cnb=this.Ppe=this.sjd=!1;this.Ni=Q;this.WIa=xa;this.Ctb=jb;this.ga=Nb;Bc&&(this.sjd=Bc.$("PromoteLayerPinchToZoomIsEnabled"),this.Ppe=Bc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.Cnb=Bc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get BK(){return this.WIa}Rfm(){return!!this.Ni.instance}XUm(Q){this.ga&&this.ga.processAction(Ra.a.r9i,
2);const xa=this.Ni.instance;this.sjd&&xa.LKi();this.WSa=xa.vj;this.Ocd=Q.eHc.scale;this.nPg=1;this.lAe=this.xkh();this.AGa=this.WIa.getBounds();if(!this.AGa)return ia.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.XXh(Q);this.Cnb?this.Q0i(this.WIa.scrollWidth,this.AGa.width,Q,this.WSa,xa):this.jVa=this.WIa.scrollWidth>this.AGa.width?this.nAc(this.Ctb.scrollLeft,Q.x,this.WSa):null;this.Rod=this.WIa.scrollHeight>this.AGa.height?this.nAc(this.Ctb.scrollTop,Q.y,this.WSa):null;return!0}MUf(){this.jVa=
null;this.lxc=0}Q0i(Q,xa,jb,Nb,Bc){Q>xa?this.jVa?(Q=Bc.Qwf,Q!==this.lxc&&(this.jVa-=this.lxc-Q,this.lxc=Q)):(this.jVa=this.nAc(this.Ctb.scrollLeft,jb.x,Nb),this.lxc=Bc.Qwf):this.MUf()}WUm(Q){const xa=this.XXh(Q);if(!xa)return ia.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.$Ln(Q.eHc.scale/this.Ocd)*this.WSa;this.qoo(xa,Q);this.roo(xa,Q);return!0}qoo(Q,xa){const jb=this.WIa.scrollWidth,Nb=this.AGa.width;this.Cnb?this.Q0i(jb,Nb,Q,xa,this.Ni.instance):!this.jVa&&jb>Nb&&
(this.jVa=this.nAc(this.Ctb.scrollLeft,Q.x,xa));if(Q=this.Fkh(Q.x,this.jVa,jb,Nb,xa))this.Ctb.scrollLeft=Q}roo(Q,xa){const jb=this.WIa.scrollHeight,Nb=this.AGa.height;!this.Rod&&jb>Nb&&(this.Rod=this.nAc(this.Ctb.scrollTop,Q.y,xa));if(Q=this.Fkh(Q.y,this.Rod,jb,Nb,xa))this.Ctb.scrollTop=Q}Fkh(Q,xa,jb,Nb,Bc){return jb<=Nb||!xa||!Nb?null:Math.max(0,Math.min(xa*Bc-Q,jb-Nb))}nAc(Q,xa,jb){return(Q+xa)/jb}VUm(Q){Q=Q.eHc.scale;this.Ppe&&(Q/=this.Ocd);this.IIh(Q);this.sjd&&this.Ni.instance.oQf();this.ga&&
this.ga.processAction(Ra.a.k7e,2);this.Cnb&&this.MUf()}UUm(Q){Q=Q.eHc.scale;this.Ppe&&(Q/=this.Ocd);this.IIh(Q,!0);this.sjd&&this.Ni.instance.oQf();this.ga&&this.ga.processAction(Ra.a.k7e,2);this.Cnb&&this.MUf()}$Ln(Q){const xa=this.Ni.instance,jb=new Date>=this.lAe;jb&&(this.lAe=this.xkh());Math.abs(Q-this.nPg)>=.01*Q&&xa.MSn(Q*this.WSa,jb);return xa.vj/this.WSa}IIh(Q,xa=!1){Q*=this.WSa;this.Ni.instance.i_f(Q,!1);const jb={};jb.initialScale=this.WSa;jb.finalScale=Q;jb.cancelled=xa;ia.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",jb)}XXh(Q){return(Q=Q.eHc.center)&&this.AGa?Object.assign(new Ba,{x:Q.x-this.AGa.x,y:Q.y-this.AGa.y}):null}xkh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(e.a)(fb,"PinchZoomAdapter",null,[1766]);class Va{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Va,"ScrollContainerElement",null,[1764]);
var ib=c(122);class Xa{constructor(Q,xa,jb,Nb,Bc,gd){this.SIe=this.y7a=null;this.W=Q;this.me=xa;this.aed=jb;this.hNg=Nb;this.bLj=Bc;this.mRb=gd;this.B8c=new ba.a}register(Q,xa){this.aed&&(4===F.AFrameworkApplication.ta.Rb.ko&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?ib.a.get_instance().Gl(8,()=>{this.uTi(Q,xa)}):this.uTi(Q,xa))}uTi(Q,xa){this.W.$a("Common.IGestureInputManager").execute(jb=>{this.E4n();this.y7a=jb;this.B8c.add(Q);
if(this.hNg){if(this.bLj&&0!==jb.jvl()){this.T9i();return}var Nb=this.W.$a("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const Bc=new Va(Q);Nb=new fb(Nb,Bc,xa,F.AFrameworkApplication.ya,F.AFrameworkApplication.K);jb.Qnn(Q,Nb)}this.T9i()})}unregister(){if(this.y7a&&this.B8c){if(this.hNg){for(let Q of this.B8c)this.y7a.Mho(Q);this.B8c.clear()}this.y7a=null}}E4n(){this.mRb&&(this.me?this.SIe=this.me.jg("Task","Register"):ia.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}T9i(){this.mRb&&
(this.SIe?this.SIe.stop():ia.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Xa,"GestureInputRegistrar",null,[1672]);class qb{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInput"}init(){this.Ah||(this.W.resolve("Common.IGestureInputRegistrar"),this.Ah=!0)}dispose(){}zc(Q){this.W=Q;Q.register(1672,"Common.IGestureInputRegistrar").singleInstance().Zd(()=>new Xa(Q,F.AFrameworkApplication.ta.lq,F.AFrameworkApplication.xOc(),F.AFrameworkApplication.khi(),
!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){ca.a.instance.Pc(new qb)}}Object(e.a)(qb,"GestureInputPackage",null,[1,2]);var rb=c(322),nb=c(86);class Tb{constructor(){this.Ejb=this.QMh=null}}Object(e.a)(Tb,"GestureAdapterInfo",null,[]);var Zb=c(377),Hb=c(237);class Sa{constructor(){this.Wob=null}pxf(){if(!this.Wob){var Q="hammer.min.js";F.AFrameworkApplication.K.Hv("IsServerFlavorDebug")&&
(Q=F.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=F.AFrameworkApplication.Dw(String.format("{0}",Q),5);Q=Hb.a.create(Q,null,null);Zb.a.cT(Q);this.Wob=Q.x0a}return this.Wob}static get instance(){Sa._instance||(Sa._instance=new Sa);return Sa._instance}}Sa._instance=null;Object(e.a)(Sa,"HammerJsDependencyLoader",null,[1765]);const ua=(Q,xa,jb=null)=>{if(void 0===xa||null===xa)throw ia.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Nb=null;switch(Q){case A.a.pinch:Nb=new Hammer.Pinch(jb);break;case A.a.pan:Nb=new Hammer.Pan(jb)}Nb&&(Nb.manager=xa);return Nb};var Fa;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(Fa||(Fa={}));Object(e.b)("GestureEvent",Fa);var Pa=c(55);class Ea extends Pa.a{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){super(Q,jb,Nb,gd);this.Tkc=xa;this.MUa=be;this.Epa=Bd;this.ZFj=Bc}get shiftKey(){return this.MUa}get ctrlKey(){return this.Epa}get clientPoint(){return this.Tkc}get eHc(){return this.ZFj}static create(Q,
xa,jb,Nb,Bc,gd){if(jb.rawEvent)if(gd){var be=jb.rawEvent;be=new Sys.UI.Point(be.clientX,be.clientY)}else be=Pa.a.IEd(jb);else be=new Sys.UI.Point(jb.clientX,jb.clientY);return new Ea(Q,be,xa,jb,Nb,Bc,jb.shiftKey,jb.ctrlKey,gd)}}Object(e.a)(Ea,"GestureEventArgs",Pa.a,[]);class lb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(lb,"GestureManagerData",null,[]);class zb{}zb.xtj=2;zb.ytj=4;zb.ztj=8;zb.Atj=8;Object(e.a)(zb,"HammerConstants",null,[]);var Xb=c(74),ub=c(101),Pb=c(17),yc=c(92);class bc extends H.a{constructor(Q,xa){super();this.KHa=rb.a.Whl;this.jDe=!!window.PointerEvent;this.M4g=window.hasOwnProperty("ontouchstart");this.Wpb=this.Nsc=null;this.xHa=
!1;this.aja=new nb.a;this.Qtc=new nb.a;this.dHg=new ba.a;this.F6a=null;this.FOb=this.mRb=this.Tyg=this.jke=this.Fye=this.AZg=this.jzg=this.txc=!1;this.Mrc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.TIe=null;this.tg=Xb.EventHandlerManager.instance;this.jDe?(ia.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Nsc=Object(a.a)(this,this.uYd,"onPointerEvent"),this.Wpb=A.a.Yhl):this.M4g?(ia.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Nsc=Object(a.a)(this,
this.Kib,"onTouchEvent"),this.Wpb=A.a.touchEvents):(ia.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Nsc=Object(a.a)(this,this.iYd,"onMouseEvent"),this.Wpb=A.a.Xhl);this.me=xa;this.K0=Q;F.AFrameworkApplication.K&&(this.txc=F.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.jzg=F.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.AZg=F.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.Fye=F.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.jke=F.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.Tyg=F.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.mRb=F.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.FOb=this.txc&&F.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&F.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}jvl(){return this.jDe?0:this.M4g?1:2}Iu(Q){super.Iu(Q);this.tg.fCa(this.Wpb,Q,0,this.Nsc)}Eu(Q){super.Eu(Q);
this.tg.nXa(Q,this.Wpb)}Qnn(Q,xa){F.AFrameworkApplication.xOc()?Sa.instance.pxf().continueWith(jb=>{this.D4n();if(jb.Ki||jb.jo)ia.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",jb.status);else{ia.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",jb.status);if(this.Tyg){jb=window.Hammer;if("undefined"===typeof jb){ia.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.w$d();return}if("undefined"===typeof jb.inputHandler){ia.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.w$d();return}}if(!Q)throw this.w$d(),Error.argumentNull("source element can not be null");jb=ub.a.Db(Q,this.KHa);if(void 0===jb||null===jb)jb=new nb.a,ub.a.yl(Q,this.KHa,jb),this.Rnn(Q);if(!jb.ub(Fa[0])){var Nb=Object.assign(new Tb,{Ejb:ua(Fa[0],this,null),QMh:xa});jb.add(Fa[0],Nb)}}this.w$d()}):ia.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}D4n(){this.mRb&&(this.me?this.TIe=this.me.jg("Task",
"RegisterGestureAdapterAfterLoad"):ia.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}w$d(){this.mRb&&(this.TIe?this.TIe.stop():ia.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Mho(Q){ia.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const xa=ub.a.Db(Q,this.KHa);void 0!==xa&&null!==xa&&(xa.remove(Fa[0]),xa.count||(ub.a.u_(Q,this.KHa),this.curRecognizer=null,this.Nho(Q)))}Rnn(Q){this.dHg.add(Q);this.tg.fCa(this.Wpb,Q,
0,this.Nsc)}Nho(Q){this.dHg.remove(Q);this.tg.nXa(Q,this.Wpb)}recognize(Q){var xa=Array(Q.pointers.length);for(var jb=0;jb<Q.pointers.length;jb++)xa[jb]=Q.pointers[jb].target;jb=null;for(this.F6a=this.pAl(xa);void 0!==this.F6a&&null!==this.F6a&&(jb=ub.a.Db(this.F6a,this.KHa),void 0===jb||null===jb);this.F6a=this.F6a.parentNode);if(void 0!==jb&&null!==jb){this.curRecognizer&&this.curRecognizer.state===zb.Atj&&(this.curRecognizer=null);xa=jb.keys;for(let Nb of xa){xa=jb.J(Nb);void 0!==xa&&null!==xa&&
void 0!==xa.Ejb&&null!==xa.Ejb&&(void 0===this.curRecognizer||null===this.curRecognizer||xa.Ejb===this.curRecognizer||xa.Ejb.canRecognizeWith(this.curRecognizer))&&xa.Ejb.recognize(Q);const Bc=xa.Ejb.state;this.curRecognizer||zb.xtj!==Bc&&zb.ytj!==Bc&&zb.ztj!==Bc||(this.curRecognizer=xa.Ejb)}}}emit(Q,xa){if("hammer.input"!==Q){this.xHa=!1;xa=Ea.create(Q,this.F6a,xa.srcEvent,xa,3,this.jDe);var jb=ub.a.Db(this.F6a,this.KHa);if(this.hkm(Q))var Nb=0;else if(this.Hjm(Q))Nb=1;else if(this.vnm(Q))Nb=2;else{ia.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:jb}=jb.Bc(Fa[Nb]));void 0!==jb&&null!==jb&&((jb=jb.QMh,jb.Rfm())?Q.endsWith("start")?this.xHa=jb.XUm(xa):Q.endsWith("end")?(jb.VUm(xa),this.xHa=!0):Q.endsWith("cancel")?(jb.UUm(xa),this.xHa=!0):Q.endsWith("move")&&(this.xHa=jb.WUm(xa)):ia.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(qa.a)(Hammer.Recognizer,Q)}pAl(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var xa=Q[0],jb=!0;for(let Nb=1;Nb<Q.length;Nb++){if(!Q[Nb])return null;if(xa!==Q[Nb]){jb=!1;break}}if(jb)return xa;xa=this.pNh(Q[0]);jb=0;for(const Nb of Q){Q=this.pNh(Nb);if(xa.J(xa.count-1)!==Q.J(Q.count-1))return null;for(let Bc=xa.count-2,gd=Q.count-2;Bc>=jb&&0<=gd;Bc--,gd--)if(xa.J(Bc)!==Q.J(gd)){jb=Bc+1;break}}return xa.J(jb)}pNh(Q){const xa=new ba.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)xa.add(Q);return xa}bUh(Q){switch(Q){case A.a.DO:case A.a.vwb:return 1;case A.a.BO:case A.a.HUe:return 2;
case A.a.kJ:case A.a.wwb:return 4;case A.a.Cbe:case A.a.GUe:return 8}return 0}Kib(Q,xa,jb){Q=this.bUh(Q);xa=this.Jxl(jb);Hammer.inputHandler(this,Q,xa);this.xHa&&jb.preventDefault();return this.xHa}P4h(){return 1<this.aja.count}Wtd(){ia.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.txc)for(let Q of this.aja)this.EPi(Q.key);else this.aja=new nb.a;this.session=null}j5j(Q,xa,jb){ia.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Qtc.ub(Q)){try{xa.setPointerCapture(Q)}catch(Nb){ia.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Nb)}this.Qtc.add(Q,xa)}this.aja.Z(Q,jb);this.FOb&&1<this.aja.count&&this.K0&&!this.K0.zAc&&(this.K0.zAc=!0)}EPi(Q){ia.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Qtc.ub(Q)){try{this.Qtc.J(Q).releasePointerCapture(Q)}catch(xa){ia.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",xa)}this.Qtc.remove(Q)}else ia.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.aja.remove(Q);this.FOb&&
1>=this.aja.count&&this.K0&&this.K0.zAc&&(this.K0.zAc=!1)}uYd(Q,xa,jb){var Nb=jb.rawEvent.pointerType.toString();const Bc=jb.rawEvent.pointerId.toString();if("touch"!==Nb)return!1;Q=this.bUh(Q);if(1!==Q&&!this.aja.ub(Bc))return!1;this.jzg&&1===Q&&jb.rawEvent.isPrimary&&this.aja.count&&(ia.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Wtd());this.txc?this.j5j(Bc,xa,jb):this.aja.Z(Bc,jb);this.Fye&&2===Q&&(!this.jke||this.jke&&"function"===typeof jb.rawEvent.getCoalescedEvents)&&
(xa=jb.rawEvent.getCoalescedEvents())&&this.P4h()&&(this.Mrc=Math.max(this.Mrc,xa.length));this.AZg&&(this.xHa=!1);Nb=this.Ixl(this.aja,jb,Nb);Hammer.inputHandler(this,Q,Nb);if(4===Q||8===Q)this.txc?this.EPi(Bc):this.aja.remove(Bc),this.aja.count||(this.session=null,this.Fye&&-1!==this.Mrc&&(ia.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Mrc),this.Mrc=-1));this.xHa&&jb.preventDefault();return this.xHa}iYd(){return!1}Jxl(Q){const xa=new lb;var jb=Q.rawEvent;const Nb=
jb.touches;jb=jb.changedTouches;xa.pointers=Array.clone(Nb);xa.pointers=Array.clone(0<Nb.length?Nb:jb);xa.changedPointers=Array.clone(jb);xa.srcEvent=Q;xa.pointerType="touch";return xa}Ixl(Q,xa,jb){const Nb=new lb;Nb.pointers=yc.toArray(Q.values);Nb.changedPointers=[xa];Nb.pointerType=jb;Nb.srcEvent=xa;return Nb}hkm(Q){return Pb.a.startsWith(Q,A.a.pinch)}Hjm(Q){return Pb.a.startsWith(Q,A.a.pan)}vnm(Q){return Pb.a.startsWith(Q,A.a.swipe)}}Object(e.a)(bc,"GestureInputManager",H.a,[1725,1726]);var Ka=
c(240);class Bb{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInputManager"}zc(Q){Q.register(bc,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Zd(()=>new bc(Ka.a.instance,F.AFrameworkApplication.ta.lq));this.W=Q}init(){this.Ah||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Ah=!0)}dispose(){}static main(){ca.a.instance.Pc(new Bb)}}Object(e.a)(Bb,"GestureInputManagerPackage",null,[1,2]);var tb=c(243),
Kb=c(51),Ib=c(1501);class Wa{constructor(Q,xa,jb){this.mHe=this.lHe=null;this.gVb=new n.a;this.rg=Q;this.Fsc=jb;this.w5=xa.appSettings[Wa.duo]||""}get kUn(){return this.gVb.task}get kka(){return this.rg.value}fyn(){const Q={};Q[Wa.eXl]=F.AFrameworkApplication.ym;Q["Content-Type"]="application/json; charset=utf-8";ia.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const xa=Kb.a.Ip(this.w5+Wa.lUn,Wa.lQm,F.AFrameworkApplication.ta.Rb.ko.toString());
this.kka.Mj(xa,1,"",Q,!0,2,Object(a.a)(this,this.fHb,"onSuccessCallback"),Object(a.a)(this,this.SGb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}tBm(Q){try{const xa={};xa.FlightName=Q.FlightName;xa.SessionID=Q.SessionID;ia.ULS.sendTraceTag(594883776,215,50,Ma.c(xa))}catch(xa){ia.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}fHb(Q){if((Q=Q.data.Ie)&&Q.length)try{const xa=Ma.a(Q);this.lHe=xa.NavBarDataJson;ia.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.lHe?({Iv:this.mHe}=Ma.d(xa.NavBarDataJson)).returnValue?(this.tBm(this.mHe),this.gVb.Eg(this.mHe)):(ia.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Ib.a.b3c(this.lHe)}),this.gVb.sba()):(ia.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.gVb.sba())}catch(xa){ia.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.gVb.sba()}else ia.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}SGb(){this.gVb.sba();
ia.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Wa._instance||(Wa._instance=Wa.eAb())}static eAb(){return new Wa(new tb.a(()=>F.AFrameworkApplication.af),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.Rb.ko)}}Wa.eXl="X-qs";Wa.lQm="at";Wa.lUn="O365ShellServiceProxy.ashx";Wa._instance=null;Wa.duo="ShellWebServiceBase";Object(e.a)(Wa,"O365ShellActor",null,[1729]);class vc{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}zc(Q){this.W=
Q;this.W.register(Wa,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Zd(()=>new Wa(new tb.a(()=>F.AFrameworkApplication.af),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.Rb.ko))}init(){F.AFrameworkApplication.K.gq(Object(a.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){F.AFrameworkApplication.o$f&&F.AFrameworkApplication.ta.Rb.KI&&this.W.resolve("Common.App.O365Shell.O365ShellActor").fyn()}dispose(){}static main(){ca.a.instance.Pc(new vc)}}
Object(e.a)(vc,"PackageManager",null,[1,2]);class Lc{w0a(){}init(){}dispose(){}}Object(e.a)(Lc,"NoOpOfflineLogger",null,[1797,10]);var Gb=c(603);class pc{}pc.Nrd=0;Object(e.a)(pc,"OfflineLoggerConstants",null,[]);var Fc=c(80),ob=c(231),Fb=c(320);class gb{constructor(Q,xa,jb,Nb,Bc){this.eTa=!1;this.c5=null;this.Plc=this.wSb=this.Job=0;this.GJ=this.B8a=this.fS=null;this.Cl=!1;this.wya=jb;this.bza=Nb;this.Sya=Bc;this.rg=xa;this.Hb=Q}init(){this.u_f();this.gvm();this.eTa=!1;this.rg.kXb(this);this.fS=
new Fc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Hb.fc(this.fS)}aAc(Q){return"OfflineLog|"+Q}gvm(){const Q=this.wya.getItem("OfflineLoggerManifest");void 0!==Q&&null!==Q&&0<Q.length&&(this.c5=gb.qhc(Q));this.c5||(this.c5={});if(void 0===this.c5.end||null===this.c5.end)this.c5.end=0;if(void 0===this.c5.offset||null===this.c5.offset)this.c5.offset=0;this.Job=this.c5.offset;isFinite(this.Job)||(this.Job=0);this.wSb=this.c5.end;isFinite(this.wSb)||(this.wSb=0);this.Plc=
this.wSb}u_f(){this.B8a=new Fb.a;this.GJ=new ob.a;this.bza.xah(Object(a.a)(this,this.sJf,"onUlsReadyToBeSent"));this.bza.abh(Object(a.a)(this,this.uJf,"onUlsSentSuccessfully"));this.bza.$ah(Object(a.a)(this,this.tJf,"onUlsSentFailed"));this.bza.nah(Object(a.a)(this,this.EFf,"onAfterUlsHostDisposed"))}sJf(Q,xa){if(void 0!==xa&&null!==xa&&void 0!==xa.args&&null!==xa.args){Q=!1;if(!this.B8a.ub(xa.args.tag)){if(!this.B8a.ub(pc.Nrd))return;Q=!0}this.B8a.remove(Q?pc.Nrd:xa.args.tag);this.GJ.ub(xa.CM)||
this.GJ.Z(xa.CM,new ba.a);this.GJ.J(xa.CM).add(xa.args)}}uJf(Q,xa){this.GJ.remove(xa.CM)}tJf(Q,xa){if(void 0!==xa&&null!==xa&&this.GJ.ub(xa.CM)){Q=this.GJ.J(xa.CM);for(let jb=0,Nb=Q.count;jb<Nb;++jb)xa=gb.serialize(Q.J(jb),this.Sya),this.i3c(this.aAc(this.Plc++),xa)}}EFf(){this.dispose()}i3c(Q,xa){try{return this.wya.setItem(Q,xa),!0}catch(jb){return ia.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",jb.message),!1}}sendOfflineLogs(){if(!this.eTa){for(var Q=this.Job,
xa=new ba.a,jb=null;Q<this.wSb&&5>=xa.count;++Q){var Nb=this.aAc(Q);const Bc=this.wya.getItem(Nb);this.wya.removeItem(Nb);if(void 0===Bc||null===Bc)continue;const gd=({sessionId:Nb}=gb.deserialize(Bc)).returnValue;if(gd){if(!jb)jb=Nb;else if(Nb!==jb)break;xa.add(gd)}else ia.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Bc)}0<xa.count&&this.bza.USi(this,yc.toArray(xa),jb);this.Job=Q;Q>=this.wSb&&(this.Hb.Ye(this.fS),this.fS=null)}}w0a(Q,xa,jb){!this.Cl&&ia.ULS.T7(xa,
jb)&&this.B8a.Z(Q,!0)}dispose(){if(!this.Cl){this.fS&&this.Hb.Ye(this.fS);var Q=yc.toArray(this.GJ.keys);Q.sort();for(const xa of Q){Q=this.GJ.J(xa);for(let jb=0,Nb=Q.count;jb<Nb;++jb){const Bc=gb.serialize(Q.J(jb),this.Sya);this.i3c(this.aAc(this.Plc++),Bc)}}this.Job<this.Plc?(this.c5.end=this.Plc,this.c5.offset=this.Job,this.i3c("OfflineLoggerManifest",JSON.stringify(this.c5))):this.wya.removeItem("OfflineLoggerManifest")}this.Cl=!0}fOa(){this.eTa=!0}Yhb(){this.eTa=!1}static serialize(Q,xa){const jb=
{};jb.t=Q.tag;jb.c=Q.category;jb.l=Q.level;jb.m=Q.message;jb.lt=Q.logType;jb.s=xa;jb.ts=Q.timestamp;jb.o=Q.isMinified;jb.a=Q.args;return JSON.stringify(jb)}static deserialize(Q){return(Q=gb.qhc(Q))?{returnValue:new Gb.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static qhc(Q){try{return JSON.parse(Q)}catch(xa){ia.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",xa.message)}return null}}Object(e.a)(gb,"OfflineLoggerImpl",
null,[1797,10,313]);class Jb{constructor(Q,xa,jb,Nb){this.sessionId=Q;this.version=xa;this.Bsd=jb;this.ZJf=Nb;this.Lua=new ba.a}}Object(e.a)(Jb,"CachedLogUpload",null,[]);class Yb{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(e.a)(Yb,"LoggingExceptionArgsLocalStorage",null,[]);class tc{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;
this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new Yb(Q.exceptionArgs))}}Object(e.a)(tc,"LoggingArgsLocalStorage",null,[]);var Ec=c(360);class Vc{constructor(Q,xa,jb,Nb,Bc,gd){this.t=Q;this.m=xa;this.s=jb;this.v=Nb;this.i=Bc;this.a=gd;this.op="Log"}}Object(e.a)(Vc,"LoggingKeyLocalStorage",null,[]);var Hd=c(121);const qd=(Q,xa,jb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===
Q.op&&Q.t===xa&&isFinite(Q.t)&&Hd.a.Sd(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===jb);class me{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og){this.eTa=this.RQg=this.GQg=this.HQg=!1;this.GJ=this.B8a=this.c5=this.fS=null;this.Cl=!1;this.erb=[];this.qSb=[];this.wya=jb;this.bza=Nb;this.Sya=Bc;this.rg=xa;this.Hb=Q;this.Fsc=gd;this.KAe=be;this.LZg=Bd;this.sTa=Xe;this.bNj=eg;this.Zve=og}get manifest(){return this.c5}get cRc(){return this.B8a}get KNa(){return this.GJ}init(){this.u_f();this.eTa=!1;this.rg.kXb(this);
this.fS=new Fc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Hb.fc(this.fS)}determineLogsToSendAtBoot(){this.EAh(!0)}determineLogsToSendOnReconnect(){this.EAh(!1)}EAh(Q){this.nBd();this.erb=[];Q&&(this.qSb=[]);for(var xa=0;xa<this.wya.length;xa++){const jb=this.wya.key(xa),Nb=me.qhc(jb,!1);qd(Nb,this.Fsc,this.KAe)&&(Nb.s===this.Sya?Array.add(this.erb,jb):Q&&Array.add(this.qSb,jb))}if(this.erb.length||Q&&this.qSb.length)if(xa=this.Zve?Object(a.a)(this,
this.X1n,"sortDescendKeysToUpload"):Object(a.a)(this,this.$1n,"sortKeysToUpload"),this.erb.sort(xa),Q&&this.qSb.sort(xa),0<this.erb.length||0<this.qSb.length)this.fS=new Fc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Hb.fc(this.fS)}$1n(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}X1n(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}aAc(Q,xa,jb,Nb){return JSON.stringify(new Vc(this.Fsc,this.KAe,xa,jb,Q,Nb))}u_f(){this.B8a=new Fb.a;this.GJ=new ob.a;this.bza.xah(Object(a.a)(this,
this.sJf,"onUlsReadyToBeSent"));this.bza.abh(Object(a.a)(this,this.uJf,"onUlsSentSuccessfully"));this.bza.$ah(Object(a.a)(this,this.tJf,"onUlsSentFailed"));this.bza.nah(Object(a.a)(this,this.EFf,"onAfterUlsHostDisposed"))}sJf(Q,xa){if(void 0!==xa&&null!==xa&&void 0!==xa.args&&null!==xa.args){if(this.cRc.ub(xa.args.tag))this.cRc.remove(xa.args.tag);else if(this.cRc.ub(pc.Nrd))this.cRc.remove(pc.Nrd);else if(!(this.bNj&&50>xa.args.level))return;({value:Q}=this.KNa.Bc(xa.CM)).returnValue||(Q=new Jb(xa.sessionId,
xa.version,xa.Bsd,xa.ZJf),this.KNa.Z(xa.CM,Q));this.KNa.J(xa.CM).Lua.add(xa.args)}}uJf(Q,xa){this.KNa.remove(xa.CM)}tJf(Q,xa){void 0!==xa&&null!==xa&&this.KNa.ub(xa.CM)&&this.oti(xa.CM)&&!this.RQg&&(this.RQg=!0,ia.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}oti(Q){let xa=!1;if(({value:Nb}=this.KNa.Bc(Q)).returnValue&&Nb&&0<Nb.Lua.count){if(Nb.Bsd>=this.sTa)return!1;var jb=Nb.Lua;const Bc=Array(jb.count);for(let gd=0,be=jb.count;gd<be;++gd)Bc[gd]=new tc(jb.J(gd));jb=me.serialize(Bc);
var Nb=this.aAc(Nb.ZJf,Nb.sessionId,Nb.version,Nb.Bsd);this.i3c(Nb,jb)&&(this.KNa.remove(Q),xa=!0)}return xa}EFf(){this.dispose()}i3c(Q,xa){try{return this.wya.setItem(Q,xa),!0}catch(jb){return ia.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",jb.message),!1}}sendOfflineLogs(){if(!this.eTa){var Q=0<this.erb.length?this.erb:this.qSb,xa=Q.length;if(xa)for(;0<xa;){F.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");
xa--;var jb=this.Zve?Q.pop():Q[0];this.Zve||Array.removeAt(Q,0);const gd=me.qhc(jb,!0);if(qd(gd,this.Fsc,this.KAe)){var Nb=this.wya.getItem(jb);this.wya.removeItem(jb);if(void 0!==Nb&&null!==Nb)if(gd.a>this.sTa)ia.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",gd.a,this.sTa);else if(jb=me.qhc(Nb,!0),void 0!==jb&&null!==jb&&isFinite(jb.length))if(jb.length){Nb=jb[jb.length-1];var Bc=(new Date).getTime()-Nb.ts;if(Bc<-me.icj)ia.ULS.sendTraceTag(37290078,222,50,
"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Nb.ts);else if(Bc>this.LZg*me.icj)ia.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.LZg,Nb.ts);else{gd.s===this.Sya?this.HQg||(this.HQg=!0,ia.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.GQg||(this.GQg=!0,ia.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",gd.s));
xa=Array(jb.length);for(Nb=0;Nb<jb.length;Nb++){Q=Nb;a:{Bc=jb[Nb];if(void 0===Bc||null===Bc){Bc=null;break a}let be=null;Bc.e&&(be=new Ec.a(null),be.name=Bc.e.n,be.stack=Bc.e.s,be.message=Bc.e.m,be.file=Bc.e.f,be.line=Bc.e.l,be.column=Bc.e.c);Bc=new Gb.a(Bc.ts,Bc.c,Bc.t,Bc.l,Bc.m,Bc.lt,Bc.o,Bc.a,be)}xa[Q]=Bc}this.bza.USi(this,xa,gd.s,gd.v,gd.a+1,gd.i);break}}else ia.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Nb);else ia.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
Nb)}}else this.nBd()}}w0a(Q,xa,jb){!this.Cl&&ia.ULS.T7(xa,jb)&&this.cRc.Z(Q,!0)}dispose(){if(!this.Cl){this.fS&&this.Hb.Ye(this.fS);var Q=yc.toArray(this.KNa.keys);for(const xa of Q)this.oti(xa)}this.Cl=!0}fOa(){this.eTa=!0;this.nBd()}Yhb(){this.eTa=!1;this.nBd();this.fS&&this.Hb.Ye(this.fS);this.fS=new Fc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Hb.fc(this.fS)}nBd(){this.fS&&(this.Hb.Ye(this.fS),this.fS=null)}static serialize(Q){return JSON.stringify(Q)}static qhc(Q,
xa){try{return JSON.parse(Q)}catch(jb){xa&&ia.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",jb.message)}return null}}me.icj=864E5;Object(e.a)(me,"OfflineLoggerImplV2",null,[1797,10,313]);class Zc{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(xa){return this.handleError("Key",xa),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(xa){return this.handleError("GetItem",
xa),null}}setItem(Q,xa){try{return localStorage.setItem(Q,xa)}catch(jb){return this.handleError("SetItem",jb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(xa){this.handleError("RemoveItem",xa)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,xa){ia.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,xa.message)}}Object(e.a)(Zc,"OfflineStorage",null,[1796]);class Dc{create(Q){let xa=null;try{void 0!==localStorage&&
null!==localStorage&&(xa=new Zc)}catch(jb){ia.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",jb.message)}Object.getType(ia.ULS.host).implementsInterface(1106)&&xa||(ia.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",xa?"supported":"not supported",Object.getType(ia.ULS.host).implementsInterface(1106)?"supported":"not supported"),Q=0);Q=1===Q?new gb(F.AFrameworkApplication.uc,F.AFrameworkApplication.af,xa,
ia.ULS.host,F.AFrameworkApplication.userSessionId):2===Q?new me(F.AFrameworkApplication.uc,F.AFrameworkApplication.af,xa,ia.ULS.host,F.AFrameworkApplication.userSessionId,F.AFrameworkApplication.ta.Rb.ko,F.AFrameworkApplication.ta.Rb.$fa,F.AFrameworkApplication.K.rc("OfflineLoggerRetentionInDays",30),F.AFrameworkApplication.K.rc("OfflineLoggerMaxAttempts",5),F.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),F.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):
new Lc;Q.init();return Q}}Object(e.a)(Dc,"OfflineLoggerFactory",null,[]);class ud{zc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=F.AFrameworkApplication.K;let xa=0;Q.$("OneNoteOfflineLoggerIsEnabled")?xa=1:Q.$("OfflineLoggerV2IsEnabled")&&(xa=2);0!==xa&&(F.AFrameworkApplication.$5f=(new Dc).create(xa))}dispose(){}}Object(e.a)(ud,"OfflineLoggerPackage",null,[1,2]);var Ce=c(56),ee=c(1336);class Uf{constructor(Q){this.rqi=null;ia.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.ERc=F.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");(this.d7=Q)||ia.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.ERc&&this.ERc.length||ia.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}m9k(Q){Q&&(this.ERc="https://dcg-df.microsoft.com/",ia.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.l9k()}l9k(){ia.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.rqi)ia.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.rqi=new Date;var Q=new Date;this.d7.Qoa("BayBridge",this.ERc).then(xa=>{const jb=+new Date-+Q;xa.IsSuccess?(ia.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",jb),this.b9k(xa.Token,this.$jl())):ia.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
jb,xa.ErrorCode,xa.ErrorMessage)}).catch(xa=>{ia.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",xa,+new Date-+Q)})}}b9k(Q,xa){const jb={};jb.Authorization="Bearer "+Q;jb["Authorization-Type"]="AAD";jb.Accept="application/json";jb["DCG-SessionId"]=F.AFrameworkApplication.userSessionId;F.AFrameworkApplication.af.Mj(xa,1,null,jb,!1,2,Object(a.a)(this,this.MLl,"getStatusSucceeded"),Object(a.a)(this,this.KLl,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");Ce.a("FetchAccountLinkedStatus")}Zll(){const Q=ee.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}$jl(){return this.ERc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}KLl(){ia.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}MLl(Q){ia.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Ma.a(Q.data.Ie).state+"";ee.a.instance.setItem("AccountLinkedStatusCache",
Q)}}Object(e.a)(Uf,"PhoneLinkManager",null,[1670]);class te{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}zc(Q){this.W=Q;this.W.register(1670,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Zd(()=>new Uf(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){F.AFrameworkApplication.K.gq(()=>{this.TZa()})}TZa(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){ca.a.instance.Pc(new te)}}Object(e.a)(te,"PhoneLinkPackage",null,[1,2]);const Fe=
Q=>{try{return Ma.a(Q)}catch(xa){}return null};class Qf{constructor(Q,xa,jb,Nb,Bc,gd){this.xY=!1;this.Pq=null;this.XCe=!1;this.ga=Q;this.rg=xa;this.Zj=jb;this.RPg=Nb;this.Oa=Bc;this.GMj=gd}init(Q,xa){xa&&Q.$a("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.ZSe,"awaitRtc"))}ZSe(Q){const xa=Q.JIc();xa.continueWith(()=>{this.Pq=xa.result;this.XCe&&(this.Pq.rO(2,null,!0),this.XCe=!1);this.Pq.B5((jb,Nb)=>{2===Nb.type&&this.wc.processAction(Ra.a.fileNameUpdate,2)});this.Pq.wza((jb,Nb)=>
{2===Nb.newState&&this.wc.processAction(Ra.a.fileNameUpdate,2)});2===this.Pq.connectionState&&this.wc.processAction(Ra.a.fileNameUpdate,2)})}fLa(Q){this.XGh(Q,!0)}XGh(Q,xa){const jb=this.mok(Q.C7i),Nb={};Nb[Qf.xsh]=Qf.ysh;this.HSi.Mj(jb,2,"",Nb,!1,2,Object(a.a)(this,this.fac,"onRefreshFilenameSuccess"),xa?Object(a.a)(this,this.uYm,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.NAi,"onRefreshFilenameFailureNoRetry"),Q)}fac(Q){this.xY=!1;const xa=Fe(Q.data.Ie);Q.data.state.onSuccess(xa,this.RPg.value)}uYm(Q){5!==
Q.data.status||this.xY?this.NAi(Q):(this.xY=!0,this.XGh(Q.data.state,!1))}NAi(Q){Q.data.state.onFailure(-1)}rzb(Q){this.YGh(Q,!0)}YGh(Q,xa){const jb=this.nok(),Nb={};Nb[Qf.xsh]=Qf.ysh;Nb[Qf.cXl]=Pb.a.Jj(Q.PSi);Nb[Qf.aXl]=this.GMj.value.tAk;this.HSi.Mj(jb,2,"",Nb,!1,2,Object(a.a)(this,this.VTc,"onRenameFileSuccess"),xa?Object(a.a)(this,this.zYm,"onRenameFileFailureRetry"):Object(a.a)(this,this.PAi,"onRenameFileFailureNoRetry"),Q)}nok(){return this.$ih()}mok(Q){let xa=this.$ih();return xa=Kb.a.Ip(xa,
Qf.gXl,Q?"2":"1")}$ih(){let Q=(this.Oa.value.appSettings.RenameWebServiceBase||"")+Qf.bXl;Q=Kb.a.Ip(Q,Qf.dXl,Pb.a.Jj(F.AFrameworkApplication.ym));this.Kp&&this.Kp.arf&&(Q=Kb.a.Ip(Q,Qf.fXl,"1"));return Q}VTc(Q){this.xY=!1;const xa=Fe(Q.data.Ie);Q.data.state.onSuccess(xa,this.RPg.value);this.Ovi()}Ovi(){this.Pq?this.Pq.rO(2,null,!0):this.XCe=!0}zYm(Q){5!==Q.data.status||this.xY?this.PAi(Q):(this.xY=!0,this.YGh(Q.data.state,!1))}PAi(Q){Q.data.state.onFailure(-1)}get wc(){return this.ga.value}get HSi(){return this.rg.value}get Kp(){return this.Zj.value}static get instance(){return Qf._instance||
(Qf._instance=Qf.eAb())}static eAb(){return new Qf(new tb.a(()=>F.AFrameworkApplication.ya),new tb.a(()=>F.AFrameworkApplication.af),new tb.a(()=>F.AFrameworkApplication.Kp),new tb.a(()=>oa.a.instance.resolve("Postmessage.IHostPostmessenger")),new tb.a(()=>F.AFrameworkApplication.K),new tb.a(()=>oa.a.instance.resolve("Common.IRenameProps")))}}Qf.xsh="Content-Type";Qf.ysh="application/json; charset=utf-8";Qf.bXl="renamehandler.ashx";Qf.dXl="qs";Qf.cXl="n";Qf.fXl="sl";Qf.aXl="X-CoauthLockId";Qf.gXl=
"u";Qf._instance=null;Object(e.a)(Qf,"ExecuteRenameFileHandler",null,[]);class id{constructor(){this.onFailure=this.onSuccess=null;this.C7i=!1}}Object(e.a)(id,"ExecuteRefreshFilenameData",null,[]);class Gg{constructor(){this.onFailure=this.onSuccess=this.PSi=null}}Object(e.a)(Gg,"ExecuteRenameFileData",null,[]);class ad{constructor(){this.W=null;this.spe=Qf.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}zc(Q){this.W=Q}init(){F.AFrameworkApplication.K.gq(Object(a.a)(this,this.fx,
"onFullAppSettingsReady"))}fx(){F.AFrameworkApplication.cPc()&&(Qf.instance.init(this.W,F.AFrameworkApplication.iYc),F.AFrameworkApplication.rzb=Object(a.a)(this,this.rzb,"executeRenameFile"),F.AFrameworkApplication.fLa=Object(a.a)(this,this.fLa,"executeRefreshFilename"),F.AFrameworkApplication.QZc=Object(a.a)(this,this.QZc,"sendFileNameAndLocationUpdateNotification"))}rzb(Q,xa,jb){const Nb=new Gg;Nb.PSi=Q;Nb.onSuccess=xa;Nb.onFailure=jb;this.spe.rzb(Nb)}fLa(Q,xa,jb){const Nb=new id;Nb.onSuccess=
Q;Nb.onFailure=xa;Nb.C7i=jb;this.spe.fLa(Nb)}QZc(){this.spe.Ovi()}dispose(){}}Object(e.a)(ad,"PackageManager",null,[1,2]);var Kd=c(142);class jh{constructor(Q,xa,jb){this.m1f=this.n1f=this.o1f=!1;this.C1f=!Q&&!xa;this.D1f=!Q&&!jb;this.C1f||this.D1f||(this.o1f=!Q,this.n1f=!xa,this.m1f=!jb)}}Object(e.a)(jh,"RenameDisabledDialogInfo",null,[]);class Qe extends Kd.StandardDialog{constructor(Q,xa,jb,Nb,Bc){super();this.I5f=[];this.Ica=new jh(Q,xa,jb);this.I$a=Nb;this.g8a=Bc;this.lg="RenameDisabledDialog";
this.Gd=0;this.We(1,CommonUIStrings.l_DialogClose);this.PRn();this.Nvn()}PRn(){this.Ica.C1f?this.L0c(this.I$a?this.g8a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Ica.D1f?this.L0c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.L4j();this.hyc(this.I5f)}L0c(Q){Array.add(this.I5f,Q)}L4j(){const Q=[];this.Ica.o1f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.Ica.n1f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Ica.m1f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.I5f,Q)}}Object(e.a)(Qe,"ReactRenameDisabledDialogBase",Kd.StandardDialog,[]);class zc extends Qe{constructor(Q,xa,jb,Nb,Bc){super(Q,xa,jb,Nb,Bc)}Nvn(){this.Mhb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(zc,"ReactRenameDisabledDialog",Qe,[]);var uc=c(154);class Ed{static get vg(){return uc.a.Rx(Ed.tl,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Ed.tl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(Ed,"RenameDisabledDialogHtml",null,[]);class Of extends uc.a{constructor(Q,xa,jb,Nb,Bc){super();this.Ica=new jh(Q,xa,jb);this.I$a=Nb;this.g8a=Bc;this.lg="RenameDisabledDialog";this.Gd=0;this.We(1,CommonUIStrings.l_DialogClose);this.vg=Ed.vg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.J3("RenameRow")}eU(){if(this.Ica.C1f){let Q;Q=this.I$a?this.g8a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Of.L0c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.Ica.D1f?Of.L0c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.g_l()}g_l(){this.Ica.o1f&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Ica.n1f&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Ica.m1f&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static L0c(Q,xa,jb){Q.style.display="none";xa.innerText=jb}}Object(e.a)(Of,"RenameDisabledDialog",uc.a,[]);var $b=c(62);class xc{constructor(Q,xa){this.Irb=0;this.ga=Q;this.QGa=xa}initialize(Q){if(!this.ga||!this.QGa)return!1;this.Irb=Q;this.Vb();return!0}Vb(){this.ga.pa(Ra.a.IYe,$b.a.frame,Object(a.a)(this,this.IYe,"commitNewDocumentTitle"))}IYe(Q,xa,jb,Nb,Bc){if(1===jb)return this.ga.processAction(Ra.a.renameFile,
1);Q=Pb.a.wI(this.QGa.Hz);Bc=(0,Bc.getNewDocumentTitle)();Bc.length>this.Irb&&(Bc=Bc.substr(0,this.Irb));if(32!==this.ga.Xb(Ra.a.renameFile,2,Bc))return this.Lhc(Q),8;this.Lhc(Bc);return 32}Lhc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Hl(){return new xc(F.AFrameworkApplication.ya,F.AFrameworkApplication.Gt)}}Object(e.a)(xc,"ReactRenameUIHandler",null,[1803]);var Yc=c(222),wd=c(1028),le=c(469),uf=c(84),yg=c(143),pb=c(27);class Wb{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,
Xe,eg,og,Ni){this._initialized=!1;this._element=null;this.Irb=0;this.KGe=this.Pse=!1;this.ga=Q;this.Yha=xa;this.le=jb;this.Ir=Nb;this.QGa=Bc;this.N_g=gd;this.tld=be;this.Eke=Bd;this.H7a=Xe;this.YMg=eg;this.Bi=og;this.xue=Ni}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,xa,jb){if(!(this.ga&&this.QGa&&this.N_g&&this.tld&&this.Eke&&xa)||0>=Q)return!1;this._element=xa;this._element.title=jb;this._element.setAttribute(pb.a.Bh,pb.a.J1);this._element.setAttribute("Unselectable",
"on");this.Irb=Q;this.UA();return this._initialized=!0}UA(){this.Yha&&(this.Yha.mb(A.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Yha.mb(A.a.paste,this._element,Object(a.a)(this,this.RTc,"onPaste")));this.le.mb(A.a.ni,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Ir.mb(A.a.pointerDown,this._element,Object(a.a)(this,this.$B,"onPointerDown"));this.Ir.mb(A.a.hM,this._element,Object(a.a)(this,this.gva,"onPointerUp"))}onBlur(){this.isActive&&!this.Pse&&(this.YMg||
this.Eke(this._element),this.Mqh(),this.P2e(!1));return this.Pse=!1}RTc(){ia.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.cWm(Q):this.dWm(Q)}cWm(Q){let xa=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:this.Mqh();this.P2e(this.Bi||this.xue);xa=!0;break;case Sys.UI.Key.tab:this.YMg&&this.Eke(this._element);break;case Sys.UI.Key.esc:this.eVf(),this.P2e(this.Bi||this.xue),xa=!0}return xa}dWm(Q){let xa=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Jej(this.xue),
this.isActive&&this.tld(this._element),xa=!0}return xa}$B(){this.isActive||(this.Jej(!1),this.isActive&&(this._element.focus(),this.tld(this._element),this.KGe=!0));return!1}gva(){return this.KGe?(this.tld(this._element),this.KGe=!1,!0):!1}G7b(){return 32===this.ga.processAction(Ra.a.renameFile,1)}Mqh(){const Q=Pb.a.wI(this.QGa.Hz);let xa=this._element.innerText.trim();xa.length>this.Irb&&(xa=xa.substr(0,this.Irb));xa!==Q&&""!==xa?32!==this.ga.Xb(Ra.a.renameFile,2,xa)?this.eVf():this.Lhc(xa):this.eVf()}eVf(){this.Lhc(Pb.a.wI(this.QGa.Hz))}Lhc(Q){this._initialized&&
(this._element.innerText=Q,this.N_g())}Jej(Q){this.G7b()?this.isActive||(Q&&(this.Pse=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(pb.a.Bh,pb.a.yfh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Yc.CuiHelper.KDh),this.H7a&&this.H7a.execute(xa=>{xa.OKi(!0)}),Q&&this._element.focus(),ia.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(Ra.a.ifc,
2)}P2e(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(pb.a.Bh,pb.a.J1);Sys.UI.DomElement.removeCssClass(this._element,Yc.CuiHelper.KDh);this.H7a&&this.H7a.execute(xa=>{xa.OKi(!1)});Q&&(this._element.blur(),this._element.focus())}static Uva(){wd.a.Uva(F.AFrameworkApplication.isRtl)}static Hl(){return new Wb(F.AFrameworkApplication.ya,le.a.instance,uf.KeyInputManager.instance,yg.a.instance,F.AFrameworkApplication.Gt,Wb.Uva,
sa.a.dGn,sa.a.Aoh,oa.a.instance.$a("Common.App.Header.HeaderEventSource"),Oa.a.WB,Oa.a.mi,Oa.a.gj)}}Object(e.a)(Wb,"RenameUIHandler",null,[1803]);class Oc{static get instance(){return F.AFrameworkApplication.ta.Rb.KI?Oc._instance||(Oc._instance=xc.Hl()):Oc._instance||(Oc._instance=Wb.Hl())}}Oc._instance=null;Object(e.a)(Oc,"RenameUIHandlerFactory",null,[]);var nd=c(113);class ve{constructor(){this.YDf=this.qNm=this.cRk=null}}Object(e.a)(ve,"RenameMruEntryProperties",null,[]);var nf=c(162),pf=c(87),
Mg=c(1500),Jg;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(Jg||(Jg={}));Object(e.b)("CommonOperationResult",Jg);class rh{constructor(Q,xa,jb,Nb,Bc,gd,
be,Bd,Xe,eg,og,Ni){this.sNg=Q;this.ga=xa;this.Zj=jb;this.XK=Nb;this.qrb=Bc;this.U_j=gd;this.I$a=be;this.L5g=Bd;this.MTj=Xe;this.g8a=eg;this.Oa=og;this.LTj=Ni}Vb(){F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.KI||this.wc.pa(Ra.a.E5b,$b.a.frame,Object(a.a)(this,this.E5b,"initializeRenameUIHandler"));this.wc.pa(Ra.a.ifc,$b.a.frame,Object(a.a)(this,this.ifc,"showRenameDisabledDialog"));this.wc.pa(Ra.a.renameFile,$b.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.wc.gb(Ra.a.fileNameUpdate,
$b.a.frame,Object(a.a)(this,this.bmn,"refreshFilename"),64);this.wc.gb(Ra.a.IVd,$b.a.frame,Object(a.a)(this,this.IVd,"moveToFolderCompleteByHost"),64);this.wc.pa(Ra.a.eGb,$b.a.frame,Object(a.a)(this,this.eGb,"moveToFolder"));F.AFrameworkApplication.ta&&(F.AFrameworkApplication.K.$("PostMessageEmbedded")||F.AFrameworkApplication.K.$("IsJsApi"))&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&F.AFrameworkApplication.gQ().execute(Q=>{Q.Av(pf.a.Iti);
Q.fC(pf.a.Iti,rh.bjn);Q.Av(pf.a.n9e);Q.fC(pf.a.n9e,rh.$in)})}G7b(){return 0===this.LTj.iZh()?32:8}dro(){return this.Kp?this.I$a?this.Kp.QCh:this.Kp.Bdb:!0}E5b(){return Oc.instance.initialize(F.AFrameworkApplication.yCd,F.AFrameworkApplication.HCh,F.AFrameworkApplication.UQi||CommonUIStrings.l_RenameFileTooltip)?32:8}ifc(){const Q=this.dro(),xa=this.U_j();ia.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.qrb,xa,Q,this.I$a);F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.NA&&F.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new zc(this.qrb,!xa,!Q,this.I$a,this.g8a()):new Of(this.qrb,!xa,!Q,this.I$a,this.g8a());return 32}renameFile(Q,xa,jb,Nb,Bc){if(1===jb)return this.G7b();if(!F.AFrameworkApplication.rzb)return 8;if(8===this.G7b())return this.wc.processAction(Ra.a.ifc,2),8;ia.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");F.AFrameworkApplication.rzb(Bc,Object(a.a)(this,
this.VTc,"onRenameFileSuccess"),Object(a.a)(this,this.yYm,"onRenameFileFailure"));return 32}VTc(Q,xa){Q?0!==Q.OperationResult?this.h4h(Q.OperationResult):(this.NHn(xa,Q.NewName),this.gjo(Q,Object(a.a)(F.AFrameworkApplication.ta.Rb,F.AFrameworkApplication.ta.Rb.ljj,"updateOpenInClientDocumentUrl")),F.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&F.AFrameworkApplication.ta.updateCommandUI(),this.MTj.ghj()):this.h4h(5)}NHn(Q,xa){const jb={};jb[nf.a.L9k]=xa;Q.sendMessage(pf.a.n9e,
jb)}gjo(Q,xa){this.rjo(Q);F.AFrameworkApplication.Czd=Q.DirectInvokeDavUrl;xa=xa(Q.EditDocInClientUrl);const jb=new ve;jb.YDf=this.XK.Hz;jb.cRk=xa;jb.qNm=Q.EditDocInClientUrl;this.wc.Xb(Ra.a.VQi,2,jb)}h4h(Q){switch(Q){case 1:Q=new Kd.StandardDialog,Q.Gd=0,Q.yU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.HTi()}}rjo(Q){this.XK.Hz=rh.ndk(this.XK.Hz,Q.NewName);Q.BreadcrumbFolderName&&(this.XK.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&
(this.XK.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.L5g(Q.NewName)}yYm(Q){const xa=new Kd.StandardDialog;xa.Gd=0;switch(Q){case 1:ia.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");xa.fha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ia.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");xa.fha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:ia.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),xa.fha(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}F.AFrameworkApplication.gQ().execute(jb=>{jb.sendMessage(pf.a.K9k,{["FailureMessage"]:Jg[Q]})});this.HTi()}bmn(Q,xa,jb){if(1===jb)return this.G7b();if(!F.AFrameworkApplication.fLa)return 8;F.AFrameworkApplication.fLa(Object(a.a)(this,this.fac,"onRefreshFilenameSuccess"),Object(a.a)(this,this.xYd,"onRefreshFilenameFailure"),
!1);return 32}eGb(Q,xa,jb,Nb,Bc){if(1===jb)return F.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===jb){const gd={};Q=F.AFrameworkApplication.wEb;xa=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&xa)&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);gd[nf.a.K6n]=Q;Bc&&Bc.MoveButtonClickedTime&&(gd[nf.a.JLm]=Bc.MoveButtonClickedTime.getTime());F.AFrameworkApplication.gQ().execute(be=>{be.sendMessage(pf.a.eGb,
gd)});if(Bc&&Bc.MoveButtonClickedTime){if(Q=nd.a.jF())Bc=(new Date).getTime()-Bc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",Bc.toString());La.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}IVd(Q,xa,jb,Nb,Bc){if(1===jb)return F.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.G7b():8;if(2===jb){if(!F.AFrameworkApplication.QZc)return La.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!Bc)return La.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Bc[nf.a.Pcm])if(Bc[nf.a.Okj])if(Q=Bc[nf.a.Okj].toLowerCase(),xa=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),jb=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),xa&&F.AFrameworkApplication.wEb&&jb){const gd={};gd[nf.a.gcc]="1";gd[nf.a.documentUrl]=Q;gd[nf.a.reason]=Mg.a.qWf;La.Health.instance.recordKpiSuccess("MoveToFolder",null);
F.AFrameworkApplication.gQ().execute(be=>{be.sendMessage(pf.a.Qyb,gd)})}else if(!F.AFrameworkApplication.wEb&&jb)La.Health.instance.recordKpiSuccess("MoveToFolder",null),sa.a.Gm(Q,sa.a.fpa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return La.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else La.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else F.AFrameworkApplication.fLa(Object(a.a)(this,this.fac,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.xYd,"onRefreshFilenameFailure"),!1),F.AFrameworkApplication.QZc(),La.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}bYn(Q,xa){return Q&&xa?Q!==this.XK.breadcrumbFolderName||xa!==this.XK.breadcrumbFolderUrl:!1}fac(Q,xa){Q&&(Q.NewName!==Pb.a.wI(this.XK.Hz)||this.bYn(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.VTc(Q,xa)}xYd(){}HTi(){this.L5g(Pb.a.wI(this.XK.Hz))}get wc(){return this.ga.value}get Kp(){return this.Zj.value}static get instance(){return rh._instance||
(rh._instance=rh.eAb())}static eAb(){return new rh(F.AFrameworkApplication.cPc,new tb.a(()=>F.AFrameworkApplication.ya),new tb.a(()=>F.AFrameworkApplication.Kp),F.AFrameworkApplication.Gt,F.AFrameworkApplication.Wma,()=>F.AFrameworkApplication.z$f,F.AFrameworkApplication.iYc,Object(a.a)(Oc.instance,Oc.instance.Lhc,"updateTitle"),oa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>F.AFrameworkApplication.Ju,F.AFrameworkApplication.K,oa.a.instance.resolve("Common.IRenameProps"))}static ndk(Q,
xa){Q=Pb.a.MLa(Q);return xa+Q}static bjn(Q){const xa=Q.Values[nf.a.vim];ia.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",xa);xa?F.AFrameworkApplication.ya.Xb(Ra.a.IVd,2,Q.Values):La.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static $in(Q){F.AFrameworkApplication.ya.Xb(Ra.a.renameFile,2,Q.Values.NewName)}}rh._instance=null;Object(e.a)(rh,"RenameActor",null,[]);var Tg=c(126),ak=c(1341),ci=c(536),Af=c(389);class Ef{constructor(Q,
xa){this.ga=Q;this.tmc=xa}Vb(){this.ga.pa(Ra.a.x1f,$b.a.frame,Object(a.a)(this,this.R_n,"showRenameDialogAction"))}R_n(Q,xa,jb){Q=32;if(1===jb)return Af.SessionStatusManager.instance.Tj||F.AFrameworkApplication.Ama?8:32;2===jb&&(32!==this.ga.processAction(Ra.a.renameFile,1)?(this.ga.processAction(Ra.a.ifc,2),Tg.a.instance.Zb(ak.a.hla,{["Reason"]:ci.a.Wun}),Q=8):32===this.ga.processAction(Ra.a.jfc,1)?this.ga.processAction(Ra.a.jfc,2):this.tmc.value.create().gQa());return Q}}Object(e.a)(Ef,"RenameDialogActor",
null,[1770]);class Ue{constructor(Q,xa,jb){this.dialog=null;this.ga=Q;this.XK=xa;this.p7a=jb}$Hl(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Ue.E0b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Pb.a.wI(this.XK.Hz),["maxLength"]:this.p7a};return Q}gQa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.$Hl()};this.dialog=new uc.a(!1,!1,!0);this.dialog.Gd=1;this.dialog.lg="RenameDialog";this.dialog.Vh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.vTf,"renameDialogHandler"),
Q)}vTf(Q,xa){if(xa&&1===Q){if(xa[Ue.E0b]&&(Q=Pb.a.wI(this.XK.Hz),xa=(xa[Ue.E0b]||"").trim(),xa!==Q&&""!==xa)){this.ga.Xb(Ra.a.renameFile,2,xa);return}Tg.a.instance.Zb(ak.a.A0b,{["Reason"]:ci.a.vIh})}}}Ue.E0b="txtDocumentName";Object(e.a)(Ue,"ReactRenameDialog",null,[1806]);class Df{static get vg(){return uc.a.Rx(Df.tl,CommonUIStrings.l_RenameDialogLabel)}}Df.tl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(Df,"RenameDialogHtml",null,[]);class Sf extends uc.a{constructor(Q,xa,jb){super();this.ga=Q;this.XK=xa;this.p7a=jb;this.lg="RenameDialog";this.vg=Df.vg}gQa(){var Q={["txtDocumentName"]:Pb.a.wI(this.XK.Hz)};this.Vh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.vTf,"renameDialogHandler"),Q);Q=document.getElementById(Sf.E0b);0<this.p7a&&(Q.maxLength=this.p7a);Q.focus()}vTf(Q,xa){if(1===Q&&(Q=Pb.a.wI(this.XK.Hz),xa=(xa[Sf.E0b]||"").trim(),xa!==Q&&""!==xa)){this.ga.Xb(Ra.a.renameFile,
2,xa);return}Tg.a.instance.Zb(ak.a.A0b,{["Reason"]:ci.a.vIh})}}Sf.E0b="txtDocumentName";Object(e.a)(Sf,"RenameDialog",uc.a,[1806]);class Se{constructor(Q){this.QGa=null;this.p7a=0;this.ga=Q;this._initialized=!1}initialize(Q,xa){this.QGa=Q;this.p7a=xa;this._initialized=!0}create(){return this._initialized?F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.NA&&F.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Ue(this.ga,this.QGa,this.p7a):new Sf(this.ga,this.QGa,this.p7a):null}}Object(e.a)(Se,
"RenameDialogFactory",null,[1769]);var Ii=c(155),hg=c(153),Fg=c(82);class qf{constructor(Q,xa){this.ga=Q;this.Ub=xa}Vb(){this.ga.pa(Ra.a.jfc,$b.a.frame,Object(a.a)(this,this.S_n,"showRenameFlyoutAction"))}Qsk(){return hg.d("setDocumentTitleFlyoutOpened")&&F.AFrameworkApplication.ta.Rb.KI}S_n(Q,xa,jb){if(1===jb)return this.Qsk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}A6j(){qf.Emm&&F.AFrameworkApplication.P2&&Fg.a.instance.fc(new Fc.a(5,1,5E3,()=>{32===
this.ga.processAction(Ra.a.jfc,1)&&this.Ub&&this.Ub.pg.name===Ii.AFrame.Wo&&(Ce.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(Ra.a.jfc,2))}))}static get Emm(){qf.sed&&null!=qf.sed||(F.AFrameworkApplication.Ne("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),qf.sed=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return qf.sed}}qf.sed=null;Object(e.a)(qf,
"RenameFlyoutActor",null,[1768]);class Cg{constructor(Q,xa,jb,Nb,Bc){this.tAk=null;this.Zj=Bc;this.tNg=jb;this.sNg=Nb;this.W_j=Q;this.g8a=xa}get Kp(){return this.Zj.value}iZh(){if(!this.sNg())return 5;if(this.g8a())return 1;if(this.Kp){if(this.tNg&&!this.Kp.QCh)return 3;if(!this.tNg&&!this.Kp.Bdb)return 4}return this.W_j()?0:2}}Object(e.a)(Cg,"RenameProps",null,[1767]);class Hh{constructor(Q,xa,jb,Nb,Bc,gd){this.Ml=!1;this.Bxe=new nb.a;this.gQb=xa;this.wy=jb;this.$Ob=Nb;this.Oa=Bc;this.sja=gd}enable(){this.Ml||
(this.ghj(),this.c3f(),this.Ml=!0)}generateKey(Q,xa,jb){return String.format("{0}/{1}/{2}",jb,Q,xa)}oyl(){const Q=Pb.a.wI(this.gQb().Hz);return this.generateKey(this.gQb().breadcrumbFolderName,this.gQb().breadcrumbFolderUrl,Q)}pyl(Q,xa,jb){return Q&&xa?this.generateKey(Q,xa,jb):jb}NXk(Q,xa,jb){return Q&&Q!==this.gQb().breadcrumbFolderName||xa&&xa!==this.gQb().breadcrumbFolderUrl?!0:jb!==Pb.a.wI(this.gQb().Hz)}ghj(){const Q=this.oyl();this.Bxe.Z(Q,new Date)}SLf(Q){this.oWn(Q)&&this.U7g(Q)}oWn(Q){const xa=
this.$Ob();return xa?this.sja&&this.sja.Bo||!xa.arf||!F.AFrameworkApplication.fLa?(this.W9i(Q),this.Ml=!1):!0:!1}JBi(Q,xa,jb,Nb){const Bc=this.NXk(Q,xa,jb);Q=this.pyl(Q,xa,jb);xa=this.Bxe.Bc(Q).returnValue;Bc&&!xa&&(this.j4h(Nb),ia.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.jyf));Bc||this.Bxe.Z(Q,this.wy())}}Object(e.a)(Hh,"ARenamedFileChecker",null,[1724]);class aj extends Hh{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){super(Q,xa,jb,Nb,Bc,gd);this.LJ=Bc;this.KTj=be;this.rse=Bd}get jyf(){return"RenamedFileCheckerUsingSettingsRefresh"}c3f(){this.LJ.Byc(Object(a.a)(this,
this.A4h,"handleSettingsRefresh"))}A4h(Q,xa){xa&&xa.nGb&&xa.Kwi&&(xa.jNa("BreadcrumbDocName")||xa.jNa("BreadcrumbFolderName")||xa.jNa("BreadcrumbFolderUrl")||xa.jNa("DirectInvokeDAVUrl")||xa.jNa("EditDocInClientUrl"))&&(ia.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.jyf),this.SLf(xa))}W9i(){this.LJ.JQi(Object(a.a)(this,this.A4h,"handleSettingsRefresh"))}U7g(Q){if(Q&&Q.nGb){const xa=Q.nGb;this.JBi(xa.lb("BreadcrumbFolderName"),xa.lb("BreadcrumbFolderUrl"),xa.lb("BreadcrumbDocName"),
Q)}}j4h(Q){const xa={OperationResult:0,classId:1};Q=Q.nGb;xa.BreadcrumbFolderName=Q.lb("BreadcrumbFolderName");xa.BreadcrumbFolderUrl=Q.lb("BreadcrumbFolderUrl");xa.DirectInvokeDavUrl=Q.lb("DirectInvokeDAVUrl");xa.EditDocInClientUrl=Q.lb("EditDocInClientUrl");Q=Q.lb("BreadcrumbDocName");xa.NewName=F.AFrameworkApplication.EEc?Q:Pb.a.wI(Q);this.rse.execute(jb=>{this.w$l(xa,jb)})}w$l(Q,xa){this.KTj().VTc(Q,xa)}}Object(e.a)(aj,"RenamedFileCheckerUsingSettingsRefresh",Hh,[]);class df extends Hh{constructor(Q,
xa,jb,Nb,Bc,gd,be,Bd,Xe,eg){super(Q,jb,Nb,Bc,gd,Xe);this.xuc=this.Dn=null;this.bSj=xa;this.ga=be;this.Hb=Bd;eg&&eg.execute(og=>{this.kqn(og)})}get jyf(){return"RenamedFileCheckerUsingTask"}kqn(Q){this.Dn=Q;this.Dn.$$a(Object(a.a)(this,this.A6,"handleVisibilityChange"))}A6(Q,xa){!this.Ml||0!==xa.newState&&1!==xa.newState||this.xuc||(this.c3f(),this.SLf(this.xuc))}c3f(){this.xuc=new Fc.a(3,2,this.bSj(),Object(a.a)(this,this.SLf,"performRenameFileCheckTick"),89);this.Hb.fc(this.xuc)}W9i(Q){this.Hb.Ye(Q)}U7g(Q){this.Dn&&
2===this.Dn.YE?this.Zrn(Q):F.AFrameworkApplication.fLa(Object(a.a)(this,this.fac,"onRefreshFilenameSuccess"),Object(a.a)(this,this.xYd,"onRefreshFilenameFailure"),!0)}Zrn(Q){this.Hb.Ye(Q);this.xuc=null}fac(Q){Q&&this.JBi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}j4h(){this.ga.processAction(Ra.a.fileNameUpdate,2)}xYd(){}}Object(e.a)(df,"RenamedFileCheckerUsingTask",Hh,[]);var ld=c(57);class dj{constructor(){this.Oa=this.W=null}get name(){return"Common.App.RenameFile"}zc(Q){this.W=
Q;this.Oa=F.AFrameworkApplication.K;this.W.register(Ef,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Zd(()=>new Ef(F.AFrameworkApplication.ya,this.W.Ze("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(Se,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Zd(()=>new Se(F.AFrameworkApplication.ya)).singleInstance();this.W.register(1724,"Common.App.Rename.IRenamedFileChecker").Zd(()=>this.xOk()).singleInstance();
this.W.register(qf,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Zd(()=>new qf(F.AFrameworkApplication.ya,ld.FocusManager.instance())).singleInstance()}xOk(){if(this.Oa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Pa("Common.IRefreshableAppSettings");if(Q&&Q.Ohi)return new aj(()=>Q.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>F.AFrameworkApplication.Gt,()=>new Date,()=>F.AFrameworkApplication.Kp,Q,this.W.Pa("Common.ISessionStatus"),()=>
rh.instance,this.W.$a("Postmessage.IHostPostmessenger"))}return new df(()=>this.Oa.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Oa.rc("RenamedFileCheckerPingIntervalInMs",12E4),()=>F.AFrameworkApplication.Gt,()=>new Date,()=>F.AFrameworkApplication.Kp,F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.uc,this.W.Pa("Common.ISessionStatus"),this.W.$a("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Oa.gq(Object(a.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){const Q=
F.AFrameworkApplication.ta.Rb.KI;F.AFrameworkApplication.cPc()&&Oc.instance.initialize(F.AFrameworkApplication.yCd,Q?null:F.AFrameworkApplication.HCh,Q?null:F.AFrameworkApplication.UQi||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Cg,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Zd(()=>new Cg(()=>F.AFrameworkApplication.z$f,()=>F.AFrameworkApplication.Ju,F.AFrameworkApplication.iYc,F.AFrameworkApplication.cPc,new tb.a(()=>F.AFrameworkApplication.Kp))).singleInstance(),rh.instance.Vb(),
this.Oa.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(F.AFrameworkApplication.Gt,F.AFrameworkApplication.yCd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Vb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Vb(),F.AFrameworkApplication.iYc&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").A6j())}dispose(){}}Object(e.a)(dj,"PackageManager",null,[1,2]);class Yh{static get vg(){return uc.a.Rx(Yh.tl,
CommonUIStrings.l_SaveACopyFileName)}}Yh.tl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(Yh,"FileNameDialogHtml",null,[]);class Nl extends uc.a{constructor(Q,xa,jb,Nb){super();this.Lad=this.mHa=
null;this.ga=Q;this.lpa=xa;this.qxc=jb;this.We(1,CommonUIStrings.l_SaveButtonLabel);this.vg=Yh.vg;this.lg="FileNameDialog-SaveACopy";this.Mm=Nb}MAa(Q,xa,jb){this.Lad=Q;this.mHa=jb;Q={["txtFileName"]:Pb.a.wI(F.AFrameworkApplication.Gt.Hz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,xa)};this.Vh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.xCd,"fileNameDialogHandler"),Q);ia.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}xCd(Q,
xa){1!==Q?ia.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=xa.txtFileName.trim(),ia.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),xa=Pb.a.MLa(F.AFrameworkApplication.fileName),Q&&""!==Q&&""!==xa&&(Q+=xa),this.qxc.REa(this.Lad,this.mHa,Q,this.Mm))}}Object(e.a)(Nl,"FileNameDialog",uc.a,[1880]);class ij{constructor(Q,xa,jb){this.ga=Q;this.lpa=xa;this.qxc=jb}create(Q){return new Nl(this.ga,this.lpa,this.qxc,Q)}}Object(e.a)(ij,
"FileNameDialogFactory",null,[1836]);class ck extends Kd.StandardDialog{constructor(Q){super();this.Gd=1;this.We(1,CommonUIStrings.l_RetryButtonLabel);this.We(0,CommonUIStrings.l_DialogClose);this.ga=Q}XS(Q){ia.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.my(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.tVf,"retryDialogHandler"))}tVf(Q){1===Q?(ia.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(Ra.a.udc,
2)):ia.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(ck,"RetryDialog",Kd.StandardDialog,[1713]);var Mk=c(225);class Wf{constructor(Q,xa,jb,Nb){this.wkd=null;this.aVj=Q;this.Oa=jb;this.fVg=xa;this.kQg=new n.a;this.me=Nb}h8b(){return this.Oa.$("SaveToCloudStorageUIIsEnabled")}ydb(){return Ra.a.yWf}Ftd(){Zb.a.rXc(Object(a.a)(this,this.iWi,"saveToCloudActionDispatcher"));Zb.a.sFc([new Mk.a(Ra.a.yWf,$b.a.frame,0)],this.fVg.x3b())}Vb(){const Q=this.fVg.x3b();Q?(Q.VV(()=>
{this.kQg.Eg(!0)}),this.Ftd()):ia.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}dMi(){ia.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}iWi(Q,xa,jb,Nb,Bc){return xa.contextId!==$b.a.frame||Q!==this.ydb()?2:this.h8b()?1===jb?Af.SessionStatusManager.instance.Tj||F.AFrameworkApplication.Ama?8:32:2===jb?(this.dMi(),Bc&&Bc.FileDownloadUrl&&ia.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.me&&(this.wkd=this.me.jg("DialogShown","SaveToOneDriveReponseTime")),this.kQg.task.continueWith(()=>{this.wkd&&(this.wkd.stop(),this.wkd=null);this.aVj.start(Bc)}),32):8:8}}Object(e.a)(Wf,"SaveToCloudStorageActor",null,[1711]);class cg extends Wf{constructor(Q,xa,jb,Nb){super(Q,xa,jb,Nb);this.CQj=xa}h8b(){return this.Oa.$("SaveACopyBrsIsEnabled")}ydb(){return Ra.a.udc}Ftd(){Zb.a.rXc(Object(a.a)(this,this.iWi,"saveToCloudActionDispatcher"));Zb.a.sFc([new Mk.a(Ra.a.udc,$b.a.frame,0)],this.CQj.x3b())}dMi(){ia.ULS.sendTraceTag(7205456,
216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(cg,"SaveACopyActor",Wf,[]);class bl{}bl.default=0;Object(e.a)(bl,"SaveToCloudErrorCodes",null,[]);class tl{constructor(Q,xa,jb,Nb,Bc,gd){this.Mm=null;this.WWj=Q;this.Zqa=xa;this.qxc=jb;this.Oa=Nb;this.X6c=Bc;this.vG=gd}start(Q){this.Mm=Q;if("SharePointOnlineConsumer"===this.Oa.lb("FileSource")){const xa=oa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(xa){xa.start(null,Q);return}}this.Zqa.fNc?
(ia.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.Ork()):(ia.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.a0n())}a0n(){this.WWj.create().MAa()}Bp(){this.vG().XS(bl.default)}Ork(){try{ia.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.X6c||2===this.X6c)Q={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId};
WL.init(Q);ia.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){ia.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.Bp()}}onSuccess(Q){ia.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&
Q.data.folders&&this.qxc.REa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Mm)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){ia.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ia.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else ia.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Bp()}}Object(e.a)(tl,"SaveToCloudManager",
null,[1712]);class ki extends tl{constructor(Q,xa,jb,Nb,Bc,gd,be){super(xa,jb,Nb,Bc,gd,be);this.PEj=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(ia.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.PEj.create(this.Mm).MAa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(ia.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Bp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&ia.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}Bp(){ia.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Bp()}}Object(e.a)(ki,"SaveACopyManager",tl,[]);var ul=c(187);class Cf{constructor(Q,xa,jb,Nb,Bc){this.mHa=this.Nk=this.Dkc=null;this.xY=!1;this.Mm=this.mVa=null;this.dMe=Q;this.bUa=xa;this.vG=jb;this.Ti=Nb;this.me=Bc}v3a(){this.Ti&&1===this.Ti.state||(this.Nk=this.bUa(),this.Nk.message=CommonUIStrings.l_CommentProgressTooltip,this.Nk.Gd=
5,this.Nk.It=!1,this.Nk.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Ska(){this.Nk&&(this.Nk.close(),this.Nk=null)}N3(){1!==F.AFrameworkApplication.ta.state&&this.vG().XS(bl.default)}OIb(){ia.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");sa.a.Gm(this.mHa,sa.a.fpa(3),void 0,"UploadToCloudManager.RedirectToFolder")}NIb(Q){let xa=!1,jb=!1;F.AFrameworkApplication.K&&(xa=F.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),jb=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
ia.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,xa);if(xa&&jb){ia.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[nf.a.gcc]="1";Nb[nf.a.documentUrl]=Q;F.AFrameworkApplication.gQ().execute(Bc=>{Bc.sendMessage(pf.a.Qyb,Nb)})}else sa.a.Gm(Q,sa.a.fpa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}REa(Q,xa,jb=null,Nb=null){ia.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.me&&(this.mVa=this.me.jg("DialogShown","SaveToOneDriveUploadTime"));this.v3a();this.mHa=xa;this.Dkc=this.dMe.create(Q,jb,Nb);this.Mm=Nb;this.wea()}wea(){ia.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Dkc.execute(Object(a.a)(this,this.kZm,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.jZm,"onSaveToCloudUploadFailed"))}kZm(Q){this.Ska();this.xY=!1;if(Q&&Q.data&&Q.data.Ie){var xa;if(({Iv:xa}=Ma.d(Q.data.Ie)).returnValue)if(Q=xa,Q.StatusCode!==ul.a.yD&&Q.StatusCode!==
ul.a.kDc)ia.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.N3();else{ia.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.NIb(Q.NewDocumentUrl):this.OIb()}catch(jb){ia.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",jb.toString())}this.$Uc()}else ia.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.b3c(Q.data.Ie)}),
this.N3()}else ia.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.N3()}jZm(Q){5!==Q.data.status&&12!==Q.data.status||this.xY?(ia.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.Ska(),this.N3(),this.$Uc()):(ia.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.xY=!0,this.wea())}$Uc(){this.mVa&&(this.mVa.stop(),this.mVa=null)}}Object(e.a)(Cf,"UploadToCloudManager",null,
[1710]);class gm extends Cf{constructor(Q,xa,jb,Nb,Bc,gd){super(xa,jb,Nb,Bc,gd);this.ga=Q}Ntf(){return!!this.Mm&&!!this.Mm.SaveEntryPoint&&"VersionHistory"===this.Mm.SaveEntryPoint.toString()}N3(){ia.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Ntf()&&this.ga.Xb(Ra.a.E4d,2,{["FailureReason"]:"Unknown"});super.N3()}OIb(){ia.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Ntf()&&this.ga.processAction(Ra.a.DYc,2);super.OIb()}NIb(Q){ia.ULS.sendTraceTag(7205461,
216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.Ntf()&&this.ga.processAction(Ra.a.DYc,2);super.NIb(Q)}wea(){this.Mm&&"true"===this.Mm.SkipSaveToHost?super.wea():32!==this.ga.processAction(Ra.a.HJb,1)?(ia.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.wea()):this.ga.Xb(Ra.a.HJb,2,[()=>{ia.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Cf.prototype.wea.call(this)},()=>{ia.ULS.sendTraceTag(8741713,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.N3()}])}}Object(e.a)(gm,"SaveACopyUploadToCloudManager",Cf,[]);var zd=c(745),dk=c(1185);class Bj{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){F.AFrameworkApplication.K.gq(Object(a.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){F.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register(gm,
"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Zd(()=>new gm(F.AFrameworkApplication.ya,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new dk.a).create(),()=>new ck(F.AFrameworkApplication.ya),F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.lq)).singleInstance();this.W.register(ij,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Zd(()=>new ij(F.AFrameworkApplication.ya,F.AFrameworkApplication.ta.Rb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();
this.W.register(cg,"Common.App.SaveACopy.SaveACopyActor").Zd(()=>new cg(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.lq)).singleInstance();this.W.register(ki,"Common.App.SaveACopy.SaveACopyManager").Zd(()=>new ki(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),zd.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
F.AFrameworkApplication.K,F.AFrameworkApplication.bla,()=>new ck(F.AFrameworkApplication.ya))).singleInstance()}static main(){ca.a.instance.Pc(new Bj)}}Object(e.a)(Bj,"PackageManager",null,[1,2]);var tj=c(42);class mk extends Kd.StandardDialog{constructor(Q,xa){super();this.vTb=!1;this.SM=null;this.ga=Q;this.xnc=xa;this.IEa=!1}XS(Q,xa,jb){this.SM=xa;this.vTb=jb;ia.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,jb);Q=this.OWe(Q);0===Q?(this.Gd=6,this.We(0,CommonUIStrings.l_DialogClose)):
(this.Gd=0,this.We(1,CommonUIStrings.l_DialogClose));0===Q&&ia.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.my(tj.a.NDn,this.rrl(Q),this.qrl(Q,xa),Object(a.a)(this,this.tVf,"retryDialogHandler"),!0)}tVf(Q){1===Q?(ia.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.SM?this.ga.Xb(Ra.a.uZc,2,[this.SM,this.vTb]):this.ga.processAction(Ra.a.uZc,2)):ia.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}OWe(Q){return 0>Q||6<Q?(ia.ULS.sendTraceTag(8194012,
216,15,"Unexpected error code {0}.",Q),0):Q}qrl(Q,xa){Q=this.OWe(Q);return this.xnc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,xa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,
CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,xa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}rrl(Q){Q=this.OWe(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(e.a)(mk,"ErrorRetryDialog",Kd.StandardDialog,
[1742]);class Tm{constructor(Q,xa){this.Oa=Q;this.ga=xa;this.xnc=this.Oa.$("SaveToHostWithExtraCharsInFileName")}create(){return new mk(this.ga,this.xnc)}}Object(e.a)(Tm,"ErrorRetryDialogFactory",null,[1701]);class sm extends uc.a{constructor(Q,xa,jb,Nb,Bc,gd,be=null){super();this.M4=null;this.ga=xa;this.lpa=Nb;this.nVa=gd;this.Oa=Q;this.vG=Bc;this.Ti=jb;this.xnc=this.Oa.$("SaveToHostWithExtraCharsInFileName");this.Mm=be;this.We(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Ti}xBh(Q,xa){this.Wga(1,
!!Q&&Q!==xa);this.M4=document.getElementById(sm.uIh);H.a.addHandler(this.M4,"change",Object(a.a)(this,this.BXd,"onFileNameChange"));H.a.addHandler(this.M4,"input",Object(a.a)(this,this.BXd,"onFileNameChange"));this.M4.focus()}tIh(Q){return this.xnc?(new RegExp("["+this.pGh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.pGh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}pGh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Dkf(){const Q=Pb.a.wI(F.AFrameworkApplication.Gt.Hz);this.Wga(1,!!this.M4&&
""!==this.M4.value&&this.M4.value!==Q)}BXd(){this.M4&&window.setTimeout(()=>{this.Dkf()},0)}xCd(Q,xa){if(1!==Q)ia.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=xa[sm.uIh];xa=sm.FDi in xa?xa[sm.FDi]:!1;ia.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Pb.a.FMi(Q),xa);const jb=Pb.a.MLa(F.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==jb||1===this.ta.state?this.tIh(Q)?
this.vG.create().XS(1,Q,xa):this.nVa.REa(Q+jb,xa,this.Mm):this.vG.create().XS(2,Q,xa)}}dispose(){this.M4&&(H.a.removeHandler(this.M4,"change",Object(a.a)(this,this.BXd,"onFileNameChange")),H.a.removeHandler(this.M4,"input",Object(a.a)(this,this.BXd,"onFileNameChange")),this.M4=null);super.dispose()}}sm.uIh="txtFileName";sm.FDi="chkOverwrite";Object(e.a)(sm,"FileNameDialogBase",uc.a,[]);class Xl{static get vg(){return uc.a.Rx(Xl.tl,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Xl.tl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Xl,"FileNameDialogHtml",null,[]);class ni extends sm{constructor(Q,xa,jb,Nb,Bc,gd){super(Q,xa,jb,Nb,Bc,gd);this.vg=Xl.vg;this.lg="FileNameDialog-SaveAsToHost"}MAa(Q,xa){const jb=Pb.a.wI(F.AFrameworkApplication.Gt.Hz);xa={["txtFileName"]:Q||jb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:xa};this.Vh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.xCd,"fileNameDialogHandler"),xa);this.xBh(Q,jb)}}Object(e.a)(ni,"FileNameDialog",sm,[1741]);class uh{constructor(Q,xa,
jb,Nb,Bc,gd){this.ga=xa;this.Oa=Q;this.lpa=Nb;this.nVa=gd;this.vG=Bc;this.Ti=jb}create(){return new ni(this.Oa,this.ga,this.Ti,this.lpa,this.vG,this.nVa)}}Object(e.a)(uh,"FileNameDialogFactory",null,[1700]);class yh{constructor(Q,xa,jb){this.nVa=jb;this.Npe=xa;this.Oa=Q}Vb(){2===F.AFrameworkApplication.ta.Rb.ko?F.AFrameworkApplication.ya.gb(Ra.a.uZc,$b.a.frame,Object(a.a)(this,this.RVi,"saveAsToHostActionDispatcher"),4):F.AFrameworkApplication.ya.pa(Ra.a.uZc,$b.a.frame,Object(a.a)(this,this.RVi,"saveAsToHostActionDispatcher"))}RVi(Q,
xa,jb,Nb,Bc){return xa.contextId!==$b.a.frame||Q!==Ra.a.uZc?2:this.Oa.$("SaveAsToHostBrsIsEnabled")?1===jb?Af.SessionStatusManager.instance.Tj||F.AFrameworkApplication.Ama?8:32:2===jb?(ia.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.Npe.create(),Bc&&Object.getType(Bc)===Array&&2===Bc.length?Q.MAa(Bc[0],!!Bc[1]):Q.MAa(null,!1),32):8:8}}Object(e.a)(yh,"SaveAsToHostActor",null,[]);class ll{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){this.Nk=null;this.vTb=
this.xY=!1;this.mVa=this.Mm=this.SM=null;this.Oa=xa;this.w5=this.Oa.appSettings.SaveAsToHostWebServiceBase;this.WKg=Nb;this.bUa=Bc;this.rg=jb;this.vG=gd;this.me=Bd;this.Ti=be;this.ga=Q;this.LSa=xa.lb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}v3a(){1!==this.Ti.state&&(this.Nk=this.bUa(),this.Nk.message=CommonUIStrings.l_CommentProgressTooltip,this.Nk.Gd=5,this.Nk.It=!1,this.Nk.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}N3(Q=0){1!==this.Ti.state&&this.vG.create().XS(Q,Pb.a.wI(this.SM),
this.vTb)}OIb(){const Q=this.Oa.appSettings.BreadcrumbFolderUrl;ia.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");sa.a.Gm(Q,sa.a.fpa(3),void 0,"UploadToHostManager.RedirectToFolder")}NIb(Q){let xa=!1,jb=!1;this.Oa&&(xa=this.Oa.$("SaveACopyIsEnabledForUiHost"),jb=this.Oa.$("UiHostSupportsDocRebootFeatures"));ia.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,xa,jb);if(xa&&jb){ia.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[nf.a.gcc]="1";Nb[nf.a.documentUrl]=Q;Nb[nf.a.reason]=Mg.a.qWf;F.AFrameworkApplication.gQ().execute(Bc=>{Bc.sendMessage(pf.a.Qyb,Nb)})}else xa&&!jb&&F.AFrameworkApplication.$Ma?sa.a.Gm(Q,sa.a.fpa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):sa.a.Gm(Q,sa.a.fpa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}REa(Q,xa,jb=null){ia.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.WKg&&
!this.WKg()&&this.rg&&(this.me&&(this.mVa=this.me.jg("DialogShown","SaveAsToHostUploadTime")),this.v3a(),this.vTb=xa,this.SM=Q,(this.Mm=jb)&&"true"===this.Mm.SkipSaveToHost?this.IBd():this.wea())}wea(){32!==this.ga.processAction(Ra.a.HJb,1)?(ia.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.IBd()):this.ga.Xb(Ra.a.HJb,2,[()=>{ia.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.IBd()},(Q,xa)=>
{ia.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.N3(xa)}])}m0m(Q){this.Ska();this.xY=!1;if(Q&&Q.data&&Q.data.Ie)if(({Iv:xa}=Ma.d(Q.data.Ie)).returnValue)if(Q=xa,Q.StatusCode!==ul.a.yD&&Q.StatusCode!==ul.a.kDc){ia.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var xa={};xa.FailureReason=Q.StatusCode.toString();xa.ExtraInfo=Q.ExtraInfo;this.pPa(xa);this.N3(parseInt(Q.ExtraInfo))}else{ia.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.rUf();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.NIb(Q.NewDocumentUrl):this.OIb()}catch(jb){ia.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",jb.toString())}this.$Uc()}else ia.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.b3c(Q.data.Ie)}),this.pPa({["FailureReason"]:"Failed to deserialize response"}),this.N3();else ia.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.pPa({["FailureReason"]:"null response"}),this.N3()}l0m(Q){5!==Q.data.status&&12!==Q.data.status||this.xY?(ia.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.Df}),this.pPa({["FailureReason"]:Q.data.Df.toString()}),this.Ska(),this.N3(),this.$Uc()):(ia.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.xY=!0,this.Mm&&"true"===this.Mm.SkipSaveToHost?this.IBd():this.wea())}Ska(){this.Nk&&
(this.Nk.close(),this.Nk=null)}$Uc(){this.mVa&&(this.mVa.stop(),this.mVa=null)}rUf(){this.Mm&&"VersionHistory"===this.Mm.SaveEntryPoint&&this.ga.processAction(Ra.a.DYc,2)}pPa(Q){this.Mm&&"VersionHistory"===this.Mm.SaveEntryPoint&&this.ga.Xb(Ra.a.E4d,2,Q)}IBd(){let Q=this.w5+this.LSa;Q=Kb.a.Ip(Q,"qs",Pb.a.Jj(F.AFrameworkApplication.ym));Q=Kb.a.Ip(Q,"n",Pb.a.Jj((new Date).getTime().toString()));Q=Kb.a.Ip(Q,"ov",Pb.a.Jj(this.vTb.toString()));Q=Kb.a.Ip(Q,"fn",Pb.a.Jj(this.SM));this.Mm&&this.Mm.FileDownloadUrl&&
(Q=Kb.a.Ip(Q,"furl",Pb.a.Jj(this.Mm.FileDownloadUrl)));this.rg.Mj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.m0m,"onUploadFinished"),Object(a.a)(this,this.l0m,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(ll,"UploadToHostManager",null,[1699]);class dn{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){F.AFrameworkApplication.K.gq(Object(a.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){F.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Vb()}zc(Q){this.W=Q;this.W.register(Tm,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Zd(()=>new Tm(F.AFrameworkApplication.K,F.AFrameworkApplication.ya)).singleInstance();this.W.register(ll,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Zd(()=>new ll(F.AFrameworkApplication.ya,F.AFrameworkApplication.K,F.AFrameworkApplication.af,
()=>F.AFrameworkApplication.Tk,()=>(new dk.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.lq)).singleInstance();this.W.register(uh,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Zd(()=>new uh(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.Rb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(yh,"Common.App.SaveAsToHost.SaveAsToHostActor").Zd(()=>new yh(F.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){ca.a.instance.Pc(new dn)}}Object(e.a)(dn,"SaveAsToHostPackage",null,[1,2]);class Gl extends Kd.StandardDialog{constructor(){super();this.Gd=0;this.We(1,CommonUIStrings.l_DialogClose)}XS(Q){this.my(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Gl,"ErrorDialog",Kd.StandardDialog,[1713]);var Ol=c(196);class Bg extends Kd.StandardDialog{constructor(Q,xa,jb){super();this.ga=Q;this.Zqa=xa;this.lpa=jb;this.K8=!1;this.Gd=1;this.wU(1);this.We(1,CommonUIStrings.l_SignIn);this.We(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}MAa(){this.Zqa.Y$g(Object(a.a)(this,this.GBi,"onSignIn"));this.Tv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.L6l,"inputHandler"))}L6l(Q){0===
Q?(ia.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.V_d()}Xuk(){let Q="2";if(this.lpa)switch(this.lpa.ko){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.Zqa.Jtn(Object(a.a)(this,this.GBi,"onSignIn"));super.hide()}V_d(){const Q=new Ol.QueryStringBuilder("Signin.aspx");Q.Ke("prompt","1");Q.Ke("cbcxt",this.Xuk());F.AFrameworkApplication.Ija(Q);sa.a.Gm(Q.toString(),"LoginWindow",void 0,"SignInDialog")}GBi(){this.Hma&&this.hide();ia.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(Ra.a.yWf,2)}}Object(e.a)(Bg,"SignInDialog",Kd.StandardDialog,[1746]);class Ak{constructor(Q,xa,jb){this.ga=Q;this.Zqa=xa;this.lpa=jb}create(){return new Bg(this.ga,this.Zqa,this.lpa)}}Object(e.a)(Ak,"SignInDialogFactory",null,[1708]);class ek{constructor(Q,xa,jb,Nb,Bc,gd,be){this.w5=Q;this.SM=xa;this.LQb=jb;this.Lad=Nb;this.hEe=Bc;this.LSa=gd;this.Mm=be}execute(Q,xa){if(!F.AFrameworkApplication.Tk&&
F.AFrameworkApplication.af){var jb=this.w5+this.LSa;jb=Kb.a.Ip(jb,"fo",Pb.a.Jj(this.Lad));jb=Kb.a.Ip(jb,"fn",Pb.a.Jj(this.SM));jb=Kb.a.Ip(jb,"qs",Pb.a.Jj(this.hEe));jb=Kb.a.Ip(jb,"n",Pb.a.Jj((new Date).getTime().toString()));this.Mm&&this.Mm.FileDownloadUrl&&(jb=Kb.a.Ip(jb,"furl",Pb.a.Jj(this.Mm.FileDownloadUrl)));this.LQb&&(jb=Kb.a.Ip(jb,"fnn",Pb.a.Jj(this.LQb)));F.AFrameworkApplication.af.Mj(jb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,xa,null)}}}Object(e.a)(ek,"SkyDriveUploadCaller",
null,[1745]);class tg{constructor(Q){this.Oa=Q;this.Zub=Q.appSettings.SkyDriveUploadWebServiceBase;this.SM=Q.appSettings.FileName;this.LSa=Q.lb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,xa,jb){return new ek(this.Zub,this.SM,xa,Q,F.AFrameworkApplication.ym,this.LSa,jb)}}Object(e.a)(tg,"SkydriveUploadCallerFactory",null,[1709]);class Be{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){F.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register(Ak,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Zd(()=>new Ak(F.AFrameworkApplication.ya,zd.a.instance,F.AFrameworkApplication.ta.Rb)).singleInstance();this.W.register(tg,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Zd(()=>new tg(F.AFrameworkApplication.K)).singleInstance();
this.W.register(Wf,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Zd(()=>new Wf(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.lq)).singleInstance();this.W.register(Cf,"Common.App.SaveToCloudStorage.UploadToCloudManager").Zd(()=>new Cf(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new dk.a).create(),()=>new Gl,F.AFrameworkApplication.ta,
F.AFrameworkApplication.ta.lq)).singleInstance();this.W.register(tl,"Common.App.SaveToCloudStorage.SaveToCloudManager").Zd(()=>new tl(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),zd.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.bla,()=>new Gl)).singleInstance()}static main(){ca.a.instance.Pc(new Be)}}Object(e.a)(Be,"PackageManager",null,[1,2]);class ai extends Kd.StandardDialog{constructor(){super();this.Gd=
0;this.We(1,CommonUIStrings.l_DialogClose)}XS(Q,xa){this.PBh(Q,xa,tj.a.PDn)}PBh(Q,xa,jb){ia.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",jb);this.my(jb,Q,xa,null)}o5e(Q,xa){ia.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.my(tj.a.RDn,Q,xa,null,!0)}}Object(e.a)(ai,"ErrorDialog",Kd.StandardDialog,[1031]);class Zd{static get vg(){return uc.a.Rx(Zd.tl,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}Zd.tl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(Zd,"FileNameDialogHtml",null,[]);var Hf=c(67);class Mi extends sm{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){super(Q,xa,jb,Nb,Bc,gd,Bd);this.R7a=this.oGe=this.jP=null;this.Jpk=CommonUIStrings.l_SaveToAnotherFolder;this.vg=Zd.vg;this.lg="FileNameDialog-SaveToSharePoint";this.ivc=be;this.OQj=Bd}MAa(Q){const xa=Pb.a.wI(F.AFrameworkApplication.Gt.Hz),jb=F.AFrameworkApplication.breadcrumbFolderName,Nb=F.AFrameworkApplication.breadcrumbBrandName,Bc={["txtFileName"]:Q||xa};let gd=CommonUIStrings.L_SaveAs;
2===F.AFrameworkApplication.ta.Rb.ko&&(gd=CommonUIStrings.L_SaveACopy);this.Vh(gd,Object(a.a)(this,this.xCd,"fileNameDialogHandler"),Bc);this.xBh(Q,xa);this.g4e.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");F.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.jP=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.oGe=pb.a.Vrd(Q,this.jP,"anotherFolderDescribedBy",""),
this.jP.className="WACButton WACDialogButtonNormal",Q=!1,jb&&jb.length?(this.O8g(this.jP,this.oGe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Nb,jb)),Q=this.I2j(Nb,jb)):this.O8g(this.jP,this.oGe,CommonUIStrings.l_CurrentOnlineFolder),this.x4j(this.jP),this.K2j(this.jP),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.jP,"SaveToAnotherLocationTwo"),ia.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.jP,"SaveToAnotherLocationOne"),H.a.addHandler(this.jP,A.a.click,Object(a.a)(this,this.RIf,"onSaveToAnotherLocationClick")),H.a.addHandler(this.jP,A.a.ni,Object(a.a)(this,this.mBi,"onSaveToAnotherLocationKeyDown")))}I2j(Q,xa){let jb;jb=!1;const Nb=document.getElementById("currentLocation");Nb.innerText="";const Bc=this.TVh(Nb,Q),gd=this.TVh(Nb,xa);let be=255,Bd=255;255<Bc+gd&&(be=Math.max(238,408-Bc),Bd=Math.max(170,408-gd),jb=!0);this.E6j(Nb,Q,Bd,xa,be);return jb}TVh(Q,
xa){const jb=document.createElement("div");jb.innerText=xa;jb.style.visibility="hidden";Q.appendChild(jb);xa=jb.clientWidth;Q.removeChild(jb);return xa}E6j(Q,xa,jb,Nb,Bc){xa&&(this.N8g(Q,xa,jb),this.v6j(Q));Nb&&this.N8g(Q,Nb,Bc)}N8g(Q,xa,jb){const Nb=document.createElement("div");Nb.innerText=xa;Nb.title=xa;Nb.className="SaveToAnotherFolderBreadcrumb";Nb.style.maxWidth=jb.toString()+"px";Q.appendChild(Nb)}v6j(Q){const xa=document.createElement("span");xa.id="FolderSeparator";const jb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");jb.setAttribute("class","SeparatorCaret");const Nb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Nb.setAttribute("points","1 4 1 11 5 7.5");jb.appendChild(Nb);xa.appendChild(jb);Q.appendChild(xa)}O8g(Q,xa,jb){jb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,jb);xa&&(xa.innerText=jb);Q.tabIndex=0;Q.setAttribute(pb.a.Bh,pb.a.J1)}K2j(Q){const xa=document.createElement("span");xa.id="anotherFolderText";xa.innerText=this.Jpk;xa.className="AnotherFolderTextSpan";
Q.appendChild(xa)}x4j(Q){const xa=document.createElement("span");xa.className="cui-img-cont-float cui-img-16by16 ";this.R7a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.R7a.setAttribute("class","FolderIconSVG");const jb=document.createElementNS("http://www.w3.org/2000/svg","path");jb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.R7a.appendChild(jb);xa.appendChild(this.R7a);Q.appendChild(xa)}mBi(Q){!Q||
Q.keyCode!==Hf.a.hs&&Q.keyCode!==Hf.a.Vde||this.RIf(Q)}RIf(){if(this.M4){const Q=Pb.a.MLa(F.AFrameworkApplication.fileName);let xa=this.M4.value;this.hide();xa&&""!==xa&&""!==Q||1===this.ta.state?(""!==Q&&(xa+=Q),this.tIh(xa)?this.vG.create().XS(1,xa,!1):this.ivc.start(xa,this.OQj)):this.vG.create().XS(2,xa,!1)}}Cuk(Q){this.jP&&this.R7a&&(Q?(this.jP.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.jP,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.R7a,"DisabledFolderIconSVG")):(this.jP.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.jP,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.R7a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.jP,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.R7a,"DisabledFolderIconSVG"))))}Dkf(){super.Dkf();this.Cuk(!!this.M4&&""!==this.M4.value)}dispose(){this.jP&&(H.a.removeHandler(this.jP,A.a.click,Object(a.a)(this,this.RIf,"onSaveToAnotherLocationClick")),H.a.removeHandler(this.jP,A.a.ni,Object(a.a)(this,this.mBi,
"onSaveToAnotherLocationKeyDown")),this.jP=null);super.dispose()}}Object(e.a)(Mi,"FileNameDialog",sm,[1139]);var de=c(545),Fj=c(374),kf=c(1497),cf=c(1603);class kc{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(kc,"SaveAsDialogInput",null,[]);class zh{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(zh,"SaveLocation",null,[]);var Bf=c(160);class si{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe){this.Vxe=
null;this.SM="";this.ivc=Q;this.vG=xa;this.Mm=Xe;this.nVa=jb;this.Ti=Bc;this.XK=Nb;this.Mub=be;this.eVb=Bd;gd&&(this.Vxe=new tb.a(()=>new kf.a(gd.value,null)))}iql(){const Q=new de.a(Fj.a.Sj());Q.Z("type","currentHost");return Object.assign(new zh,{folderName:this.XK.breadcrumbFolderName,friendlyPath:this.XK.breadcrumbBrandName,properties:Q})}Cmm(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}OKl(){if(!this.Vxe||
!this.Mub)return null;var Q=this.Vxe.value.fk("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.Rti)return null;Q=Q.Rti;const xa=new ba.a;let jb=0,Nb=0;for(var Bc=0;Bc<Q.length;Bc++){var gd=Q[Bc];if(!this.Cmm(gd))continue;jb++;if(!gd.sharepoint_info)continue;const be=gd.url,Bd=gd.sharepoint_info.site_url,Xe=gd.title;gd=cf.b(gd,F.AFrameworkApplication.isRtl);if(!(be&&Bd&&Xe&&gd))continue;Nb++;const eg=new de.a(Fj.a.Sj());eg.Z("type","SharePoint");eg.Z("siteUrl",Bd);eg.Z("folderUrl",be);Nb++;xa.add(Object.assign(new zh,
{folderName:Xe,friendlyPath:gd,properties:eg}))}Bc=new Map;Bc.set("NumPlaces",Q.length.toString());Bc.set("NumSharepointPlaces",jb.toString());Bc.set("placesWithMetadata",Nb.toString());La.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Bc);0<jb&&(Nb?.5>1*Nb/jb&&La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):La.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return xa}prl(){const Q=
new ba.a;Q.add(this.iql());const xa=this.OKl();xa&&Q.addRange(xa);return Object.assign(new kc,{enableMoreLocations:!F.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.SM,extension:Pb.a.MLa(this.XK.Hz),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}Ndf(){const Q=Object(a.a)(this,this.prl,"getDialogInput"),xa={};xa.inputPropsCallback=Q;return xa}MAa(Q){this.SM=Q;this.SM||(this.SM=String.format(CommonUIStrings.l_SaveACopy_Filename,Pb.a.wI(this.XK.Hz)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.Ndf()};let xa=CommonUIStrings.L_SaveAs;2===this.Ti.Rb.ko&&(xa=CommonUIStrings.L_SaveACopy);const jb=new uc.a(!1,!1,!0);jb.Gd=1;jb.lg="SaveAsDialog";jb.We(1,CommonUIStrings.l_SaveButtonLabel);jb.Vh(xa,Object(a.a)(this,this.LDn,"saveAsDialogHandler"),Q)}p_n(Q,xa){Q&&""!==Q&&""!==xa||1===this.Ti.state?this.Bmm()?this.tvm(Q,xa):(""!==xa&&(Q+=xa),this.ivc.start(Q,this.Mm)):(ia.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.vG.create().XS(2,
Q,!1))}tvm(Q,xa){La.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const jb=this.eVb.o0e(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.eVb.wef(jb).then(Nb=>{if(Nb&&0<Nb.length){const Bc=Nb[0][nf.a.Z6m];Nb=Nb[0][nf.a.$6m];if(""!==Bc&&""!==Nb)this.Mub.REa(Nb,Q+xa,Bc,this.Mm),La.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.vG.create().XS(0,Q,!1);const gd=nd.a.jF();gd&&(gd.set("SiteUrlAvailable",
""===Bc?"false":"true"),gd.set("FolderUrlAvailable",""===Nb?"false":"true"));La.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Bf.a,{extendedProperties:gd}))}}else this.vG.create().XS(0,Q,!1),La.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Nb=>{"Canceled"===Nb?((Nb=nd.a.jF())&&Nb.set("IsCanceled","true"),La.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Bf.a,{extendedProperties:Nb}))):
La.Health.instance.recordKpiFailure("SaveACopySFP",Nb,!1,!1,null)})}Bmm(){return this.eVb?this.eVb.Xtf():(ia.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}LDn(Q,xa){if(xa&&1===Q){Q=xa.fileName;var jb=Pb.a.MLa(this.XK.Hz);xa.moreLocationsSelected&&this.p_n(Q,jb);if(xa.locationCallback){var Nb=xa.locationCallback();Nb?Nb.properties&&"currentHost"===Nb.properties.J("type")?this.nVa.REa(Q+jb,!1,this.Mm):Nb.properties&&"SharePoint"===Nb.properties.J("type")?(xa=Nb.properties.J("siteUrl"),
Nb=Nb.properties.J("folderUrl"),this.Mub.REa(Nb,Q+jb,xa,this.Mm)):ia.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ia.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ia.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(si,"ReactSaveAsDialog",null,[1139]);class ag{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd=null,Xe=null,eg=null){this.ga=xa;this.Oa=Q;this.lpa=Nb;this.nVa=gd;this.vG=Bc;this.Ti=jb;this.L_g=be;this.zMj=Bd;this.Mub=Xe;this.eVb=
eg}create(Q){return this.Ti&&this.Ti.Rb.NA?new si(this.L_g,this.vG,this.nVa,F.AFrameworkApplication.Gt,this.Ti,this.zMj,this.Mub,this.eVb,Q):new Mi(this.Oa,this.ga,this.Ti,this.lpa,this.vG,this.nVa,this.L_g,Q)}}Object(e.a)(ag,"FileNameDialogFactory",null,[1117]);class Xg{constructor(Q,xa,jb,Nb){this.$v=this.Wsc=null;this.Gpb=Q;this.Ti=jb;this.aSj=Nb;this.JSa=new tb.a(()=>new kf.a(xa.value,Object(a.a)(this,this.aBb,"getMoreInfoEventReceived")))}get ACi(){this.Wsc||(this.JSa.value.fk("Save As",!0),
this.$v&&this.$v.dba&&this.$v.dba.length&&(this.Wsc=this.iDl(this.$v.dba)));return this.Wsc}start(Q){if(!this.ACi)if(F.AFrameworkApplication.breadcrumbFolderUrl&&F.AFrameworkApplication.breadcrumbFolderUrl.length)this.Wsc=F.AFrameworkApplication.breadcrumbFolderUrl;else return ia.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.$v),!1;const xa=this.aSj();xa.C_n();const jb=
xa.NFl();if(!jb)return ia.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Gpb.start((Nb,Bc)=>{xa.hide();Q(Nb,Bc)},()=>{this.FGb(xa)},jb,this.Wsc);return!0}FGb(Q){Q.hide();ia.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}iDl(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const xa=Q.indexOf("/documents/");return-1!==xa?Q.substring(0,xa+1)+"_layouts/15/onedrive.aspx":""}aBb(Q){this.$v||3!==Q.state||(this.$v=Q)}}Object(e.a)(Xg,"OneDriveFilePickerHelper",
null,[1116]);class Mf extends uc.a{constructor(){super()}C_n(){this.Nob="FilePickerDialog";this.vg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.lg="PickerDialog-MsoSp";this.showDialog("",null)}NFl(){return document.getElementById("FilePickerDiv")}vO(){}Cga(){}}Object(e.a)(Mf,"PickerDialog",uc.a,[1032]);class li{constructor(Q,xa,jb,Nb,Bc,gd,be){this.Oa=Q;this.Npe=jb;this.ga=xa;this.ivc=Nb;this.Gpb=Bc;this.Vsc=gd;this.Mzj=be}Vb(){const Q=this.Gpb.x3b();Q?Oa.a.maa||this.Oa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.gb(Ra.a.xdc,$b.a.frame,Object(a.a)(this,this.lWi,"saveToSharePointActionDispatcher"),64):(Q.x0a.continueWith(xa=>{xa.Ki&&this.Gpb.IHf(xa)}),this.Ftd()):ia.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Ftd(){Zb.a.rXc(Object(a.a)(this,this.lWi,"saveToSharePointActionDispatcher"));Zb.a.sFc([new Mk.a(Ra.a.xdc,$b.a.frame,0)],this.Gpb.x3b())}get h8b(){return this.Oa.$("SaveToAnotherFolderBrsIsEnabled")}get rlh(){return this.Oa.$("UserCanWriteRelative")}lWi(Q,
xa,jb,Nb,Bc){return xa.contextId!==$b.a.frame||Q!==Ra.a.xdc?2:this.h8b&&(this.Vsc.ACi||this.rlh)?1===jb?Af.SessionStatusManager.instance.Tj||F.AFrameworkApplication.Ama?8:this.Mzj()?32:8:2===jb?(ia.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Bc&&Bc.SaveEntryPoint&&"VersionHistory"===Bc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.rlh?(ia.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Npe.create(Bc).MAa(null)):(ia.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.ivc.start(null,Bc)),32):8:8}}Object(e.a)(li,"SaveToSharePointActor",null,[]);class Kh{constructor(Q,xa,jb,Nb){this.Mm=this.VSg=null;this.Mub=Q;this.vG=xa;this.Vsc=jb;this.Ti=Nb}start(Q,xa){ia.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.VSg=Q;this.Mm=xa;this.Vsc.start((jb,Nb)=>{this.iOf(jb,Nb)})||this.s1f()}iOf(Q,xa){if(Q)this.onSuccess(xa);else this.onFailure(xa)}s1f(){1!==this.Ti.state&&this.vG().o5e(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){ia.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const xa=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let jb=null;if(xa&&(jb=Q?this.fLl(Q):this.eLl(xa))){this.Mub.REa(xa,this.VSg,jb,this.Mm);return}ia.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!xa,!jb)}ia.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.s1f()}eLl(Q){Q.endsWith("/")||(Q+="/");let xa=0;for(let jb=0;jb<Q.length;jb++)if("/"===Q.charAt(jb)&&5===++xa)return Q.substr(0,jb);return null}fLl(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const xa=Q.lastIndexOf("/");return-1!==xa?Q.substring(0,xa):null}onFailure(Q){ia.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?ia.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
Q.error.errorCode,Q.error.message):ia.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.s1f()}}Object(e.a)(Kh,"SaveToSharePointManager",null,[1720]);class Gj{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){this.w5=Q;this.SM=xa;this.LQb=Nb;this.hEe=gd;this.mHa=jb;this.jXj=Bc;this.LSa=be;this.Mm=Bd}execute(Q,xa){if(!F.AFrameworkApplication.Tk&&F.AFrameworkApplication.af){var jb=this.w5+this.LSa;jb=Kb.a.Ip(jb,"fu",Pb.a.Jj(this.mHa));jb=Kb.a.Ip(jb,"su",Pb.a.Jj(this.jXj));jb=Kb.a.Ip(jb,"fn",
Pb.a.Jj(this.SM));jb=Kb.a.Ip(jb,"n",Pb.a.Jj((new Date).getTime().toString()));this.Mm&&this.Mm.FileDownloadUrl&&(jb=Kb.a.Ip(jb,"furl",Pb.a.Jj(this.Mm.FileDownloadUrl)));jb=jb+"&"+this.hEe;this.LQb&&this.LQb.length?jb=Kb.a.Ip(jb,"fnn",Pb.a.Jj(this.LQb)):ia.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ia.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");F.AFrameworkApplication.af.Mj(jb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,Q,xa,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(Gj,"SharePointSaveAsCaller",null,[1763]);class Hi{constructor(Q){this.Zub=Q.appSettings.SaveAsToHostWebServiceBase;this.SM=Q.appSettings.FileName;this.LSa=Q.lb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,xa,jb,Nb){return new Gj(this.Zub,this.SM,Q,xa,jb,F.AFrameworkApplication.ym,this.LSa,Nb)}}Object(e.a)(Hi,"SharePointUploadCallerFactory",null,[1719]);var ch=c(1339);class hm{constructor(Q,xa,jb,Nb,Bc){this.Nk=this.Dkc=
null;this.Whe=!1;this.hGe=this.mHa=null;this.dMe=xa;this.bUa=jb;this.vG=Nb;this.Ti=Bc;this.ga=Q}REa(Q,xa,jb,Nb){this.Whe=!1;ia.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.v3a();this.mHa=Q;Nb&&Nb.SaveEntryPoint&&(this.hGe=Nb.SaveEntryPoint);this.Dkc=this.dMe.create(Q,xa,jb,Nb);Nb&&"true"===Nb.SkipSaveToHost?this.wea():this.ffl()}ffl(){const Q=()=>{ia.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.wea()};32!==this.ga.Xb(Ra.a.HJb,2,[()=>{ia.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.wea()},Q])&&Q()}wea(){ia.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Dkc.execute(Object(a.a)(this,this.mZm,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.lZm,"onSaveToSharePointUploadFailed"))}mZm(Q){if(Q&&Q.data&&Q.data.Ie){var xa;if(({Iv:xa}=Ma.d(Q.data.Ie)).returnValue)if(xa.StatusCode!==ul.a.yD&&xa.StatusCode!==
ul.a.kDc)ia.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,xa.StatusCode),xa.StatusCode!==ul.a.wUf&&this.rCh(Q.data.status)||(this.pPa(xa.StatusCode.toString()),this.zZn(xa.StatusCode));else{ia.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.rUf();try{xa.NewDocumentUrl?this.NIb(xa.NewDocumentUrl):this.OIb()}catch(jb){ia.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
jb.toString())}}else ia.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.b3c(Q.data.Ie)}),this.Vzd()||(this.pPa("Failed to deserialize response"),this.R0c())}else ia.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Vzd()||(this.pPa("Unknown"),this.R0c())}lZm(Q){Q&&Q.data?this.rCh(Q.data.status)||(ia.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.pPa(ch.a[Q.data.status]),this.R0c()):(ia.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.Vzd()||(this.pPa("Unknown"),this.R0c()))}Vzd(){if(!this.Whe)return ia.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.Whe=!0,this.wea(),!0;ia.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}rCh(Q){ia.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.Vzd()}OIb(){ia.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");sa.a.Gm(this.mHa,sa.a.fpa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}NIb(Q){let xa=
!1,jb=!1;F.AFrameworkApplication.K&&(xa=F.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),jb=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ia.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,xa);if(xa&&jb){ia.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Nb={};Nb[nf.a.gcc]="1";Nb[nf.a.documentUrl]=Q;Nb[nf.a.reason]=Mg.a.qWf;F.AFrameworkApplication.gQ().execute(Bc=>
{Bc.sendMessage(pf.a.Qyb,Nb)})}else sa.a.Gm(Q,sa.a.fpa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}v3a(){this.Ti&&1===this.Ti.state||(this.Nk=this.bUa(),this.Nk.message=CommonUIStrings.l_CommentProgressTooltip,this.Nk.Gd=5,this.Nk.It=!1,this.Nk.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Ska(){this.Nk&&(this.Nk.close(),this.Nk=null)}R0c(){this.Bp(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}q_n(){this.Bp(CommonUIStrings.l_NoSavePermissionDialogTitle,
CommonUIStrings.l_NoSavePermissionDialogMessage)}FZn(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Bp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,tj.a.MDn)}Bp(Q,xa,jb=tj.a.QDn){ia.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,xa);this.Ska();1!==this.Ti.state&&this.vG().PBh(Q,xa,jb)}zZn(Q){ia.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case ul.a.wce:this.q_n();break;case ul.a.wUf:this.FZn();break;
default:this.R0c()}}rUf(){"VersionHistory"===this.hGe&&this.ga.processAction(Ra.a.DYc,2)}pPa(Q){"VersionHistory"===this.hGe&&this.ga.Xb(Ra.a.E4d,2,{["FailureReason"]:Q})}}Object(e.a)(hm,"UploadToSharePointManager",null,[1718]);var Wk=c(742),Pl=c(124);class oh{constructor(){this.Uld=this.Sze=this.Jze=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}zc(Q){this.W=Q;this.Jze=Wk.a.Lq(Q.$a("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.Sze=Wk.a.Lq(Q.$a("Common.IEventEmitter<Common.IMruResult>"));
this.Uld=Wk.a.Lq(Q.$a("Common.App.SharedFilePicker.ISharedFilePicker"));Pl.Task.WAA.call(null,this.Jze,this.Sze,this.Uld).continueWith(()=>{this.smn()})}smn(){this.W.register(Hi,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Zd(()=>new Hi(F.AFrameworkApplication.K)).singleInstance();this.W.register(hm,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Zd(()=>
new hm(F.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new dk.a).create(),()=>new ai,F.AFrameworkApplication.ta)).singleInstance();this.W.register(Kh,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Zd(()=>new Kh(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new ai,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),F.AFrameworkApplication.ta)).singleInstance();
this.W.register(Xg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Zd(()=>new Xg(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new tb.a(()=>this.Jze.result),F.AFrameworkApplication.ta,()=>new Mf)).singleInstance();this.W.register(ag,"Common.App.SaveToSharePoint.FileNameDialogFactory").Zd(()=>new ag(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.Rb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new tb.a(()=>this.Sze.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Uld?this.Uld.result:null)).singleInstance();this.W.register(li,"Common.App.SaveToSharePoint.SaveToSharePointActor").Zd(()=>new li(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>F.AFrameworkApplication.ta.Zsk)).singleInstance();F.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Vb()}static main(){ca.a.instance.Pc(new oh)}}Object(e.a)(oh,"PackageManager",null,[1,2]);
class Pi{}Object(e.a)(Pi,"StringDifference",null,[1706]);class Qd{constructor(Q,xa){this.charCode=Q;this.description=xa}}Object(e.a)(Qd,"UBTableEntry",null,[]);class Ql{}new Qd(8,"C0 Controls 1");new Qd(9,"Horizontal tab (HT)");new Qd(10,"Line feed (LF)");new Qd(12,"C0 Controls 2");new Qd(13,"Carriage return (CR)");new Qd(31,"C0 Controls 3");new Qd(32,"Space");new Qd(47,"ASCII Punctuation and Symbols 1");new Qd(57,"ASCII Digits");new Qd(64,"ASCII Punctuation and Symbols 2");new Qd(90,"Uppercase Latin Alphabet");
new Qd(96,"ASCII Punctuation and Symbols 3");new Qd(122,"Lowercase Latin Alphabet");new Qd(127,"U+0000..U+007F Basic Latin");new Qd(159,"C1 Controls");new Qd(160,"NB Space");new Qd(191,"Latin-1 Punctuation and Symbols");new Qd(255,"U+0080..U+00FF Latin-1 Supplement");new Qd(383,"U+0100..U+017F Latin Extended-A");new Qd(591,"U+0180..U+024F Latin Extended-B");new Qd(687,"U+0250..U+02AF IPA Extensions");new Qd(767,"U+02B0..U+02FF Spacing Modifier Letters");new Qd(879,"U+0300..U+036F Combining Diacritical Marks");
new Qd(1023,"U+0370..U+03FF Greek and Coptic");new Qd(1279,"U+0400..U+04FF Cyrillic");new Qd(1327,"U+0500..U+052F Cyrillic Supplement");new Qd(1423,"U+0530..U+058F Armenian");new Qd(1535,"U+0590..U+05FF Hebrew");new Qd(1791,"U+0600..U+06FF Arabic");new Qd(1871,"U+0700..U+074F Syriac");new Qd(1919,"U+0750..U+077F Arabic Supplement");new Qd(1983,"U+0780..U+07BF Thaana");new Qd(2047,"U+07C0..U+07FF NKo");new Qd(2111,"U+0800..U+083F Samaritan");new Qd(2143,"U+0840..U+085F Mandaic");new Qd(2303,"U+08A0..U+08FF Arabic Extended-A");
new Qd(2431,"U+0900..U+097F Devanagari");new Qd(2559,"U+0980..U+09FF Bengali");new Qd(2687,"U+0A00..U+0A7F Gurmukhi");new Qd(2815,"U+0A80..U+0AFF Gujarati");new Qd(2943,"U+0B00..U+0B7F Oriya");new Qd(3071,"U+0B80..U+0BFF Tamil");new Qd(3199,"U+0C00..U+0C7F Telugu");new Qd(3327,"U+0C80..U+0CFF Kannada");new Qd(3455,"U+0D00..U+0D7F Malayalam");new Qd(3583,"U+0D80..U+0DFF Sinhala");new Qd(3711,"U+0E00..U+0E7F Thai");new Qd(3839,"U+0E80..U+0EFF Lao");new Qd(4095,"U+0F00..U+0FFF Tibetan");new Qd(4255,
"U+1000..U+109F Myanmar");new Qd(4351,"U+10A0..U+10FF Georgian");new Qd(4607,"U+1100..U+11FF Hangul Jamo");new Qd(4991,"U+1200..U+137F Ethiopic");new Qd(5023,"U+1380..U+139F Ethiopic Supplement");new Qd(5119,"U+13A0..U+13FF Cherokee");new Qd(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new Qd(5791,"U+1680..U+169F Ogham");new Qd(5887,"U+16A0..U+16FF Runic");new Qd(5919,"U+1700..U+171F Tagalog");new Qd(5951,"U+1720..U+173F Hanunoo");new Qd(5983,"U+1740..U+175F Buhid");new Qd(6015,"U+1760..U+177F Tagbanwa");
new Qd(6143,"U+1780..U+17FF Khmer");new Qd(6319,"U+1800..U+18AF Mongolian");new Qd(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new Qd(6479,"U+1900..U+194F Limbu");new Qd(6527,"U+1950..U+197F Tai Le");new Qd(6623,"U+1980..U+19DF New Tai Lue");new Qd(6655,"U+19E0..U+19FF Khmer Symbols");new Qd(6687,"U+1A00..U+1A1F Buginese");new Qd(6831,"U+1A20..U+1AAF Tai Tham");new Qd(7039,"U+1B00..U+1B7F Balinese");new Qd(7103,"U+1B80..U+1BBF Sundanese");new Qd(7167,"U+1BC0..U+1BFF Batak");
new Qd(7247,"U+1C00..U+1C4F Lepcha");new Qd(7295,"U+1C50..U+1C7F Ol Chiki");new Qd(7375,"U+1CC0..U+1CCF Sundanese Supplement");new Qd(7423,"U+1CD0..U+1CFF Vedic Extensions");new Qd(7551,"U+1D00..U+1D7F Phonetic Extensions");new Qd(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new Qd(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new Qd(7935,"U+1E00..U+1EFF Latin Extended Additional");new Qd(8191,"U+1F00..U+1FFF Greek Extended");new Qd(8303,"U+2000..U+206F General Punctuation");
new Qd(8351,"U+2070..U+209F Superscripts and Subscripts");new Qd(8399,"U+20A0..U+20CF Currency Symbols");new Qd(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new Qd(8527,"U+2100..U+214F Letterlike Symbols");new Qd(8591,"U+2150..U+218F Number Forms");new Qd(8703,"U+2190..U+21FF Arrows");new Qd(8959,"U+2200..U+22FF Mathematical Operators");new Qd(9215,"U+2300..U+23FF Miscellaneous Technical");new Qd(9279,"U+2400..U+243F Control Pictures");new Qd(9311,"U+2440..U+245F Optical Character Recognition");
new Qd(9471,"U+2460..U+24FF Enclosed Alphanumerics");new Qd(9599,"U+2500..U+257F Box Drawing");new Qd(9631,"U+2580..U+259F Block Elements");new Qd(9727,"U+25A0..U+25FF Geometric Shapes");new Qd(9983,"U+2600..U+26FF Miscellaneous Symbols");new Qd(10175,"U+2700..U+27BF Dingbats");new Qd(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new Qd(10239,"U+27F0..U+27FF Supplemental Arrows-A");new Qd(10495,"U+2800..U+28FF Braille Patterns");new Qd(10623,"U+2900..U+297F Supplemental Arrows-B");
new Qd(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new Qd(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new Qd(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new Qd(11359,"U+2C00..U+2C5F Glagolitic");new Qd(11391,"U+2C60..U+2C7F Latin Extended-C");new Qd(11519,"U+2C80..U+2CFF Coptic");new Qd(11567,"U+2D00..U+2D2F Georgian Supplement");new Qd(11647,"U+2D30..U+2D7F Tifinagh");new Qd(11743,"U+2D80..U+2DDF Ethiopic Extended");new Qd(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new Qd(11903,"U+2E00..U+2E7F Supplemental Punctuation");new Qd(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new Qd(12255,"U+2F00..U+2FDF Kangxi Radicals");new Qd(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new Qd(12351,"U+3000..U+303F CJK Symbols and Punctuation");new Qd(12447,"U+3040..U+309F Hiragana");new Qd(12543,"U+30A0..U+30FF Katakana");new Qd(12591,"U+3100..U+312F Bopomofo");new Qd(12687,"U+3130..U+318F Hangul Compatibility Jamo");new Qd(12703,"U+3190..U+319F Kanbun");new Qd(12735,
"U+31A0..U+31BF Bopomofo Extended");new Qd(12783,"U+31C0..U+31EF CJK Strokes");new Qd(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new Qd(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new Qd(13311,"U+3300..U+33FF CJK Compatibility");new Qd(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new Qd(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new Qd(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new Qd(42127,"U+A000..U+A48F Yi Syllables");new Qd(42191,"U+A490..U+A4CF Yi Radicals");
new Qd(42239,"U+A4D0..U+A4FF Lisu");new Qd(42559,"U+A500..U+A63F Vai");new Qd(42655,"U+A640..U+A69F Cyrillic Extended-B");new Qd(42751,"U+A6A0..U+A6FF Bamum");new Qd(42783,"U+A700..U+A71F Modifier Tone Letters");new Qd(43007,"U+A720..U+A7FF Latin Extended-D");new Qd(43055,"U+A800..U+A82F Syloti Nagri");new Qd(43071,"U+A830..U+A83F Common Indic Number Forms");new Qd(43135,"U+A840..U+A87F Phags-pa");new Qd(43231,"U+A880..U+A8DF Saurashtra");new Qd(43263,"U+A8E0..U+A8FF Devanagari Extended");new Qd(43311,
"U+A900..U+A92F Kayah Li");new Qd(43359,"U+A930..U+A95F Rejang");new Qd(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new Qd(43487,"U+A980..U+A9DF Javanese");new Qd(43615,"U+AA00..U+AA5F Cham");new Qd(43647,"U+AA60..U+AA7F Myanmar Extended-A");new Qd(43743,"U+AA80..U+AADF Tai Viet");new Qd(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new Qd(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new Qd(44031,"U+ABC0..U+ABFF Meetei Mayek");new Qd(55215,"U+AC00..U+D7AF Hangul Syllables");new Qd(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new Qd(56191,"U+D800..U+DB7F High Surrogates");new Qd(56319,"U+DB80..U+DBFF High Private Use Surrogates");new Qd(57343,"U+DC00..U+DFFF Low Surrogates");new Qd(63743,"U+E000..U+F8FF Private Use Area");new Qd(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new Qd(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new Qd(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new Qd(65039,"U+FE00..U+FE0F Variation Selectors");new Qd(65055,"U+FE10..U+FE1F Vertical Forms");new Qd(65071,"U+FE20..U+FE2F Combining Half Marks");
new Qd(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new Qd(65135,"U+FE50..U+FE6F Small Form Variants");new Qd(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new Qd(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new Qd(65535,"U+FFF0..U+FFFF Specials");new Qd(65663,"U+10000..U+1007F Linear B Syllabary");new Qd(65791,"U+10080..U+100FF Linear B Ideograms");new Qd(65855,"U+10100..U+1013F Aegean Numbers");new Qd(65935,"U+10140..U+1018F Ancient Greek Numbers");new Qd(65999,"U+10190..U+101CF Ancient Symbols");
new Qd(66047,"U+101D0..U+101FF Phaistos Disc");new Qd(66207,"U+10280..U+1029F Lycian");new Qd(66271,"U+102A0..U+102DF Carian");new Qd(66351,"U+10300..U+1032F Old Italic");new Qd(66383,"U+10330..U+1034F Gothic");new Qd(66463,"U+10380..U+1039F Ugaritic");new Qd(66527,"U+103A0..U+103DF Old Persian");new Qd(66639,"U+10400..U+1044F Deseret");new Qd(66687,"U+10450..U+1047F Shavian");new Qd(66735,"U+10480..U+104AF Osmanya");new Qd(67647,"U+10800..U+1083F Cypriot Syllabary");new Qd(67679,"U+10840..U+1085F Imperial Aramaic");
new Qd(67871,"U+10900..U+1091F Phoenician");new Qd(67903,"U+10920..U+1093F Lydian");new Qd(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new Qd(68095,"U+109A0..U+109FF Meoritic Cursive");new Qd(68191,"U+10A00..U+10A5F Kharoshthi");new Qd(68223,"U+10A60..U+10A7F Old South Arabian");new Qd(68415,"U+10B00..U+10B3F Avestan");new Qd(68447,"U+10B40..U+10B5F Inscriptional Parthian");new Qd(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new Qd(68687,"U+10C00..U+10C4F Old Turkic");new Qd(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new Qd(69759,"U+11000..U+1107F Brahmi");new Qd(69839,"U+11080..U+110CF Kaithi");new Qd(69887,"U+110D0..U+110FF Sora Sompeng");new Qd(69967,"U+11100..U+1114F Chakma");new Qd(70111,"U+11180..U+111DF Sharada");new Qd(71375,"U+11680..U+116CF Takri");new Qd(74751,"U+12000..U+123FF Cuneiform");new Qd(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new Qd(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new Qd(92735,"U+16800..U+16A3F Bamum Supplement");new Qd(94111,"U+16F00..U+16F9F Miao");new Qd(110847,
"U+1B000..U+1B0FF Kana Supplement");new Qd(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new Qd(119295,"U+1D100..U+1D1FF Musical Symbols");new Qd(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new Qd(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new Qd(119679,"U+1D360..U+1D37F Counting Rod Numerals");new Qd(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new Qd(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new Qd(127023,"U+1F000..U+1F02F Mahjong Tiles");
new Qd(127135,"U+1F030..U+1F09F Domino Tiles");new Qd(127231,"U+1F0A0..U+1F0FF Playing Cards");new Qd(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new Qd(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new Qd(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new Qd(128591,"U+1F600..U+1F64F Emoticons");new Qd(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new Qd(128895,"U+1F700..U+1F77F Alchemical Symbols");new Qd(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new Qd(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new Qd(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new Qd(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new Qd(917631,"U+E0000..U+E007F Tags");new Qd(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new Qd(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new Qd(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(Ql,"UnicodeBlocks",null,[1705]);class lg{constructor(){this.W=
null}zc(Q){this.W=Q;this.W.register(Pi,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Ql,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){ca.a.instance.Pc(new lg)}}
Object(e.a)(lg,"SensitiveLoggingPackage",null,[1,2]);var Mj;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(Mj||(Mj={}));Object(e.b)("SharedFilePickerLandingLocation",Mj);class bi{constructor(Q){this.pCb=this.Cbc=null;this._initialized=!1;this.nmf=Q}K7e(Q){this._initialized||(Q.Av(pf.a.GLi),Q.fC(pf.a.GLi,Object(a.a)(this,this.qYm,"onReceivedPickerResponse")),this._initialized=!0)}wef(Q){return this.pCb=new Promise((xa,
jb)=>{const Nb={};Nb[nf.a.Y6m]=Q;this.Cbc=(Bc,gd)=>{""===gd?(ia.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),xa(Bc)):("Canceled"===gd?ia.ULS.sendTraceTag(572548164,306,50,gd):ia.ULS.sendTraceTag(556901065,306,10,gd),jb(gd))};this.nmf.execute(Bc=>{this.K7e(Bc);Bc.sendMessage(pf.a.C1m,Nb)})})}qYm(Q){this.Cbc(Q.Values[nf.a.GGn],void 0===Q.Values[nf.a.WLf]||null===Q.Values[nf.a.WLf]?"":Q.Values[nf.a.WLf])}Xtf(){return F.AFrameworkApplication.K.$("UiHostCommonFilePicker")}o0e(Q,
xa,jb,Nb,Bc,gd,be,Bd,Xe=null){const eg={};eg[nf.a.fGn]=Q;eg[nf.a.titleText]=xa;eg[nf.a.Gbk]=jb;eg[nf.a.Hbk]=Nb;eg[nf.a.Jbk]=Bc;eg[nf.a.uZk]=!0;eg[nf.a.Q9k]=gd;eg[nf.a.b7m]=be;eg[nf.a.a7m]=Mj[Bd];hg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(eg[nf.a.c7m]="Dark");Xe&&(null!=Xe.JXb&&(eg[nf.a.JXb]=Xe.JXb),null!=Xe.w5b&&(eg[nf.a.w5b]=Xe.w5b));return eg}}Object(e.a)(bi,"SharedFilePickerManager",null,[1707]);class vl{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}zc(Q){this.W=
Q;Q.register(bi,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Zd(()=>new bi(Q.$a("Postmessage.IHostPostmessenger")))}init(){F.AFrameworkApplication.K.gq(()=>{this.TZa()})}TZa(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){ca.a.instance.Pc(new vl)}}Object(e.a)(vl,"SharedFilePickerPackage",null,[1,2]);class kd extends Sys.EventArgs{constructor(Q){super();this.DNm=Q}}Object(e.a)(kd,
"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class yf{}Object(e.a)(yf,"TypingSpeedMeterWindow",null,[]);class Yd{constructor(Q,xa,jb,Nb,Bc){this.XAf=null;this.wBg=this.eod=this.vKe=this.D$b=0;this.zLe=new h.a;this.wy=Q;this.Hh=xa;this.Hh.lrd(Object(a.a)(this,this.LGb,"onCpuMeterFrameAvailable"));this.g_j=jb;this.QNj=Bc;this.zZj=Nb}U9j(Q){this.zLe.addHandler("TypingSpeedWindowAvailable",Q)}Aun(Q){this.zLe.removeHandler("TypingSpeedWindowAvailable",Q)}LGb(Q,xa){this.XAf=xa.FSc}Ski(){var Q=this.wy();
Q-this.eod>this.zZj&&this.pTi();this.D$b||(this.vKe=Q);this.eod=Q;this.D$b++;this.D$b>=this.QNj&&(this.zLe.raiseEvent("TypingSpeedWindowAvailable",new kd(this.Ikh())),Q=new yf,Q.TS=this.Ikh(),this.XAf&&(Q.CP=this.XAf.CP),Q.EC=this.wBg,this.g_j.track(Q),this.pTi())}pTi(){this.eod=this.vKe=this.D$b=0}Ikh(){return 2>this.D$b?0:Math.round(6E4*(this.D$b-1)/(this.eod-this.vKe))}yno(Q){this.wBg=Q}dispose(){this.Hh.pTf(Object(a.a)(this,this.LGb,"onCpuMeterFrameAvailable"))}}Object(e.a)(Yd,"TypingSpeedMeter",
null,[1744]);class Rj{constructor(Q){this.Eub=null;this.Vo=new n.a;this.wy=Q}initialize(Q,xa,jb,Nb){this.Eub||(this.Eub=new Yd(this.wy,Q,xa,jb,Nb),this.Vo.Eg(this.Eub));return this.Eub}}Object(e.a)(Rj,"TypingSpeedMeterProvider",null,[1704]);class fk{constructor(){this.yLe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(F.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=oa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),xa=Wk.a.Lq(oa.a.instance.$a("Common.ICpuMeterProvider"));
xa.continueWith(()=>{const jb=xa.result.Vo.task;var Nb=new Ga.a(F.AFrameworkApplication.K.rc("TypingSpeedMeterWindowSamplingPercent",0)/100);Nb=new va.a(Object(a.a)(Nb,Nb.l3a,"shouldBeInSample"));const Bc=P.a.vF(12,1,Nb),gd=F.AFrameworkApplication.K.rc("TypingSpeedMeterWindowTimeoutMs",5E3),be=F.AFrameworkApplication.K.rc("TypingSpeedMeterMaxKeystrokesPerWindow",5);jb.CWR(()=>this.yLe=Q.initialize(jb.result,Bc,gd,be))})}}dispose(){this.yLe&&this.yLe.dispose()}zc(Q){Q.register(Rj,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Zd(()=>
new Rj(sa.a.kf))}static main(){ca.a.instance.Pc(new fk)}}Object(e.a)(fk,"TypingSpeedMeterPackage",null,[1,2]);class vg{create(Q){return new Ga.a(Q)}}Object(e.a)(vg,"RandomSamplerFactory",null,[954]);var Ie=c(9),Gm=c(1370);class ej{constructor(Q,xa,jb,Nb,Bc){Q.p9j(()=>{Nb.vYc()});Q.L9j((gd,be)=>{Nb.tYc(be.revisionId,be.g1a)});Q.QPe((gd,be)=>{Nb.o2l(be.MBn,be.g1a,be.lcj)});Q.o9j(()=>{Nb.hUf()});xa.O9j((gd,be)=>{Nb.vao(be.ORi,be.cbe,be.actualValue)});xa.F8j((gd,be)=>{Nb.uao(be.ORi,be.cbe,be.actualValue)});
Bc.krd(()=>{Nb.t3c()});jb.B5((gd,be)=>{6===be.type&&Nb.odc(be.BM)})}}Object(e.a)(ej,"EventForwarder",null,[]);class Ph{constructor(Q,xa,jb){this.dPj=Q;this.LM=jb;this.ZVb=xa}create(Q,xa){return new ej(this.dPj,this.ZVb,Q,xa,this.LM)}}Object(e.a)(Ph,"EventForwarderFactory",null,[]);var dg=c(438);class Ll{}Ll.rgo="TypingToOutboundReplicationStart";Ll.d2m="OutboundReplicationStartToOutboundReplicationEnd";Ll.lVi="RtcNotificationToInboundReplicationEnd";Ll.igj="TypingToInboundReplicationEnd";Object(e.a)(Ll,
"PerfTrackerPhases",null,[]);class vf{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe=null){this.Kye=this.FQg=!1;this.EAe=5;this.fSg=50;this.hze=20;this.Fxe=this.Sye=this.dxa=null;this.Llc=this.Clc=0;this.EIe=this.OJe=!1;this.Fnd=Array(7);this.hjc=null;this.jIg=!1;this.lke=null;this.vga={};this.Icd=Q;this.bSa=xa;this.ENj=jb;this.ZJg=Nb.create(Ll.lVi,Bc,gd,20,!1);this.Jod=Nb.create(Ll.igj,be,Bd,20,!0);if(this.Oa=F.AFrameworkApplication.K)this.FQg=this.Oa.$("LogSteppedInboundFrameIsEnabled"),this.Kye=this.Oa.$("LogTasksDetailsFromCPUMeterIsEnabled"),
this.hze=this.Oa.rc("InboundFrameMaxNumberOfLongRunningTasks",20),this.fSg=this.Oa.rc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.EAe=this.Oa.rc("InboundFrameNumberOfLastShortTasks",5);this.qob=Xe}get awk(){null==this.lke&&(this.lke=!!this.Oa&&this.Oa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.lke}initialize(Q){this.dxa=Q}hxn(Q,xa,jb=null){this.Tnh();ia.ULS.shipAssertTag(8229761,324,0<Q.length);let Nb=!1;for(const gd of Q){const be=gd.toString();if(be in
this.vga){var Bc=this.vga[be];if(!Bc.Udc){Bc.XYi(Q,xa,jb);if(this.Kye&&!Nb){const Bd=this.j8k(),Xe=this.Ohl(this.hjc);Nb=!0;this.Voi(gd.toString(),Bc,Bd,this.Fxe,this.Fnd,Xe)}else this.Voi(gd.toString(),Bc,null,null,this.Fnd,null);delete this.vga[be]}}else Bc=this.Icd.create(this.ZJg,this.Jod),Bc.XYi(Q,xa),this.vga[be]=Bc}this.EIe=!1}odc(Q){ia.ULS.shipAssertTag(8257930,304,Q.lki,"Expected data not sent on the wire");if(Q.lki){if(Q.e5d in this.vga){var xa=this.vga[Q.e5d];xa.s5d||(xa.odc(Q.revisionId,
Q.nDi,Q.$4i,Q.g1a),delete this.vga[Q.e5d])}else xa=this.Icd.create(this.ZJg,this.Jod),xa.odc(Q.revisionId,Q.nDi,Q.$4i,Q.g1a),this.vga[Q.e5d]=xa;this.Tnh()}}U3l(){this.OJe||(this.Sye=Array(this.hze),this.Fxe=Array(this.EAe),this.Llc=this.Clc=0,this.Fnd=[0,0,0,0,0,0,0,0],this.hjc=Array(3),this.hjc[1]=[0,0],this.hjc[2]=[0,0],this.OJe=!0)}TWn(Q){return!Q.TP&&Q.TN===J.a.IRi&&(Q=dg.a(this.vga))&&Q[0]?!0:!1}tTm(Q){this.OJe=!1;const xa=dg.a(this.vga);xa&&xa[0]&&(Q.TRT>=this.fSg&&this.Clc<this.hze?this.Sye[this.Clc++]=
Q:(this.Fxe[this.Llc]=Q,this.Llc=this.Llc<this.EAe-1?this.Llc+1:0),this.HDm(Q),this.$Dm(Q))}sTm(){this.Kye&&(this.U3l(),this.EIe=!0)}HDm(Q){this.Fnd[Q.TP]++}$Dm(Q){if(Q&&Q.UI){const xa=this.hjc[Q.UI];xa[0]+=1;xa[1]+=Q.TRT}}Ohl(Q){const xa={};Q&&(Q[1]&&(xa.Typing=Q[1]),Q[2]&&(xa.Clicking=Q[2]));return xa}j8k(){return this.Clc?this.Sye.slice(0,this.Clc-1):null}Tnh(){var Q=dg.a(this.vga);if(Q&&(this.jIg||this.LEm(Q),Q.length>this.ENj))for(const xa of Q){Q=this.vga[xa];const jb=Q.createdTime,Nb=this.bSa();
6E4<Nb-jb&&(v.b(8438528,304,50,"{0}",{["Not Received"]:Q.Udc?"RtcNotification":"ServerRevision",["Duration"]:Nb-jb}),Q.Udc||v.b(42075798,304,15,"{0}",{["RevisionId"]:xa,["Duration"]:Nb-jb}),delete this.vga[xa])}}LEm(Q){if(this.awk&&this.qob)for(const xa of Q)if(Q=this.vga[xa],Q.s5d&&!Q.Udc&&(Q=Q.createdTime,2E3<this.bSa()-Q)){let jb=null;Ie.App.xa&&Ie.App.xa.jb&&Ie.App.xa.jb.Xc&&(jb=Ie.App.xa.jb.Xc.contentReplicator);this.qob.execute(Nb=>{Nb.flush(jb,1)});this.jIg=!0}}Voi(Q,xa,jb,Nb,Bc,gd){this.FQg&&
(xa=xa.xhl())&&(xa.RevisionId=Q,xa.LRTWR=jb,xa.LSTWR=Nb,xa.TSD=Bc,xa.UIWR=gd,this.dxa&&this.dxa.track(xa))}}Object(e.a)(vf,"InboundMonitor",null,[1762]);class Ae{constructor(Q,xa,jb,Nb){this.kA=xa;this.Icd=jb;this.wZj=Nb}create(Q,xa,jb,Nb,Bc=null){return new vf(this.Icd,this.kA,50,this.wZj,Q,xa,jb,Nb,Bc)}}Object(e.a)(Ae,"InboundMonitorFactory",null,[1717]);var cb=c(299);class Eb{}Eb.Nde="UserCount";Eb.IBn="RevisionChainLength";Object(e.a)(Eb,"PerfTrackerPivotNames",null,[]);class ec{}Object(e.a)(ec,
"PerfTrackingContext",null,[]);const Cc=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Pc{}Object(e.a)(Pc,"SteppedInboundFrame",null,[]);class jd{constructor(Q,xa,jb,Nb,Bc){this.j9a=this.Kcd=null;this.UJg=500;this.Jcd=this.oqa=this.xqb=this.ARb=this.k6c=-1;this.bhg=null;this.F0g=this.v_g=!1;this.ZZg=null;this.JVg=this.pIa=0;this.QTb=Q;this.createdTime=xa();this.bmd=!1;this.QBe=0;this.asb=jb;this.OIj=Nb;this.Jod=Bc;F.AFrameworkApplication.K&&
(this.UJg=F.AFrameworkApplication.K.rc("InboundFrameSamplingMinimalTotalTimeMs",500))}get s5d(){return this.v_g}get Udc(){return this.F0g}get rUi(){return this.ZZg}get g1a(){return this.pIa}get c2m(){return this.JVg}get bzb(){return this.asb()}odc(Q,xa,jb,Nb){this.s5d||(this.bmd=jb,this.QBe=xa,this.k6c=E.a.qU(sa.a.kf(),2),this.bhg=(new Date).toISOString(),this.j9a=Q,this.JVg=Nb,this.v_g=!0,this.Udc?this.fFh():(this.y9i(),ha.a.instance.Iy(Q.toString()+"Start"),cb.a.instance.JUd(2)))}XYi(Q,xa,jb=null){this.Udc||
(this.pIa=xa,this.F0g=!0,this.ZZg=Q,this.Jcd=E.a.qU(sa.a.kf(),2),this.s5d&&(ha.a.instance.Iy(this.j9a.toString()+"End"),jb&&(this.ARb=jb.qyn,this.xqb=jb.x2a,this.oqa=jb.ixn),cb.a.instance.Vud(),this.fFh()))}xhl(){if(!(0<this.k6c&&0<this.ARb&&0<this.xqb&&0<this.oqa&&0<this.Jcd))return null;const Q=new Pc;Q.TT=E.a.qU(this.Jcd-this.k6c,2);if(Q.TT<this.UJg)return null;Q.ST=this.bhg;Q.UC=this.bzb;Q.RS=E.a.qU(this.ARb-this.k6c,2);Q.SR=E.a.qU(this.xqb-this.ARb,2);Q.RRS=E.a.qU(this.oqa-this.xqb,2);Q.RP=E.a.qU(this.Jcd-
this.oqa,2);Q.ResponseLanded=E.a.qU(this.xqb,2);0<Q.RS?(ha.a.instance.nX("RTCToRequestSent",this.j9a.toString()+"Start","RequestInvoked"+this.ARb),ha.a.instance.nX("RequestSentToResponseReceived","RequestInvoked"+this.ARb,"RequestCompleted"+this.xqb),ha.a.instance.nX("ResponseReceivedToReplicationStart","RequestCompleted"+this.xqb,"ReplicationStart"+this.oqa)):ha.a.instance.nX("RTCToReplicationStart",this.j9a.toString()+"Start","ReplicationStart"+this.oqa);ha.a.instance.nX("Replication","ReplicationStart"+
this.oqa,this.j9a.toString()+"End");return Q}y9i(){this.Kcd=this.QTb.create();this.Kcd.start(Ll.lVi,Ll.igj)}fFh(){this.Kcd||this.y9i();const Q=this.Kcd.end(this.bmd,this.aOk());this.OIj.D4d(Q);this.Jod.D4d(Q+this.QBe)}aOk(){const Q={};Q[Eb.Nde]=Cc(this.bzb);var xa=this.rUi.length;Q[Eb.IBn]=9>=xa?xa.toString():"10AndAbove";return Object.assign(new ec,{P:Q,FC:this.g1a,CFC:this.c2m+this.g1a,ID:this.j9a.toString(),CD:this.QBe,UC:this.bzb,RCL:this.rUi.length})}}Object(e.a)(jd,"InboundOperation",null,[1760]);
class pe{constructor(Q,xa,jb){this.dHa=Q;this.bSa=xa;this.asb=jb}create(Q,xa){return new jd(this.dHa,this.bSa,this.asb,Q,xa)}}Object(e.a)(pe,"InboundOperationFactory",null,[1716]);class ue{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe){this.dmd=!0;this.SWg=this.Hid=null;this.rO=eg=>{this.ij.rO(6,eg)};this.PBe=Q;this.$Dj=xa;this.$Rj=jb;this.ij=Nb;this.ALe=Bc.create("TypingToOutboundReplicationStart",gd,be,20,!1);this.WEe=Bc.create("OutboundReplicationStartToOutboundReplicationEnd",Bd,Xe,20,!1)}get FLf(){return this.Hid}get O_d(){return this.SWg}t3c(){!this.FLf&&
this.dmd&&(this.dmd=this.$Dj())&&(this.Hid=this.PBe.create(this.rO,this.$Rj(),this.ALe,this.WEe),this.FLf.t3c())}vYc(){this.dmd=!0;this.SWg=this.FLf;this.O_d&&(this.Hid=null,this.O_d.vYc())}hUf(){this.Hid=null}tYc(Q,xa){this.O_d&&this.O_d.tYc(Q,xa)}}Object(e.a)(ue,"OutboundMonitor",null,[]);class Od{constructor(Q,xa){this.PBe=Q;this.SQj=xa}create(Q,xa,jb,Nb,Bc,gd,be){return new ue(this.PBe,Q,xa,jb,this.SQj,Nb,Bc,gd,be)}}Object(e.a)(Od,"OutboundMonitorFactory",null,[]);var zf=c(59);class Tf{constructor(Q){this.A9a=
Q}get Shn(){return this.A9a}ub(Q){return!!this.A9a&&Q in this.A9a}get lki(){return this.ub(Tf.sAd)&&this.ub(Tf.vJb)&&this.ub(Tf.p0f)}get revisionId(){if(this.ub(Tf.vJb))return zf.a.Pf(this.A9a[Tf.vJb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get e5d(){if(this.ub(Tf.vJb))return this.A9a[Tf.vJb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get nDi(){if(this.ub(Tf.sAd))return Number.parseInvariant(this.A9a[Tf.sAd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get $4i(){if(this.ub(Tf.vJb))return Boolean.parse(this.A9a[Tf.p0f]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get g1a(){if(this.ub(Tf.YEf))return Number.parseInvariant(this.A9a[Tf.YEf]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static zLk(Q){return new Tf(Q)}static ELk(Q,xa,jb,Nb){const Bc={};Bc[Tf.sAd]=Q.toString();Bc[Tf.vJb]=xa.toString();Bc[Tf.p0f]=jb.toString();Bc[Tf.YEf]=Nb.toString();return new Tf(Bc)}}
Tf.vJb="RevisionID";Tf.sAd="Duration";Tf.p0f="ShouldSample";Tf.YEf="NumSequentialFailures";Object(e.a)(Tf,"ReplicationNotificationMessage",null,[1747]);class dc{constructor(Q,xa,jb,Nb,Bc,gd,be){this.Gr=this.Gi=0;this.nsb=this.ixc=null;this.xhe=[];this.QXg=null;this.W$c={};this.pIa=0;this.QTb=Q;this.uVj=xa;this.bSa=jb;this.asb=Nb;this.C1g=Bc;this.j9a=null;this.W$c.TypingStartStage=null;this.W$c.ReplicationStartStage="TypingStartStage";this.W$c.ReplicationEndStage="ReplicationStartStage";this.$5g=1<
this.bzb;this.ALe=gd;this.WEe=be}get bzb(){return this.asb()}t3c(){this.MWe("TypingStartStage")&&(this.lRf("TypingStartStage"),ia.ULS.shipAssertTag(8257931,324,!this.nsb&&!this.Gr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.Gi=this.bSa(),this.ixc=this.QTb.create(),this.q9i(this.ixc,Ll.rgo))}vYc(){if(this.MWe("ReplicationStartStage")){this.lRf("ReplicationStartStage");ia.ULS.shipAssertTag(8257932,324,!!this.ixc,"TypingStart not called");if(this.ixc){const Q=this.aFh(this.ixc,
this.j9a);this.ALe.D4d(Q)}this.nsb=this.QTb.create();this.q9i(this.nsb,Ll.d2m)}}tYc(Q,xa){this.MWe("ReplicationEndStage")&&(this.lRf("ReplicationEndStage"),this.Gr=this.bSa(),this.pIa=xa,ia.ULS.shipAssertTag(8257933,324,!!this.nsb,"ReplicationStart not called"),this.nsb&&(ia.ULS.shipAssertTag(8193425,324,!!this.nsb,"ReplicationStart not called"),xa=this.aFh(this.nsb,Q),this.WEe.D4d(xa)),ia.ULS.shipAssertTag(8257934,324,!!this.Gi,"StartTime not set. No message sent to other editors."),this.Gi&&(Q=
Tf.ELk(this.Gr-this.Gi,Q,this.C1g,this.pIa),this.uVj(Q.Shn)))}MWe(Q){if(this.W$c[Q]===this.QXg)return!0;ia.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.f2j()});return!1}f2j(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let xa=0;xa<this.xhe.length;xa++)Q.append(" "+this.xhe[xa]);return Q.toString()}lRf(Q){this.xhe.push(Q);this.QXg=Q}q9i(Q,xa){this.$5g&&Q.start(xa)}aFh(Q,xa){if(!this.$5g)return-1;const jb={};jb[Eb.Nde]=Cc(this.bzb);xa=Object.assign(new ec,
{P:jb,FC:this.pIa,CFC:0,ID:xa?xa.toString():"",CD:0,UC:this.bzb,RCL:0});return Q.end(this.C1g,xa)}}Object(e.a)(dc,"OutboundOperation",null,[1751]);class Oi{constructor(Q,xa,jb){this.QTb=Q;this.bSa=xa;this.asb=jb}create(Q,xa,jb,Nb){return new dc(this.QTb,Q,this.bSa,this.asb,xa,jb,Nb)}}Object(e.a)(Oi,"OutboundOperationFactory",null,[1715]);class Ci{constructor(Q,xa){this.hAg=this._name=this.q1=null;this.me=Q;this.dxa=xa}start(Q,xa=null){this.q1=this.me.jg("UserAction",Q);this._name=Q;this.hAg=xa}end(Q,
xa){let jb=-1;Q&&(jb=this.q1.ri,xa.D=jb,xa.CN=this.hAg,xa.CD+=jb,this.dxa.track(xa,this._name));return jb}}Object(e.a)(Ci,"PerfTracker",null,[1748]);class oi{constructor(Q,xa){this.me=Q;this.dxa=xa}create(){return new Ci(this.me,this.dxa)}}Object(e.a)(oi,"PerfTrackerFactory",null,[1714]);class Wg{constructor(Q,xa,jb){this.etc=null;this.RQj=Q;this.YJg=xa;this.iUb=jb}init(Q,xa,jb,Nb,Bc,gd,be){xa=this.iUb.create(xa/100);jb=this.iUb.create(jb/100);this.etc=this.RQj.create(Object(a.a)(xa,xa.l3a,"shouldBeInSample"),
Object(a.a)(jb,jb.l3a,"shouldBeInSample"),Q,Nb,Bc,gd,be)}t3c(){this.etc.t3c()}vYc(){this.etc.vYc()}hUf(){this.etc.hUf()}tYc(Q,xa){this.etc.tYc(Q,xa)}o2l(Q,xa,jb=null){this.YJg.hxn(Q,xa,jb)}odc(Q){Q=Tf.zLk(Q);this.YJg.odc(Q);ha.a.instance.Iy(Q.revisionId+"Start")}vao(Q,xa,jb){v.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.Dxd(Q,xa,jb))}uao(Q,xa,jb){v.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.Dxd(Q,xa,jb))}Dxd(Q,xa,jb){const Nb=
{};Nb.PhaseName=Q;Nb.ThresholdValue=xa;Nb.ActualValue=jb;return Nb}}Object(e.a)(Wg,"ReplicationTelemetryManager",null,[]);var Bk=c(929);class Ca extends Bk.a{constructor(Q,xa){super(Q,xa);this.ej=this.bnd=0}Fva(Q){this.bnd+=Q;this.ej++}getValue(){return this.ej?this.bnd/this.ej:0}uPa(){this.ej=this.bnd=0}}Object(e.a)(Ca,"AverageMetric",Bk.a,[]);class vb extends Bk.a{constructor(Q,xa){super(Q,xa);this.pya=0}Fva(Q){Q>this.pya&&(this.pya=Q)}getValue(){return this.pya}uPa(){this.pya=0}}Object(e.a)(vb,
"MaxMetric",Bk.a,[]);var hc=c(1787);class Nc extends Bk.a{constructor(Q,xa,jb=100){super(Q,xa);this.Xfd=this.hTb=this.IVb=0;this.Ikd=jb;this.NFe=new hc.a(this.Ikd)}Fva(Q){if(this.hTb===this.Ikd){const xa=this.NFe.dequeue();this.IVb-=xa;this.hTb--}this.NFe.enqueue(Q);this.IVb+=Q;this.hTb++;Q=this.IVb/this.hTb;Q>this.Xfd&&this.hTb===this.Ikd&&(this.Xfd=Q)}getValue(){return this.Xfd}uPa(){this.Xfd=0;this.NFe=new hc.a(this.Ikd);this.hTb=this.IVb=0}}Object(e.a)(Nc,"MaxRollingAverageMetric",Bk.a,[]);class sd extends Bk.a{constructor(Q,
xa){super(Q,xa);this.ej=0}Fva(){this.ej++}getValue(){return this.ej}uPa(){this.ej=0}}Object(e.a)(sd,"CounterMetric",Bk.a,[]);class Id{constructor(Q,xa){this.IWb=xa;this.Lie=new Ca(Q+"-AverageValue","Milliseconds");this.fze=new vb(Q+"-MaxValue","Milliseconds");this.mze=new Nc(Q+"-MaxRollingAverageValue","Milliseconds");this.ame=new sd(Q+"-NumberOfEvents","Count");this.Kqa=new Za.a(Q+"-SlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.aQ("CoAuthLatencySlowTargetValue",3E3),F.AFrameworkApplication.K.aQ("CoAuthLatencySlowThresholdPercentile",
95),this.IWb);this.aDe=new Za.a(Q+"-BrokenSlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.aQ("CoAuthLatencyBrokenSlowTargetValue",5E3),F.AFrameworkApplication.K.aQ("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.IWb)}s_(Q){this.Lie.Fva(Q);this.fze.Fva(Q);this.mze.Fva(Q);this.ame.Fva(Q);this.Kqa.Fva(Q);this.aDe.Fva(Q)}h3d(){this.Lie.ZOa();this.fze.ZOa();this.mze.ZOa();this.ame.ZOa();this.Kqa.ZOa();this.aDe.ZOa();this.Lie.uPa();this.fze.uPa();this.mze.uPa();this.ame.uPa();this.Kqa.uPa();
this.aDe.uPa()}}Object(e.a)(Id,"ReplicationLatencyMetrics",null,[]);class We{constructor(){this.Pxe=new nb.a}uMi(Q,xa,jb){if(!(0>xa)){if(!({value:Nb}=this.Pxe.Bc(Q,Nb)).returnValue){var Nb=new Id(Q,jb);this.Pxe.Z(Q,Nb)}Nb.s_(xa)}}h3d(){for(const Q of this.Pxe.values)Q.h3d()}}Object(e.a)(We,"ReplicationTelemetryMetricsManager",null,[1702]);class Fd{uMi(){}h3d(){}}Object(e.a)(Fd,"ReplicationTelemetryMetricsManagerStub",null,[1702]);class Ff{constructor(Q,xa,jb,Nb,Bc,gd,be){this.bVa=this.sod=0;this.fOj=
Q;this.eDe=jb;this.j4g=Nb;this.Zwg=Bc;this.ZVb=xa;this.gOj=gd;this.IWb=be}D4d(Q){this.fOj.uMi(this.eDe,Q,this.IWb);Q>this.j4g&&this.ZVb.dao(this.eDe,this.j4g,Q);this.sod+=Q;this.bVa++;this.sod/this.bVa>this.Zwg&&this.bVa>this.gOj&&this.ZVb.zik(this.eDe,this.Zwg,this.sod/this.bVa)}}Object(e.a)(Ff,"TimeSpanVerifier",null,[1743]);class Ac{constructor(Q,xa){this.bUj=Q;this.ZVb=xa}create(Q,xa,jb,Nb,Bc){return new Ff(this.bUj,this.ZVb,Q,xa,jb,Nb,Bc)}}Object(e.a)(Ac,"TimeSpanVerifierFactory",null,[1703]);
class Qi extends Sys.EventArgs{constructor(Q,xa,jb){super();this.ORi=Q;this.cbe=xa;this.actualValue=jb}}Object(e.a)(Qi,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Tc{constructor(){this.sa=new h.a}dao(Q,xa,jb){this.sa.raiseEvent("TSVTE",new Qi(Q,xa,jb))}zik(Q,xa,jb){this.sa.raiseEvent("TSVATE",new Qi(Q,xa,jb))}O9j(Q){this.sa.addHandler("TSVTE",Q)}F8j(Q){this.sa.addHandler("TSVATE",Q)}}Object(e.a)(Tc,"TimeSpanVerifierNotifier",null,[1698]);class uj{constructor(){this.W=this.Oa=null}get name(){return"Box4.ReplicationTelemetry"}zc(Q){this.Oa=
Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Oa.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new oi(Ie.App.xa.lq,P.a.vF(20,1,new S.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Tc).singleInstance();this.Oa.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new We).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new Fd).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Ac(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new Oi(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),uj.qRh)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Od(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),
Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>new pe(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),uj.qRh)).singleInstance();var xa=new Ae(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),jb=this.Oa.$("ComponentStateLoggingPackageIsEnabled")?
this.W.$a("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>xa.create(this.Oa.rc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Oa.rc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Oa.rc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Oa.rc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),jb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new vg).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",
()=>new Wg(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();Q.ha("ReplicationTelemetry.EventForwarderFactory",()=>new Ph(Gm.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Oa.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Oa.rc("Box4ReplicationTelemetrySamplePercent",0),xa=this.Oa.rc("Box4ReplicationTelemetryPhaseSamplePercent",
0),jb=this.Oa.rc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Nb=this.Oa.rc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Bc=this.Oa.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),gd=this.Oa.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),be=this;this.W.$a("Box4.Presence.IRtcProxyProvider").execute(Xe=>{Xe.CI().continueWith(()=>{const eg=Xe.CI().result,og=be.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");
og.init(eg,Q,xa,jb,Nb,Bc,gd);be.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(eg,og);if(be.Oa.$("LogSteppedInboundFrameIsEnabled")){const Ni=Wk.a.Lq(be.W.$a("Common.ICpuMeterProvider"));Ni.continueWith(()=>{const kk=be.W.resolve("ReplicationTelemetry.IInboundMonitor");var mj=new va.a(()=>!0);mj=P.a.vF(19,1,mj);kk.initialize(mj);const am=Ni.result.Vo.task;am.continueWith(()=>{am.result.Dqd(0,()=>kk.EIe,zj=>{kk.tTm(zj)});am.result.Dqd(1,zj=>kk.TWn(zj),()=>{kk.sTm()})})})}ia.ULS.sendTraceTag(8257935,
305,50,"ReplicationTelemetry init")})});var Bd=this;F.AFrameworkApplication.FK(()=>{Bd.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").h3d()})}}dispose(){}static qRh(){const Q=Ie.App.vd;return Q?Q.TDh:0}}Object(e.a)(uj,"ReplicationTelemetryPackage",null,[1,2]);var oj=c(932),ti=c(14),Th=c(145),di=c(3),Nj=c(96),im=c(66),Hg=c(229),ah=c(19),Ji=c(24),Jh=c(11),Dl=c(1896);class Bh{static get vg(){return uc.a.Rx(Bh.tl,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Bh.tl="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(Bh,"InsertSymbolsDialogHtml",null,[]);class Ge extends Dl.a{constructor(Q,xa,jb){super();this.uSb=this.jJa=this.m$a=null;this.Cte=0;this.z8l=Nb=>{1===Nb?(this.xHf("symbol_d_"+Ge.Pqc),this.Ub.zK(this.$J,!0),this.Ub.Fs().Wj.qy(this.qG),this.qG.focus()):this.hide()};this.kaj=Nb=>{if(Nb.target!==this.uSb){const Bc=this.Ub.Fs();Bc&&Bc.Wj&&(Bc.Wj.qy(Nb.target),this.uSb=Nb.target)}this.zZm(Nb.target.id)};this.G7n=Nb=>{const Bc=Nb.Af;if("a"!==Bc.tagName.toLowerCase())return!1;Nb.eventName===A.a.XC&&
this.xHf(Bc.id);this.Ub.zK(this.$J,!0);this.Ub.Fs().Wj.qy(Bc);Bc.focus();return!0};this.I7n=Nb=>{var Bc=Nb.Af;if("a"!==Bc.tagName.toLowerCase())return!1;const gd=parseInt(Bc.id.substr(Bc.id.lastIndexOf("_")+1));if(Nb.Ib.ctrlKey||Nb.Ib.altKey||Nb.Ib.keyCode>=Hf.a.ONb&&Nb.Ib.keyCode<=Hf.a.PNb)return!1;if(Nb.eventName===A.a.ni){Nb=Nb.Ib.keyCode;let be=-1;Nb===Sys.UI.Key.enter?(this.xHf(Bc.id),this.Ub.zK(this.$J,!0),this.Ub.Fs().Wj.qy(Bc),Bc.focus()):Nb===Sys.UI.Key.up?be=gd-15:Nb===Sys.UI.Key.down?be=
gd+15:Nb===Sys.UI.Key.left?be=F.AFrameworkApplication.isRtl?gd+1:gd-1:Nb===Sys.UI.Key.right&&(be=F.AFrameworkApplication.isRtl?gd-1:gd+1);0<=be&&(Bc=this.Gif("symbol_d_"+be))&&Bc.focus()}return!0};this.ga=Q;this.Ub=xa;this.n$a=jb;this.We(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.We(0,CommonUIStrings.l_DialogClose);this.K8=!1;this.vg=Bh.vg;this.lg="InsertSymbolsDialog"}dispose(){0<Ge.XKe&&ia.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.Cte,Ge.XKe);Ge.ACg++;ia.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Ge.ACg);this.ga=this.n$a=null;super.dispose()}gQa(){this.Vh(Box4Intl.Box4Strings.L_SymbolSingle,this.z8l,null);this.Cte=0;Ge.GCg++;ia.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Ge.GCg);const Q=this.Gif("symbol_d_"+Ge.Pqc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let xa=0;xa<Q.length;xa++)H.a.removeHandler(Q[xa],
A.a.focus,this.kaj);super.hide()}get ihb(){return Ge.Vqc}set ihb(Q){Ge.Vqc=Q}get ehb(){return Ge.Jqc}set ehb(Q){Ge.Jqc=Q}eU(){super.eU();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.n$a.jnk(),Q=Q.getElementsByTagName("a")))for(let xa=0;xa<Q.length;xa++)H.a.addHandler(Q[xa],A.a.focus,this.kaj)}Wja(){const Q=document.getElementById("symbolsContainer");Q&&(this.m$a||(this.m$a=this.G7n,this.oq.mb(A.a.click,Q,this.m$a),this.oq.mb(A.a.XC,Q,this.m$a)),this.jJa||(this.jJa=this.I7n,
this.le.mb(A.a.ni,Q,this.jJa),this.le.mb(A.a.Kt,Q,this.jJa),this.le.mb(A.a.oh,Q,this.jJa)));super.Wja()}dcb(){const Q=document.getElementById("symbolsContainer");Q&&(this.m$a&&(this.oq.sc(A.a.click,Q,this.m$a),this.oq.sc(A.a.XC,Q,this.m$a),this.m$a=null),this.jJa&&(this.le.sc(A.a.ni,Q,this.jJa),this.le.sc(A.a.Kt,Q,this.jJa),this.le.sc(A.a.oh,Q,this.jJa),this.jJa=null));super.dcb()}zZm(Q){this.Q1i("symbol_d_"+Ge.Pqc,!1);Ge.Pqc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.Q1i(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const xa=
this.xId(Ge.Pqc);Q.innerText=xa.altText}}xId(Q){const xa=this.n$a.eae.s4f.value,jb=dg.a(xa);return xa[jb[Q]]}xHf(Q){this.Cte++;Ge.XKe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const xa=this.xId(Q),jb={};jb.SourceControlId="symbol_"+Q+"_"+xa.cae;this.ga.Xb(di.a.Jfb,2,jb);ia.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}Gif(Q){const xa=document.getElementById("symbolsContainer");return xa?xa.querySelector("#"+Q):null}Q1i(Q,xa){(Q=this.Gif(Q))&&(xa?Q.setAttribute("selected",
"true"):Q.removeAttribute("selected"))}}Ge.Pqc=0;Ge.Vqc=null;Ge.Jqc=null;Ge.GCg=0;Ge.ACg=0;Ge.XKe=0;Object(e.a)(Ge,"InsertSymbolsDialog",Dl.a,[]);class Wd{constructor(Q,xa,jb,Nb,Bc,gd,be){this.CMl=()=>this.n$a.lok();this.WJi=(Bd,Xe,eg,og,Ni)=>{if(1===eg)return 32;Bd=this.n$a.YEi(Ni);Bd=String.format(this.n$a.H7n,Bd.character);Ni[oj.a.InnerHTML]=Bd;Ni[oj.a.On]=!1;return 32};this.FMa=(Bd,Xe,eg,og,Ni)=>{if(({ve:Bd,selected:eg,FMa:am}=this.EDc(Xe,eg)).returnValue)return am;var kk=ah.SelectionEditor.zf(eg);
let mj=!0;eg=8;var am=this.Hc.Rc(15);am.Eb(Bd.ld);kk||(eg=this.ga.Vf(Xe,di.a.Oka,2,!0,og,null),Xe=32===eg,ia.ULS.shipAssertTag(6407387,348,Xe,"DeleteForReplace did not succeed. Response is {0}",eg),mj=Xe);mj&&(Xe=Bd.Cb.Jg,kk=ah.SelectionEditor.zf(Xe),ia.ULS.shipAssertTag(6407388,348,kk,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Xe.contextId),eg=8,kk&&(eg=this.ga.Vf(Xe,di.a.Jfb,2,!1,og,Ni),ia.ULS.shipAssertTag(6407389,348,32===eg,"Insertion at IP context did not succeed. Response is {0}",
eg),32===eg&&ld.FocusManager.instance().Kg(Bd.sI)));am.dispose();return eg};this.y8l=(Bd,Xe,eg,og,Ni)=>{if(1===eg)return 32;if(ah.SelectionEditor.n_a(Xe))return 2;Bd=this.n$a.YEi(Ni);og.Mr=Bd.index;og=this.Yc.Zf(Xe.node);eg=og.Ab(11);ia.ULS.shipAssertTag(6379466,324,eg,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Th.a[Xe.node.type]);eg=this.Hc.Rc(15);eg.Qu(og);Wd.characterPropertiesEditor.replaceTextRange(Xe,Bd.character,!0,!1);Xe=Ji.SelectionFactory.xe(og.currentNode,
Xe.cpBegin+1);this.hb.setSelection(Xe);eg.dispose();return 32};this.PHb=(Bd,Xe,eg,og,Ni)=>{if(1===eg)return 32;Ni.MenuItems=this.pYj.value;return 32};this.laj=(Bd,Xe,eg)=>{({FMa:Bd}=this.EDc(Xe,eg));return Bd};this.o6i=(Bd,Xe,eg)=>{2===eg&&(new Ge(this.ga,ld.FocusManager.instance(),oa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).gQa();return 32};this.tPf=()=>32;this.ga=Q;this.Yc=xa;this.pYj=new tb.a(this.CMl);this.Hc=jb;this.n$a=Nb;this.Mk=Bc;this.hb=gd;this.Km=be}Vb(){this.ga.gb(di.a.tPf,
ti.a.application,this.tPf,96);this.ga.pa(di.a.PHb,ti.a.view,this.PHb);this.ga.pa(di.a.dae,ti.a.view,this.laj);this.ga.pa(di.a.n2d,ti.a.view,this.WJi);this.ga.pa(di.a.Jfb,ti.a.view,this.FMa);this.ga.pa(di.a.PHb,ti.a.Wc,this.PHb);this.ga.pa(di.a.dae,ti.a.Wc,this.laj);this.ga.pa(di.a.n2d,ti.a.Wc,this.WJi);this.ga.pa(di.a.Jfb,ti.a.Wc,this.y8l);this.ga.Vc(di.a.PHb,1124);this.ga.Vc(di.a.dae,1036);this.ga.Vc(di.a.n2d,1124);this.ga.Vc(di.a.Jfb,1036);F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&
(this.ga.pa(di.a.DMc,ti.a.view,this.o6i),this.ga.pa(di.a.DMc,ti.a.Wc,this.o6i),this.ga.Vc(di.a.DMc,1124))}EDc(Q,xa){let jb,Nb=null;Q.view.ye&&(Nb=Q.view);jb=null;if(!Nb||!Nb.Cb)return v.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,ve:Nb,selected:jb,FMa:8};jb=Nb.Cb.Jg;if(!jb)return{returnValue:!0,ve:Nb,selected:jb,FMa:2};if(this.Mk.mZ(jb)||this.Mk.fua(jb))return{returnValue:!0,ve:Nb,
selected:jb,FMa:8};if(Nb.Cb.ib.JI||this.Km&&this.Km.instance&&this.Km.instance.KT(jb)||ah.SelectionEditor.n_a(Q.rk))return{returnValue:!0,ve:Nb,selected:jb,FMa:2};if(Wd.Sg.Swa(Jh.ParagraphReader.HT,jb))return Q=8,Wd.Kc.Zb(Nj.a.vf,{["Reason"]:im.a.uN}),{returnValue:!0,ve:Nb,selected:jb,FMa:Q};Q=32;return 1===xa?{returnValue:!0,ve:Nb,selected:jb,FMa:Q}:{returnValue:!1,ve:Nb,selected:jb,FMa:Q}}static get characterPropertiesEditor(){return Wd.Yd||(Wd.Yd=oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){Wd.Yd=
Q}static get Sg(){return Hg.ContextSetEditor.instance}static get Kc(){return Tg.a.instance}}Wd.Yd=null;Object(e.a)(Wd,"SymbolsActor",null,[1668]);class Pd{constructor(Q,xa){this.cae=Q;this.altText=xa}}Object(e.a)(Pd,"Symbol",null,[]);class rf{constructor(){this.wJe=null;this.u3g=new tb.a(rf.r1e)}get s4f(){return this.u3g}yUh(Q){this.wJe||(this.wJe=dg.a(this.u3g.value));return Array.indexOf(this.wJe,Q)}static r1e(){const Q={};Q["\u2022"]=new Pd("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Pd("\u20ac",
Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Pd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Pd("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Pd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Pd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Pd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Pd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Pd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Pd("\u2264",
Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Pd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Pd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Pd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Pd("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Pd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Pd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Pd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);
Q["\u03c0"]=new Pd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Pd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Pd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Pd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Pd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Pd("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Pd("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Pd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);
Q["\u00bf"]=new Pd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Pd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Pd("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Pd("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Pd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Pd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Pd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);
Q["\u00c3"]=new Pd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Pd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Pd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Pd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Pd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Pd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Pd("\u00c9",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Pd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Pd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Pd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Pd("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Pd("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Pd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);
Q["\u00d1"]=new Pd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Pd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Pd("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Pd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Pd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Pd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=
new Pd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Pd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Pd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Pd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Pd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Pd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Pd("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Pd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Pd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Pd("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Pd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Pd("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Pd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
Q["\u00e8"]=new Pd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Pd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Pd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Pd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Pd("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Pd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Pd("\u00ee",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Pd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Pd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Pd("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Pd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Pd("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Pd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);
Q["\u00f6"]=new Pd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Pd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Pd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Pd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Pd("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Pd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=
new Pd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Pd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Pd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Pd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Pd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Pd("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Pd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);
Q["\u015f"]=new Pd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Pd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(e.a)(rf,"SymbolsLoader",null,[1667]);var ie=c(443),rd=c(358),Nk=c(213),bh=c(662),yi=c(1426),Db=c(236),Ic=c(95);class Jd{constructor(Q){this.eae=Q}get H7n(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}YEi(Q){Q=Q.SourceControlId.split("_");const xa={};2===Q.length?(xa.character=
Q[1],xa.index=this.eae.yUh(xa.character)):(xa.character=Q[2],xa.index=parseInt(Q[1]));return xa}lok(){return this.r0h()}build(){return this.DMl()}jnk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const xa=this.eae.s4f.value,jb=dg.a(xa);let Nb=0;for(;Nb<jb.length;){Nb%15||Q.append('<tr role="presentation">');const Bc=xa[jb[Nb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Nb,Pb.a.GZ(Bc.cae),Pb.a.GZ(Bc.altText)));Nb++;Nb%15&&Nb!==jb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}DMl(){const Q=this.r0h();return Db.q(Q)}r0h(){const Q=Object.assign(new ie.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.S6j());F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.U4j());return Q}U4j(){const Q=Object.assign(new rd.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),xa=Object.assign(new Nk.a,{Id:"btnMoreSymbols",Command:di.a.DMc.toString(),LabelText:Pb.a.Ff(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Pb.a.Ff(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:F.AFrameworkApplication.pr,Image16by16Class:Ic.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(xa);return Q}S6j(){const Q=Object.assign(new rd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
xa=Object.assign(new bh.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),jb=this.eae.s4f.value,Nb=dg.a(jb),Bc=Math.min(25,Nb.length);for(let be=0;be<Bc;be++){var gd=jb[Nb[be]];gd=Object.assign(new yi.a,{Id:String.format("{0}{1}_{2}","symbol_",be,gd.cae),Character:gd.cae,Command:di.a.Jfb.toString(),QueryCommand:di.a.n2d.toString(),Alt:Pb.a.Ff(gd.altText)});xa.GalleryItems.push(gd)}Q.ControlList.push(xa);
return Q}}Object(e.a)(Jd,"SymbolsUiBuilder",null,[1666]);var Ne=c(53),Ee=c(246),$f=c(657),sf=c(390);class Ke{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){F.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register(rf,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Jd(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();
this.W.ha("Box4.Symbols.SymbolsActor",()=>new Wd(F.AFrameworkApplication.ya,new $f.a,new sf.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Ee.a.instance,Ne.a.instance,this.W.$a("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){ca.a.instance.Pc(new Ke)}}Object(e.a)(Ke,"Box4SymbolsPackage",null,[1,2]);var sh=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Re=c(1563),dh=c(1524),Ck=c(1513),mh=c(1815),vh=c(206),zg=c(440);class zi{constructor(){this.$Fa=null}zc(Q){this.container=Q}init(){this.$Fa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.$Fa&&this.$Fa.dispose()}}Object(e.a)(zi,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class Qh{get gGk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get hGk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get iGk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Z1m(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get $ib(){return CommonUIStrings.l_AccCheckerPaneTitle}get C5m(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(Qh,"AccessibilityCheckStringsProvider",null,[814]);
class Rl{constructor(){this.rVi=this.contentId=null}}Object(e.a)(Rl,"ResultIds",null,[]);class kh{constructor(Q,xa){this._element=null;this.kg=xa;this.le=Q}get element(){this._element||(this._element=this.QKk(),this.ez());return this._element}k_f(Q){this._element=Q}dispose(){this.element&&(this.j8(),this.k_f(null))}ez(){this.kg&&this.le?(this.kg.mb(A.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.le.mb(A.a.ni,this.element,Object(a.a)(this,this.RF,"onKeyPress"))):ia.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}j8(){this.kg&&this.le&&(this.kg.sc(A.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.le.sc(A.a.ni,this.element,Object(a.a)(this,this.RF,"onKeyPress")))}onClick(){this.UXd();return!0}RF(Q){return this.xhm(Q.Ib.keyCode)?(this.UXd(),!0):!1}xhm(Q){return Q===Hf.a.Vde||Q===Hf.a.hs}}Object(e.a)(kh,"AInteractivePaneElement",null,[844,10]);var nk=c(477),
Lh=c(49);class Rh extends kh{constructor(Q,xa,jb){super(Q,xa);this.$Ae=jb}hide(){this.element.removeAttribute(pb.a.Bh);pb.a.Jq(this.element,pb.a.Fz,pb.a.Jo);this.element.style.display="none"}show(){pb.a.Jq(this.element,pb.a.Fz,pb.a.rL);pb.a.Jq(this.element,pb.a.Bh,pb.a.kSe);this.element.style.display="block"}QKk(){const Q=nk.b("div",this.Gvi,"AccCheckerNotification");pb.a.Jq(Q,pb.a.gfh,pb.a.Jo);pb.a.Jq(Q,pb.a.Fda,this.EEf);Q.tabIndex=0;const xa=nk.b("span",this.Fvi,"AccCheckerNotificationIcon");var jb=
Ic.createClusteredImage(16,16,"Info_16x16x32","",!0,"");xa.appendChild(jb);jb=nk.b("span",this.EEf,"AccCheckerNotificationText");Lh.a.ly(jb,this.Hvi);Q.appendChild(xa);Q.appendChild(jb);return Q}UXd(){this.$Ae()}}Object(e.a)(Rh,"APopupNotification",kh,[863,844,10]);class wf extends Rh{constructor(Q,xa,jb,Nb){super(Q,xa,jb);this.cra=Nb}get Gvi(){return"AccCheckerOutOfSyncNotificationId"}get Fvi(){return"AccCheckerOutOfSyncNotificationIconId"}get EEf(){return"AccCheckerOutOfSyncNotificationTextId"}get Hvi(){return this.cra.Z1m}}
Object(e.a)(wf,"OutOfSyncNotification",Rh,[]);class lc extends Rh{constructor(Q,xa,jb,Nb){super(Q,xa,jb);this.cra=Nb}get Gvi(){return"AccCheckerPartialResultNotificationId"}get Fvi(){return"AccCheckerPartialResultNotificationIconId"}get EEf(){return"AccCheckerPartialResultNotificationTextId"}get Hvi(){return this.cra.C5m}}Object(e.a)(lc,"PartialResultNotification",Rh,[]);var Bm=c(139),Rd=c(34),qe=c(180);class ok{constructor(Q,xa,jb,Nb=null,Bc=null,gd=null,be=null){this.IZg=this.gL=this.le=this.$Fa=
null;this.xNa=Nb;this.kg=Q;this.Ub=xa;this.Ro=jb;this.cra=be||new Qh;this.NBe=Bc||new wf(this.xNa,this.kg,Object(a.a)(this,this.ZXk,"dimissOutOfSyncNotification"),this.cra);this.GCe=gd||new lc(this.xNa,this.kg,Object(a.a)(this,this.$Xk,"dimissPartialResultNotification"),this.cra)}show(){}hide(){}get xNa(){return this.le||(this.le=F.AFrameworkApplication.ta.oy)}set xNa(Q){this.le=Q}Guh(){}$la(){}dispose(){}u4a(){}r$l(Q){var xa=this.IZg[Q];Q=xa.contentId;if((xa=xa.rVi+"")&&xa.length){const jb=[];Array.add(jb,
Object.assign(new Rd.a,{name:"RuleID",string:xa}));Bm.a.sendTelemetryEvent(Object.assign(new qe.a,{name:String.format("{0}.{1}",ok.m5f,"ViolationSelected"),dataFields:jb}))}this.UMm(Q)}UMm(Q){Q&&this.$Fa.fMn(Q)||(this.Ub.zK(Ii.AFrame.B7g,!1),this.bZn())}ZXk(){this.F0c(!1)}$Xk(){this.f6i(!1)}bZn(){const Q=Object.assign(new Kd.StandardDialog(!0),{It:F.AFrameworkApplication.faa,Gd:1,IEa:!1});Q.wU(1);Q.We(1,this.cra.gGk);Q.We(0,CommonUIStrings.l_DialogCancel);Q.yU(this.cra.iGk,this.cra.hGk,xa=>{1===xa&&
this.tpf()})}qok(Q){let xa=null;if(Q.Results&&0<Q.Results.length){xa={};let jb=0;for(const Nb of Q.Results)Nb.ResultId=ok.m1j+ ++jb,Q=new Rl,Q.contentId=Nb.ContentId,Q.rVi=Nb.RuleId,xa[Nb.ResultId]=Q}return xa}zDm(){Bm.a.addNamespaceMapping(ok.m5f,ok.T9n);Bm.a.sendTelemetryEvent(Object.assign(new qe.a,{name:String.format("{0}.{1}",ok.m5f,"ShowTaskpane")}))}}ok.m1j="AccCheckResult";ok.m5f="Office.UX.AccChecker";ok.T9n="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(ok,
"BaseAccessibilityCheckPane",null,[815,10]);class jj{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(jj,"AccCheckerTaskPaneProps",null,[]);var Di=c(1351),td=c(1365),rn=c(1020),dd=c(164);class Ok extends ok{constructor(Q,xa,jb,Nb,Bc=null,gd=null,be,Bd=null,Xe=null){super(xa,
jb,Nb,gd,void 0,void 0,Bd);this.evg=null;this.uYg=this.FCe=this.Mhd=this.dld=this.xkd=!1;this.YLe=null;this.RJe=!!F.AFrameworkApplication.ta&&!!F.AFrameworkApplication.ta.Rb&&F.AFrameworkApplication.ta.Rb.yuf;this.Rnc=this.j4=null;this.Goc=0;this.Obd=null;this.cY=Bc;Xe&&(this.j4=Xe.iqd,this.Rnc=Xe.lHo,this.Goc=Xe.pIo);this.oA=new td.a}get isVisible(){return this.uYg}aQa(Q){this.uYg=Q}m5e(Q){Q&&(this.evg=Q,Q.IsSuccess&&(this.IZg=this.qok(Q),Q.IsPartialResult&&this.f6i(!0)),this.xkd=!0,this.dld=!1,
this.om())}F0c(Q){this.isVisible&&Q!==this.Mhd&&(this.Mhd=Q,this.om())}f6i(Q){this.FCe=Q;this.om()}tO(){this.dld||dd.UISurfaces.fu().then(Q=>{ha.a.instance.Iy(Ok.rnb+":PaneOpen:Start");Q.showTaskPane(Ok.rnb,this.AB());this.tpf();return null});this.isVisible?dd.UISurfaces.fu().then(Q=>{Q.setSelectedTaskPane(Ok.rnb);return null}):this.zDm()}om(){dd.UISurfaces.fu().then(Q=>{Q.updateTaskPane(Ok.rnb,this.AB());return null})}AB(){var Q=new jj;this.oA.mKb(Q);Q=Object.assign(new rn.a,{title:this.cra.$ib,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.I7();this.aQa(!0);F.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.vba();this.aQa(!1);this.dld=this.xkd=!1;this.om();F.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.RJe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const xa=this.Ub.re(Ok.rnb);xa.parent=Ii.AFrame.Qp;xa.XL=!0;this.$Fa=Q;this.i2j()}dispose(){this.u4a();this.NBe&&(this.NBe.dispose(),this.NBe=null);
this.GCe&&(this.GCe.dispose(),this.GCe=null);super.dispose()}i2j(){this.oA.AK(this.onRecheckExecute());this.oA.AK(this.dil());this.oA.AK(this.rIl());this.oA.AK(this.onInvokeNavigateExecute());this.oA.AK(this.gwl());this.oA.AK(this.FDl());this.oA.AK(this.xFl());this.oA.AK(this.updateLastScanTime());this.oA.AK(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.tpf()}}}dil(){return Q=>{Q.accessibilityCheckResultCollection=this.evg}}rIl(){return Q=>{Q.resultsReady=this.xkd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=xa=>{this.r$l(xa)}}}gwl(){return Q=>{Q.helpLink=this.L7k}}FDl(){return Q=>{Q.outOfSync=this.Mhd}}xFl(){return Q=>{Q.partialResult=this.FCe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=xa=>{this.YLe=xa}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{F.AFrameworkApplication.K&&F.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?F.AFrameworkApplication.XJ||this.Seh()?this.Obd?this.Obd():this.j4.value&&this.Rnc&&
this.Goc&&this.j4.value.Xb(this.Goc,2,this.Rnc):this.c7i():this.Seh()?this.Obd?this.Obd():this.j4.value&&this.Rnc&&this.Goc&&this.j4.value.Xb(this.Goc,2,this.Rnc):this.c7i()}}}Seh(){return!this.cY||!this.cY.value}c7i(){const Q=this.cY.value;if(Q){var xa={};xa.query=Ok.gTj+Ok.MHj;xa=Object.assign(new Di.a,{qX:xa});Q.Bba(Ok.ase,xa)}}tpf(){this.FCe=this.Mhd=this.xkd=!1;this.YLe&&this.YLe();this.om();this.dld=!0;this.$Fa.sSm()}I7(){this.Ub.Kg(Ok.rnb)}vba(){this.Z_a()&&this.Ub.Kg(this.Ub.NS)}Z_a(){return!!this.Ub.pg&&
this.Ub.pg.name===Ok.rnb}}Ok.rnb="AccessibilityCheckerPane";Ok.MHj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Ok.ase="FA000000012";Ok.gTj="AssetID=";Object(e.a)(Ok,"ReactAccessibilityCheckPane",ok,[]);class Rg extends Ok{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe=null){super(Q,xa,jb,Nb,Bc,gd,void 0,Xe);this.tEj=Bd;this.pP=be}get L7k(){return this.tEj}tO(){this.pP.FKa();super.tO()}}Object(e.a)(Rg,"ReactLiveBooksAccessibilityCheckPane",Ok,[]);var Cm=c(1127),vj=c(134),Hm=c(183),vq=c(75),Gh=c(159),wc=c(525),Og;
(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(Og||(Og={}));Object(e.b)("AccessibilityRuleCategory",Og);class Ri{constructor(Q,xa,jb=null){this.Xge=null;this.yMg=this.jLg=!1;this.AJa=Q;this.q6c=xa;this.ga=jb;this.wc.pa(Ra.a.Szk,$b.a.frame,Object(a.a)(this,this.XXe,"closePane"))}get wc(){return this.ga||(this.ga=F.AFrameworkApplication.ya)}set wc(Q){this.ga=Q}b4k(){this.jLg||(this.AJa.initialize(this),this.q6c.initialize(this),
this.jLg=!0)}sSm(){v.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.q6c.TCn()}tO(Q,xa,jb){if(1===jb)return Af.SessionStatusManager.instance.Tj?8:32;this.AJa.isVisible||this.b4k();this.A_n();return 32}XXe(Q,xa,jb){1!==jb&&this.AJa.$la();return 32}JIf(){this.AJa.F0c(!0)}m5e(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const jb=Q.AccessibilityRules;for(let Nb in jb){var xa=Nb;const Bc=jb[Nb].RuleId+"";xa!==Bc&&v.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
xa,Bc)}this.Xge=jb}else!this.Xge&&Q.Results&&0<Q.Results.length?(v.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.Xge;Q.IsSuccess||v.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.psn(Q);this.jDm(Q);this.AJa.m5e(Q)}}psn(Q){const xa=Q.AccessibilityRules;if(Q=Q.Results)for(let jb=Q.length-1;0<=jb;jb--){const Nb=Q[jb];let Bc="";const gd=Nb.RuleId;Nb.ContentName||(Bc+="Result does not have content name. ");gd in xa||(Bc+=String.format("No accessibility check rule exists for ID {0}.",
gd));0<Bc.length&&(v.b(36214999,200,15,"Omitting invalid accessibility check result: "+Bc),Array.removeAt(Q,jb))}}BJl(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):oa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("accessibility-checker-pane-strings")}A_n(){this.yMg?this.AJa.tO():this.BJl().then(()=>{this.yMg=!0;this.AJa.tO()}).catch(Q=>ia.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}jDm(Q){var xa={};const jb={};var Nb=Q.Results,Bc=[];Array.add(Bc,Object.assign(new Rd.a,{name:"FinalViolationCount",int64:0}));Array.add(Bc,Object.assign(new Rd.a,{name:"FinalErrorCount",string:"0"}));Array.add(Bc,Object.assign(new Rd.a,{name:"FinalWarningCount",string:"0"}));Array.add(Bc,Object.assign(new Rd.a,{name:"FinalTipCount",string:"0"}));Array.add(Bc,Object.assign(new Rd.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Nb){for(const Bd of Nb)if(Q.AccessibilityRules){var gd=Q.AccessibilityRules[Bd.RuleId];
if(gd){if(xa[Og[gd.Category]]){let Xe=xa[Og[gd.Category]];xa[Og[gd.Category]]=++Xe}else xa[Og[gd.Category]]=1;jb[Bd.RuleId]?(gd=jb[Bd.RuleId],jb[Bd.RuleId]=++gd):jb[Bd.RuleId]=1}}Bc[0].int64=Nb.length;for(var be in xa)switch(Q=xa[be],Nb=be,Nb="Final"+Nb.charAt(0).toUpperCase()+Nb.substring(1,Nb.length)+"Count",Nb){case "FinalErrorCount":Bc[1].string=Q.toString();break;case "FinalWarningCount":Bc[2].string=Q.toString();break;case "FinalTipCount":Bc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":Bc[4].string=
Q.toString()}}Bm.a.sendTelemetryEvent(Object.assign(new qe.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Bc}));for(let Bd in jb)xa=Bd,Bc=jb[Bd],be=[],Array.add(be,Object.assign(new Rd.a,{name:"RuleID",string:xa})),Array.add(be,Object.assign(new Rd.a,{name:"FinalViolationCount",string:Bc.toString()})),Bm.a.sendTelemetryEvent(Object.assign(new qe.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:be}))}dispose(){this.AJa&&
this.AJa.dispose();this.q6c&&this.q6c.dispose()}}Object(e.a)(Ri,"AAccessibilityCheckManager",null,[52,10]);var vi=c(332);class gh extends Ri{constructor(Q,xa,jb){super(xa,jb,Q);this.graph=null}YJi(Q,xa,jb,Nb,Bc){if(1===jb)return 32;Bc[vi.a.On]=this.AJa.isVisible;return 32}Son(){for(const Q of this.tvi){const xa=this.graph.Ve(Q);xa.qp(Object(a.a)(this,this.Wh,"onPropertyChanged"));xa.Wt(Object(a.a)(this,this.g_,"onConnected"));xa.Zu(Object(a.a)(this,this.zTc,"onDisconnected"))}}Vho(){for(const Q of this.tvi){const xa=
this.graph.Ve(Q);xa.CX(Object(a.a)(this,this.Wh,"onPropertyChanged"));xa.oU(Object(a.a)(this,this.g_,"onConnected"));xa.lba(Object(a.a)(this,this.zTc,"onDisconnected"))}}dispose(){super.dispose();this.Vho()}Wh(){this.JIf()}g_(){this.JIf()}zTc(){this.JIf()}}Object(e.a)(gh,"ALiveBooksAccessibilityCheckManager",Ri,[]);class pk extends gh{constructor(Q,xa,jb,Nb,Bc,gd){super(Q,xa,jb);this.wc.pa(Ra.a.J0f,$b.a.frame,Object(a.a)(this,this.tO,"showPane"));this.wc.gb(Ra.a.Hfn,$b.a.frame,Object(a.a)(this,this.YJi,
"queryToggleAccCheckerPane"),96);this.graph=Bc;this.wOj=Nb;this.SKj=gd;this.Son()}get tvi(){return[12,14,22,19,30,43,44]}fMn(Q){if(this.SKj)return ia.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;ia.ULS.shipAssertTag(20272215,334,!!Q);return this.wOj.PMm(Q)}}Object(e.a)(pk,"WordAccessibilityCheckManager",gh,[]);var ml=c(94),co=c(33),Im=c(141),Kn=c(21),jm=c(186),Xk=c(5),Vf=c(18),Te=c(500);class Hk{constructor(Q,xa,jb,Nb,Bc,gd,be){this.Io=null;this.gyb=0;this.Yc=xa;this.nB=
jb;this.hb=Nb;this.ga=Bc;this.Zc=gd;this.xt=Q;this.ud=be}get bR(){if(!this.Io){const Q=this.Yc.Zf(this.xt.Xc);this.nB.I7f(Q);if(Q.Ab(7)||Q.kd(7))this.Io=ml.a.Lr(Q,Q.origin)}return this.Io}PMm(Q){if(!Q||!Q.Dg||0>=Q.Dg.length)return ia.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var xa=Array(Q.Dg.length);let jb=7,Nb=null;for(let gd=0;gd<Q.Dg.length;gd++)if(Nb=this.Bal(Q.Dg[gd])){if(7===jb)jb=this.gyb;else if(jb!==this.gyb)return ia.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),
!1;var Bc=this.ud.EOa(Nb.characterData,Nb.qa);const be=Q.cpBegin?this.ud.Jxb(Bc,Q.cpBegin):-1;Bc=Q.cpEnd?this.ud.Jxb(Bc,Q.cpEnd):-1;if(-1>be||-1>Bc)return ia.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;xa[gd]=co.a.vL(be,Bc,!1,Nb);switch(Q.contentType){case 5:if(!Im.HyperlinkReader.n5h(xa[gd],!1))return!1;break;case 6:if(!Kn.ImageReader.laa(xa[gd]))return!1;break;case 7:xa[gd]=co.a.vL(-1,-1,!1,Nb)}}else return!1;xa=new jm.Selection(xa,!1);return this.YQn(Nb,
xa,Q.contentType)}Bal(Q){if(this.bR)for(this.bR.reset(),this.gyb=7;this.bR.moveNext();){var xa=this.bR.currentNode.type;if(38===xa||36===xa||23===xa)this.gyb=xa;else if(12===xa){xa=this.bR.currentNode;const jb=xa.ia(Xk.a.Nc,0);if(Q===jb)return xa}}return null}p4f(Q){this.ga.processAction(Vf.a.WS,2);this.ga.processAction(Vf.a.q$,2);let xa=2;switch(this.gyb){case 23:xa=32;break;case 38:xa=this.ga.Xb(Vf.a.Mib,2,new Te.a(Q));break;case 36:xa=this.ga.Xb(Vf.a.khb,2,new Te.a(Q));break;default:ia.ULS.shipAssertTag(20272220,
334,!1,"Unexpected search scope encountered: {0}",this.gyb)}if(32===xa)return!0;ia.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.gyb);return!1}YQn(Q,xa,jb){if(this.p4f(Q)){Q=this.xt.zv;const Nb=this.hb.ib.kb;Nb&&Nb.equals(xa)&&this.Zc.uoa(Q,null);this.Zc.uoa(Q,xa);switch(jb){case 0:case 1:this.ga.processAction(di.a.OJb,2);break;case 2:this.ga.processAction(di.a.DZc,2);break;case 3:this.ga.processAction(di.a.Yva,2)}return!0}return!1}}Object(e.a)(Hk,"WordAccessibilityCheckNavigateManager",
null,[1694]);class El{constructor(Q){this.$Fa=null;this.kHg=Q}get fileId(){return this.kHg?this.kHg():null}initialize(Q){this.$Fa=Q}Fxi(Q){this.$Fa.m5e(Q)}}Object(e.a)(El,"AAccessibilityCheckService",null,[813,10]);class pj{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const xa=Q.AccessibilityRules,jb={};if(xa)for(let Nb=0;Nb<xa.length;++Nb){const Bc=xa[Nb];jb[Bc.Key]=
Bc.Value}Q.AccessibilityRules=jb;return Q}}Object(e.a)(pj,"AccessibilityCheckResultCollection",null,[]);class Sj extends El{constructor(Q){super(Q)}onFailure(Q,xa){ia.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",xa);Q=Object.assign(new pj,{IsSuccess:!1});this.Fxi(Q)}onSuccess(Q){Q=Sj.pIl(Q);let xa=null;if(Q)try{xa=this.zVk(Q)}catch(jb){ia.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",jb.message),xa=Object.assign(new pj,{IsSuccess:!1})}else ia.ULS.shipAssertTag(20730844,
334,!1,"AccChecker response is NULL."),xa=Object.assign(new pj,{IsSuccess:!1});this.Fxi(xa)}dispose(){}static pIl(Q){let xa=null;Q&&Q.hk&&(xa=Q.hk[0]);return xa?xa.Body:null}}Object(e.a)(Sj,"ALiveBooksAccessibilityCheckService",El,[]);var Fn=c(1057),gk=c(244);class eo extends gk.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Tl(){return 56}static construct(Q,xa){const jb=new eo;jb.FileId=Q;jb.IsCoauthorable=xa;return jb}}Object(e.a)(eo,"WordAccessibilityCheckRequest",gk.a,[]);class Dg{}
Object(e.a)(Dg,"AccessibilityCheckRule",null,[]);var Ml=c(151);class Mm{static parse(Q){switch(Pb.a.mh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),Ml.a.argument(Q);}}}Object(e.a)(Mm,"AccessibilityRuleCategoryParser",null,[]);class Ln{constructor(){this.Category=this.Text=this.Id=null}static Pao(Q){const xa=new Dg;xa.RuleId=Q.Id;xa.RuleName=Q.Text;xa.Category=
Mm.parse(Q.Category);return xa}}Object(e.a)(Ln,"WordAccessibilityCheckRule",null,[]);class Pk{}Object(e.a)(Pk,"AccessibilityCheckResult",null,[]);class Tj{constructor(){this.cpEnd=this.cpBegin=this.Dg=null;this.contentType=0}}Object(e.a)(Tj,"WordAccessibilityCheckContentId",null,[]);const Ro=Q=>{switch(Pb.a.mh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;
case "anchoredepicture":return 7;default:return 8}};var Qk=c(1535);class Mn{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static Nao(Q){const xa=new Pk;xa.RuleId=Q.RuleId;xa.ContentName=Q.Label;const jb=new Tj;jb.Dg=Q.ParaId;jb.cpBegin=Qk.b(Q.OS);jb.cpEnd=Qk.b(Q.OE);jb.contentType=Ro(Q.ContentType);xa.ContentId=jb;return xa}}Object(e.a)(Mn,"WordAccessibilityViolation",null,[]);class po{constructor(){this.Violations=this.Rules=null}static Oao(Q){const xa=new pj;
try{var jb={};if(Q.Rules){for(let Nb=0;Nb<Q.Rules.length;++Nb){const Bc=Ln.Pao(Q.Rules[Nb]);jb[Bc.RuleId]=Bc}xa.AccessibilityRules=jb}if(Q.Violations){const Nb=Array(Q.Violations.length);for(jb=0;jb<Q.Violations.length;++jb)Nb[jb]=Mn.Nao(Q.Violations[jb]);xa.Results=Nb}xa.IsPartialResult=!1;xa.IsSuccess=!0}catch(Nb){ia.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Nb.message),xa.IsSuccess=!1}return xa}}Object(e.a)(po,
"WordAccessibilityCheckResult",null,[]);class ln extends Sj{constructor(Q,xa,jb){super(Q);this.YQb=xa;this.Lqb=jb}TCn(){const Q=Object.assign(new Fn.a,{Zr:eo.construct(this.fileId,this.Lqb),status:1,mH:"AccessibilityCheck"});this.YQb(12,!1,Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"),Q,null,Q)}zVk(Q){Q=Ma.b(Q);return po.Oao(Q)}}Object(e.a)(ln,"WordAccessibilityCheckService",Sj,[]);class Nn extends zi{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}zc(Q){super.zc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Rg(F.AFrameworkApplication.ya,vh.a.instance,ld.FocusManager.instance(),zg.a.instance,Q.Ze("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),uf.KeyInputManager.instance,Cm.a.instance,F.AFrameworkApplication.K.lb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new ln(()=>F.AFrameworkApplication.rootQuerySignature,wc.a.XP,vj.PageReader.instance.xGd(Ie.App.xa.jb.Xc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Hk(Ie.App.xa.jb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),Hm.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),F.AFrameworkApplication.ya,vq.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new pk(F.AFrameworkApplication.ya,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Ie.App.ik.ml,Gh.App.DOc)).singleInstance()}init(){Gh.App.uee&&this.container.resolve("Box4.IFeatureHelper").io.continueWith(()=>{zi.prototype.init.call(this)})}}Object(e.a)(Nn,"WordAccCheckerPackageManager",zi,[]);class gi{constructor(Q,xa){this.p3g=!1;this.Ndo=()=>{this.Mdo()};this.Zj=Q;this.mS=xa}wib(Q){Q.RW.E$j(this.Ndo)}Mdo(){!this.p3g&&this.Zj&&
(this.Zj.TCa?this.mS?this.mS.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ia.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.p3g=!0)}}Object(e.a)(gi,"CoauthSurveyManager",null,[1663]);class wq{constructor(){this.xt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){Ie.App.xa&&(this.xt=Ie.App.xa.jb)&&(this.xt.Xta?this.hha():this.xt.zda(()=>{this.hha()}))}hha(){var Q=this.xt.Xc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").wib(Q)}dispose(){}zc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new gi(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.$a("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){F.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&ca.a.instance.Pc(new wq)}}Object(e.a)(wq,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var wm;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(wm||(wm={}));Object(e.b)("ComponentLoggingScenario",wm);var Co=c(1408);class en{flush(Q,xa){const jb=this.orl(Q);jb.LoggingScenario=wm[xa];dg.a(jb).length?ia.ULS.sendTraceTag(594571986,3013,15,"{0}",jb):ia.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Co.a[Q.GWa])}orl(Q){const xa={};if(!Q)return xa;const jb=new hc.a;for(jb.enqueue(Q);!jb.isEmpty;){Q=jb.dequeue();const Nb=Co.a[Q.GWa];try{xa[Nb]=Q.vI()}catch(Bc){ia.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Nb.toString(),{["Kind"]:"Exception",["Stack"]:Bc.stack,["Message"]:Bc.message,["FileName"]:Bc.fileName,["LineNumber"]:Bc.lineNumber})}if((Q=Q.gwd)&&Q.length)for(let Bc of Q)!Bc||Co.a[Bc.GWa]in xa||jb.enqueue(Bc)}return xa}}
Object(e.a)(en,"ComponentStateLogManager",null,[1664]);class Sl{flush(){}}Object(e.a)(Sl,"NoOpComponentStateLogManager",null,[1664]);class sn{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}zc(Q){this.W=Q;F.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new en).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Sl).as("Common.IComponentStateLogManager").singleInstance()}static main(){ca.a.instance.Pc(new sn)}}Object(e.a)(sn,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Ym=c(1897);class rk{constructor(Q,xa,jb){this.rg=Q;this.smd=xa;this.sYg=jb}Mj(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg=null,og=!1,Ni=null,kk=null,mj=null,am=null,zj=!1){return this.sYg?this.smd.Mj(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,kk,mj):this.rg.Mj(Q,xa,jb,Nb,Bc,gd,
be,Bd,Xe,eg,og,Ni,kk,mj,am,zj)}O3b(Q){return this.sYg?this.smd.O3b():this.rg.O3b(Q)}}Object(e.a)(rk,"ClientRequestAdapter",null,[1002]);var Yl=c(184),Um=c(269),kj=c(267),fj=c(1360),km=c(285),cl=c(1372),Ig=c(1898),lm=c(54),Nm=c(726),xf=c(599),xj=c(128),mg=c(683),Vi=c(482),wl;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(wl||
(wl={}));Object(e.b)("MostRecentRevisionIdOrigin",wl);class Wi extends Sys.EventArgs{constructor(Q,xa,jb,Nb){super();this.Q8b=Q;this.S0m=xa;this.httpStatusCode=jb;this.oD=Nb}}Object(e.a)(Wi,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class gl{constructor(){this.n5=0}get isEmpty(){return!this.n5}vyc(Q){this.n5|=Q}dPc(Q){return!!(this.n5&Q)}clear(){this.n5=0}yAc(){return!1}}Object(e.a)(gl,"DocxSaveMonitorRetryAttemptOnce",null,[]);class pm{constructor(Q,xa=3){this.n5=0;this.Akd=new Map;this.KNj=
Q;this.wUj=xa}get isEmpty(){return!this.n5}vyc(Q){this.n5|=Q;let xa=this.Akd.get(Q)||0;this.Akd.set(Q,++xa)}dPc(Q){return!!(this.n5&Q)}clear(){this.n5=0;this.Akd.clear()}yAc(Q){return this.wUj&Q?(this.Akd.get(Q)||0)<this.KNj:!1}}Object(e.a)(pm,"DocxSaveMonitorRetryAttemptMany",null,[]);class Zm{static create(Q=!1,xa=3,jb=0){return Q?new pm(xa,jb):new gl}}Object(e.a)(Zm,"DocxSaveMonitorRetryAttemptFactory",null,[]);var mm=c(1637),Vm;(function(Q){Q[Q.zKo=-1]="noResultYet";Q[Q.yPo=0]="upToDate";Q[Q.jNo=
1]="sessionLost";Q[Q.EPo=2]="userSignedOut";Q[Q.WLo=3]="previousRequestPending";Q[Q.G4d=4]="requestFailed";Q[Q.FNo=5]="shuttingDown";Q[Q.EKo=6]="nullResponseData";Q[Q.SIo=7]="invalidResponseData";Q[Q.fHo=8]="failedRevisionLookup";Q[Q.PMo=9]="savedWithinThreshold";Q[Q.BKo=10]="notSavedWarning";Q[Q.iJo=11]="kickoutThreshold";Q[Q.jPo=12]="unknownRevision";Q[Q.pFo=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.jJo=17]=
"kickoutThreshold_Offline";Q[Q.qGo=18]="dssSessionDeleted";Q[Q.rGo=19]="dssSessionExpired";Q[Q.KPo=20]="waitingForSessionTokenRefresh";Q[Q.sGo=21]="dssSessionNotFound"})(Vm||(Vm={}));Object(e.b)("SaveMonitorResult",Vm);class Zg{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,Ni,kk,mj,am,zj,yn,Jk,iq,ar,Kk,Ag,nn,Dr,ms,Js=null,ns,Ks){this.csc=0;this.aSb=!1;this.Iuc=null;this.Iqc=this.cN=-1;this.CDe=null;this.bjd=0;this.cjd=!1;this.dsb=null;this.Ksc=0;this.pGe=this.u4g=null;this.xR=this.uPg=this.coe=0;this.Nxe=
null;this.BMg=!1;this.Dn=null;this.tmd=0;this.$nd=void 0;this.$ld=this.A1g=!1;this.SZg=0;this.Hbl=()=>{var ef;ia.ULS.sendTraceTag(524871194,Zg.Sn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.hX,["AppVisibilityState"]:fj.a[null===(ef=this.Dn)||void 0===ef?void 0:ef.YE]});ef=this.mrb;this.mrb=this.wy();if(this.YO())this.vz.event(5),this.stop("session has shut down");else{this.Z7a===Zg.cUi&&this.Xoa(this.IQb);var nm=this.qoc();if(nm)if(this.$ve()&&F.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),
this.hX)this.vz.event(0);else if(this.eSb())this.vz.event(1),this.stop("session is lost"),F.AFrameworkApplication.Ne("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.BMg&&!this.yhm()&&(ia.ULS.sendTraceTag(554726995,Zg.Sn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.ax(lm.a.MCh));else if(this.$ve())20!==this.vz.currentState?(this.vz.event(20),this.u4g=this.wy(),ia.ULS.sendTraceTag(593510691,Zg.Sn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.w4g)):this.wy().getTime()-this.u4g.getTime()>this.w4g&&(this.vz.event(14),this.$ld?this.HRd(20,lm.a.GEc,"TokenExpired"):(this.stop("Waited too long for session token to be refreshed"),this.ax(lm.a.GEc)));else if(this.LLj())if(this.mrb=ef,this.aSb)this.vz.event(3),this.wy().getTime()-this.Iuc.getTime()>this.Ywe&&(ef=this.Jke.O3b(this.cN),ia.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.cN,ch.a[ef]),this.mkd&&this.mkd.log(),this.stop("stuck on previousRequestPending"),
this.ax());else if(ef=xf.b(mm.a.construct(nm)),this.aSb=!0,this.Iuc=this.gUj(),this.cN=this.Jke.Mj(Zg.serviceUrl,2,ef,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.swk,this.rwk,null,void 0,void 0,this.jTj,this.VGe,void 0,void 0,!0),0>=this.cN)this.aSb=!1,ia.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.cN.toString());else{ef=this.Jke.O3b(this.cN);nm=100;if(ef&&1!==ef||this.cKg)nm=50;ia.ULS.sendTraceTag(19161612,Zg.Sn,nm,"DocxSaveMonitor: Sending Request {0}",
{["Id"]:this.cN,["Status"]:ch.a[ef]});this.mkd&&this.mkd.start(this.cN)}else this.vz.event(2);else this.vz.event(13)}};this.rwk=ef=>{this.xR=this.pwd+1;let nm=this.aSb=!1,on=!1;ef=ef.data;Oa.a.wl&&F.AFrameworkApplication.a7("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");ef?(ia.ULS.sendTraceTag(22552773,Zg.Sn,15,"Request failed {0}",{["Status"]:ef.status,["HttpStatus"]:ef.Df,["Correlation"]:ef.qj?ef.qj[km.a.Z5]:"",["Id"]:ef.id,["ConsecutiveErrors"]:this.pwd,["Request.InvokedTime"]:ef.gH,
["Request.EnqueueTime"]:ef.ZKa,["Request.CompletedTime"]:ef.HS}),on=7===ef.status||13===ef.status,this.yAc(2)&&on?(this.URa.vyc(2),nm=!0,this.Iqc=ef.Df,this.vz.event(16)):this.yAc(1)&&5===ef.status?(this.URa.vyc(1),nm=!0,this.Iqc=ef.Df,this.vz.event(15)):(this.vz.event(4),this.Iqc=ef.Df)):(this.vz.event(4),ia.ULS.sendTraceTag(23425240,Zg.Sn,15,"RequestFailed and event data is null"));if(!nm&&(this.URa.clear(),on?this.HRd(17,lm.a.v0k,"while offline"):this.HRd(11,lm.a.K5e,"while online")))return;this.Xoa(nm?
this.zkl(on):this.IQb)};this.swk=ef=>{this.xR=this.pwd+1;this.aSb=!1;var nm={};this.URa.clear();if(ef=ef.data){var on=ef.qj?ef.qj[km.a.Z5]:"";nm.HttpStatus=ef.Df;nm.Correlation=on;nm.Id=ef.id;ia.ULS.sendTraceTag(23425242,Zg.Sn,this.cKg?50:100,"Request succeeded at the HTTP level {0}",nm);this.Iqc=ef.Df}else ia.ULS.sendTraceTag(23425241,Zg.Sn,15,"Request succeeded with null response data");if(this.YO()||!this.hAd)this.vz.event(5),this.stop("session has shut down");else if(!this.vmm())if(ef&&ef.Ie)if(ef=
this.Fsa(ef.Ie))if(this.W8.Fmb(ef),ef.StatusCode)this.Jvf(ef,nm)||this.vz.event(8,nm);else{this.xR=0;this.mrb=this.wy();this.vFe.clear();nm={["LastSavedRevisionId"]:ef.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:ef.RevisionSequenceNumber};ef=xj.b(ef.LastSavedRevisionId);this.nec(ef,3);var Aa=this.hdf().store.getRevision(ef);if(Aa){ef=null;on=this.Sdb();Aa=(Aa=Aa.Ndb(on))?Aa.id:zf.a.nil;let Ta=on;for(;Ta&&!Ta.id.equals(Aa);)ef=Ta,Ta=Ta.hl;this.UVl(ef,nm,on)||this.vz.event(9)}else this.GUl()||
this.vz.event(12,nm);this.Xoa(this.uwc)&&ia.ULS.sendTraceTag(22552774,Zg.Sn,50,"Received response from server -- going back to normal interval")}else this.vz.event(7),this.Kvf("invalid response",nm);else this.vz.event(6),this.Kvf("null response",nm)};this.JAn=(ef,nm)=>{ef={};ef.DocxSaveMonitorState=Vm[nm.newState];ef.PreviousState=Vm[nm.uNf];ef.PreviousStateHits=nm.vNf;ef.PreviousStateTransitionTime=nm.wNf.toISOString();ef.LastHttpStatus=this.Iqc;ef.LastSuccessTime=this.mrb.toISOString();this.Iuc&&
(ef.LastRequestStartTime=this.Iuc.toISOString());ef.LastSavedRevisionID=this.pSc.toString();ef.LastSavedRevisionIdOrigin=this.csc;ef.LastSavedRevisionIdSetTime=this.pGe?this.pGe.toISOString():null;ef.IsViable=this.pf.zua;ef.IsNetworkConnected=this.pf.pK;ef.IsExpired=this.pf.PZ;ef.HasEmergencyViewModeBeenDeployed=this.pf.Tj;ef["Navigator.Online"]=window.navigator.onLine;const on=nm.V4n;on&&Zg.qsi(ef,on);nm=nm.newState;switch(nm){case 13:ia.ULS.sendTraceTag(5830086,Zg.Sn,50,"{0}",ef);break;case 1:ia.ULS.sendTraceTag(5884125,
Zg.Sn,50,"{0}",ef);break;case 0:ia.ULS.sendTraceTag(5830087,Zg.Sn,50,"{0}",ef);break;case 2:ia.ULS.sendTraceTag(5830088,Zg.Sn,50,"{0}",ef);break;case 3:ia.ULS.sendTraceTag(5830089,Zg.Sn,50,"{0}",ef);break;case 4:ia.ULS.sendTraceTag(5884126,Zg.Sn,50,"{0}",ef);break;case 5:ia.ULS.sendTraceTag(5884127,Zg.Sn,50,"{0}",ef);break;case 6:ia.ULS.shipAssertTag(5830090,Zg.Sn,!1,"{0}",ef);break;case 7:ia.ULS.shipAssertTag(5830091,Zg.Sn,!1,"{0}",ef);break;case 8:ia.ULS.sendTraceTag(5830092,Zg.Sn,15,"{0}",ef);
break;case 10:ia.ULS.sendTraceTag(5830094,Zg.Sn,15,"{0}",ef);break;case 9:ia.ULS.sendTraceTag(5884128,Zg.Sn,50,"{0}",ef);break;case 11:ia.ULS.sendTraceTag(5830096,Zg.Sn,15,"{0}",ef);break;case 17:ia.ULS.sendTraceTag(37835678,Zg.Sn,15,"{0}",ef);break;case 12:ia.ULS.sendTraceTag(5830095,Zg.Sn,15,"{0}",ef);break;case 18:ia.ULS.sendTraceTag(38122832,Zg.Sn,15,"{0}",ef);break;case 19:ia.ULS.sendTraceTag(38122833,Zg.Sn,15,"{0}",ef);break;case 21:ia.ULS.sendTraceTag(0,Zg.Sn,15,"{0}",ef);break;case 14:ia.ULS.sendTraceTag(6575508,
Zg.Sn,15,"{0}",ef);break;case 15:ia.ULS.sendTraceTag(36739287,Zg.Sn,50,"{0}",ef);break;case 16:ia.ULS.sendTraceTag(36767649,Zg.Sn,15,"{0}",ef);break;case 20:ia.ULS.sendTraceTag(593510690,Zg.Sn,15,"{0}",ef);break;default:ia.ULS.shipAssertTag(5884129,Zg.Sn,!1,"Bad state:{0} logInfo:{1}",nm,ef)}};this.uwc=Q;this.IQb=xa;this.Z7a=Q;this.J6g=jb;this.rWj=Nb;this.jTj=gd;this.VGe=be;this.mTb=Bd;this.mDg=Xe;this.Jke=eg;this.EY=og;this.W8=Ni;this.qoc=kk;this.LLj=mj;this.eSb=am;this.$ve=zj;this.YO=yn;this.wy=
Jk;this.gUj=iq;this.BMg=ms;this.URa=Zm.create(Ks.isEnabled,Ks.maxRetries,Ag.n5);this.vFe=new Vi.a;this.Rqe=nn;this.vz=new cl.a(-1);this.pf=Js;this.yv=ns;this.vz.WPe(this.JAn);this.mkd=ar;this.mrb=Jk();this.cKg=Kk;this.Zwj=Ks.isEnabled?null:Ag;this.qob=Dr;this.w4g=this.J6g;this.Lze=zf.a.nil;this.sa=new h.a;oa.a.instance.$a("Common.App.VisibilityManagement.IVisibilityManager").execute(ef=>{this.Dn=ef;this.Dn.$$a((nm,on)=>{this.A6(nm,on)});this.NDe=ef.YE});this.pf&&this.pf.FPe((ef,nm)=>{this.CGb(ef,
nm)});this.A1g=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportUpToDateKPI",!1):!1;this.Ywe=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",Bc):Bc;if(this.$ld=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWithSessionExpiredOnlyWhenVisible",!1):!1)this.SZg=F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.IQb);this.xUj=Ks}CGb(Q,xa){ia.ULS.sendTraceTag(528577692,Zg.Sn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Ig.a[xa.sFf],Ig.a[xa.HSc]);1!==xa.HSc&&3!==xa.HSc&&(ia.ULS.sendTraceTag(528566343,Zg.Sn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.URa.dPc(1),this.URa.dPc(2)),this.URa.clear())}get hAd(){return this.coe}get pSc(){return this.Lze}get hX(){const Q=!this.Sdb()||this.pSc.equals(this.Sdb().id);
this.Jxn(Q,this.yv.hX);Q||ia.ULS.sendTraceTag(521413851,Zg.Sn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Sdb().id.toString(),this.pSc.toString());return Q}get wfi(){return this.wy().getTime()-this.mrb.getTime()>this.Ywe}get pwd(){return this.xR}get GWa(){return 3}get gwd(){let Q=null;Ie.App.xa&&Ie.App.xa.jb&&Ie.App.xa.jb.Xc&&(Q=Ie.App.xa.jb.Xc.contentReplicator);return[Q,Gh.App.R_]}A6(Q,xa){var jb,Nb,Bc;Q={["VisibilityState"]:fj.a[this.Dn.YE],
["IsVisible"]:this.Dn.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.aSb,["KickoutIntervalElapsed"]:this.wfi,["LastSuccessfulIterationTime"]:null!==(jb=this.mrb)&&void 0!==jb?jb:"null",["RequestStartTime"]:null!==(Nb=this.Iuc)&&void 0!==Nb?Nb:"null",["SkippedKickouts"]:this.tmd,["LastSkippedKickoutAt"]:null!==(Bc=this.zPg)&&void 0!==Bc?Bc:"null"},["IsViable"]:this.pf.zua,["IsNetworkConnected"]:this.pf.pK,["IsExpired"]:this.pf.PZ,["HasEmergencyViewModeBeenDeployed"]:this.pf.Tj,["Navigator.Online"]:window.navigator.onLine};
ia.ULS.sendTraceTag(539874775,Zg.Sn,50,Ma.c(Q));this.NDe!=this.Dn.YE&&(this.$ld&&(0==xa.oldState||1==xa.oldState||0!==xa.newState&&1!==xa.newState||this.Xoa(this.SZg)),0===this.Dn.YE?(Ce.c(Vf.a.Plk,void 0,void 0,void 0,void 0,void 0,Q),this.$nd&&Ce.b("AvgTimeSpentOutsideOfWord",Date.now()-this.$nd,1),this.$nd=void 0):0===this.NDe&&(Ce.c(Vf.a.Qlk,void 0,void 0,void 0,void 0,void 0,Q),this.$nd=Date.now()),this.NDe=this.Dn.YE)}start(){this.coe=this.mDg.Jbb(this.Hbl,this.Z7a)}Xoa(Q){if(!this.hAd||this.Z7a===
Q)return!1;const xa=this.Z7a;this.Z7a=Q;this.stop("changing save monitor interval from "+xa+"ms to "+Q+"ms");this.start();return!0}nec(Q,xa){if(xa>=this.csc&&Q&&!zf.a.nil.equals(Q)){var jb=!this.Lze.equals(Q);this.csc=xa;this.Lze=Q;const Nb=this.wy();this.pGe=Nb;const Bc=this.hX;jb&&(xa={["Id"]:Q.toString(),["IsUpToDate"]:Bc,["Origin"]:wl[xa]},this.Nxe&&(xa.LastUpToDateTime=this.Nxe.toISOString()),(jb=this.hdf())&&jb.store&&(Q=jb.store.getRevision(Q))&&(xa.LastSavedCreationTime=Q.creationTime.toISOString()),
ia.ULS.sendTraceTag(557320151,Zg.Sn,50,"Updating Last Saved Revision: {0}",xa));Bc&&(this.Nxe=Nb)}else xa<this.csc?ia.ULS.sendTraceTag(572051800,Zg.Sn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.csc,xa):ia.ULS.sendTraceTag(572051801,Zg.Sn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',xa)}stop(Q){this.Ye(Q)}Ye(Q){this.hAd&&(ia.ULS.sendTraceTag(5830084,Zg.Sn,50,"Stopping DocxSaveMonitor because {0}!",Q),this.mDg.Ye(this.hAd),this.coe=0)}GUl(){if(0>=this.mTb)return!1;
var Q=this.Hgf();if(!Q)return this.CDe=null,this.bjd=0,this.cjd=!1;this.dsb=Q.bDd;this.dsb===this.CDe?this.bjd++:(this.CDe=this.dsb,this.bjd=1,this.cjd=!1);if(this.bjd<Zg.RKm)return!1;this.Ksc=+this.wy()-+this.dsb;if(this.Ksc<=this.mTb)return!1;if(!this.cjd)return this.cjd=!0,this.PKi(),!1;if(this.qob)this.qob.execute(xa=>{xa.flush(this,0)});else{Q="";try{this.Rqe&&(Q=this.Rqe())}catch(xa){Q=Ma.c({["Kind"]:"Exception",["Stack"]:xa.stack,["Message"]:xa.message,["FileName"]:xa.fileName,["LineNumber"]:xa.lineNumber}),
ia.ULS.sendTraceTag(50426817,Zg.Sn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}ia.ULS.sendTraceTag(50426818,Zg.Sn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.dsb.toISOString(),this.Ksc,this.mTb,Q)}this.mTb=-1;this.stop("Exceeded oldest allowed local revision");this.ax(lm.a.w0k);return!0}Hgf(){let Q=null,xa=this.Sdb();for(;xa&&!xa.tua;)Q=xa,xa=xa.hl;return Q}vmm(){return this.eSb()?
(this.vz.event(1),this.stop("session is lost"),!0):this.$ve()?(this.vz.event(14),ia.ULS.sendTraceTag(20029718,Zg.Sn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.ax(lm.a.GEc),!0):!1}hdf(){const Q=this.qoc();return Q?Q.Mc:null}Sdb(){const Q=this.hdf();return Q?Q.Am:null}yAc(Q){return this.xUj.isEnabled?this.URa.yAc(Q):this.Zwj.dPc(Q)&&!this.URa.dPc(Q)}zkl(Q){return Q?Zg.Hao:Zg.cUi}HRd(Q,xa,jb){if(this.wfi)if(this.Dn&&!this.Dn.isVisible)ia.ULS.sendTraceTag(540669727,Zg.Sn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.tmd+=1,this.zPg=this.wy();else return this.vz.event(Q,{}),this.stop("request failed after kickout interval "+jb),this.qob&&this.qob.execute(Nb=>{Nb.flush(this,2)}),this.ax(xa),!0;return!1}Jvf(Q,xa){const jb=Q.StatusCode;return 88===jb||89===jb||236===jb?(xa.KickoutDiagnostics=this.Rqe(),88===jb?(xa.Result="deleted DSS session",this.vz.event(18,xa),this.stop("deleted DSS session"),this.ax(lm.a.localCobaltDeletedSessionFault)):89===jb?(xa.Result="expired DSS session",this.vz.event(19,xa),this.stop("expired DSS session"),
this.ax(lm.a.localCobaltExpiredSessionFault)):(F.AFrameworkApplication.Vl("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=xj.b(Q.LastSavedRevisionId),this.nec(Q,4)),xa.Result="DSS session not found",this.vz.event(21,xa),this.stop("DSS session not found"),this.ax(lm.a.localCobaltSessionNotFound)),!0):14===jb?(this.stop("DSS returned an unspecified failure"),
this.ax(lm.a.Cxm),!0):104===jb?(this.stop("this operation is disabled on the server"),!0):this.Kvf("unrecognized OperationResult: "+jb,xa)}Kvf(Q,xa){if(!this.vFe.contains(Q))this.vFe.add(Q);else if(this.HRd(11,lm.a.K5e,Q))return xa.ConsecutiveErrors=this.pwd,xa.Reason=Q,ia.ULS.sendTraceTag(41997899,Zg.Sn,15,"DocxSaveMonitor kickout. {0}",xa),!0;this.Xoa(this.IQb);return!1}UVl(Q,xa,jb){let Nb=!1;if(Q){const Bc=this.wy().getTime()-Q.creationTime.getTime();Bc>=this.J6g&&(Nb=!0,Zg.qsi(xa,this.DIl(Q,Bc,
jb)),Bc>=this.Ywe&&10===this.vz.currentState?(this.vz.event(11,xa),this.stop("didn't save in time"),this.ax()):(this.vz.event(10,xa),this.PKi(),this.gaf()))}return Nb}v9j(Q){this.sa.addHandler(Zg.aHi,Q)}Kah(Q){this.sa.addHandler(Zg.oaf,Q)}BQi(Q){this.sa.removeHandler(Zg.oaf,Q)}PKi(){this.sa.raiseEvent(Zg.aHi)}Fsa(Q){let xa;return({group:xa}=mg.a.g8(Q)).returnValue?xa.Responses[0]:null}DIl(Q,xa,jb){const Nb={};Nb.FirstUnsavedRevisionId=Q.id.toString();Nb.FirstUnsavedRevisionLengthToRoot=Q.hO;Nb.UnsavedTimeInMs=
xa;Nb.CurrentRevisionId=jb.id.toString();Nb.CurrentRevisionLengthToRoot=jb.hO;return Nb}gaf(){wc.a.haf(8)}ax(Q=lm.a.K5e){this.rWj?(this.stop(Zg.mrm),Q===lm.a.GEc?this.EY.value.ax(Q,Object.assign(new Nm.a,{bka:4,R1:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,V9:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.EY.value.ax(Q,new Nm.a)):ia.ULS.sendTraceTag(19247383,Zg.Sn,50,"Kickout disabled")}vI(){const Q={};this.dsb&&(Q.ORT=this.dsb.toISOString());0<this.Ksc&&
(Q.AA=this.Ksc);0<this.mTb&&(Q.MAA=this.mTb);0<this.tmd&&(Q.LSKO=this.zPg.toISOString());this.vz&&0<=this.vz.currentState&&(Q.SMS=Vm[this.vz.currentState]);const xa={};F.AFrameworkApplication.Jma&&(xa.S=1);Ie.App.lostSession&&(xa.LS=1);this.pf&&(this.pf.Bo&&(xa.KO=1),this.pf.PZ&&(xa.TE=1));this.Dn&&(xa.VS=fj.a[this.Dn.YE]);window.navigator&&(xa.NW=!window.navigator.onLine);Q.AMD=xa;return Q}Svl(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};F.AFrameworkApplication.buildVersion&&
(Q["X-OfficeVersion"]=Pb.a.lQ(F.AFrameworkApplication.buildVersion));F.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Pb.a.lQ(F.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=F.AFrameworkApplication.zJa.toString());F.AFrameworkApplication.canary&&(Q["X-Key"]=Pb.a.lQ(F.AFrameworkApplication.canary));F.AFrameworkApplication.userType&&(Q["X-UserType"]=Pb.a.lQ(F.AFrameworkApplication.userType));const xa=F.AFrameworkApplication.af.h4;xa&&(Q["X-WacCluster"]=Pb.a.lQ(xa));F.AFrameworkApplication.userSessionId&&
(Q["X-UserSessionId"]=Pb.a.lQ(F.AFrameworkApplication.userSessionId));return Q}laf(){var Q=this.pf?this.pf.networkState:null;if(1===Q||3===Q)ia.ULS.sendTraceTag(558158790,Zg.Sn,15,"Not sending request because we dont have network.");else if(Q=this.qoc()){var xa=new Sys.Net.WebRequest;xa.set_httpVerb("POST");xa.set_url(Zg.serviceUrl);var jb={};jb.body=xf.b(mm.a.construct(Q));jb.headers=this.Svl();jb.method=xa.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(xa.getResolvedUrl(),jb).then(Nb=>
{ia.ULS.sendTraceTag(561551382,Zg.Sn,50,"Request succeeded at the HTTP level {0}",Nb.statusText);this.uPg=Nb.status;return Nb.json()},Nb=>{ia.ULS.sendTraceTag(561551383,Zg.Sn,15,"Request failed at the HTTP level {0}",Nb);return null}).then(Nb=>{Nb=JSON.stringify(Nb);this.hwk(Nb,this.uPg);return Nb},()=>{ia.ULS.sendTraceTag(561551385,Zg.Sn,15,"Request succeeded with null response data");return""}):ia.ULS.sendTraceTag(561002076,Zg.Sn,15,"Browser does not support Fetch.")}catch(Nb){ia.ULS.sendTraceTag(561551386,
Zg.Sn,15,String.format("Exception when attempting to get last revision save id : {0}",Nb))}}else ia.ULS.sendTraceTag(540079457,Zg.Sn,15,"Target node is null, not sending last saved revision request.")}hwk(Q,xa){let jb=zf.a.nil,Nb=!1,Bc=-1;xa===ul.a.yD&&((Q=this.Fsa(Q))?(jb=xj.b(Q.LastSavedRevisionId),Q.StatusCode||(Nb=!0,Bc=Q.StatusCode)):ia.ULS.sendTraceTag(561002077,Zg.Sn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(Zg.oaf,new Wi(jb,Nb,xa,Bc))}static qsi(Q,
xa){for(let jb in xa)Q[jb]=xa[jb]}yhm(){return Af.SessionStatusManager.instance.Bo}Jxn(Q,xa){if(this.A1g)if(La.Health.instance.recordKpiUsage(Zg.F8f,0,Zg.B1b,null),Q===xa)La.Health.instance.recordKpiSuccess(Zg.F8f,null);else{const jb=new Map;jb.set("DocxSaveMonitor",Q.toString());jb.set("RSNManager",xa.toString());jb.set("TimeSinceLastRSNUpdate",(+new Date-+this.yv.vli).toString());La.Health.instance.recordKpiFailure(Zg.F8f,"Inconsistency",!1,!1,Object.assign(new Bf.a,{extendedProperties:jb}))}}}
Zg.cUi=0;Zg.serviceUrl=Ie.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";Zg.mrm="kickout";Zg.aHi="PS";Zg.oaf="FLSR";Zg.Sn=343;Zg.RKm=5;Zg.Hao=5E4;Zg.F8f="UpToDate";Zg.B1b="wwrelfc";Object(e.a)(Zg,"DocxSaveMonitor",null,[1882,133]);class sp{Jbb(Q,xa){return window.setInterval(Q,xa)}Ye(Q){window.clearInterval(Q)}}sp.instance=new sp;Object(e.a)(sp,"DocxSaveMonitorTaskManager",null,[1662]);class Xi{constructor(Q){this.cN=0;this.bra=Q}start(Q){this.bra&&(this.cN=Q,this.bra.reset())}log(){if(this.bra){var Q=
{};Q.RequstId=this.cN;Q.InvokeCount=this.bra.YMc;Q.InvokeFailedCount=this.bra.ZMc;Q.NoOpenConnectionCount=this.bra.LSc;Q.SynchronousNotificationCount=this.bra.R1c;Q.ResponseNotAvailable=this.bra.RYc;ia.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(e.a)(Xi,"RequestLifeCycleTelemetryManager",null,[1661]);class Gn{constructor(){this.W=this.kGe=null;this.VOk=()=>{var Q=F.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var xa=Q.$("DocxSaveMonitorKickoutEnabled");
const jb=Q.rc("DocxSaveMonitorIntervalMs",6E4),Nb=Q.rc("DocxSaveMonitorFailureIntervalMs",5E3),Bc=Q.rc("DocxSaveMonitorWarningTimeMs",12E4),gd=Q.rc("DocxSaveMonitorKickoutTimeMs",3E5),be=Q.rc("DocxSaveMonitorQueueTimeoutMs",6E4),Bd=Q.rc("DocxSaveMonitorSentTimeoutMs",12E4),Xe=Q.rc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var eg=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const og=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Ni=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",
!1),kk=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||Ni;Ni=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var mj=F.AFrameworkApplication.af,am=kk?new Ym.a(F.AFrameworkApplication.userSessionId,mj.h4,mj.czh):null;am=new rk(mj,am,kk);eg=eg&&mj&&!kk?new Xi(mj.Rba):null;kk=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",
!1):!1;mj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const zj=Zm.create(kk,mj);zj.vyc(1);zj.vyc(2);Ni=Ni?this.W.$a("Common.IComponentStateLogManager"):null;xa=new Zg(jb,Nb,Bc,xa,gd,be,Bd,Xe,sp.instance,am,oa.a.instance.Ze("Box4.IKickoutExecutor"),Um.a.instance,this.f4b,()=>!F.AFrameworkApplication.YVd||zd.a.instance.fNc,()=>Ie.App.lostSession,Object(a.a)(Yl.a.instance,Yl.a.instance.Vza,"checkAndTriggerSessionHasExpired"),
()=>F.AFrameworkApplication.Tk,()=>new Date,()=>new Date,eg,og,zj,this.Jil,Ni,Q,oa.a.instance.Pa("Common.ISessionStatus")||Af.SessionStatusManager.instance,oa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),{isEnabled:kk,maxRetries:mj});xa.start();ia.ULS.sendTraceTag(5884131,Zg.Sn,50,"SaveMonitor initialized");return xa};this.f4b=()=>{const Q=Ie.App.xa.jb.Fc;return Q?Q.ld:null};this.Jil=()=>{const Q={};F.AFrameworkApplication.uc&&(Q.TM=F.AFrameworkApplication.uc.vI());kj.WoncaApp.yE&&
(Q.RS=kj.WoncaApp.yE.vI());Gh.App.R_&&(Q.CRS=Gh.App.R_.vI());Ie.App.xa&&Ie.App.xa.jb&&Ie.App.xa.jb.Xc&&Ie.App.xa.jb.Xc.contentReplicator&&(Q.GSR=Ie.App.xa.jb.Xc.contentReplicator.vI());F.AFrameworkApplication.Jma&&(Q.S=1);Ie.App.lostSession&&(Q.LS=1);Ie.App.vd&&Ie.App.vd.cB.Bo&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Ie.App.zs||Ie.App.Fm)this.kGe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.kGe&&
this.kGe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}zc(Q){this.W=Q;(Ie.App.zs||Ie.App.Fm)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.VOk).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){ca.a.instance.Pc(new Gn)}}Object(e.a)(Gn,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Hl;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(Hl||(Hl={}));Object(e.b)("FirstRunExperienceVersion",Hl);class ma{get eRe(){return"Word"}get Ukh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Hl.version0}get currentVersion(){return Hl.version1}get fdm(){return ma.isEnabled()&&
F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get h8b(){return ma.isEnabled()&&F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get Cji(){return F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get ldl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Rsi(){return 24}get OUi(){return 4E3}get fZc(){return""}static isEnabled(){const Q=F.AFrameworkApplication.sessionStartInfoSettings?
F.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(e.a)(ma,"FirstRunExperienceLauncherSettings",null,[1695]);class bb{constructor(Q){this.ZFg=Q}GZn(Q){this.ZFg&&this.ZFg.HZn(Q)}}Object(e.a)(bb,"FirstRunExperienceManager",null,[1693]);class Ab{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}zc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new bb(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=
this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.GZn(new ma)}dispose(){}}Object(e.a)(Ab,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class ac{constructor(Q,xa,jb){this.FJi=(Nb,Bc,gd,be,Bd)=>{if(1===gd)return 32;switch(Nb){case Vf.a.GJi:Bd[vi.a.On]=1===this.CHa.Sbb;break;case Vf.a.HJi:Bd[vi.a.On]=2===this.CHa.Sbb}return 32};this.woa=(Nb,Bc,gd,be,Bd)=>{if(1===gd)return 32;if(2===gd){Bc=this.CHa.ih.isVisible;this.CHa.aB(!0,1===Bd);gd=0;switch(Nb){case Vf.a.Z0f:Bd=
1;break;case Vf.a.$0f:Bd=2;break;case Vf.a.S8d:Bd=2;gd=1;break;case Vf.a.T8d:Bd=1;gd=2;break;case Vf.a.U8d:Bd=1;gd=3;break;case Vf.a.pbe:Bd=this.CHa.Sbb;this.RNg&&!Bd&&(Bd=1);break;default:gd=Bd=0}Bc&&Nb===Vf.a.woa||this.CHa.BMn(Bd,gd);return 32}return 8};this.rLd=(Nb,Bc,gd,be,Bd)=>{this.toggleButton(Bd,!1);return this.cAk(gd)};this.pbe=(Nb,Bc,gd,be,Bd)=>this.CHa.ih.isVisible?this.rLd(Nb,Bc,gd,be,Bd):this.woa(Nb,Bc,gd,be,Bd);this.ga=Q;this.CHa=xa;this.RNg=jb}dispose(){this.CHa&&this.CHa.dispose()}Vb(){this.ga.pa(Vf.a.pbe,
ti.a.view,this.pbe);this.ga.gb(Vf.a.woa,ti.a.view,this.woa,4);this.ga.pa(Vf.a.rLd,ti.a.view,this.rLd);this.ga.gb(Vf.a.S8d,ti.a.view,this.woa,4);this.ga.pa(Vf.a.T8d,ti.a.view,this.woa);this.ga.pa(Vf.a.U8d,ti.a.view,this.woa);this.RNg&&(this.ga.gb(Vf.a.GJi,ti.a.view,this.FJi,96),this.ga.pa(Vf.a.Z0f,ti.a.view,this.woa),this.ga.gb(Vf.a.HJi,ti.a.view,this.FJi,96),this.ga.pa(Vf.a.$0f,ti.a.view,this.woa))}cAk(Q){if(1===Q)return 32;this.CHa.aB(!1);return 32}toggleButton(Q,xa){Q&&(Q[vi.a.On]=xa)}}Object(e.a)(ac,
"FormatPictureActor",null,[10]);class sc{constructor(Q){this.nub=!1;this.ih=Q}get Sbb(){return this.ih.fRk}BMn(Q,xa){switch(Q){case 0:case 1:this.ih.D_n(xa);break;case 2:this.ih.O_n(xa)}}aB(Q,xa=!1){this.nub||this.eof();Q?this.ih.tO(xa):this.ih.$la()}dispose(){this.ih.dispose()}eof(){this.nub||(this.ih.initialize(),this.nub=!0)}}Object(e.a)(sc,"FormatPictureManager",null,[1887,10]);var Sc=c(373),Cd=c(106),ke=c(335);class Dd{}Dd.AO=ke.a.WDd;Dd.Jac=1;Dd.$ib=WordEditorIntl.WordEditorStrings.L_FormatPicture;
Dd.Bsa="FormatPictureTaskPaneData";Object(e.a)(Dd,"FormatPicturePaneConstants",null,[]);class $d{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)($d,"FormatPictureTaskPaneProps",null,[]);class mf{constructor(Q,
xa,jb,Nb){this.zGe=0;this.rmc=this.zja=null;this.Nkd=this.Ekd=this.qfd=this.x7c=this.pod=0;this.xu=this.aQb=!1;this.qme=0;this.IZm=()=>{this.A_i()};this.xl=()=>{let Bc=!1;Bc=this.Een()||Bc;Bc=this.c2a()||Bc;Bc=this.b2a()||Bc;Bc=this.Ibc()||Bc;(Bc=this.Aen()||Bc)&&this.om()};this.pP=Q;this.uMj=xa;this.Txe=jb;this.kg=Nb}initialize(){this.fZ();this.eha()}get isVisible(){return this.xu}tO(Q){this.K0c(Q)}$la(){this.vba();this.$Zl()}D_n(Q){this.R1i(Q,1)}O_n(Q){this.R1i(Q,2)}R1i(Q,xa){this.qme=xa;this.zGe=
Q}get fRk(){return this.qme}dispose(){}fZ(){this.pP.FKa();this.zGe=this.qme=0}get $h(){return this.uMj.value}get wc(){return this.Txe.value}Z_a(){return!!this.$h.pg&&this.$h.pg.name===Dd.AO}A_i(){this.$h.Kg(Dd.AO)}eha(){const Q=this.$h.re(Dd.AO);Q.parent=Ii.AFrame.Qp;Q.wda(this.IZm)}vba(){this.Z_a()&&this.$h.Kg(this.$h.NS)}K0c(Q){dd.UISurfaces.fu().then(xa=>{xa.showTaskPane(Dd.AO,this.AB(Q));this.isVisible&&Q&&this.$h.Kg(Dd.AO);return null})}om(){dd.UISurfaces.fu().then(Q=>{Q.updateTaskPane(Dd.AO,
this.AB(!1));return null})}$Zl(){dd.UISurfaces.fu().then(Q=>{Q.hideTaskPane(Dd.AO,2);return null})}AB(){const Q=new $d;this.CTn(Q);return Object.assign(new rn.a,{title:Dd.$ib,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:xa=>{this.xu=!0;Ie.App.xa.GVa(this.xl);Ie.App.xa.updateCommandUI();this.A_i();this.kg.nyc(Dd.AO,xa)},onClose:()=>{this.vba();this.xu=!1;Ie.App.xa.ycc(this.xl);Ie.App.xa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}CTn(Q){const xa=
hg.e().numberFormatInfo;Q.section=this.zGe;Q.numberFormatInfo="object"===typeof xa?xa:null;Q.title=this.zja;Q.description=this.rmc;Q.topCrop=this.pod;Q.bottomCrop=this.x7c;Q.leftCrop=this.qfd;Q.rightCrop=this.Ekd;Q.rotationAngle=this.Nkd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.aQb}onTitleChange(){return Q=>{if(Q!==this.zja){this.zja=
Q;var xa=new Sc.DictionaryPropertySet;xa.setValue(Cd.a.mfb,Q);this.wc.Xb(di.a.q_c,2,xa);this.om()}}}onDescriptionChange(){return Q=>{if(Q!==this.rmc){var xa=new Sc.DictionaryPropertySet;xa.setValue(Cd.a.PW,Q);this.rmc=Q;this.wc.Xb(di.a.fKb,2,xa);this.om()}}}onCropSpinButtonChange(){return(Q,xa)=>{const jb=new Sc.DictionaryPropertySet;switch(xa){case 0:this.pod=Q;jb.setValue(Cd.a.rfb,Q);this.wc.Xb(Vf.a.OLc,2,jb);break;case 1:this.x7c=Q;jb.setValue(Cd.a.ofb,Q);this.wc.Xb(Vf.a.LLc,2,jb);break;case 2:this.qfd=
Q;jb.setValue(Cd.a.pfb,Q);this.wc.Xb(Vf.a.MLc,2,jb);break;case 3:this.Ekd=Q,jb.setValue(Cd.a.qfb,Q),this.wc.Xb(Vf.a.NLc,2,jb)}this.om()}}onRotationSpinButtonChange(){return Q=>{this.Nkd=Q;const xa=new Sc.DictionaryPropertySet;xa.setValue(Cd.a.TLc,0);xa.setValue(Cd.a.jK,Q);this.wc.Xb(di.a.imageRotate,2,xa);this.om()}}Een(){const Q=2===this.wc.Xb(di.a.q_c,1,null),xa=Q!==this.aQb;this.aQb=Q;return xa}c2a(){var Q=new Sc.DictionaryPropertySet;this.wc.Xb(di.a.c2a,2,Q);Q=Q.ia(Cd.a.mfb,"");const xa=Q!==this.zja;
this.zja=Q;return xa}b2a(){var Q=new Sc.DictionaryPropertySet;this.wc.Xb(di.a.b2a,2,Q);Q=Q.ia(Cd.a.PW,"");const xa=Q!==this.rmc;this.rmc=Q;return xa}Ibc(){var Q=new Sc.DictionaryPropertySet;this.wc.Xb(Vf.a.hWc,2,Q);const xa=Q.ia(Cd.a.rfb,0),jb=Q.ia(Cd.a.ofb,0),Nb=Q.ia(Cd.a.pfb,0);Q=Q.ia(Cd.a.qfb,0);const Bc=xa!==this.pod||jb!==this.x7c||Nb!==this.qfd||Q!==this.Ekd;this.pod=xa;this.x7c=jb;this.qfd=Nb;this.Ekd=Q;return Bc}Aen(){var Q=new Sc.DictionaryPropertySet;this.wc.Xb(di.a.sIb,2,Q);Q=Q.ia(Cd.a.jK,
0);const xa=Q!==this.Nkd;this.Nkd=Q;return xa}}Object(e.a)(mf,"ReactFormatPicturePane",null,[1660,10]);class jg{constructor(){this.Uad=this.W=null}get name(){return"WordEditor.FormatPicture"}zc(Q){this.W=Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new sc(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"),Gh.App.Gnj)).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new mf(Cm.a.instance,new tb.a(()=>ld.FocusManager.instance()),new tb.a(()=>
F.AFrameworkApplication.ya),vh.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new ac(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"),Gh.App.Gnj)).singleInstance()}init(){if(Gh.App.Aee||Gh.App.Vag)this.Uad=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Uad.Vb(),Ie.App.xa.updateCommandUI()}dispose(){this.Uad&&this.Uad.dispose()}static main(){ca.a.instance.Pc(new jg)}}Object(e.a)(jg,"WordEditorFormatPicturePackage",
null,[1,2]);class ge{constructor(){this.cRb=this.Huc=null;this.hkd=0}get name(){return"WordEditor.FrameTiming"}zc(){F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfFrameTimingMeterDisabled",!1)||(this.cRb=new EventTiming.FrameTimingMeter,this.hkd=F.AFrameworkApplication.K.rc("FrameTimingMeterReportingIntervalInSeconds",60),0>=this.hkd&&(this.hkd=60),this.Huc=Q=>{(Q=Q.rawEvent)&&ia.ULS.sendTraceTag(24962208,306,50,Ma.c(Q.detail))},H.a.addHandler(window.self,
A.a.XRi,this.Huc))}init(){this.cRb&&this.cRb.start(this.hkd)}dispose(){this.cRb&&(this.cRb.stop(),this.cRb=null);this.Huc&&(H.a.removeHandler(window.self,A.a.XRi,this.Huc),this.Huc=null)}static main(){ca.a.instance.Pc(new ge)}}Object(e.a)(ge,"FrameTimingPackageManager",null,[1,2]);var ng=c(1434),Sg=c(564);class qj extends gk.a{constructor(){super();this.Prompt=0;this.FileId=null}Tl(){return 100}static construct(Q,xa){const jb=new qj;jb.FileId=Q;jb.Prompt=xa;return jb}}Object(e.a)(qj,"GraphMergeConsentChangedRequest",
gk.a,[]);var wi=c(588);class Ki extends wi.a{constructor(){super();this.Location=this.FileId=null}Tl(){return 34}static construct(Q,xa){const jb=new Ki;jb.FileId=Q;jb.Location=xa;return jb}}Object(e.a)(Ki,"PlayGraphMergeReplayRequest",wi.a,[]);class Zi{constructor(Q,xa,jb,Nb,Bc,gd=null,be=null){this.Cl=!1;this.XM=null;this.x0g=this.Cwe=!1;this.kZe=()=>{if(this.kxa.$Kd)this.Cwe=!0;else if(this.Cwe=!1,!this.HIn){this.x0g=!0;var Bd=this.yGa.Bva;ia.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",
400===Bd);if(100===Bd||400===Bd)Bd=qj.construct(this.MR(),Bd),this.iy(Bd)}};this.t4h=(Bd,Xe)=>{Xe&&Xe.vAf&&Xe.vAf.p0e&&!this.kxa.Gji&&(this.kxa.fhj(),this.kxa.$Kd=!0,this.iy(Xe.vAf.p0e))};this.r4h=(Bd,Xe)=>{Xe&&Xe.U4c&&this.kxa.fhj()};this.s4h=(Bd,Xe)=>{Xe&&(Xe.ShowMergePrompt&&this.yGa.CSi(this.kZe),F.AFrameworkApplication.kh&&(F.AFrameworkApplication.kh.SessionMergeInfo|=Xe.PartMergeInfo))};this.MR=Q;this.Npd=jb;this.kxa=Nb;this.yGa=Bc;this.Npd&&this.Npd.d9j(this.t4h);this.W8=gd||Um.a.instance;
if(!be){const Bd=new Sg.a;be=Xe=>Bd.sla(0,Xe)}this.Cyj=be}get Bpm(){return this.Cwe}get HIn(){return this.x0g}iy(Q){const xa=new Fn.a;xa.Zr=Q;xa.status=1;xa.mH="GraphMerge";const jb=this.Cyj(()=>{this.QYc(xa,33===Q.Tl())});jb.QJ(xa);jb.qW()}QYc(Q,xa){this.Cl||(xa&&(this.kxa.$Kd=!1),2===Q.statusCode&&!W.a.QDb(Q.hk)&&1===Q.hk.length&&Q.hk[0]?(Q=Q.hk[0],Q.StatusCode?this.kxa.sZf():xa&&this.yGa.CSi(this.kZe),this.W8.Fmb(Q),this.Bpm&&this.kZe()):this.kxa.sZf())}wib(Q){this.XM=Q;this.XM.xXb(this.r4h);this.XM.yXb(this.s4h)}dispose(){this.Cl||
(this.Npd&&this.Npd.iun(this.t4h),this.XM&&(this.XM.YIb(this.r4h),this.XM.dYc(this.s4h)),this.Cl=!0)}}Object(e.a)(Zi,"GraphMergeBackupManager",null,[1690,10]);class eh{constructor(Q,xa=null,jb=null,Nb=null){this.Qie=0;this.sve=!1;this.HOg=new Date(0);this.$Kd=!1;this.yGa=Q;this.wy=xa||(()=>new Date);jb||(jb=F.AFrameworkApplication.K?F.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.hOj=jb;Nb||(Nb=F.AFrameworkApplication.K?F.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxBackups",
1):1);this.sRg=Nb}get iom(){return+this.wy()-+this.HOg<this.hOj}get Gji(){return 500===this.yGa.Bva?!1:100===this.yGa.Bva?!0:this.sve||this.$Kd||this.iom}fhj(){this.HOg=this.wy();this.Qie++;this.Qie>=this.sRg&&this.sZf()}sZf(){this.sve||(this.sve=!0,ia.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.Qie,this.sRg))}}Object(e.a)(eh,"GraphMergeBackupThrottler",null,[1689]);class Zl{constructor(Q,xa,jb=null){this.dIg=!1;
this.SU=Q;this.JEj=xa;null==jb&&(jb=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.UDe=jb?500:300}get Bva(){return this.UDe}CSi(Q){if(!this.dIg&&300===this.Bva){var xa=this.JEj.value;xa&&xa.isFeatureEnabled(50)&&(this.dIg=!0,this.SU.execute(jb=>{jb.RZn(()=>{this.IEk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.Bva&&(ia.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.UDe=100,Q());
this.$Oi()}IEk(Q){300===this.Bva&&(ia.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.UDe=400,Q());this.$Oi()}$Oi(){this.SU.execute(Q=>{Q.TZl()})}}Object(e.a)(Zl,"GraphMergeCollectionConsentManager",null,[1688]);class nl extends Sys.EventArgs{constructor(Q){super();this.vAf=Q}}Object(e.a)(nl,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var mb=c(835),nc=c(710),Wc=c(1006),vd=c(638),Md=c(1682),tf=c(1680),If=c(216),fg=c(149);class ea{constructor(Q,xa,jb,
Nb,Bc,gd){this.GOf=this.zg=null;this.xPc=this.xag=!1;this.Lk=null;this.v0c=Q.runtime.v0c;this.ap=Q;this.$d=xa;this.Rg=jb;this.an=Nb;this.sEk=Bc;this.graphNodeComplexMerge=gd}}Object(e.a)(ea,"GraphNodeComplexMergeState",null,[]);var Ua=c(1498),sb=c(1484);class Lb{constructor(Q,xa=null){this.Pg=Q;this.YSb=xa||this.RIc()}get Lhb(){return this.YSb}get $d(){return this.Pg}RIc(){return[Object(a.a)(this,this.e1n,"simpleMerge"),Object(a.a)(this,this.JDk,"complexMerge")]}GTn(Q,xa,jb,Nb,Bc,gd){xa=new ea(Q,
jb,new tb.a(()=>new Ua.a(Nb?Nb.gm:null,Bc)),new tb.a(()=>new Ua.a(Nb?Nb.gm:null,gd)),new tb.a(()=>new Ua.a(gd,Bc)),xa.ivh(Bc,()=>Q.runtime.Wb));xa.zg=Nb.hWb;xa.GOf=new If.a;return xa}merge(Q,xa,jb,Nb,Bc,gd){xa=this.GTn(Q,xa,jb,Nb,Bc,gd);jb=!0;for(Nb=0;Nb<this.Lhb.length&&jb;Nb++)(jb=(0,this.Lhb[Nb])(xa))||Q.logger.OTd("GraphNodeMerge.GetMergeFunctions()",Nb);if(Q=xa.xPc&&xa.Lk?new sb.a(xa.Lk,!1):null)switch(Q.aSn(xa.zg),(Q?Q.gm:Bc).Qc){case 1074135145:xa.ap.runtime.a3d.QFk.Z(Q.gm.id,Q.gm);break;case 1074135153:xa.ap.runtime.a3d.Gkk.Z(Q.gm.id,
Q.gm);break;case 1074135127:xa.ap.runtime.a3d.ECk.Z(Q.gm.id,Q.gm);break;case 393230:xa.ap.runtime.gVd.add(Q.gm.id)}return{returnValue:xa.xPc,Lk:Q}}e1n(Q){if(Q.ap.runtime.Wb&&Q.ap.runtime.Wb.NBb(1000005)&&0<Q.zg.count)return!0;var xa=Q.graphNodeComplexMerge.j1d;return Q.an.value.DNc(xa)&&Q.sEk.value.DNc(xa)?Q.Rg.value.DNc(xa)?!0:(xa=Q.an.value.Ef,Q.xPc=!0,Q.Lk=xa.OG(),!1):(Q.xPc=!0,!1)}JDk(Q){const xa=Q.an.value.Ef;Q.v0c&&fg.a.instance.Sa(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
xa.id,xa.Qc);const jb=Q.graphNodeComplexMerge.G7f(Q);Q.xPc=jb;fg.a.instance.Sa(4018184,1,jb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",jb?"Succeeded":"Failed",xa.id,xa.Qc,!!Q.Lk);return jb}}Object(e.a)(Lb,"GraphNodeMerge",null,[1867]);class rc extends gk.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}Tl(){return 33}static construct(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og){const Ni=new rc;Ni.FileId=Q;Ni.BaseRevisions=xa;Ni.TheirRevisions=jb;Ni.YourRevisions=Nb;Ni.IgnoreConflictsInLastServerRevision=Bc;Ni.MergeHint=gd;Ni.ObjectSpaceId=be?xj.a(be):null;Ni.RequestId=Bd?xj.a(Bd):null;Ni.Source=Xe;Ni.Reason=eg;Ni.Prompt=og;return Ni}}Object(e.a)(rc,"CreateGraphMergeReplayRequest",gk.a,[]);var Rc=c(800),pd=c(249),Sd=c(16),ce=c(1783),gf=c(1824);class se{constructor(Q,
xa=null,jb=null){this.z_k=(Nb,Bc)=>{let gd=Nb;var be=Bc,Bd=this.O8a.get(Nb);if(!Bd)return{nEa:gd,nJb:be};be=new If.a;be.add(Bd);var Xe=this.Orb.get(Nb)||this.EE.J(Nb);Bd=new If.a;Bd.add(Xe);Xe=new If.a;Xe.add(this.EE.J(Nb));ia.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.FG.kkf,this.FG.c3,this.vVh(Bd),this.vVh(be));var eg=this.KVh(this.FG.c3);this.Hcl(eg,Nb,be);Bd=new ce.a(eg,Xe,1===eg.input.c3?
Bd:be,1===eg.input.c3?be:Bd,this.KVh(1),Bd,be);be=new If.a;for(Xe=0;Xe<Bc.length;Xe++){this.FG.hG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const og=({C2a:gd,aoa:eg}=Bd.F3c(Nb,Bc.J(Xe))).returnValue;be.add(eg);og?ia.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Nb,Bc.J(Xe),gd,eg):ia.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Nb)}return{nEa:gd,nJb:be}};this.FG=Q;this.EE=Q.lk;this.O8a=Q.M$n;this.Orb=Q.myo;this.eNj=Q.Bxm;this.Pg=xa||new Wc.a;this.GRj=jb||this.z_k}yEc(Q){const xa=new If.a;for(let jb=0;jb<Q.length;jb++){const Nb=this.q_k(Q.J(jb));xa.add(Nb)}return xa}xEc(Q,xa,jb){const Nb=Q.su===Q.Oz&&Q.startCp===Q.endCp;xa&&({nEa:Q.su,aoa:Q.startCp}=this.WQa(Q.su,Q.startCp,Q.su),Nb&&(Q.Oz=Q.su,Q.endCp=Q.startCp));jb&&!Nb&&({nEa:Q.Oz,aoa:Q.endCp}=this.WQa(Q.Oz,Q.endCp,Q.Oz));return Q}q_k(Q){if(Q.su===Q.Oz){var xa=new If.a;
xa.add(Q.startCp);xa.add(Q.endCp);({nEa:Q,nJb:xa}=this.M9f(Q.su,xa));return new Rc.a(Q,xa.J(0),Q,xa.J(1))}xa=new If.a;var jb=new If.a;let Nb;xa.add(Q.startCp);({nEa:xa,nJb:Nb}=this.M9f(Q.su,xa));jb.add(Q.endCp);({nEa:Q,nJb:jb}=this.M9f(Q.Oz,jb));return new Rc.a(xa,Nb.J(0),Q,jb.J(0))}M9f(Q,xa){let jb=Q,Nb=xa;if(!this.EE.J(Q))return ia.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{nEa:jb,
nJb:Nb};if(this.O8a.get(Q))({nEa:jb,nJb:Nb}=this.GRj(Q,xa,jb,Nb));else if(this.FG.qnf&&!this.FG.qnf.J(this.FG.qnf.length-1).Q2(Q)){Nb=new If.a;for(let Bc=0;Bc<xa.length;Bc++){let gd;({nEa:jb,aoa:gd}=this.WQa(Q,xa.J(Bc),jb));Nb.add(gd)}}return{nEa:jb,nJb:Nb}}vVh(Q){let xa="";Q.forEach(jb=>{xa+=jb.w2c();xa+=" ";return!0});return xa}KVh(Q){const xa=oa.a.instance.Pa("Box4.IFeatureHelper"),jb=new gf.a;jb.input.source=this.FG.kkf;jb.input.c3=this.FG.c3;jb.input.cGc=()=>xa;jb.runtime.lk=this.EE;jb.runtime.dAa=
this.FG.gDk;1===Q?(jb.runtime.du=this.Orb,jb.runtime.nq=this.O8a,jb.runtime.kCd=this.FG.kli,jb.runtime.Cce=this.FG.Bli):2===Q&&(jb.runtime.du=this.O8a,jb.runtime.nq=this.Orb,jb.runtime.kCd=this.FG.Bli,jb.runtime.Cce=this.FG.kli);jb.runtime.Wb=xa;return jb}Hcl(Q,xa,jb){if(Q.runtime.du.ub(pd.a.KK)){var Nb=Q.runtime.du.J(pd.a.KK);Nb=this.Pg.getPropertyObjectIds(Nb,Xk.a.c0);if(1===Nb.length&&(Nb=Nb.J(0),Q.runtime.du.ub(Nb)&&(Nb=Q.runtime.du.J(Nb),3===this.Pg.getPropertyInt32(Nb,Xk.a.Bmb)))){const Bc=
this.Pg.getPropertyString(Nb,Xk.a.Gha),gd=this.Pg.getPropertyString(Nb,Xk.a.JMb);xa.toString()===Bc&&Bc===gd&&(xa=this.Pg.getPropertyObjectId(Nb,Xk.a.H3c),Q.runtime.du.ub(xa)&&jb.add(Q.runtime.du.J(xa)))}}}MEl(Q,xa){let jb=0;for(let Nb=0;Nb<Q.length;Nb++)if(xa.equals(Q.J(Nb)))return jb=Nb,{returnValue:!0,idx:jb};return{returnValue:!1,idx:jb}}WQa(Q,xa){const jb=this.eNj&&!!this.Orb.J(Q)&&!this.EE.J(Q);let Nb=Q,Bc=xa,gd=!1,be=!1;(jb?this.Orb:this.O8a).forEach((Bd,Xe)=>{this.FG.hG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.Osf(Xe.Qc)&&this.EE.J(Bd)){Xe=null;if(jb){Xe=this.nJc(og=>this.Orb.J(og)||this.EE.J(og),Bd);var eg=this.UPd(Xe,Q)}else eg=this.nJc(og=>this.EE.J(og),Bd),eg=this.UPd(eg,Q);if(eg&&(be=!0,Xe||(Xe=this.nJc(og=>this.Orb.J(og)||this.EE.J(og),Bd)),Bd=this.nJc(og=>this.O8a.J(og)||this.EE.J(og),Bd),eg=0,({idx:eg}=this.MEl(Xe,Q)).returnValue)){for(let og=eg+1;og<Xe.length;og++)if(this.UPd(Bd,Xe.J(og)))return Bc=0,Nb=Xe.J(og),gd=!0,!1;for(--eg;0<=eg;eg--)if(this.UPd(Bd,Xe.J(eg)))return Bc=Number.MAX_VALUE,
Nb=Xe.J(eg),gd=!0,!1}}return!0});gd||(ia.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,xa,jb,be),5===this.FG.kkf&&(ia.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Nb),({PJh:xa}=this.gul()).returnValue?(Nb=xa,Bc=0,ia.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Nb)):ia.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Nb)));return{nEa:Nb,aoa:Bc}}gul(){let Q=zf.a.nil,xa=new If.a;this.O8a.forEach((jb,Nb)=>{this.FG.hG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.Osf(Nb.Qc)?(xa=this.nJc(Bc=>this.O8a.J(Bc)||this.EE.J(Bc),jb),!1):!0});return 0<xa.length?(Q=xa.J(0),{returnValue:!0,PJh:Q}):{returnValue:!1,PJh:Q}}Osf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}nJc(Q,xa){var jb=Q(xa);xa=new If.a;if(!this.Osf(jb.Qc))return xa;jb=this.Pg.getPropertyObjectIds(jb,Sd.a.$e);for(let Nb=0;Nb<jb.length;Nb++){const Bc=new If.a;this.$gf(Q,jb.J(Nb),Bc);xa.IA(xa.length,Bc)}return xa}$gf(Q,xa,jb){var Nb=Q(xa);if(Nb)if(393230===Nb.Qc)jb.add(xa);else if(393229===
Nb.Qc)xa=this.Pg.getPropertyObjectIds(Nb,Sd.a.gI).mg(0),this.$gf(Q,xa,jb);else if(393250===Nb.Qc||393251===Nb.Qc||393252===Nb.Qc)for(xa=this.Pg.getPropertyObjectIds(Nb,Sd.a.$e),Nb=0;Nb<xa.length;Nb++)this.$gf(Q,xa.J(Nb),jb)}UPd(Q,xa){for(let jb=0;jb<Q.length;jb++)if(xa.equals(Q.J(jb)))return!0;return!1}}Object(e.a)(se,"GraphMergeSelectionRecordUpdater",null,[]);class Gf extends Md.a{constructor(Q=null,xa=null,jb=null,Nb=null,Bc=null,gd=null,be=null,Bd=null,Xe=-1,eg=null,og=null,Ni=null){super();this.Fwh=
kk=>{const mj=kk.N1,am=Ie.App.xa.jb.Xc;return new mb.a(kk,mj,am.Ad,am.fileId,am.TIb,am.contextId,mj?mj.id:zf.a.nil,this.pUi,!1,!0)};this.MR=Q||(()=>F.AFrameworkApplication.rootQuerySignature);xa||(xa=kk=>new nc.a(kk));this.XZg=xa;this.Pg=jb||new Wc.a;this.ezg=be||new tf.ChildNodeListMerge(this.$d);this.wUb=Bd;this.pUi||(this.wUb=(kk,mj,am)=>new vd.a(kk,mj,am));this.YSb=Nb||this.RIc();this.B7a=Bc||new mh.a;this.NHg=gd||new Lb(this.$d);this.xRg=void 0===Xe||null===Xe||-1===Xe?Gh.App.Hnj:Xe;this.kxa=
eg;this.yGa=og;this.uJd=this.JWk(Ni);this.oFg=()=>oa.a.instance.Pa("Box4.IFeatureHelper")}JWk(Q){Q||(Q=F.AFrameworkApplication.K?F.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}mBa(){return(new Date).getTime()}g$i(Q,...xa){return String.format.apply(null,[Q].concat(xa))}fao(Q){throw Ml.a.invalidOperation(Q);}IFd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}N9m(Q){if(this.kxa&&this.kxa.Gji||!this.b7n(Q))return null;this.bBm(Q);
let xa;({Wik:Nb,L$n:Bc,lyo:xa}=this.bPk(Q,this.Fwh));const jb=Md.a.ovl(Q);var Nb=rc.construct(this.MR(),Nb.Awa(),Bc.Awa(),xa.Awa(),Q.input.l5b,Q.input.c3,Q.input.Xl,Q.input.XFb,Q.input.source,jb,this.yGa.Bva);var Bc=Q.output.bM;3===jb&&0<Bc.length&&(Nb.MergedRevision=this.Fwh(Q.output.bM.last()));return Nb}yEc(Q,xa){return(new se(Q)).yEc(xa)}xEc(Q,xa,jb,Nb){return(new se(Q)).xEc(xa,jb,Nb)}}Object(e.a)(Gf,"GraphMerger",Md.a,[]);class xh extends Gf{constructor(Q,xa=null,jb=null){super(Q,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,xa,jb);this.sa=new h.a}get Bva(){return this.yGa?this.yGa.Bva:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}d9j(Q){this.sa.addHandler(xh.ikf,Q)}iun(Q){this.sa.removeHandler(xh.ikf,Q)}e0f(){return!1}Q9b(Q,xa,jb,Nb,Bc,gd,be){(Q=super.Q9b(Q,xa,jb,Nb,Bc,gd,be))&&this.sa.raiseEvent(xh.ikf,new nl(Q));return Q}}xh.ikf="GMC";Object(e.a)(xh,"WordEditorGraphMerger",Gf,[1686,1377,1378]);class Zh{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}zc(Q){this.W=
Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Zl(this.W.$a("WordEditor.IBusinessBarController"),new tb.a(()=>Q.Pa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new eh(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>
new xh(()=>F.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Zi(()=>F.AFrameworkApplication.rootQuerySignature,F.AFrameworkApplication.ya,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),
this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){Ie.App.aR||(Ie.App.aR=ng.a.dea());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Ie.App.aR.Pjk(Q);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Pa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(e.a)(Zh,"GraphMergePackage",null,[1,2]);var Rk=c(165);class $g{constructor(Q){this.iTb=0;this.ih=Q}tyh(Q){this.iTb=Math.max(0,--this.iTb);
this.eRi(Q);0<this.iTb&&window.setTimeout(()=>{this.tyh(Q)},1E3)}eRi(Q){Q.style.backgroundColor="rgba(255,0,0,"+Math.min(1,this.iTb/20)+")"}Gvn(Q){this.ih&&this.ih.t4m&&(this.iTb++,this.eRi(Q),this.ih.fwi=Lh.a.Abf(Q,!1),1===this.iTb&&window.setTimeout(()=>{this.tyh(Q)},1E3))}}Object(e.a)($g,"ParagraphRenderVisualizationManager",null,[1685]);class ol{constructor(Q,xa,jb,Nb,Bc){this.Auc=this.Z8c=this.hxc=this.ih=null;this.bme=new ba.a;this.Cuc=null;this.BTg=0;this.oCi=(gd,be)=>{this.hxc&&(this.hxc.innerText=
be.DNm+" CPM")};this.LGb=(gd,be)=>{this.Z8c&&(this.Z8c.innerText=be.FSc.CP+"%",this.bme.add(be.FSc.CP))};this.showTaskPane=()=>{if(!Ie.App.xa.Rlb)return 16;this.ih||this.byd();this.pP.showTaskPane(this.ih);this.ih.element.style.overflow="scroll";return 32};this.tZk=()=>{const gd=sa.a.Gm("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;gd.writeln("<HEAD>");gd.writeln('<STYLE type="text/css">');gd.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");gd.writeln("</STYLE>");
gd.writeln("</HEAD>");gd.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const be=document.createElement("div");var Bd=document.createElement("div");Bd.innerText=String.format("{0}, {1}","Frame","CpuPercent");be.appendChild(Bd);for(Bd=0;Bd<this.bme.count;Bd++){const Xe=this.Nmk(Bd,this.bme.J(Bd));Xe&&be.appendChild(Xe)}gd.writeln(be.innerHTML);gd.writeln("</BODY>");gd.close();return!0};this.ga=Q;this.pP=xa;this.kg=jb;this.pra=Nb;this.VAg=Bc}get t4m(){return this.Auc?this.Auc.checked:!1}get fwi(){return this.BTg}set fwi(Q){this.Cuc&&
(this.Cuc.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",Q));this.BTg=Q}Vb(){this.ga.pa(Vf.a.luh,ti.a.application,this.showTaskPane)}dispose(){null!==this.ih&&(this.pP.Lyb(ol.ny,this.ih),this.ih=null);this.pra.execute(Q=>{this.JGh(Q,xa=>{xa.Aun(this.oCi)})});this.VAg.execute(Q=>{this.IGh(Q,xa=>{xa.pTf(this.LGb)})})}byd(){const Q=new Yc.CuiHelper(Rk.a.Kab,Box4Intl.Box4Strings);this.ih=this.pP.w1e(ol.ny,0,ol.width,"InteractivePerfTaskPaneData",Q);this.jJk();
this.gJk();this.iJk()}Wef(Q){Q=document.getElementById(Q);return Lh.a.mAb(Lh.a.mAb(Q,"cui-groupContainer"),"cui-groupBody")}IGh(Q,xa){const jb=Q.Vo.task;jb.continueWith(()=>{xa(jb.result)})}JGh(Q,xa){const jb=Q.Vo.task;jb.continueWith(()=>{xa(jb.result)})}jJk(){const Q=this.Wef("TypingSpeedMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const xa=document.createElement("div");xa.innerText="Typing Speed";this.hxc=document.createElement("div");this.hxc.innerText="0 CPM";this.pra.execute(jb=>
{this.JGh(jb,Nb=>{Nb.U9j(this.oCi)})});Q.appendChild(xa);Q.appendChild(this.hxc)}gJk(){const Q=this.Wef("CpuMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const xa=document.createElement("div");xa.innerText="CPU Meter";this.Z8c=document.createElement("div");this.VAg.execute(Bc=>{this.IGh(Bc,gd=>{gd.lrd(this.LGb)})});const jb=document.createElement("div"),Nb=document.createElement("button");Nb.innerText="View Cpu Percent";this.kg.mb(A.a.click,Nb,this.tZk);jb.appendChild(Nb);Q.appendChild(xa);
Q.appendChild(this.Z8c);Q.appendChild(jb)}iJk(){const Q=this.Wef("RenderGroup"),xa=document.createElement("label");xa.innerText="Enable render visualizations";this.Auc=document.createElement("input");this.Auc.setAttribute("type","checkbox");Q.appendChild(this.Auc);Q.appendChild(xa);this.Cuc=document.createElement("div");this.Cuc.style.margin="10px";Q.appendChild(this.Cuc);oa.a.instance.ha("Box4.IParagraphRenderVisualizationManager",()=>new $g(this))}Nmk(Q,xa){Q=Q.toString();xa=xa.toString();const jb=
document.createElement("div");jb.innerText=String.format("{0}, {1}",Q,xa);return jb}}ol.ny="InteractivePerfTaskPane";ol.width=400;Object(e.a)(ol,"InteractivePerfTaskPane",null,[]);class $l{constructor(){this.ih=null}get name(){return"WordEditor.InteractivePerfTaskPane"}zc(Q){Q.ha("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",()=>new ol(F.AFrameworkApplication.ya,Cm.a.instance,F.AFrameworkApplication.ta.jz,Q.$a("Common.ITypingSpeedMeterProvider"),Q.$a("Common.ICpuMeterProvider"))).singleInstance()}init(){if(this.ih=
oa.a.instance.Pa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.ih.Vb(),"1"===Kb.a.fQ(document.URL,"wdShowIPerfTaskPane")&&F.AFrameworkApplication.ya.processAction(Vf.a.luh,2)}dispose(){this.ih&&(this.ih.dispose(),this.ih=null)}static main(){ca.a.instance.Pc(new $l)}}Object(e.a)($l,"InteractivePerfTaskPanePackageManager",null,[1,2]);var sk=c(302);class dp{constructor(Q){this.$ke="FontPicker";this.Tue=null;this.G5a=Q;this.dad=this.G5a.Kva(sk.a.dFb,Object(a.a)(this,this.Azb,"featureStateChangeCallback"));
this.G5a.isFeatureEnabled(sk.a.dFb,!1).then(xa=>{this.Tue=xa})}get isLicensed(){return this.Tue}Azb(Q){this.Tue=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.$ke,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.G5a.scc(sk.a.dFb,this.dad)}}Object(e.a)(dp,"ModernFontPickerFeatureHelper",null,[1034,10]);var bq=c(504),Fi=c(653),Yk=c(1597);class Jm{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=
this.trigger=this.fontName=null}}Object(e.a)(Jm,"FontInfoTaskPaneProps",null,[]);class pl{constructor(Q,xa,jb,Nb=null){this.rLe=this.fV=this.dad=null;this._state=this.vSb=0;this.Txe=Q;this.G5a=xa;this.Ayj=jb;this.Ub=Nb}get wc(){return this.Txe.value}initialize(){this.wc.pa(Ra.a.xUf,$b.a.frame,Object(a.a)(this,this.xUf,"requestFontInfo"));this.dad=this.G5a.Kva(sk.a.dFb,Object(a.a)(this,this.Azb,"featureStateChangeCallback"));this.eha()}tO(Q=!1){const xa=dd.UISurfaces.fu(),jb=this.G5a.isFeatureEnabled(sk.a.dFb,
!1),Nb=[];Nb.push(xa);Nb.push(jb);Promise.all(Nb).then(Bc=>{Bc[0].showTaskPane(Yk.a.Vzb,this.AB(Bc[1]));Q&&this.IK()})}wno(Q){dd.UISurfaces.fu().then(xa=>{xa.updateTaskPane(Yk.a.Vzb,this.AB(Q));return null})}Azb(Q){this.wno(Q.isEnabled)}xUf(Q,xa,jb,Nb,Bc){this.fV=Bc.CommandValueId;this.rLe=Bc.Trigger;this.vSb=Bc.InputMethod;this.tO(2===this._state&&1===this.vSb);return 32}AB(Q){const xa=new Jm;xa.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");xa.fontName=
this.fV;xa.isLicensed=Q;xa.trigger=this.rLe;xa.helpArticleUrl=this.VEk();xa.paneId=Yk.a.Vzb;Q=this.V3l();Q.contentProps=xa;return Q}V3l(){return Object.assign(new rn.a,{title:Yk.a.$ib,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}eha(){if(this.Ub){var Q=
this.Ub.re(Yk.a.Vzb);Q.parent=Ii.AFrame.Qp;Q.XL=!0}}onOpen(){this._state=2;this.IK()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.vSb=Q),this.IK())}onClose(){this.vSb=this._state=0;this.blur()}onHide(){this._state=1;this.vSb=0}IK(){this.Ub&&1===this.vSb&&this.Ub.Kg(Yk.a.Vzb)}blur(){this.Ub&&this.Ub.pg&&this.Ub.pg.name===Yk.a.Vzb&&this.Ub.Kg(this.Ub.NS)}onUpsellButtonClicked(){this.G5a.launchUpsellExperience(Yk.a.experienceId)}dispose(){this.G5a.scc(sk.a.dFb,this.dad)}VEk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",
this.Ayj,this.fwl(),"WDWAENDUSER",F.AFrameworkApplication.lcid)}fwl(){switch(this.rLe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return pl.pmk(this.fV)}static pmk(Q){let xa="hlpFontInfo";for(let jb=0;jb<Q.length;++jb){const Nb=Pb.a.charAt(Q,jb);if(255<Q.charCodeAt(jb)||Pb.a.PNd(Nb))xa+=Nb}return xa}}Object(e.a)(pl,"FontInfoPane",null,[1033,10]);class cq extends pl{constructor(Q,
xa,jb,Nb,Bc){super(Q,xa,Nb.lb("FontInfoHelpBaseUrl"),Bc);this.pP=jb}tO(Q){this.fZ();super.tO(Q)}Azb(Q){super.Azb(Q);Ie.App.xa.updateCommandUI()}fZ(){this.pP.FKa()}}Object(e.a)(cq,"WordEditorFontInfoPane",pl,[]);class Sr{constructor(){this.VQb=this.jgd=this.Ync=this.W=null}get name(){return"WordEditor.ModernFontPicker"}zc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new dp(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();
Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new cq(new tb.a(()=>F.AFrameworkApplication.ya),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Cm.a.instance,F.AFrameworkApplication.K,ld.FocusManager.instance())).singleInstance()}init(){this.jgd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Ync=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");this.Ync.initialize();F.AFrameworkApplication.K.$("IsAnonymousUser")||((this.VQb=this.W.Pa(Fi.a))?
this.VQb.initialize():ia.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Ie.App.xa.updateCommandUI()}dispose(){this.Ync&&(this.Ync.dispose(),this.Ync=null);this.jgd&&(this.jgd.dispose(),this.jgd=null);this.VQb&&(this.VQb.cBc(),this.VQb=null)}static main(){Object(bq.a)()&&ca.a.instance.Pc(new Sr)}}Object(e.a)(Sr,"ModernFontPickerPackage",null,[1,2]);var dl=c(130),Om=c(6),Rf=c(261),xq=c(40),pi=c(20),el=c(1077);class ep{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,Ni=
null){this.dY=jb;this.Yc=Q;this.Hc=xa;this.Kh=Bc;this.iGa=gd;this.TU=be;this.Jyg=Bd;this.Iyg=Xe;this.rx=eg;this.SBj=Ni||ep.rw}get xh(){return this.rx?this.rx.xh:!1}Z9h(Q){return this.jCa(Q,0)}U6l(Q){return this.jCa(Q,1)}jCa(Q,xa){let jb=null;if(this.xh&&this.TU&&(this.Iyg.instance&&this.Iyg.instance.tFa(Q),xa?1===xa&&(jb=this.TU.yVh(Q.node)):jb=this.TU.cdf(Q.node,Q.cpBegin,Q.Fb),jb&&!jb.ia(Xk.a.I6,!1)))return ia.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),
2;const Nb=Om.GraphIterator.xW(this.Yc.Ck());Nb.set(Q.node);Nb.Ab(10);const Bc=this.Hc.Rc(15);Bc.Qu(Nb);xa?xq.OutlineElementNavigator.Xd(Nb):(this.splitParagraph(Nb,Q),this.dY.shc(Q.node,Hf.a.hs));Q=Jh.ParagraphReader.Rm(Nb.currentNode);this.e8l(Nb);this.xh&&jb&&this.Jyg&&(xa=new ba.a,xa.add(Nb.currentNode),this.Jyg.J8g(xa,jb.id));this.BNn(Q);Bc.dispose();return 32}BNn(Q){Q=Ji.SelectionFactory.xe(Q,0);Ne.a.instance.setSelection(Q)}e8l(Q){this.Kh.TB(Q,!0,!0,null,!1,!1);Q=xq.OutlineElementNavigator.Fe(Q);
this.V6l(Q)}splitParagraph(Q,xa){const jb=xq.OutlineElementNavigator.Xd(Q);if(xa.cpBegin||this.xh&&(!this.xh||-1!==xa.Fb)){pi.a.instance.J(4)&&Ie.App.vd.Pp&&xa.cpBegin!==Jh.ParagraphReader.textLength(xa.node)&&Ie.App.vd.Mq.KG(xa.node);this.Kh.TB(Q,!1,!0,null,!1,!0);var Nb=Om.GraphIterator.xW(this.Yc.Ck());Nb.set(jb);this.Kh.Hba(Nb,Q,xa,!0,!0,!0)}}V6l(Q){Q=this.SBj(Q);this.iGa.v$h(Q)}static fE(){return new ep(new $f.a,new sf.a,oa.a.instance.resolve("Box4.IAutoCorrectScheduler"),el.a.instance,oa.a.instance.resolve("Box4.IOutlineElementEditor"),
oa.a.instance.resolve("Box4.IBlobEditor"),oa.a.instance.Pa("Box4.IContentControlReader"),oa.a.instance.Pa("Box4.IContentControlEditor"),oa.a.instance.$a("Box4.IContentControlConverter"),oa.a.instance.Pa("Box4.ContentControlConfigSettings"),oa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=ep.wng?ep.wng:ep.wng=ep.fE()}static rw(Q){return co.a.rw(Q)}}Object(e.a)(ep,"PageBreakInserter",null,[1733]);class Mh{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd){this.h8l=(Xe,eg,og,Ni)=>
{var kk=eg.view,mj=kk.Cb.Jg;if(!mj)return 2;if(!this.KWe(eg))return 8;if(1===og)return 32;let am=!0;og=8;const zj=this.Xve(mj);mj=this.Hc.Rc(15);mj.Eb(kk.ld);mj.Al=Xe;zj||(og=this.ga.Vf(eg,di.a.Oka,2,!0,Ni,null),Xe=32===og,ia.ULS.shipAssertTag(4208012,314,Xe),am=Xe);am&&(kk=kk.Cb.Jg,Xe=this.Xve(kk),ia.ULS.shipAssertTag(4208013,314,Xe,"{0}",{["ContextId"]:eg.contextId}),og=8,Xe&&(og=this.Dte.Z9h(kk),ia.ULS.shipAssertTag(4208014,314,32===og)));mj.dispose();32===og&&this.Jd.ys(10);return og};this.g8l=
(Xe,eg,og)=>{if(!eg||eg.contextId!==ti.a.Wc)return 8;if(1===og)return eg.contextId===ti.a.Wc?32:8;if(2===og){if(!this.KWe(eg))return 8;Xe=this.Dte.Z9h(eg);32===Xe&&this.Jd.ys(10);return Xe}return 32};this.f8l=(Xe,eg,og)=>{if(!eg||eg.contextId!==ti.a.table)return 8;if(1===og)return 32;if(2===og){if(!this.KWe(eg))return 8;Xe=this.Dte.U6l(eg);32===Xe&&this.Jd.ys(10);return Xe}return 32};this.ga=Q;this.Dte=xa;this.Hc=jb;this.Km=Nb;this.Xve=Bc;this.Mk=gd;this.IKj=be;this.Jd=Bd}Vb(){this.ga.pa(Vf.a.jCa,
ti.a.view,this.h8l);this.ga.pa(Vf.a.jCa,ti.a.Wc,this.g8l);this.ga.pa(Vf.a.jCa,ti.a.table,this.f8l);this.ga.Vc(Vf.a.jCa,4)}y3(){const Q=ld.FocusManager.instance().re(dl.AppFrame.sF);Ii.AFrame.ti(Q,uf.KeyInputManager.lc(Hf.a.hs,uf.KeyInputManager.Mh),Vf.a.jCa)}rhm(Q){return this.Pv(Q.iterator)}Wkm(Q){Q=Q.J(0);const xa=ah.SelectionEditor.Qj(Q,!0,!1);if(this.Pv(xa.Qa.iterator))return!0;Q=ah.SelectionEditor.Qj(Q,!1,!1);return this.Pv(Q.Qa.iterator)}Pv(Q){return Q.Ab(14)}KWe(Q){let xa=null,jb=Q;if(jb.contextId===
ti.a.view){xa=jb.view;if(!xa.features.e4f)return!1;jb=xa.Cb.Jg;if(!jb)return!1}else{const Nb=Om.GraphIterator.Za(jb.node);if(Nb.Ab(36)||Nb.Ab(38)||Nb.Ab(40)||Nb.Ab(14))return!1}return Rf.a.ufa(Q)?!1:jb.contextId===ti.a.table?this.Mk.chm(jb.node):!this.Mk.ahm(jb)||this.Km&&this.Km.instance&&this.Km.instance.KT(jb)?!1:((Q=this.Xve(jb))?this.rhm(jb):this.Wkm(xa.Cb.ib))||Q&&this.IKj(jb,!0)?!1:!0}static fE(){return new Mh(F.AFrameworkApplication.ya,ep.instance,new sf.a,oa.a.instance.$a("Box4.IExternalSelectionManager"),
ah.SelectionEditor.zf,Ee.a.instance,Im.HyperlinkReader.wma,oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Mh.omg?Mh.omg:Mh.omg=Mh.fE()}}Object(e.a)(Mh,"PageBreakActor",null,[1687]);class yr{constructor(){this.aCe=this.W=null}get name(){return"WordEditor.PageBreak"}zc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){this.aCe=Mh.instance;this.aCe.Vb();this.aCe.y3();Ie.App.xa.updateCommandUI()}dispose(){}}
Object(e.a)(yr,"PackageManager",null,[1,2]);var On=c(1436),Wn=c(1437),rg=c(233),Pn=c(167),Si=c(260),fp=c(293),So=c(472);class Uq{constructor(Q,xa,jb,Nb,Bc,gd,be){this.Isb=null;this.sa=new h.a;this.vme=1;this.$ed=-1;this.JTa=null;this.ona=()=>{this.vVe()};this.hb=xa;this.Hb=jb;this.c$c=Nb;this.QH=Bc;this.hA=gd;this.hda=be;this.enable()}get pDc(){return this.vme}E2i(Q){this.vme!==Q&&(this.vme=Q,this.sa.raiseEvent("X"),this.Usf&&this.w9f())}get Usf(){const Q=oa.a.instance.Pa("WordEditor.Pagination.IPageEndMarkers");
return Q?Q.Usf:!0}get mf(){return this.QH.value}get fj(){return cb.a.instance}j8j(Q){this.sa.addHandler("X",Q)}w9f(){this.fj.Qd(()=>{this.hda.kU(So.a.ODi)},"CPC:UPN")}enable(){this.hb.tB(this.ona);this.vVe()}vVe(){if(!this.JTa||1>=this.JTa.count)this.E2i(1);else{var Q=this.hb.ib.kb;if(Q){var xa=Q.Uf?Q.Tc:Q.Qa;!xa||0>xa.cpBegin||(Q=xa.node)&&Jh.ParagraphReader.nc(Q)&&this.Lgm(Q)&&(this.Isb&&(this.Hb.Ye(this.Isb),this.Isb=null),this.Isb=new Fc.a(2,1,400,jb=>{this.findCurrentPageFromIp(jb,xa)},62),this.Hb.fc(this.Isb))}}}Lgm(Q){Q=
Om.GraphIterator.Za(Q);return Q.Ab(35)||Q.Ab(37)||Q.Ab(39)?!1:!0}vjj(Q){this.JTa=Q;this.Zhj()}Zhj(){if(-1!==this.$ed){var Q=this.M$k(this.$ed);-1!==Q&&this.E2i(Q)}}findCurrentPageFromIp(Q,xa){this.Isb===Q&&(this.Isb=null,this.$ed=this.Zhl(xa),-1!==this.$ed&&this.Zhj())}M$k(Q){if(!this.JTa)return-1;for(let xa=0;xa<this.JTa.count;xa++){const jb=this.JTa.J(xa);if(Q>jb.A7g&&Q<jb.A7g+jb.height)return jb.yj}return-1}Zhl(Q){var xa=this.bFl(Q);if(!xa||!xa.htmlElement)return-1;const jb=xa.getBounds();Q=this.Bpl(Q,
xa);if(!Q)return-1;xa=sa.a.aZa(this.c$c.D1a,xa.htmlElement).y;return Q.y+Math.floor(Q.height/2)-jb.y+xa}bFl(Q){return Q.node.Be(this.mf.Sb)}Bpl(Q,xa){Q=this.hA?this.hA.aea(Q,!0):Q.cpBegin;return fp.a.tq(xa,Q)}disable(){this.hb.Iga(this.ona)}}Object(e.a)(Uq,"CurrentPageCalculator",null,[1846,1841]);class tp{constructor(Q){tp.qY=Q}get f2e(){return tp.qY}get pDc(){return this.f2e.pDc}d3k(){this.f2e.enable()}gYk(){this.f2e.disable()}}tp.qY=null;Object(e.a)(tp,"CurrentPageManager",null,[1845]);var yq=
c(115);class Dm extends Sys.EventArgs{constructor(Q,xa){super();this.Gui=xa}}Object(e.a)(Dm,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class hk extends Sys.EventArgs{constructor(Q,xa,jb){super();this.delta=Q;this.Gui=jb}}Object(e.a)(hk,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class qo{constructor(Q,xa,jb){this.JXg=this.kjd=-1;this.itc=null;this.sa=new h.a;this.gAe=!1;this.z3m=(Nb,Bc)=>{this.gAe=this.Bvk();Bc.Tib||this.Bnc.value.measure(this.wvk)};this.wvk=()=>{const Nb=this.D1a.clientHeight;
this.vvk(Nb);this.Evk(Nb)};this.fKf=(Nb,Bc)=>{Bc.property===yq.a.tI&&(Nb=Bc.node)&&Nb.ia(yq.a.tI,!1)&&(Nb=Nb.Be(this.mf.Sb))&&(Nb=Nb.htmlElement)&&this.GTa.add(Nb)};this.QH=Q;this.Bnc=xa;this.GTa=new ba.a;this.mf.pah(this.z3m);this.bmf();this.Maa=this.Maa.bind(this);jb.Gvb(this.Maa)}get mf(){return this.QH.value}Maa(){this.itc=null}get D1a(){this.itc||(this.itc=this.mf.ld.Be(this.mf.Sb).D1a,ia.ULS.shipAssertTag(34136386,336,!!this.itc));return this.itc}q9j(Q){this.sa.addHandler("OnPageContentSizeChangeKey",
Q)}vvk(Q){Q!==this.JXg&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new Dm(Q,this.gAe)),this.JXg=Q)}Evk(Q){Q!==this.kjd&&(-1!==this.kjd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new hk(Q-this.kjd,Q,this.gAe)),this.kjd=this.D1a.clientHeight)}Bvk(){let Q=!1;for(let xa=this.GTa.count-1;0<=xa;xa--)this.GTa.J(xa).hasChildNodes()&&(this.GTa.removeAt(xa),Q=!0);return Q}bmf(){Ie.App.ik.ml.Ve(23).qp(this.fKf)}}Object(e.a)(qo,"DocumentSizeManager",null,[]);var xm=c(60),tn=c(262);class mi{constructor(Q){this.QH=
Q}get mf(){const Q=this.QH.value;ia.ULS.shipAssertTag(37820298,336,Q.yi,"OutlineManager.PageView is not a PageView.");return Q}v7d(Q,xa){const jb=xm.a.Ri(mi.Bg.yA(Q),1);xa+=jb;Q.Be(this.mf.Sb).htmlElement.firstChild.style.minHeight=xa+"px"}oSh(){const Q=Om.GraphIterator.Za(this.mf.ld);Q.ro();Q.Ud();ia.ULS.shipAssertTag(37820299,336,10===Q.Gn.type);return Q.Gn}OUh(){const Q=Om.GraphIterator.Za(this.mf.ld);Q.ro();Q.T$();ia.ULS.shipAssertTag(37820300,336,10===Q.Gn.type);return Q.Gn}NGl(Q){const xa=Om.GraphIterator.Za(this.mf.ld);
xa.ro();xa.Ud();let jb=xa.Gn,Nb=null;for(;Q!==jb&&xa.xj();)Nb=jb,jb=xa.Gn;ia.ULS.shipAssertTag(37820301,336,10===xa.Gn.type);return Nb}static get Bg(){return tn.a.instance}}Object(e.a)(mi,"OutlineManager",null,[1844]);class rj{constructor(Q){this.qya=0;this.s0=null;this.L0f=xa=>{for(let jb of xa.customData)this.showAdornmentText(jb)};this.Hb=Q}lZd(){this.s0||(this.s0=this.YCc())}nvd(){this.s0&&0<rj.xHc(this.s0).length&&this.Hb.fc(this.s0);this.s0=null}YCc(){return Object.assign(new Fc.a(3,1,250,this.L0f,
166),{customData:[]})}gZf(Q){this.qya=Q}C0c(Q){if(Q){Q.style.width=this.qya+"px";if(this.s0)var xa=this.s0;else xa=this.YCc(),this.Hb.fc(xa);rj.xHc(xa).push(Q)}}fLc(Q){Q&&(Q.style.width="0px",this.Ilf(Q))}z3c(Q,xa){xa?this.C0c(Q):this.fLc(Q)}showAdornmentText(Q){Q.style.width===this.qya+"px"&&(this.IHc(Q).style.visibility="visible")}Ilf(Q){Q&&(this.IHc(Q).style.visibility="hidden")}IHc(Q){Q=Q.childNodes;ia.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+
Q.length);return Q[0]}static xHc(Q){return Q.customData}}Object(e.a)(rj,"PageAdornmentAnimationManager",null,[1842]);class Hn{constructor(Q){this.Ll=Q;this.b9=new ob.a;this.c9=new ob.a}eAa(Q){Q=Om.GraphIterator.Za(Q);if(Q.ro()&&Q.Mp()){Q.Ud();do 10===Q.Le&&this.xMf(Q.currentNode),Q.Ht();while(8!==Q.Le)}}KKb(Q){const xa=Q.yj;var jb=this.sBb(Q.hMb);if(!this.b9.ub(jb))return ia.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+jb),!1;Q=
this.b9.J(jb);ia.ULS.shipAssertTag(24958353,336,this.c9.ub(jb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");jb=this.c9.J(jb);return this.Dlf(Q,xa,jb)}JKb(Q){const xa=Q.yj;var jb=this.sBb(Q.hMb);if(!this.b9.ub(jb))return ia.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+jb),!1;Q=this.b9.J(jb);ia.ULS.shipAssertTag(24958355,336,this.c9.ub(jb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
jb=this.c9.J(jb);return this.Q$e(Q,xa,jb)}Uif(Q){if(!Q)return ia.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var xa=Q.ctd;if(!xa)return ia.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.yj)),0;xa=this.Ll.IAb(xa);if(!xa)return ia.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;xa=this.Ll.Rla(xa);const jb=1===Q.yj;Q=!(Q.yj%2);return 1===xa?1:
2===xa?jb?2:1:3===xa?Q?3:4:jb?2:Q?3:4}xMf(Q){if(10===Q.type){var xa=new ob.a,jb=this.Ll.IAb(Q);ia.ULS.shipAssertTag(24958356,336,!!jb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Nb=this.Ll.Rla(jb);Q=this.sBb(Q);this.J9f(Q,Nb);this.I9f(Q,xa);jb=Om.GraphIterator.Za(jb);if(jb.Mp()){jb.Ud();do Q=jb.currentNode,Nb=this.Ll.fGd(Q),Q=this.Ll.d6h(Q),xa.add(Nb,Q),jb.Ht();while(36===jb.Le)}}}J9f(Q,xa){this.c9.ub(Q)?this.c9.Z(Q,
xa):this.c9.add(Q,xa)}I9f(Q,xa){this.b9.ub(Q)?this.b9.Z(Q,xa):this.b9.add(Q,xa)}sBb(Q){ia.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(Xk.a.Sga,0)}Dlf(Q,xa,jb){const Nb=1===xa;xa=!(xa%2);switch(jb){case 2:if(Nb){if(Q.ub(2))return Q.J(2)}else if(Q.ub(0))return Q.J(0);break;case 3:if(xa){if(Q.ub(1))return Q.J(1)}else if(Q.ub(0))return Q.J(0);break;case 4:if(Nb){if(Q.ub(2))return Q.J(2)}else if(xa){if(Q.ub(1))return Q.J(1)}else if(Q.ub(0))return Q.J(0);
break;case 1:if(Q.ub(0))return Q.J(0)}return!1}Q$e(Q,xa,jb){const Nb=1===xa;xa=!(xa%2);switch(jb){case 2:if(Nb){if(Q.ub(5))return Q.J(5)}else if(Q.ub(3))return Q.J(3);break;case 3:if(xa){if(Q.ub(4))return Q.J(4)}else if(Q.ub(3))return Q.J(3);break;case 4:if(Nb){if(Q.ub(5))return Q.J(5)}else if(xa){if(Q.ub(4))return Q.J(4)}else if(Q.ub(3))return Q.J(3);break;case 1:if(Q.ub(3))return Q.J(3)}return!1}}Object(e.a)(Hn,"PageAdornmentContentManager",null,[1843]);var zr=c(1140);class $m{constructor(Q,xa,
jb,Nb,Bc,gd,be,Bd,Xe){this.O$f(Q,xa,jb,gd,be,Bd,Xe);this.yj=Q;this.rq=xa;this.$q=jb;this.hMb=Nb;this.ctd=Bc;this.sbb=gd;this.Q4b=be;this.Y1b=Bd;this.eEi=Xe}get top(){return this.rq}get height(){return this.$q}T_c(Q){this.rq!==Q&&(this.sbb.style.top=Q+"px",this.rq=Q)}MYf(Q){this.height!==Q&&(this.sbb.style.height=Q+"px",this.$q=Q)}O$f(Q,xa,jb,Nb,Bc,gd,be){ia.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);ia.ULS.shipAssertTag(37244962,
336,0<=xa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",xa);ia.ULS.shipAssertTag(37244963,336,0<=jb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",jb,xa);ia.ULS.shipAssertTag(37244992,336,!!Nb,"PageAdornmentContainer: containerDomElement parameter is null.");ia.ULS.shipAssertTag(37244993,336,!!Bc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ia.ULS.shipAssertTag(37244994,336,!!gd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
ia.ULS.shipAssertTag(37244995,336,!!be,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(e.a)($m,"PageAdornmentContainer",null,[1881]);class xk{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,Ni,kk){this.GIg="headerFooterTab";this.Lnd=null;this.xu=!0;this.Wre=0;this.mxe=null;this.AZa=!1;this.VGb=mj=>{this.NQm(mj.Fv);return!0};this.nD=()=>!0;this.fCb=()=>{this.z_e()&&(this.AZa=!1,this.Yio(),this.mxe=new Date)};this.XGb=mj=>{this.AZa||this.OU.C0c(mj.Fv);return!0};this.WGb=
mj=>{this.AZa||(mj=mj.Fv,this.u0f(mj)||this.OU.fLc(mj));return!0};this.jnn=()=>{let mj=Array.dequeue(this.IEe);for(;mj;)this.lU(mj),mj=Array.dequeue(this.IEe);this.Lnd=null};this.QH=Q;this.kg=xa;this.HD=jb;this.Yha=Nb;this.ga=Bc;this.Lj=gd;this.OU=be;this.Bxa=Bd;this.zHa=Xe;this.Hb=eg;this.Oa=og;this.IEe=[];this.p0=new Map;this.OH=Ni;this.Kw=kk;this.zHa.mrd(this.fCb);this.gw=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.S2;if(this.zdd=(this.Pte=!!this.Oa&&this.Oa.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Oa&&this.Oa.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Ie.App.xa.Bu.getLayoutBreakpoint()&&(this.xu=!1),Ie.App.xa.Bu.registerLayoutBreakpointChanged(this.GIg,mj=>{switch(mj){case "Small":this.A6h();break;default:this.D6i()}})}get mf(){return this.QH.value}D6i(){try{this.v_n()}catch(Q){ia.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}A6h(){try{this.WZl()}catch(Q){ia.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Lsn(){for(const Q of this.p0.keys())this.J3d(Q)}eAa(){try{this.UDk()}catch(Q){ia.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}vjj(Q){try{this.qno(Q)}catch(xa){ia.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",xa.message)}}dispose(){try{this.zho(),this.dio(),this.zHa&&this.zHa.yQi(this.fCb)}catch(Q){ia.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}NQm(Q){const xa=this.XNc(Q),jb=this.NPh(Q);jb?(Q=this.Bxa.Uif(jb),this.ga.Xb(xa?Vf.a.eee:Vf.a.K4c,2,Q),this.AZa=!0):(ia.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(Vf.a.PMd,2))}zho(){this.p0.forEach(Q=>{this.RQa(Q)})}dio(){this.gw&&(this.zdd&&(Ie.App.xa.Bu.unregisterLayoutBreakpointChanged(this.GIg),this.zdd=
!1),this.gw=!1)}RQa(Q){if(Q){var xa=Q.Q4b;Q=Q.Y1b;Lh.a.SCa(xa)&&Lh.a.SCa(Q)?(this.Lj.sc(A.a.CQ,xa,this.XGb),this.Lj.sc(A.a.CQ,Q,this.XGb),this.Lj.sc(A.a.uK,xa,this.WGb),this.Lj.sc(A.a.uK,Q,this.WGb),this.kg.sc(A.a.click,xa,this.VGb),this.kg.sc(A.a.click,Q,this.VGb),this.HD.sc(xa,xk.KGb),this.HD.sc(Q,xk.KGb),this.Yha.sc(A.a.ex,xa,this.nD),this.Yha.sc(A.a.ex,Q,this.nD)):ia.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Rfn(Q){this.IEe.push(Q);
this.Lnd||(this.Lnd=new Fc.a(2,1,50,this.jnn),this.Hb.fc(this.Lnd))}lU(Q){if(Q){var xa=Q.Q4b;Q=Q.Y1b;Lh.a.SCa(xa)&&Lh.a.SCa(Q)?(this.Lj.mb(A.a.CQ,xa,this.XGb),this.Lj.mb(A.a.CQ,Q,this.XGb),this.Lj.mb(A.a.uK,xa,this.WGb),this.Lj.mb(A.a.uK,Q,this.WGb),this.kg.mb(A.a.click,xa,this.VGb),this.kg.mb(A.a.click,Q,this.VGb),this.HD.mb(xa,xk.KGb),this.HD.mb(Q,xk.KGb),this.Yha.mb(A.a.ex,xa,this.nD),this.Yha.mb(A.a.ex,Q,this.nD)):ia.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}v_n(){if(!this.xu){for(let Q of this.p0.values())Q.sbb.style.display=
"block";this.xu=!0}}WZl(){this.xu&&(this.p0.forEach(Q=>{Q.sbb.style.display="none"}),this.xu=!1)}UDk(){this.Bxa.eAa(this.mf.ld)}qno(Q){this.OU.lZd();var xa=0;const jb=new ba.a;this.eAa();const Nb=this.Eyl();for(var Bc of Q)Q=Bc.yj,this.Y2m(Bc)||this.J3d(Bc.yj),this.p0.has(Q)?this.iko(Bc):this.kKk(Bc),xa=Q,jb.add(Q);for(Bc=1;Bc<=xa;Bc++)jb.contains(Bc)||this.J3d(Bc);for(xa+=1;xa<=Nb;xa++)this.J3d(xa);this.OU.nvd()}Y2m(Q){return this.p0.has(Q.yj)?this.p0.get(Q.yj).hMb.id===Q.hMb.id:!1}Eyl(){let Q=0;
this.p0.forEach((xa,jb)=>{jb>Q&&(Q=jb)});return Q}kKk(Q){const xa=Q.hMb.Be(this.mf.Sb);if(xa){var jb=Q.yj;Q=this.LCc(jb,Q.top,Q.height,xa.r$,Q.hMb,Q.ctd);this.Rfn(Q);this.G8f(Q);this.Y9f(Q);this.zdd&&!this.xu&&(Q.sbb.style.display="none");this.p0.set(jb,Q)}}LCc(Q,xa,jb,Nb,Bc,gd){const be=nk.b("div","","PageAdornmentContainer");be.style.top=xa+"px";be.style.height=jb+"px";Nb.appendChild(be);this.wVe(be,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Nb=this.V0e(Q);
be.appendChild(Nb);const Bd=this.s0e(Q);be.appendChild(Bd);const Xe=this.j0e(Q);be.appendChild(Xe);F.AFrameworkApplication.isRtl&&(be.classList.add("Rtl"),Bd.classList.add("Rtl"),Xe.classList.add("Rtl"));return new $m(Q,xa,jb,Bc,gd,be,Bd,Xe,Nb)}s0e(Q){Q=nk.b("div","h"+Q,this.Kw?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.OH&&(this.Kw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=zr.a.qee);const xa=nk.b("span","","");xa.innerText=WordEditorIntl.WordEditorStrings.l_Header;
xa.style.whiteSpace="nowrap";Q.appendChild(xa);return Q}j0e(Q){Q=nk.b("div","f"+Q,this.Kw?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.OH&&(this.Kw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=zr.a.qee);const xa=nk.b("span","","");xa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;xa.style.whiteSpace="nowrap";Q.appendChild(xa);return Q}V0e(Q){const xa=nk.b("div","","PageAdornmentNumberLabel");xa.innerText=Q.toString();return xa}wVe(Q,xa,jb){if(!this.Wre){const Nb=
nk.b("p","","");Nb.innerText=xa;Nb.style.whiteSpace="nowrap";Nb.style.visibility="hidden";Q.appendChild(Nb);xa=nk.b("p","","");xa.innerText=jb;xa.style.whiteSpace="nowrap";xa.style.visibility="hidden";Q.appendChild(xa);this.Wre=Q.clientWidth;this.OU.gZf(this.Wre);Q.removeChild(Nb);Q.removeChild(xa)}}J3d(Q){if(this.p0.has(Q)){var xa=this.p0.get(Q);this.RQa(xa);Lh.a.Nu(xa.sbb);this.p0.delete(Q)}}iko(Q){if(this.p0.has(Q.yj)){var xa=this.p0.get(Q.yj);xa.T_c(Q.top);xa.MYf(Q.height);this.G8f(xa);this.Y9f(xa)}else ia.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}Yio(){this.OU.lZd();this.eAa();this.p0.forEach(Q=>{this.G8f(Q);this.Y9f(Q)});this.OU.nvd()}G8f(Q){const xa=Q.Q4b,jb=Q.Y1b,Nb=this.Bxa.KKb(Q),Bc=this.Bxa.JKb(Q);this.Apo(Q,Nb,Bc);this.OU.z3c(xa,Nb);this.OU.z3c(jb,Bc)}Apo(Q,xa=!0,jb=!0){const Nb=Q.Q4b;Q=Q.Y1b;3!==F.AFrameworkApplication.ya.mode?(Nb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Nb.title=
xa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=jb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}u0f(Q){const xa=this.NPh(Q);return xa?this.XNc(Q)?this.Bxa.KKb(xa):this.Bxa.JKb(xa):(ia.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}NPh(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.p0.has(Q)?this.p0.get(Q):(ia.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}XNc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(ia.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}Y9f(Q){const xa=Q.height;xa<xk.ZKm?(Q.Q4b.classList.add(xk.bfb),Q.Y1b.classList.add(xk.bfb)):(Q.Q4b.classList.remove(xk.bfb),Q.Y1b.classList.remove(xk.bfb));xa<xk.$Km?(Q.eEi.classList.add(xk.bfb),Q.sbb.classList.add(xk.bfb)):(Q.eEi.classList.remove(xk.bfb),Q.sbb.classList.remove(xk.bfb))}z_e(){return!this.mxe||
E.a.wlf(this.mxe,500)}static KGb(){return!0}}xk.bfb="Hidden";xk.ZKm=120;xk.$Km=50;Object(e.a)(xk,"PageAdornmentManager",null,[1840,10,1841]);class un{constructor(Q,xa){this.YZd=new ba.a;this.YZd.add(Q);this.YZd.add(xa)}}Object(e.a)(un,"PageElementManagerList",null,[]);var Eo=c(65);class yj{constructor(Q,xa,jb){this.Om=Q;this.yTb=[];this.ME=xa;this.OH=jb}tOi(){for(let Q=0,xa=this.yTb.length;Q<xa;Q++)Lh.a.Nu(this.yTb[Q]);Array.clear(this.yTb)}kRh(Q,xa,jb,Nb,Bc,gd){let be=Math.min(Nb.x-gd.x,Bc.x-gd.x);
Nb=Math.min(gd.x+gd.width-(Nb.x+Nb.width),gd.x+gd.width-(Bc.x+Bc.width));xa+=Bc.y-gd.y;({oga:xa,leftMargin:be,rightMargin:Nb}=this.Fak(xa,be,Nb));Q=this.fEl(Q,be,Nb,be,Nb,jb);Q.style.top=xa+"px";Q.style.zIndex="0";this.yTb.push(Q);Eo.c(Q,!0);return Q}mHd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}fEl(Q,xa,jb,Nb,Bc,gd){return Q?this.hNl(xa,jb,Nb,Bc,gd):this.xEl(Nb,Bc,gd)}Fak(Q,xa,jb){xa/=this.Om.instance.vj;jb/=this.Om.instance.vj;Q/=this.Om.instance.vj;return{oga:Q,leftMargin:xa,rightMargin:jb}}agm(Q){return this.iki(Q)&&
this.VDi(Q)?(Q=this.jBb(Q))&&Q.offsetParent?!1:!0:!1}$fm(Q){return!this.iki(Q)||this.VDi(Q)?!1:!0}AQ(){}jBb(Q){if(!Q.cLf)return null;let xa=null;Q.kgb&&!Q.waa?(Q=this.mHd(Q.cLf))&&(xa=Q):xa=Q.cLf;return xa}iki(Q){return Q.kgb&&!Q.waa&&Q.paragraphNode?!0:!1}VDi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}Dkh(Q,xa){Q=sa.a.zLa(Q);xa=sa.a.zLa(xa);return(Q-xa)/this.Om.instance.vj}AVe(Q,xa){Q=sa.a.zLa(Q);xa=sa.a.zLa(xa);return(Q-xa)/this.Om.instance.vj}DUd(){this.xjj(!1)}CUd(){this.xjj(!0)}xjj(Q){for(let xa=
0,jb=this.yTb.length;xa<jb;xa++){const Nb=this.yTb[xa];"PageEndMarker.Para"===Nb.id?yj.Ajj(Nb,Q):"PageEndMarker.Table"===Nb.id&&yj.skj(Nb,Q)}}xEl(Q,xa,jb){if(!yj.zWb){yj.zWb=nk.b("div","PageEndMarker.Para","PageEndMarker");var Nb=nk.b("div","","Current FullWidth");this.OH&&(Nb.style.borderTopColor=this.ME.yta());yj.zWb.appendChild(Nb);Nb=nk.b("div","","Stale LeftWing");const Bc=nk.b("div","","Stale RightWing");this.OH&&(Nb.style.borderTopColor=this.ME.yta(),Bc.style.borderTopColor=this.ME.yta());
yj.zWb.appendChild(Nb);yj.zWb.appendChild(Bc)}Nb=yj.zWb.cloneNode(!0);Nb.childNodes[1].style.width=Q-10+"px";Nb.childNodes[2].style.width=xa-10+"px";yj.Ajj(Nb,jb);return Nb}hNl(Q,xa,jb,Nb,Bc){if(!yj.Lub){yj.Lub=nk.b("div","PageEndMarker.Table","PageEndMarker");var gd=nk.b("div","","Current LeftWing"),be=nk.b("div","","Current RightWing");this.OH&&(gd.style.borderTopColor=this.ME.yta(),be.style.borderTopColor=this.ME.yta());yj.Lub.appendChild(gd);yj.Lub.appendChild(be);gd=nk.b("div","","Stale LeftWing");
be=nk.b("div","","Stale RightWing");this.OH&&(gd.style.borderTopColor=this.ME.yta(),be.style.borderTopColor=this.ME.yta());yj.Lub.appendChild(gd);yj.Lub.appendChild(be)}gd=yj.Lub.cloneNode(!0);gd.childNodes[0].style.width=Q+"px";gd.childNodes[1].style.width=xa+"px";gd.childNodes[2].style.width=jb-10+"px";gd.childNodes[3].style.width=Nb-10+"px";yj.skj(gd,Bc);return gd}static Ajj(Q,xa){xa?yj.dGm(Q):yj.eGm(Q)}static eGm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static dGm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static skj(Q,xa){xa?yj.iGm(Q):yj.jGm(Q)}static jGm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static iGm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
yj.zWb=null;yj.Lub=null;Object(e.a)(yj,"PageEndDOMHelper",null,[]);class Jq{constructor(Q,xa){this.Rsb=this.PXg=null;this.Om=Q;this.Hh=xa}s3f(Q,xa){try{this.Q5n(Q,xa)}catch(jb){ia.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",jb.message)}}sDk(Q,xa,jb,Nb,Bc,gd,be){this.Hh.Qd(()=>{try{this.tDk(Q,xa,jb,Nb,Bc,gd,be)}catch(Bd){ia.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Bd.message)}},"PEMPC:CP")}Q5n(Q,xa){this.PXg=Q;this.Rsb=xa}tDk(Q,xa,jb,Nb,Bc,gd,be){var Bd=this.PXg;if(Bd&&Q){var Xe=Bd.count,eg=Q.count;if(Xe&&eg){var og=this.nal(Bd,Q);if(og.count){var Ni=this.Om.vj,kk=this.QZb(og)/Ni,mj=this.krh(og)/Ni;Q=this.WCd(Bd,Q);if(Q.count){Bd=this.QZb(Q)/Ni;Ni=this.krh(Q)/Ni;var am=!0;for(var zj=0;zj<og.count;zj++)if(og.J(zj)){am=!1;break}var yn=zj=0;this.Rsb&&xa&&(zj=this.yqk(this.Rsb,xa),yn=xa.count-this.Rsb.count);ia.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:jb,
["HardPageBreakExists"]:Bc,["EstimatedPageCount"]:Xe,["CalculatedPageCount"]:eg,["InOrderAverageDelta"]:kk,["InOrderStandardDeviation"]:mj,["ShortestAverageDelta"]:Bd,["ShortestStandardDeviation"]:Ni,["PositionsShouldBeUpdated"]:Nb,["DocumentHeightChanged"]:gd,["DeltasAllZero"]:am,["HeaderFooterOpenSinceLastResponse"]:be,["DeltaInViewport"]:zj,["ChangeInViewportMarkerCount"]:yn});gd||be||am||(ia.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
xa=og.toArray().toString(),jb=Q.toArray().toString(),ia.ULS.sendTraceTag(35726603,336,50,"{0} {1}",xa,jb))}}}}else ia.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}yqk(Q,xa){const jb=new ba.a;for(let Nb of Q)jb.add(Nb.top);if(!jb.count)return-1;Q=new ba.a;for(let Nb of xa)Q.add(Nb.top);if(!Q.count)return-1;xa=this.WCd(jb,Q);return this.QZb(xa)/this.Om.vj}QZb(Q){if(!Q.count)return 0;let xa=0;for(let jb=
0;jb<Q.count;jb++)xa+=Q.J(jb);return xa/Q.count}krh(Q){if(!Q.count)return 0;const xa=this.QZb(Q);let jb=0;for(let Nb=0;Nb<Q.count;Nb++){const Bc=Q.J(Nb)-xa;jb+=Bc*Bc}return Math.sqrt(jb/Q.count)}nal(Q,xa){const jb=new ba.a;if(!Q.count||!xa.count)return jb;Q.Sc((Bc,gd)=>Bc-gd);xa.Sc((Bc,gd)=>Bc-gd);const Nb=Math.min(Q.count,xa.count);for(let Bc=0;Bc<Nb;Bc++){const gd=Math.abs(Q.J(Bc)-xa.J(Bc));jb.add(gd)}return jb}WCd(Q,xa){const jb=new ba.a;if(!Q.count||!xa.count)return jb;var Nb=Q.count<=xa.count;
const Bc=Nb?Q:xa;Q=Nb?xa:Q;for(xa=0;xa<Bc.count;xa++){Nb=Bc.J(xa);let be=Math.abs(Nb-Q.J(0)),Bd=0;for(let Xe=1;Xe<Q.count;Xe++){var gd=Q.J(Xe);gd=Math.abs(Nb-gd);gd<be&&(be=gd,Bd=Xe)}jb.add(be);Q.removeAt(Bd)}return jb}}Object(e.a)(Jq,"PageEndMarkerPositionComparer",null,[1839]);var tm=c(428),yk=c(522);class Sk{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg){this.rq=Q;this._pageNumber=xa;this.kgb=jb;this.waa=Nb;this.cLf=Bc;this.outlineNode=gd;this.outlineGroupNode=be;this.MVg=Bd;this.paragraphNode=Xe;this.iU=
eg}get top(){return this.rq}get yj(){return this._pageNumber}get q2m(){return this.MVg}T_c(Q){this.rq=Q}w7d(Q){this._pageNumber=Q}S0i(Q){this.MVg=Q}}Object(e.a)(Sk,"PageEndMarker",null,[]);class Ar{constructor(){this.qf=null;this.Oui=0}}Object(e.a)(Ar,"PageEndMarkerToRestore",null,[]);class Vq{constructor(Q,xa,jb,Nb,Bc,gd,be){this.fKf=(Bd,Xe)=>{Xe.property===yq.a.tI&&(Bd=Xe.node)&&Bd.ia(yq.a.tI,!1)&&this.zpd.contains(Bd.id)&&(Xe=Bd.Be(this.mf.Sb))&&(Xe=Xe.htmlElement)&&(this.zpd.remove(Bd.id),this.GTa.add(Xe))};
this.QH=Q;this.Om=xa;this.yIa=jb;this.Cx=Nb;this.eCe=Bc;this.LY=gd;this.Lm=be;this.tt=new ba.a;this.zTb=new ba.a;this.Kub=new ob.a;this.zpd=new yk.a(new tm.a);this.GTa=new ba.a;this.CTb=!!Bc;this.bmf()}get mf(){const Q=this.QH.value;ia.ULS.shipAssertTag(37052750,336,Q.yi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}N3c(Q){try{this.Smo(Q)}catch(xa){this.Cx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
xa.message)}}T5j(Q){try{this.U5j(Q)}catch(xa){this.Cx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",xa.message)}}vrk(Q){try{return this.wrk(Q)}catch(xa){this.Cx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",xa.message)}return!1}CAn(){try{this.DAn()}catch(Q){this.Cx.AQ(Q.message+" "+Q.stack),ia.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}EJc(){try{return this.cIl()}catch(Q){return this.Cx.AQ(Q.message+" "+Q.stack),ia.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}H9f(){try{this.soo()}catch(Q){this.Cx.AQ(Q.message+" "+Q.stack),ia.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}$We(){try{return this.Xwk()}catch(Q){return this.Cx.AQ(Q.message+" "+Q.stack),ia.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}X7l(Q){try{this.Y7l(Q)}catch(xa){this.Cx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",xa.message)}}Smo(Q){if(Q){this.Byk();for(let xa=0;xa<Q.length;xa++){const jb=
xa+1,Nb=this.fFk(Q[xa],jb);this.tt.add(Nb);this.Kub.add(jb,Nb)}}}Y7l(Q){let xa=!1;for(let jb of Q)if(jb)if(0<jb.aC)for(let Nb of jb.Rof)xa=this.Uqd(Nb,jb.outlineGroupNode)||xa;else if(0>jb.aC){xa=!0;for(let Nb of jb.mzd)this.KUk(Nb.yj)}xa&&this.QTf()}U5j(Q){const xa=this.PPh(Q.paragraphNode);this.Uqd(Q,xa)&&this.QTf()}KUk(Q){const xa=Q-1;0>xa||this.tt.count<=xa||(this.tt.removeAt(xa),this.Kub.ub(Q)&&this.Kub.remove(Q))}cIl(){const Q=new ba.a;for(let xa of this.tt)this.v7b(xa)&&Q.add(xa);return Q}Uqd(Q,
xa){if(!Q)return ia.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;xa=this.cFk(Q,xa);Q=Q.Fbm?-1:Q.yj;let jb=!1,Nb;this.Kub.ub(Q)?(Nb=this.Kub.J(Q).yj,xa.w7d(Nb),this.tt.Z(Nb-1,xa),this.Kub.remove(Q)):(Nb=xa.yj,this.tt.insert(Nb-1,xa),jb=!0);return jb}fFk(Q,xa){return new Sk(0,xa,Q.HardBreak,!1,null,null,null,0,null,null)}cFk(Q,xa){const jb=Q.Xib,Nb=Q.yj,Bc=Q.iU,gd=!!Bc&&Bc.HardBreak,be=Q.waa,Bd=Q.paragraphNode,Xe=this.ZWh(xa),
eg=Q.outlineNode;var og=this.Qgf(eg);if(!og)return ia.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Ni=null;gd&&(Ni=this.Cx.mHd(Q.Xib));Q=this.Cx.Dkh(Ni||jb,Xe);og=this.Cx.AVe(Ni||jb,og);return new Sk(og,Nb,gd,be,jb,eg,xa,Q,Bd,Bc)}wrk(Q){this.zTb=new ba.a;this.CTb&&this.eCe.reset();this.Grn();this.a2n();this.Gak();this.krk(Q);return 0<this.zTb.count}Grn(){for(let Q=0;Q<this.tt.count;Q++){const xa=this.tt.J(Q);this.Cx.agm(xa)?
this.BEm(xa):(this.Cx.$fm(xa)||this.v7b(xa)&&!this.Qgf(xa.outlineNode))&&this.yPi(xa)}}Gak(){let Q=0,xa=null;var jb=0;let Nb=0;for(let Bc=0;Bc<this.tt.count;Bc++){const gd=this.tt.J(Bc);this.v7b(gd)&&(gd.kgb&&(Nb+=this.zkh(gd,jb,Nb)),xa&&xa.id===gd.outlineNode.id||(xa=gd.outlineNode,Nb=Q=0),gd.kgb&&!gd.waa&&(Q=this.irk(gd)),jb=gd.top+Q+Nb,gd.T_c(jb))}this.zkh(null,jb,Nb);this.yrn()}zkh(Q,xa,jb){let Nb=null;this.CTb&&(Nb=this.eCe.lrk(Q,xa,jb));return Nb?Nb.delta:0}DAn(){if(this.zTb){for(let Q=0;Q<
this.zTb.count;Q++){const xa=this.zTb.J(Q);Lh.a.CLn(xa.qf,xa.Oui)}this.CTb&&this.eCe.zAn()}}soo(){if(!this.CTb){var Q=this.yIa.OUh();if(this.tt.count){var xa=this.yIa.oSh();for(let Bc=0;Bc<this.tt.count;Bc++){var jb=this.tt.J(Bc);if(this.v7b(jb)&&jb.waa){jb=this.yIa.NGl(jb.outlineNode);var Nb=0<Bc?this.tt.J(Bc-1).outlineNode:xa;Nb=Bc&&jb.id===Nb.id?this.tt.J(Bc-1).top:0;this.yIa.v7d(jb,Nb)}}xa=this.tt.J(this.tt.count-1);xa.waa?this.yIa.v7d(Q,0):this.yIa.v7d(Q,xa.top)}else this.yIa.v7d(Q,0)}}a2n(){this.tt.Sc((Q,
xa)=>Q.yj-xa.yj)}QTf(){for(let Q=0;Q<this.tt.count;Q++)this.tt.J(Q).w7d(Q+1)}irk(Q){return Q?this.Ckh(Q)-Q.top:(ia.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}trk(Q){if(!Q)return 0;const xa=this.ZWh(Q.outlineGroupNode);return xa?this.Cx.Dkh(this.Cx.jBb(Q),xa):0}Ckh(Q){if(!Q)return 0;const xa=this.Cx.jBb(Q);Q=this.Qgf(Q.outlineNode);return Q?this.Cx.AVe(xa,Q):(ia.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}yrn(){let Q=0,xa=!1,jb=null,Nb=!1;for(let Bc=this.tt.count-1;0<=Bc;Bc--){const gd=this.tt.J(Bc);this.v7b(gd)&&(jb&&jb.id===gd.outlineNode.id||(xa=!jb,jb=gd.outlineNode,Q=this.NDl(jb)),gd.kgb?(xa=!1,Q=gd.top):this.CTb&&xa||!(gd.top>Q)||(this.yPi(gd),Lh.a.Nu(this.Cx.jBb(gd)),Nb=!0))}Nb&&this.QTf()}yPi(Q){this.tt.contains(Q)&&(this.CTb&&this.LY.Msn(Q),this.tt.remove(Q))}v7b(Q){return Q?(Q=this.Cx.jBb(Q))&&Q.offsetParent?!0:!1:(ia.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}Xwk(){let Q=!1;for(let xa=this.GTa.count-1;0<=xa;xa--)this.GTa.J(xa).hasChildNodes()&&(this.GTa.removeAt(xa),Q=!0);return Q}BEm(Q){(Q=this.PPh(Q.paragraphNode))&&(this.zpd.contains(Q.id)||this.zpd.add(Q.id))}bmf(){this.Lm&&this.Lm.Ve(23).qp(this.fKf)}krk(Q){for(let xa=this.tt.count-1;0<=xa;xa--){const jb=this.tt.J(xa);this.v7b(jb)&&this.jrk(jb,Q)}}jrk(Q,xa){const jb=this.Ckh(Q),Nb=this.trk(Q);Q.kgb?(Q.T_c(jb),Q.S0i(Nb)):(xa=xa?jb-Q.top:Nb-Q.q2m,Q.T_c(jb-xa),Q.S0i(Nb-xa),1<Math.abs(xa)&&this.kQn(this.Cx.jBb(Q),
xa))}Qgf(Q){if(!Q)return null;Q=Q.Be(this.mf.Sb);return Q?Q.htmlElement:(ia.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}ZWh(Q){return Q?(Q=Q.Be(this.mf.Sb))?Q.htmlElement:null:null}PPh(Q){Q=Om.GraphIterator.Za(Q);return Q.Ab(23)?Q.kd(23):null}MDl(Q){if(!Q)return null;Q=Q.Be(this.mf.Sb);return Q?sa.a.getElementBounds(Q.htmlElement):(ia.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}NDl(Q){return(Q=
this.MDl(Q))?Q.height/this.Om.vj:0}kQn(Q,xa){xa=(Lh.a.tsl(Q)-xa)*this.Om.vj;this.zTb.add(Object.assign(new Ar,{qf:Q,Oui:xa}))}Byk(){this.tt=new ba.a;this.Kub=new ob.a}}Object(e.a)(Vq,"PageEndMarkerPositionUpdater",null,[1838]);var Wq=c(386),mn=c(38),In=c(880),Kq=c(371),Wm=c(22);class an{constructor(Q,xa,jb,Nb,Bc,gd,be=!1,Bd=!1,Xe=!1,eg=!1,og=!1){this.O$f(xa,jb,Nb,Bc,gd,Xe,og);this.position=Q;this.yj=xa;this.paragraphNode=jb;this.iU=Nb;this.Xib=Bc;this.outlineNode=gd;this.M_a=be;this.Kji=Bd;this.Fbm=
Xe;this.waa=eg;this.ctf=og}w7d(Q){this.yj=Q}O$f(Q,xa,jb,Nb,Bc,gd,be){be||(ia.ULS.shipAssertTag(38326881,336,!!Bc,"PageEndDetails: outlineNode parameter value is null."),ia.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),ia.ULS.shipAssertTag(24126529,336,!!xa||gd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ia.ULS.shipAssertTag(24126530,336,!!jb||gd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ia.ULS.shipAssertTag(24126531,336,!!Nb||gd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static iMk(Q,xa){return an.S_e(0,Q,null,xa,!0,!1)}static jMk(Q){return an.S_e(0,0,null,Q,!1,!0)}static S_e(Q,xa,jb,Nb,Bc,gd){return new an(Q,xa,null,null,jb,Nb,Bc,gd,!0)}static z_b(Q,xa){return new an(0,Q,null,xa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(e.a)(an,"PageEndDetails",null,[]);class Zk{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,Ni,kk,mj,am,zj,yn,
Jk,iq,ar,Kk){this.Hqa=!0;this.Yle=0;this.Zhd=this.Xre=this.Yre=this.Zne=this.cCe=this.Gre=!1;this.akd=this.otb=null;this.mve=!0;this.JGb=()=>{this.DUd()};this.kHf=()=>{this.Yre=!1};this.lHf=()=>{this.Xre=this.Yre=!0};this.pXm=(Ag,nn)=>{1>=Math.abs(nn.delta)||(this.Zne=!0,this.wjj(!nn.Gui))};this.Lln=Ag=>{Ag===this.otb&&(this.otb=null);if(this.Hqa){var nn=Ag.customData;if(Ag=this.HTa.get(nn.id))for(this.HTa.Z(nn.id,new ba.a),ia.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
Ag.count,nn.id),this.d9&&this.d9.eAa(),nn=0;nn<Ag.count;nn++){const Dr=Ag.J(nn),ms=Dr.iU;ms.HardBreak||(Lh.a.Nu(Dr.Xib),this.DTf(ms))}}};this.Kln=()=>{this.akd=null;this.Hqa&&this.pga&&0<this.pga.count&&(ia.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.N3c(this.pga.toArray(),this.Hqa))};this.QH=Q;this.Ci=xa;this.d9=jb;this.bN=Nb;this.WVg=Bc;this.d9a=gd;Zk.Cx=Bd;this.vHg=Xe;this.TH=eg;this.Hb=og;this.xGj=Ni;this.me=mj;this.LY=zj;this.gCe=yn;this.FTb=Jk;
this.qY=iq;this.eTb=new Wq.a;this.ATb=new ba.a;this.pga=new ba.a;this.HTa=new Wq.a;this.LM=kk;this.HY=Kk;this.c_d=this.c_d.bind(this);this.e_d=this.e_d.bind(this);this.p3d=this.p3d.bind(this);this.Maa=this.Maa.bind(this);this.LM.krd(this.JGb);this.dCe=!1;this.XVg=ar;am&&(am.Vah(this.lHf),am.mrd(this.kHf));be&&be.q9j(this.pXm);this.HY.Gvb(this.Maa)}get Usf(){return this.mve}get mf(){return this.QH.value}get Mi(){return this.Ci.value}N3c(Q,xa){const jb=this.me.jg("Task","UpdateMarkers");this.O5n();
this.Hqa=xa;Zk.Cx.tOi();this.eTb=new Wq.a;this.ATb.clear();this.pga.clear();this.HTa=new Wq.a;this.mve=this.Gre=!1;this.bN&&this.bN.N3c(Q);this.T4k();this.Yle=Q.length;this.LY&&this.LY.reset(Q);this.d9&&this.d9.eAa();for(let Nb of Q)this.pga.add(Nb),this.DTf(Nb);xa&&this.bN&&this.gCe&&this.gCe.isEnabled&&(Q=this.bN.EJc(),this.gCe.kWa(Q));this.rDk();this.Zne=this.cCe=!1;this.Xre=this.Yre;kj.WoncaApp.instance.sfb&&Zk.Tmf&&this.bN.H9f();this.d9a.pno(this.bN.EJc(),this.pga.count);this.mve=!0;this.qY.w9f();
jb.stop();ia.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:jb.ri,["RenderedLineCount"]:this.Yle,["AvgDurationPerPageInMs"]:jb.ri/this.gXh()})}jXh(){const Q=this.bN.EJc();if(!Q)return null;const xa=Lh.a.w2(),jb=new ba.a;for(let Nb of Q)this.Ejm(Nb,xa)&&jb.add(Nb);return jb}Ejm(Q,xa){if(!Q)return!1;Q=Zk.Cx.jBb(Q);if(!Q)return!1;Q=sa.a.zLa(Q);return 0<=Q&&Q<=xa}TMh(){const Q=new ba.a;if(!this.HTa)return ia.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const xa=this.HTa.keys;for(let Bc=0;Bc<xa.length;Bc++){var jb=xa.J(Bc);if(jb=this.HTa.J(jb))for(let gd=0;gd<jb.count;gd++){var Nb=jb.J(gd);Nb.iU.HardBreak||Nb.Xib.classList.contains("Hidden")||(Nb=sa.a.zLa(Nb.Xib),Q.add(Nb))}}return Q}O5n(){const Q=this.TMh(),xa=this.jXh();this.WVg.s3f(Q,xa);this.FTb&&this.FTb.isEnabled&&this.FTb.s3f(xa)}rDk(){if(!(25<this.gXh())){var Q=this.TMh(),xa=this.jXh();this.WVg.sDk(Q,xa,this.XVg,this.cCe,this.Gre,this.Zne,this.Xre);this.FTb&&this.FTb.isEnabled&&this.FTb.kWa(xa)}}Maa(){this.d9.Lsn();
this.zAh()}zAh(){this.Zhd&&(this.mf.Ttn(this.c_d),this.mf.Dun(this.e_d),this.mf.jun(this.p3d),this.Zhd=!1)}T4k(){this.Zhd||(this.mf.pah(this.c_d),this.mf.Y9j(this.e_d),this.mf.Qah(this.p3d),this.Zhd=!0)}DTf(Q){if(this.dCe)return!0;Q=this.Ivn(Q);if(!Q)return!1;this.LY&&this.LY.FVl(Q);this.bN&&(this.bN.T5j(Q),this.d9a.sjj(this.bN.EJc()),kj.WoncaApp.instance.sfb&&Zk.Tmf&&this.bN.H9f());return!0}Ivn(Q){let xa=this.O$(Q.ParaId);if(!xa)return null;if(!xa.anchor||!xa.Ui)return this.H$g(Q,xa),null;let jb,
Nb;if(Q.HardBreak){var Bc=Jh.ParagraphReader.eh(xa,!0,!0,!0);this.c4m(Bc)&&(xa=Bc);if(!({oga:Bc,outlineGroupNode:jb,Wib:Nb}=this.Reo(Q,xa)).returnValue)return null;this.Gre=!0}else if(!({ZZd:Bc,outlineGroupNode:jb,Wib:Nb}=this.Jvn(Q,xa)).returnValue)return null;return this.Uqd(xa,Q,Bc,jb,Nb)}c4m(Q){return Q?(Q=Q.Be(this.mf.Sb))?!!Zk.Cx.mHd(Q.htmlElement):!1:!1}Jvn(Q,xa){var jb=Q.PageEndType;let Nb,Bc=0,gd=null;if(!jb){if(!({oga:Q,OKf:Nb}=this.kXh(Q,xa)).returnValue)return{returnValue:!1,ZZd:Bc,outlineGroupNode:gd,
Wib:null}}else if(!({oga:Q,vae:Nb}=this.gEl(Q,xa)).returnValue)return{returnValue:!1,ZZd:Bc,outlineGroupNode:gd,Wib:null};var be=Om.GraphIterator.Za(xa);be.rd();gd=be.kd(23);xa=gd.Be(this.mf.Sb).getBounds();be=be.BPa().Be(this.mf.Sb);if(!be)return ia.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.mf.Sb),{returnValue:!1,ZZd:Bc,outlineGroupNode:gd,Wib:null};const Bd=be.getBounds();Bc=Q-xa.y;jb=Zk.Cx.kRh(jb,Bc,this.Hqa,Nb,xa,Bd);be.r$.appendChild(jb);return{returnValue:!0,
ZZd:Bc,outlineGroupNode:gd,Wib:jb}}Reo(Q,xa){let jb=null;const Nb=xa.Be(this.mf.Sb);var Bc=0;let gd=null;if(this.qRd(Q,Nb,xa))return{returnValue:!1,oga:Bc,outlineGroupNode:jb,Wib:gd};jb=Zk.lui(xa);const be=jb.Be(this.mf.Sb);if(!be)return ia.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.mf.Sb),{returnValue:!1,oga:Bc,outlineGroupNode:jb,Wib:gd};Bc=be.getBounds();Bc=fp.a.tq(Nb,Q.CP).y-Bc.y;gd=this.Jvl(xa);return{returnValue:!0,oga:Bc,outlineGroupNode:jb,Wib:gd}}Jvl(Q){return Q.Be(this.mf.Sb).htmlElement}O$(Q){const xa=
this.TH.keb(Q);if(xa!==zf.a.nil){const jb=this.Mi.Db(xa);if(jb)return jb}ia.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,xa);return null}kXh(Q,xa){const jb=Q.CP;let Nb=0,Bc=null;const gd=xa.Be(this.mf.Sb);if(this.qRd(Q,gd,xa))return{returnValue:!1,oga:Nb,OKf:Bc};Bc=gd.getBounds();Nb=jb?this.vHg(Object(qa.a)(53,gd),jb):Bc.y-this.xGj(gd);return{returnValue:!0,oga:Nb,OKf:Bc}}gEl(Q,xa){let jb=null,Nb=0;var Bc=Q.PageEndType;let gd=Om.GraphIterator.Za(xa);
gd.rd();if(!mn.TableReader.Pv(gd))return ia.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({oga:Nb,OKf:jb}=this.kXh(Q,xa)).returnValue,oga:Nb,vae:jb};if(1===Bc){Wm.returnToContainingRow(gd);Bc=gd.currentNode.Be(this.mf.Sb);if(this.qRd(Q,Bc,xa))return{returnValue:!1,oga:Nb,vae:jb};Nb=Bc.getBounds().y}else{Bc=xa.Be(this.mf.Sb);if(this.qRd(Q,Bc,xa))return{returnValue:!1,oga:Nb,vae:jb};Nb=this.vHg(Object(qa.a)(53,
Bc),Q.CP)}--Nb;xa=null;do Q=xa,xa=gd.kd(14);while(xa);gd=Om.GraphIterator.Za(Q);gd.rd();Wm.moveToFirstRow(gd);jb=gd.currentNode.Be(this.mf.Sb).getBounds();return{returnValue:!0,oga:Nb,vae:jb}}qRd(Q,xa,jb){if(!xa||xa.eOa(16))return this.H$g(Q,jb),!0;xa=xa.getBounds();return xa.width||xa.height?!1:(this.Y9g(Q),!0)}Y9g(Q){this.ATb.contains(Q)||this.ATb.add(Q)}H$g(Q,xa){xa=xa.id;let jb;({value:jb}=this.eTb.Bc(xa)).returnValue||(jb=new ba.a,this.eTb.Z(xa,jb));jb.add(Q)}c_d(){const Q=new ba.a;for(let xa=
this.ATb.count-1;0<=xa;xa--){const jb=this.ATb.J(xa);this.DTf(jb)||Q.add(jb)}this.ATb=Q;this.$We()}$We(){this.bN&&this.bN.$We()&&this.wjj(!1)}wjj(Q){this.bN&&(this.bN.vrk(Q)&&(this.cCe=!0),this.XVg&&this.bN.CAn(),this.d9a.sjj(this.bN.EJc()),kj.WoncaApp.instance.sfb&&Zk.Tmf&&this.bN.H9f())}e_d(Q,xa){try{const jb=xa.id;if(this.eTb.ub(jb)){const Nb=this.eTb.J(jb);for(Q=0;Q<Nb.count;Q++)this.Y9g(Nb.J(Q));this.eTb.remove(jb)}}catch(jb){}}DUd(){this.Hqa&&(this.Hqa=!1,Zk.Cx.DUd())}CUd(){this.Hqa||(this.Hqa=
!0,Zk.Cx.CUd())}w_n(){this.dCe=!1;this.pga&&this.N3c(this.pga.toArray(),this.Hqa);this.d9&&this.d9.D6i()}XZl(){this.dCe=!0;Zk.Cx.tOi();this.d9&&this.d9.A6h();this.LY&&this.LY.YZl()}Uqd(Q,xa,jb,Nb,Bc){const gd=this.pga.indexOf(xa)+1;if(0>gd)return null;const be=Si.WordSectionNavigator.instance.XI(Q),Bd=this.waa(xa,Q);Q=new an(jb,gd,Q,xa,Bc,be,!Q||!xa||!Bc,!1,!1,Bd);this.HTa.ub(Nb.id)||this.HTa.Z(Nb.id,new ba.a);this.HTa.J(Nb.id).add(Q);return Q}waa(Q,xa){if(!Q||!Q.HardBreak)return!1;Q=Om.GraphIterator.Za(xa);
Q.Ab(7);if(Q.dH())return!1;Q.kd(23);return Q.dH()?!1:!0}KMi(Q){this.Hqa&&(Q.anchor&&Q.Ui?!(Q=Zk.lui(Q))||this.otb&&this.otb.customData&&this.otb.customData.id===Q.id||(this.otb=Object.assign(new Fc.a(3,1,500,this.Lln),{customData:Q}),this.Hb.fc(this.otb)):ia.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}p3d(){this.Hqa&&!this.akd&&this.pga&&0<this.pga.count&&(this.akd=new Fc.a(3,1,500,this.Kln),this.Hb.fc(this.akd))}dispose(){this.mf&&
this.zAh();this.HY.nTf(this.Maa);this.LM.oTf(this.JGb)}static get Tmf(){null==Zk.Yse&&(Zk.Yse=F.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Zk.Yse}static Fvl(Q){let xa=0;try{const jb=Q.htmlElement,Nb=Lh.a.gM(jb.firstChild.style.marginTop);Q=0;const Bc=Zk.thf(jb.parentNode);if(Bc){const gd=Bc.firstChild;gd&&gd.classList.contains("ParaWrappingDiv")&&(Q=Lh.a.gM(gd.firstChild.style.marginBottom))}xa=Math.max(Nb,Q)/2}catch(jb){}return xa}static thf(Q){let xa=Q.previousSibling;
if(!xa){var jb=Q.parentNode;Lh.a.isf(jb)&&(jb=jb.parentNode)&&(xa=jb.previousSibling)}if(!xa&&(Q=Q.parentNode,Q.classList.contains(In.a.uDi)||ia.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){xa=Q.lastChild;do{if(xa.classList.contains("OutlineElement")||Lh.a.isf(xa)&&xa.classList.contains(Kq.a.e9b))break;xa=xa.previousSibling}while(xa)}if(xa){if(xa.classList.contains(Kq.a.e9b))return xa.lastChild.lastChild;
if(Lh.a.isf(xa))return xa.lastChild}return xa}static lui(Q){Q=Om.GraphIterator.Za(Q);return Q.Ab(23)?Q.kd(23):null}gXh(){return this.Yle+1}}Zk.Cx=null;Zk.Yse=null;Object(e.a)(Zk,"PageEndMarkers",null,[1696,1697,10]);var Uj=c(116);class vn{constructor(Q,xa,jb){this.o2m=".Outline";this.QH=Q;this.Om=xa;this.Cx=jb}get mf(){const Q=this.QH.value;ia.ULS.shipAssertTag(38416594,336,Q.yi,"Invalid PageView.");return Q}H2b(Q){return(Q=Q.outlineNode)?this.XWh(Q):(ia.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),
null)}XWh(Q){let xa,jb;return(xa=Q.Be(this.mf.Sb))&&(jb=xa.htmlElement)?jb.querySelector(this.o2m):(ia.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}OPh(Q){Q=xq.OutlineElementNavigator.Sk(Q.paragraphNode);let xa;return Q&&(xa=Q.Be(this.mf.Sb))?xa.htmlElement:(ia.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}rkh(Q,xa){const jb=this.fRl(Q);return this.prk(Q,xa)-jb}eRh(Q){return this.cXh(Q.outlineNode,Q.yj)}cXh(Q,xa){if(!Q)return-1;var jb=
Q.ia(Xk.a.ey,-1);jb=xm.a.Ri(jb,1);var Nb=Q.ia(Xk.a.marginTop,-1);Nb=xm.a.Ri(Nb,1);Q=Q.ia(Xk.a.marginBottom,-1);Q=xm.a.Ri(Q,1);return 1===xa?jb-Q:jb-(Nb+Q)}IUk(Q){Q&&Lh.a.Nu(Q.Xib)}nhf(Q){if(Q.Kji||Q.waa)return 0;if(Q.M_a)return Q=this.H2b(Q),sa.a.getElementBounds(Q).height/this.Om.vj;const xa=this.H2b(Q);return this.Cx.AVe(this.iXh(Q),xa)}WJk(Q,xa,jb){jb=jb.Be(this.mf.Sb).getBounds();Q=Q.Be(this.mf.Sb);const Nb=Q.getBounds();jb.y=Nb.y;xa=this.Cx.kRh(0,xa*this.Om.vj,!1,jb,jb,Nb);Q.r$.appendChild(xa);
return xa}J$h(Q,xa){if(Q&&!Q.ctf)if(Q.M_a){if(Q=this.H2b(Q))Q.style.paddingBottom=xa+"px"}else if(Q.iU&&Q.iU.HardBreak)if(Q.waa){if(Q=this.vYh(Q))Q.style.paddingBottom=xa+"px"}else{if(Q=this.OPh(Q))Q.style.paddingTop=xa+"px"}else ia.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Lbh(Q,xa){xa=this.H2b(xa);Q=this.H2b(Q);return sa.a.zLa(xa)-sa.a.zLa(Q)}wYh(Q){Q=Om.GraphIterator.Za(Q.outlineNode);Q.Ab(7);return Q.dH()}Qgi(Q){if(!Q||Q.ctf)return!1;
if(Q.M_a||Q.Kji)return!0;Q=this.iXh(Q);return!!Q&&Lh.a.u$(Q)}AQ(Q){this.Cx.AQ(Q)}vYh(Q){return(Q=this.wYh(Q))?(Q=Q.Ii(this.mf.Sb).htmlElement,Q?Q:(ia.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}iXh(Q){return Q.iU&&Q.iU.HardBreak&&!Q.waa?this.Cx.mHd(Q.Xib):Q.Xib}fRl(Q){if(Q.M_a){Q=this.H2b(Q);if(!Q)return ia.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Uj.a.MB(Q);return Lh.a.Xea(Q.paddingBottom)}if(Q.iU&&Q.iU.HardBreak){if(Q.waa)return(Q=this.vYh(Q))?
Lh.a.Xea(Q.style.paddingBottom):-1;Q=this.OPh(Q);return Q?Lh.a.Xea(Q.style.paddingTop):(ia.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}prk(Q,xa){return this.nhf(Q)-xa}}Object(e.a)(vn,"PageFullHeightDOMHelper",null,[]);class Xq{constructor(){this.delta=this.anj=this.aC=0;this.nga=null;this.hLa=this.CHi=0;this.outlineGroupNode=null;this.iAa=0;this.Rof=new ba.a;this.mzd=new ba.a;this.ANm=new ba.a}}Object(e.a)(Xq,"PageFullHeightInfo",null,[]);class Dp{constructor(Q,
xa){this.Bya=Q;this.Dx=xa}Akh(Q,xa){try{return this.mrk(Q,xa)}catch(jb){return this.Dx.AQ(jb.message+" "+jb.stack),ia.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",jb.message),null}}mrk(Q,xa){ia.ULS.shipAssertTag(38416596,336,Q.M_a||Q.iU.HardBreak);const jb=this.Dx.nhf(Q),Nb=this.Dx.rkh(Q,xa),Bc=this.Bya.okh(Q,Nb);Q=Object.assign(new Xq,{iAa:Nb,hLa:Bc,nga:Q});this.emo(Q);Q.anj=Q.hLa-Q.iAa;Q.delta=xa+Bc+Q.delta-jb;return Q}emo(Q){Q.iAa>Q.hLa?this.fmo(Q):
0>Q.iAa&&this.k9f(Q)}k9f(Q){let xa=Q.nga.yj;for(;0>Q.iAa;)Q.aC--,Q.delta-=this.Bya.kIc(xa),Q.iAa+=this.Bya.kIc(xa-1),xa--;Q.hLa=this.Bya.kIc(xa)}fmo(Q){const xa=this.Dx.eRh(Q.nga);Q.aC=Math.floor((Q.iAa-Q.hLa)/xa)+1;Q.delta=Q.aC*xa;Q.iAa-=Q.hLa+(Q.aC-1)*xa;Q.hLa=xa}}Object(e.a)(Dp,"PageFullHeightInfoCalculator",null,[]);class zq{constructor(Q,xa,jb,Nb){this.cVa=0;this.wJa=null;this.Bya=Q;this.tsb=xa;this.RV=jb;this.Dx=Nb;this.cZg=new ba.a}get DX(){return this.cZg}FVl(Q){try{this.Kkf(Q)}catch(xa){this.Dx.AQ(xa.message+
" "+xa.stack),ia.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",xa.message)}}reset(Q){try{this.Uyn(Q)}catch(xa){this.Dx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",xa.message)}}YZl(){try{this.ZZl()}catch(Q){this.Dx.AQ(Q.message+" "+Q.stack),ia.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}Z7l(Q){try{this.$7l(Q)}catch(xa){this.Dx.AQ(xa.message+
" "+xa.stack),ia.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",xa.message)}}Msn(Q){try{this.Nsn(Q)}catch(xa){this.Dx.AQ("Pagination: "+xa.message+" "+xa.stack),ia.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",xa.message)}}X4l(){var Q=this.RV.Bef(),xa=this.RV.FUh();Q=an.jMk(Q);xa=an.iMk(this.cVa,xa);this.DX.Z(0,Q);this.Kkf(xa)}Yyn(){var Q=Si.WordSectionNavigator.instance.FUh();
(Q=this.Dx.XWh(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}T5l(Q){this.cZg=new ba.a;this.DX.add(null);for(let xa=0;xa<Q.length;xa++){const jb=an.z_b(xa+1,Q[xa]);this.DX.add(jb)}this.DX.add(an.z_b(Q.length+1,null))}E5l(Q){this.Bya.ezn(Q)}Bzn(){if(this.DX)for(let Q of this.DX)Q&&this.Hei(Q)&&this.Dx.J$h(Q,0)}Kkf(Q){const xa=this.HGl(Q);if(this.Dx.Qgi(xa)){let jb=this.Dx.nhf(xa);Q.outlineNode!==xa.outlineNode&&(jb+=this.Dx.Lbh(Q,xa));this.wqk(Q,jb);this.Hei(Q)&&this.ETf(Q,jb)}else this.wJa.add(Q),
20<this.wJa.count&&ia.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.wJa.count);this.DX.Z(Q.yj,Q);this.xVl(Q)}ZZl(){this.Bzn()}Uyn(Q){this.cVa=Q.length+1;this.wJa=new ba.a;this.T5l(Q);this.E5l(this.cVa);this.X4l();this.Yyn()}$7l(Q){this.Bya.sno(Q);for(let xa of Q){if(!xa){ia.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<xa.aC){Q=xa.nga.yj;for(let jb of xa.Rof)this.DX.insert(Q,jb),Q++}else if(0>xa.aC)for(let jb of xa.mzd)this.DX.remove(jb),this.wJa.contains(jb)&&
this.wJa.remove(jb)}this.CRi()}Nsn(Q){Q=Q.yj;this.Bya.Osn(Q);this.DX.removeAt(Q);for(let xa of this.wJa)xa.yj===Q&&this.wJa.remove(xa);this.CRi()}wqk(Q,xa){xa=this.Dx.rkh(Q,xa);this.Bya.okh(Q,xa)}ETf(Q,xa){Q.iU&&Q.iU.HardBreak||this.tsb.ETf(Q,xa)}xVl(Q){Q=Q.yj+1;for(let xa of this.wJa)if(xa&&xa.yj===Q){this.Kkf(xa);this.wJa.remove(xa);break}}CRi(){for(let Q=0;Q<this.DX.count;Q++){const xa=this.DX.J(Q);xa&&xa.w7d(Q)}}Hei(Q){Q=this.ZDl(Q);return 2===Q||1===Q}HGl(Q){return this.DX.J(Q.yj-1)}ZDl(Q){return Q.M_a?
2:Q.iU&&Q.iU.HardBreak?1:0}}Object(e.a)(zq,"PageFullHeightManager",null,[1735]);class Pp{constructor(Q,xa,jb,Nb){this.tsb=Q;this.Bya=xa;this.RV=jb;this.Dx=Nb}create(){return new zq(this.Bya,this.tsb,this.RV,this.Dx)}}Object(e.a)(Pp,"PageFullHeightManagerFactory",null,[]);var up=c(1068),Qp=c(596);class Qn{constructor(Q,xa,jb,Nb,Bc){this.BTb=null;this.LY=Q;this.bN=xa;this.ktc=jb;this.tsb=Nb;this.Dx=Bc}reset(){this.BTb=new ba.a}lrk(Q,xa,jb){try{return this.nrk(Q,xa,jb)}catch(Nb){return ia.ULS.sendTraceTag(38897350,
336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Nb.message),null}}zAn(){try{this.AAn()}catch(Q){ia.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}nrk(Q,xa,jb){if(!this.LY.DX.count)return null;const Nb=this.eEl(Q,!Q);if(!Nb||Nb.ctf)return ia.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Nb.iU&&Nb.iU.HardBreak)return null;
var Bc=this.LY.DX.J(Nb.yj-1);return this.Dx.Qgi(Bc)&&(xa-=jb,Nb.outlineNode!==Bc.outlineNode&&(xa+=this.Dx.Lbh(Nb,Bc)),(Bc=this.ktc.Akh(Nb,xa))&&1<Math.abs(Bc.delta))?(Bc.CHi=xa,Bc.outlineGroupNode=this.LDl(Q,Nb),this.BTb.add(Bc),this.k9f(Bc),Bc):null}LDl(Q,xa){return xa&&xa.M_a?(Q=Object(qa.a)(Qp.a,Jh.ParagraphReader.dK(xa.outlineNode)),Q=Om.GraphIterator.Za(Q),Q.ro(),Object(qa.a)(up.a,Q.kd(23))):Q&&Q.kgb?Q.outlineGroupNode:null}AAn(){this.BTb.Sc((Q,xa)=>xa.nga.yj-Q.nga.yj);for(let Q of this.BTb)this.tsb.jRi(Q);
this.vno()}vno(){this.bN.value.X7l(this.BTb);this.LY.Z7l(this.BTb)}eEl(Q,xa){return xa?this.LY.DX.J(this.LY.DX.count-1):this.LY.DX.J(Q.yj)}k9f(Q){let xa=Q.nga.yj;const jb=-Q.aC;for(let Nb=0;Nb<jb;Nb++)xa--,Q.mzd.add(this.LY.DX.J(xa))}}Object(e.a)(Qn,"PageFullHeightPositionUpdater",null,[1736]);class go{constructor(Q,xa,jb,Nb,Bc){this.LY=Q;this.bN=xa;this.ktc=jb;this.tsb=Nb;this.Dx=Bc}create(){return new Qn(this.LY,this.bN,this.ktc,this.tsb,this.Dx)}}Object(e.a)(go,"PageFullHeightPositionUpdaterFactory",
null,[]);class Br{constructor(Q,xa){this.Dx=Q;this.ktc=xa}ETf(Q,xa){try{this.Mvn(Q,xa)}catch(jb){this.Dx.AQ(jb.message+" "+jb.stack),ia.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",jb.message)}}jRi(Q){try{this.Lvn(Q)}catch(xa){this.Dx.AQ(xa.message+" "+xa.stack),ia.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",xa.message)}}Mvn(Q,xa){ia.ULS.shipAssertTag(38285913,336,Q.M_a||Q.iU.HardBreak);Q=this.ktc.Akh(Q,
xa);this.jRi(Q)}Lvn(Q){this.Kvn(Q);this.Cvn(Q)}Cvn(Q){0<Q.aC?this.i8l(Q):0>Q.aC&&this.JUk(Q)}Kvn(Q){this.Dx.J$h(Q.nga,Q.anj)}i8l(Q){let xa=Q.CHi+Q.hLa;for(let Nb=0;Nb<Q.aC;Nb++){var jb=Q.nga.yj+Nb;const Bc=Q.nga.waa?this.Dx.wYh(Q.nga):Q.nga.outlineNode;jb=this.VJk(Bc,Q.outlineGroupNode,xa,jb);Q.Rof.add(jb);Q.ANm.add(xa);xa+=Q.hLa}}JUk(Q){for(let xa of Q.mzd)this.Dx.IUk(xa)}VJk(Q,xa,jb,Nb){xa=this.Dx.WJk(Q,jb,xa);return an.S_e(jb,Nb,xa,Q,!1,!1)}}Object(e.a)(Br,"PageFullHeightRenderer",null,[]);class dq{constructor(Q){this.tQf=
Q}}Object(e.a)(dq,"PageHeightDeltaResult",null,[1734]);class fn{constructor(Q,xa,jb){this.Xp=null;this.Dx=Q;this.Hh=xa;jb.execute(Nb=>{Nb.register(this)})}get hSc(){return"PageHeightDelta"}get result(){return this.Xp}get BEf(){return 1}get HWf(){return 500}get isEnabled(){return!0}HEf(){this.Xp=null}kWa(Q){this.Hh.Qd(()=>{try{this.oAc(Q)}catch(xa){ia.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",xa.message)}},"PHDM:C")}oAc(Q){this.Xp=null;Q=
this.pAc(Q);-1!==Q&&(this.Xp=new dq(Q))}pAc(Q){if(!Q.count)return-1;let xa=0,jb=0;for(let Nb of Q)Q=this.ork(Nb),-1!==Q&&(xa+=Q,jb++);return jb?xa/jb:-1}ork(Q){if(!Q.Fem)return-1;const xa=this.Dx.cXh(Q.ctd,Q.yj);return-1===xa?-1:Math.abs(Q.height-xa)}}Object(e.a)(fn,"PageHeightDeltaMetric",null,[1691]);class gp{constructor(Q){this.ASa=null;this.Dx=Q}kIc(Q){return this.ASa.J(Q-1)}ezn(Q){this.ASa=new ba.a;for(let xa=0;xa<Q;xa++)this.ASa.add(-1)}okh(Q,xa){if(this.Fjm(Q))return this.ASa.J(Q.yj-1);xa=
this.Nqk(Q,xa);this.P5n(Q,xa);return xa}sno(Q){for(let xa of Q)this.rno(xa)}P5n(Q,xa){this.ASa.Z(Q.yj-1,xa)}Osn(Q){this.ASa.removeAt(Q-1)}rno(Q){if(Q)if(0<Q.aC){var xa=Q.nga.yj;for(var jb=0;jb<Q.aC;jb++)this.ASa.insert(xa,Q.hLa)}else if(0>Q.aC)for(xa=-Q.aC,Q=Q.nga.yj-xa,jb=0;jb<xa;jb++)this.ASa.removeAt(Q)}Fjm(Q){return-1!==this.ASa.J(Q.yj-1)}Nqk(Q,xa){if(Q.M_a||Q.iU.HardBreak)Q=this.Dx.eRh(Q),xa=xa<Q?Q:xa;return xa}}Object(e.a)(gp,"PageHeightStorage",null,[]);var Jn=c(123);class il{constructor(Q){this.tQf=
Q}}Object(e.a)(il,"PageLevelDeltaResult",null,[1734]);class hp{constructor(Q,xa,jb,Nb){this.Xp=null;this.QH=Q;this.ira=xa;this.Hh=jb;Nb.execute(Bc=>{Bc.register(this)})}get mf(){const Q=this.QH.value;ia.ULS.shipAssertTag(39081438,336,Q.yi,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get hSc(){return"PageLevelDelta"}get result(){return this.Xp}get BEf(){return 0}get HWf(){return 60}get isEnabled(){return!0}HEf(){this.Xp=null}kWa(Q){this.Hh.Qd(()=>{try{this.oAc(Q)}catch(xa){ia.ULS.sendTraceTag(39081440,
324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",xa.message)}},"PLDM:C")}oAc(Q){this.Xp=null;Q=this.pAc(Q);-1!==Q&&(this.Xp=new il(Q))}pAc(Q){if(!Q.count)return-1;let xa=0,jb=0;for(let Nb of Q)Q=this.qrk(Nb),-1!==Q&&(xa+=Q,jb++);return jb?xa/jb:-1}qrk(Q){if(Q.kgb)return-1;var xa=Q.iU.CP;Q=Q.paragraphNode;ia.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.Be(this.mf.Sb);ia.ULS.shipAssertTag(39081442,324,Object(Jn.a)(53,Q));let jb;({Qth:xa,fmi:Q,HUi:jb}=this.crk(Q,Lh.a.Rz(Q.htmlElement).length,
xa));return Q&&jb?Math.min(xa.x-Q.x,jb.x-xa.x):(ia.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}crk(Q,xa,jb){let Nb,Bc,gd,be=Bc=jb,Bd=gd=Nb=null;if(jb>xa)return ia.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{Qth:Bd,gtm:be,fmi:gd,gCn:Bc,HUi:Nb};Bd=this.ira.tq(Q,jb);for(var Xe=0,eg=jb;Xe<=eg;){let og=Math.floor((Xe+eg)/2),Ni=this.ira.tq(Q,
og);if(Xe===eg){be=og;gd=Ni;break}Ni.y+Ni.height<=Bd.y?Xe=og+1:eg=og}for(;jb<=xa;){Xe=Math.ceil((jb+xa)/2);eg=this.ira.tq(Q,Xe);if(jb===xa){Bc=Xe;Nb=eg;break}eg.y>=Bd.y+Bd.height?xa=Xe-1:jb=Xe}return{Qth:Bd,gtm:be,fmi:gd,gCn:Bc,HUi:Nb}}}Object(e.a)(hp,"PageLevelDeltaMetric",null,[1691]);class Ep{constructor(Q,xa,jb,Nb,Bc,gd,be){this.yj=Q;this.top=xa;this.A7g=jb;this.height=Nb;this.hMb=Bc;this.ctd=gd;this.Fem=be}}Object(e.a)(Ep,"Page",null,[]);class ik{constructor(Q,xa,jb,Nb,Bc){this.uTb=null;this.t3g=
0;this.QH=Q;this.c$c=xa;this.VVg=jb;this.yIa=Nb;this.YVg=Bc;this.JTa=new ba.a}get mf(){const Q=this.QH.value;ia.ULS.shipAssertTag(37007393,336,Q.yi,"PageManager.PageView is not a PageView.");return Q}get hm(){return this.JTa}sjj(Q){Q=this.KLi(Q);this.ujj(Q)}pno(Q,xa){this.t3g=xa;Q=this.KLi(Q);this.ujj(Q);this.YVg.isEnabled&&this.YVg.kWa(Q)}KLi(Q){this.JTa=new ba.a;this.uTb=new Wq.a(0);const xa=new ba.a;if(!Q)return this.hm;var jb=0,Nb=null;for(let Bc=0;Bc<Q.count;Bc++){const gd=Q.J(Bc);jb=gd.yj;Nb=
this.Uxd(jb,Nb,gd);this.hm.add(Nb);!ik.fAe&&0>Nb.height&&xa.add(Nb);Nb=gd}Q=this.Uxd(jb+1,Nb,null);this.hm.add(Q);!ik.fAe&&0>Q.height&&xa.add(Q);for(let Bc of xa)ik.fAe=!0,ia.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+Bc.yj);return this.hm}Uxd(Q,xa,jb){const Nb=xa?xa.outlineNode:this.yIa.oSh(),Bc=jb?jb.outlineNode:this.yIa.OUh();var gd=this.dXh(Nb);const be=this.dXh(Bc),Bd=xa?this.ykh(xa):0;gd=Bd+gd;const Xe=jb?this.ykh(jb):this.c$c.D1a.clientHeight-be;
return new Ep(Q,Bd,gd,Nb.id===Bc.id?Xe-Bd:Xe+be-gd,Nb,Bc,(jb?jb.yj:this.t3g+1)===(xa?xa.yj:0)+1)}ykh(Q){return Q.waa?0:Q.top}ujj(Q){if(this.VVg.YZd)for(let xa of this.VVg.YZd)xa&&xa.vjj(Q)}dXh(Q){this.uTb||(this.uTb=new Wq.a(0));if(this.uTb.ub(Q.id))return this.uTb.J(Q.id);var xa=Q.Be(this.mf.Sb);if(!xa)return ia.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;xa=sa.a.aZa(this.c$c.D1a,xa.htmlElement).y;this.uTb.Z(Q.id,xa);return xa}}ik.fAe=!1;Object(e.a)(ik,
"PageManager",null,[1692]);var ym=c(635);class Aq{constructor(Q,xa,jb,Nb,Bc,gd,be){this.C$f=this.E1a=!1;this.ga=Q;this.hda=xa;this.YRa=jb;this.tt=Nb;this.Ti=Bc;this.$Vg=gd;this.PD=be;this.E1a=0===this.PD.Qw?!0:!1;this.HFf=this.HFf.bind(this);this.PD.rah(this.HFf)}Vb(){this.ga.gb(Vf.a.IWc,ti.a.application,this.IWc.bind(this),96);this.ga.gb(Vf.a.u2d,ti.a.application,this.u2d.bind(this),96);this.ga.gb(Vf.a.ube,ti.a.application,this.ube.bind(this),96);this.ga.gb(Vf.a.rbe,ti.a.application,this.rbe.bind(this),
8)}ube(Q,xa,jb){return 1===jb?32:this.ga.processAction(Vf.a.d4a,2)}rbe(Q,xa,jb,Nb){if(1===jb)return 0===this.PD.Qw?32:8;this.E1a?(this.tBh(),this.C$f=!0):(this.JEh(),this.C$f=!1);this.Ti.updateCommandUI();Nb.Mr=this.E1a?1:0;return 32}IWc(Q,xa,jb,Nb,Bc){if(1===jb)return 32;Q=this.$Vg.$Jc();-1===Q?Q="":this.E1a||1===this.PD.Qw?(xa=this.$Vg.mql(),xa>Q&&(Q=xa),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,xa,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);Bc[ym.a.Visible]=!0;Bc[ym.a.LabelText]=Q;return 32}u2d(Q,xa,jb,Nb,Bc){if(1===jb)return 32;Bc[vi.a.On]=this.E1a;return 32}HFf(Q,xa){0!==xa.q$b||this.C$f?this.tBh():this.JEh()}JEh(){this.E1a||(this.YRa.d3k(),this.tt.w_n(),this.E1a=!0)}tBh(){this.E1a&&(this.YRa.gYk(),this.tt.XZl(),this.E1a=!1)}}Object(e.a)(Aq,"PaginationActor",null,[]);class jl{constructor(Q){this.tQf=Q}}Object(e.a)(jl,"PaginationDeltaResult",null,[1734]);class Jc{constructor(Q,
xa){this.Rsb=this.had=null;this.Hh=Q;xa.execute(jb=>{jb.register(this)})}get hSc(){return"PaginationDelta"}get result(){return this.had}get BEf(){return 1}get HWf(){return 200}get isEnabled(){return!0}HEf(){this.had=null}kWa(Q){this.Hh.Qd(()=>{try{this.oAc(Q)}catch(xa){ia.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",xa.message)}},"PDM:C")}s3f(Q){this.Rsb=Q}oAc(Q){this.had=null;Q=this.pAc(this.Rsb,Q);-1!==Q&&(this.had=new jl(Q))}pAc(Q,xa){if(!(Q&&
xa&&Q.count&&xa.count))return-1;const jb=new ba.a;for(let Nb of Q)jb.add(Nb.top);Q=new ba.a;for(let Nb of xa)Q.add(Nb.top);xa=this.WCd(jb,Q);return this.QZb(xa)}QZb(Q){if(!Q.count)return 0;let xa=0;for(let jb=0;jb<Q.count;jb++)xa+=Q.J(jb);return xa/Q.count}WCd(Q,xa){const jb=new ba.a;if(!Q.count||!xa.count)return jb;var Nb=Q.count<=xa.count;const Bc=Nb?Q:xa;Q=Nb?xa:Q;for(xa=0;xa<Bc.count;xa++){Nb=Bc.J(xa);let be=Math.abs(Nb-Q.J(0)),Bd=0;for(let Xe=1;Xe<Q.count;Xe++){var gd=Q.J(Xe);gd=Math.abs(Nb-
gd);gd<be&&(be=gd,Bd=Xe)}jb.add(be);Q.removeAt(Bd)}return jb}}Object(e.a)(Jc,"PaginationDeltaMetric",null,[1691]);var zm=c(406),ho=c(1359),U=c(1890);class la extends zm.a{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd=null){super();this.XM=null;this.Xle=0;this.cVa=-1;this.eqb=!1;this.k7=()=>{ia.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.vBh()};this.hHf=()=>{if(0==this.HY.Qw){var Xe=this.XM.ku;zf.a.Jp(Xe,this.CSb)||(this.CSb=Xe,this.iWm(this.ZHa,this.CSb))}};
this.HY=Q;this.Maa=this.Maa.bind(this);this.HY.Gvb(this.Maa);this.ga=xa;this.tt=jb;this.qY=Nb;this.hja=Bc;this.$xe=Bd||Um.a.instance;this.CSb=this.ZHa=zf.a.nil;this.sMj=be;gd.CWR(()=>gd.result.cB.IVa(this.k7));this.s0b();this.Xj=new ho.a(1E3);this.Xj.lXa();this.hja.register(this)}get gna(){return"Pagination"}get D0b(){return this.sMj.value}get $rm(){return this.ZHa}get idj(){return this.cVa}aTn(Q){this.cVa!==Q&&(this.cVa=Q,this.qY.w9f())}Maa(){this.ZHa=this.CSb=zf.a.nil;this.s0b()}wib(Q){this.XM=
Q;this.XM.xXb(this.hHf);this.hXb(this.XM.node)}iWm(Q,xa){zf.a.Jp(Q,xa)?(this.tt.CUd(),this.s0b()):(this.tt.DUd(),this.G4n())}k3k(){this.enabled=2}s0b(){this.enabled=0}G4n(){this.Xle=0;this.k3k();this.kE(null,null,null)}Yla(){return Ie.App.lostSession||Ie.App.vd.cB.Bo?!1:!!(this.enabled&2)&&this.Xj.IW()}kE(){this.Xj.mdb();this.hja.rU()}forceOutbound(){}z2(){return 0===this.enabled?!1:this.he&&2===this.he.status?!0:this.Yla()}oPa(){if(1===this._state)this.he.Zr=U.a.d$(F.AFrameworkApplication.rootQuerySignature,
this.ZHa),this.he.mH="Pagination",this.he.status=1,this._state=3;else if(3===this._state&&this.he&&2===this.he.status)if(F.AFrameworkApplication.Tk)this._state=4;else if(this.Xj.e0(),this.Xj.D6(),this._state=1,this.Xle++,2!==this.he.statusCode)this.t0b();else if(1!==(this.he.hk?this.he.hk.length:0))this.t0b();else{var Q=this.he.hk[0];this.$xe.Fmb(Q);104===Q.StatusCode?this.vBh():101===Q.StatusCode?this.t0b():3===Q.StatusCode?this.t0b():Q.StatusCode?this.t0b():Q.PageEnds?(this.aTn(Q.PageEnds.length+
1),this.ZHa=xj.b(Q.LastKnownPaginationRevision),ia.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.cVa,this.ZHa),this.tt.N3c(Q.PageEnds,zf.a.Jp(this.ZHa,this.CSb)),this.D0b.pga=Q.PageEnds,this.qY.vVe(),ia.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.cVa,this.ZHa),
this.pYk()):this.t0b()}}vBh(){this.XM&&this.XM.YIb(this.hHf);this.s0b()}t0b(){60<this.Xle&&this.s0b()}pYk(){zf.a.Jp(this.ZHa,this.CSb)&&this.s0b()}dispose(){this.XM&&(this.XM.YIb(this.hHf),this.XM.node&&this.NXc(this.XM.node),this.XM=null);this.HY.nTf(this.Maa)}hXb(Q){Q&&(Q.addListener(this),this.eqb=!0)}NXc(Q){this.eqb&&Q&&(Q.removeListener(this),this.eqb=!1)}UGb(Q){this.NXc(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.Ad.Am)&&this.iTm(this.ZHa,Q.id)}onAfterFirstSaveContent(){}iTm(Q,xa){zf.a.Jp(Q,
xa)&&this.tt.CUd()}}Object(e.a)(la,"PaginationReplicator",zm.a,[1684,10,86]);class kb{constructor(){this.d9=this.tt=this.qY=this.YRa=this.Wu=null;this.yqa=!1;this.Uck=()=>{this.Och()}}get name(){return"WordEditor.Pagination"}get kvo(){return F.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}zc(Q){this.W=Q;this.Ic=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new un(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new mi(new tb.a(()=>Ie.App.xa.jb.Fc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new ik(new tb.a(()=>Ie.App.xa.jb.Fc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();
this.W.ha("WordEditor.IPaginationReplicator",()=>new la(this.W.resolve("WordEditor.IMainViewModeManager"),F.AFrameworkApplication.ya,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),Gh.App.R_,Ie.App.Ula(),new tb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new tp(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new hp(new tb.a(()=>Ie.App.xa.jb.Fc),this.W.resolve("Box4.ITextMetricsAdapter"),cb.a.instance,this.W.$a("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new fn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),cb.a.instance,this.W.$a("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",
()=>new Jc(cb.a.instance,this.W.$a("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new gp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new vn(new tb.a(()=>Ie.App.xa.jb.Fc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",
()=>new Dp(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Br(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new go(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
this.W.Ze("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",
()=>new Vq(new tb.a(()=>Ie.App.xa.jb.Fc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),Ie.App.ik.ml)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Pp(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),
this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Si.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Jq(this.W.resolve("Common.IZoomManager"),cb.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();
this.W.ha("WordEditor.Pagination.PaginationActor",()=>new Aq(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),F.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new qo(new tb.a(()=>Ie.App.xa.jb.Fc),On.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new Uq(F.AFrameworkApplication.ya,Ne.a.instance,Fg.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new tb.a(()=>Ie.App.xa.jb.Fc),this.W.Pa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.tt=new Zk(new tb.a(()=>Ie.App.xa.jb.Fc),new tb.a(()=>Ie.App.xa.jb.Xc.Ad),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),fp.a.iJc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),Fg.a.instance,Zk.Fvl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Wn.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.kvo,this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new yj(this.W.$a("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Ie.App.instance&&Ie.App.instance.XB)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new rj(F.AFrameworkApplication.uc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Hn(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentManager",
()=>this.d9=new xk(new tb.a(()=>Ie.App.xa.jb.Fc),vh.a.instance,rg.a.instance,le.a.instance,F.AFrameworkApplication.ya,Pn.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Fg.a.instance,F.AFrameworkApplication.K,!!Ie.App.instance&&Ie.App.instance.XB,!!Ie.App.instance&&Ie.App.instance.Cma)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.Ic.io.continueWith(()=>
{this.Wm()})}Wm(){const Q=Ie.App.xa.jb;Q.Xta?this.Och():Q.zda(this.Uck)}Och(){this.yqa||(this.yqa=!0,this.YRa=oa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.qY=oa.a.instance.resolve("Common.ICurrentPageCalculator"),this.Wu=oa.a.instance.resolve("WordEditor.IPaginationReplicator"),oa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Vb())}dispose(){this.d9&&(this.d9.dispose(),this.d9=null);this.tt&&(this.tt.dispose(),this.tt=null);this.Wu&&(this.Wu.dispose(),this.Wu=null);this.qY&&
(this.qY.disable(),this.qY=null);this.YRa&&(this.YRa=null)}}Object(e.a)(kb,"PackageManager",null,[1,2]);class Vb{constructor(){this.W=null}zc(Q){this.W=Q||oa.a.instance}dispose(){}}Object(e.a)(Vb,"TellMePackage",null,[1,2]);var mc=c(1449),Uc=c(1451),Nd=c(282),xd=c(1447),Oe=c(1347);class Jf{constructor(Q=null,xa=null,jb=null,Nb,Bc=null){this.Fhe=null;this.Dvg=!1;this.KFg=this.oOb=null;this.MWj=this.r1g=this.Exj=this.LFg=!1;this.Q8c=null;this.Uxj=null==xa?F.AFrameworkApplication.dwb:xa;this.jJj=null==
jb?F.AFrameworkApplication.JZ:jb;this.uXj=null==Bc?F.AFrameworkApplication.z3a:Bc;this.OHj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.eZj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.ZSn(!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.WYj=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.DPc;this.XYj=!xd.a.maa()&&!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.VYj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.LEj=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.LKb;this.YYj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.oWj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.GQj=this.p0c||this.o0c;this.EQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.FQj=this.wsf;this.vLj=!!F.AFrameworkApplication.K&&this.BQa&&F.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.oGj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.UGj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.cGj=F.AFrameworkApplication.K?parseFloat(F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.sLj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.dYj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.YGj=F.AFrameworkApplication.K?
F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.pWj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.fXj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.IWj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||
this.uO;this.FLj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.TKj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.lLj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
F.AFrameworkApplication.uiCulture;this.CLj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.SLj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Gxj=this.BQa&&!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.vHj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.lXj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==F.AFrameworkApplication.K.lb("Application"));this.gzj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.P_j=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||F.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled"));this.GJj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.KJj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.mLj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.fVj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.Mwj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.TGj=F.AFrameworkApplication.K?
F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.ELj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.Tnm;this.IJj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.JJj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.HJj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.ZYj=this.Aji&&(this.KJf||this.LJf||this.dUc||this.BQa&&xd.a.OCa()&&!!F.AFrameworkApplication.K&&(this.Rec||this.PKb||this.QKb||this.RKb||this.TKb||F.AFrameworkApplication.K.$("ShowAnswerSearchResults")||F.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||F.AFrameworkApplication.K.$("ShowEntitySearchResults")||F.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.Nwj=!!F.AFrameworkApplication.K&&!F.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&F.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&F.AFrameworkApplication.Zvb;this.Owj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.G4l(Q||{});this.vGe="2918242107";this.uGe="1454393937";this.Dsb={};this.A$a=[];this.PGk=[xd.a.jce]}get application(){return this.oOb}get dwb(){return this.Uxj}get HFn(){return this.vGe}get GFn(){return this.uGe}get I9e(){return this.KFg}get bJh(){return this.LFg}get JZ(){return this.jJj}get z3a(){return this.uXj}get Wvb(){return this.Exj}get FZl(){return this.OHj}get h$n(){return this.eZj}get Aji(){return!0}get Y9n(){return this.ZYj}get WVn(){return this.r1g}ZSn(Q){this.r1g=
Q}get BQa(){return this.WYj}get e2c(){return this.XYj}get c2c(){return this.VYj}get w9k(){return this.LEj}get W9n(){return this.YYj}get Pbe(){return!1}get dUc(){return this.GQj}get KJf(){return this.EQj}get LJf(){return this.FQj}get $_a(){return!1}get VQd(){return!1}get juf(){return this.vLj}get G8d(){return this.MWj}get Rec(){return!1}get qXn(){return!1}get ftm(){return""}get $ff(){return 2}get xHl(){return 4}get yHl(){return 5}get o_h(){return""}get itl(){return this.oGj}get F_h(){return this.UGj}get q_h(){return 1E3}get p_h(){return 1E-6}get z6n(){return this.dYj}get Q3f(){return!1}get I$i(){return!1}get Llm(){return this.lLj}get FQd(){return!1}get GQd(){return!1}get egi(){return!1}get dgi(){return!1}get Tnm(){return!1}get Bji(){return!1}get KCd(){return!1}get $kb(){return!1}get PKb(){return!1}get QKb(){return!1}get RKb(){return!1}get TKb(){return!1}get p0c(){return this.oWj}get Mec(){return this.pWj}get o0c(){return!1}get kdf(){return null}get AQd(){return!1}get y8d(){return this.IWj}get BWh(){return 0}get lnl(){return this.cGj}get j0h(){return this.YGj}get Nmm(){return this.sLj}get GBl(){return-3.9}get uO(){return this.fXj}get EPc(){return this.FLj}get Hsf(){return this.TKj}get Auf(){return this.CLj}get oab(){return this.Gxj}get Upm(){return this.SLj}get KBa(){return this.vHj}get E7i(){return this.lXj}get Dlk(){return this.gzj}get Jde(){return this.P_j}get MNd(){return this.GJj}get aam(){return this.KJj}get Wlm(){return this.mLj}get bXi(){return this.fVj}get aak(){return this.Mwj}get Nv(){return this.TGj}get Sgb(){return this.ELj}get Z$l(){return this.IJj}get $$l(){return this.JJj}get Y$l(){return this.HJj}get bak(){return this.Nwj}get cak(){return this.Owj}get hEb(){return!!F.AFrameworkApplication.ta&&
F.AFrameworkApplication.ta.Rb.hq}get hq(){return!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.hq}get wim(){return!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.Pec}get XNm(){return Ic.getImageClass("OfficeAssistant_32x32x32")}PFd(){return Promise.reject("GetFindMatchCount method is not overridden")}jRd(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}yOd(){return!1}get PPd(){return!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get sbj(){return F.AFrameworkApplication.K?
F.AFrameworkApplication.K.lb("TellMeServiceHelpClassifierModelName"):""}get wsf(){return!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get eCb(){return"NoOpHeaderUi"}get IGk(){return this.Q8c}get parameterData(){return this.Dsb}get Hfo(){return this.A$a}v5k(){if(this.Fhe&&!this.Dvg&&(this.Dvg=!0,this.Qkb(this.Fhe),this.hq)){var Q=oa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new Oe.a(Q)).nEd(this.Fhe.kG);appChrome.api.dispatch(Q)}}get OWf(){return""}Qkb(){}ZWk(Q){const xa=
[];for(let jb=0;jb<Q.length;++jb)Q[jb].mYn?xa.push(new Nd.a(Q[jb].alternate,xd.a.Gfj+jb.toString())):xa.push(new Nd.a(Q[jb].standard,xd.a.jce+jb.toString()));return xa}G4l(Q){const xa={};for(let jb in Q){const Nb=jb,Bc=Q[jb];for(let gd in Bc){const be=gd,Bd=Bc[gd];(xa[be]||(xa[be]={}))[Nb]=Bd}}this.Q8c=xa}get ubj(){return""}get tbj(){return""}get A6i(){return!1}}Object(e.a)(Jf,"TellMeApplicationData",null,[1119]);class fh{constructor(Q,xa=null,jb=!1){this.standard=Q;this.alternate=xa;this.mYn=jb}}
Object(e.a)(fh,"TryQuerySet",null,[]);class ih{constructor(){this.sSg=this.tSg=null}get CLm(){return this.sSg}fea(Q){this.tSg=Q;return this.M0e(Q)}YOm(){this.sSg=this.tSg}CGd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.cC):Q.cC}Icf(Q){return Q.cC}}Object(e.a)(ih,"ParameterizedCommand",null,[]);class Qg extends ih{constructor(Q){super();this.sPc=Q}get commandId(){return this.sPc?"DefinitionsParameterized":"DefinitionButton"}get $Kf(){return"Definition"}M0e(Q){const xa=
Pb.a.Ff(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.cC));return Db.a(xd.a.E1e(Q.value),Ra.a.i3e.toString(),xa,xd.a.Tof,null,Pb.a.Ff(xd.a.Zxb(Q.cC)),xa,null,null)}CGd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.cC)}Icf(Q){return xd.a.Zxb(Q.cC)}}Object(e.a)(Qg,"DefinitionsParameterizedCommand",ih,[]);class hi extends ih{constructor(Q){super();this.sPc=Q}get commandId(){return this.sPc?F.AFrameworkApplication.ta.Rb.Vem?
"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get $Kf(){return"Find"}M0e(Q){const xa=Pb.a.Ff(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.cC));return Db.a(xd.a.E1e(Q.value),Ra.a.findInDocument.toString(),xa,"Find_16x16x32",null,Pb.a.Ff(Q.cC),xa,null,null)}CGd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.cC)}}Object(e.a)(hi,"FindParameterizedCommand",ih,[]);class lj extends ih{constructor(Q){super();this.sPc=Q}get commandId(){return this.sPc?
"SynonymsParameterized":"SynonymButton"}get $Kf(){return"Synonym"}M0e(Q){const xa=Pb.a.Ff(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,Q.cC));return Db.a(xd.a.E1e(Q.value),Ra.a.i3e.toString(),xa,xd.a.Tof,null,Pb.a.Ff(xd.a.Zxb(Q.cC)),xa,null,null)}CGd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.cC)}Icf(Q){return xd.a.Zxb(Q.cC)}}Object(e.a)(lj,"SynonymsParameterizedCommand",ih,[]);var Oj=c(1899),Uh=c(1818),tk=c(1920),
Il=c(1894),Ai=c(1895),ql=c(1523);class ph extends Oj.a{constructor(){super(...arguments);this.gS=null;this.$Ua=Uh.FindManager.createInstance(this,tk.a.instance,ql.a.instance,!0,!0)}static get instance(){return ph._instance}I1b(){this.gS(this.$Ua.Fj.yha);this.$Ua.mWa(!0)}PFd(Q){const xa=new Promise((jb,Nb)=>{this.gS=jb;setTimeout(()=>{Nb("Find manager execution timed out");this.$Ua.mWa(!0)},500)});Q=Il.a.createQuery(Q,Ai.a.none);this.$Ua.find(Q);return xa}}ph._instance=new ph;Object(e.a)(ph,"TellMeFindStatusSpy",
Oj.a,[]);class Gi extends Jf{constructor(Q){super({});this.oOb="Word";this.BGj=Q;F.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.LFg=!0,this.KFg=this.KCd?"FindWithMatchesParameterized":"FindParameterized");Q=new Qg(this.hEb);const xa=new lj(this.hEb);this.parameterData[Q.commandId]=Q;this.parameterData[xa.commandId]=xa;F.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&(Q=new hi(this.hEb),this.parameterData[Q.commandId]=Q);F.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&
(Q=[new fh(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new fh(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new fh(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new fh(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new fh(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.A$a=this.ZWk(Q))}PFd(Q){return ph.instance.PFd(Q)}get F2a(){return dl.AppFrame.coa}get eCb(){return dl.AppFrame.rMa}get OWf(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Qkb(Q){var xa=
F.AFrameworkApplication.K;Q=Q.kG;Q.WordCountFlyout=!this.BGj();Q.SelectAllButton=!xa.$("TellMeSelectAllResultIsEnabled");const jb=xa.$("TellMeDesktopUpSellIsEnabled");let Nb=F.AFrameworkApplication.Vnm;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Nb));Nb=!1;Q.TextBoxUpSellButton=!jb||Nb;Q.TableOfContentsUpSellButton=!jb||Nb;Q.SmartArtUpSellButton=!jb||Nb;Q.WordArtUpSellButton=!jb||Nb;Q.MultiColumnLayoutUpSellButton=!jb||Nb;Q.InsertEquationUpSellButton=!jb||
Nb;Q.TrackChangesUpSellButton=!jb||Nb;Q.ShapesUpSellButton=!jb||Nb;Q.LabelsUpSellButton=!jb||Nb;Q.InsertCitationUpSellButton=!jb||Nb;Q.TextBoxUpSellButtonEnterprise=!jb||!Nb;Q.TableOfContentsUpSellButtonEnterprise=!jb||!Nb;Q.SmartArtUpSellButtonEnterprise=!jb||!Nb;Q.WordArtUpSellButtonEnterprise=!jb||!Nb;Q.MultiColumnLayoutUpSellButtonEnterprise=!jb||!Nb;Q.InsertEquationUpSellButtonEnterprise=!jb||!Nb;Q.TrackChangesUpSellButtonEnterprise=!jb||!Nb;Q.ShapesUpSellButtonEnterprise=!jb||!Nb;Q.LabelsUpSellButtonEnterprise=
!jb||!Nb;Q.InsertCitationUpSellButtonEnterprise=!jb||!Nb;xa=!xa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!F.AFrameworkApplication.JZ;Q.SynonymButton=xa;Q.DefinitionButton=xa}get ubj(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get tbj(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get Q3f(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get sbj(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Rec(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get wsf(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get $ff(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get A6i(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get VQd(){return F.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get PPd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get FQd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get GQd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get q_h(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get p_h(){return 1E-6*F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get egi(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get dgi(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get o_h(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get Bji(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get BWh(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get Aji(){return F.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Pbe(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get $_a(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get G8d(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get I$i(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get AQd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get PKb(){return F.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get QKb(){return F.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get RKb(){return F.AFrameworkApplication.K.$("ShowEntitySearchResults")}get TKb(){return F.AFrameworkApplication.K.$("ShowWolframSearchResults")}get kdf(){return F.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(Gi,"WordEditorTellMeApplicationData",Jf,[]);var Rp=c(1506),ro;
(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(ro||(ro={}));Object(e.b)("ProviderSynchronizationType",ro);var Rn;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Rn||(Rn={}));Object(e.b)("MenuUpdatePolicy",Rn);var Fo=c(1455),xg=c(1452),ip=c(1572),Cr=c(1456),eq=c(1478),
Sn=c(99),Tr=c(247);class so extends Oj.a{constructor(Q){super();this.N0j=Q}I1b(){this.N0j.update()}}Object(e.a)(so,"TellMeFindStatusManager",Oj.a,[]);class Bi{constructor(Q){this.s$a=this.eyg=null;this.Gi=0;this.cdd="TellMeWAC.";const xa=Q.I9e;this.qc=Q;this.pad=xa;this.Rxe=Object.assign(new Rp.a,{landingTab:"Indoc",data:null});Q=new so(this);this.$Ua=Uh.FindManager.createInstance(Q,tk.a.instance,ql.a.instance,!0,!0)}IL(){return"WordFindInDocument"}FW(){return this.qc.$ff?this.qc.$ff===Rn.waitAll?
ro.waitAll:ro.synchronizeSlow:ro.none}MI(Q,xa){this.jpm(Q)?(this.s$a=Q,this.eyg=xa,Q=Il.a.createQuery(Q.Ig,Ai.a.none),this.Gi=window.performance.now(),this.$Ua.find(Q)):xa.resultsUpdated(new Fo.a(Q))}update(){this.qIn(Math.round(window.performance.now()-this.Gi));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.s$a.Ig);var xa=F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.$kb?xd.a.bXa(this.s$a.Ig,15,this.Rxe):Pb.a.Ff(this.s$a.Ig);const jb=[];jb.push(appChrome.actions.setControlLabel(this.pad,
Q));jb.push(appChrome.actions.setCompoundButtonCommandValueId(this.pad,xa));jb.push(appChrome.actions.updateCompoundButtonDescription(this.pad,this.pjf()));appChrome.api.dispatch(jb);Q=new xg.a(this.pad,ip.a.FindInDocument,this.s$a.Ig,this.$Ua.Fj.yha.toString());xa=new Cr.a(eq.a.FindInDocument);xa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;xa.Ez(Q);const Nb=new Fo.a(this.s$a);Nb.kw(xa);window.requestAnimationFrame(()=>{this.eyg.resultsUpdated(Nb)});this.$Ua.mWa(!0);this.rIn(Math.round(window.performance.now()-
this.Gi))}pjf(){const Q=this.$Ua.Fj.yha.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}jpm(Q){return!!Q&&!!Q.Ig&&""!==Q.Ig.trim()}qIn(Q){const xa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.s$a.Ig.length};this.sendActivityEvent(xa,Q)}rIn(Q){const xa={["Time"]:(new Date).getTime(),["Event"]:"Latency",
["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.s$a.Ig.length};this.sendActivityEvent(xa,Q)}sendActivityEvent(Q,xa){Q=Sn.a.WJ(Q);Bm.a.xEa(Object.assign(new Tr.a,{name:"Latency",dataFields:Q,durationMs:xa}),this.cdd)}}Object(e.a)(Bi,"WordFindInDocumentWithMatchesProvider",null,[1143]);class Xn{constructor(Q,xa){this.wc=Q;this.kNd=xa}d_a(Q,xa,jb){return this.kNd.d_a(0,Q,xa,jb)}insertHtmlText(Q){return Q?32===this.tof(Q):!1}tof(Q){return this.executeCommand(di.a.Ora,
Q)}executeCommand(Q,xa){const jb=new Sc.DictionaryPropertySet;jb.setValue(Cd.a.PQ,xa);jb.setValue(Cd.a.Xva,!1);xa=this.wc.processAction(Q,1);32===xa&&(xa=this.wc.Xb(Q,2,jb));return xa}}Object(e.a)(Xn,"WordInsertContentHandler",null,[1683]);class Ur extends Vb{constructor(){super();this.fx=()=>{if(F.AFrameworkApplication.s5f){var Q=Ie.App.xa.Rb.kif(Ra.a.tellMe);Q.GNc?this.wGi():Q.VV(this.nFn);var xa=new Gi(()=>!1);mc.TellMeActor.instance.initialize(xa,null,null,null,null,null,Object(a.a)(Ie.App.xa,
Ie.App.xa.TDd,"forceUpdateRibbonControls"),F.AFrameworkApplication.K,this.W.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.$a("Common.IActionContextProvider"),this.W.$a("Common.ISystemInitiatedFeedback"));mc.TellMeActor.instance.pmn(Q);mc.TellMeActor.instance.kon(new Xn(F.AFrameworkApplication.ya,this.W.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));xa.bJh&&xa.KCd&&mc.TellMeActor.instance.YH(new Bi(xa),Uc.a.tellMe)}};this.nFn=()=>{this.wGi()}}get name(){return"WordEditor.TellMe"}init(){F.AFrameworkApplication.K.gq(this.fx)}wGi(){Ie.App.xa.updateCommandUI()}}
Object(e.a)(Ur,"WordEditorTellMePackage",Vb,[]);class to{constructor(){this.W=null;this.wbj=(Q,xa,jb)=>{2===jb&&(Q=new Kd.StandardDialog,Q.Gd=0,Q.fha(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}dispose(){}Wm(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(136)){F.AFrameworkApplication.ya.gb(Vf.a.wordTestFeature,
ti.a.view,this.wbj,96);var Q=ld.FocusManager.instance().re(dl.AppFrame.sF);Ii.AFrame.ti(Q,uf.KeyInputManager.lc(Hf.a.p5a,5|uf.KeyInputManager.Mh),Vf.a.wordTestFeature)}}zc(Q){this.W=Q}static main(){ca.a.instance.Pc(new to)}}Object(e.a)(to,"WordEditorTestFeaturePackage",null,[1,2]);var uo=c(114);class xl{constructor(Q,xa){this.mVi=Q;this.wc=xa;this.m6d=(jb,Nb,Bc,gd,be)=>{if(1===Bc)return 32;this.mVi.rO(9,be,!1);return 32};this.Vaa=(jb,Nb)=>{if(9===Nb.type){var Bc;(jb=Nb.BM)?("string"===typeof jb?Bc=
jb:"data"===jb.type&&(Bc=uo.a.Gwh(jb.L$m,jb.newState,jb.bTn)),Bc&&xl.tyc(Bc)):ia.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.qXc()}qXc(){this.wc.pa(Vf.a.m6d,$b.a.frame,this.m6d);this.mVi.B5(this.Vaa)}dispose(){}static tyc(Q){Q=Ie.App.xa.notificationBar.usa(Q,!1);Q.image=5;Q.ema="CoAuth_AuthorStatus_16x16x32";Ie.App.xa.notificationBar.qA(Q)}}Object(e.a)(xl,"TrackChangeNotificationActor",null,[]);class qm{constructor(){this.ij=this.jLe=this.W=null;
this.XTc=()=>{if(this.ij=Ie.App.hJd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new xl(this.ij,F.AFrameworkApplication.ya)).singleInstance(),this.jLe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}zc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){Ie.App.hJd().continueWith(this.XTc)}dispose(){this.jLe&&this.jLe.dispose()}}Object(e.a)(qm,
"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Sp=c(81),fq=c(1431),To=c(1888);class yl{}yl.v8f="UnsavedChanges";yl.w8f="UnsavedChangesThemed";yl.CEn="SavedChanges";yl.Qgj="UnsavedChangesOpenPipe";yl.vio="UnsavedChangesOpenPipeCssClassNameThemed";yl.Pgj="UnsavedChangesClosePipe";yl.sio="UnsavedChangesClosePipeThemed";yl.tio="UnsavedChanges";yl.uio="UnsavedChangesThemed";yl.x8f="UnsavedChangesIndicatorPositionRef";Object(e.a)(yl,"UnsavedChangesHighlightUtils",null,[]);class Yq extends fq.a{constructor(Q,
xa){super();this.Cca=Q;this.Kw=xa;this.hqa=[this.Kw?new To.a(yl.w8f,yl.uio):new To.a(yl.v8f,yl.tio)]}get ama(){return!0}get nCb(){return 4}get ffb(){return this.hqa}uOa(Q,xa){if(this.Cca){var jb=this.Cca.TAf;if(jb&&jb.count&&jb.contains(Q.id))for(Q=xa.e2a("span"),xa=0;xa<Q.length;xa++)jb=Q[xa],xa||jb.classList.add(this.Kw?yl.vio:yl.Qgj),xa===Q.length-1&&jb.classList.add(this.Kw?yl.sio:yl.Pgj),jb.classList.add(this.Kw?yl.w8f:yl.v8f)}}oeb(){}}Object(e.a)(Yq,"UnsavedChangesHighlightActor",fq.a,[]);var Lq=
c(1008);class Mq{constructor(Q){this.xme=null;this.Cca=Q;this.Que=!1}get key(){return"UnsavedChangesHighlight"}get qw(){return"UnsavedChanges"}reset(Q){if(this.Cca){Q=Q.node;if(Jh.ParagraphReader.nc(Q)){const xa=this.Cca.TAf;if(xa&&xa.contains(Q.id)){this.Que=!0;this.xme=Q.id;return}}this.Que=!1;this.xme=zf.a.nil}}qFa(){let Q=null;return this.Que?(Q=Object.assign(new Lq.a,{YF:this.key,contentObject:this.xme,description:null}),{returnValue:!0,VE:Q}):{returnValue:!1,VE:Q}}}Object(e.a)(Mq,"UnsavedChangesHighlightCpContentDetailsProvider",
null,[298,299]);var wt=c(1432);class Fp{constructor(Q,xa,jb,Nb,Bc,gd,be){this.qSg=null;this.t4=Q;this.pf=xa;this.zV=jb;this.X4=Nb;this.H4g=Bc;this.GUb=gd;this.Kw=be;this.pf.IVa(this.k7.bind(this))}get TAf(){return this.qSg}s_l(){if(this.t4){if(1===this.t4.jYe){if(0===this.t4.$vf&&this.t4.DCi()){this.qSg=this.t4.sVd;const Q=this.t4.x3c;this.t4.DEn.forEach(this.VXk.bind(this));Q.forEach(this.t_l.bind(this));0<Q.length&&this.AZk(this.zV);return 0}return this.Min(this.t4.$vf)}return 2}return 1}Min(Q){switch(Q){case 0:return this.t4.M5h()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}F6h(Q,xa,jb){if(xa)if(jb){jb=xa.querySelectorAll("span");for(let Nb=0;Nb<jb.length;Nb++){const Bc=jb[Nb];Nb||Bc.classList.add(yl.Qgj);Nb===jb.length-1&&Bc.classList.add(yl.Pgj);Bc.classList.add(this.Kw?yl.w8f:yl.v8f)}xa.classList.add(yl.x8f);Q&&this.X4.Fhc(Q)}else xa.classList.add(yl.CEn)}$4b(Q,xa){const jb=this.AOl(Q);if(Q&&(Q=Q.Be(Gh.App.xa.jb.Fc.Sb)))if(Q.Ag&&Q.Ag.Ji&&0!==Q.Ag.Ji.count)for(let Nb of Q.Ag.Ji)this.F6h(jb,Nb,xa);else this.F6h(jb,
Q.htmlElement,xa)}AOl(Q){return this.H4g&&(Q=this.H4g.QId(Q))&&Q&&(Q=Q.Be(Gh.App.xa.jb.Fc.Sb))?Q:null}t_l(Q){this.$4b(Q,!0);return!0}VXk(Q){this.$4b(Q,!1);return!0}AZk(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}k7(Q,xa){if(xa===Sys.EventArgs.Empty)ia.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args");else if(xa&&xa.errorCode){if(Fp.HWn?!this.GUb.hX:wt.a.iK.iK())Q=
this.s_l(),ia.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),La.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.Jco(Q)}else ia.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",xa?"Error Code":"Kickout Event Args")}static get HWn(){if(null!=Fp.prg)var Q=Fp.prg;else{var xa,jb;Q=null!==(jb=null===(xa=F.AFrameworkApplication.K)||void 0===xa?void 0:xa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportCSDLUsingRevisionSequencing",
!1))&&void 0!==jb?jb:!1;Q=Fp.prg=Q}return Q}Jco(Q){let xa;const jb=new Bf.a;jb.extendedProperties=new Map;jb.extendedProperties.set("HighlightUnsavedChangesResult",Q.toString());jb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:xa="HighlightInternalError";break;case 5:xa="ChangeOutsideCanvas"}6!==Q&&5!==Q||jb.extendedProperties.set("UnsavedChangesCollectionResult",this.t4.$vf.toString());xa&&(La.Health.instance.recordQosError(xa,["UnsavedContentNotHighlighted"],
!0,!0,!1,!1,jb),La.Health.instance.recordKpiFailure("UnsavedChangesHighlight",xa,!0,!0,jb))}dispose(){this.pf.Acc(this.k7.bind(this))}}Object(e.a)(Fp,"UnsavedChangesHighlighter",null,[10]);var gq=c(524),Yn=c(467),Km=c(1429);class Pm extends Km.a{constructor(Q,xa){super();this.Cca=Q;this.Kw=xa}HKb(Q){if(!this.Cca)return!1;const xa=this.Cca.TAf;return xa?xa.contains(Q.zb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}brk(Q,xa){xa=Q.dCa?Q.dCa[xa]?Q.dCa[xa].style?Q.dCa[xa].style.marginLeft:
null:null:null;var jb=Q.leftMargin;Q=1440<=jb?-(jb/1440*96):Q.Fwb(0,96,this.zoom);jb=0;xa&&(xa=xa.match(/^(\d+)px/))&&xa[1]&&(jb=Number(xa[1]));return Q-jb}Grk(Q,xa,jb){return Sys.UI.DomElement.getBounds(Q).y-jb.B2[xa].y}Rqk(Q){return Sys.UI.DomElement.getBounds(Q).height}bwh(Q,xa,jb,Nb){let Bc;Bc=this.brk(jb,xa);xa=this.Grk(Q,xa,jb);Q=this.Rqk(Q);Nb=gq.a.createElement(Nb,Yn.a.div);Nb.className=this.Kw?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Nb.style.left=Bc+"px";Nb.style.top=xa+
"px";Nb.style.height=Q+"px";return Nb}rvh(Q,xa,jb,Nb){const Bc=[];let gd=Q.querySelectorAll("."+yl.x8f);if(0===gd.length&&Q.classList.contains(yl.x8f))jb=this.bwh(Q,xa,jb,Nb),jb.rxb=xa,Bc.push(jb);else for(Q=0;Q<gd.length;Q++){let be=this.bwh(gd[Q],xa,jb,Nb);be.rxb=xa;Bc.push(be)}return Bc}Nxb(Q){let xa=[];var jb=Q.o7;const Nb=jb.Ng.ownerDocument;if(jb.Vj){let Bc=0;for(let gd of jb.Ag.Ji)(jb=this.rvh(gd,Bc,Q,Nb))&&(xa=xa.concat(jb)),Bc+=1}else xa=this.rvh(jb.htmlElement,0,Q,Nb);return xa}}Object(e.a)(Pm,
"UnsavedChangesIndicatorActor",Km.a,[]);class Vr{constructor(){this.V4=this.tv=this.qHa=this.X4=this.Ncd=this.Cca=null}get name(){return"WordEditor.UnsavedChangesHighlight"}zc(){}init(){this.X4=oa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.Cca=new Fp(oa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Af.SessionStatusManager.instance,Wk.a.Lq(oa.a.instance.$a("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.X4,oa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
oa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!Ie.App.instance&&Ie.App.instance.Cma);this.qHa=oa.a.instance.$a("Box4.Accessibility.IAccessibilityContextManager");this.V4=oa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.Ncd=new Pm(this.Cca,!!Ie.App.instance&&Ie.App.instance.Cma);this.X4.Kjb(this.Ncd);this.qHa&&this.qHa.execute(Q=>{Q.w3(new Mq(this.Cca))});this.tv=new Yq(this.Cca,!!Ie.App.instance&&Ie.App.instance.Cma);this.V4.Jjb(this.tv)}dispose(){this.X4&&
this.Ncd&&this.X4.Jce(this.Ncd);this.V4&&this.tv&&this.V4.q8f(this.tv);Sp.a.YA(this.Cca)}static main(){ca.a.instance.Pc(new Vr)}}Object(e.a)(Vr,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var Wr=c(347);class Go{constructor(Q,xa,jb,Nb){jb=new wordVersionHistory.AppBootSettings;jb.logger=new Wr.a;jb.forcePdfDevEnv=!1;jb.userSessionId=F.AFrameworkApplication.userSessionId;jb.wacCluster=Nb;jb.publicScriptPath=F.AFrameworkApplication.Q3;jb.userType=F.AFrameworkApplication.userType;jb.isDoubleClickFixEnabled=
Q.isDoubleClickFixEnabled;this.bee=new wordVersionHistory.AppVersionControllerImpl(jb,xa)}onVersionSelected(Q,xa,jb,Nb){this.bee.onVersionSelected(Q,xa,jb,Nb)}onDownloadTokenReady(Q,xa){this.bee.onDownloadTokenReady(Q,xa)}getRenderFailureEvent(){return this.bee.getRenderFailureEvent()}getLoadFinishEvent(){return this.bee.getLoadFinishEvent()}}Object(e.a)(Go,"AppVersionControllerImplWrapper",null,[1888]);class wn{create(Q,xa,jb,Nb){return new Go(Q,xa,jb,Nb)}}Object(e.a)(wn,"AppVersionControllerImplWrapperFactory",
null,[1863]);class Hs{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):null}}Object(e.a)(Hs,"VersionHistoryControllerFactory",null,[1861]);class jp{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(xa){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(xa){}}}Object(e.a)(jp,"VersionHistoryLogConnector",
null,[]);var Na=c(527),ab=c(1415),wb=c(1608);class ic{constructor(){this.revisionId=null;this.fVf=0}}Object(e.a)(ic,"ForceSaveData",null,[]);class Hc extends gk.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}Tl(){return 106}static construct(Q,xa,jb){const Nb=new Hc;Nb.FileId=Q;Nb.VersionToken=xa;Nb.ExclusiveLockId=xj.a(jb);return Nb}}Object(e.a)(Hc,"RestoreVersionRequest",gk.a,[]);class Xc{static Sla(){return(new Date).getTime()}static YEk(Q){const xa=new Bf.a;xa.durationMs=
Q;xa.extendedProperties=new Map;return xa}}Object(e.a)(Xc,"VersionHistoryUtils",null,[]);var yd=c(313);class Xd{constructor(Q,xa,jb,Nb,Bc,gd,be,Bd,Xe,eg,og,Ni,kk,mj,am){this.wc=Q;this.$h=xa;this.MN=jb;this.hfl=Nb;this.Qs=Bc;this.sni=gd;this.f5c=be;this.ntd=Bd;this.Qso=Xe;this.K=eg;this.hdk=og;this.lTe=Ni;this.bnb=kk;this.ef=mj;this.$$f=am;this.aRa=this.yGc=this.E0c=this.f9d=this.r1f=this.Z7f=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.H5d=0;this.UXb=this.aee=
null;this.bag=ab.b.None;this.H7b=!1;this.dag="";this.O7k={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.$6i=(zj,yn,Jk)=>{if(1===Jk)return Af.SessionStatusManager.instance.Tj?8:32;if(2===Jk){this.aee=Hd.a.create().toString();ia.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.aee);F.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");
F.AFrameworkApplication.a7("WoVer882;WoVer882cf");Object(wb.a)();this.ef.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.ef.OA(Vf.a.G1m,{succeeded:!0});this.ibj.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Pu.VersionHistoryLaunchSessionId=this.aee;this.perfTelemetryInfos=[];this.controller||(this.dag=this.K.lb("WacCluster"),this.controller=this.Qso.getVersionHistoryControllerInstance({ulsLogger:new Wr.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:F.AFrameworkApplication.ym,
appSettings:{appName:ab.a.Word,wdEnableDownloadTokens:this.f5c.boj,wdEnableSaveACopy:!0,wdEnableRestore:this.f5c.$nj,userSessionId:F.AFrameworkApplication.userSessionId,wacCluster:this.dag,uiLocale:F.AFrameworkApplication.uiCulture?F.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:F.AFrameworkApplication.K.lb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.f5c.aoj,isRtl:F.AFrameworkApplication.isRtl,
wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:Oa.a.maa,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.ef.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:Xd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.fVn()||this.cVn());this.E0n()}return 32};
this.Lxn=(zj,yn,Jk)=>{if(1===Jk)return Af.SessionStatusManager.instance.pK?32:8;2===Jk&&(zj=this.qbb(this.H5d),this.ef.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:zj}),this.aRf());return 32};this.Kxn=(zj,yn,Jk,iq,ar)=>{var Kk,Ag,nn;if(1===Jk)return Af.SessionStatusManager.instance.pK?32:8;2===Jk&&(zj="Unknown",yn="",ar&&(zj=null!==(Kk=ar.FailureReason)&&void 0!==Kk?Kk:zj,ar=null!==(Ag=ar.ExtraInfo)&&void 0!==Ag?Ag:"",yn=null!==(nn=this.O7k[ar])&&void 0!==nn?nn:ar),Ag=this.qbb(this.H5d),
""!==yn&&Ag.extendedProperties.set("ExtraInfo",yn),nn=this.bnb.Deb(zj,3,yn),this.ef.logKpiFailure("WordVersionHistorySaveACopy",zj,{isIntentional:nn.isIntentional,additionalValues:Ag},nn),ia.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",zj,yn));return 32};this.aSd=()=>{this.Vvi();this.aRf();this.Qs&&this.Qs.refreshDocument({CYn:!0})};this.jfl=zj=>{ia.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var yn=zj.revisionId;const Jk=zf.a.create();yn=Hc.construct(F.AFrameworkApplication.rootQuerySignature,
yn,Jk);const iq=Object.assign(new Fn.a,{Zr:yn,status:1,mH:"RestoreVersion"});yn=this.lTe.sla(0,()=>{this.bWl(iq,zj.fVf)});yn.QJ(iq);yn.qW()};this.vLh=(zj,yn)=>{this.H7b=!1;const Jk=this.qbb(zj.fVf);Jk.extendedProperties.set("status",Na.a[yn]);const iq=this.bnb.Deb("ForceSaveFailed",5);this.ef.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:iq.isIntentional,additionalValues:Jk},iq);this.ef.OA(Vf.a.lBc,{succeeded:!1});ia.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+
Na.a[yn]+" for version "+zj);this.controller.setRestoreFailedAtServer(this.aSd)};this.ibj={};this.Pu={};this.D0n=!1;this.S2=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Rb.S2}Aud(){null===this.yGc&&(this.yGc=Xc.Sla())}qbb(Q){const xa=new Bf.a;null===Q?ia.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(xa.durationMs=Xc.Sla()-Q,xa.extendedProperties=new Map);return xa}f6l(){null===this.aRa&&(this.aRa=Xc.Sla());this.ef.logKpiUsage("WordVersionHistorySelectVersion",
0,{isForAlertableKpi:!0})}aRf(){const Q=[],xa=Object.assign(new Bf.a,{extendedProperties:new Map});if(null!=this.f9d&&null!=this.r1f){var jb=this.f9d-this.r1f;Q.push(Object.assign(new Rd.a,{name:"showPaneDuration",string:jb.toString()}));xa.extendedProperties.set("showPaneDuration",jb.toString())}null!=this.yGc&&null!=this.E0c&&(jb=this.yGc-this.E0c,Q.push(Object.assign(new Rd.a,{name:"firstActionDuration",string:jb.toString()})),xa.extendedProperties.set("firstActionDuration",jb.toString()));(jb=
this.bag===ab.b.None)?this.ef.logKpiSuccess("WordVersionHistory",{additionalValues:xa}):this.ef.logKpiFailure("WordVersionHistory",ab.b[this.bag],{isIntentional:!1,additionalValues:xa},{name:Xd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.ef.OA(Vf.a.iAk,{succeeded:jb,customData:Q})}Vb(){this.wc.pa(Ra.a.t9d,$b.a.frame,this.$6i);this.wc.pa(Ra.a.DYc,$b.a.frame,this.Lxn);this.wc.pa(Ra.a.E4d,$b.a.frame,this.Kxn)}E0n(){this.r1f=Xc.Sla();this.yGc=this.E0c=this.f9d=null;
if(document.getElementById("VersionHistoryOverlay"))this.LG();else{this.Inn();this.Hnn();this.rnn();this.wnn();this.Fnn();this.vnn();this.f5c.coj&&this.unn();this.Enn();this.Gnn();const Q=document.createElement("div");let xa=Q.id="VersionHistoryOverlay",jb=null;this.xnn(Q);if(this.S2&&(jb=Object(yd.a)("Header"))){const Nb=document.getElementById("AppHeaderPanel");xa=Nb&&"none"===Nb.style.display?String.format("{0} {1} {2}",xa,"RegionComposer","NoAppHeader"):String.format("{0} {1}",xa,"RegionComposer")}jb||
(jb=document.getElementById("WACInnerFrame"));Q.className=xa;jb.appendChild(Q);this.Z7f=this.controller.createVersionHistoryDialog(Q);this.eha()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}fVn(){if(F.AFrameworkApplication.kM)return ia.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=32==this.wc.processAction(Ra.a.udc,1);let xa=32==this.wc.processAction(Ra.a.xdc,1);
return Q||xa?!1:(ia.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}cVn(){return F.AFrameworkApplication.kM?(ia.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.wc.processAction(Ra.a.downloadACopy,1)?(ia.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),!0):!1}wnn(){this.controller.getFullAppErrorEvent().addListener(Q=>
{let xa=Q?ab.b[Q]:"";this.Pu[Xd.Q9n]=xa;this.bag=Q;ia.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",xa,this.aee)})}Inn(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.f9d=Xc.Sla();this.Byn(Q.containerDiv);this.$$f.initialize(this.UXb);this.LG()})}Hnn(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.aRa&&(this.aRa=Xc.Sla());this.$$f.display(Q)})}unn(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>
{try{ia.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.TUl(Q)}catch(xa){ia.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",xa)}})}TUl(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.f6l(),this.UXb.onVersionSelected(this.currentVersion,this.baseVersion,this.ibj,!this.D0n)):ia.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}rnn(){this.controller.getCloseSelectedEvent().addListener(()=>{this.jAk();this.Hsm()})}A5l(Q){const xa={};xa.FileDownloadUrl=Q;xa.SaveEntryPoint="VersionHistory";return xa}vJl(Q){let xa="Dialog Failure - ActionResponse "+Q.toString();2===Q?xa="DialogNotHandled":8===Q&&(xa="DialogFailed");return xa}Fnn(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.H5d=Xc.Sla();this.ef.logKpiUsage("WordVersionHistorySaveACopy",
0);this.Aud();ia.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.Vvi();var xa=this.A5l(Q);Q=32==this.wc.processAction(Ra.a.udc,1);xa=this.wc.Xb(Q?Ra.a.udc:Ra.a.xdc,2,xa);const jb=this.qbb(this.H5d),Nb=32===xa;if(!Nb){const Bc=this.vJl(xa),gd=this.bnb.Deb(Bc,2);this.ef.logKpiFailure("WordVersionHistorySaveACopy",Bc,{isIntentional:gd.isIntentional,additionalValues:jb},gd);ia.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
xa.toString())}this.ef.OA(Vf.a.fzk,{succeeded:Nb})})}vnn(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{var xa=Xc.Sla();this.ef.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.Aud();Q=new Ol.QueryStringBuilder(Q);Q.Ke("fn",F.AFrameworkApplication.fileName);Q=this.wc.Xb(Ra.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});xa=this.qbb(xa);const jb=32===Q;jb?this.ef.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:xa}):(this.ef.logKpiFailure("WordVersionHistoryDownloadVersion",
Q.toString(),{isIntentional:!1,additionalValues:xa},{name:Xd.vetoName,errorNameOverride:"DownloadVersionFailed"}),ia.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.ef.OA(Vf.a.ezk,{succeeded:jb})})}bWl(Q,xa){this.H7b=!1;if(2===Q.statusCode&&Q.hk&&0<Q.hk.length&&Q.hk[0])if(Q=Q.hk[0],xa=this.qbb(xa),this.sni&&Q.ShouldAvoidLockRelease&&this.sni.xkb(!1,"VersionHistory"),191===Q.StatusCode)Q=this.bnb.Deb("MultipleClientsInCoauthSession",5),this.ef.logKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:xa},Q),this.ef.OA(Vf.a.lBc,{succeeded:!1}),ia.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),Xd.Ism();else if(Q.StatusCode){xa.extendedProperties.set("status",Na.a[Q.StatusCode]);const jb=this.bnb.Deb("ServerOperationFailed",5);this.ef.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:xa},
jb);this.ef.OA(Vf.a.lBc,{succeeded:!1});ia.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Na.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.aSd)}else this.ef.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:xa}),this.ef.OA(Vf.a.lBc,{succeeded:!0}),ia.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.aSd();else xa=this.bnb.Deb("ServerOperationFailed",5),this.ef.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",
{isIntentional:xa.isIntentional},xa),ia.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+ch.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(this.aSd)}Enn(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.H7b)ia.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.H7b=!0;this.Aud();var xa=Xc.Sla();this.ef.logKpiUsage("WordVersionHistoryRestore",0);var jb=null;Q&&(jb=Q.split("-")[0]);jb&&""!==jb?(Q=Object.assign(new ic,{revisionId:jb,
fVf:xa}),ia.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",jb),this.controller.setRestoreInProgress(),this.hfl(19,!1,this.jfl,this.vLh,Q,null,null)):(jb=this.bnb.Deb("InvalidRevisionId",5),this.ef.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:jb.isIntentional},jb),this.ef.OA(Vf.a.lBc,{succeeded:!1}),ia.ULS.shipAssertTag(592197012,3005,!1),this.H7b=!1)}})}Jnn(){this.UXb.getRenderFailureEvent().addListener(Q=>
{const xa=this.bnb.Deb(Q,1),jb=this.qbb(this.aRa);this.aRa=null;this.ef.logKpiFailure("WordVersionHistorySelectVersion",Q,{isIntentional:xa.isIntentional,additionalValues:jb},xa);try{this.Pu.ViewerErrorCode="ViewerErrorCode"in this.Pu?this.Pu.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),ia.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Nb){ia.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Nb)}})}ynn(){this.UXb.getLoadFinishEvent().addListener(()=>
{null==this.E0c&&(this.E0c=Xc.Sla());const Q=this.qbb(this.aRa);this.aRa=null;this.ef.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:Q});this.controller.setVersionLoadComplete()})}Gnn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.aRa&&(this.aRa=Xc.Sla());this.$$f.vbo()})}allowKeytips(Q){hg.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}LG(){this.MN.Rw(dl.AppFrame.coa);this.allowKeytips(!1);this.MN.Rw(Ii.AFrame.Wo);this.MN.Rw(dl.AppFrame.Doa);
this.$h.zK("VersionHistoryViewer",!1);this.MN.LG("VersionHistoryViewer");this.$h.zK("VersionHistoryHeader",!0);this.MN.LG("VersionHistoryHeader");this.$h.zK("VersionHistoryOverlay",!0);this.MN.LG("VersionHistoryOverlay")}Rw(){this.MN.LG(dl.AppFrame.coa);this.allowKeytips(!0);this.MN.LG(Ii.AFrame.Wo);this.MN.LG(dl.AppFrame.Doa);this.MN.Rw("VersionHistoryOverlay");this.$h.RQ("VersionHistoryOverlay");this.MN.Rw("VersionHistoryHeader");this.$h.RQ("VersionHistoryHeader");this.MN.Rw("VersionHistoryViewer");
this.$h.RQ("VersionHistoryViewer")}jAk(){this.H7b&&ia.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.aRf();document.getElementById("VersionHistoryOverlay").style.display="none";this.Pu.browser=Oa.a.dF;Oa.a.I2&&(this.Pu.electronBrowserVersion=Oa.a.k2k);this.Rw();ia.ULS.sendTraceTag(592197017,3005,50,Ma.c(this.Pu))}Byn(Q){try{if(this.UXb)jp.setIsPageLoadForFirstTime(!1);else{jp.setIsPageLoadForFirstTime(!0);const xa=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",
!1)?this.dag:"";this.UXb=this.hdk.create(this.f5c,Q,this.ntd,xa);this.Jnn();this.ynn()}}catch(xa){ia.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",xa)}}i0e(Q){const xa=this.$h.re(Q);xa.parent=Ii.AFrame.Qp;this.MN.Dra(Q);xa.XL=!0;return xa}eha(){this.i0e("VersionHistoryOverlay").vda((Q,xa)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===xa.name&&this.Z7f.then(jb=>
{jb.enterFocusTrapZone();return null})}catch(jb){ia.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",jb)}});this.i0e("VersionHistoryHeader").vda((Q,xa)=>{try{"VersionHistoryHeader"===xa.name&&this.Z7f.then(jb=>{jb.enterHeaderFocusTrapZone();return null})}catch(jb){ia.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",jb)}});this.i0e("VersionHistoryViewer").vda((Q,xa)=>{try{"VersionHistoryViewer"===
xa.name&&ld.FocusManager.IK(document.getElementById("vhViewer"))}catch(jb){ia.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",jb)}})}Hsm(){const Q=oa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):ia.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}Vvi(){const Q=oa.a.instance.Pa("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ia.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static Ism(){const Q=oa.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ia.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}xnn(Q){Q&&Q.addEventListener("keydown",xa=>{xa.ctrlKey&&"KeyC"===xa.code&&
(this.Aud(),this.ef.logKpiUsage("WordVersionHistoryCopyText",0),F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(!F.AFrameworkApplication.protectFile&&!F.AFrameworkApplication.kM||F.AFrameworkApplication.izb||xa.preventDefault()));xa.ctrlKey&&"KeyF"===xa.code&&this.ef.logKpiUsage("WordVersionHistorySearchText",0)})}}Xd.Q9n="ErrorCode";Xd.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(Xd,"VersionHistoryPaneActor",null,[1860]);
class Le{constructor(){this.isDoubleClickFixEnabled=this.aoj=this.$nj=this.coj=this.boj=!1}}Object(e.a)(Le,"WordVersionHistorySettings",null,[]);class Xf{Deb(Q,xa,jb){let Nb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==xa?Nb.errorNameOverride="VersionHistoryLaunchFailed":1==xa?Q.includes("Failed to fetch")?Nb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseInternalError":
Q.includes("Unexpected server response (502) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":Q.includes("Unexpected server response (415) while retrieving PDF")?(Nb.errorNameOverride="SelectVersionFailedServerResponseUnsupportedMediaType",Nb.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Nb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?
Nb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?(Nb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Nb.isIntentional=!0):Nb.errorNameOverride="SelectVersionFailed":5==xa?(Nb.errorNameOverride="RestoreVersionFailed"+Q,Nb.isIntentional="MultipleClientsInCoauthSession"===Q):4==xa?Nb.errorNameOverride="DownloadVersionFailed"+Q:2==xa?Nb.errorNameOverride=Xf.tWf+Q:3==xa&&(jb?(Nb.errorNameOverride=
Xf.tWf+jb,Nb.isIntentional="OverwriteTarget"===jb||"TargetFileLocked"===jb):(Q=this.Awl(Q),Nb.errorNameOverride=Q?"SaveVersionFailedServerResponse"+Q:Xf.tWf));return Nb}Awl(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Xf.tWf="SaveVersionFailed";Object(e.a)(Xf,"WordVersionHistoryVetoHelper",null,[1859]);var qh=c(1011),sj=c(1004);class Lg{constructor(Q,
xa){this.nee=Q;this.ef=xa;this.lRe=null;this.pPc=!0}initialize(Q){this.lRe=Q}vbo(){this.pPc=!this.pPc;this.display(this.p5e)}display(Q){this.p5e=Q;this.Byf(Q);if(this.lRe){var xa=this.nee.$Ql(Q,this.pPc);if(2==xa)this.nee.v0m(Q.currentVersion.RevisionID);else{1==xa&&this.ef.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.nee.UTm(Q.currentVersion.RevisionID);try{this.lRe.onVersionSelected(this.p5e.currentVersion,this.p5e.baseVersion,
null,this.pPc)}catch(jb){ia.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",jb)}}}else this.iEm()}Byf(Q){this.nee.Lam(Q.currentVersion.RevisionID)||(this.ef.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0}),this.pPc&&!Q.noBaseToCompareTo&&this.ef.logKpiUsage("WordVersionHistoryShowChanges",0))}iEm(){this.ef.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});
ia.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(Lg,"VersionDisplayActor",null,[1858]);var Nh;(function(Q){Q[Q.notStarted=0]="notStarted";Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]="complete"})(Nh||(Nh={}));Object(e.b)("WaitForBaseState",Nh);class jk{constructor(Q,xa){this.revisionId=Q;this.ef=xa;this.state=Nh.notStarted}get tRk(){return this.revisionId}begin(){this.state==Nh.notStarted&&(this.startTime=Xc.Sla(),this.state=Nh.inProgress,this.ef.logKpiUsage("WordVersionHistoryWaitForBase",
1),ia.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==Nh.inProgress){this.state=Nh.complete;this.endTime=Xc.Sla();const xa=Xc.YEk(this.endTime-this.startTime);this.revisionId==Q?this.ef.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:xa}):this.ef.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:xa},{name:"VersionHistoryExperienceDegraded"})}}}Object(e.a)(jk,"WaitForBaseOperation",null,[]);class Dk{constructor(Q){this.ef=
Q}$Ql(Q,xa){return Q.noBaseToCompareTo||!xa?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?1:0==Q.baseVersion.DownloadUrl.length?2:1:1}Lam(Q){return this.kNb?this.kNb.tRk==Q:!1}UTm(Q){this.kNb&&this.a$i(Q)}v0m(Q){this.kNb&&this.a$i(Q);this.kNb=new jk(Q,this.ef);this.kNb.begin()}a$i(Q){this.kNb.end(Q);this.kNb=null}}Object(e.a)(Dk,"WaitForBaseController",null,[1678]);class $e{constructor(){this.Bqo=
{crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){F.AFrameworkApplication.mRd()?(ia.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),ib.a.get_instance().Gl(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").LD;(F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):
Q.loadScript("wordVersionHistory")).catch(xa=>ia.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",xa)).then(()=>this.o0m()).catch(xa=>ia.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",xa))})):ia.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}o0m(){ia.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");
this.container.resolve("IVersionHistoryPaneActor").Vb();return null}dispose(){}zc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");if(this.K.$("AppSupportsVersionHistory")){var xa=this.container.resolve("Common.IBrowserUtils"),jb=new Le;jb.boj=this.K.$("WordWdDownloadTokenIsEnabled");jb.coj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");jb.$nj=this.K.$("WordVersionHistoryEnableRestore");jb.aoj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");jb.isDoubleClickFixEnabled=
this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryDoubleClickFixEnabled",!1);this.container.ha("IFeatureUsageAndHealthLogger",()=>new qh.a(La.Health.instance,new sj.a,this.Bqo)).singleInstance();this.container.ha("IWaitForBaseController",()=>new Dk(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new Lg(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();
this.container.ha("IVersionHistoryPaneActor",()=>new Xd(F.AFrameworkApplication.ya,ld.FocusManager.instance(),zg.a.instance,wc.a.XP,Ie.App.xa,Ie.App.S_,jb,xa,new Hs,F.AFrameworkApplication.K,new wn,new Sg.a,new Xf,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=!1;F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&F.AFrameworkApplication.mRd()&&(Q=!0);ca.a.instance.Pc(new $e,
0,Q)}}Object(e.a)($e,"WordVersionHistoryPackage",null,[1,2]);var He=c(104);class hf{constructor(Q,xa,jb){this.ga=Q;this.Om=xa;this.Oa=jb}Vb(){this.Oa.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Ra.a.ofc,$b.a.frame,Object(a.a)(this.Om,this.Om.ofc,"showZoomDialog")),this.ga.gb(Ra.a.Nfn,$b.a.frame,Object(a.a)(this.Om,this.Om.JAi,"onQueryZoomText"),96),this.ga.pa(Ra.a.l5c,$b.a.frame,Object(a.a)(this.Om,this.Om.poj,"zoomDialogTabFocusHandler")),this.ga.pa(Ra.a.k5c,$b.a.frame,Object(a.a)(this.Om,this.Om.poj,
"zoomDialogTabFocusHandler")));this.Oa.$("ZoomSliderIsEnabled")&&(this.ga.gb(Ra.a.fKi,$b.a.frame,Object(a.a)(this.Om,this.Om.iYm,"onQueryZoomPercentage"),96),this.ga.gb(Ra.a.soj,$b.a.frame,Object(a.a)(this.Om,this.Om.G0m,"onZoomToPercentage"),96),this.ga.pa(Ra.a.Byo,$b.a.frame,He.ActionManager.Of))}}Object(e.a)(hf,"CommonZoomActor",null,[1022]);class Eg extends hf{constructor(Q,xa,jb){super(Q,xa,jb);this.rda=xa}Vb(){super.Vb();this.Oa.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Vf.a.Bbg,$b.a.frame,
He.ActionManager.Of),this.ga.pa(Vf.a.Zee,$b.a.frame,Object(a.a)(this.rda,this.rda.Ayo,"zoomTo100")));this.ga.pa(Vf.a.zoomToPageWidth,$b.a.frame,Object(a.a)(this.rda,this.rda.zoomToPageWidth,"zoomToPageWidth"));this.ga.pa(Ra.a.wfb,$b.a.frame,Object(a.a)(this.rda,this.rda.wfb,"increaseZoom"));this.ga.pa(Ra.a.Wbb,$b.a.frame,Object(a.a)(this.rda,this.rda.Wbb,"decreaseZoom"));this.ga.pa(Vf.a.ZWf,$b.a.frame,Object(a.a)(this.rda,this.rda.NSn,"setZoomLevelFromRibbon"));this.ga.gb(Vf.a.yjb,$b.a.frame,Object(a.a)(this.rda,
this.rda.JAi,"onQueryZoomText"),96);this.ga.gb(Vf.a.B2d,ti.a.application,Object(a.a)(this.rda,this.rda.hYm,"onQueryZoomLevelLabelText"),96);this.ga.pa(di.a.Bxh,$b.a.frame,He.ActionManager.Of);this.ga.pa(di.a.Axh,$b.a.frame,He.ActionManager.Of);this.ga.pa(di.a.Fxh,$b.a.frame,He.ActionManager.Of);this.ga.pa(di.a.Cxh,$b.a.frame,He.ActionManager.Of);this.ga.pa(Vf.a.Iha,$b.a.frame,He.ActionManager.Of)}}Object(e.a)(Eg,"WordEditorZoomActor",hf,[]);class Zf{constructor(Q,xa){this.zoom=Q;this.Mbk=xa}}Object(e.a)(Zf,
"SetCustomZoomArgs",null,[]);var rl=c(1133);class ei{constructor(Q,xa){this.ESk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.FSk=[ei.j4e,ei.zzd,"200","150","100","75","50"];this.Lka=3;this.OM=0;this.delta=.1;this.Qwf=0;this.ie=new h.a;this.hg=null;this.K=Q;this.wc=xa;this.G2i(1)}get vj(){return this.OM}G2i(Q){this.OM=Q}get tDc(){return Math.round(100*this.vj)}get KNm(){return Math.floor(this.tDc/10)/10+this.delta}get JNm(){return Math.ceil(this.tDc/
10)/10-this.delta}get ga(){return F.AFrameworkApplication.ya}P$j(Q){this.ie.addHandler("ZoomChanged",Q)}Qun(Q){this.ie.removeHandler("ZoomChanged",Q)}z7(Q){this.P$j(Q)}Sjb(Q){this.Qun(Q)}ONi(){}DPi(){}NNi(){}CPi(){}m5c(Q){this.qoj(Q,this.vj)}qoj(Q,xa){null!==Q&&Uj.a.CQn(Q,xa)}i_f(Q,xa=!0){let jb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(jb=new Zf(Q,xa));this.g_i(jb)}MSn(Q,xa=!1){this.Iha(Q,3|(xa?0:4))}E0m(Q,xa,jb){if(1===Q)return 32;Q=jb/100;Q<this.kSc?Q=this.kSc:Q>this.TRc&&
(Q=this.TRc);this.Iha(Q,1);xa&&(xa.Mr=Math.floor(100*Q));return 32}JAi(Q,xa,jb,Nb,Bc){if(1===jb)return 32;Q=Pb.a.hBa(this.tDc,6,F.AFrameworkApplication.numberFormat);Bc.Value=Q;Bc.LabelText=Q;return 32}G0m(Q,xa,jb,Nb,Bc){return 1===jb?32:this.E0m(jb,Nb,Bc.value)}iYm(Q,xa,jb,Nb,Bc){Bc.MinValue=100*this.kSc;Bc.MaxValue=100*this.TRc;Bc.value=this.tDc;return 32}I2h(){return this.ESk}J2h(){return this.FSk}sql(){let Q=Math.floor(100*this.vj).toString();1===this.Lka?Q=ei.j4e:2===this.Lka&&(Q=ei.zzd);return Q}wfb(Q,
xa,jb){if(1===jb)return 32;this.tRc(this.wc?this.wc.PG:0,"IncreaseZoom");this.Lka=0;this.Iha(this.KNm);return 32}Wbb(Q,xa,jb){if(1===jb)return 32;this.tRc(this.wc?this.wc.PG:0,"DecreaseZoom");this.Lka=0;this.Iha(this.JNm);return 32}NSn(Q,xa,jb,Nb,Bc){if(1===jb)return 32;this.tRc(this.wc?this.wc.PG:0,"SetZoomLevelFromRibbon");Q=Bc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Fc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),Fg.a.instance.fc(Q),32;Q=parseInt(Q)/100;
if(isNaN(Q))return 2;this.Lka=0;this.Iha(Q);return 32}tRc(Q,xa){ia.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,xa,F.AFrameworkApplication.ta.Rb.hq)}ofc(Q,xa,jb){if(1===jb)return 32;ia.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.sql();this.hg=new rl.a(this.I2h(),this.J2h(),Object(a.a)(this,this.ZWl,"handleZoomDialogResult"),ld.FocusManager.instance(),!0);this.hg.ofc(CommonUIStrings.l_ZoomDialogTitle,
Q)}Ddm(Q){return Q.toLowerCase()===ei.j4e.toLowerCase()}Edm(Q){return Q.toLowerCase()===ei.zzd.toLowerCase()}ZWl(Q){if(Q){if(this.Ddm(Q)){this.Lka=1;var xa=32}else if(this.Edm(Q))this.Lka=2,xa=this.zoomToPageWidth(0,null,2,null,null);else if(xa=Number.parseInvariant(Q)){this.Lka=0;let jb=xa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(jb=new Zf(xa,!0));xa=this.g_i(jb)}else xa=8;32===xa?ia.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):ia.ULS.sendTraceTag(7156360,
353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else ia.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}Ihn(){this.ie.raiseEvent("ZoomChanged",null)}LKi(){}oQf(){}poj(Q){if(!this.hg)return 2;var xa=this.hg.$h.Fs().Wj.a2;if(xa===this.hg.mz&&Q===Ra.a.l5c||xa===this.hg.qG&&Q===Ra.a.k5c)this.hg.lvb||this.hg.nGn(),this.hg.$h.Fs().Wj.qy(this.hg.lvb);else if(xa.id.startsWith(this.hg.OWc)||xa.className.startsWith(this.hg.mKi))xa=null,Q===Ra.a.l5c?xa=this.hg.qG:Q===Ra.a.k5c&&
(xa=this.hg.mz),this.hg.$h.Fs().Wj.qy(xa),Sys.UI.DomElement.removeCssClass(this.hg.lvb.parentNode,this.hg.fQf);else if(Q===Ra.a.l5c)this.hg.$h.Fs().d$b();else if(Q===Ra.a.k5c)this.hg.$h.Fs().b$b();else return 2;return 32}}ei.j4e="FullPage";ei.zzd="PageWidth";Object(e.a)(ei,"ZoomManager",null,[861]);var Vj;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=3]="onBoot"})(Vj||(Vj={}));Object(e.b)("ZoomStatus",Vj);c(1030);var Ek;(function(Q){Q[Q.normal=
0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(Ek||(Ek={}));Object(e.b)("ZoomUpdateFlags",Ek);var Ik=c(256),Ho=c(353),jr=c(1186);class xt extends ei{constructor(Q,xa,jb,Nb,Bc,gd,be){super(Q,xa);this.gvo=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.hvo=[ei.zzd,"200","150","125","100","75","50"];this.cMe=this.rTi=!1;this.Swg="AutoFitForAdaptiveLayout";this.oFj="FitPageWidthFailure";
this.F_j="UpdateZoomFailure";this.a1j="wwf";this.uNe=null;this.r3d=()=>{this.Lka===Vj.fitWidth&&this.l$e()};this.WQk=Bd=>{if(Bd.ctrlKey&&(F.AFrameworkApplication.ya.processAction(di.a.Cxh,2),this.Z0j)){Bd=Bd.luo;if(!Bd)return!1;this.Iha(this.vj-(0<Bd?.1:-.1));this.tRc(6,"CtrlScroll");return!0}return!1};this.F0m=()=>{ia.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.RV=jb;this.Lj=Nb;this.Ub=Bc;this.kg=gd;this.loc=be;this.pOg=Q.$("KeepViewAfterZoomIsEnabled");
this.b1j=Q.$("ZoomShortCutIsEnabled");this.Z0j=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableZoomScroll",!1);this.T_j=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.RJj=(this.Pte=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.oDj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.c1j=Q.$("ZoomSliderIsEnabled");this.ez()}get appName(){return"WordEditor"}get TRc(){return 4}get kSc(){return.1}get XQk(){return wacBoot.CtrlWheelMetrics}e$j(Q){this.ie.addHandler("PinchStart",
Q)}Gun(Q){this.ie.removeHandler("PinchStart",Q)}d$j(Q){this.ie.addHandler("PinchEnd",Q)}Fun(Q){this.ie.removeHandler("PinchEnd",Q)}get hJ(){return null!=this.Hrg?this.Hrg:this.Hrg=oa.a.instance.Pa("WordEditor.IStatusBarUser")}Dkj(Q){Q=!(Q&Ek.disableUiControlUpdate);const xa=ib.a.get_instance().isCompleted(7);return Q&&xa?(Q={SelectZoomOption:"ComboBoxModel"},Ie.App.xa&&Ie.App.xa.nG(Q),this.Rpo(),!0):!1}Iha(Q,xa=Ek.normal){let jb=!0;this.oDj||F.AFrameworkApplication.ya.processAction(Vf.a.Iha,2);if(this.vj===
Q)return this.cMe||(this.cMe=this.Dkj(xa)),jb;Q>this.TRc?Q=this.TRc:Q<this.kSc&&(Q=this.kSc);var Nb=!!(xa&Ek.quiet);1===Q||Nb||F.AFrameworkApplication.ya.processAction(Vf.a.Bbg,2);try{Nb=null;Ie.App.xa&&Object(Jn.a)(jr.PageView,Ie.App.xa.jb.Fc)&&(Nb=Ie.App.xa.jb.Fc);let Bc=-1,gd=-1,be=-1;const Bd=!(xa&Ek.disableScrollUpdate);this.pOg&&Bd&&(Bc=ah.SelectionEditor.FQl(Ne.a.instance.ib.kb,Nb),gd=Nb.BK.scrollLeft,be=Nb.BK.scrollTop);const Xe=this.vj;this.G2i(Q);this.Ihn();this.cMe=this.Dkj(xa);Bd&&this.poo(Nb,
Bc,gd,be,Xe)}catch(Bc){jb=!1,ia.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Bc)}return jb}poo(Q,xa,jb,Nb,Bc){Q&&Q.isActive?this.pOg?0<=xa&&100>=xa?Q.mw.qba(100-xa,!0,!0):Q.mw.Kqm(jb,Nb,Bc,this.vj):Q.mw.qba():ia.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}Ayo(Q,xa,jb){2===jb&&(this.tRc(this.wc?this.wc.PG:0,"ZoomTo100"),this.Lka=Vj.manual,this.Iha(1));return 32}g_i(Q){this.Lka=Vj.manual;let xa,jb=!0;if(this.T_j){if(!Object(Jn.a)(Zf,Q))return ia.ULS.sendTraceTag(51644238,
353,10,"actiondata is not a SetCustomZoomArgs"),8;xa=Q.zoom/100;jb=Q.Mbk}else xa=Number.parseInvariant(String.format("{0}",Q))/100;ia.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",xa);Q=Ek.normal;jb||(Q=Ek.disableScrollUpdate);this.Iha(xa,Q);return 32}zoomToPageWidth(Q,xa,jb){if(1===jb)return 32;ia.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Ce.a)("ZoomToPageWidth",!0);this.Lka=Vj.fitWidth;this.a5k();return this.l$e()}hYm(Q,xa,jb,Nb,Bc){if(1===
jb)return 32;Q=Pb.a.hBa(this.tDc,6,F.AFrameworkApplication.numberFormat);Bc[Ik.a.labelText]=Q;return 32}I2h(){return this.gvo}J2h(){return this.hvo}a5k(){this.rTi||(Ie.App.xa?(Ie.App.xa.$Y(this.r3d),this.rTi=!0):ia.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}l$e(){var Q=Ie.App.xa?Ie.App.xa.jb.Fc:null;if(Q&&Ie.App.xa.nC){var xa=null;(Q=this.pql(Q))&&(xa=this.RV.XI(Q));xa||(xa=this.RV.Bef());if(null!==xa)return xa=tn.a.instance.ev(xa),
xa=xm.a.Ri(xa,0),Q=this.loc(),xa+=Q&&Q.m8d()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,xa+=2*Ho.a.cbg,this.Iha(Ie.App.xa.nC.offsetWidth/xa),32;ia.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ia.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}pql(Q){return Q&&Q.Cb&&Q.Cb.ib.kb&&Q.Cb.ib.kb.Qa&&Q.Cb.ib.kb.Qa.node?Q.Cb.ib.kb.Qa.node:null}Rpo(){this.hJ&&(this.c1j?(this.hJ.kU(So.a.wyo),this.hJ.kU(So.a.xyo)):
this.hJ.kU(So.a.yyo))}s5n(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var xa=Q.ctrlWheelOccurred;if("boolean"!==typeof xa)ia.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ia.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",xa);try{Q.stop()}catch(jb){ia.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",jb)}}}else ia.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}ez(){this.s5n(this.XQk);if(this.Lj){var Q=document.getElementById(dl.AppFrame.cAd);
Q&&this.Lj.mb(A.a.Qhb,Q,this.WQk)}this.Ub&&(Q=this.Ub.re(dl.AppFrame.sF),this.b1j&&(Q.bindAction(uf.KeyInputManager.lc(Hf.a.Zhc,uf.KeyInputManager.Mh),Ra.a.wfb),Q.bindAction(uf.KeyInputManager.lc(Hf.a.z4c,uf.KeyInputManager.Mh),Ra.a.wfb),Q.bindAction(uf.KeyInputManager.lc(Hf.a.$hc,uf.KeyInputManager.Mh),Ra.a.Wbb),Q.bindAction(uf.KeyInputManager.lc(Hf.a.aic,uf.KeyInputManager.Mh),Ra.a.Wbb),Q.bindAction(uf.KeyInputManager.lc(Hf.a.c6c,uf.KeyInputManager.Mh),Vf.a.Zee)));this.kg&&(this.uNe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&
this.kg.mb(A.a.click,this.uNe,this.F0m);this.RJj&&(Ie.App.xa.Bu.registerLayoutBreakpointChanged("canvas",xa=>{this.USe(xa)}),Ie.App.xa.Bu.registerBoundingWindowRectsChanged("canvas",()=>{this.USe(Ie.App.xa.Bu.getLayoutBreakpoint())}))}USe(Q){let xa=!0,jb="";if(this.Lka!==Vj.onBoot)return xa;La.Health.instance.recordKpiUsage(this.Swg,0,this.a1j,null);switch(Q){case "Small":8===this.l$e()&&(jb=this.oFj,xa=!1);break;default:1===this.vj||this.Iha(1)||(jb=this.F_j,xa=!1)}xa||La.Health.instance.recordKpiFailure(this.Swg,
jb,!0,!0,null);return xa}ONi(Q){this.e$j(Q)}DPi(Q){this.Gun(Q)}NNi(Q){this.d$j(Q)}CPi(Q){this.Fun(Q)}LKi(){this.ie.raiseEvent("PinchStart",null)}oQf(){this.ie.raiseEvent("PinchEnd",null)}}Object(e.a)(xt,"WordEditorZoomManager",ei,[1659,861]);class Fk{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(F.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),xa=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Vb();
Sys.UI.DomElement.overrideGetBounds=!0;F.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&F.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&xa&&ib.a.get_instance().Gl(4,()=>{xa.USe(Ie.App.xa.Bu.getLayoutBreakpoint())||ia.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}zc(Q){this.W=Q;F.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new xt(F.AFrameworkApplication.K,
F.AFrameworkApplication.ya,Si.WordSectionNavigator.instance,Pn.a.instance,ld.FocusManager.instance(),vh.a.instance,()=>Q.Pa("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Eg(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),F.AFrameworkApplication.K)).singleInstance())}static main(){ca.a.instance.Pc(new Fk)}}Object(e.a)(Fk,"ZoomPackage",null,
[1,2]);var kp=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",
ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",
LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",
attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",
LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},
children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",
Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",
LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",
MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},rv=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class yt extends uc.a{constructor(Q){super(!1,!1,
!0);this.r6c=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.r6c.smf}};this.Vh("",Object(a.a)(this,this.HAn,"resultHandler"),Q)}HAn(Q,xa){1===Q&&(this.r6c.smf=xa.tooltipPersistenceEnabled)}}Object(e.a)(yt,"AccessibilitySettingsDialog",uc.a,[]);class vp{constructor(Q,xa){this.ga=Q;this.r6c=xa}Vb(){this.ga.pa(Ra.a.GYn,$b.a.frame,Object(a.a)(this,this.HYn,"showAccessibilitySettingsDialogHandler"))}HYn(){(new yt(this.r6c)).start();return 32}}
Object(e.a)(vp,"AccessibilitySettingsDialogActor",null,[1850]);const kr=Q=>{const xa=new n.a;F.AFrameworkApplication.af.Mj(ls(Q),1,null,null,!0,2,jb=>{200===jb.data.Df?xa.Eg("true"===jb.data.Ie.toLowerCase()):xa.Eg(!1)},()=>{xa.Eg(!1)},null,void 0,void 0,void 0,void 0,"7");return xa.task},ls=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",F.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,F.AFrameworkApplication.ym);class io{constructor(){this.tRb=null}get smf(){return!!this.tRb}set smf(Q){Q!==
this.tRb&&(this.tRb=Q,hg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Yhi()&&F.AFrameworkApplication.af.Mj(ls("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}avm(){const Q=new n.a;if(this.tRb)Q.Eg(this.tRb);else if(this.Yhi()){const xa=kr("getHoverableRibbonTooltipIsEnabled");xa.continueWith(()=>{this.tRb=xa.result;hg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(xa.result);
Q.Eg(xa.result)},8)}else Q.Eg(!1)}Yhi(){const Q=F.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),xa=F.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!xa}}Object(e.a)(io,"AccessibilitySettingsInfo",null,[1849]);class zl{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}zc(Q){this.W=Q;this.W.register(io,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Zd(()=>new io).singleInstance();
this.W.register(vp,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Zd(()=>new vp(F.AFrameworkApplication.ya,this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),xa=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&xa?(xa.Vb(),Q.avm()):v.b(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){ca.a.instance.Pc(new zl)}}Object(e.a)(zl,"AccessibilitySettingsPackage",null,[1,2]);class wp{constructor(){this.events=[];this.tUf=!1}static Evf(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!wp.Rqm[Q.key]}static Pnk(Q,xa){let jb;jb=wp.Evf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=xa?(xa.altPressed=(!!Q.altKey).toString(),
xa.ctrlPressed=(!!Q.ctrlKey).toString(),xa.key=jb,xa.repeat=(!!Q.repeat).toString(),xa.shiftPressed=(!!Q.shiftKey).toString(),xa):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:jb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static hhi(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static BGh(Q){return!!Q&&wp.hhi(Q)&&wp.Evf(Q)}static CGh(Q){return!!Q&&wp.hhi(Q)&&!wp.Evf(Q)}keyPressedEventHandlerStart(Q,
xa){wp.CGh(Q)&&this.w9i(Q,xa)}keyPressedEventHandlerEnd(Q){wp.CGh(Q)&&this.$9i(Q)}keyDownEventHandlerStart(Q,xa){wp.BGh(Q)&&this.w9i(Q,xa)}keyDownEventHandlerEnd(Q){wp.BGh(Q)&&this.$9i(Q)}w9i(Q,xa){Q={["metadata"]:wp.Pnk(Q,xa),["timeStamp"]:this.ghc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.ghc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.vpn()}$9i(Q){if(0!==this.events.length){var xa=this.ghc(Q.timeStamp);
for(let jb=this.events.length-1;0<=jb;--jb){const Nb=this.events[jb];if(Nb.timeStamp===xa){Nb.timeToHandlerFinishMs=this.ghc(performance.now()-Q.timeStamp);Nb.eventDurationMs=this.ghc(Nb.timeToHandlerFinishMs-Nb.timeToHandlerStartMs);break}}}}ghc(Q){return Number(Q.toFixed(2))}vpn(){if(!this.tUf){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.tUf=!1;const xa=performance.now();this.events.forEach(Nb=>
{Nb.timeToRequestAnimationFrameMs=this.ghc(xa-Nb.timeStamp)});var jb=document.createEvent("CustomEvent");jb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(jb);this.events=[];jb=document.createEvent("CustomEvent");jb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(jb)});this.tUf=!0}}}wp.Rqm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,
["PageUp"]:!0,["Tab"]:!0};class hq{constructor(){this.F4d=this.O0a=this.CNa=this.J9b=null;this.Z7b=!1;this.Gcc=null;this.WGc=[];this.O3c=()=>{hq.Gjm()&&null==this.O0a?(this.CNa=null,this.O0a=requestAnimationFrame(this.VRc)):null!=this.O0a&&(cancelAnimationFrame(this.O0a),this.O0a=null)};this.VRc=Q=>{if(null!=this.CNa){const xa=Q-this.CNa;if(null==this.J9b||this.J9b<xa)this.J9b=xa;for(let jb=0;jb<hq.ranges.length;++jb)if(xa<hq.ranges[jb]){++this.WGc[jb];break}}this.CNa=Q;this.O0a=requestAnimationFrame(this.VRc)};
this.bSi=()=>{if(null!=this.J9b){var Q={};for(var xa=0;xa<hq.ranges.length;++xa)Q[hq.ranges[xa]]=this.WGc[xa],this.WGc[xa]=0;xa=performance.now();Q={["intervalStart"]:this.Gcc,["intervalEnd"]:xa,["maxFrameLengthMs"]:this.J9b,["frameData"]:Q};var jb=document.createEvent("CustomEvent");jb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(jb);this.J9b=null;this.Gcc=xa}}}static atf(){return!!window.performance&&!!window.performance.now}start(Q){!this.Z7b&&hq.atf()&&(this.iTn(),this.F4d=setInterval(this.bSi,
1E3*Q),this.Gcc=performance.now(),this.O3c(),document.addEventListener("visibilitychange",this.O3c),this.Z7b=!0)}stop(){this.Z7b&&(document.removeEventListener("visibilitychange",this.O3c),null!=this.F4d&&(clearInterval(this.F4d),this.F4d=null),null!=this.O0a&&(cancelAnimationFrame(this.O0a),this.O0a=null),this.bSi(),this.Z7b=!1)}get hPc(){return this.Z7b}iTn(){this.WGc=[];for(let Q=0;Q<hq.ranges.length;++Q)this.WGc.push(0)}}hq.Gjm=()=>"visible"===document.visibilityState;hq.ranges=[17,34,42,67,100,
200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];var Xr=c(79),Is={get t0k(){var Q=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!Q)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return Q}},at=c(617);class Yr{constructor(Q,xa){this.gAd=Q;this.mFn=xa;this.mCi=(jb,Nb)=>Object(Xr.__awaiter)(this,void 0,void 0,function*(){if(Nb.GEa){this.gAd.t2a(this.mCi);this.gAd.qe();var [,Bc]=yield Promise.all([this.Oum(),Promise.all([c.e(3),
c.e(7),c.e(14)]).then(c.bind(null,1914))]);Bc.main(Is.t0k)}})}initialize(){this.gAd.JJa(this.mCi);this.gAd.initialize()}Oum(){return Object(Xr.__awaiter)(this,void 0,void 0,function*(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiMakerDocumentWizardUx"):(yield Object(at.b)(this.mFn)).LD.loadScript("aiMakerDocumentWizardUx")})}}Object(e.a)(Yr,"AiMakerInitializer",null,[]);var Tn=c(703),Vh=c(922);class xn extends Vh.a{constructor(Q){var xa;super("BooleanFeatureGateConditionId");
this.ox=Q.ox;this.nCd=Q.nCd;this.defaultValue=null!==(xa=Q.defaultValue)&&void 0!==xa?xa:!1}initialize(){super.initialize();const Q=F.AFrameworkApplication.K;Q.gq(()=>{const xa=Q.getBooleanFeatureGate(this.nCd,this.defaultValue);this.Ej(xa)})}Ej(Q){super.Ej(Q);ia.ULS.sendTraceTag(512369937,3028,50,this.i$(this.ox,!0,`featureGate=${this.nCd}`))}}Object(e.a)(xn,"BooleanFeatureGateCondition",Vh.a,[]);class Qm extends Tn.a{constructor(){const Q=new xn({ox:16,nCd:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});
super(16,new ba.a([Q]),null,3028,"BlankDocumentTriggered")}}Object(e.a)(Qm,"AiMakerDocumentWizardTriggerModel",Tn.a,[]);var Zq=c(921);class $q extends Zq.a{get name(){return"WordEditor.AiMaker.Entry"}icb(Q){this.container=Q}kcb(){(new Yr(new Qm(this.container.resolve("Box4.IParagraphReader"),Ie.App.xa.jb.Fc),this.container.$a("Common.IDynamicScriptLoaderProvider"))).initialize()}jcb(){}static main(){ca.a.instance.Pc(new $q)}}Object(e.a)($q,"AiMakerEntryPackage",Zq.a,[]);Type.registerNamespace("B4RT");
Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");
Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");ca.a.instance.Pc(new $e);Ke.main();Type.registerNamespace("Common.App.AccessibilityChecker");
Type.registerNamespace("Common.App.Assistance");l;Type.registerNamespace("CACPU");ka.main();Type.registerNamespace("CAEventTimingMeter");ja.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");pa.main();Type.registerNamespace("Common.App.GestureInput");qb.main();Type.registerNamespace("Common.App.GestureManager");Bb.main();Type.registerNamespace("Common.ModernFontPicker");Type.registerNamespace("Common.App.OfflineLogger");ca.a.instance.Pc(new ud);Type.registerNamespace("Common.App.O365Shell");
vc.main();Type.registerNamespace("Common.App.PhoneLink");te.main();Type.registerNamespace("Common.App.SensitiveLogging");lg.main();Type.registerNamespace("Common.App.Rename");ca.a.instance.Pc(new dj,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");ca.a.instance.Pc(new ad);Type.registerNamespace("Common.App.SaveAsToHost");dn.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Be.main();Type.registerNamespace("Common.App.SaveACopy");Bj.main();Type.registerNamespace("Common.App.SaveToSharePoint");
oh.main();Type.registerNamespace("Common.App.SharedFilePicker");vl.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");fk.main();sh;ge.main();ca.a.instance.Pc(new kb);Gn.main();kp;jg.main();ca.a.instance.Pc(new Ab);Sr.main();Re.a.prototype.toString=dh.a.prototype.toString;Ck.a.D3h=new mh.a;ca.a.instance.Pc(new Zh);Fk.main();
ca.a.instance.Pc(new Nn);ca.a.instance.Pc(new yr);ca.a.instance.Pc(new Ur);to.main();wq.main();sn.main();Vr.main();Type.registerNamespace("NLRT");ca.a.instance.Pc(new uj);Type.registerNamespace("Common.App.AccessibilitySettings");zl.main();rv;$l.main();ca.a.instance.Pc(new qm);$q.main();window.EventTiming={EventTimingMeter:wp,FrameTimingMeter:hq}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16817908/wdjs/WordEditorDS.box4.dll2.js.map