'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1460:function(C,O,c){c.r(O);c.d(O,"RtcUtils",function(){return h});C=c(0);var l=c(8),e=c(1488),a=c(36);class h{static IWe(m,v=e.RealtimeChannel.Tzf){let u;try{u=a.c(m)}catch(n){throw m=String.format("Failed to JSON-serialize payload : {0}",n),l.ULS.sendTraceTag(18637072,500,10,m),Error.argument("payload",m);}if(u.length>v)throw m=String.format("Payload exceeds maximum length: {0} > {1}.",u.length,v),l.ULS.sendTraceTag(18637074,
500,10,m),Error.argument("payload",m);return u}static deserialize(m,v,u){if(!m)return null;if(Object.getType(m)!==String){var n=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",v,Object.getType(m).getName(),u);l.ULS.sendTraceTag(18637075,500,10,n);return null}n=null;try{n=a.a(m)}catch(x){m=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",v,x,u),l.ULS.sendTraceTag(18637077,
500,10,m)}return n}static G$b(m){if(!m)return"";if("string"===typeof m)return m.toString();try{return a.c(m)}catch(v){return m.toString()}}static Y7k(m){let v,u,n;v=0;n=u=null;if(!m)return{E7h:v,G7h:u,exception:n};try{const x=m.source;x&&Object.getType(x)===String&&(n=x);const A=m.context;A&&(m=A,v=m.status?m.status:0,u=m.statusText?m.statusText:null)}catch(x){}return{E7h:v,G7h:u,exception:n}}}Object(C.a)(h,"RtcUtils",null,[])},1479:function(C,O,c){c.r(O);C=c(0);var l=c(8),e=c(44),a=c(78),h;(function(n){n[n.SendNotification=
0]="SendNotification";n[n.SendPersistentState=1]="SendPersistentState";n[n.FindSession=2]="FindSession";n[n.Last=3]="Last"})(h||(h={}));Object(C.b)("ApiType",h);var m;(function(n){n[n.AttemptCount=0]="AttemptCount";n[n.SuccessCount=1]="SuccessCount";n[n.DropCount=2]="DropCount";n[n.FailedCount=3]="FailedCount";n[n.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";n[n.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";n[n.ThrottledCount=6]="ThrottledCount";n[n.Last=7]="Last"})(m||(m=
{}));Object(C.b)("EventCountType",m);var v=c(1561);c.d(O,"FrequentLoggingMetrics",function(){return u});class u{constructor(n){this.yrh=this.rJh=null;this.Gri=this.WLh=0;this.Bx=null;this.XQg=this.Qye=0;this.rg=n;this.y5l();this.upe=this.WFg=this.xze=!1;this.rrc=0}get n7k(){return this.upe}r4n(n){this.XQg=n;window.setInterval(Object(e.a)(this,this.iyf,"logMetricsBatchAndReset"),n);this.Qye=(new Date).getTime()}$N(n,x){this.EUn(n)&&!this.WFg||this.n7k||!window.navigator.onLine||this.rg.aNa||(this.Bx[n][x]++,
this.xze=!0)}y5l(){this.Bx=Array(3);for(let n=0;3>n;n++){this.Bx[n]=Array(7);for(let x=0;7>x;x++)this.Bx[n][x]=0}}Qnk(){const n={};for(let x=0;3>x;x++)for(let A=0;7>A;A++)this.fpm(x,A)&&(n[h[x]+m[A]]=this.Bx[x][A]);n.FSDomain=this.rJh;n.ConnectionDomain=this.yrh;n.FSRetryInterval=this.WLh;n.MaxPayloadSize=this.Gri;n.LogNumber=this.rrc;1===this.rrc&&(n.FSLatencies=v.a.instance.Jtl(),n.ConLatencies=v.a.instance.sol());return n}fpm(n,x){return 2===n&&3!==x&&0!==x?!1:!0}EUn(n){return 2===n?!1:!0}iyf(){if(this.xze){this.rrc++;
if((new Date).getTime()-this.Qye<5E3+this.XQg){var n=a.a.toJSON(this.Qnk());l.ULS.sendTraceTag(50644352,500,15,n)}this.Qye=(new Date).getTime();for(n=0;3>n;n++)for(let x=0;7>x;x++)this.Bx[n][x]=0;this.xze=!1}}TGm(){this.WFg=!0}static get instance(){return u._instance}static create(n){u.instance||(u._instance=new u(n));return u.instance}}u._instance=null;Object(C.a)(u,"FrequentLoggingMetrics",null,[963])},1488:function(C,O,c){c.r(O);C=c(0);var l=c(8),e=c(44),a=c(433),h=c(1629),m=c(86),v=c(2);class u{constructor(za,
pa){this.status=za;this.R8b=pa}}Object(C.a)(u,"UserStatusInfo",null,[]);var n=c(51),x=c(1561);class A{constructor(za,pa){this.data=za;this.timeStamp=pa}}Object(C.a)(A,"PresenceData",null,[]);class H{constructor(za){this.$ya=!1;this.uub=0;this.ule=!1;this.setTimeout=H.f3e;this.clearTimeout=H.Y2e;this.tEm=Object(e.a)(this,this.iDm,"logRtcConnectingUsageStatement");this.aw=za}ZSm(){this.$ya||(this.uub=this.setTimeout(()=>{this.$ya=!1;this.Qoi()},8E3),this.$ya=!0,this.ule=!1)}QTm(){this.jZ()}j_m(){this.Qoi()}Qoi(){this.jZ();
this.ule||(this.ule=!0,this.tEm())}iDm(){l.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.aw)}jZ(){this.$ya&&this.clearTimeout(this.uub);this.uub=0;this.$ya=!1}static f3e(za,pa){return window.setTimeout(za,pa)}static Y2e(za){window.clearTimeout(za)}}Object(C.a)(H,"ConnectedUsageKpiLogger",null,[979]);class E{constructor(){this.QLi=this.SQf;this.TLi=this.VQf;this.SLi=this.UQf;this.XLi=this.YQf;this.WLi=this.XQf;this.hRf=this.iRf;this.eRf=this.fRf;this.KIb=
this.cRf;this.gXc=this.dRf;this.RLi=this.TQf;this.fOa=this.UDf;this.Yhb=this.VDf}SQf(){}VQf(){}UQf(){}YQf(){}XQf(){}fRf(){}dRf(){}cRf(){}iRf(){}TQf(){}UDf(){}VDf(){}}Object(C.a)(E,"NoopRealtimeChannelMetrics",null,[970,313]);class L{}L.Q3c="presenceUpdated";L.updateNotification="updateNotification";L.$Fi="persistentStateCleared";L.updatePersistentState="persistentStateUpdated";Object(C.a)(L,"RtcClientMethodNames",null,[]);class M{}M.A0l="realtimeChannelHub";M.Q3c="UpdatePresence";M.rO="SendUpdateNotification";
M.Mcf="GetCompletePersistentStateWithMetadata";M.updatePersistentState="UpdatePersistentState";M.ymb="UpdateClientInfo";Object(C.a)(M,"RtcHubMethodNames",null,[]);class F{constructor(za){this.wv=za}kpn(za){this.wv.on(L.Q3c,za)}fqn(za){this.wv.on(L.updateNotification,za)}jpn(za){this.wv.on(L.updatePersistentState,za)}ipn(za){this.wv.on(L.$Fi,za)}bio(za){this.wv.off(L.Q3c,za)}lio(za){this.wv.off(L.updateNotification,za)}aio(za){this.wv.off(L.updatePersistentState,za)}$ho(za){this.wv.off(L.$Fi,za)}Q3c(za){return this.wv.invoke(M.Q3c,
za)}ymb(za){return this.wv.invoke(M.ymb,za)}rO(za,pa){return this.wv.invoke(M.rO,za,pa)}Mcf(za){return this.wv.invoke(M.Mcf,za)}updatePersistentState(za,pa){return this.wv.invoke(M.updatePersistentState,za,pa)}}Object(C.a)(F,"RealtimeChannelProxy",null,[976,977,978]);class J{constructor(){this.Pie=this.$wg=!1;this.Nie=0;this.Gke=this.vHe=this.uHe=this.She=!1;this.Upe=0;this.t_g=!1;this.s_g=this.r_g=0;this.PFe=!1;this.WFe=this.UFe=this.YFe=this.QFe=0;this.VFe=!1}get Cik(){return this.Pie}get Bik(){return this.Nie}get Dbk(){return this.She}get cWn(){return this.uHe}get dWn(){return this.vHe}get jzk(){return this.Gke}get VCd(){return this.Upe}get MCn(){return this.t_g}get hVi(){return this.r_g}get LCn(){return this.s_g}get HCn(){return this.PFe}get ICn(){return this.QFe}get nVi(){return this.YFe}get iVi(){return this.UFe}get kVi(){return this.WFe}get jVi(){return this.VFe}static createInstance(za){const {RealtimeChannel:pa}=
c(1488);return za?Object.assign(new J,{$wg:za.$("AwayStatusManagerIsEnabled"),Pie:za.$("AwayStatusOneMinuteTimeoutIsEnabled"),Nie:za.rc("AwayCoauthorThresholdMs",9E5),She:za.$("RtcAllowCrossDomainAccessEnabled"),uHe:za.$("ShouldLogOnContentNotification"),vHe:za.$("ShouldLogOnHostSubscriptionNotification"),Gke:za.$("RtcClientMetricsEnabled"),Upe:za.rc("RtcFindSessionRequestTimeoutInMS",6E4),t_g:za.$("RtcJsClientFrequentlyLogsMetrics"),r_g:za.rc("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),
s_g:za.rc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),PFe:za.$("RtcClientMessageTelemetryEnabled"),QFe:za.rc("RtcClientMessageTelemetrySampleSize",5),YFe:za.rc("RtcSendTelemetryMessageIntervalInMS",3E5),UFe:za.rc("RtcLogClientMessageMetricsTimeOutInMs",2E4),WFe:za.rc("RtcMaxPayloadSizeInCharactersOverride",pa.Tzf),VFe:za.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new J,{$wg:!1,Pie:!1,Nie:9E5,She:!1,uHe:!1,vHe:!0,Gke:!1,Upe:9E4,PFe:!1,
QFe:5,YFe:3E5,UFe:2E4,WFe:pa.Tzf,VFe:!1})}}Object(C.a)(J,"RealtimeChannelSettings",null,[975]);var I=c(1673),K=c(64),N=c(150);class G{constructor(za){this.Rwc=null;this.DPa=0;this.uzb=!1;this.wm=za;this.wm.wza(Object(e.a)(this,this.cga,"onConnectionStateChanged"))}cga(za,pa){this.DPa=pa.newState}O_m(){l.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.wm.U2d()}X3l(za){this.Rwc.init(za)}}Object(C.a)(G,"ARtcMessageHandler",null,[]);var P=c(1352);class S{constructor(){this.Presence=
null;this.TimeStamp=0}}Object(C.a)(S,"PresenceDataEntryForClients",null,[]);var W=c(78);class X{constructor(za,pa=""){this.sVj=za;this.gIa=pa}send(){return this.sVj()}get messageId(){return this.gIa}}Object(C.a)(X,"MessageHandler",null,[986]);var Y=c(1585);class ca extends Sys.EventArgs{constructor(za,pa,Ba,Ra){super();this.fUf=za;this.reconnectDelay=pa;this.reason=Ba;this.iXf=Ra}}Object(C.a)(ca,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ha=c(1633);class ra{constructor(){this.OIe=this.Gi=
null}get ri(){return this.Gi?this.OIe?this.OIe.getTime()-this.Gi.getTime():(new Date).getTime()-this.Gi.getTime():0}start(){this.Gi=new Date}stop(){this.OIe=new Date}}Object(C.a)(ra,"SimpleStopwatch",null,[]);var sa=c(1635),oa;(function(za){za[za.contentUpdate=0]="contentUpdate";za[za.editorsTableUpdate=1]="editorsTableUpdate";za[za.fileNameUpdate=2]="fileNameUpdate";za[za.wetContentUpdate=3]="wetContentUpdate";za[za.persistedContentUpdate=4]="persistedContentUpdate";za[za.clientRtcReconnectRequest=
5]="clientRtcReconnectRequest";za[za.replicationTelemetry=6]="replicationTelemetry";za[za.lockUpdate=7]="lockUpdate";za[za.collabServiceContentUpdate=8]="collabServiceContentUpdate";za[za.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";za[za.saveTargetUpdate=10]="saveTargetUpdate";za[za.uploadToOcsUpdate=11]="uploadToOcsUpdate";za[za.labelUpdate=12]="labelUpdate";za[za.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";za[za.subscribeOrExtend=14]="subscribeOrExtend";
za[za.elapsedBootTelemetry=15]="elapsedBootTelemetry";za[za.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";za[za.clientToClientResponseMessage=17]="clientToClientResponseMessage";za[za.verifyNotificationPipeline=18]="verifyNotificationPipeline";za[za.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";za[za.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";za[za.last=21]="last"})(oa||(oa={}));Object(C.b)("UpdateNotificationType",oa);var ka=c(1634),ia=c(1074),La=c(1075);
class va extends G{constructor(za,pa,Ba,Ra,fb,Va,ib,Xa,qb,rb){super(ib);this.wv=null;this.NQg=!1;this.gIa=0;this.VCe=new N.a;this.hMj=va.Xol();this.YBe=v.AFrameworkApplication.K.lb("OwningFeatureCrewForRtcNotificationKpis");this.Nd=za;this.yTg=this.xTg=0;this.Rwc=pa;this.Rwc.rrd(Object(e.a)(this,this.O_m,"onTooManyUndeliveredMessages"));this._clientId=Ba;this.$Sj=fb;this.wm.n$j(Object(e.a)(this,this.vYm,"onRefreshProxyRequired"));this.wm.l$j(Object(e.a)(this,this.tYm,"onRefreshAllPersistentStateRequest"));
this.wm.u$j(Object(e.a)(this,this.rO,"sendUpdateNotification"));this.wm.s8j(Object(e.a)(this,this.XVm,"onInternalPresenceUpdated"));this.wm.t8j(Object(e.a)(this,this.YVm,"onInternalUpdateNotificationReceived"));this.wm.r8j(Object(e.a)(this,this.WVm,"onInternalPersistentStateUpdated"));this.wm.q8j(Object(e.a)(this,this.VVm,"onInternalPersistentStateCleared"));this.wm.t$j(Object(e.a)(this,this.TZc,"sendPersistentState"));this.wm.J$j(Object(e.a)(this,this.ymb,"updateClientInfo"));this.me=Va;this.aw=
Ra;this.Bx=Xa;this.gV=qb;this.Orc=rb;this.ppa=Object(K.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.Application)||""}vYm(za,pa){this.wv=this.$Sj(pa.hubConnection);this.Rwc.reset();this.wv.kpn(Object(e.a)(this,this.m3,"onPresenceUpdated"));this.wv.jpn(Object(e.a)(this,this.$Gb,"onPersistentStateUpdated"));this.wv.ipn(Object(e.a)(this,this.dac,"onPersistentStateCleared"));this.wv.fqn(Object(e.a)(this,this.Vaa,"onUpdateNotificationReceived"))}cga(za,pa){this.DPa=pa.newState;2===pa.newState&&
this.VHn()}VHn(){for(let za of this.VCe)this.rO(null,new ha.a(za.key,za.value,!1,new a.a));this.VCe=new N.a}tYm(za,pa){pa.pXe();for(za=0;3>za;++za)this.AHn(za,pa)}AHn(za,pa){try{this.wv.Mcf(za).done(Ba=>{pa.iic(pa.iZe,"GetCompletePresenceSuccess")&&(pa.FEk.j_m(),l.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.aw),this.wm.ohn(),this.NXm(za,Ba),this.wm.Jgn(Ba),pa.cHh.ub(za)&&this.wm.TKi(za,pa.cHh.J(za),new a.a))}).fail(Ba=>{const {RtcUtils:Ra}=c(1460);
pa.iic(pa.iZe,"GetCompletePresenceFail")&&(l.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",Ra.G$b(Ba),this.aw),this.wm.U2d())}).always(()=>{pa.jx&&pa.jx.stop()})}catch(Ba){l.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",pa.iZe,Ba.message)}}TZc(za,pa){var {RtcUtils:Ba}=c(1460);za=pa.presence;let Ra;const fb=
pa.Y3a;this.gV.$N(1,0);try{Ra=Ba.IWe(za,this.Orc)}catch(ib){this.gV.$N(1,3);l.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",ib.message);fb.setException(ib);return}Ba=new m.a;Ba.Z(this._clientId,Object.assign(new S,{Presence:za,TimeStamp:(new Date).getTime()}));this.wm.$Ki(pa.type,Ba);if(2!==this.DPa)this.Bx.KIb(),this.gV.$N(1,2),fb.Eg(null);else{var Va=this.gIa.toString();++this.gIa;za=new X(()=>this.XHn(pa.type,Ra,Va),Va);za=this.Xbj(0,
pa.type).add(za);za.eYd(ib=>{2===ib&&this.gV.$N(1,6);fb.Eg(null)});za.dYd(()=>{})}}XHn(za,pa,Ba){let Ra=null;const fb=new ra,Va=new Y.a;l.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.aw);if(2!==this.DPa)return this.Bx.KIb(),this.gV.$N(1,2),l.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.aw),Va.Czf(),Va;this.me&&20>this.xTg&&(Ra=this.me.jg("WebServiceCall","Send Presence Message"),this.xTg++);fb.start();Va.IRc(1);try{this.wv.updatePersistentState(za,
pa).done(()=>{this.Bx.eRf();this.gV.$N(1,1);l.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Ba,this.aw);Va.Jhb(1);fb&&(fb.stop(),fb.ri>this.Nd.hVi?this.gV.$N(1,4):this.gV.$N(1,5))}).fail(ib=>{const {RtcUtils:Xa}=c(1460);this.uzb||(this.Bx.KIb(),this.gV.$N(1,3),l.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Ba,Xa.G$b(ib),this.aw));Va.Jhb(2)}).always(()=>{Ra&&Ra.stop()})}catch(ib){l.ULS.sendTraceTag(593072906,
500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",ib.message),this.gV.$N(1,3),Va.Jhb(2)}return Va}ymb(za,pa){({RtcUtils:za}=c(1460));const Ba=pa.izk,Ra=pa.Y3a;let fb;try{fb=za.IWe(Ba,this.Orc)}catch(Va){l.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",Va.message);Ra.setException(Va);return}try{this.wv.ymb(fb).done(()=>{l.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(Va=>{const {RtcUtils:ib}=
c(1460);this.uzb||l.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",ib.G$b(Va));Ra.Eg(null)})}catch(Va){l.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Va.message),Ra.Eg(null)}}rO(za,pa){({RtcUtils:za}=c(1460));const Ba=pa.type,Ra=pa.BM,fb=pa.mVk,Va=pa.Y3a;let ib;this.gV.$N(0,0);try{ib=za.IWe(Ra,this.Orc)}catch(qb){this.gV.$N(0,3);l.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",
qb.message);Va.setException(qb);return}if(2!==this.DPa)fb?this.VCe.Z(Ba,Ra):(this.Bx.KIb(),this.gV.$N(0,2)),Va.Eg(null);else{var Xa=this.gIa.toString();++this.gIa;pa=new X(()=>this.EIn(Ba,ib,Xa),Xa);pa=this.Xbj(1,Ba).add(pa);pa.eYd(qb=>{2===qb&&this.gV.$N(0,6);Va.Eg(null)});pa.dYd(()=>{})}}EIn(za,pa,Ba){let Ra=null;const fb=new ra,Va=new Y.a;l.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.aw);if(2!==this.DPa)return this.Bx.KIb(),this.gV.$N(0,2),l.ULS.sendTraceTag(7934172,
500,15,"Connection is lost - unable to send the message for [{0}]",this.aw),Va.Czf(),Va;this.me&&3===za&&20>this.yTg&&(Ra=this.me.jg("WebServiceCall","Send WetContent Update"),this.yTg++);fb.start();Va.IRc(1);this.wv.rO(za,pa).done(()=>{this.Bx.eRf();this.gV.$N(0,1);l.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",Ba,this.aw);Va.Jhb(1);fb&&(fb.stop(),fb.ri>this.Nd.hVi?this.gV.$N(0,4):this.gV.$N(0,5))}).fail(ib=>{const {RtcUtils:Xa}=c(1460);this.uzb||
(this.Bx.KIb(),this.gV.$N(0,3),l.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Ba,Xa.G$b(ib),this.aw));Va.Jhb(2)}).always(()=>{Ra&&Ra.stop()});return Va}Dha(){this.wv.bio(Object(e.a)(this,this.m3,"onPresenceUpdated"));this.wv.aio(Object(e.a)(this,this.$Gb,"onPersistentStateUpdated"));this.wv.$ho(Object(e.a)(this,this.dac,"onPersistentStateCleared"));this.wv.lio(Object(e.a)(this,this.Vaa,"onUpdateNotificationReceived"))}XVm(za,pa){this.m3(pa.HFa,
pa.Hzd)}m3(za){this.Bx.gXc();this.$Gb(0,za)}WVm(za,pa){this.$Gb(pa.type,pa.HFa)}NXm(za,pa){const Ba={};for(let Ra in pa)Ba[Ra]=pa[Ra].Presence;this.qAi(za,Ba,pa)}$Gb(za,pa){this.Bx.gXc();this.qAi(za,pa)}qAi(za,pa,Ba=null){var {RtcUtils:Ra}=c(1460);if(l.ULS.T7(500,100))for(var fb in pa);delete pa[this._clientId];if(!W.a.isEmpty(pa)){for(var Va in pa)fb=Va,pa[fb]=Ra.deserialize(pa[Va],"Presence",fb,!1,this.Orc);Ra=new m.a;Va=(new Date).getTime();for(let ib in pa){fb=pa[ib];let Xa=ib,qb;Ba?(qb=Ba[Xa],
qb.Presence=fb):qb=Object.assign(new S,{Presence:fb,TimeStamp:Va});Ra.Z(Xa,qb)}this.wm.$Ki(za,Ra);switch(za){case 0:this.NQg||(l.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.aw),this.NQg=!0,v.AFrameworkApplication.kh&&v.AFrameworkApplication.kh.MGm());this.wm.MKi(pa,[]);break;default:this.wm.hhn(za,pa)}}}VVm(za,pa){this.dac(pa.fvd)}dac(za){this.Bx.gXc();if(l.ULS.T7(500,100))for(let pa=0;pa<za.length;++pa);za.length&&(this.wm.Dhn(za),this.wm.ghn(za),this.wm.MKi({},
za))}YVm(za,pa){this.Vaa(pa.type,pa.BM)}Vaa(za,pa=null){this.Nd.cWn&&0===za&&l.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===za&&this.YBe&&0<this.YBe.length){var Ba=Object.assign(new ka.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.YBe,vetoPillar:"RealTimeCoauth"});(Ba=P.a.getInstance(Ba))&&Ba.logKpiUsage(this.hMj)}this.Nd.dWn&&13===za&&l.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
pa||"<none>"));this.Bx.gXc();5===za?(pa=(za=this.n5m(pa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",za.reason,za.reconnectDelay):"Received client reconnection request from the server without params.",l.ULS.sendTraceTag(18637071,500,50,pa),this.wm.U2d(za)):(pa=c(1460).RtcUtils.deserialize(pa,String.format("UpdateNotification-{0}",oa[za]),null,!1,this.Orc),this.wm.Chn(za,pa))}n5m(za){try{if(!za||""===za)return null;const pa=JSON.parse(za);
return new ca(pa[sa.a.cWf],pa[sa.a.GCn],pa[sa.a.KCn],pa[sa.a.iXf])}catch(pa){return l.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",pa.message),null}}Xbj(za,pa){return this.Rwc.gOl(this.hOl(za,pa))}hOl(za,pa){return za+","+pa}static Xol(){var za=new Map;za.set("SkipAria","True");za=Object.assign(new ia.a,{extendedProperties:za});return Object.assign(new La.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:za,blockFutureEmissionDurationInMs:3E5})}}
Object(C.a)(va,"RtcMessageHandler",G,[]);class Ga{Fvh(za,pa=""){const {MaxOutstandingThrottler:Ba}=c(1630);return Ba.createInstance(za,pa)}RMk(za,pa=""){const {MaxRateThrottler:Ba}=c(1632);return Ba.createInstance(za,pa)}}Object(C.a)(Ga,"ThrottlerFactory",null,[972]);var Oa=c(70),Za=c(1636);class ja{constructor(za){this.Nd=null;this.Ah=!1;this.sa=new Oa.a;this.kze=new m.a;this.ize=new m.a;this.pKe=za;this.kRb=this.pKe.Fvh(pa=>pa.send(),"GlobalMaxOustandingThrottler");this.kRb.rrd(()=>{this.sa.raiseEvent("TMUDM")})}init(za){this.Ah||
(this.Nd=za,this.kRb.init(this.Nd.Ylb,this.Nd.oSl),this.Ah=!0)}gOl(za){var {MaxRateThrottler:pa}=c(1632),{MaxOutstandingThrottler:Ba}=c(1630);this.Ah||this.init(new Za.a(pa.Iyh,Ba.fzh,Ba.Uyh,ja.nIm));({value:pa}=this.kze.Bc(za)).returnValue||(({value:pa}=this.ize.Bc(za)).returnValue||(pa="MaxOutstandingThrottler-"+za,pa=this.pKe.Fvh(Object(e.a)(this.kRb,this.kRb.add,"add"),pa),pa.init(this.Nd.Ylb,this.Nd.mIm),pa.rrd(()=>{this.sa.raiseEvent("TMUDM")}),this.ize.add(za,pa)),Ba="MaxRateThrottler-"+za,
pa=this.pKe.RMk(Object(e.a)(pa,pa.add,"add"),Ba),pa.init(this.Nd.oKm),this.kze.add(za,pa));return pa}reset(){for(let za of this.kze)za.value.gRf();for(let za of this.ize)za.value.gRf(),za.value.reset();this.kRb.gRf();this.kRb.reset()}rrd(za){this.sa.addHandler("TMUDM",za)}}ja.nIm=1E3;Object(C.a)(ja,"ThrottlerManager",null,[973]);var ba;(function(za){za[za.unspecified=0]="unspecified";za[za.word=1]="word";za[za.excel=2]="excel";za[za.powerPoint=3]="powerPoint";za[za.test=4]="test";za[za.wacFrontEnd=
5]="wacFrontEnd";za[za.oneNote=6]="oneNote";za[za.visio=7]="visio";za[za.officeMobile=8]="officeMobile";za[za.cosmosDBChangefeed=9]="cosmosDBChangefeed";za[za.last=10]="last"})(ba||(ba={}));Object(C.b)("RtcClientAppName",ba);const qa=(za,pa,Ba,Ra,fb,Va,ib,Xa,qb=null,rb=null,nb=null,Tb=null)=>{const Zb=J.createInstance(v.AFrameworkApplication.K),Hb=v.AFrameworkApplication.buildVersion?v.AFrameworkApplication.buildVersion:"1.0",Sa=Ma(za,pa,ib,Hb),ua=Zb.jzk?c(1779).RealtimeChannelMetrics.createInstance(Sa):
new E;var Fa=c(1479).FrequentLoggingMetrics.create(fb);Zb.MCn&&Fa.r4n(Zb.LCn);var Pa="";Pa=qb&&""!==qb?qb:"/rtc2/";Fa.rJh=n.a.t2(Pa);const Ea=Pa+"signalr";qb=Pa+"findsession";const lb=M.A0l;Pa=new Ga;nb=nb||I.a.getInstance();l.ULS.shipAssertTag(556867617,500,Zb.kVi<=c(1488).RealtimeChannel.Hri,"Client attempting to override max payload size beyond absolute limit");const zb=Math.min(Zb.kVi,c(1488).RealtimeChannel.Hri);Fa.Gri=zb;Fa=new va(Zb,new ja(Pa),za,Sa,Xb=>new F(Xb.createHubProxy(lb)),Xa,nb,ua,
Fa,zb);rb||(rb=c(1677).FindSessionStrategy.createInstance(pa,fb,qb,Xa,Hb,ib,za,Sa,nb,Va,Ra,Tb));rb.VCd=Zb.VCd;pa=new H(Sa);Ba=Ba?Ba.split(","):null;za=new (c(1488).RealtimeChannel)(za,Ba,Sa,Xa,()=>$.hubConnection(Ea),rb,Fa,pa,nb,ua,Zb,fb);za.init();return za},Ma=(za,pa,Ba)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",za,Ia(ba[Ba]),Ia("browser"),pa),Ia=za=>za?za.charAt(0).toLocaleUpperCase()+za.substring(1,za.length):za;c.d(O,"RealtimeChannel",function(){return wa});class wa{constructor(za,
pa,Ba,Ra,fb,Va,ib,Xa,qb,rb,nb,Tb){this.MIe=!1;this.y4=null;this.i1=new m.a;this.plc=1;this.nca=null;this.Cl=!1;this.jxe=(new Date(0)).getTime();this.Z1g=0;this._clientId=za;this.Cod=pa;this.A8=0;this.me=Ra;this.tle=Xa;this.UUj=ib;this.dwj=qb;this.gBj=fb;this.L5a=Va;this.aw=Ba;this.Bx=rb;this.Nd=nb;this.rg=Tb;this.ZWj=1>100*Math.random()}get SNa(){return this.L5a.SNa}set SNa(za){this.L5a.SNa=za}get ckb(){return this.UUj}get wm(){return this.dwj}init(){this.wm.m$j(Object(e.a)(this,this.Gzd,"disconnectAndCreateNewConnection"));
this.wm.M$j(Object(e.a)(this,this.i0m,"onUpdatePersistentStateRequestReceivedInternal"));this.wm.L$j(Object(e.a)(this,this.h0m,"onUpdatePersistentStateClearedRequestReceived"));this.rg.kXb(this.Bx);v.AFrameworkApplication.FK(()=>{const {FrequentLoggingMetrics:za}=c(1479);this.Bx.hRf();za.instance&&za.instance.iyf()});this.Xvh();this.sYk();this.wm.w$j(Object(e.a)(this,this.hko,"updateConnectionQueryString"))}sYk(){try{const Ba=$.signalR;if(!Ba)throw Error.invalidOperation("Failed to retrieve Signalr object");
const Ra=Ba.version;if(!Ra)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Ra){var za=Ba.transports;if(!za)throw Error.invalidOperation("Failed to retrieve transports object");var pa=za.longPolling;if(!pa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!pa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");pa.supportsKeepAlive=this.gPk()}}catch(Ba){l.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",Ba.message)}}gPk(){return()=>!1}Xvh(){const za=++this.plc;this.jxe=(new Date(0)).getTime();this.nca=this.gBj();this.wm.lhn(this.nca);this.nca.stateChanged(pa=>{this.cTm(pa,za)});this.nca.connectionSlow(Object(e.a)(this,this.c_m,"onSlowConnection"));this.nca.error(Object(e.a)(this,this.VZm,"onSignalRError"));this.nca.log=Object(e.a)(this,this.WZm,"onSignalRLog")}iic(za,pa){return za!==this.plc?(l.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
pa),!1):!0}connect(){2!==this.A8&&1!==this.A8&&(l.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.aw),this.tle.ZSm(),x.a.instance.s4n(),this.cga(1,this.A8),this.c9i())}c9i(){const za=this.plc;this.MIe=!1;this.Bx.QLi();this.L5a.cJl(Object(e.a)(this,this.CEk,"connectSignalrConnection"),Object(e.a)(this,this.Byi,"onFailureToConnect"),Object(e.a)(this.ckb,this.ckb.X3l,"initThrottlerManager"),Object(e.a)(this,this.iic,"verifyConnectionToken"),za)}Byi(za=null){this.Bx.SLi();
let pa=null;!za||"documentsessiondeleted"!==(pa=za.toLowerCase())&&"documentsessionexpired"!==pa?this.Gzd():(l.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.aw,za),this.disconnect())}Gzd(za,pa=null){l.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.y4);za=(za=2===this.A8||1===this.A8)&&!this.ckb.uzb;let Ba=!0,Ra=0;pa&&Object.getType(pa)!==Object.getType(Sys.EventArgs.Empty)&&
pa.fUf&&""!==pa.fUf&&(za=!0,this.L5a.yQn(pa.fUf),Ba=pa.iXf,Ra=pa.reconnectDelay);za&&this.cga(1,this.A8);++this.plc;this.ckb.Dha();this.D5n(Ba);this.L5a.NZk();this.Xvh();za&&window.setTimeout(Object(e.a)(this,this.c9i,"startConnecting"),Math.min(Ra,3E4))}hko(){let za=null;const pa=({correlationId:za}=this.L5a.ZRh()).returnValue;this.nca.qs=pa;l.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.aw,za)}CEk(za){const {FrequentLoggingMetrics:pa}=
c(1479);this.jxe=(new Date).getTime();let Ba=null;this.nca.qs=({correlationId:Ba}=this.L5a.ZRh()).returnValue;this.Nd.Dbk&&(this.nca.url=za,pa.instance&&(pa.instance.yrh=n.a.t2(za)));let Ra=null;this.me&&(Ra=this.me.jg("WebServiceCall","ConnectToServer"));l.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.aw);za={};this.Cod&&(za.transport=1===this.Cod.length?this.Cod[0]:this.Cod);za.pingInterval=null;x.a.instance.fXc(1,0);za.waitForPageLoad=!1;this.nca.start(za,null).done(fb=>
{this.Bx.TLi();x.a.instance.fXc(1,1,!0);l.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",fb.id,Ba)}).fail(fb=>{l.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.L5a.jW,Ba,this.aw);this.Byi();this.Bx.RLi(fb);x.a.instance.fXc(1,1,!1);this.wm.QKi(0,{["CorrelationId"]:Ba,["ErrorDetails"]:fb,["ConnectionState"]:h.a[this.A8]})}).always(()=>{const {FrequentLoggingMetrics:fb}=
c(1479);Ra&&Ra.stop();fb.instance&&(fb.instance.upe=!1)})}disconnect(){const {FrequentLoggingMetrics:za}=c(1479);0===this.A8?l.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.aw):(this.Bx.WLi(),za.instance&&(za.instance.upe=!0),l.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.aw),this.ckb.uzb=!0,this.tle.QTm(),this.cga(0,this.A8),this.Gzd(),this.ckb.uzb=!1)}D5n(za){const pa=this.Jrk(),Ba=this.nca,Ra=this.y4,
fb=()=>{if(this.MIe)l.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.MIe=!0,Ba.stop(!0,za)}catch(Va){l.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Va.message)}};0<pa?(l.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Ra,pa),window.setTimeout(fb,pa)):(l.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Ra),fb())}Jrk(){let za=0;0===this.nca.state&&(za=this.jxe+wa.Mto-
(new Date).getTime(),0>za&&(za=0));return za}get connectionState(){return this.A8}wza(za){this.wm.wza(za)}cYc(za){this.wm.cYc(za)}CYi(za){this.TZc(0,za)}TZc(za,pa){const Ba=new a.a;this.wm.TKi(za,pa,Ba);return Ba.task}KVa(za){this.wm.KVa(za)}$Ib(za){this.wm.$Ib(za)}qrd(za){this.wm.qrd(za)}f4d(za){this.wm.f4d(za)}prd(za){this.wm.prd(za)}e4d(za){this.wm.e4d(za)}dKc(za){return this.eQl(za)}dAb(){return this.Cbf(0)}Cbf(za){const pa={};for(let Ba of this.i1)Ba.value.ub(za)&&(pa[Ba.key]=Ba.value.J(za).data);
return pa}eQl(za){return this.i1.ub(za)&&this.i1.J(za).ub(0)?this.i1.J(za).J(0).data:null}i0m(za,pa){for(let Ba of pa.Spo)this.i1.ub(Ba.key)||this.i1.Z(Ba.key,new N.a),za=Ba.value,this.i1.J(Ba.key).Z(pa.type,new A(za.Presence,new Date(za.TimeStamp))),Ba.key===this._clientId&&0===pa.type&&this.wm.Vgn(za.Presence)}h0m(za,pa){for(const Ba of pa.fvd)this.i1.remove(Ba)}ijl(){const za=new N.a;if(!this.i1.ub(this._clientId))return za;for(let pa of this.i1.J(this._clientId))za.Z(pa.key,pa.value.data);return za}rO(za,
pa=null,Ba=!1){const Ra=new a.a;this.wm.qQf(za,pa,Ba,Ra);return Ra.task}B5(za){this.wm.B5(za)}Ccc(za){this.wm.Ccc(za)}Ceb(za){let pa,Ba;return({value:pa}=this.i1.Bc(za)).returnValue&&({value:Ba}=pa.Bc(0)).returnValue?new u(this.jQl(Ba),Ba.timeStamp):null}tHc(){const za={};for(let pa of this.i1)pa.value.Bc(0).returnValue&&(za[pa.key]=this.Ceb(pa.key));return za}ymb(za){const pa=new a.a;this.wm.ZKi(za,pa);return pa.task}get clientId(){return this._clientId}get P0n(){return this.ZWj}dispose(){const {FrequentLoggingMetrics:za}=
c(1479);this.Cl||(this.ckb.Dha(),this.rg.W3d(this.Bx),this.Bx.hRf(),za.instance&&za.instance.iyf(),this.Cl=!0)}cTm(za,pa){this.iic(pa,"StateChangedSignalR")&&this.cga(this.ath(za.newState),this.ath(za.oldState))}cga(za,pa){var {FrequentLoggingMetrics:Ba}=c(1479),{ClientToClientMessageTelemetry:Ra}=c(1690);if((1!==this.A8||0!==pa||1!==za)&&this.A8!==pa){const fb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.A8,
pa,za]));l.ULS.sendTraceTag(3290053,500,10,fb)}if(this.A8!==za){switch(za){case 2:Ba.instance&&Ba.instance.TGm();this.y4=this.nca.id;l.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.y4,this.aw);this.XDm(this.nca);l.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Ba=null;this.me&&(Ba=this.me.jg("WebServiceCall","Receive First Presence"));Ra=this.plc;this.wm.khn(Object(e.a)(this,this.iic,"verifyConnectionToken"),Ra,this.tle,Object(e.a)(this,
this.pXe,"clearExistingPersistentState"),this.ijl(),Ba);this.Nd.HCn&&(Ba=100*Math.random()<=this.Nd.ICn,c(1690).ClientToClientMessageTelemetry.z3b(this.wm,this.Nd,Ba).start());break;case 1:2===pa&&l.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.y4);break;case 0:if(Ra.instance&&Ra.instance.stop(),this.ckb.uzb)l.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.y4);else{1===pa&&(l.ULS.sendTraceTag(7672737,500,
50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.y4),this.Bx.XLi());2===pa&&l.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.y4);this.Gzd();return}}this.A8=za;this.wm.wgn(za,pa)}}XDm(za){if(za&&za.transport&&za.transport.name){za=za.transport.name;var pa=za.toLowerCase();
"websockets"===pa?l.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",za,this.aw):"serversentevents"===pa?l.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",za,this.aw):"foreverframe"===pa?l.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",za,this.aw):"longpolling"===pa?l.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",za,this.aw):"mocktransport"!==pa&&l.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",
za)}else l.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}c_m(){if(this.Nd.jVi){const za=n.a.fQ(this.SNa,"mid");l.ULS.sendTraceTag(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.y4,za)}else l.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.y4)}VZm(){l.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.y4)}WZm(za){za=c(1460).RtcUtils.G$b(za);if(this.Nd.jVi&&za.startsWith("Keep alive timed out.")){const pa=
n.a.fQ(this.SNa,"mid");l.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",za,pa)}else this.P0n&&2E3>this.Z1g&&!za.startsWith("Invok")&&!za.startsWith("Trigger")&&(l.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",za),this.Z1g++)}pXe(){let za;const pa=[];({value:za}=this.i1.Bc(this._clientId)).returnValue&&this.i1.remove(this._clientId);for(let Ba of this.i1.keys)Array.add(pa,Ba);for(const Ba of pa)this.i1.remove(Ba);za&&this.i1.Z(this._clientId,za);this.wm.Pgn(pa)}ath(za){switch(za){case 0:return 1;
case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",za,"Unknown SignalR state");}}jQl(za){return za&&za.timeStamp?(new Date).getTime()-za.timeStamp.getTime()>(this.Nd.Cik?6E4:this.Nd.Bik)?2:1:1}static createInstance(za,pa,Ba,Ra,fb,Va,ib,Xa=null,qb=null,rb=null,nb=null,Tb=null,Zb=null){return qa(za,pa,Ba,Zb,Ra,fb,Va,ib,Xa,qb,rb,Tb,nb)}}wa.Hri=31E3;wa.Tzf=8E3;wa.Mto=15E3;Object(C.a)(wa,"RealtimeChannel",null,[946,947])},1561:function(C,O,c){c.d(O,"a",function(){return l});
C=c(0);class l{constructor(){this.d3g=!1;this.Tsb=null;this.mBg=0;this.Spe=this.jxh();this.w8c=this.jxh();this.rob=this.dRb=0;this.vw=()=>new Date}get C6n(){return this.d3g}jxh(){const e=Array(6);for(let a=0;a<e.length;a++)e[a]=0;return e}Jtl(){return this.Spe.toString()}sol(){return this.w8c.toString()}s4n(){this.Tsb=this.vw()}fXc(e,a,h=!1){this.C6n||(h&&(this.d3g=!0),h=this.vw(),0===e&&5<this.dRb||1===e&&5<this.rob||(this.mBg<e?(1===this.dRb%2&&(this.Spe[this.dRb]=-1,this.dRb++),this.mBg=e,1===
a&&(this.w8c[this.rob]=-1,this.rob++),this.w8c[this.rob]=this.r3f(h),this.rob++):0===e?(this.Spe[this.dRb]=this.r3f(h),this.dRb++):(this.w8c[this.rob]=this.r3f(h),this.rob++)))}r3f(e){const a=e.getTime()-this.Tsb.getTime();this.Tsb=e;return a}static get instance(){l._instance||(l._instance=new l);return l._instance}static set instance(e){l._instance=e}}l._instance=null;Object(C.a)(l,"LatencyMetrics",null,[])},1585:function(C,O,c){C=c(0);class l{constructor(){this.iyg=this.mle=!1;this.callback=null}wTc(a){this.callback=
a;this.cej()}Yqi(a){this.mle||(this.mle=!0,this.$Aj=a,this.cej())}cej(){this.mle&&this.callback&&!this.iyg&&(this.iyg=!0,this.callback(this.$Aj))}}Object(C.a)(l,"CompletionTask",null,[]);c.d(O,"a",function(){return e});class e{constructor(){this.YRg=new l;this.WRg=new l}eYd(a){this.YRg.wTc(a)}dYd(a){this.WRg.wTc(a)}IRc(a){this.YRg.Yqi(a)}Jhb(a){this.WRg.Yqi(a)}Czf(){this.IRc(2);this.Jhb(2)}}Object(C.a)(e,"MessageStatus",null,[987])},1629:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;
(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(l||(l={}));Object(C.b)("ChannelConnectionState",l)},1630:function(C,O,c){c.r(O);c.d(O,"MaxOutstandingThrottler",function(){return h});C=c(0);var l=c(44),e=c(70);O=c(1631);var a=c(1585);class h extends O.a{constructor(m,v=""){super(m,v);this.L9b=this.Ylb=0;this.sa=new e.a;this.iSb=!1;this.Wgd=this.X8c=this.x8c=this.oKe=0;this.u1=[];this.clearTimeout=h.Y2e}add(m){this.jSb||this.init(h.fzh,h.Uyh);
this.zub++;const v=new a.a;this.n7b?this.Q7d(m,v):this.Wgd<this.L9b?this.SZc(m,v):(this.Q7d(m,v),this.iSb=!1);return v}SZc(m,v){m=this.t0g(m);const u=this.setTimeout(Object(l.a)(this,this.LWm,"onMessageWaitTimeExpired"),this.Ylb);++this.Wgd;Array.add(this.u1,u);const n=this.x8c;m.eYd(x=>{v.IRc(x)});m.dYd(x=>{this.x8c===n&&(this.KWm(n,u),v.Jhb(x))})}KWm(m,v){this.x8c===m&&(--this.Wgd,this.clearTimeout(v),Array.remove(this.u1,v),this.n7b&&this.tIn())}tIn(){this.n7b&&!this.iSb&&(this.oKe=this.setTimeout(Object(l.a)(this,
this.uIn,"sendThrottledMessageFromTimer"),0),this.iSb=!0)}uIn(){this.iSb=!1;if(this.n7b){const m=this.Ynd,v=this.XVb;this.iBc(!1);this.SZc(m,v)}}LWm(){++this.X8c;this.X8c>Math.floor(this.L9b/2)&&(this.X8c=-1E9,this.sa.raiseEvent("TMUDM"))}rrd(m){this.sa.addHandler("TMUDM",m)}reset(){this.zub=this.Qwc=this.Umc=this.X8c=0;++this.x8c;for(const m of this.u1)this.clearTimeout(m);this.Wgd=0;this.u1=[];this.iBc(!0);this.iSb&&(this.clearTimeout(this.oKe),this.oKe=0,this.iSb=!1)}init(m,v){this.jSb||(this.Ylb=
m,this.L9b=v,this.jSb=!0)}static createInstance(m,v=""){return new h(m,v)}static Y2e(m){window.clearTimeout(m)}}h.fzh=15E3;h.Uyh=5;Object(C.a)(h,"MaxOutstandingThrottler",O.a,[985,984])},1631:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);var l=c(8);class e{constructor(a,h=""){this.Umc=this.Qwc=0;this.dve=!1;this.XVb=this.Ynd=null;this.jSb=!1;this.t0g=a;this.Ybj=h;this.setTimeout=e.f3e;this.zub=this.Qwc=this.Umc=0}gRf(){0<this.zub&&0<this.Umc&&l.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",
this.Ybj,this.Umc,this.zub);0<this.zub&&0<this.Qwc&&l.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Ybj,this.Qwc,this.zub)}get n7b(){return this.dve}Q7d(a,h){this.Qwc++;this.iBc(!0);this.dve=!0;this.Ynd=a;this.XVb=h}iBc(a){this.dve=!1;this.XVb&&a&&(this.Umc++,this.XVb.Czf());this.XVb=this.Ynd=null}static f3e(a,h){return window.setTimeout(a,h)}}Object(C.a)(e,"ThrottlerBase",null,[])},1632:function(C,O,c){c.r(O);c.d(O,"MaxRateThrottler",function(){return a});
C=c(0);var l=c(44);O=c(1631);var e=c(1585);class a extends O.a{constructor(h,m=""){super(h,m);this.T9b=0;this.Sqc=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(h){this.jSb||(this.T9b=h,this.jSb=!0)}add(h){this.jSb||this.init(a.Iyh);this.zub++;const m=this.currentTime(),v=new e.a;this.Sqc>m&&(this.Sqc=m);this.n7b?(this.iBc(!0),this.Q7d(h,v)):this.Sqc+this.T9b<=m?this.SZc(h,v):(this.Q7d(h,v),this.setTimeout(Object(l.a)(this,this.sIn,"sendThrottledMessage"),this.Sqc+this.T9b-
m));return v}sIn(){if(this.n7b){const h=this.Ynd,m=this.XVb;this.iBc(!1);this.SZc(h,m)}}SZc(h,m){this.Sqc=this.currentTime();h=this.t0g(h);h.eYd(v=>{m.IRc(v)});h.dYd(v=>{m.Jhb(v)})}static createInstance(h,m=""){return new a(h,m)}}a.Iyh=200;Object(C.a)(a,"MaxRateThrottler",O.a,[983,984])},1633:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l extends Sys.EventArgs{constructor(e,a,h,m){super();this.type=e;this.BM=a;this.mVk=h;this.Y3a=m}}Object(C.a)(l,"SendUpdateNotificationEventArgs",
Sys.EventArgs,[])},1635:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}l.cWf="rr";l.KCn="rd";l.GCn="rbp";l.iXf="sa";Object(C.a)(l,"RtcReconnectParams",null,[])},1636:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a,h,m){this.oKm=e;this.Ylb=a;this.mIm=h;this.oSl=m}}Object(C.a)(l,"ThrottlerManagerSettings",null,[])},1673:function(C,O,c){C=c(0);class l extends Sys.EventArgs{constructor(N,G){super();this.newState=N;this.oldState=G}}Object(C.a)(l,"ChangedConnectionStateEventArgs",
Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(N,G){super();this.izk=N;this.Y3a=G}}Object(C.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class a extends Sys.EventArgs{constructor(N){super();this.presence=N}}Object(C.a)(a,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var h=c(1781),m=c(1780),v=c(1778);class u extends Sys.EventArgs{constructor(N,G=null){super();this.Fl=N;this.z_j=G}get type(){return this.Fl}get BM(){return this.z_j}}Object(C.a)(u,"UpdateNotificationEventArgs",Sys.EventArgs,
[]);class n extends Sys.EventArgs{constructor(){super()}}Object(C.a)(n,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);class x extends Sys.EventArgs{constructor(N,G,P,S,W,X){super();this.iic=N;this.iZe=G;this.FEk=P;this.cHh=W;this.pXe=S;this.jx=X}}Object(C.a)(x,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(N){super();this.hubConnection=N}}Object(C.a)(A,"RefreshProxyEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(N,
G){super();this.xea=N;this.errorMessage=G}}Object(C.a)(H,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(N,G,P){super();this.type=N;this.presence=G;this.Y3a=P}}Object(C.a)(E,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var L=c(1633);class M extends Sys.EventArgs{constructor(){super()}}Object(C.a)(M,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(N){super();this.fvd=N}}Object(C.a)(F,"UpdatePersistentStateClearedRequestEventArgs",
Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(N,G){super();this.type=N;this.Spo=G}}Object(C.a)(J,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var I=c(70);c.d(O,"a",function(){return K});class K{constructor(){this.sa=new I.a}wgn(N,G){this.sa.raiseEvent("CSC",new l(N,G))}lhn(N){this.sa.raiseEvent("RP",new A(N))}U2d(N){this.sa.raiseEvent("RC",N)}ohn(){this.sa.raiseEvent("RMID")}khn(N,G,P,S,W,X){this.sa.raiseEvent("RPS",new x(N,G,P,S,W,X))}$Ki(N,G){this.sa.raiseEvent("UPSR",
new J(N,G))}MKi(N,G){this.sa.raiseEvent("PU",new v.a(N,G))}Vgn(N){this.sa.raiseEvent("MPU",new a(N))}qQf(N,G,P,S){this.sa.raiseEvent("SUN",new L.a(N,G,P,S))}Chn(N,G){this.sa.raiseEvent("UNR",new u(N,G))}TKi(N,G,P){this.sa.raiseEvent("SP",new E(N,G,P))}hhn(N,G){this.sa.raiseEvent("PSU",new m.a(N,G))}ghn(N){this.sa.raiseEvent("PSC",new h.a(N))}Pgn(N){this.sa.raiseEvent("IPSC",new h.a(N))}Dhn(N){this.sa.raiseEvent("UPSC",new F(N))}phn(N,G){this.sa.raiseEvent("SPC",new M(N,G))}QKi(N,G){this.sa.raiseEvent("RCF",
new H(N,G))}Jgn(N){this.sa.raiseEvent("CPSWM",new n(N))}ZKi(N,G){this.sa.raiseEvent("UCI",new e(N,G))}wza(N){this.sa.addHandler("CSC",N)}cYc(N){this.sa.removeHandler("CSC",N)}n$j(N){this.sa.addHandler("RP",N)}m$j(N){this.sa.addHandler("RC",N)}q$j(N){this.sa.addHandler("RMID",N)}l$j(N){this.sa.addHandler("RPS",N)}M$j(N){this.sa.addHandler("UPSR",N)}KVa(N){this.sa.addHandler("PU",N)}$Ib(N){this.sa.removeHandler("PU",N)}s8j(N){this.sa.addHandler("IPU",N)}J$j(N){this.sa.addHandler("UCI",N)}u$j(N){this.sa.addHandler("SUN",
N)}t8j(N){this.sa.addHandler("IUNR",N)}B5(N){this.sa.addHandler("UNR",N)}Ccc(N){this.sa.removeHandler("UNR",N)}qrd(N){this.sa.addHandler("PSU",N)}f4d(N){this.sa.removeHandler("PSU",N)}r8j(N){this.sa.addHandler("IPSU",N)}prd(N){this.sa.addHandler("PSC",N)}e4d(N){this.sa.removeHandler("PSC",N)}q8j(N){this.sa.addHandler("IPSC",N)}L$j(N){this.sa.addHandler("UPSC",N)}t$j(N){this.sa.addHandler("SP",N)}w$j(N){this.sa.addHandler("SPC",N)}static getInstance(){return K._instance||(K._instance=new K)}}K._instance=
null;Object(C.a)(K,"RtcEventHub",null,[974])},1677:function(C,O,c){c.r(O);C=c(0);var l=c(8),e=c(44),a=c(77),h=c(1629);class m{}m.T9b="throttling_messageDelay";m.TOc="enabled";m.Ylb="throttling_timeToWaitForResponse";m.L9b="throttling_maxNumberOfOutstandingMessages";m.f3h="throttling_globalMaxNumberOfOutstandingMessages";m.errorMessage="errorMessage";m.m7i="url";m.WDa="queryString";m.jW="connectionString";Object(C.a)(m,"RtcFindSessionOutputFieldNameConstants",null,[]);var v=c(2),u=c(51),n=c(37),x=
c(285),A=c(1339),H=c(78),E=c(17),L=c(121);class M{constructor(){this.g3h=this.Eri=this.Fri=this.Kri=0;this.uQd=!1;this.correlationId=this.jW=this.WDa=this.jZe=this.errorMessage=null}get DDk(){return this.jZe+"?"+this.WDa}}Object(C.a)(M,"FindSessionResponse",null,[]);var F=c(589);class J{constructor(ca,ha,ra,sa,oa,ka){this.fUa=null;const {FindSessionStrategy:ia}=c(1677);this.hTj=ca;ca=String.format("{0}={1}",F.a.clientId,E.a.Jj(sa));ca=String.format("{0}&{1}={2}",ca,F.a.userSessionId,E.a.Jj(oa));ca=
String.format("{0}&{1}={2}",ca,F.a.llj,E.a.Jj(ra.toString()));ca=String.format("{0}&{1}={2}",ca,F.a.userType,E.a.Jj("1"));ca=String.format("{0}&{1}={2}",ca,F.a.xlj,E.a.Jj(ha));ca=String.format("{0}&{1}={2}",ca,F.a.Moh,E.a.Jj(ia.kzk));(ha=J.Sbf(ra,ka))&&(ca=String.format("{0}&{1}",ca,ha));this.hBj=ca}$Mi(){this.fUa=this.hTj()}Jgl(){this.fUa&&""!==this.fUa||(this.$Mi(),l.ULS.sendTraceTag(575784194,500,this.fUa&&""!==this.fUa?50:15,"Query signature delegate called for refresh returned: {0} ",this.fUa));
const ca=String.format("{0}={1}",F.a.yIb,E.a.Jj(this.fUa));return String.format("{0}&{1}",ca,this.hBj)}static Sbf(ca,ha){return 4===ca?String.format("{0}={1}",F.a.bvi,"1"):ha?ha.f2h():null}}Object(C.a)(J,"FindSessionQueryStringGenerator",null,[]);var I=c(1479),K=c(1561),N=c(1460),G=c(1636);class P{}P.fbl="FSType";Object(C.a)(P,"RtcFindSessionRequestHeaders",null,[]);class S{}S.Din="polling";Object(C.a)(S,"RtcFindSessionTypes",null,[]);var W=c(1635);class X{}X.Dso="RTC-TokenProofkey";X.zpm="RTC-IsWacJsBootFsRequest";
Object(C.a)(X,"RtcRequestHeaders",null,[]);c.d(O,"FindSessionStrategy",function(){return Y});class Y{constructor(ca,ha,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za,ja=null){this.UOg=(new Date(0)).getTime();this.cRg=0;this.Mfd=!1;this.G0g=null;this.xRf=36E5;this.uPb=Y.k9h;this.tnc=0;this.lJb=null;this.DPa=0;this.pdc=this.Arh=null;this.jUj=[m.TOc,m.errorMessage,m.m7i,m.jW,m.WDa,m.f3h,m.L9b,m.Ylb,m.T9b];this.iUj=[m.TOc,m.errorMessage];this.jW=this.SNa=null;this.OFg=new J(Oa?Oa:()=>v.AFrameworkApplication.ym,oa,ka,
ia,ca,ha);this.Jkc=Za;this.me=sa;this.rg=ha;this.Wpe=ra;this.aw=La;this.wm=va;this.Onc=ja;this.PFg=!1;this.VCd=9E4;Ga&&Ga.execute(ba=>{ba.JVa(()=>{l.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.aw);this.OFg.$Mi()})});2>=100*Math.random()&&(this.xRf=3E5);I.FrequentLoggingMetrics.instance&&(I.FrequentLoggingMetrics.instance.WLh=this.xRf)}yQn(ca){this.pdc=ca}init(){this.wm.q$j(Object(e.a)(this,this.Pyn,"resetGetMachineIdDelay"));this.wm.wza(Object(e.a)(this,
this.cga,"onConnectionStateChanged"))}cga(ca,ha){this.DPa=ha.newState;2===ha.newState&&(this.tnc=0)}ZRh(){let ca;ca=this.lJb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.lJb.WDa,Y.Lth,E.a.Jj(ca)),correlationId:ca}}cJl(ca,ha,ra,sa,oa){this.yHn(()=>{sa(oa,"GetMachineIdSuccess")&&(l.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.jW,this.aw),ca(this.G0g),ra(this.iOl()))},ka=>{sa(oa,"GetMachineIdFailure")&&(l.ULS.sendTraceTag(4060129,500,
15,"Failed to retrieve Rtc MachineId for [{0}]",this.aw),ha(ka))},sa,oa)}NZk(){this.poh();this.z2l()}yHn(ca,ha,ra,sa){l.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.jW);if(this.jW)ca();else{var oa=this.Qqk();window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(ca,ha,ra,sa)},oa)}}sendFindSessionRequestToServerInternal(ca,ha,ra,sa){ra(sa,"RequestMachineId")&&(this.UOg=(new Date).getTime(),ra=n.a.kf(),
this.QFd(oa=>{const ka=n.a.kf();this.SEi(oa);this.eZf();ca();oa=n.a.kf()-ka;l.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",oa)},oa=>{const ka=n.a.kf();this.poh();I.FrequentLoggingMetrics.instance&&I.FrequentLoggingMetrics.instance.$N(2,3);ha(oa);oa=n.a.kf()-ka;l.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",oa)},!1),ra=n.a.kf()-ra,l.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",ra))}z2l(){this.uPb+=Y.sAl;this.uPb=Math.min(this.uPb,Y.XHm)}Qqk(){var ca=
(new Date).getTime();ca=this.UOg+this.uPb-ca;0>ca&&(ca=0);return ca}SEi(ca){try{this.lJb=ca,this.SNa=ca.DDk,this.jW=ca.jW,this.Arh=ca.WDa,this.G0g=ca.jZe}catch(ha){l.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",ha.toString())}}poh(){this.jW=null;this.qoh()}eZf(){this.qoh();this.Mfd=!0;this.cRg=window.setTimeout(Object(e.a)(this,this.emn,"refreshMachineId"),this.xRf)}qoh(){this.Mfd&&(window.clearTimeout(this.cRg),this.Mfd=!1)}emn(){this.Mfd=
!1;this.QFd(ca=>{const ha=this.Arh!==ca.WDa,ra=this.jW!==ca.jW,sa=this.jW;this.SEi(ca);0!==this.DPa&&(ra?(l.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",sa||"null",ca.jW),this.wm.U2d()):(this.wm.phn(ha,ra),this.eZf()))},()=>{I.FrequentLoggingMetrics.instance&&I.FrequentLoggingMetrics.instance.$N(2,3);this.eZf()},!0)}Pyn(){this.uPb=Y.k9h}iOl(){return new G.a(this.lJb.Kri,this.lJb.Fri,this.lJb.Eri,this.lJb.g3h)}pdo(ca){if(Object.getType(ca)!==
Object)return null;for(let ha in ca);return this.mLk(ca)}mLk(ca){if(!(m.TOc in ca))return null;const ha=ca[m.TOc];var ra=ha?this.jUj:this.iUj;for(const sa of ra)if(!(sa in ca))return null;ra=Object.assign(new M,{uQd:ca[m.TOc],errorMessage:ca[m.errorMessage],correlationId:L.a.create().toString()});ha&&(ra.jZe=ca[m.m7i],ra.WDa=ca[m.WDa],ra.jW=ca[m.jW],ra.g3h=ca[m.f3h],ra.Eri=ca[m.L9b],ra.Fri=ca[m.Ylb],ra.Kri=ca[m.T9b]);return ra}Ktl(ca,ha){l.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");
this.Onc.sJh.continueWith(()=>{this.Onc.sJh.result?(l.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),ca(this.Onc.tJh)):(l.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),ha(this.Onc.tJh))})}KSi(ca,ha,ra,sa,oa=!1){return ka=>{K.a.instance.fXc(0,1);ca&&ca.stop();this.Jkc=this.pdc=null;this.Ooi(ka.data,!0,ha);var ia=N.RtcUtils.deserialize(ka.data.Ie,"FindSession",null);if(ia)if(ia=this.pdo(ia)){if(ia.uQd&&ia.WDa&&ia.jW){l.ULS.sendTraceTag(4317446,
500,50,"Successfully retrieved MachineId from server for [{0}]",this.aw);this.Tym(ka.data);ra(ia);return}ha.FindSessionFailureReason="FindSessionInvalidResponse";ha.IsRtcEnabled=ia.uQd;ha.IsQueryStringEmpty=!ia.WDa;ha.IsConnectionStringEmpty=!ia.jW;l.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.aw,ia.uQd,!ia.WDa,!ia.jW)}else ha.FindSessionFailureReason=
"FindSessionTranslateServerResponseFailed",l.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.aw);else ha.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",l.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.aw);this.RKi(ha,oa);sa(null)}}DSi(ca,ha,ra,sa=!1){return oa=>{K.a.instance.fXc(0,1);ca&&ca.stop();this.Jkc=this.pdc=null;this.Ooi(oa.data,!1,ha);let ka=null;var ia="unknown";let La=
"unknown";oa.data&&((ia=oa.data.qj)&&Y.pZc in ia&&(ka=ia[Y.pZc].toString()),ia=A.a[oa.data.status],La=oa.data.Df.toString());ha.FindSessionFailureReason="FindSessionRequestFailed";ha.HttpErrorCode=La;ha.HttpErrorStatus=ia;ha[Y.pZc]=ka;l.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",ia,La,this.aw,ka,sa);this.RKi(ha,sa);ra(La)}}QFd(ca,ha,ra=!1){let sa=null;l.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",
this.aw);const oa={};var ka=this.OFg.Jgl();oa[x.a.Z5]=L.a.create().toString();this.pdc&&""!==this.pdc?ka=String.format("{0}&{1}={2}",ka,W.a.cWf,this.pdc):this.Jkc&&""!==this.Jkc&&(ka=String.format("{0}&{1}={2}",ka,W.a.cWf,this.Jkc),oa[X.Dso]="True",oa[X.zpm]="True");ka=this.Wpe+"?"+ka;ra&&(oa[P.fbl]=S.Din);const ia={};ia.IsNetworkOfflineBeforeSendRequest=this.rg.aNa;ia.HasAvailableConnectionsBeforeSendRequest=this.rg.OKd;ia.MaxConnectionsAllowed=this.rg.I9b;ia.IsRefreshMachineId=ra;this.Onc&&!this.PFg?
(this.Ktl(this.KSi(null,ia,ca,ha,ra),this.DSi(null,ia,ha,ra)),this.PFg=!0):(this.me&&(sa=this.me.jg("WebServiceCall","GetMachineIdFromTheServer")),I.FrequentLoggingMetrics.instance&&I.FrequentLoggingMetrics.instance.$N(2,0),0>this.rg.oXb(ka,1,null,oa,[Y.jxd,Y.pZc,Y.cTc,Y.bWf,Y.Vti,Y.zwi,Y.ywi],1,this.KSi(sa,ia,ca,ha,ra),this.DSi(sa,ia,ha,ra),null,!1,null,this.VCd,"3",null,!0)&&(5<this.tnc&&200>this.tnc&&l.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",
this.tnc),window.setTimeout(()=>{this.tnc++;ha("-1")},1E3)))}Ooi(ca,ha,ra){ra||(ra={});ra.IsNetworkOfflineAfterRequestComplete=this.rg.aNa;ra.IsRequestSucceeded=ha;ca&&(ra.EnqueueTime=ca.ZKa,ra.InvokedTime=ca.gH,ra.CompletedTime=ca.HS,ca.qj&&(Y.jxd in ca.qj&&(ra.CorrelationId=ca.qj[Y.jxd]),Y.cTc in ca.qj&&(ra[Y.cTc]=ca.qj[Y.cTc])));l.ULS.sendTraceTag(38633565,500,ha?50:15,N.RtcUtils.G$b(ra))}RKi(ca,ha){ca||(ca={});ca.ConnectionState=h.a[this.DPa];ha||this.wm.QKi(1,ca)}Tym(ca){try{var ha=!1,ra=!1,
sa=ca.qj,oa=u.a.t2(ca.request.get_url());if(sa&&Y.bWf in sa){const Ga=sa[Y.bWf].toString().toLocaleLowerCase();ra="true"===Ga;ha="false"===Ga}sa=!1;const va=0<=oa.toLocaleLowerCase().indexOf("collab");ra&&!va?sa=!0:ha&&va&&(sa=!0);if(sa){ha={};ha.HostName=oa;ha.Status=A.a[ca.status];ha.HttpStatus=ca.Df.toString();var ka=ca.request.get_headers();for(let Ga in ka){var ia=ka[Ga];(oa=Ga)&&0<oa.length&&(ra=0,ia&&(ra=ia.toString().length),ha["r_"+oa]=ra)}if(ca.qj){const Ga=new a.a;Ga.add(Y.jxd);Ga.add(Y.cTc);
Ga.add(Y.pZc);Ga.add(Y.zwi);Ga.add(Y.ywi);Ga.add(Y.Vti);Y.c6j(ha,ca.qj,Ga)}Y.N5j(ca.request.get_url(),ha);var La=H.a.toJSON(ha);l.ULS.sendTraceTag(559437006,500,15,La)}}catch(va){l.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",va.toString())}}static createInstance(ca,ha,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za=null){return Y.kMk(ca,ha,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za)}static kMk(ca,ha,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za=null){ca=ca||L.a.create().toString();ca=new Y(ca,ha,ra,sa,oa,ka,ia,La,
va,Ga,null,Oa,Za);ca.init();return ca}static c6j(ca,ha,ra){for(let sa of ra)sa in ha&&(ca[sa]=ha[sa])}static N5j(ca,ha){if(ca){var ra=ca.indexOf("?");if(-1!==ra)for(ca=ca.substr(ra+1).split("&"),ra=0;ra<ca.length;++ra){var sa=ca[ra].split("=");if(2===sa.length){const oa=sa[0];if(oa&&0<oa.length){let ka=0;if(sa=sa[1])ka=sa.length;ha["q_"+oa]=ka}}}}}}Y.sAl=3E3;Y.XHm=3E5;Y.kzk="1.0";Y.k9h=1E3;Y.jxd="X-CorrelationId";Y.Lth="corrid";Y.pZc="RtcErrorCode";Y.cTc="X-OfficeCluster";Y.bWf="X-NewEnv";Y.Vti="X-MSEdge-Ref";
Y.ywi="X-OFFICEFD";Y.zwi="X-OfficeFE";Object(C.a)(Y,"FindSessionStrategy",null,[971])},1690:function(C,O,c){c.r(O);C=c(0);var l=c(8),e=c(44),a=c(433),h=c(59),m=c(77);class v{constructor(n){this.messageId=n;this.wIn=(new Date).getTime();this.gwf=new m.a}}Object(C.a)(v,"MessageLatencyDetails",null,[]);c.d(O,"ClientToClientMessageTelemetry",function(){return u});class u{constructor(n,x,A){this.eIa=null;this.Rye=this.RGe=0;this.Nd=x;this.ZRg=A;this.Fvc=!1;this.wm=n;this.wm.B5(Object(e.a)(this,this.ajn,
"receiveMessage"))}start(){if(this.ZRg&&!this.Fvc){const n=this.Nd.nVi;this.Rye=this.Nd.iVi;n<=this.Rye?(l.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Nd.nVi,this.Nd.iVi),this.ZRg=!1):(this.Fvc=!0,this.RGe=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),n))}}sendMessage(){if(this.Fvc){const n=h.a.create().toString();
this.eIa=new v(n);this.wm.qQf(16,n,!1,new a.a);window.setTimeout(()=>{this.jBm(n)},this.Rye)}}jBm(n){this.eIa&&this.eIa.messageId===n&&(0<this.eIa.gwf.count?(n=this.eIa.gwf.toArray().join(","),l.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",n)):l.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.eIa=null)}stop(){this.RGe&&(window.clearInterval(this.RGe),this.Fvc=!1)}ajn(n,x){16===x.type?this.wm.qQf(17,x.BM,!1,new a.a):17===x.type&&this.Fvc&&x.BM&&this.Gbn(x.BM)}Gbn(n){n&&
this.eIa&&n.toString()===this.eIa.messageId&&(n=(new Date).getTime()-this.eIa.wIn,this.eIa.gwf.add(n))}static get instance(){return u._instance}static z3b(n,x,A){return u.instance||(u._instance=new u(n,x,A))}}u._instance=null;Object(C.a)(u,"ClientToClientMessageTelemetry",null,[])},1778:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l extends Sys.EventArgs{constructor(e,a){super();this.HFa=e;this.Hzd=a}}Object(C.a)(l,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1779:function(C,O,c){c.r(O);
c.d(O,"RealtimeChannelMetrics",function(){return m});C=c(0);var l=c(8),e=c(187),a=c(78),h=c(1460);class m{constructor(){this.JTg=this.KTg=this.LTg=this.FTg=this.ETg=this.GTg=this.Asc=this.CAe=0;this.xad=this.Jxe=this.Uqc=this.uxe=this.vxe=this.ixe=this.n8a=this.Gqc=this.tSb=this.hxe=this.vad=this.PQb=null;this.cze=this.Nrc=this.E0g=this.ozg=0;this.$Rg=!1;this.QLi=this.SQf;this.TLi=this.VQf;this.SLi=this.UQf;this.XLi=this.YQf;this.WLi=this.XQf;this.hRf=this.iRf;this.eRf=this.fRf;this.KIb=this.cRf;
this.gXc=this.dRf;this.RLi=this.TQf;this.fOa=this.UDf;this.Yhb=this.VDf}SQf(){this.CAe++;this.hxe=new Date;this.PQb||(this.PQb=new Date)}VQf(){this.Asc++;this.n8a=new Date;this.vad||(this.vad=this.n8a);this.Uqc=this.n8a;this.VDk()}UQf(){this.GTg++;this.ixe=new Date}YQf(){this.ETg++;this.tSb=new Date}XQf(){this.FTg++;this.Gqc=new Date}fRf(){this.vxe=new Date;this.LTg++}dRf(){this.xad||(this.xad=new Date);this.KTg++}cRf(){this.uxe=new Date;this.JTg++}iRf(){!this.$Rg&&this.CAe&&(l.ULS.sendTraceTag(39321871,
500,15,a.a.toJSON(this.RAk())),this.$Rg=!0)}TQf(v){let u,n;({E7h:v,G7h:u,exception:n}=h.RtcUtils.Y7k(v));v&&v!==e.a.yD&&(l.ULS.sendTraceTag(40157596,500,15,a.a.toJSON({["HttpErrorCode"]:v,["HttpErrorStatus"]:u,["Exception"]:n})),e.a.Wpf(v)&&this.ozg++,e.a.Utf(v)&&this.E0g++)}UDf(){this.Jxe=new Date}VDf(){this.tSb=this.Uqc=new Date}RAk(){return{["numberOfConnectionAttempts"]:this.CAe,["numberOfSuccessfulConnections"]:this.Asc,["numberOfFailedConnections"]:this.GTg,["numberOfDisconnectedConnections"]:this.ETg,
["numberOfExplicitDisconnectedConnections"]:this.FTg,["numberOfSentMessages"]:this.LTg,["numberOfReceivedMessages"]:this.KTg,["numberOfLostMessages"]:this.JTg,["firstConnectionAttempt"]:this.PQb?this.PQb:null,["firstMessageReceived"]:this.xad?this.xad:null,["firstConnectionSuccess"]:this.vad?this.vad:null,["lastConnectionAttempt"]:this.hxe?this.hxe:null,["lastConnectionSuccess"]:this.n8a?this.n8a:null,["lastConnectionFailure"]:this.ixe?this.ixe:null,["lastMessageSent"]:this.vxe?this.vxe:null,["lastMessageLost"]:this.uxe?
this.uxe:null,["lastDisconnect"]:this.tSb?this.tSb:null,["lastExplicitDisconnect"]:this.Gqc?this.Gqc:null,["lastTimeOnline"]:this.Uqc?this.Uqc:null,["lastTimeOffline"]:this.Jxe?this.Jxe:null,["maxDisconnectedTimeMs"]:this.Nrc,["maxExplicitDisconnectedTimeMs"]:this.cze,["clientConnectionErrors"]:this.ozg,["serverConnectionErrors"]:this.E0g}}VDk(){this.PQb&&1===this.Asc&&(this.Nrc=Math.max(this.Nrc,this.n8a.getTime()-this.PQb.getTime()));this.tSb&&1<this.Asc&&(this.Nrc=Math.max(this.Nrc,this.n8a.getTime()-
this.tSb.getTime()));this.Gqc&&1<this.Asc&&(this.cze=Math.max(this.cze,this.n8a.getTime()-this.Gqc.getTime()))}static createInstance(v){m._instance||(m._instance=new m,l.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",v));return m._instance}}m._instance=null;Object(C.a)(m,"RealtimeChannelMetrics",null,[970,313])},1780:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l extends Sys.EventArgs{constructor(e,a){super();this.type=e;this.HFa=a}}Object(C.a)(l,
"PersistentStateUpdateEventArgs",Sys.EventArgs,[])},1781:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l extends Sys.EventArgs{constructor(e){super();this.fvd=e}}Object(C.a)(l,"PersistentStateClearedEventArgs",Sys.EventArgs,[])},1913:function(C,O,c){c.r(O);var l=c(0),e=c(44);class a{constructor(Ca,vb){this.l9=null;this.Jtc=Ca;this.gSj=vb}init(){this.Jtc.continueWith(()=>{this.l9=this.Jtc.result;this.l9.BXb(Object(e.a)(this,this.m7,"onUsersUpdated"))})}m7(){a.iSe(this.l9.qYa())&&(this.l9.h4d(Object(e.a)(this,
this.m7,"onUsersUpdated")),this.gSj.IsRealCoauthSession=!0)}get clm(){return this.l9?a.iSe(this.l9.qYa()):!1}static iSe(Ca){let vb=null;for(const hc of Ca)if(hc)if(Ca=hc.isAnonymous||!hc.email?hc.clientId:hc.email.toUpperCase(),!vb)vb=Ca;else if(vb!==Ca)return!0;return!1}}Object(l.a)(a,"CoauthTelemetry",null,[724]);var h=c(8),m=c(433),v=c(64),u=c(2),n;(function(Ca){Ca[Ca.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Ca[Ca.notImplemented=1]="notImplemented";Ca[Ca.renderHandled=2]="renderHandled";
Ca[Ca.renderHandledWithVeto=3]="renderHandledWithVeto"})(n||(n={}));Object(l.b)("CoauthorGalleryTelemetryEndResult",n);var x=c(83),A=c(78),H=c(124);class E{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){this.TWg=this.Izg=this.yC=null;this.j4=Ca;this.Lmd=new m.a;this.Oa=hc;this.Wke=vb;this.o4=Nc;this.Qg=sd;this.ZCe=Id;this.n9a=We;this.Hxj=Fd;this.EIg=this.wIg=!1;this.cod=0;this.Gzg=1;this.Ynb=Ff;this.Bxc=this.Oa.$("PeoplesWellExtraButtonInfoIsEnabled");this.ppa=Object(v.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.Application)||
""}get C9i(){return this.Lmd.task}init(){H.Task.WAA.call(null,this.n9a,this.Wke,this.ZCe).continueWith(()=>{this.yC=this.n9a.result;this.Izg=this.Wke.result;this.TWg=this.ZCe.result;H.Task.WAA.call(null,this.Wke.result.AZb,this.ZCe.result.hcj).continueWith(()=>{this.Gzg=this.Izg.AZb.result;this.cod=this.TWg.hcj.result;this.yC.BXb(Object(e.a)(this,this.hZd,"onUsersUpdatedEventListener"));this.yC.qYa().length&&this.m7()})})}hZd(){this.m7()}m7(){this.Hxj(this.yC.qYa())?(this.yC.h4d(Object(e.a)(this,
this.hZd,"onUsersUpdatedEventListener")),this.DUm(this.wIg)):this.Lmd.GU(1);this.wIg=!0}DUm(Ca){this.EIg?this.C9i.continueWith(()=>{h.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",n[this.C9i.result])}):(this.EIg=!0,this.xcn(0===this.Gzg&&!Ca))}xcn(Ca){Ca?this.o4.Gl(4,Object(e.a)(this,this.AHf,"onInteractiveReady")):this.Lmd.GU(1)}AHf(){const Ca=this.Qg.CF("AppInitStatus_interactivityReady");h.ULS.shipAssertTag(42259235,325,!!this.cod);const vb=this.cod-
Ca,hc={};hc.InteractiveTime=Ca;hc.ReactRenderComplete=this.cod;hc.HadTabSwitch=this.Ynb();hc.IsModernGallery=this.Bxc;h.ULS.sendTraceTag(594883104,325,50,A.a.toJSON(hc));this.Bxc?(h.ULS.sendTraceTag(42062997,325,15,vb.toString()),this.Lmd.GU(this.Yso(vb)?3:2)):h.ULS.sendTraceTag(594883103,325,15,vb.toString())}Yso(Ca){const vb=Ca>this.Oa.rc("CoauthorGalleryTimeToRenderDurationMs",1E4),hc="Word"===this.ppa;if(this.Ynb())return h.ULS.sendTraceTag(50455714,325,50,vb.toString()),!1;hc&&x.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",
0,"wordcollabrel",null);vb&&(hc&&x.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),h.ULS.sendTraceTag(42062998,325,15,Ca.toString()));return vb}}Object(l.a)(E,"CoauthorGalleryTelemetry",null,[723]);class L{constructor(Ca){this.yC=null;this.e8c={};this.Iid={};this.upc=null;this.n9a=Ca}KHd(Ca){const vb=new m.a;this.init().continueWith(()=>{Ca in this.e8c?vb.GU(this.e8c[Ca]):this.Iid[Ca]=vb});return vb.task}init(){if(this.upc)return this.upc.task;
this.upc=new m.a;this.n9a.continueWith(()=>{this.yC=this.n9a.result;this.yC.BXb(Object(e.a)(this,this.m7,"onUsersUpdated"));this.Kjj();this.upc.Eg(null)});return this.upc.task}Kjj(){const Ca=this.yC.qYa();Ca.sort(Object(e.a)(this,this.vDk,"comparePresenceUsers"));this.e8c={};for(let vb=0;vb<Ca.length&&Ca[vb]&&Ca[vb].vNa;vb++)this.E5j(this.e8c,Ca[vb].clientId,vb)}E5j(Ca,vb,hc){Ca[vb]=hc;vb in this.Iid&&(this.Iid[vb].GU(hc),delete this.Iid[vb])}m7(){this.Kjj()}vDk(Ca,vb){return Ca.vNa>vb.vNa?1:Ca.vNa<
vb.vNa?-1:0}}Object(l.a)(L,"CoauthorPositionFinder",null,[722]);var M=c(77),F=c(199);class J{constructor(Ca,vb,hc,Nc){this.l9=null;this.toe=this.Vze=!1;this.GPg=0;this.Jtc=Ca;this.xJe=vb;this.Oa=hc;this.bTb=Nc;this.axj=u.AFrameworkApplication.Whc||u.AFrameworkApplication.Wma}get xyd(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.Jtc.continueWith(()=>{this.l9=this.Jtc.result;this.l9.BXb(Object(e.a)(this,this.m7,"onUsersUpdated"))})}m7(){this.PAk(this.l9.qYa());
!this.Vze||this.xyd&&!this.toe||this.l9.h4d(Object(e.a)(this,this.m7,"onUsersUpdated"))}PAk(Ca){const vb=new M.a;let hc=0;for(const Nc of Ca)if(Nc&&Nc.isAnonymous){u.AFrameworkApplication.Ne("70eb6120;2gfeb930");if(this.xyd&&!this.toe)if(vb.contains(Nc.userName)){const sd=this.KOl(Ca);h.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected among {0} total guest coauthors",sd);this.toe=!0}else vb.add(Nc.userName);Nc.clientId!==this.bTb&&(hc++,2<=hc&&!this.Vze&&this.sBm())}this.xyd&&
this.GPg!==hc&&(h.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",hc+(this.axj?1:0)),this.GPg=hc)}sBm(){h.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.Vze=!0;this.xyd&&this.xJe&&this.xJe.continueWith(()=>{window.setTimeout(()=>{this.xJe.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}KOl(Ca){return F.a.lf(Ca)?0:F.a.Hag(Ca,vb=>vb.isAnonymous).length}}Object(l.a)(J,"GuestCoauthTelemetry",null,[]);var I=c(243);class K{constructor(){this.id=
null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(l.a)(K,"PL",null,[]);var N=c(36);class G{constructor(){this.ct=this.vt=this.d=0}static PYi(Ca,vb,hc){const Nc=new G;Nc.d=Ca;Nc.vt=vb;Nc.ct=hc;return N.c(Nc)}}Object(l.a)(G,"VD",null,[]);var P=c(160);class S{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){this.N0g=!1;this._id=Ca;this.Gi=vb;this.Gr=hc;this.Wze=Nc;this.lKe=sd;this.Vub=Id;this.Qob=We;this.kAj=Fd;this.Ynb=Ff;this.ppa=Object(v.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.Application)||
""}cee(Ca){H.Task.WAA(this.Wze,this.lKe).continueWith(()=>{if(this.Wze.result<=this.lKe.result)Ca.GU(!1);else{var vb=this.Gr-this.Gi,hc=new K;hc.id=this._id;hc.et=this.Gr;hc.st=this.Gi;hc.d=this.Gr-this.Gi;hc.mp=this.Wze.result;hc.tp=this.lKe.result;hc.ct=this.qnl(this.kAj);hc.vc=this.Ynb();var Nc=N.c(hc),sd="Word"===this.ppa;h.ULS.sendTraceTag(42078597,302,15,Nc);if(sd){const Id=new Map;Id.set("data",Nc);x.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Id)}vb>this.Vub.value&&
!this.N0g&&!hc.vc&&(this.N0g=!0,Ca.GU(!0),hc=Object.assign(new P.a,{inStaging:!0,extendedProperties:new Map}),hc.extendedProperties.set("data",Nc),sd&&x.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,hc),vb<this.Qob.value&&h.ULS.sendTraceTag(42078598,302,15,G.PYi(vb,this.Vub.value,this.Qob.value)));Ca.task.isCompleted||Ca.GU(!1)}})}qnl(Ca){switch(Ca){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(l.a)(S,
"PresenceLatencyActivityLogger",null,[]);class W{constructor(Ca,vb,hc){this.zyg=this.Ezg=this.M7c=this.d8c=this.fOb=0;this._id=Ca;this.Vub=vb;this.Qob=hc;this.ppa=Object(v.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.Application)||""}get Sbh(){return this.fOb}set Sbh(Ca){this.fOb=Ca;this.HWe()}get oph(){return this.d8c}set oph(Ca){this.d8c=Ca;this.HWe()}get Hlh(){return this.M7c}set Hlh(Ca){this.M7c=Ca;this.HWe()}get pph(){return 0!==this.Ezg}get Ilh(){return 0!==this.zyg}HWe(){!this.pph&&
this.fOb&&this.d8c&&(this.Ezg=this.cee(this.d8c,"CoauthGalleryLightupDurationTooLong"));!this.Ilh&&this.fOb&&this.M7c&&(this.zyg=this.cee(this.M7c,"CanvasPresenceLightupDurationTooLong"))}cee(Ca,vb){const hc=Ca-this.fOb;var Nc=new K;Nc.id=this._id;Nc.et=Ca;Nc.st=this.fOb;Nc.d=hc;var sd=N.c(Nc);Ca="Word"===this.ppa;Nc="CanvasPresenceLightupDurationTooLong"===vb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===vb?h.ULS.sendTraceTag(572289499,302,
15,sd):h.ULS.sendTraceTag(571524118,302,15,sd);if(Ca){var Id=new Map;Id.set("data",sd);x.Health.instance.recordKpiUsage(Nc,0,"wordcollabrel",Id)}return hc>this.Vub.value?(Id=Object.assign(new P.a,{inStaging:!0,extendedProperties:new Map}),Id.extendedProperties.set("data",sd),sd=hc<this.Qob.value,Id.extendedProperties.set("cash",sd?"true":"false"),Ca&&x.Health.instance.recordKpiFailure(Nc,vb,!1,!0,Id),h.ULS.sendTraceTag(572289500,302,15,G.PYi(hc,this.Vub.value,this.Qob.value)),sd?2:1):3}}Object(l.a)(W,
"PresenceLightupLatencyLogger",null,[]);var X=c(39),Y=c(157);class ca{constructor(Ca,vb,hc,Nc,sd,Id,We=null,Fd=null,Ff=null){this.WXg={};this.Vke={};this.oOg=new M.a;this.vpc=this.yC=this.ij=null;this.D2g=this.C2g=0;this.Vub=new I.a(()=>We.cQ("PresenceBootLatencyThreshold",1E4));this.Qob=new I.a(()=>We.cQ("PresenceBootLatencyCutoffThreshold",6E4));this.p0j=new I.a(()=>We.cQ("PresenceLightupLatencyThreshold",2E3));this.hCj=new I.a(()=>We.cQ("PresenceLightupLatencyCutoffThreshold",1E4));this.nSj=Nc;
this.Hzg=Ca;this.w_g=vb;this.n9a=hc;this.Qg=sd;this.bTb=Fd;this.Ynb=Id;this.zh=Ff;this.vxg=!1;this.init()}qFc(Ca,vb,hc=null,Nc=0){hc&&(h.ULS.shipAssertTag(42274970,302,!this.bTb||this.bTb===hc,"_myClientId is already set and you are trying to update it to something different"),this.bTb=hc);const sd=new m.a;this.init().continueWith(()=>{this.ZXm(Ca);this.G3k(sd,Ca,vb,Nc)})}get dui(){return this.bTb||"{"+u.AFrameworkApplication.userSessionId+"}"}init(){if(this.vpc)return this.vpc.task;this.vpc=new m.a;
this.Ynb()&&h.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.Hzg.continueWith(()=>{const Ca=this.Hzg.result,vb=Ca.AZb,hc=Ca.DLm;hc.continueWith(()=>{vb.continueWith(()=>{this.zh&&this.zh.addQosPillar("RealTimeCoauth");this.d3f(vb.result,hc.result);this.vpc.Eg(null)})})});this.w_g.continueWith(()=>{this.ij=this.w_g.result;this.ij.wza(Object(e.a)(this,this.cZm,"onRtcConnection"));this.ij.B5(Object(e.a)(this,this.CSm,"onCoauthorBootReceived"))});this.n9a.continueWith(()=>{this.yC=this.n9a.result;
this.yC.BXb(Object(e.a)(this,this.hZd,"onUsersUpdatedEventListener"));0<this.yC.qYa().length&&this.m7()});return this.vpc.task}hPh(){return this.Qg.Vda(X.a.L4a)?this.Qg.CF(X.a.L4a):Y.a.Lab?window.performance.timing.fetchStart:-1}cZm(Ca,vb){this.vxg||2!==vb.newState||(Ca=Date.now()-this.hPh(),vb={},vb.clientId=this.dui,vb.bootTime=Ca,this.vxg=!0,this.ij.rO(15,vb))}CSm(Ca,vb){if(15===vb.type){Ca=Date.now();vb=vb.BM;var hc=vb.bootTime;this.Gff(vb.clientId).Sbh=Ca-hc}}hZd(){this.m7()}m7(){const Ca=Date.now();
var vb=this.yC.qYa();const hc=new M.a;for(const Nc of vb)this.oOg.contains(Nc.clientId)||(this.oOg.add(Nc.clientId),hc.add(Nc.clientId));if(0<hc.count)for(let Nc of hc)vb=this.Gff(Nc),vb.pph||(vb.oph=Ca)}ZXm(Ca){Ca=this.Gff(Ca);Ca.Ilh||(Ca.Hlh=Date.now())}Gff(Ca){return Ca in this.Vke?this.Vke[Ca]:this.Vke[Ca]=new W(Ca,this.p0j,this.hCj)}d3f(Ca,vb=0){this.C2g=Ca;this.D2g=vb?vb:(new Date).getTime()}G3k(Ca,vb,hc,Nc){hc=hc?hc.getTime():(new Date).getTime();vb in this.WXg?Ca.Bha():(Nc=new S(vb,this.FLl(),
hc,this.KHd(this.dui),this.KHd(vb),this.Vub,this.Qob,Nc,this.Ynb),this.WXg[vb]=Nc,Nc.cee(Ca))}FLl(){return 1===this.C2g?this.D2g:this.hPh()}KHd(Ca){return this.nSj.KHd(Ca)}}Object(l.a)(ca,"PresenceBootTelemetry",null,[721]);var ha=c(122),ra=c(179),sa=c(203),oa=c(23),ka=c(742);class ia{get name(){return"Common.App.CoauthTelemetry"}zc(Ca){Ca.register(a,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").singleInstance().Zd(()=>new a(ka.a.Lq(Ca.$a("Common.IPeopleInfoProvider")),
u.AFrameworkApplication.kh));Ca.register(E,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").singleInstance().Zd(()=>new E(u.AFrameworkApplication.ya,ka.a.Lq(Ca.$a("Common.ICoauthoringTelemeryInfoProvider")),u.AFrameworkApplication.K,ha.a.get_instance(),sa.a.instance,ka.a.Lq(Ca.$a("Common.IPeoplesWell")),ka.a.Lq(Ca.$a("Common.IPeopleInfoProvider")),a.iSe,()=>this.vih()));Ca.register(ca,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").singleInstance().Zd(()=>
new ca(ka.a.Lq(Ca.$a("Common.ICoauthoringTelemeryInfoProvider")),ka.a.Lq(Ca.$a("Common.IRealtimeChannelBasic")),ka.a.Lq(Ca.$a("Common.IPeopleInfoProvider")),Ca.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),sa.a.instance,()=>this.vih(),u.AFrameworkApplication.K,null,x.Health.instance));Ca.register(L,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").singleInstance().Zd(()=>new L(ka.a.Lq(Ca.$a("Common.IPeopleInfoProvider"))));
Ca.register(J,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").singleInstance().Zd(()=>new J(ka.a.Lq(Ca.$a("Common.IPeopleInfoProvider")),ka.a.Lq(Ca.$a("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.K,"{"+u.AFrameworkApplication.userSessionId+"}"))}init(){u.AFrameworkApplication.K.gq(()=>{oa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();oa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();u.AFrameworkApplication.K.$("CoauthorGalleryTelemetryIsEnabled")&&
oa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();u.AFrameworkApplication.K.$("CashTelemetryIsEnabled")&&(oa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),oa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}vih(){return Y.a.Lab&&sa.a.instance.Vda(X.a.w4c)?0<sa.a.instance.CF(X.a.w4c)[X.a.Amj]:!1}static main(){ra.a.instance.Pc(new ia)}}Object(l.a)(ia,"CoauthTelemetryPackage",null,[1,2]);class La extends Sys.EventArgs{constructor(){super()}}
Object(l.a)(La,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var va;(function(Ca){Ca[Ca.notYetStarted=0]="notYetStarted";Ca[Ca.polling=1]="polling";Ca[Ca.subscribed=2]="subscribed";Ca[Ca.blocked=3]="blocked";Ca[Ca.permanentlyStopped=4]="permanentlyStopped"})(va||(va={}));Object(l.b)("RtcHostNotificationSubscriptionState",va);var Ga=c(80),Oa=c(1372),Za=c(70);class ja{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){this.Ih=!1;this.t9=this.lUb=this.mda=this.qUa=null;this.qwc=ja.Tge;this.sa=new Za.a;this.i$a=
new Oa.a(0);this.i$a.WPe(Object(e.a)(this,this.g_m,"onStateMachineChanged"));this.TUj=Ca;this.Tkd=vb;this.SUj=hc;this.SFe=Nc;this.Hb=sd;this.pf=Id;We.execute(Ac=>{this.Ih||(this.lUb=Ac,this.lUb.B5(Object(e.a)(this,this.Vaa,"onUpdateNotificationReceived")),this.start())});Fd.execute(Ac=>{this.Ih||(this.t9=Ac,Ac.JVa(Object(e.a)(this,this.iga,"onTokenRefreshed")))});this.bod=Ff}get Rfc(){return this.i$a.currentState}get vii(){return!this.pf||this.pf.zua}get Rii(){return 2===this.Rfc&&this.bod()<this.qwc}start(){0!==
this.Rfc?h.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",va[this.Rfc]):(this.i$a.event(1),this.zXf(null))}zXf(){this.qUa=null;if(this.vii){h.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",va[this.Rfc]);let Ca=null;this.SFe&&this.SFe.length&&(Ca={},Ca.etts=this.SFe);this.lUb.rO(14,Ca,!0);this.HWi(this.TUj)}else this.i$a.event(3)}HWi(Ca){this.qUa=Ga.a.j$(1E3*Ca,Object(e.a)(this,this.zXf,"sendSubscribeEvent"),
this.Tkd,192,"RtcHostNotificationSubscribe");this.Hb.fc(this.qUa)}gFn(Ca){Ca=1E3*(Ca+this.SUj);const vb=this.bod().getTime()+Ca;this.qwc=new Date(vb);Ca-=this.Tkd;this.mda?this.Hb.A3(this.mda,Ca):(this.mda=Ga.a.j$(Ca,Object(e.a)(this,this.ido,"transitionToPollingEvent"),this.Tkd/2,194,"RtcHostNotificationTransitionToPolling"),this.Hb.fc(this.mda))}ido(){this.mda=null;2===this.Rfc&&(this.i$a.event(1),h.ULS.shipAssertTag(573100185,502,!!this.qUa,"Missing task to ensure that we re-subscribe."))}iga(){this.OTl()}OTl(){3===
this.Rfc&&this.vii&&(this.i$a.event(this.Rii?2:1),this.zXf(null))}Vaa(Ca,vb){if(13===vb.type&&(Ca=vb.BM,h.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",{["SerializableHostNotificationSubscription"]:Ca,["DurationBeforeExpirationToResubscribeInSec"]:this.Tkd}),vb=Ca.cts,!this.Ffo(vb))){if(Ca.sb){var hc=2;this.gFn(Ca.cts)}else hc=1,this.qwc=ja.Tge,this.mda&&(this.Hb.Ye(this.mda),this.mda=null);this.i$a.event(hc);this.qUa?this.Hb.A3(this.qUa,1E3*vb):this.HWi(vb)}}Ffo(Ca){if(!isNaN(Ca)&&
isFinite(Ca)&&0<Ca)return!1;this.Q9i(!1);return!0}Q9i(Ca){this.qUa&&(this.Hb.Ye(this.qUa),this.qUa=null);this.mda&&(this.Hb.Ye(this.mda),this.mda=null);this.lUb&&(this.lUb.Ccc(Object(e.a)(this,this.Vaa,"onUpdateNotificationReceived")),this.lUb=null);this.t9&&(this.t9.ZIb(Object(e.a)(this,this.iga,"onTokenRefreshed")),this.t9=null);Ca||this.i$a.event(4)}g_m(Ca,vb){Ca=vb.newState;const hc=vb.uNf,Nc={};Nc.NewState=va[Ca];Nc.PreviousState=va[hc];Nc.PreviousStateHits=vb.vNf;Nc.PreviousStateTransitionTime=
vb.wNf.toISOString();Nc.IsSubscribed=this.Rii;this.qwc!==ja.Tge&&(Nc.SubscriptionExpiringTime=this.qwc.toISOString());h.ULS.sendTraceTag(572346515,502,4===Ca?15:50,"HostNotificationChanged: {0}",Nc);this.sa.raiseEvent("HN",new La(hc,Ca))}dispose(){this.Ih||(this.Ih=!0,this.Q9i(!0),this.mda&&(this.Hb.Ye(this.mda),this.mda=null))}}ja.Tge=new Date(0);Object(l.a)(ja,"RtcHostNotificationSubscriptionManager",null,[720,10]);var ba=c(389);class qa{constructor(){this.Ah=this.Ih=!1}get name(){return"RtcHostNotificationSubscription"}zc(Ca){Ca.register(ja,
"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").singleInstance().Zd(()=>{const vb=u.AFrameworkApplication.K;return new ja(vb.rc("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),vb.rc("RtcHostNotificationRetryIntervalBufferInSeconds",120),vb.rc("RtcHostNotificationSubscriptionLostBufferInSeconds",60),this.uJl(vb),u.AFrameworkApplication.uc,ba.SessionStatusManager.instance,
Ca.$a("Common.IRealtimeChannelBasic"),Ca.$a("Common.ISessionExpirationManager"),()=>new Date)})}init(){u.AFrameworkApplication.K.gq(()=>{!this.Ih&&u.AFrameworkApplication.K.$("RtcHostNotificationEnabled")&&(this.Ah=!0,oa.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})}dispose(){this.Ih||(this.Ih=!0,this.Ah&&oa.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())}uJl(Ca){return Ca.Hv("RtcEventTypesToSubscribe")?
Ca.NB("RtcEventTypesToSubscribe"):null}static main(){ra.a.instance.Pc(new qa)}}Object(l.a)(qa,"RtcHostNotificationSubscriptionPackage",null,[1,2]);var Ma=c(498),Ia=c(651);class wa{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi){this.clientId=Ca;this.SkypeChatThreadId=hc;this.chatThreadDiscoveryUri=Nc;this.inChat=sd;this.localColbaltSessionId=vb;this.capabilities=Id;this.email=We;this.isReadOnly=Fd;this.userName=Ff;this.isAnonymous=Ac;this.presenceStatus=Qi}}Object(l.a)(wa,"SerializablePresenceUserData",
null,[]);class za extends Ma.a{constructor(Ca,vb,hc,Nc,sd=null,Id=null,We=null,Fd=null,Ff=null,Ac=!1,Qi=!1,Tc=!1,uj=null){super(Ca,vb,hc,Nc,Id,We,Fd,Ff,Ac,Qi,Tc);this.zQ=sd;this.presenceStatus=uj}getData(){return new wa(this.clientId,this.zQ,this.KAc,this.chatThreadDiscoveryUri,this.inChat,this.capabilities.capabilities,this.email,this.isReadOnly,this.userName,this.isAnonymous,this.presenceStatus)}LHd(Ca){return(Ca=Ca.value)?Ca.user:null}clone(){return new za(this.clientId,this.userName,this.color,
this.capabilities.clone(),this.zQ,this.KAc,this.email,this.client,this.chatThreadDiscoveryUri,this.isAnonymous,this.inChat,this.isReadOnly,this.presenceStatus)}static Mxb(Ca){return Ca.clientId?new za(Ca.clientId,Ca.userName,null,new Ia.a(void 0===Ca.capabilities?0:Ca.capabilities),Ca.localColbaltSessionId,Ca.SkypeChatThreadId,Ca.email,null,Ca.chatThreadDiscoveryUri,Ca.isAnonymous,Ca.inChat,Ca.isReadOnly,Ca.presenceStatus):null}static cvh(Ca,vb,hc,Nc=null,sd=null,Id=null,We=null,Fd=null,Ff=!1,Ac=
!1,Qi=!1,Tc=null){return Ca?new za(Ca,vb,null,new Ia.a(void 0===hc?0:hc),Nc,sd,Id,We,Fd,Qi,Ff,Ac,Tc):null}}Object(l.a)(za,"PresenceUser",Ma.a,[1214,1215,26]);class pa extends za{constructor(){super();this.sbc=this.Cxf=null}EBl(){const Ca=u.AFrameworkApplication.userName,vb=u.AFrameworkApplication.K.lb("UserPrincipalName"),hc=this.Cxf?this.Cxf.zQ:null,Nc=u.AFrameworkApplication.Whc||u.AFrameworkApplication.Wma,sd=this.sbc?this.sbc.getStatus():null;return new za(this.clientId,Ca,this.color,this.capabilities,
hc,this.KAc,vb,this.client,this.chatThreadDiscoveryUri,Nc,this.inChat,this.isReadOnly,sd)}}Object(l.a)(pa,"MyPresenceUser",za,[1266,26]);var Ba=c(222);class Ra{constructor(Ca,vb,hc,Nc,sd){this.Nd=Ca;this._clientId=vb;this.jDj=sd;this.bHj=hc||(()=>null);this.cHj=Nc||(()=>null)}get id(){return this.Nd.id}get bqd(){return this.Nd.bqd}get fqd(){return this.Nd.fqd}get eqd(){return this.Nd.eqd}get dqd(){return this.Nd.dqd}get cqd(){return this.Nd.cqd}get hqd(){return this.Nd.hqd}get HNe(){return this.Nd.HNe}get sfc(){return this.Nd.sfc}get G9d(){return this.Nd.G9d}get RVd(){return this.Nd.RVd}get clientId(){return this._clientId}get dKc(){return this.bHj}get Ceb(){return this.cHj}get xZk(){return this.jDj}static createInstance(Ca,
vb,hc,Nc,sd=!1){return new Ra(Ca,vb,hc,Nc,sd)}}Object(l.a)(Ra,"PeoplesWellSettings",null,[]);var fb=c(9),Va=c(57),ib=c(155),Xa=c(82),qb=c(213),rb=c(236),nb=c(443),Tb=c(358);class Zb extends qb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(l.a)(Zb,"PeopleButtonProps",qb.a,[]);var Hb=c(393),Sa=c(348),ua=c(17),Fa=c(121),Pa=c(374),Ea=c(86);class lb{constructor(Ca){this.x4c=new Ea.a;
this.m2e=null;this.clientId=Ca}sSn(Ca){this.arn();this.XKn(Ca);for(const vb of Ca)vb.clientId!==this.clientId&&this.P$g(vb)}get A$f(){const Ca=[];for(let vb of this.x4c.values){const hc=this.FXi(vb);Array.add(Ca,hc)}return Ca}get hib(){return this.x4c.count}uPe(Ca,vb){Ca=Ca.toUpperCase();let hc;({value:hc}=this.x4c.Bc(Ca)).returnValue||(hc=[],this.x4c.Z(Ca,hc));Array.add(hc,vb)}arn(){this.x4c=new Ea.a}XKn(Ca){for(const vb of Ca)if(vb.clientId===this.clientId){this.m2e=vb;break}}}Object(l.a)(lb,"UserTracker",
null,[1084]);class zb extends lb{constructor(Ca,vb){super(Ca);this.dHj=vb}P$g(Ca){Ca.isAnonymous||!Ca.email?this.uPe(Ca.clientId,Ca):this.m2e&&Pa.a.Sj().equals(this.m2e.email,Ca.email)||this.uPe(Ca.email,Ca)}FXi(Ca){let vb=new Date(0),hc=0<Ca.length?Ca[0]:null;for(const Nc of Ca)(Ca=this.dHj(Nc.clientId))&&vb.getTime()<Ca.R8b.getTime()&&(vb=Ca.R8b,hc=Nc);return hc}}Object(l.a)(zb,"UniqueUserTracker",lb,[]);class Xb extends lb{constructor(Ca){super(Ca)}P$g(Ca){this.uPe(Ca.clientId,Ca)}FXi(Ca){return Ca[0]}}
Object(l.a)(Xb,"UserInstanceTracker",lb,[]);const ub=(Ca,vb,hc)=>hc?new zb(Ca,vb):new Xb(Ca);var Pb=c(62),yc=c(616),bc=c(13);class Ka{constructor(Ca,vb=null,hc=null){this.yC=null;this.uKe=new m.a;this.Nd=Ca;this.Q_d=vb;hc&&hc.continueWith(()=>{this.yC=hc.result;this.yC.BXb(Object(e.a)(this,this.m7,"onUsersUpdated"));this.s3d()});new Ma.a(this.settings.clientId,"Anonymous user","#cccccc",new Ia.a(7));this.ZOd=this.iwe=!0;this.Tre=this.YCe=!1;this.Owa=ub(this.settings.clientId,this.settings.Ceb,Ca.xZk)}get settings(){return this.Nd}get Qbm(){return u.AFrameworkApplication.K?
u.AFrameworkApplication.K.$("ColorPresenceHashIsEnabled"):!1}get ici(){return u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"):!1}mpl(){let Ca;let vb,hc,Nc,sd;var Id=this.npl();this.Owa.hib?1===this.Owa.hib?(vb=!0,hc=this.settings.sfc.cluster,Nc=this.settings.sfc.kyd,sd=this.Owa.A$f[0].color):(vb=!0,hc=this.settings.RVd.cluster,Nc=this.settings.RVd.kyd,sd=""):(vb=!1,sd=Nc=hc="");Ca=Id[0];Id=Id.slice(1);return{a2m:Ca,b2m:Id,W1m:vb,ALo:hc,Y1m:Nc,X1m:sd}}npl(){if(2<=
this.Owa.hib)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.Owa.hib)];if(1===this.Owa.hib){const Ca=this.Owa.A$f[0],vb=this.settings.Ceb(Ca.clientId);return vb&&2===vb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,Ca.userName]:[Ca.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,Ca.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}kQl(Ca){return this.lQl(Ca)}flh(Ca,
vb,hc){return vb?this.Lsk(vb)?(Ca=this.settings.Ceb(Ca))&&2===Ca.status?!1:!0:(hc&&h.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(hc&&h.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),!1)}LLl(Ca){return Ca.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}lQl(Ca){if(!Ca.capabilities.OBa(1))return this.LLl(Ca);const vb=Ca.isReadOnly,hc=this.settings.Ceb(Ca.clientId);
Ca=this.settings.dKc(Ca.clientId);if(!hc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(hc.status){case 1:return Ca?vb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.OHk(Ca)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}hxl(Ca){if(this.Q_d.iRd)return this.Q_d.H_b(Ca.email,
"O365",u.AFrameworkApplication.ym,0)}YPl(Ca){Ca=this.settings.Ceb(Ca.clientId);return!Ca||Ca&&1===Ca.status?!0:!1}$Pl(Ca){var vb=String.format("buttonPeoplesWellUser-{0}",Ca.clientId),hc=Ca.clientId,Nc=this.kQl(Ca);const sd=Ca.userName,Id=Ca.color;var We=Object,Fd=We.assign,Ff=new Zb,Ac=this.settings.hqd.toString(),Qi=this.settings.G9d.cluster,Tc=this.settings.G9d.kyd,uj=this.bRh(),oj=Ca.isAnonymous,ti;if(ti=[sd],ti.length){var Th=new Sys.StringBuilder("STRARRY@");for(const di of ti)Th.append(di?
di.length:0),Th.append(","),Th.append(di),Th.append(",");ti=Th.toString().slice(0,-1)}else ti=null;vb=Fd.call(We,Ff,{Id:vb,Command:Ac,LabelText:"{0}",Image32by32:Qi,Image32by32Class:Tc,MenuItemId:hc,CommandValueId:hc,Alt:sd,DisplayMode:uj,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:Nc,ImageBackColor:Id,IsAnonymous:oj,LabelTextUserGeneratedPlaceholderReplacements:ti,Upn:Ca.email});u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")&&
this.Q_d&&(hc=this.hxl(Ca),Nc=this.YPl(Ca),vb.ImageUrl=hc,vb.ActiveStatus=Nc,vb.JoinTimeInMS=Ca.vNa,Ca=this.flh(Ca.clientId,this.settings.dKc(Ca.clientId),!1),vb.CanJump=Ca,""===hc&&h.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));return vb}vvl(){return Object.assign(new qb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}bRh(){return this.Qbm?"Initials":
"Menu32"}aQl(Ca){const vb=[];for(const hc of Ca)Ca=this.$Pl(hc),Array.add(vb,Ca);return vb}yOd(){return 0<this.Owa.hib}Jfn(Ca){if(!this.iwe)return!0;this.ZOd||(Ca[yc.a.Visible]=!0);let vb,hc,Nc,sd,Id;({a2m:vb,b2m:hc,W1m:Nc,Y1m:sd,X1m:Id}=this.mpl());Ca[yc.a.LabelText]=vb;hc&&hc.length&&(Ca[yc.a.LabelTextUserGeneratedPlaceholderReplacements]=hc);Ca[yc.a.ImageIsVisible]=Nc;Ca[yc.a.Image16by16Class]=sd;Ca[yc.a.ImageBackColor]=Id;this.iwe=!1;return!0}m8m(Ca){if(0>=this.Owa.hib)return!1;var vb=this.i2n(this.Owa.A$f),
hc=this.aQl(vb);vb=Object.assign(new nb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});hc=Object.assign(new Tb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.bRh(),ControlList:hc});u.AFrameworkApplication.K.$("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.Q_d&&(hc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,hc.TitleId="menuCoauthorsTitle",hc.Theme="Light");Array.add(vb.MenuSectionList,hc);u.AFrameworkApplication.K.$("DocChatIsEnabled")&&u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")&&
u.AFrameworkApplication.ta&&u.AFrameworkApplication.ta.Rb.hq&&(hc=[],Array.add(hc,this.vvl()),hc=Object.assign(new Tb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:hc}),Array.add(vb.MenuSectionList,hc));u.AFrameworkApplication.ta&&u.AFrameworkApplication.ta.Rb.hq?Ca.MenuItems=vb:Ca.PopulationXML=rb.q(vb);return!0}y$f(Ca){h.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");Ca=Ca.MenuItemId;if(!Ca)return!1;const vb=this.settings.dKc(Ca);if(!this.flh(Ca,vb,
!0))return!1;this.Fqm(vb);return!0}Xln(){const Ca=this.Cjl();this.Owa.sSn(Ca);this.ZOd&&1<=this.Owa.hib&&(h.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.ZOd=!1);this.iwe=!0}m7(){this.Tre||(window.setTimeout(()=>{this.s3d();this.Tre=!1},3E3),this.Tre=!0)}Cjl(){let Ca;Ca=this.Bjl()||[];for(const vb of Ca)this.IDn(vb);return Ca}IDn(Ca){Ca.clientId||(Ca.clientId=Fa.a.create().toString());Ca.userName||(Ca.userName="Anonymous user");Ca.capabilities||(Ca.capabilities=
new Ia.a);Ca.color||(Ca.color="#cccccc");Ca.vNa||(Ca.vNa=0)}i2n(Ca){const vb=[];Array.addRange(vb,Ca);vb.sort(Ka.K1m);return vb}fpn(){u.AFrameworkApplication.K.$("CoauthorGalleryTelemetryIsEnabled")&&!this.YCe&&(u.AFrameworkApplication.ya.p6(bc.a.Aph)&&Hb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||u.AFrameworkApplication.ya.gb(bc.a.Aph,Pb.a.frame,Object(e.a)(this,this.DSm,"onCoauthorGalleryFirstRender"),96));this.gpn();this.YCe=
!0;this.s3d()}DSm(Ca,vb,hc,Nc,sd){this.uKe.GU(sd.RenderTime);return 32}get hcj(){return this.uKe.task}s3d(){if(!this.YCe&&(this.uKe.GU((new Date).getTime()),h.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.ici))return;this.Xln();this.ici&&this.ZOd?u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||Sa.a.w$b("ribbon","coauthorGallery"):
(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(Sa.a.Xua("ribbon","coauthorGallery"),Sa.a.c1a("ribbon","coauthorGallery")),this.Yln())}dispose(){this.yC&&(this.yC.h4d(Object(e.a)(this,this.m7,"onUsersUpdated")),this.yC=null)}static K1m(Ca,vb){return Ca.capabilities.OBa(1)&&vb.capabilities.OBa(1)||!Ca.capabilities.OBa(1)&&!vb.capabilities.OBa(1)?ua.a.localeCompare(Ca.userName,vb.userName):Ca.capabilities.OBa(1)?
-1:1}}Object(l.a)(Ka,"APeoplesWell",null,[1006,10]);var Bb=c(14);class tb extends Ka{constructor(Ca,vb,hc=null,Nc=null){super(Ca,hc,Nc);this.qSa=()=>!0;this.ga=vb}Lfn(Ca){return this.Jfn(Ca)}o8m(Ca){return this.m8m(Ca)}cro(Ca){return this.y$f(Ca)}pZa(Ca,vb,hc,Nc,sd,Id){Ca=!1;switch(hc){case 1:Ca=sd(Nc);break;case 2:Ca=Id(Nc)}return tb.Pkk(Ca)}Fcm(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,()=>this.yOd(),this.qSa)}Kfn(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,Object(e.a)(this,this.Lfn,"queryUsersProxy"),
this.qSa)}n8m(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,this.qSa,Object(e.a)(this,this.o8m,"populateFlyoutContentsProxy"))}HBk(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,this.qSa,this.qSa)}GBk(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,this.qSa,this.qSa)}bro(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,this.qSa,Object(e.a)(this,this.cro,"userButtonClickProxy"))}n6m(Ca,vb,hc,Nc,sd){return this.pZa(Ca,vb,hc,sd,this.qSa,()=>{this.s3d();return!0})}gpn(){this.ga.pa(this.settings.bqd,Bb.a.application,
Object(e.a)(this,this.Fcm,"isControlEnabledHandler"));this.ga.gb(this.settings.fqd,Bb.a.application,Object(e.a)(this,this.Kfn,"queryUsersHandler"),96);this.ga.gb(this.settings.dqd,Bb.a.application,Object(e.a)(this,this.HBk,"commandMenuOpenHandler"),96);this.ga.gb(this.settings.cqd,Bb.a.application,Object(e.a)(this,this.GBk,"commandMenuCloseHandler"),96);this.ga.gb(this.settings.eqd,Bb.a.application,Object(e.a)(this,this.n8m,"populateFlyoutContentsHandler"),96);this.ga.pa(this.settings.hqd,Bb.a.application,
Object(e.a)(this,this.bro,"userButtonClickHandler"));this.ga.gb(this.settings.HNe,Bb.a.application,Object(e.a)(this,this.n6m,"peoplesWellRefreshControlHandler"),96)}static Pkk(Ca){return Ca?32:8}}Object(l.a)(tb,"ABox4PeoplesWell",Ka,[]);var Kb=c(3),Ib=c(53),Wa=c(11),vc=c(33),Lc=c(186);class Gb{static isSupported(Ca){for(let vb=0;vb<Gb.S$i.length;vb++)if(Ca===Gb.S$i[vb])return!0;return!1}}Gb.S$i=[1];Object(l.a)(Gb,"RTTDataVersion",null,[]);var pc=c(1562);const Fc=Ca=>{if("number"!==typeof Ca.RK||"number"!==
typeof Ca.DK)return!1;let vb,hc=!1,Nc=!1,sd=!1;switch(Ca.RK){case 0:Nc=vb=!0;break;case 1:sd=hc=Nc=vb=!0;break;case 2:if(null!=Ca.PE&&"number"!==typeof Ca.PE)return!1;vb=!0;break;case 4:vb=!0;break;case 3:Nc=vb=!0;break;case 5:hc=vb=!0;break;default:return!1}return vb&&("number"!==typeof Ca.PS||"number"!==typeof Ca.TS)||Nc&&("object"!==typeof Ca.OS||!Ca.OS||!pc.validateVersionedCpData(Ca.OS))||hc&&("number"!==typeof Ca.PE||"number"!==typeof Ca.TE)||sd&&("object"!==typeof Ca.OE||!Ca.OE||!pc.validateVersionedCpData(Ca.OE))?
!1:!0},ob=Ca=>{let vb="";if("number"!==typeof Ca.I)return{returnValue:!1,lfa:"Invalid PacketId Type"};if("number"!==typeof Ca.O)return{returnValue:!1,lfa:"Invalid Operation Type"};if("string"!==typeof Ca.A)return{returnValue:!1,lfa:"Invalid ClientId Type"};if("object"!==typeof Ca.AN)return{returnValue:!1,lfa:"Invalid Anchor Object Type"};if(!Ca.AN)return{returnValue:!1,lfa:"Null AnchorObject"};if(!Fc(Ca.AN)){let hc;try{hc=N.c(Ca.AN)}catch(Nc){hc=String.format("Failed to JSON-serialize payload : {0}",
Nc)}8E3<hc.length&&(hc=String.format("Payload exceeds maximum length: {0} > {1}, not logging",hc.length,8E3));vb="Invalid AnchorObject: "+hc+", Client: "+Ca.C;return{returnValue:!1,lfa:vb}}return!Ca.O&&Ca.AN.RK?(vb="Invalid RangeKind:"+Ca.AN.RK+" for Caret",{returnValue:!1,lfa:vb}):2===Ca.O&&("number"!==typeof Ca.TF||"undefined"!==typeof Ca.TX&&"string"!==typeof Ca.TX||1!==Ca.AN.RK&&Ca.AN.RK)?{returnValue:!1,lfa:"Invalid TypingData"}:3!==Ca.O||"object"===typeof Ca.AP&&Ca.AP&&"number"===typeof Ca.AP.TFA&&
"number"===typeof Ca.AP.PN&&"number"===typeof Ca.AP.TN&&2===Ca.AN.RK?6!==Ca.O||"object"===typeof Ca.MP&&Ca.MP&&"number"===typeof Ca.MP.PM&&"number"===typeof Ca.MP.TM&&5===Ca.AN.RK?4!==Ca.O||"object"===typeof Ca.SP&&Ca.SP&&"number"===typeof Ca.SP.PA&&"number"===typeof Ca.SP.TA&&"number"===typeof Ca.SP.PB&&"number"===typeof Ca.SP.TBS&&3===Ca.AN.RK&&(Ca.AN.PS===Ca.SP.PA||Ca.AN.PS===Ca.SP.PB)?7!==Ca.O||"object"===typeof Ca.SPS&&Ca.SPS&&"string"===typeof Ca.SPS.SF&&"boolean"===typeof Ca.SPS.SL?null!=Ca.ISS&&
"number"!==typeof Ca.ISS?{returnValue:!1,lfa:"invalid StrictlySequentialId"}:{returnValue:!0,lfa:vb}:{returnValue:!1,lfa:"Invalid SymbolData"}:{returnValue:!1,lfa:"Invalid SplitParaData"}:{returnValue:!1,lfa:"Invalid RemoveParaData"}:{returnValue:!1,lfa:"Invalid AddParaData"}};var Fb=c(1535);class gb{constructor(Ca,vb=null,hc=null){this.Q_=this.IKf=this.R5f=null;null!=Ca&&(this.R5f=Ca);null!=vb&&(this.IKf=vb);null!=hc&&(this.Q_=hc)}}Object(l.a)(gb,"AddParaData",null,[]);class Jb{constructor(Ca=null,
vb=null){this.wgc=this.HKf=null;null!=Ca&&(this.HKf=Ca);null!=vb&&(this.wgc=vb)}}Object(l.a)(Jb,"MergeRemoveParaData",null,[]);class Yb{constructor(Ca,vb,hc,Nc,sd,Id,We=null,Fd=null,Ff=null,Ac=null,Qi=null,Tc=null,uj=0,oj=null){this.P1c=this.text=this.WLb=this.oLb=this.dSc=this.lXb=this.Nha=null;this.packetId=Ca;this.client=hc;this.ft=Nc;this.clientId=vb.toLowerCase();this.xS=sd;this.version=uj;Id&&(this.Nha=Id);null!=We&&(this.WLb=We);void 0!==Fd&&null!==Fd&&(this.text=Fd);Ff&&(this.lXb=Ff);Ac&&
(this.dSc=Ac);Qi&&(this.oLb=Qi);Tc&&(this.P1c=Tc);this.strictlySequentialId=oj}}Object(l.a)(Yb,"RTTData",null,[]);class tc{constructor(Ca=null,vb=null,hc=null,Nc=null){this.Q5f=this.GKf=this.N5f=this.FKf=null;null!=Ca&&(this.FKf=Ca);null!=vb&&(this.N5f=vb);null!=hc&&(this.GKf=hc);null!=Nc&&(this.Q5f=Nc)}}Object(l.a)(tc,"SplitParaData",null,[]);class Ec{constructor(Ca=null,vb=null){this.r4f=this.q4f=null;Ca&&(this.q4f=Ca);null!=vb&&(this.r4f=vb)}}Object(l.a)(Ec,"SymbolData",null,[]);class Vc{constructor(Ca,
vb=null,hc=null){null!=Ca&&(this.TFA=Ca);null!=vb&&(this.PN=vb);null!=hc&&(this.TN=hc)}}Object(l.a)(Vc,"SerializableAddParaDataV1",null,[]);class Hd{constructor(Ca=null,vb=null){null!=Ca&&(this.PM=Ca);null!=vb&&(this.TM=vb)}}Object(l.a)(Hd,"SerializableMergeRemoveParaDataV1",null,[]);class qd{}Object(l.a)(qd,"SerializableRTTDataV1",null,[]);class me{constructor(Ca=null,vb=null,hc=null,Nc=null){null!=Ca&&(this.PA=Ca);null!=vb&&(this.TA=vb);null!=hc&&(this.PB=hc);null!=Nc&&(this.TBS=Nc)}}Object(l.a)(me,
"SerializableSplitParaDataV1",null,[]);class Zc{constructor(Ca=null,vb=null){Ca&&(this.SF=Ca);null!=vb&&(this.SL=vb)}}Object(l.a)(Zc,"SerializableSymbolDataV1",null,[]);const Dc=Ca=>{var vb;if(!({lfa:vb}=ob(Ca)).returnValue)return h.ULS.sendTraceTag(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",vb),null;let hc=vb=null,Nc=null,sd=null,Id=null,We=null,Fd=null,Ff=null;Ca.WD&&(vb=Ca.WD);null!=Ca.TF&&(hc=Ca.TF);void 0!==Ca.TX&&null!==Ca.TX&&(Nc=Ca.TX);Ca.AP&&(sd=new gb(Ca.AP.TFA,Ca.AP.PN,
Ca.AP.TN));Ca.MP&&(Id=new Jb(Ca.MP.PM,Ca.MP.TM));Ca.SP&&(We=new tc(Ca.SP.PA,Ca.SP.TA,Ca.SP.PB,Ca.SP.TBS));Ca.SPS&&(Fd=new Ec(Ca.SPS.SF,Ca.SPS.SL));null!=Ca.ISS&&(Ff=Ca.ISS);return new Yb(Ca.I,Ca.A,Ca.C,Ca.O,Fb.a(Ca.AN),vb,hc,Nc,sd,Id,We,Fd,1,Ff)},ud=Ca=>{let vb=Ca;if("number"===typeof vb.V){if(1===vb.V)return Dc(Ca);h.ULS.sendTraceTag(9188758,302,15,"Unsupported Version");return null}let hc=0,Nc=null;for(let sd=0;sd<Ca.length;sd++)vb=Ca[sd],Gb.isSupported(vb.V)&&vb.V>hc&&(hc=vb.V,Nc=Ca[sd]);return 1===
hc?Dc(Nc):null},Ce=Ca=>{if(Ca){const vb=new qd;vb.I=Ca.packetId;vb.V=1;vb.A=Ca.clientId;vb.C=Ca.client;vb.O=Ca.ft;vb.AN=Fb.c(Ca.xS);Ca.Nha&&(vb.WD=Ca.Nha);null!=Ca.WLb&&(vb.TF=Ca.WLb);void 0!==Ca.text&&null!==Ca.text&&0<Ca.text.length&&(vb.TX=Ca.text);Ca.lXb&&(vb.AP=new Vc(Ca.lXb.R5f,Ca.lXb.IKf,Ca.lXb.Q_));Ca.dSc&&(vb.MP=new Hd(Ca.dSc.HKf,Ca.dSc.wgc));Ca.oLb&&(vb.SP=new me(Ca.oLb.FKf,Ca.oLb.N5f,Ca.oLb.GKf,Ca.oLb.Q5f));Ca.P1c&&(vb.SPS=new Zc(Ca.P1c.q4f,Ca.P1c.r4f));vb.ISS=Ca.strictlySequentialId;Ca=
vb}else Ca=null;return Ca};var ee=c(59);class Uf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){this.LocalCobaltSessionId=Ca;this.SkypeChatThreadId=vb;this.ChatThreadDiscoveryUri=hc;this.InChat=Nc;this.Capabilities=sd;this.Email=Id;this.UserName=We;this.IsAnonymous=Fd;this.PresenceStatus=Ff}}Object(l.a)(Uf,"SerializableWacData",null,[]);class te{constructor(){this.Dmd=this.Cmd=0}nCl(){this.Dmd===Number.MAX_VALUE&&(this.Dmd=0);this.Dmd++;return this.Dmd}mCl(){this.Cmd===Number.MAX_VALUE&&(this.Cmd=0);this.Cmd++;
return this.Cmd}static get instance(){return te.CXj}}te.CXj=new te;Object(l.a)(te,"StrictlySequentialIdGenerator",null,[727]);var Fe=c(1477);class Qf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd=0){this.Jqa=null;this.dryDeletion=0;this.TH=Ca;this.rIa=Id;this.ud=sd;this.evb=We;this.Nc=vb;this.shapeId=Fd;this.LDa=hc;this.v7=We.create(this,Nc,sd,Id)}clone(){return new Qf(this.TH,this.Nc,this.LDa,this.v7.tNb,this.ud,this.rIa,this.evb,this.shapeId)}get paragraphId(){return this.Jqa?this.Jqa:this.TH.keb(this.Nc)}vIf(){this.Jqa||
(this.Jqa=this.paragraphId,this.v7.vIf())}Sd(){return 0<=this.v7.cp}getData(){const Ca=this.v7.tNb;return Ca?new Fe.a(0,this.Nc,this.LDa,Ca,null,null,null,0,this.shapeId):null}static Mxb(Ca,vb,hc,Nc,sd){return vb?new Qf(vb,parseInt(Ca.COa),Ca.$3a,Ca.JQ,hc,Nc,sd,Ca.shapeId):null}}Object(l.a)(Qf,"WordPresenceIp",null,[715,77,716]);class id{constructor(Ca,vb,hc){this.hQa=this.uaa=this.Irc=!1;this.c9a=Ca;this.YSa=hc;this.user=vb}get ip(){return this.YSa}get H9b(){return this.Irc}set H9b(Ca){(this.Irc=
Ca)&&this.ip.vIf()}bif(){const Ca=te.instance.mCl();return new Yb(this.c9a,this.user.clientId,1,0,this.ip?this.ip.getData():null,new Uf(this.user.zQ,this.user.KAc,this.user.chatThreadDiscoveryUri,this.user.inChat,this.user.capabilities.capabilities,this.user.email,this.user.userName,this.user.isAnonymous,this.user.presenceStatus),void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ca)}cTh(){return this.user.clientId+(this.ip?this.ip.paragraphId.toString():ee.a.nil.toString())}Sd(){const Ca=!!this.user&&
this.user.Sd(),vb=!this.ip||this.ip.Sd();return Ca&&vb}clone(){const Ca=new id;Ca.c9a=this.c9a;Ca.Irc=this.Irc;Ca.user=this.user?this.user.clone():null;Ca.YSa=this.ip?this.ip.clone():null;Ca.uaa=this.uaa;Ca.hQa=this.hQa;return Ca}static m0e(Ca,vb,hc,Nc,sd){if(!Ca||!vb)return null;if(Ca.ft)return h.ULS.sendTraceTag(7685324,302,15,"Presence packet is of unexpected operationType {0}",Ca.ft),null;let Id;Id=void 0!==Ca.Nha&&null!==Ca.Nha?za.cvh(Ca.clientId,Ca.Nha.UserName,Ca.Nha.Capabilities,Ca.Nha.LocalCobaltSessionId,
Ca.Nha.SkypeChatThreadId,Ca.Nha.Email,Ca.client,Ca.Nha.ChatThreadDiscoveryUri,Ca.Nha.InChat,!1,Ca.Nha.IsAnonymous,Ca.Nha.PresenceStatus):za.cvh(Ca.clientId,null,0,void 0,void 0,void 0,Ca.client);return new id(Ca.packetId,Id,Qf.Mxb(Ca.xS,vb,hc,Nc,sd))}}Object(l.a)(id,"WordPresenceInfo",null,[725,77]);class Gg extends tb{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,Tc,uj,oj){super(Ca,Id,oj,vb);this.Nzj=hc;this.dVj=Nc;this.BTj=sd;this.hb=We;Gg.xt=Fd;this.TH=Ff;this.ud=Ac;this.rIa=Qi;this.iNe=Tc;this.xGa=
uj}y$f(Ca){this.xGa.Jki(Ca.CommandValueId);return super.y$f(Ca)}Fqm(Ca){let vb;({lNf:vb}=this.ltf(Ca)).returnValue&&(this.dVj(vb.ip.paragraphId,vb.ip.v7.cp),u.AFrameworkApplication.K.$("WordEditorMoveIpToUserLocationIsEnabled")&&(Ca=Gg.vKl(vb),void 0!==Ca&&null!==Ca?(h.ULS.sendTraceTag(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),this.hb.setSelection(Ca),Va.FocusManager.nJ()&&Va.FocusManager.instance().Kg(ib.AFrame.Wo)):h.ULS.sendTraceTag(20764575,325,50,"IP will not be moved since the selection is either null or undefined")),
Ca=new Ga.a(2,1,0,()=>{this.ga.Xb(Kb.a.g9d,2,vb)}),Xa.a.instance.fc(Ca))}kYh(Ca){return Ca?(Ca=id.m0e(ud(Ca),this.TH,this.ud,this.rIa,this.iNe.instance))&&Ca.Sd()&&Ca.ip?Ca:null:null}Lsk(Ca){return this.ykm(Ca)?this.atk(Ca)?!0:(h.ULS.sendTraceTag(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),!1):(h.ULS.sendTraceTag(41236612,325,50,"Cannot jump to user location because presence is not valid"),!1)}ykm(Ca){return!!this.kYh(Ca)}ltf(Ca){Ca=this.kYh(Ca);return{returnValue:!!Ca,
lNf:Ca}}atk(Ca){let vb;return({lNf:vb}=this.ltf(Ca)).returnValue?this.Nzj(vb.ip.paragraphId,vb.ip.v7.cp):!1}Bjl(){if(!this.yC)return[];const Ca=[];for(let vb of this.yC.qYa())vb.userName?Ca.push(vb):h.ULS.sendTraceTag(592229832,304,15,"The looked up RTC User has no name");return Ca}OHk(Ca){let vb;return({lNf:vb}=this.ltf(Ca)).returnValue&&vb.user&&vb.user.presenceStatus&&"0"!==vb.user.presenceStatus?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,vb.user.presenceStatus):CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Yln(){this.BTj(this.settings.id)}static createInstance(Ca,
vb,hc,Nc,sd,Id,We){const Fd=fb.App.xa.jb,Ff=u.AFrameworkApplication.ya,Ac=Ib.a.instance,Qi=oa.a.instance.resolve("Box4.ICoauthCashTelemetry");return new Gg(Ca,vb,Tc=>Fd.Fc.yi?Fd.Fc.PVe(Tc,!0):!1,(Tc,uj)=>{Fd.Fc.yi&&Fd.Fc.Adc(Tc,uj,!0,!0)},()=>{fb.App.Ev.eI.P3c()},Ff,Ac,Fd,hc,Nc,sd,Id,Qi,We)}static vKl(Ca){const vb=Gg.xt.Xc.Ad.Db(Ca.ip.paragraphId);if(void 0===vb||null===vb)return h.ULS.sendTraceTag(20764576,325,15,"The node could not be obtained"),null;if(!Wa.ParagraphReader.nc(vb))return h.ULS.sendTraceTag(20764577,
325,15,"The obtained node is not a paragraph node"),null;Ca=vc.a.Uc(vb,Ca.ip.v7.cp);return new Lc.Selection([Ca],!0)}}Gg.xt=null;Object(l.a)(Gg,"WordEditorPeoplesWell",tb,[]);class ad{constructor(){this.fx=()=>{u.AFrameworkApplication.BFi?ad.EPa.CI().continueWith(this.XTc):h.ULS.sendTraceTag(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")};this.XTc=()=>{ad.ij=ad.EPa.CI().result;if(ad.ij){var Ca=()=>{const vb=fb.App.xa.jb;return vb?vb.Xc?vb.Xc.Ad:(h.ULS.sendTraceTag(23196876,
325,15,"ActivePage is null"),null):(h.ULS.sendTraceTag(23196875,325,15,"Workspace is null"),null)};fb.App.Ula().continueWith(()=>{const vb=fb.App.Ula().result.pj,hc=Ba.CuiHelper.JFl(u.AFrameworkApplication.pr,u.AFrameworkApplication.pr,u.AFrameworkApplication.pr,u.AFrameworkApplication.pr),Nc=Ra.createInstance(hc,vb,Object(e.a)(ad.ij.r5d,ad.ij.r5d.dKc,"getUserPresence"),Object(e.a)(ad.ij.r5d,ad.ij.r5d.Ceb,"getUserStatusInfo"),u.AFrameworkApplication.K.$("WordEditorPresenceDedupeMultipleCoauthorInstances"));
oa.a.instance.ha("RealtimePresenceUI.WordEditorPeoplesWell",()=>Gg.createInstance(Nc,ka.a.Lq(ad.W.$a("Common.IPeopleInfoProvider")),ad.W.Pa("WordEditor.ParagraphWordIdMapping"),ad.W.Pa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Ca,ad.W.$a("WordEditor.Presence.IWordPresenceCpFactory"),ad.W.resolve("Common.App.People.IPeopleManager"))).as("Common.IPeoplesWell").singleInstance();ad._instance=oa.a.instance.resolve("Common.IPeoplesWell");ad._instance.fpn();h.ULS.sendTraceTag(23196877,
325,50,"PeoplesWellControl is fully initialized")})}else h.ULS.sendTraceTag(23196873,325,15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")}}get name(){return"WordEditor.PeoplesWellControl"}zc(Ca){ad.W=Ca}init(){u.AFrameworkApplication.K.gq(this.fx)}dispose(){ad._instance&&(ad._instance.dispose(),ad._instance=null)}static get EPa(){return null!=ad.$qg?ad.$qg:ad.$qg=oa.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}}ad._instance=null;ad.W=null;ad.ij=null;Object(l.a)(ad,
"WordEditorPeoplesWellControlPackage",null,[1,2]);var Kd=c(81),jh=c(143);class Qe{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff=!1){this.w5a=null;this.aqe=!0;this.xDe=this.Pq=this.Oie=null;this.sa=new Za.a;this.lIa=Ca;this.cda=vb;this.AXg=hc;this.Utc=Nc;this.axg=Id;Qe.Hb=sd;this.FSj=We;this.KY=Fd;this.JTj=Ff;H.Task.WAA(vb,hc).continueWith(Object(e.a)(this,this.G3l,"initOnTaskReady"))}O$j(Ca){this.sa.addHandler("u",Ca)}aLi(){this.sa.raiseEvent("u",null,this)}G3l(){this.cda.result&&this.AXg.result&&(this.Pq=
this.cda.result,this.xDe=this.AXg.result,this.Pq.KVa(Object(e.a)(this,this.m3,"onPresenceUpdated")),this.Oie=new Ga.a(2,2,this.axg,Object(e.a)(this,this.njo,"updateAwayClientsTask"),88),Qe.Hb.fc(this.Oie))}m3(Ca,vb){(this.aqe||this.ejn(vb.HFa))&&Qe.Hb.A3(this.Oie,0)}ejn(Ca){for(let hc in Ca){var vb=this.Utc.LHd({key:hc,value:Ca[hc]});if(vb&&vb.clientId&&(vb=vb.clientId.toLowerCase(),(vb=this.w5a[vb]||this.w5a[vb.toUpperCase()])&&2===vb.status))return!0}return!1}njo(Ca){var vb=this.Pq.tHc();if(vb){var hc=
new Date,Nc=!1;if(this.aqe){this.w5a=vb;this.aqe=!1;var sd=this.w5a;for(var Id in sd){vb=Id;var We=sd[Id];We.R8b<hc&&(hc=We.R8b);2===We.status&&(Nc=!0,this.xDe.ZXc(vb))}Nc&&this.aLi();Qe.Hb.A3(Ca,this.bWh(hc))}else{We=new M.a;Id=!1;var Fd=this.w5a;for(sd in Fd){Fd=sd;if(!(Fd in this.w5a)||this.lIa.clientId===Fd)continue;var Ff=this.w5a[Fd];const Ac=vb[Fd];if(Ff&&Ac){Ff=Ff.status;const Qi=Ac.status;2===Ff&&1===Qi?(We.add(Fd),h.ULS.sendTraceTag(38052609,392,50,Fd+" returned from away")):1===Ff&&2===
Qi&&(Id=Nc=!0,this.xDe.ZXc(Fd),h.ULS.sendTraceTag(38052610,392,50,Fd+" went away"));1===Qi&&Ac.R8b<hc&&(hc=Ac.R8b)}}this.w5a=vb;Qe.Hb.A3(Ca,this.bWh(hc));(0<We.count||Nc)&&this.aLi();0<We.count&&!this.JTj?(Ca=this.ynl(We),this.ebo(Ca)):Ca=new M.a;(Id||0<Ca.count)&&this.FSj(bc.a.xvd,2)}}}ebo(Ca){if(Ca.count)for(let vb of Ca)Ca=this.KY.usa(String.format(CommonUIStrings.l_EditorsToastArriving,vb),!1),Ca.image=5,Ca.ema="CoAuth_AuthorStatus_16x16x32",this.KY.qA(Ca)}ynl(Ca){const vb=this.Pq.dAb(),hc=new M.a;
for(let Nc in vb){const sd={key:Nc,value:vb[Nc]};if(Ca.contains(sd.key)){const Id=this.Utc.LHd(sd);Id&&(hc.add(Id.userName),Ca.remove(sd.key))}}hc.count||h.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return hc}bWh(Ca){const vb=new Date;return Math.max(Ca.getTime()+this.axg-vb.getTime(),0)}}Qe.Hb=null;Object(l.a)(Qe,"AwayManager",null,[]);var zc=c(783);class uc{constructor(Ca=0){this.updates=Ca}get Alf(){return 0!==this.updates}OBa(Ca){return!!(this.updates&Ca)}W2a(Ca){this.updates|=
Ca}toString(){if(this.OBa(0))return"none";const Ca=new M.a;this.OBa(1)&&Ca.add("user(s) joined");this.OBa(2)&&Ca.add("user(s) disconnected");this.OBa(4)&&Ca.add("user(s) updated");return Ca.toArray().join(", ")}}Object(l.a)(uc,"UserUpdateEvent",null,[]);var Ed=c(32);class Of{constructor(Ca,vb,hc,Nc,sd=null){this.sa=new Za.a;this.zJ=this.ij=null;this.MSg=this.hTg=this.Cl=!1;this.Yp=new Ea.a;Ca.continueWith(()=>{this.ij=Ca.result;this.ij.KVa(Object(e.a)(this,this.kBi,"onRtcPresenceUpdate"));this.ij.wza(Object(e.a)(this,
this.jBi,"onRtcConnectionChange"));this.W9f(null,null)});vb.continueWith(()=>{this.zJ=vb.result;this.zJ.EVa(Object(e.a)(this,this.CTc,"onEditorsTableUpdated"))});sd&&sd.continueWith(()=>{sd.result.O$j(Object(e.a)(this,this.W9f,"updateUserStatus"));this.W9f(null,null)});this.m9a=hc;this.Utc=Nc}get users(){return this.Yp}BXb(Ca){this.sa.addHandler("UU",Ca)}h4d(Ca){this.sa.removeHandler("UU",Ca)}W9f(){if(this.ij){var Ca=!1,vb=this.ij.tHc();for(let Nc in vb){var hc=vb[Nc];const sd=Nc;this.users.ub(sd)&&
(hc=this.Tdj(hc),Ca=this.users.J(sd).fxb!==hc||Ca,this.users.J(sd).fxb=hc)}Ca&&(Ca=new uc(4),this.n6d(Ca))}}Tdj(Ca){return 1===Ca.status?0:1}qYa(){this.users.count||(this.hTg||(Ed.b(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),this.hTg=!0),this.H8m());const Ca=[];for(let vb of this.users)Array.add(Ca,vb.value);return Ca}H8m(){if(this.ij){var Ca=this.ij.dAb();this.wAf(Ca)}if(this.zJ){Ca=this.zJ.mHc();for(const vb of Ca)vb.Id&&(Ca=this.gxh(vb.Id),this.V9f(new uc,Ca))}}xpi(Ca){({value:Ca}=
this.users.Bc(Ca));return Ca}dispose(){this.Cl||(this.ij&&(this.ij.$Ib(Object(e.a)(this,this.kBi,"onRtcPresenceUpdate")),this.ij.cYc(Object(e.a)(this,this.jBi,"onRtcConnectionChange"))),this.zJ&&this.zJ.kQi(Object(e.a)(this,this.CTc,"onEditorsTableUpdated")),this.Cl=!0)}jBi(Ca,vb){2===vb.newState&&(Ca=this.wAf(this.ij.dAb()),Ca.Alf&&this.n6d(Ca))}CTc(Ca,vb){Ca=new uc;var hc=this.zJ.mHc();h.ULS.sendTraceTag(561894485,302,50,"editorstablemanager coauthors count is {0}, editorstableupdate old count of coauthors is {1}, editorstableupdate new count of coauthors is {2}",
hc.length,vb.zQm,vb.Hui);const Nc=new Ea.a;for(var sd of hc){hc=sd.Id;const Id=this.gxh(hc);this.V9f(Ca,Id);Nc.Z(hc,Id)}if((vb=vb.leaving)&&0<vb.length)for(sd=0;sd<vb.length;sd++)h.ULS.sendTraceTag(562415168,302,50,"{0} users in coauth gallery. User leaving the editor table: {1}",this.users.count,vb.J(sd).Id),({value:hc}=this.users.Bc(vb.J(sd).Id)).returnValue?hc?(this.users.remove(vb.J(sd).Id),Ca.W2a(2),Nc.Z(vb.J(sd).Id,hc)):h.ULS.sendTraceTag(561287839,302,50,"Empty entry in PIP users: {0}",vb.J(sd).Id):
h.ULS.sendTraceTag(570426140,302,15,"Disconnected user not found: {0}",vb.J(sd).Id);vb=this.ij.dAb();for(let Id in vb)sd=this.Utc.LHd({key:Id,value:vb[Id]}),Nc.Z(sd.clientId,sd);for(let Id of this.users)Nc.ub(Id.value.clientId)||(h.ULS.sendTraceTag(561287840,302,15,"Coauth Gallery contains user not in Editors Table or RTC presence: {0}",Id.key),this.users.remove(Id.key),Ca.W2a(2));Ca.Alf&&this.n6d(Ca)}kBi(Ca,vb){Ca=this.wAf(vb.HFa);for(const hc of vb.Hzd)this.users.ub(hc)&&(Ca.W2a(2),this.users.J(hc).fxb=
2);Ca.Alf&&this.n6d(Ca)}wAf(Ca){const vb=new uc;if(!Ca)return vb;for(let Nc in Ca){var hc=this.Utc.LHd({key:Nc,value:Ca[Nc]});hc&&(hc=hc.clone(),this.V9f(vb,hc))}return vb}V9f(Ca,vb){if(vb){var hc=vb.clientId;var Nc=this.cAn(vb);({value:vb}=this.users.Bc(hc)).returnValue?vb.equals(Nc)||(Ca.W2a(4),this.users.Z(hc,Nc)):(h.ULS.sendTraceTag(562415169,302,50,"{0} users in coauth gallery. User joining: {1}",this.users.count,hc),Ca.W2a(1),this.users.Z(hc,Nc))}}gxh(Ca){return this.users.ub(Ca)?this.users.J(Ca):
Ma.a.yLk(Ca)}cAn(Ca){if(!Ca||!Ca.clientId||!this.zJ)return Ca;const vb=Ca.clone();vb.fxb=this.xnl(Ca);if(Ca=this.zJ.E2b(vb.clientId))vb.isReadOnly=vb.isReadOnly||Ca.IsReadOnly?!0:!1,vb.userName=this.bAn(vb,Ca),vb.capabilities=this.bKm(vb.capabilities,Ca.Capabilities),vb.email=vb.email||Ca.SIPAddress||Ca.EmailAddress,Ca.JoinCoauthTime&&(vb.vNa=Ca.JoinCoauthTime);vb.color=this.m9a.cKc(new zc.a(vb.email,void 0,vb.userName,void 0,vb.isAnonymous,vb.clientId),3);return vb}xnl(Ca){if(!this.ij)return 2;if(Ca&&
Ca.clientId){const vb=this.ij.tHc();if(Ca.clientId in vb)return this.Tdj(vb[Ca.clientId])}return 2}nDk(Ca,vb){vb.Name&&Ca.userName&&vb.Name!==Ca.userName&&!this.MSg&&(this.MSg=!0,Ed.b(42316243,302,15,"User names in EditorsTable and RTC don't match"))}bKm(Ca,vb){Ca=Ca||new Ia.a;vb&&(vb.SupportsRealtimeChannel&&Ca.W2a(1),vb.SupportsRename&&Ca.W2a(2),vb.SupportsChat&&Ca.W2a(4));return Ca}bAn(Ca,vb){this.nDk(Ca,vb);return vb.Name||Ca.userName||(Ca.isAnonymous||vb.IsAnonymous?CommonUIStrings.l_GuestUserName:
null)}n6d(Ca){h.ULS.sendTraceTag(42316245,302,100,"PeopleInfoProvider update detected: {0}",Ca.toString());this.sa.raiseEvent("UU")}}Object(l.a)(Of,"PeopleInfoProvider",null,[1112,10]);var $b;(function(Ca){Ca[Ca.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Ca[Ca.peopleImageClassName=1]="peopleImageClassName";Ca[Ca.peopleImageClusterPath=4]="peopleImageClusterPath";Ca[Ca.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";Ca[Ca.imageDimension=6]="imageDimension";
Ca[Ca.rtl=8]="rtl";Ca[Ca.pointerInputManager=9]="pointerInputManager";Ca[Ca.clickInputManager=10]="clickInputManager";Ca[Ca.vertical=11]="vertical";Ca[Ca.zIndex=12]="zIndex";Ca[Ca.contextMenuInputManager=13]="contextMenuInputManager";Ca[Ca.imageDomElement=14]="imageDomElement";Ca[Ca.useIdleTooltip=15]="useIdleTooltip";Ca[Ca.viewportBoundsCallback=16]="viewportBoundsCallback";Ca[Ca.flipHorizontalDirection=17]="flipHorizontalDirection";Ca[Ca.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";
Ca[Ca.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Ca[Ca.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})($b||($b={}));Object(l.b)("PresenceTooltipSettingKeys",$b);class xc{constructor(){this.pq={}}get(Ca,vb=null){Ca=$b[Ca];return"number"===typeof vb?(vb=this.pq[Ca])?Number.parseInvariant(vb.toString()):0:this.pq[Ca]}add(Ca,vb){this.pq[$b[Ca]]=vb}GJa(Ca,vb){$b[Ca]in this.pq||(this.pq[$b[Ca]]=vb)}remove(Ca){delete this.pq[$b[Ca]]}}Object(l.a)(xc,"PresenceTooltipSettings",null,
[]);class Yc extends Za.a{constructor(Ca){super();this._element=null;this.element=Ca}get element(){return this._element}set element(Ca){this._element=Ca}get visible(){return"visible"===this.element.style.visibility}set visible(Ca){this.element.style.visibility=Ca?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(Ca){this.element.dir=Ca?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(Ca){this.element.style.zIndex=String(Ca)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(Ca){return this.element.ownerDocument.createElement(Ca)}jha(){return!0}static vwh(Ca){return"prControl"+(Ca?"Rtl":"")}}Object(l.a)(Yc,"BasePresenceControl",Za.a,[10,1039]);class wd extends Sys.EventArgs{constructor(Ca,vb){super();this.type=Ca;this.In=vb}}wd.GT="InteractivityChanged";Object(l.a)(wd,"InteractivityChangedEventArgs",Sys.EventArgs,[]);class le{static Iql(Ca){return le.Jql(Ca)}static Jql(Ca){const vb=
document.createElementNS(le.zbg,"svg");vb.setAttribute("viewBox",String.format(le.RRk,le.smj,le.rmj));vb.appendChild(le.BMl(Ca));return vb}static BMl(Ca){const vb=le.smj/Ca,hc=2*vb,Nc=le.rmj/2;Ca=(Ca-12-8)*vb/2;const sd=document.createElementNS(le.zbg,"g");Sys.UI.DomElement.addCssClass(sd,le.QRk);for(let Id=1;3>=Id;Id++)sd.appendChild(le.knl(Id,hc,Ca+(6*Id-2)*vb,Nc));return sd}static knl(Ca,vb,hc,Nc){const sd=document.createElementNS(le.zbg,"circle");Sys.UI.DomElement.addCssClass(sd,String.format("{0}-{1}",
le.dxk,Ca));sd.setAttribute("cx",String.format("{0}",hc));sd.setAttribute("cy",String.format("{0}",Nc));sd.setAttribute("r",String.format("{0}",vb));return sd}}le.zbg="http://www.w3.org/2000/svg";le.QRk="prDancingDots";le.dxk="prAnimateCircle";le.RRk="0 0 {0} {1}";le.rmj=40;le.smj=120;Object(l.a)(le,"ModernPresenceTooltipDancingDots",null,[]);var uf=c(91),yg=c(95),pb=c(7),Wb=c(27),Oc=c(116),nd=c(49);class ve extends Yc{constructor(Ca,vb){super(Ca);this.f6g=this.k7a=this.Bke=this._img=this.HD=this.Ir=
this.kg=null;this.TIa=vb.get(8,!1);this.T6a=vb.get(6,0);this.O_j=vb.get(15,!1);this.Nd=vb;this.cFg=0;this.element=Ca;this.element.className=ve.A$e;this._span=document.createElement("span");this.element.appendChild(this._span);this.HDj=le.Iql(vb.get(6,0));this.UA(vb);this._state=5}Evb(Ca){this.addHandler(wd.GT,Ca)}XIb(Ca){this.removeHandler(wd.GT,Ca)}get user(){return this.f6g}get state(){return this._state}dispose(){this.element&&(this.kg.sc(pb.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),
this.kg.sc(pb.a.XC,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.Ir.sc(pb.a.pointerDown,this.element,Object(e.a)(this,this.$B,"onPointerDown")),this.Ir.sc(pb.a.pointerOut,this.element,Object(e.a)(this,this.kO,"onPointerOut")),this.Ir.sc(pb.a.pointerOver,this.element,Object(e.a)(this,this.tX,"onPointerOver")),this.HD.sc(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}UA(Ca){this.kg=Ca.get(10);this.kg.mb(pb.a.click,
this.element,Object(e.a)(this,this.onClick,"onClick"));this.kg.mb(pb.a.XC,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior"));this.Ir=Ca.get(9);this.Ir.mb(pb.a.pointerOver,this.element,Object(e.a)(this,this.tX,"onPointerOver"));this.Ir.mb(pb.a.pointerOut,this.element,Object(e.a)(this,this.kO,"onPointerOut"));this.Ir.mb(pb.a.pointerDown,this.element,Object(e.a)(this,this.$B,"onPointerDown"));this.HD=Ca.get(13);this.HD.mb(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior"))}hide(Ca=
null,vb=0,hc=0){this.O_j&&Ca?this.b_n(Ca,vb,hc):(3===this.state&&this.WOi(),this.visible=!1,this._state=5)}b_n(Ca,vb,hc=0){this.show(Ca,vb,15,4,void 0,hc)}L5i(Ca,vb,hc=!1,Nc=!1,sd=!1,Id=0){this.show(Ca,vb,20,hc?2:Nc?1:0,sd,Id)}AZn(Ca,vb,hc,Nc=!1,sd=0){this.show(Ca,vb,hc+20,3,Nc,sd)}show(Ca,vb,hc,Nc=3,sd=!1,Id=0){!Ca||Nc===this.state&&this.EYl(vb,hc)||(this.V2j(Nc,sd,Id),this.yda(Ca,Nc,Id),this._state=Nc,4===Id||0===Id&&!this.TIa?this.element.style.left=vb+"px":this.element.style.right=vb+"px",this.element.style.top=
hc+"px",this.visible=!0)}yda(Ca,vb,hc){this.f6g=Ca;nd.a.rA(this._span);Oc.a.Myk(this._span);this._span.id="fly_"+Ca.clientId;this._span.style.backgroundColor=Ca.color;4!==vb?(this._span.style.height=this.T6a+"px",this._span.style.lineHeight=this.T6a+"px",Oc.a.uec(this._span,"border-radius",this.T6a+"px")):4===hc||0===hc&&!this.TIa?this._span.style.left="0px":this._span.style.right="0px";2!==vb&&(4===vb?nd.a.ly(this._span,""):1===vb?this._span.appendChild(this.HDj):(this._span.setAttribute("dir","auto"),
hc=ua.a.Exl(Ca.userName),(!Ca.isAnonymous||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&hc||0!==vb?(Ca=Ca.userName,0===vb&&(Ca=hc,Oc.a.uec(this._span,"text-align","center")),nd.a.ly(this._span,Ca)):(this._img||(this._img=this.uJk()),this._span.appendChild(this._img),Oc.a.uec(this._span,"text-align","start"))))}onClick(Ca){if(0===this.state)return this.raiseEvent(wd.GT,new wd(1,Ca)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,
302,50,"User clicked on presence pill.");return!1}kO(Ca){3===this.state&&this.raiseEvent(wd.GT,new wd(3,Ca));return!1}tX(Ca){3!==Ca.ig&&this.raiseEvent(wd.GT,new wd(2,Ca));return!1}$B(Ca){if(3!==Ca.ig)return!0;this.raiseEvent(wd.GT,new wd(4,Ca));return!1}uJk(){const Ca=document.createElement("img");Ca.src=uf.a.b$("doughperson_white_glyph.svg");Ca.setAttribute("Unselectable","on");Wb.a.Jq(Ca,Wb.a.Bh,Wb.a.Gz);return yg.createClusteredImageFromClusterWithImageClass(this.T6a,this.T6a,null,null,ve.Ldl,
"",!1,"",this.element.ownerDocument,Ca)}V2j(Ca,vb=!1,hc=0){if(!this.sNc(this.state)||!this.sNc(Ca))switch(Sys.UI.DomElement.removeCssClass(this.element,this.Bke),this.state){case 4:3===Ca?this.CVa(ve.B$e,ve.AKh):this.sNc(Ca)&&this.CVa(ve.z$e,ve.AKh);break;case 3:4===Ca?this.CVa(ve.E$e,ve.zKh):this.sNc(Ca)&&(vb&&this.WOi(),this.CVa(ve.z$e,ve.zKh,vb?ve.Kdl:""));break;case 0:case 1:case 2:4===Ca?this.CVa(ve.E$e,ve.C$e):3===Ca&&(vb&&this.b4j(),this.CVa(ve.B$e,ve.C$e,vb?ve.BKh:"",3===hc?ve.Odl:ve.Mdl));
break;default:4===Ca?this.CVa(ve.E$e):3===Ca?this.CVa(ve.B$e):this.sNc(Ca)&&this.CVa(ve.z$e)}}CVa(...Ca){this.Bke=Ca.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.Bke)}b4j(){this.cFg=window.setTimeout(()=>{this.element&&(this.k7a=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.k7a),this.element.style.zIndex="2",this.k7a.style.zIndex="1")},300)}WOi(){window.clearTimeout(this.cFg);this.k7a&&(Sys.UI.DomElement.removeCssClass(this.k7a,ve.C$e+" "+ve.BKh),Sys.UI.DomElement.addCssClass(this.k7a,
ve.Jdl),H.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.k7a.parentNode&&this.element.parentNode.removeChild(this.k7a)}),Oc.a.wcc(this.element,"z-index"))}sNc(Ca){return 0===Ca||1===Ca||2===Ca}EYl(Ca,vb){const hc=Oc.a.wX(this.element.style.top);return Oc.a.wX(this.element.style.left)===Ca&&hc===vb}FUf(Ca){3===Ca&&Oc.a.Y9(this.element,"left")?(Ca=Oc.a.wX(this.element.style.left),Oc.a.wcc(this.element,"left"),this.element.style.right=-1*Ca+"px"):4===Ca&&Oc.a.Y9(this.element,
"right")&&(Ca=Oc.a.wX(this.element.style.right),Oc.a.wcc(this.element,"right"),this.element.style.left=-1*Ca+"px")}}ve.A$e="prModernFlyout UIFont";ve.E$e="flyoutIdle";ve.B$e="flyoutExpanded";ve.z$e="flyoutCollapsed";ve.AKh="flyoutFromIdle";ve.zKh="flyoutFromExpanded";ve.C$e="flyoutFromCollapsed";ve.BKh="flyoutStacked";ve.Kdl="flyoutFromStacked";ve.Jdl="flyoutFadeOut";ve.Ldl="cui-img-cont-float cui-img-20by20";ve.Mdl="flyoutLtrDir";ve.Odl="flyoutRtlDir";Object(l.a)(ve,"ModernPresenceTooltipFlyoutControl",
Yc,[]);class nf{constructor(Ca,vb,hc=2,Nc=4){this.offsetTop=Ca;this.offsetLeft=vb;this.pmj=hc;this.h7h=Nc}}Object(l.a)(nf,"FlyoutsPositioningInfo",null,[]);var pf=c(37);class Mg{constructor(Ca=!1,vb=!1){this.Nl=Ca;this.jqe=vb}Tyl(Ca,vb,hc,Nc,sd){const Id=sd.y,We=sd.height;var Fd=this.Ell(Nc);const Ff=Fd+vb,Ac=Ca*hc+2*(Ca-1);hc=null;1===Ca||this.Bsk(Fd,Ac,Id,We)?Ca=new nf(0,0,2):(Ca=this.k$e(Ff,Ac,Id,We),Ca.offsetTop-=Fd);this.jqe?hc=new nf(0,0,void 0,this.Nl?4:3):(Nc=this.Dll(Nc,sd),Fd=Math.max(0,
sd.x),sd=sd.width,vb=Nc+vb,this.Csk(Nc,Fd,sd)?hc=new nf(0,0,void 0,this.Nl?3:4):this.Dsk(vb,Fd)&&(hc=new nf(0,0,void 0,this.Nl?4:3)),hc||(hc=this.vcl(Nc,vb,Fd,sd)));return new nf(Ca.offsetTop,hc.offsetLeft,Ca.pmj,hc.h7h)}Ell(Ca){return pf.a.zLa(Ca)}Dll(Ca,vb){return this.Nl?vb.width-pf.a.jOh(Ca):pf.a.jcf(Ca)}Bsk(Ca,vb,hc,Nc){return Ca+vb<=hc+Nc}k$e(Ca,vb,hc,Nc){let sd=1,Id=Math.max(hc,Ca-vb);vb>Ca-hc&&(sd=2,Id=vb<Nc?Nc-vb:hc);return new nf(Id,0,sd)}Csk(Ca,vb,hc){return Ca+150<=vb+hc}Dsk(Ca,vb){return 150<=
Ca-vb}vcl(Ca,vb,hc,Nc){Nc-vb>=Ca-hc?Ca=4:(vb=Ca,Ca=3);return new nf(0,vb,void 0,Ca)}}Object(l.a)(Mg,"ModernPresenceTooltipPositioner",null,[]);class Jg{constructor(Ca,vb,hc,Nc,sd,Id,We){this.I8=Ca;this._parent=vb;this.Jzg=hc;this.DAj=Nc;this.uIj=sd;this.QVb=Id;this.TIa=We;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Ca,vb){if(3!==Ca)if(5!==Ca&&this.I8&&this.I8.length){if(4===Ca){var hc=this.uIj;var Nc=(this.QVb-hc)/2;
this.element.style.height=this.QVb+"px";this.element.style.width=this.QVb+"px";Ca=Oc.a.wX(this.I8[0].element.style.top);vb=Oc.a.wX(this.TIa?this.I8[0].element.style.right:this.I8[0].element.style.left)}else hc=this.Jzg,Nc=(this.QVb-hc)/2,this.element.style.height=this.QVb+"px",this.element.style.width=this.Bnl()+2*Nc+"px",Ca=Oc.a.wX(this.I8[this.I8.length-1].element.style.top),vb=this.Drk(this.I8[this.I8.length-1].element,hc,vb);Oc.a.uec(this.element,"border-radius",this.QVb+"px");this.element.style.top=
Ca-Nc-hc+"px";this.TIa?this.element.style.right=vb-Nc+"px":this.element.style.left=vb-Nc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}Drk(Ca,vb,hc){return this.TIa&&!hc?Oc.a.wX(Ca.style.right):this.TIa||hc?this.TIa&&hc?-Oc.a.wX(Ca.style.left)-vb:-Oc.a.wX(Ca.style.right)-vb:Oc.a.wX(Ca.style.left)}Bnl(){return this.I8&&this.I8.length?this.Jzg+Math.min(this.I8.length-1,2)*
this.DAj:0}}Object(l.a)(Jg,"ModernPresenceTooltipTarget",null,[]);var rh=c(153);class Tg extends Yc{constructor(Ca,vb,hc){super(Ca);this.pUb=this.HHa=this.TJg=this.Opb=!1;this.Yp=[];this.kcd={};this.Nd=hc;this.Nl=hc.get(8,!1);this.RIg=hc.get(15,!1);this.CCj=hc.get(12,0);this.Mab=hc.get(6,0);this.f$a=vb;this.x6g=hc.get(16);this.jqe=hc.get(17,!1);this.xIj=hc.get(19,!1);this.uSj=hc.get(20,!1);this.bfd=0;this.oSj=new Mg(this.Nl,this.jqe);this.ujc=this.KQh();this.Hsb=!1;this.$Nb=[];this.fpc=[];this.element.id=
Tg.tdb();this.element.className=Yc.vwh(this.Nl);this.mXa&&(this.zIndex=this.mXa);this.rtl=this.Nl;this.oYf(vb);this.P4=this.createElement("div");this.P4.className="prFlyoutContainer";this.element.appendChild(this.P4);this.I8=[];this.K7a=new Jg(this.n2,this.element,this.Mab,4,6,32,this.Nl);this.Ir=hc.get(9);this.Ir.mb(pb.a.pointerDown,this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"));this.Ir.mb(pb.a.pointerOver,this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"));this.Ir.mb(pb.a.pointerOut,
this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"))}get H0d(){return F.a.clone(this.Yp)}get n2(){return this.I8}get mXa(){return this.CCj}get fYa(){return this.n2?this.n2.length:0}get gMb(){return 0<this.fYa?this.n2[0].state:5}get Yqf(){return 3===this.gMb&&!this.Opb}Evb(Ca){this.addHandler(wd.GT,Ca)}XIb(Ca){this.removeHandler(wd.GT,Ca)}dispose(){if(this.Yqf)this.Hsb=!0;else{if(this.n2)for(const Ca of this.n2)Ca.XIb(Object(e.a)(this,this.qOa,"onInteractivityChanged")),Kd.a.YA(Ca);this.I8=null;
this.Ir.sc(pb.a.pointerDown,this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"));this.Ir.sc(pb.a.pointerOver,this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"));this.Ir.sc(pb.a.pointerOut,this.K7a.element,Object(e.a)(this,this.T$b,"onHitTarget"));super.dispose()}}dfc(){this.DZb();this.visible=!0}G0c(){this.visible=!0;this.fHh();this.Opb=!0}M0f(){this.G0c()}hide(){this.APi();this.CZa();this.K7a.update(this.gMb,this.pUb)}yda(Ca){const vb=this.gMb,hc=this.Opb;Ca.clientId||(Ca.clientId=(Tg.Cpc++).toString());
if(Ca.clientId in this.kcd){var Nc=this.Jzb(Ca.clientId);if(0<=Nc){Nc=this.Yp[Nc];if(Nc.color===Ca.color&&Nc.userName===Ca.userName)return;this.s2a(Ca.clientId)}}this.hide();Nc=new ve(this.createElement("div"),this.Nd);Nc.Evb(Object(e.a)(this,this.qOa,"onInteractivityChanged"));this.P4.insertBefore(Nc.element,this.P4.firstChild);this.kcd[Ca.clientId]=Nc;Array.add(this.Yp,Ca);Array.add(this.n2,Nc);this.Bkj(vb,hc);this.visible=!0}s2a(Ca){if(this.Yqf)Array.add(this.fpc,Ca);else{var vb=this.gMb,hc=this.Opb;
this.hide();this.YXc(Ca);this.Bkj(vb,hc)}}Pti(Ca){const vb=this.Jzb(Ca);if(!(0>=vb)){var hc=this.Yp[vb];Ca=this.kcd[Ca];Array.removeAt(this.Yp,vb);Array.insert(this.Yp,0,hc);Array.removeAt(this.n2,vb);Array.insert(this.n2,0,Ca);this.P4.removeChild(Ca.element);this.P4.appendChild(Ca.element);this.DZb()}}Bkj(Ca,vb){0>=this.Yp.length?this.hide():3===Ca&&vb?this.G0c():this.dfc()}j8e(Ca){if(this.Yqf&&this.xIj)return!1;Ca=Tg.Chf(Ca);if(this.P4!==Ca&&nd.a.SMa(this.P4,Ca))return!0;for(const vb of this.n2)if(nd.a.SMa(vb.element,
Ca))return!0;return!1}position(Ca,vb){this.element.style.top=vb+"px";this.element.style.left=Ca+"px"}DZb(Ca=!1){if(!Ca||this.HHa){this.TJg&&this.D1i(!0);var vb=Math.min(3,this.fYa)-1;Ca=0;var hc=1,Nc=0;this.pUb&&(Ca=this.ujc,hc=-1,Nc=-this.Mab);for(let sd=this.fYa-1;sd>vb;sd--)this.n2[sd].L5i(this.Yp[sd],-4*vb*hc+Nc,!0,!1,!0,Ca);for(;0<=vb;vb--)this.n2[vb].L5i(this.Yp[vb],-4*vb*hc+Nc,0<vb,Array.contains(this.$Nb,this.Yp[vb].clientId),vb!==this.bfd,Ca);this.bfd=0;this.K7a.update(0,this.pUb);this.zIndex=
this.mXa;this.Opb=!1;this.APi(0);this.Hsb&&this.dispose()}}fHh(){this.TJg&&this.D1i(!1);this.zIndex=this.mXa+1;let Ca,vb,hc;({offsetX:vb,offsetY:Ca,g7h:hc}=this.NNn());for(let Nc=0;Nc<this.fYa;Nc++)this.n2[Nc].AZn(this.Yp[Nc],vb,Ca+(this.Mab+2)*Nc,Nc!==this.bfd,hc)}CZa(){let Ca=0,vb=0;this.pUb&&(Ca=this.ujc,vb=-6);for(let hc=0;hc<this.fYa;hc++)this.n2[hc].hide(this.Yp[hc],vb,Ca);this.zIndex=this.mXa;this.visible=this.Opb=!1;this.Hsb&&this.dispose()}dYe(Ca=0){Ca?(this.HHa=!0,H.Task.delay(Ca).continueWith(()=>
{this.RIg?this.h_l():this.DZb(!0);this.HHa=!1})):this.RIg?this.hide():this.DZb()}h_l(){this.HHa&&this.hide()}ckk(){if(u.AFrameworkApplication.ta&&u.AFrameworkApplication.ta.Rb.Ima&&rh.c()){const Ca=appChrome.selectors.getShyState();return Ca.isActive&&0!==Ca.state}return!1}qOa(Ca,vb){Ca=this.gMb;this.ckk()||2!==vb.type&&(4!==vb.type||3===Ca)?4===vb.type&&3===Ca?(this.HHa&&(this.HHa=!1),this.dYe()):3!==vb.type||3!==Ca||this.Opb||(1<this.fYa?(this.HHa=!0,H.Task.delay(250).continueWith(()=>{this.DZb(!0);
this.HHa=!1})):this.dYe()):(this.HHa&&(this.HHa=!1),3!==Ca&&(this.fHh(),3===vb.In.ig&&this.dYe(2E3)));this.raiseEvent(wd.GT,vb)}T$b(Ca){3===Ca.ig?this.qOa(this,new wd(4,Ca)):Ca.eventName===pb.a.pointerOver?this.qOa(this,new wd(2,Ca)):Ca.eventName===pb.a.pointerOut&&this.qOa(this,new wd(3,Ca));return!1}oYf(Ca){this.element.style.width=Ca+"px";this.element.style.height=this.Mab+"px"}YXc(Ca){this.Rqn(Ca);Ca=this.Jzb(Ca);if(!(0>Ca)){var vb=this.Yp[Ca];Array.removeAt(this.Yp,Ca);delete this.kcd[vb.clientId];
vb=this.n2[Ca];this.P4.removeChild(vb.element);this.Nd.get(18,!1)&&vb.XIb(Object(e.a)(this,this.qOa,"onInteractivityChanged"));Array.removeAt(this.n2,Ca);vb.dispose()}}APi(Ca=5){if(this.fpc.length){this.visible&&this.CZa();for(let vb=0;vb<this.fpc.length;vb++)this.YXc(this.fpc[vb]);Array.clear(this.fpc);0>=this.Yp.length||5===Ca?this.hide():0===Ca&&this.dfc()}}Jzb(Ca){for(let vb=0;vb<this.Yp.length;vb++)if(this.Yp[vb].clientId===Ca)return vb;return-1}Rqn(Ca){-1===this.Jzb(Ca)?h.ULS.sendTraceTag(41706452,
302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.$Nb,Ca)&&(Array.remove(this.$Nb,Ca),this.Yp[0].clientId===Ca&&0<this.$Nb.length&&this.Pti(this.$Nb[this.$Nb.length-1]),this.Yp[0].clientId===Ca&&1===this.gMb&&this.DZb())}D1i(Ca){Ca?Sys.UI.DomElement.addCssClass(this.P4,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.P4,"prBackgroundSelection")}NNn(){let Ca,vb;vb=Ca=0;var hc=this.ujc;if(this.x6g){const Nc=this.x6g(this);if(!Nc)return{offsetX:Ca,offsetY:vb,
g7h:hc};const sd=4===this.gMb;hc=this.oSj.Tyl(this.fYa,sd?6:this.Mab,this.Mab,this.element,Nc);vb=hc.offsetTop;this.bfd=this.vxl(hc.pmj,hc.offsetTop);hc=hc.h7h;hc!==this.ujc&&(this.FUf(hc),this.element.dir=3===hc?"rtl":"ltr",this.ujc=hc);hc!==this.KQh()?(Ca=this.uSj?-2:sd?-6:-this.Mab,this.pUb=!0):this.pUb=!1}return{offsetX:Ca,offsetY:vb,g7h:hc}}vxl(Ca,vb){if(1===Ca)return this.fYa-1;Ca=Math.abs(vb);return 0<Ca?Ca/(this.Mab+2):0}FUf(Ca){for(let vb=0;vb<this.fYa;vb++)this.n2[vb].FUf(Ca)}KQh(){return this.Nl?
3:4}static tdb(){return String.format("{0}-{1}","presencetooltip",Tg.Cpc++)}static Chf(Ca){return Ca.Ib.rawEvent.relatedTarget}}Tg.Cpc=0;Object(l.a)(Tg,"ModernPresenceTooltipControl",Yc,[1097,10]);var ak=c(206),ci=c(233);class Af{constructor(Ca){this.Nd=Ca;this.Nd.GJa(10,ak.a.instance);this.Nd.GJa(9,jh.a.instance);this.Nd.GJa(6,20);this.Nd.GJa(13,ci.a.instance);this.Nd.GJa(17,!1)}U_e(Ca,vb=!1){this.Nd.GJa(15,vb);return new Tg(Ca,20,this.Nd)}}Object(l.a)(Af,"ModernPresenceTooltipFactory",null,[1096]);
class Ef extends Yc{constructor(Ca,vb){super(Ca);this.Yp=null;this.TIa=vb.get(8,!1);this.T6a=vb.get(6,0);this.element=Ca;this.element.className=Ef.A$e;this._ul=this.createElement("ul");this.element.appendChild(this._ul);this.kg=vb.get(10);this.kg.mb(pb.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Ir=vb.get(9);this.Ir.mb(pb.a.pointerOut,this.element,Object(e.a)(this,this.kO,"onPointerOut"));this.Ir.mb(pb.a.pointerDown,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior"));
this.HD=vb.get(13);this.HD.mb(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior"))}Evb(Ca){this.addHandler(wd.GT,Ca)}XIb(Ca){this.removeHandler(wd.GT,Ca)}get users(){return this.Yp}dispose(){this.element&&(this.kg.sc(pb.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.Ir.sc(pb.a.pointerDown,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.Ir.sc(pb.a.pointerOut,this.element,Object(e.a)(this,this.kO,"onPointerOut")),
this.HD.sc(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(Ca,vb,hc){this.hide();!Ca||0>=Ca.length||(this.TIa?this.element.style.right=vb+"px":this.element.style.left=vb+"px",this.element.style.top=hc+"px",this.x7j(Ca),this.visible=!0)}x7j(Ca){this.Yp=Ca;nd.a.rA(this._ul);for(let vb=Ca.length-1;0<=vb;vb--)this.yda(Ca[vb])}yda(Ca){const vb=document.createElement("li");vb.style.backgroundColor=Ca.color;vb.style.height=
this.T6a+"px";vb.id="fly_"+Ca.clientId;vb.style.lineHeight=this.T6a+"px";nd.a.ly(vb,Ca.userName);vb.setAttribute("dir","auto");this._ul.appendChild(vb)}onClick(){this.hide();return!1}kO(Ca){this.raiseEvent(wd.GT,new wd(3,Ca));return!1}}Ef.A$e="prFlyout UIFont";Object(l.a)(Ef,"PresenceTooltipFlyoutControl",Yc,[]);class Ue extends Yc{constructor(Ca,vb,hc){super(Ca);this._img=null;this.Yp=[];this.element.className="prGlyph";this.Nd=vb;this.TTb=this.Nd.get(9);this.oq=this.Nd.get(10);this.HD=this.Nd.get(13);
this.F_l();this.yda(hc);this.Eue=!1}get f1a(){return this.Yp.length}get users(){return this.Yp}Evb(Ca){this.addHandler(wd.GT,Ca)}XIb(Ca){this.removeHandler(wd.GT,Ca)}dispose(){this.fho();super.dispose()}yda(Ca){Array.add(this.Yp,Ca);2===this.f1a?this.Hha(!0):1===this.f1a?this.Hha(!1):this.Hha(this.Eue)}s2a(Ca){this.B$k(Ca)&&(1<this.f1a&&this.Hha(!0),1===this.f1a?this.Hha(!1):1>this.f1a&&this.hide())}show(){this.Hha(2<=this.f1a);this.visible=!0}hide(){this.visible=!1}fxl(Ca){return Ca?this.pPh(0,5):
this.pPh(1,4)}B$k(Ca){for(let vb=0;vb<this.f1a;vb++)if(this.Yp[vb].clientId===Ca)return Ca=this.Yp[vb],Array.removeAt(this.Yp,vb),Ca;return null}Hha(Ca){this.Eue!==Ca&&(this._img&&this.element.removeChild(this._img),this._img=this.fxl(Ca),this.element.appendChild(this._img),this.Eue=Ca);this._img.childNodes[0].style.backgroundColor=this.Yp[this.Yp.length-1].color}pPh(Ca,vb){const hc=this.Nd.get(6,0),Nc=this.Nd.get(14);return yg.createClusteredImageFromClusterWithImageClass(hc,hc,this.Nd.get(Ca),this.Nd.get(vb),
"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,Nc?Nc.cloneNode(!0):null)}tX(Ca){3!==Ca.ig&&this.raiseEvent(wd.GT,new wd(2,Ca));return!1}onClick(Ca){this.raiseEvent(wd.GT,new wd(1,Ca));return!0}kO(Ca){3!==Ca.ig&&this.raiseEvent(wd.GT,new wd(3,Ca));return!1}fho(){this.element&&(this.TTb.sc(pb.a.pointerDown,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.TTb.sc(pb.a.pointerOver,this.element,Object(e.a)(this,this.tX,"onPointerOver")),this.TTb.sc(pb.a.pointerOut,
this.element,Object(e.a)(this,this.kO,"onPointerOut")),this.oq.sc(pb.a.XC,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.oq.sc(pb.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.HD.sc(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")))}F_l(){this.element&&(this.TTb.mb(pb.a.pointerDown,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.TTb.mb(pb.a.pointerOver,this.element,
Object(e.a)(this,this.tX,"onPointerOver")),this.TTb.mb(pb.a.pointerOut,this.element,Object(e.a)(this,this.kO,"onPointerOut")),this.oq.mb(pb.a.XC,this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")),this.oq.mb(pb.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.HD.mb(this.element,Object(e.a)(this,this.jha,"stopPropagationAndPreventDefaultBehavior")))}}Object(l.a)(Ue,"PresenceTooltipGlyph",Yc,[]);class Df extends Yc{constructor(Ca,vb,hc){super(Ca);this.Yp=
[];this.NJ=[];this.nIa=0;this.Xvc=this.ZQb=!1;this.pvg=null;this.lcd={};this.Nd=hc;this.Nl=hc.get(8,!1);this.Nia=hc.get(11,!1);Ca=hc.get(12,0);this.imageDimension=hc.get(6,0);this.f$a=vb;this.element.id=Df.tdb();this.element.className=Yc.vwh(this.Nl);Ca&&(this.zIndex=Ca);this.rtl=this.Nl;this.oYf(vb);this.Xxa=this.createElement("div");this.Xxa.className=this.Nia?"prContainerV":"prContainerHr";this.element.appendChild(this.Xxa);this.lGg=Array(this.nIa);for(vb=0;vb<this.nIa;vb++)this.z$[vb]=new Ef(this.createElement("div"),
this.Nd),this.z$[vb].Evb(Object(e.a)(this,this.qOa,"onInteractivityChanged")),this.element.appendChild(this.z$[vb].element)}get H0d(){return F.a.clone(this.Yp)}get z$(){return this.lGg}get l8g(){return this.pvg}get M9d(){return this.imageDimension+2}get width(){return this.Nia?this.M9d:this.f$a}get height(){return this.Nia?this.f$a:this.M9d}Evb(Ca){this.addHandler(wd.GT,Ca)}XIb(Ca){this.removeHandler(wd.GT,Ca)}dispose(){if(this.z$)for(const Ca of this.z$)Ca.XIb(Object(e.a)(this,this.qOa,"onInteractivityChanged")),
Kd.a.YA(Ca);Kd.a.lWf(this.NJ);this.NJ=this.lGg=null;super.dispose()}dfc(){this.CZa();this.a1f();this.visible=!0;this.ZQb=!1}G0c(){!this.NJ||1>this.NJ.length||(this.CZa(),this.visible=!0,this.a1f(),this.y0d(this.NJ[this.NJ.length-1]),this.ZQb=!0)}M0f(){if(this.NJ&&!(1>this.NJ.length)){this.visible=!0;this.a1f();var Ca=0;for(const vb of this.NJ)this.y0d(vb,Ca++);this.ZQb=!1;this.Xvc=!0}}hide(){this.visible=!1;this.CZa();for(let Ca=0;Ca<this.NJ.length;Ca++)this.NJ[Ca].hide();this.ZQb=!1}dnh(){if(!this.Xvc)return!1;
let Ca=0;for(const vb of this.z$)vb.visible&&Ca++;return this.Xvc=0<Ca&&(this.Yp.length<=this.nIa?Ca===this.Yp.length:Ca===this.nIa)}yda(Ca){if(!(0>=this.nIa)){Ca.clientId||(Ca.clientId=(Df.Cpc++).toString());if(Ca.clientId in this.lcd){var vb=this.Jzb(Ca.clientId);if(0<=vb){vb=this.Yp[vb];if(vb.color===Ca.color&&vb.userName===Ca.userName)return;this.s2a(Ca.clientId)}}vb=this.dnh();var hc=0;if(this.Yp.length<this.nIa){var Nc=new Ue(this.createElement("div"),this.Nd,Ca);Nc.Evb(Object(e.a)(this,this.qOa,
"onInteractivityChanged"));this.Nl&&!this.Nia&&0<this.Yp.length?this.Xxa.insertBefore(Nc.element,this.Xxa.firstChild):(this.Xxa.appendChild(Nc.element),hc=this.NJ.length);Array.add(this.NJ,Nc)}else this.Nl&&!this.Nia?Nc=this.NJ[0]:(hc=this.NJ.length-1,Nc=this.NJ[hc]),Nc.yda(Ca);Nc.show();this.lcd[Ca.clientId]=Nc;Array.add(this.Yp,Ca);this.uij(Nc,hc);vb&&this.M0f()}}s2a(Ca){const vb=this.dnh();vb&&this.CZa();this.YXc(Ca);this.Yp.length>=this.nIa&&this.NJ.length<this.nIa&&this.ijn();0>=this.Yp.length?
this.hide():vb&&this.M0f()}Pti(){}YXc(Ca){var vb=this.Jzb(Ca);0>vb||(Ca=this.Yp[vb],Array.removeAt(this.Yp,vb),vb=this.lcd[Ca.clientId],delete this.lcd[Ca.clientId],vb.s2a(Ca.clientId),this.uij(vb),0>=vb.f1a&&(this.Xxa.removeChild(vb.element),Array.remove(this.NJ,vb),vb.dispose()))}ijn(){var Ca=this.SDl();!Ca||1>=Ca.users.length||(Ca=Array.clone(this.Yp),Ca.forEach(vb=>{this.YXc(vb.clientId)}),Ca.forEach(vb=>{this.yda(vb)}))}Jzb(Ca){for(let vb=0;vb<this.Yp.length;vb++)if(this.Yp[vb].clientId===Ca)return vb;
return-1}SDl(){return this.Nl&&!this.Nia?this.NJ[0]:this.NJ[this.NJ.length-1]}position(Ca,vb){this.element.style.top=vb+"px";this.element.style.left=Ca+"px"}a1f(){for(let Ca=0;Ca<this.NJ.length;Ca++)this.NJ[Ca].show()}CZa(){for(let Ca=0;Ca<this.nIa;Ca++)this.z$[Ca].hide();this.Xvc=!1}y0d(Ca,vb=0){if(Ca)if(this.pvg=Ca,this.Nia){const hc=this.imageDimension;if(1<Ca.users.length)this.z$[vb].show(Ca.users,hc,this.height-this.imageDimension);else{const Nc=this.Xxa.children.length;for(let sd=0;sd<this.Xxa.children.length;sd++)Ca.element===
this.Xxa.children[sd]&&this.z$[vb].show(Ca.users,hc,this.height-(Nc-sd)*this.M9d+2)}}else this.z$[vb].show(Ca.users,this.width,0)}qOa(Ca,vb){var hc=Object(v.a)(Ue,Ca);hc=hc?this.WIh(hc):-1;if(2===vb.type||1===vb.type&&-1!==hc&&!this.z$[hc].visible)this.y0d(Ca);else if(1===vb.type)this.CZa(),this.ZQb=!1;else if(3===vb.type){if(this.j8e(vb.In))return;this.ZQb||this.CZa()}this.raiseEvent(wd.GT,vb)}j8e(Ca){Ca=Df.Chf(Ca);let vb=!1;for(const hc of this.z$)if(nd.a.SMa(hc.element,Ca)){vb=!0;break}return this.Xxa!==
Ca&&nd.a.SMa(this.Xxa,Ca)||vb}uij(Ca,vb=0){const hc=this.O$l(Ca);hc&&0>=Ca.f1a?this.z$[vb].hide():hc?this.y0d(Ca):this.z$[vb].hide()}WIh(Ca){let vb=0;for(const hc of this.NJ){if(Ca===hc)return vb;vb++}return-1}O$l(Ca){const vb=this.WIh(Ca);return!!this.l8g&&Ca===this.l8g&&-1!==vb&&this.z$[vb].visible}oYf(Ca){this.nIa=Ca===this.imageDimension?1:Math.floor(Ca/this.M9d);this.Nia?(this.element.style.height=Ca+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=Ca+"px",this.element.style.height=
this.imageDimension+"px")}static tdb(){return String.format("{0}-{1}","presencetooltip",Df.Cpc++)}static Chf(Ca){Ca=Ca.Ib.rawEvent;return Ca.relatedTarget||Ca.toElement}}Df.Cpc=0;Object(l.a)(Df,"PresenceTooltipControl",Yc,[1097,10]);class Sf{constructor(Ca){this.Nd=Ca;this.Nd.GJa(10,ak.a.instance);this.Nd.GJa(9,jh.a.instance);this.Nd.GJa(6,16);this.Nd.GJa(13,ci.a.instance)}U_e(Ca){return new Df(Ca,16,this.Nd)}}Object(l.a)(Sf,"PresenceTooltipFactory",null,[1096]);var Se=c(269),Ii=c(101),hg=c(60),Fg=
c(5),qf=c(6),Cg=c(21),Hh=c(90),aj=c(535),df=c(307),ld=c(123);class dj extends Sys.EventArgs{constructor(Ca,vb){super();this.paragraphId=Ca;this.htm=vb}}Object(l.a)(dj,"PresenceControlRenderedEventArgs",Sys.EventArgs,[]);class Yh extends Yc{constructor(Ca,vb,hc,Nc,sd,Id=null,We=null){super(null);this.bcd=this.Nm=null;this.KQc=!1;this.Ooa=0;this.ep=Ca;this.Wwc=vb;this.Ir=hc;this.Ni=Nc;this.xGa=sd;Yh.iqb=0;this.Dch=new Ea.a;this.zTi=new Ea.a;this.zV=Id;this.Oa=We;this.wFj=this.Oa.rc("PresenceIpRenderedFloodgateTimeLapseSec",
30);this.$Zj=this.Oa.rc("PresenceIpRenderedFloodgateTriggerThreshold",3);this.Cpa=0}get V0a(){return u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")}h8j(Ca){this.addHandler("CR",Ca)}iQi(Ca){this.removeHandler("CR",Ca)}T2d(){this.raiseEvent("CR",new dj(this.ep.ip.paragraphId,this.KQc))}kBf(){if(Object(ld.a)(Tg,this.Nm)){const Ca=Object(v.a)(Tg,this.Nm);Yh.iqb=0<Yh.iqb?Yh.iqb+1:Ca.mXa+1;Ca.zIndex=Yh.iqb;this.element.style.zIndex=String(Yh.iqb)}}izn(){if(Object(ld.a)(Tg,this.Nm)){const Ca=
Object(v.a)(Tg,this.Nm);Yh.iqb=Ca.mXa;Ca.zIndex=Ca.mXa;this.element.style.zIndex=String(Ca.mXa)}}Hoi(){this.zV&&!this.Ldo()&&this.zV.continueWith(()=>{this.zV.result.logActivity("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",this.wFj)&&this.Cpa++})}Ldo(){return this.Cpa>=this.$Zj}static Xni(){Yh.YFg||(Yh.YFg=!0,h.ULS.sendTraceTag(4006594,302,50,"First presence ip rendered on the page"))}static tdb(Ca){return Yh.S0l+Ca.cTh()}}Yh.yHi="data-presence-control";Yh.BDi="OverlayControlElementOwner";
Yh.S0l="ipId_";Yh.zHi="WacPresence";Yh.R2m="PresenceIpPaddingDiv";Yh.YFg=!1;Yh.iqb=0;Object(l.a)(Yh,"APresenceControl",Yc,[1272,10]);class Nl{constructor(){this.rotation=this.height=this.width=this.top=this.left=0;this.k3a=!1}}Object(l.a)(Nl,"PresenceImageControlStyle",null,[1271]);class ij extends Yh{constructor(Ca,vb,hc,Nc,sd,Id=null,We=null){super(Ca,vb,hc,Nc,sd,Id,We);this.kO=()=>{this.Xsi();return!1};this.bZd=Fd=>{this.Nm&&3===Fd.ig&&(2!==this.Ooa?(this.kBf(),this.fLb()):this.Xsi());return!1}}s2a(Ca){this.Nm&&
this.Nm.s2a(Ca)}Nde(){return this.Nm?this.Nm.H0d.length:0}updatePosition(Ca){if(this.element&&this.element.parentNode){var vb=this.DTh(Ca);if(vb){var hc=Sys.UI.DomElement.getBounds(this.element.parentNode),Nc,sd;({left:hc,top:Nc,height:sd,width:vb}=this.oGl(vb,hc,this.element.parentNode,this.Ni.instance));this.element.style.top=Nc+"px";this.element.style.left=hc+"px";this.element.style.height=sd+"px";this.element.style.width=vb+"px";hc=this.JTh(Ca);Oc.a.IX(this.element,hc);Ca=this.lff(Ca,this.ep.ip.shapeId);
this.g2i(hc,vb,this.isSelected(Ca),u.AFrameworkApplication.isRtl);this.fLb()}}}VA(){this.element&&(nd.a.Nu(this.element),this.Nm.s2a(this.ep.user.clientId),this.T2d())}lrh(Ca,vb,hc,Nc){vb=new Nl;if(!Nc||!hc)return vb;hc=this.DTh(Ca);if(!hc)return vb;vb.top=hc.y;vb.left=hc.x;vb.height=hc.height;vb.width=hc.width;vb.rotation=this.SIl(Ca);vb.k3a=!0;return vb}bRi(Ca,vb,hc,Nc){Yh.Xni();this.bcd=Ca;if(Nc){const sd=this.lff(Ca,this.ep.ip.shapeId);if(!sd)return;const Id=!this.element;Id&&this.X_e(vb.ownerDocument,
Ca);Id||!this.element.parentNode?sd.appendChild(this.element):this.element.parentNode!==sd&&(this.element.parentNode.removeChild(this.element),sd.appendChild(this.element));this.Nm.yda(this.ep.user);this.element.style.borderColor=this.ep.user.color;this.element.id=Yh.tdb(this.ep);hc.k3a&&(this.element.style.height=hc.height+"px",this.element.style.top=hc.top+"px",this.element.style.left=hc.left+"px",this.element.style.width=hc.width+"px",Oc.a.IX(this.element,hc.rotation),Oc.a.IX(this.Nm.element,-1*
hc.rotation),this.g2i(hc.rotation,hc.width,this.isSelected(sd),u.AFrameworkApplication.isRtl),this.fLb())}this.KQc=!Nc;this.T2d()}SIl(Ca){return this.element&&this.element.parentNode&&this.FZh(Oc.a.getTransform(this.element.parentNode))?this.FZh(Oc.a.getTransform(this.element)):this.JTh(Ca)}FZh(Ca){return Ca&&-1<Ca.indexOf("deg")&&(Ca=parseInt(Ca.substring(Ca.indexOf("(")+1,Ca.indexOf("deg"))),!isNaN(Ca))?Ca:0}Vhj(Ca){this.element.style.borderColor=this.ep.user.color;this.element.id=Yh.tdb(this.ep);
this.updatePosition(Ca)}X_e(Ca,vb){this.element=Ca.createElement("div");this.element.setAttribute(Yh.yHi,!0);Ii.a.yl(this.element,Yh.BDi,this);this.element.className=ij.x$m;u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoopsCoAuthSelectionIssueFixIsEnable",!1)&&(Ca=vb.zb)&&Ca.EP&&(this.element.style.pointerEvents="none");this.element.dir=u.AFrameworkApplication.isRtl?"rtl":"ltr";this.Nm=this.Wwc.U_e(this.createElement("div"),!0);this.Nm.yda(this.ep.user);
this.Nm.hide();this.Ir.mb(pb.a.pointerOut,this.Nm.element,this.kO);this.Ir.mb(pb.a.pointerDown,this.Nm.element,this.bZd);this.Nm.element.classList.add(Yh.zHi);this.element.appendChild(this.Nm.element)}oGl(Ca,vb,hc,Nc){let sd=Ca.y,Id=Ca.x,We=Ca.height;Ca=Ca.width;(1<Math.abs(vb.width-hc.offsetWidth)||1<Math.abs(vb.height-hc.offsetHeight))&&Nc&&(sd=Math.round(sd/Nc.vj),Id=Math.round(Id/Nc.vj),We=Math.round(We/Nc.vj),Ca=Math.round(Ca/Nc.vj));return{left:Id,top:sd,height:We,width:Ca}}isSelected(Ca){return Ca.classList.contains(df.a.f0b)}g2i(Ca,
vb,hc,Nc){this.Nm.element.style.left="auto";this.Nm.element.style.top="auto";this.Nm.element.style.right="auto";this.Nm.element.style.bottom="auto";hc=hc?Math.round(.5*ij.Noa)+ij.Nbo:0;0<=Ca&&90>Ca||360===Ca?(this.Nm.element.style.top=-.5*ij.Noa-hc+"px",Nc?this.Nm.element.style.right=vb-.5*ij.Noa+"px":this.Nm.element.style.left=vb-.5*ij.Noa+"px"):90<=Ca&&180>Ca?(this.Nm.element.style.left=-.5*ij.Noa-hc+"px",Nc?this.Nm.element.style.bottom=-.5*ij.Noa+"px":this.Nm.element.style.top=-.5*ij.Noa+"px"):
180<=Ca&&270>Ca?(this.Nm.element.style.bottom=-.5*ij.Noa-hc+"px",Nc?this.Nm.element.style.left=vb-.5*ij.Noa+"px":this.Nm.element.style.right=vb-.5*ij.Noa+"px"):(this.Nm.element.style.right=-.5*ij.Noa-hc+"px",Nc?this.Nm.element.style.top=-.5*ij.Noa+"px":this.Nm.element.style.bottom=-.5*ij.Noa+"px")}ai(Ca,vb){const hc=this.g3b(Ca,vb);return hc?hc.properties:(Ca=this.ITh(Ca,vb))?Ca.properties:null}lff(Ca,vb){var hc=this.g3b(Ca,vb);return hc&&(hc=hc.XYa(Ca.Ng))?hc.element:(vb=this.ITh(Ca,vb))?Object(v.a)(aj.a,
vb).Be(Ca.Sb).htmlElement:null}g3b(Ca,vb){Ca=Hh.i(Ca.zb,5);for(const hc of Ca)if(hc.properties.getValue(Fg.a.Zyb)===vb)return hc;return null}ITh(Ca,vb){Ca=qf.GraphIterator.Za(Ca.zb);let hc=Ca.Pb(6);for(;hc;){const Nc=hc.properties.getValue(Fg.a.Zyb);if(Cg.ImageReader.Ov(hc)&&Nc===vb)return hc;hc=Ca.yf(6)}return null}Uwl(Ca){const vb=hg.a.uf(Cg.ImageReader.mE(Ca),0);Ca=hg.a.uf(Cg.ImageReader.AF(Ca),1);return{Oha:vb,CZl:Ca}}JTh(Ca){Ca=this.ai(Ca,this.ep.ip.shapeId);return Cg.ImageReader.AZ(Ca)}DTh(Ca){var vb=
this.ep.ip;if(!vb||!vb.shapeId)return null;var hc=this.ai(Ca,vb.shapeId);const Nc=this.lff(Ca,vb.shapeId);if(!hc||!Nc)return null;const sd=Cg.ImageReader.ul(hc);let Id=Ca=1,We;({Oha:vb,CZl:We}=this.Uwl(hc));fb.App.instance&&fb.App.instance.eua(sd)?(hc=Cg.ImageReader.zla(hc),Ca=hg.a.uf(hc[0],0),Id=hg.a.uf(hc[2],1)):hc.hasProperty(Fg.a.t3)?(hc=hc.getValue(Fg.a.t3),Ca+=hg.a.uf(hc[0],0),Id+=hg.a.uf(hc[2],1)):(Ca+=0<Nc.offsetWidth?(Nc.offsetWidth-vb)/2:2,Id+=0<Nc.offsetHeight?(Nc.offsetHeight-We)/2:2);
return new Sys.UI.Bounds(Math.round(Ca),Math.round(Id),Math.round(vb),Math.round(We))}Xsi(){this.Nm&&(this.Nm.dfc(),this.Ooa=1)}fLb(){for(const Ca of this.Nm.H0d)if(Ca.clientId===this.ep.user.clientId&&!Ca.equals(this.ep.user)){this.Nm.yda(this.ep.user);break}if(this.ep.hQa||2===this.Ooa)this.Nm.G0c(),this.ep.hQa=!1,this.ep.uaa=!0,this.Ooa=2;this.ep.uaa&&1!==this.Ooa||(this.Nm.dfc(),this.ep.uaa=!0,this.Ooa=1)}}ij.x$m="WACImgPresenceHighlight";ij.Noa=20;ij.Nbo=6;Object(l.a)(ij,"PresenceImageControl",
Yh,[]);var ck=c(293);class Mk{constructor(){this.height=this.top=this.left=this.bbi=0;this.k3a=!1;this.Zz=this.rh=null}}Object(l.a)(Mk,"PresenceIpControlStyle",null,[1271]);var Wf=c(75);class cg extends Yh{constructor(Ca,vb,hc,Nc,sd,Id=null,We=null,Fd=null){super(Ca,vb,hc,Nc,sd,Id,We);this.dwc=this.ZSa=this.rVb=null;this.tX=Ff=>{!this.Nm||this.V0a&&!this.Nm.j8e(Ff)||(this.kBf(),this.L5d(Ff));this.Vhj(this.bcd);return!1};this.kO=()=>{this.Nm&&this.kQ();return!1};this.bZd=Ff=>{this.Nm&&3===Ff.ig&&(2!==
this.Ooa?(this.kBf(),this.L5d(Ff)):this.kQ());return!1};this.yC=Fd}X_e(Ca){this.element=Ca.createElement("div");this.element.setAttribute(Yh.yHi,!0);Ii.a.yl(this.element,Yh.BDi,this);this.element.className=Yh.R2m;this.element.dir=u.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ir.mb(pb.a.pointerOver,this.element,this.tX);this.V0a&&(this.Ir.mb(pb.a.pointerOut,this.element,this.kO),this.Ir.mb(pb.a.pointerDown,this.element,this.bZd));this.ZSa=this.createElement("div");this.ZSa.className=cg.y$m;this.V0a||
(this.dwc=this.createElement("div"),this.dwc.className=cg.B$m,this.ZSa.appendChild(this.dwc));this.Nm=this.Wwc.U_e(this.createElement("div"),this.V0a);Ca=this.Oa.$("NoPresenceUserLookUpBeforeRender");this.yC&&!Ca&&(this.ep.user=this.yC.xpi(this.ep.user.clientId)||this.ep.user);this.Nm.yda(this.ep.user);this.Nm.hide();this.Nm.element.classList.add(this.V0a?Yh.zHi:cg.f6m);this.ZSa.appendChild(this.Nm.element);this.element.appendChild(this.ZSa)}wUk(){this.rVb&&(Xa.a.instance.Ye(this.rVb),this.rVb=null)}fLb(Ca){for(var vb of this.Nm.H0d)if(vb.clientId===
this.ep.user.clientId&&!vb.equals(this.ep.user)){this.Nm.yda(this.ep.user);break}vb=!1;cg.ASk===this.ep.user.color?({value:vb}=this.Dch.Bc(this.ep.user.clientId,!1),vb||(this.Dch.Z(this.ep.user.clientId,!0),h.ULS.sendTraceTag(17954772,302,50,'{ "ClientID" : "'+this.ep.user.clientId+'" , "Event" : "RenderGrayPawn"}'))):({value:vb}=this.zTi.Bc(this.ep.user.clientId,!1),vb||(this.zTi.Z(this.ep.user.clientId,!0),h.ULS.sendTraceTag(17954773,302,50,'{ "ClientID" : "'+this.ep.user.clientId+'" , "Event" : "RenderColoredPawn"}')));
return Ca||this.ep.hQa||2===this.Ooa?(this.Hoi(),this.Nm.G0c(),this.ep.hQa=!1,this.ep.uaa=!0,this.Ooa=2,cg.Aao):this.ep.uaa&&1!==this.Ooa?0:(this.Hoi(),this.Nm.dfc(),this.ep.uaa=!0,this.Ooa=1,cg.zao)}L5d(Ca=null){this.wUk();const vb=this.fLb(!!Ca);this.V0a&&Ca&&Ca.eventName===pb.a.pointerOver||this.XEn(vb)}kQ(){this.Nm&&this.Ooa&&(this.izn(),this.Nm.hide(),this.Ooa=0)}XEn(Ca){this.rVb=new Ga.a(2,1,Ca,()=>{this.rVb=null;this.kQ()},56);Xa.a.instance.fc(this.rVb)}updatePosition(Ca){if(this.element&&
this.element.parentNode){var vb=this.nUh(Ca);if(vb){Ca=Sys.UI.DomElement.getBounds(this.element.parentNode);vb=new Sys.UI.Bounds(vb.x-Ca.x,vb.y-Ca.y,cg.ebi,vb.height);var hc;({left:Ca,top:vb,height:hc}=this.rGl(vb,Ca,this.element.parentNode,this.Ni.instance));this.element.style.height=2*cg.Gac+hc+"px";this.element.style.top=vb-cg.Gac+"px";this.element.style.left=Ca-cg.Gac+"px";this.ZSa.style.height=Math.max(cg.Msi,hc)+"px";this.L5d()}}}VA(){this.element&&(nd.a.Nu(this.element),this.T2d())}lrh(Ca,
vb,hc,Nc,sd){const Id=new Mk;if(!Nc||!hc)return Id;Nc=this.nUh(Ca);if(!Nc)return Id;var We=hc;hc=Ca;if(Ca.Vj){var Fd=Ca.Yb;We=Ca.Ag.W3b(this.ep.ip.v7.cp);0>We&&0==We;Ca.Yb.$ta?nd.a.SMa(Fd.editingElement,Ca.Ag.Ji.J(We))||(hc=Ca.source.Ii(Wf.InteractiveViewManager.instance.yd.Sb),vb=hc.Ag.Ji.J(We)):vb=hc.Ag.Ji.J(We);We=vb.getBoundingClientRect()}We=new Sys.UI.Bounds(Nc.x-We.x,Nc.y-We.y,cg.ebi,Nc.height);Ca=We.y;Nc=We.x;We=We.height;Fd=this.Ni.instance;sd&&Fd&&(sd=Fd.vj,Ca=Math.round(Ca/sd),Nc=Math.round(Nc/
sd),We=Math.round(We/sd));Id.top=Ca-cg.Gac;Id.left=Nc-cg.Gac;Id.height=2*cg.Gac+We;Id.bbi=Math.max(cg.Msi,We);Id.k3a=!0;Id.rh=vb;Id.Zz=hc;return Id}bRi(Ca,vb,hc,Nc){Yh.Xni();this.bcd=Ca;Ca=hc.rh;vb=hc.Zz;if(Ca&&vb){if(Nc){const sd=!this.element;sd&&this.X_e(Ca.ownerDocument);sd||!this.element.parentNode?Ca.appendChild(this.element):this.element.parentNode!==Ca&&(this.element.parentNode.removeChild(this.element),Ca.appendChild(this.element));this.bcd=vb;Ca=this.ep.user.color;this.ZSa.style.borderColor=
Ca;this.V0a||(this.dwc.style.borderColor=Ca);this.element.id=Yh.tdb(this.ep);hc.k3a&&(this.element.style.height=hc.height+"px",this.element.style.top=hc.top+"px",this.element.style.left=hc.left+"px",this.ZSa.style.height=hc.bbi+"px",this.L5d())}this.KQc=!Nc;this.T2d()}else h.ULS.sendTraceTag(520950942,302,50,`Skip IpControl rendering due to paragraphElement is null:${!Ca} or paragraphViewElement is null:${!vb}`)}dispose(){this.element&&(this.VA(),this.Ir.sc(pb.a.pointerOver,this.element,this.tX),
this.V0a&&(this.Ir.sc(pb.a.pointerOut,this.element,this.kO),this.Ir.sc(pb.a.pointerDown,this.element,this.bZd)),Kd.a.YA(this.Nm),this.element=this.Nm=null);super.dispose()}Vhj(Ca){const vb=this.ep.user.color;this.ZSa.style.borderColor=vb;this.V0a||(this.dwc.style.borderColor=vb);this.element.id=Yh.tdb(this.ep);this.updatePosition(Ca)}rGl(Ca,vb,hc,Nc){let sd=Ca.y,Id=Ca.x;Ca=Ca.height;(1<Math.abs(vb.width-hc.offsetWidth)||1<Math.abs(vb.height-hc.offsetHeight))&&Nc&&(sd=Math.round(sd/Nc.vj),Id=Math.round(Id/
Nc.vj),Ca=Math.round(Ca/Nc.vj));return{left:Id,top:sd,height:Ca}}nUh(Ca){const vb=this.ep.ip;if(!vb)return null;let hc;try{const Nc=vb.v7.cp;hc=ck.a.eZ(Nc,Ca,0<Nc,!1,!1,!1)}catch(Nc){h.ULS.sendTraceTag(4301318,302,15,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",Xa.a.instance.hv,Nc.message,Nc.stack),hc=null}return hc}}cg.f6m="WacPawn";cg.ebi=2;cg.zao=7E3;cg.Aao=2E3;cg.Gac=5;cg.y$m="presenceIp";cg.B$m="PresenceSmallBox";cg.Msi=10;cg.ASk="0xcccccc";Object(l.a)(cg,"PresenceIpControl",
Yh,[]);class bl{constructor(Ca,vb,hc,Nc,sd=null,Id=null,We=null){this.Mlc={};this.Klc={};this.rzg={};this.Wwc=Ca;this.Ir=vb;this.Om=hc;this.xGa=Nc;this.zV=sd;this.Oa=Id;this.yC=We}get hRk(){return this.Mlc}get Ixh(){return this.Klc}nGl(Ca){const vb=!!this.Oa&&this.Oa.$("PeoplesWellExtraButtonInfoIsEnabled");return Ca.ip.shapeId&&vb?this.sGl(Ca):this.tGl(Ca)}sGl(Ca){const vb=Ca.ip.shapeId.toString();this.rzg[Ca.user.clientId]=vb;const hc=this.Klc[vb];return hc?(hc.ep=Ca,{returnValue:hc,Lde:!0}):{returnValue:this.Klc[vb]=
new ij(Ca,this.Wwc,this.Ir,this.Om,this.xGa,this.zV,this.Oa),Lde:!1}}tGl(Ca){const vb=Ca.user.clientId,hc=this.Mlc[vb];return hc&&hc.ep.user.equals(Ca.user)?(hc.ep=Ca,{returnValue:hc,Lde:!0}):{returnValue:this.Mlc[vb]=new cg(Ca,this.Wwc,this.Ir,this.Om,this.xGa,this.zV,this.Oa,this.yC),Lde:!1}}oUh(Ca){return this.Mlc[Ca]}Pwl(Ca){return(Ca=this.Klc[this.rzg[Ca]])&&!Ca.Nde()?Ca:null}EZk(){var Ca=this.Mlc;for(const vb in Ca)Ca[vb].dispose();Ca=this.Klc;for(const vb in Ca)Ca[vb].dispose()}}Object(l.a)(bl,
"PresenceControlProvider",null,[]);var tl=c(159);class ki{constructor(){this.c9a=0}fWh(){this.c9a++;this.c9a===Number.MAX_VALUE&&(this.c9a=1);return this.c9a}static get instance(){return ki.htc}}ki.htc=new ki;Object(l.a)(ki,"PacketIdGenerator",null,[728]);var ul=c(1069);class Cf{constructor(Ca,vb,hc){this.kFn=Ca;this.p2l=vb;this.qli=hc}}Object(l.a)(Cf,"SuccessfulInboundReplicationCallbackData",null,[]);class gm{constructor(Ca,vb,hc,Nc,sd,Id,We){this.NCn=(Fd,Ff)=>{Ff.type||(Fd=this.Zj.TDh>=this.MDj,
this.sZj&&Fd?(Fd=this.gre())?Fd.JFh():h.ULS.sendTraceTag(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.kE())};this.k_m=Fd=>{if(Fd=Object(v.a)(Cf,Fd)){var Ff=Fd.p2l.ri.toString(),Ac=this.gre(),Qi=Ac.ku,Tc="";Qi!==Fd.qli&&(h.ULS.sendTraceTag(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",Fd.kFn.toString()),Tc=this.YBl(Ac,Qi,Fd.qli));h.ULS.sendTraceTag(19964237,500,50,"Revisions: {0}, InboundDuration: {1}",
Tc,Ff)}else h.ULS.sendTraceTag(19964235,500,10,"The callback data was null")};this.FCn=Ca;this.gre=vb;this.Zj=hc;this.sZj=sd;this.MDj=Id;this.gSb=Nc;this.kq=We;this.FCn.B5(this.NCn)}kE(){const Ca=this.gre();if(!Ca)h.ULS.sendTraceTag(19682514,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");else if(!this.gSb()&&Ca.DNa){let vb=-1;Object(ld.a)(ul.a,Ca)&&(vb=Ca.Xj.jEa());const hc=this.kq.jg("Task","ShoulderTapInboundReplicationTimer");Ca.kE(this.k_m,null,new Cf(vb,
hc,Ca.ku))}}YBl(Ca,vb,hc){const Nc=new Sys.StringBuilder;Ca=Ca.node.Ad.store.getRevision(vb);if(!Ca)return h.ULS.sendTraceTag(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{["lastRevisionId"]:vb}),"";for(Nc.append(Ca.id.Vs);vb!==hc;){Nc.append(", ");Nc.append(vb.Vs);Ca=Ca.hl;if(!Ca)break;vb=Ca.id}return Nc.toString()}}Object(l.a)(gm,"ContentNotificationManager",null,[]);class zd extends gm{constructor(Ca,vb,hc,Nc,sd,Id,We){super(Ca,vb,hc,Nc,sd,Id,We)}static get EPa(){return null!=
zd.brg?zd.brg:zd.brg=oa.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}static init(){if(fb.App.xa){var Ca=fb.App.xa.jb;Ca&&(Ca.zda(zd.mTc),Ca=Ca.Xc)&&(zd.Wu=Ca.contentReplicator,zd.Wu&&fb.App.Ula().continueWith(zd.sGf))}}static sGf(){zd.f8c=fb.App.Ula().result;zd.f8c&&zd.f8c.Pp&&zd.EPa.CI().continueWith(zd.XTc)}static XTc(){zd.ij=zd.EPa.CI().result;if(zd.ij){var Ca=u.AFrameworkApplication.K,vb=Ca.$("Box4ThrottleInboundRequests");Ca=Ca.rc("Box4ThrottleInboundsAtUserCount",20);zd.Wu.eId=()=>
zd.ij.SNa;zd.c8c=zd.c8c||new zd(zd.ij,()=>zd.Wu,zd.f8c,()=>u.AFrameworkApplication.Tk,vb,Ca,fb.App.xa.lq);zd.c8c.kE()}}static mTc(Ca){zd.c8c||(Ca.Tjb(zd.mTc),zd.init())}}zd.c8c=null;zd.ij=null;zd.Wu=null;zd.f8c=null;Object(l.a)(zd,"WordContentNotificationManager",gm,[]);class dk{constructor(Ca,vb,hc,Nc,sd,Id){this.Y8c=null;this.yXg=Ca;this.ud=hc;this.rIa=Nc;this.hA=sd;this.hh=Id;this.tNb=vb}clone(){return new dk(this.yXg,this.tNb.clone(),this.ud,this.rIa,this.hA,this.hh)}get cp(){if(null!=this.Y8c)return this.Y8c;
var Ca=this.yXg.paragraphId;if(Ca.equals(ee.a.nil))return 0;var vb=this.rIa();if(!vb)return 0;Ca=vb.Db(Ca);if(!Ca)return h.ULS.sendTraceTag(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;vb=this.ud.Jxb(this.ud.EOa(Ca.characterData,Ca.qa),this.tNb);if(this.hA&&this.hh&&Ca.yw){const hc=vc.a.Uc(Ca,vb);hc.Fb=this.hh.lgf(Ca,vb,this.tNb.hAa);vb=this.hA.aea(hc,!0)}return vb}vIf(){null==this.Y8c&&(this.Y8c=this.cp)}equals(Ca){return Ca?this.tNb.isEqual(Ca.tNb,!1):!1}}Object(l.a)(dk,
"WordPresenceCp",null,[741,77,742]);class Bj{constructor(Ca,vb){this.hA=Ca;this.hh=vb}create(Ca,vb,hc,Nc){return new dk(Ca,vb,hc,Nc,this.hA,this.hh)}}Object(l.a)(Bj,"Factory",null,[730]);var tj=c(522);class mk extends Sys.EventArgs{constructor(Ca,vb,hc){super();this.paragraphId=Ca;this.presence=vb;this.ypf=hc}}Object(l.a)(mk,"ParagraphChangedEventArg",Sys.EventArgs,[]);class Tm{constructor(Ca){this.cp=Ca}equals(Ca){return Ca?this.cp===Ca.cp:!1}clone(){return new Tm(this.cp)}}Object(l.a)(Tm,"PresenceCp",
null,[741,77]);class sm{constructor(Ca,vb,hc,Nc,sd){this.paragraphId=Ca;this.cp=vb;this.length=hc;this.shapeId=Nc;this.dryDeletion=sd}}Object(l.a)(sm,"SerializablePresenceIpData",null,[]);class Xl{constructor(Ca,vb,hc,Nc=0,sd=0){this.Jqa=null;Ca&&(this.Jqa=ee.a.Pf(Ca));this.xXg=new Tm(vb);this.LDa=hc;this.b1g=Nc;this.KDg=sd}get paragraphId(){return this.Jqa}get v7(){return this.xXg}get shapeId(){return this.b1g}get dryDeletion(){return this.KDg}Sd(){return 0<=this.v7.cp&&!!this.paragraphId&&!this.paragraphId.equals(ee.a.nil)}getData(){return new sm(this.paragraphId.toString(),
this.v7.cp,this.LDa,this.shapeId,this.dryDeletion)}clone(){const Ca=new Xl;Ca.Jqa=this.paragraphId;Ca.xXg=this.v7?this.v7.clone():null;Ca.LDa=this.LDa;Ca.b1g=this.shapeId;Ca.KDg=this.dryDeletion;return Ca}static Mxb(Ca){return Ca.paragraphId&&void 0!==Ca.cp&&null!==Ca.cp&&void 0!==Ca.length&&null!==Ca.length?new Xl(Ca.paragraphId,Ca.cp,Ca.length,void 0,Ca.dryDeletion):null}}Object(l.a)(Xl,"PresenceIp",null,[715,77]);class ni{constructor(Ca,vb){this.ip=Ca;this.user=vb}}Object(l.a)(ni,"SerializablePresenceData",
null,[]);class uh{constructor(Ca,vb){this.hQa=this.uaa=this.H9b=!1;this.YSa=vb;this.user=Ca}get ip(){return this.YSa}bif(){return new ni(this.ip?this.ip.getData():null,this.user.getData())}cTh(){return this.user.clientId+(this.YSa?this.YSa.paragraphId.toString():ee.a.nil.toString())}Sd(){const Ca=!!this.user&&this.user.Sd(),vb=!this.ip||this.ip.Sd();return Ca&&vb}clone(){const Ca=new uh;Ca.user=this.user?this.user.clone():null;Ca.YSa=this.YSa?this.YSa.clone():null;Ca.uaa=this.uaa;Ca.H9b=this.H9b;
Ca.hQa=this.hQa;return Ca}static Mxb(Ca){return Ca?new uh(za.Mxb(Ca.user),Ca.ip?Xl.Mxb(Ca.ip):null):null}}Object(l.a)(uh,"PresenceInfo",null,[725,77]);class yh extends Za.a{constructor(){super();this.ttc={};this.BRa={};this.SFg=!1}get U3m(){return this.ttc}get Cgi(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")}dbh(Ca){this.addHandler("PPC",Ca)}PQi(Ca){this.removeHandler("PPC",Ca)}kJc(Ca){return Ca.ip.paragraphId.toString()}XOe(Ca,vb=!1){this.SFg||
(this.SFg=!0,h.ULS.sendTraceTag(4289312,302,50,"First presence added to data manager"));var hc=({z$m:Nc}=this.Mom(Ca)).returnValue;if(Nc&&!vb)(hc=this.BRa[Ca.user.clientId])&&0<=hc.length&&(hc[hc.length-1].ip.LDa=Ca.ip.LDa);else{hc||this.FPi(Ca.user.clientId);this.Cgi&&hc&&this.$lo(Ca);vb=this.kJc(Ca);var Nc=Ca.user.clientId;var sd=this.ttc[vb]||[],Id=this.BRa[Nc]||[];Id.length>=yh.Dri&&(Id=Id.splice(-yh.LPm,yh.Dri));hc||sd.push(Nc);Id.push(Ca);this.ttc[vb]=sd;this.BRa[Nc]=Id;Ca.ip.paragraphId.equals(ee.a.nil)||
this.nQf(Ca.ip.paragraphId,Ca,!0)}}Mom(Ca){var vb=this.BRa[Ca.user.clientId];const hc=!vb||0>=vb.length?null:vb[vb.length-1],Nc=!!hc&&this.kJc(hc)===this.kJc(Ca);vb=Nc&&hc.ip.v7.equals(Ca.ip.v7)&&hc.user.equals(Ca.user);this.Cgi&&vb&&hc.ip.shapeId&&Ca.ip.shapeId&&hc.ip.shapeId!==Ca.ip.shapeId&&(vb=!1);return{returnValue:Nc,z$m:vb}}$lo(Ca){const vb=this.sRk(Ca);vb&&vb.ip.shapeId&&(Ca.ip.shapeId&&Ca.ip.shapeId===vb.ip.shapeId||this.nQf(vb.ip.paragraphId,vb,!1))}sRk(Ca){Ca=this.BRa[Ca.user.clientId];
return!Ca||0>=Ca.length?null:Ca[Ca.length-1]}FPi(Ca){const vb=this.BRa[Ca];if(vb&&0<vb.length){const hc=vb[0].ip.paragraphId,Nc=this.kJc(vb[0]);delete this.BRa[Ca];this.Asn(Nc,Ca);hc.equals(ee.a.nil)||this.nQf(hc,vb[0],!1)}}iPh(Ca){return this.ttc[Ca]}rHc(Ca,vb,hc,Nc=!1){const sd=[],Id=this.iPh(Ca);if(!Id)return sd;for(let We=0;We<Id.length;We++){const Fd=Id[We],Ff=this.BRa[Fd];let Ac=!1;for(let Qi=Ff.length-1;0<=Qi;Qi--){const Tc=Ff[Qi];if(Nc){if(Tc.uaa&&Tc.ip.paragraphId.equals(ee.a.Pf(Ca))){Ac=
!0;sd.push(Tc);break}}else if(Object(ld.a)(uh,Tc)?Tc.ip.LDa===vb:Tc.ip.LDa===hc){Ac=!0;Tc.H9b=!0;sd.push(Tc);this.BRa[Fd]=Ff.splice(Qi,Ff.length);break}}!Ac&&0<Ff.length&&Ff[0].H9b&&Ff[0].ip.paragraphId.equals(ee.a.Pf(Ca))&&sd.push(Ff[0])}return sd}sjl(Ca){if(!Ca||!Ca.Qa||!Ca.Qa.node)return null;Ca=this.rHc(Ca.Qa.node.id.toString(),0,0,!0);Ca=this.oQl(Ca);Ca.sort((vb,hc)=>{if(!(vb&&vb.userName&&hc&&hc.userName))return h.ULS.sendTraceTag(542165082,302,15,"Missing presence user info for user in PresenceInfos"),
0});return Ca}oQl(Ca){if(!Ca||!Ca.length)return[];const vb=[],hc=new tj.a(Pa.a.Sj());for(let Nc=0;Nc<Ca.length;Nc++){const sd=Ca[Nc].user;sd.isAnonymous&&hc.contains(sd.clientId)||!sd.isAnonymous&&sd.email&&hc.contains(sd.email)||(vb.push(sd),hc.add(sd.isAnonymous?sd.clientId:sd.email))}return vb}nQf(Ca,vb,hc){this.raiseEvent("PPC",new mk(Ca,vb,hc))}Asn(Ca,vb){Array.remove(this.ttc[Ca],vb)}}yh.Dri=10;yh.LPm=2;Object(l.a)(yh,"PresenceDataManager",Za.a,[1220]);class ll extends yh{constructor(Ca){super();
this.RD=Ca}XOe(Ca,vb=!1){super.XOe(Ca,vb)}kJc(Ca){return Ca.ip.Nc.toString()}iPh(Ca){Ca=this.RD.Db(ee.a.Pf(Ca));if(!Ca)return null;Ca=Ca.ia(Fg.a.Nc,0);return this.U3m[Ca.toString()]}}Object(l.a)(ll,"WordPresenceDataManager",yh,[]);var dn=c(1436),Gl=c(1030),Ol=c(1778),Bg=c(19);class Ak{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,Tc,uj,oj,ti,Th,di,Nj,im,Hg,ah,Ji,Jh,Dl){this.qJa=Array(5);this.WLe=this._started=this.TGe=!1;this.uDe=null;this.XXg=new tj.a(Pa.a.Sj());this.nid={};this.Kve=!1;this.B3m=()=>
{if(!this.WLe&&!this.fl.Qv){var Bh=new Ga.a(0,1,20,()=>{const Ge=new M.a;var Wd=this.p9a.hRk;for(var Pd in Wd){const rf=Wd[Pd];rf.KQc&&Ge.add(rf.ep.ip.paragraphId)}if(this.JWd){Wd=this.p9a.Ixh;for(const rf in Wd)Pd=Wd[rf],Pd.KQc&&!Ge.contains(Pd.ep.ip.paragraphId)&&Ge.add(Pd.ep.ip.paragraphId)}this.tNh(Ge);this.WLe=!1},72);this.Hb.fc(Bh);this.WLe=!0}};this.Uyi=()=>{this.TGe&&(this.lXf(),this.TGe=!1)};this.n3=(Bh,Ge)=>{this.GYi(Ge.kl.kb)};this.m3=(Bh,Ge)=>{Bh=Ge.HFa;for(var Wd in Bh){const Pd=Bh[Wd];
this.Oa.$("CashTelemetryIsEnabled")&&this.qFc(Pd,new Date,null);Pd.ip?this.POe(Pd):this.ZXc(Pd.user.clientId)}Ge=Ge.Hzd;for(Wd=0;Wd<Ge.length;++Wd)this.iVk(Ge[Wd]);this.k4d()};this.wIf=(Bh,Ge)=>{Ge.paragraphId?this.Yno(Ge.paragraphId.toString(),Ge.htm,this.nid):h.ULS.shipAssertTag(8758481,302,!1,"null paraid")};this.AHi=(Bh,Ge)=>{Ge.paragraphId&&(Bh=this.oC.Db(Ge.paragraphId))&&((Object(ld.a)(uh,Ge.presence)?this.Yqe(Bh):this.Zqe(Bh))===Ge.presence.ip.LDa&&this.dFn(Ge.paragraphId),this.JWd&&this.A$m(Ge))};
this.wv=Ca;this.hb=Nc;this.yC=sd;this.Nsb=Id;this.fl=Ff;this.JDj=Ac;this.p9a=Qi;this.oC=hc;this.OHg=Tc;this.Yqe=uj;this.Zqe=oj;this.hwj=We;this.NDj=Fd;this.lIa=ti;this.Lm=Th;this.Hc=di;this.Hb=Nj;this.l4g=Ji;this.wTj=Dl;this.vDe=Hg;this.Oa=ah;this.Thd=vb;Ak.$id=new Ea.a;for(Ca=0;Ca<this.Thd.length;Ca++)this.Thd[Ca].Won(this);this.Nsb.dbh(this.AHi);this.wv.KVa(this.m3);Jh&&this.fl.Lja(this.B3m);this.wv.y3d(this)}get JWd(){return!!this.Oa&&this.Oa.$("PeoplesWellExtraButtonInfoIsEnabled")}k4d(Ca=!1){this.l4g&&
!Ca||this.YQi()}YQi(){const Ca=new M.a,vb=this.nid;for(const hc in vb)Ca.add(ee.a.Pf(hc));this.tNh(Ca);this.nid={}}lXf(){this.hb.ib&&this.GYi(this.hb.ib.kb,!0)}GYi(Ca,vb=!1){this.wTj||(this.oC.Am.tua||vb?Ca?(vb=this.kOk(Ca))?this.wv.tXf(vb):(this.wv.tXf(null),h.ULS.sendTraceTag(4281418,302,50,"Not supported selection context {0}",Ca.Qa.contextId)):this.wv.tXf(null):this.TGe=!0)}kOk(Ca){if(!this.JWd||!Ca.Wgb)if(Ca=Bg.SelectionEditor.Qj(Ca,!0,!1),!Bg.SelectionEditor.Dm(Ca))return null;return this.Tih(Ca)}Tih(Ca){const vb=
Ca.Qa.cpBegin,hc=Ca.Qa.node.id;Ca=this.Yqe(Ca.Qa.node);return new Xl(hc.toString(),vb,Ca)}qFc(Ca,vb,hc){if(this.vDe)if(Ca&&Ca.user&&Ca.user.clientId){var Nc=Ca.user.clientId;this.XXg.contains(Nc)||(this.uDe?(this.uDe.qFc(Nc,vb,null,Ak.bJl(hc||Ca.user.client)),this.XXg.add(Nc)):this.vDe.continueWith(()=>{this.uDe=this.vDe.result;this.qFc(Ca,vb,hc)}))}else h.ULS.sendTraceTag(42262876,302,15,"invalid presence")}pGl(Ca){const vb=new M.a;for(let hc=0;hc<Ca.length;hc++)vb.add(this.fQl(Ca[hc]));return vb}POe(Ca){var vb=
null;Ca&&Ca.user&&(vb=Ca.user.client);Ca=Ca.clone();Ca.user=this.yC.xpi(Ca.user.clientId)||Ca.user;this.Oa.$("CashTelemetryIsEnabled")&&this.qFc(Ca,new Date,vb);Ca.Sd()&&!Ca.user.UW()&&(vb=Ca.user.clientId,Ak.$id.ub(vb)||this.W3h(vb),this.Lno(vb),Ca.user.userName=CommonUIStrings.l_AnonymousUserName);this.Nsb.XOe(Ca,!1)}Lno(Ca){const {value:vb}=Ak.$id.Bc(Ca,!1);vb||(Ak.$id.Z(Ca,!0),h.ULS.sendTraceTag(17954774,302,50,'{ "ClientID" : "'+Ca+'" , "Event" : "CreateAnonymousGrayPawn"}'))}W3h(){}ZXc(Ca){this.Nsb.FPi(Ca)}iVk(Ca){this.ZXc(Ca);
const vb=this.p9a.oUh(Ca);vb&&(vb.iQi(this.wIf),vb.dispose());this.JWd&&(Ca=this.p9a.Pwl(Ca))&&(Ca.iQi(this.wIf),Ca.dispose())}A3b(Ca){if(12!==Ca.type)return new M.a;Ca=this.Nsb.rHc(Ca.id.toString(),this.Yqe(Ca),this.Zqe(Ca));return 0>=Ca.length?new M.a:this.pGl(Ca)}Yno(Ca,vb,hc){!vb&&Ca in hc&&delete hc[Ca]}dispose(){this.stop();this.Nsb.PQi(this.AHi);this.wv.$Ib(this.m3);this.wv.s8f(this);for(let Ca=0;Ca<this.Thd.length;Ca++)this.Thd[Ca].Xho(this);Kd.a.lWf([this.hwj,this.NDj,this.wv]);this.p9a.EZk()}fQl(Ca){let vb=
!1;Ca=({Lde:vb}=this.p9a.nGl(Ca)).returnValue;vb||Ca.h8j(this.wIf);return Ca}i2h(Ca){Ca=this.oC.Db(Ca);if(!Ca)return this.qJa[0]||(h.ULS.sendTraceTag(4281420,302,50,"Could not find the node in object space"),this.qJa[0]=!0),null;if(!Wa.ParagraphReader.nc(Ca))return this.qJa[1]||(h.ULS.sendTraceTag(4281421,302,50,"Not a paragraph node"),this.qJa[1]=!0),null;if(!Ca.Be(this.fl.Sb))return this.qJa[2]||(h.ULS.sendTraceTag(4281422,302,50,"No ViewElement found for this node"),this.qJa[2]=!0),null;if(!Ca.anchor)return this.qJa[3]||
(h.ULS.sendTraceTag(4281423,302,50,"node is not anchored"),this.qJa[3]=!0),null;this.qJa[4]||(h.ULS.sendTraceTag(4564931,302,50,"Valid paragraph node found for rendering ip"),this.qJa[4]=!0);return Ca}jPi(Ca){Ca=this.Nsb.rHc(Ca.toString(),-1,-1,!0);if(!F.a.lf(Ca))for(const vb of Ca)(Ca=this.p9a.oUh(vb.user.clientId))&&Ca.element&&Ca.VA()}tNh(Ca){if(Ca.count){var vb=new M.a;for(var hc of Ca)(Ca=this.i2h(hc))?vb.add(Ca):this.jPi(hc);if(vb.count){hc=this.Hc.Rc(2);try{hc.set(this.Lm);for(const Nc of vb)this.hCh(Nc)}finally{hc&&
hc.dispose()}}}}hCh(Ca){Ca.fH(this.fl.Sb,32,!0);Ca.fH(this.JDj,32,!0)}dFn(Ca){this.nid[Ca.toString()]=null;this.l4g&&!this.Kve&&(Ca=new Ga.a(0,1,200,()=>{this.Kve=!1;this.YQi()},70),this.Hb.fc(Ca),this.Kve=!0)}A$m(Ca){if(Ca.presence.ip.shapeId&&!Ca.ypf){var vb=this.p9a.Ixh[Ca.presence.ip.shapeId.toString()];vb&&vb.s2a(Ca.presence.user.clientId)}}stop(){this._started&&(this._started=!1,this.hb.Iga(this.n3),this.OHg.HQi(this.Uyi))}start(){if(!this._started){this._started=!0;this.hb.tB(this.n3);this.OHg.NPe(this.Uyi);
var Ca=this.wv.dAb();delete Ca[this.lIa.clientId];this.m3(null,new Ol.a(Ca,[]));this.lXf()}}g9d(Ca){if(Ca&&Ca.Sd()&&Ca.ip){var vb=this.Nsb.rHc(Ca.ip.paragraphId.toString(),-1,-1),hc=!1,Nc=null;for(let sd=0;sd<vb.length;sd++)if(Nc=vb[sd],Nc.user.clientId===Ca.user.clientId){hc=Nc.hQa=!0;break}if(hc)if(vb=Nc.ip.paragraphId,Ca=this.i2h(vb)){vb=this.Hc.Rc(2);try{vb.Eb(Ca),this.hCh(Ca)}finally{vb&&vb.dispose()}}else this.jPi(vb)}}static bJl(Ca){return Ca?Ca?1===Ca?1:2===Ca?2:0:2:0}}Ak.$id=null;Object(l.a)(Ak,
"PresenceManager",null,[1216,10,681,1217,1218,1219]);class ek{constructor(Ca,vb,hc,Nc){this.zPb=null;this._started=this.iue=!1;this.Rub=null;this.ona=(sd,Id)=>{if(!u.AFrameworkApplication.Tk&&(sd=this.Rij(Id.kl),this.zPb&&sd)){sd=this.Qme.rHc(this.zPb.toString(),-1,-1,!0);for(Id=0;Id<sd.length;Id++)this.Rub[sd[Id].user.clientId]=sd[Id];0>=sd.length||(sd=this.ZKk(sd),this.Ep.sendNotification(sd,!0))}};this.CAi=(sd,Id)=>{this.hb.ib&&!u.AFrameworkApplication.Tk&&this.iue&&this.zPb&&this.zPb.equals(Id.paragraphId)&&
(sd=null,!Id.ypf||Id.presence.user.clientId in this.Rub?Id.ypf||(sd=this.jwh(Id.presence.user.userName,!1),delete this.Rub[Id.presence.user.clientId]):(sd=this.jwh(Id.presence.user.userName,!0),this.Rub[Id.presence.user.clientId]=Id.presence),sd&&this.Ep.sendNotification(sd,!0))};this.ij=Nc;this.hb=vb;this.Qme=Ca;this.Ep=hc;this.ij.y3d(this)}start(){this._started||(this._started=!0,this.Rub={},this.Qme.dbh(this.CAi),this.hb.tB(this.ona),this.Rij(this.hb.ib))}stop(){this._started&&(this._started=!1,
this.Rub=null,this.Qme.PQi(this.CAi),this.hb.Iga(this.ona))}ZKk(Ca){if(1===Ca.length)return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,Ca[0].user.userName);const vb=[],hc=Ca.length;for(let Nc=0;Nc<hc;Nc++)vb.push(Ca[Nc].user.userName);return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,vb.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}jwh(Ca,vb){return String.format(vb?Box4Intl.Box4Strings.l_UserJoiningParagraph:Box4Intl.Box4Strings.l_UserLeavingParagraph,
Ca)}dispose(){this.ij.s8f(this);this.stop()}Rij(Ca){if(!Ca)return!1;Ca=Ca.kb;if(!Ca)return!1;Ca=Ca.Qa;if(!Ca)return!1;this.iue=Bg.SelectionEditor.zf(Ca);Ca=Ca.node.id;if(Ca.equals(this.zPb)||!this.iue)return!1;this.zPb=Ca;this.Rub={};return!0}}Object(l.a)(ek,"PresenceAccessibilityManager",null,[10,681]);class tg{constructor(Ca,vb){this._started=!1;this.zJ=null;this.kdd=!1;this.CTc=()=>{this._started&&this.qYi()};this.ij=Ca;vb&&(this.zJ=vb,this.zJ.EVa(this.CTc));this.ij.y3d(this)}start(){this._started||
(this._started=!0,this.zJ?this.qYi():this.ij.rO(1,this.Tuh()))}qYi(){const Ca=this.kdd;(this.kdd=!!this.zJ.Uy)&&!Ca&&this.ij.rO(1,this.Tuh())}Tuh(){const Ca={};Ca.Id="{"+u.AFrameworkApplication.userSessionId.toUpperCase()+"}";Ca.HQ=!1;Ca.NT=1;Ca.WEB=!0;return Ca}stop(){this._started&&(this._started=this.kdd=!1)}dispose(){this.ij.s8f(this);this.zJ&&this.zJ.kQi(this.CTc)}}Object(l.a)(tg,"EditorsTableNotifier",null,[10,681]);var Be=c(390),ai=c(18);class Zd extends Ak{constructor(Ca,vb,hc,Nc,sd,Id,We,
Fd,Ff,Ac,Qi,Tc,uj,oj,ti,Th,di,Nj,im,Hg,ah,Ji,Jh,Dl,Bh,Ge,Wd,Pd,rf,ie,rd){super(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,uj,oj,ti,Th,im,Hg,ah,Ji,Jh,Dl,Bh,Ge,rf);this.Zj=null;this.c2k=Nk=>{const bh=!!this.Zj.bB.E2b(Nk);h.ULS.sendTraceTag(579179741,302,50,"ClientId:{0} isPresentAfterPoll:{1}",Nk,bh)};this.b2k=(Nk,bh)=>{h.ULS.sendTraceTag(579179742,302,15,"EditorsReplicator failed with {0} when looking for ClientId {1}",bh,Nk)};this.iga=()=>{u.AFrameworkApplication.Ne("5815j879;igh2e666");if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnabledWordRTCTokenRefresh",
!1)&&2===Zd.ij.connectionState&&!ba.SessionStatusManager.instance.PZ){const Nk={};Nk.qs=u.AFrameworkApplication.rootQuerySignature;Zd.ij.ymb(Nk)}};Tc.gb(ai.a.J_n,Bb.a.application,Zd.G5j,64);Tc.gb(ai.a.SSf,Bb.a.application,Zd.SSf,64);Tc.gb(ai.a.LPf,Bb.a.application,Zd.LPf,96);Tc.gb(Kb.a.g9d,Bb.a.application,Zd.I_n,64);this.TH=di;this.ud=Nj;this.evb=Wd;this.lIa.sbc=Pd;this.lIa.sbc.i$j(Zd.DAi);ie.continueWith(()=>{this.Zj=ie.result});h.ULS.sendTraceTag(4006600,302,50,"WordPresenceManager Initialized");
(this.l1=rd)&&this.l1.execute(Nk=>{Nk.JVa(this.iga)})}ABa(Ca){if(!Ca||!Ca.anchor)return null;for(Ca=Ca.anchor.mr;Ca;Ca=Ca.Wz)if(Ca.CCa)return Ca.zr.node;return null}Tih(Ca){var vb=null;vb=u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled");var hc=Ca.Qa.cpBegin,Nc=Ca.Qa.node;vb&&Cg.ImageReader.Ov(Nc)&&(Nc=this.ABa(Nc));if(!Nc)return h.ULS.sendTraceTag(51242309,302,15,"selectedNode is null"),null;Nc=this.Zqe(Nc);const sd=Ca.Qa.node.ia(Fg.a.Nc,0);if(!this.TH)return h.ULS.sendTraceTag(35997152,
302,15,"paragraphWordIdMapping is null"),null;var Id=this.TH.value.keb(sd);const We=Zd.RD.Db(Id);if(!We)return h.ULS.sendTraceTag(16791249,302,15,"Can't find pid "+Id),null;hc=this.ud.yic(this.ud.EOa(We.characterData,We.qa),hc);hc.hAa=-1===Ca.Qa.Fb?0:Ca.Qa.Fb;Id=0;vb&&Ca.Wgb&&(Id=this.KKl(Ca));return vb=new Qf(this.TH.value,sd,Nc,hc,this.ud,()=>Zd.RD,this.evb,Id)}KKl(Ca){const vb=Cg.ImageReader.tBa(Ca.Qa);return vb?vb.properties.ia(Fg.a.Zyb,0):Ca.Qa.node.properties.ia(Fg.a.Zyb,0)}W3h(Ca){this.Zj&&
this.Zj.Vka&&this.Zj.Vka.kE(this.c2k,this.b2k,Ca)}dispose(){this.l1&&this.l1.execute(Ca=>{Ca.ZIb(this.iga)});super.dispose()}static get lw(){return oa.a.instance.resolve("Common.Utils.IAriaNotifier")}static CI(){return Zd.Dpc.task}static get_instance(){return Zd.Zid.task}static uGl(){return Zd.zXg.task}static get EPa(){return null!=Zd.arg?Zd.arg:Zd.arg=oa.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}static init(){Zd.Zid||(Zd.Zid=new m.a);Zd.eGg&&(h.ULS.sendTraceTag(4256585,302,50,"WordPresenceManager Init"),
Zd.eGg=!1);if(fb.App.xa){var Ca=fb.App.xa.jb;Ca?(Ca.zda(Zd.mTc),Zd.wsb=Ca.Fc,Zd.wsb&&Zd.wsb.yi?(Zd.XM=Ca.Xc.contentReplicator,Zd.XM?(Zd.RD=Ca.Xc.Ad,Zd.RD?Zd.EPa.CI().continueWith(Zd.dZm):h.ULS.sendTraceTag(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app")):h.ULS.sendTraceTag(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object")):h.ULS.sendTraceTag(4006598,
302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):h.ULS.sendTraceTag(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else h.ULS.sendTraceTag(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}static dZm(){Zd.ij=Zd.EPa.CI().result;if(Zd.ij){var Ca=[Zd.wsb.oUc,Zd.wsb.editingView.oUc],vb=Ib.a.instance,hc=oa.a.instance.resolve("Box4.Presence.WordPresenceDataManager"),
Nc=new ek(hc,vb,Zd.lw,Zd.ij),sd=u.AFrameworkApplication.K.$("DoNotAddToEditorsTableOnFrameIsEnabled")?fb.App.vd.bB:null;sd=new tg(Zd.ij,sd);var Id=oa.a.instance.Ze("WordEditor.IParagraphWordIdMapping"),We=oa.a.instance.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Fd=oa.a.instance.resolve("Common.IPeopleInfoProvider");Zd._instance=new Zd(Zd.ij,Ca,Zd.RD,vb,Fd,hc,Nc,sd,Zd.wsb,Zd.wsb.editingView.Sb,oa.a.instance.resolve("Box4.Presence.PresenceControlProvider"),u.AFrameworkApplication.ya,
Zd.XM,Wa.ParagraphReader.textLength,Wa.ParagraphReader.Wka,oa.a.instance.resolve("Box4.Presence.MyPresenceUser"),Id,We,fb.App.ik.ml,new Be.a,Xa.a.instance,dn.a.get_instance(),ka.a.Lq(oa.a.instance.$a("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),u.AFrameworkApplication.K,u.AFrameworkApplication.K.$("Box4ThrottleAndBatchPresenceRendering"),u.AFrameworkApplication.K.$("Box4DoNotRenderPresenceOutOfView"),oa.a.instance.resolve("WordEditor.Presence.IWordPresenceCpFactory"),oa.a.instance.resolve("Common.IPresenceStatusProvider"),
!fb.App.zs&&!fb.App.Fm,fb.App.Ula(),oa.a.instance.$a("Common.ISessionExpirationManager"));h.ULS.sendTraceTag(23196878,302,50,"WordPresenceManager instance created");Zd.Zid.Eg(Zd._instance);Zd.Dpc.Eg(Zd._instance);Zd.zXg.Eg(Zd._instance);Ca=oa.a.instance;Ca.ha("WordEditor.Presence.WordPresenceManager",()=>Zd._instance).as("Common.IPresenceRemover").as("Common.IPresenceSender").singleInstance();Ca.resolve("WordEditor.Presence.WordPresenceManager")}else h.ULS.sendTraceTag(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}static mTc(Ca){Zd._instance||
(h.ULS.sendTraceTag(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(Ca=Object(v.a)(11,Ca))&&Ca.Tjb(Zd.mTc),Zd.init())}static DAi(){Zd._instance.lXf()}static G5j(Ca,vb,hc,Nc,sd){hc=sd.split(",");if(!hc||3!==hc.length)return 8;Ca=hc[0].trim();vb=hc[1].trim();hc=Number.parseInvariant(hc[2].trim());Ca=new uh(new za(Ca),new Xl(vb,hc,-1));if(!Zd.Dpc.task.isCompleted)return 8;vb=Zd.CI().result;vb.POe(Ca);vb.k4d();return 32}static SSf(Ca,vb,hc,Nc,sd){if(!Zd.Dpc.task.isCompleted)return 8;
Ca=Zd.CI().result;Ca.ZXc(sd);Ca.k4d();return 32}static I_n(Ca,vb,hc,Nc,sd){if(!Zd.Dpc.task.isCompleted)return 8;Ca=Zd.CI().result;if(!Ca)return 8;Ca.g9d(sd);return 32}static LPf(Ca,vb,hc,Nc,sd){if(1===hc)return 32;if(!Zd.EPa.CI().isCompleted)return 8;Ca=Zd.EPa.CI().result;if(!Ca)return h.ULS.sendTraceTag(4301136,302,10,"rtcProxy is null when trying to display RTC connection status"),8;sd[Gl.a.Value]=2===Ca.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===Ca.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnecting:
"";return 32}}Zd._instance=null;Zd.eGg=!0;Zd.Zid=new m.a;Zd.Dpc=new m.a;Zd.zXg=new m.a;Zd.RD=null;Zd.wsb=null;Zd.XM=null;Zd.ij=null;Object(l.a)(Zd,"WordPresenceManager",Ak,[]);class Hf{constructor(Ca){this.sa=new Za.a;this.qY=Ca;this.qY.CWR(()=>this.qY.result.j8j(()=>{this.sa.raiseEvent("X")}))}i$j(Ca){this.sa.addHandler("X",Ca)}Iun(Ca){this.sa.removeHandler("X",Ca)}getStatus(){return this.qY.isCompleted&&this.qY.result?this.qY.result.pDc.toString():"0"}}Object(l.a)(Hf,"WordPresenceStatusProvider",
null,[729]);class Mi{constructor(Ca,vb,hc,Nc){this.ij=null;this.XFg=this.Lye=!1;this.eZm=()=>{this.cda.isCompleted&&this.cda.result?(this.ij=this.cda.result,this.ij.KVa(this.m3),h.ULS.sendTraceTag(5604372,302,50,"Presence Update Monitor is ready.")):h.ULS.sendTraceTag(5604373,302,15,"RtcTask did not complete successfully. No monitoring")};this.m3=(sd,Id)=>{sd=Id.HFa;for(const We in sd)if(Id=sd[We],!this.Lye&&Id.user.zQ&&Id.user.zQ!==this.W8.zQ){h.ULS.sendTraceTag(5604375,302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",
this.W8.zQ,Id.user.zQ);this.Lye=!0;break}this.Lye&&this.ij.$Ib(this.m3);this.XFg||(h.ULS.sendTraceTag(5604374,302,50,"First presence received"),this.XFg=!0)};this.Zj=Ca;this.W8=vb;this.cda=hc;hc.continueWith(this.eZm);this.tOj=Nc;this.tOj.Cxf=this.W8}}Object(l.a)(Mi,"WordPresenceUpdateMonitor",null,[]);var de=c(447),Fj=c(1488),kf=c(216),cf=c(1780),kc=c(1781),zh=c(1673);class Bf{constructor(Ca,vb,hc,Nc,sd,Id,We){this.sa=new Za.a;this.lMg=this.dOg=this.Nwe=this.LQg=!1;this.aMe=this.Yod=0;this.vWb=null;
this.lIa=Id;this.lIa.clientId=Ca.clientId;this.Pq=Ca;this.w8=vb;this.YO=Nc;this.JFj=sd;this.Hb=hc;this.N6a=new kf.a;this.Ym=We;this.w8&&this.w8.continueWith(()=>{this.w8.jo||this.w8.Ki||this.w8.result.X$g(Object(e.a)(this,this.exi,"onAmIAloneChanged"))})}get connectionState(){return this.Pq.connectionState}KVa(Ca){this.sa.addHandler("PU",Ca)}$Ib(Ca){this.sa.removeHandler("PU",Ca)}wza(Ca){this.sa.addHandler("CSC",Ca)}cYc(Ca){this.sa.removeHandler("CSC",Ca)}qrd(Ca){this.sa.addHandler("PSU",Ca)}f4d(Ca){this.sa.removeHandler("PSU",
Ca)}prd(Ca){this.sa.addHandler("PSC",Ca)}e4d(Ca){this.sa.removeHandler("PSC",Ca)}CYi(){}get clientId(){return this.Pq.clientId}B5(Ca){this.sa.addHandler("UN",Ca)}Ccc(Ca){this.sa.removeHandler("UN",Ca)}Z3l(){this.vWb=Array(12);for(let Ca=0;12>Ca;Ca++)this.vWb[Ca]=0;this.dOg=this.Ym?this.Ym.$("UpdateNotificationTaskExperimentIsEnabled"):!0;u.AFrameworkApplication.FK(()=>{this.rEm()})}init(){this.Pq.wza(Object(e.a)(this,this.cga,"onConnectionStateChanged"));this.Pq.KVa(Object(e.a)(this,this.m3,"onPresenceUpdated"));
this.Pq.qrd(Object(e.a)(this,this.$Gb,"onPersistentStateUpdated"));this.Pq.prd(Object(e.a)(this,this.dac,"onPersistentStateCleared"));this.Pq.B5(Object(e.a)(this,this.Vaa,"onUpdateNotificationReceived"));this.xrh();this.Z3l()}y3d(Ca){this.N6a.contains(Ca,(vb,hc)=>vb===hc)||(this.N6a.add(Ca),2===this.connectionState&&Ca.start())}s8f(Ca){for(let vb=0;vb<this.N6a.length;vb++)if(this.N6a.J(vb)===Ca){this.N6a.nF(vb);break}}connect(){this.Nwe||this.Pq.connect()}disconnect(){this.Pq.disconnect()}get r5d(){return this.Pq}fAh(Ca){return uh.Mxb(Ca)}GXf(Ca,
vb){return(new uh(Ca,vb)).bif()}tXf(Ca){Ca&&Ca.Sd()&&!this.YO()?this.Pq.CYi(this.GXf(this.lIa.EBl(),Ca)):H.Task.C$(null)}TZc(Ca,vb){return this.Pq.TZc(Ca,vb)}Cbf(Ca){return this.Pq.Cbf(Ca)}tHc(){return this.Pq.tHc()}rO(Ca,vb,hc=!1){return this.Pq.rO(Ca,vb,hc)}dAb(){return this.Kuh(this.Pq.dAb())}ymb(Ca){if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnabledWordRTCTokenRefresh",!1)){const vb=new m.a;zh.a.getInstance().ZKi(Ca,vb);return vb.task}return H.Task.C$(null)}get SNa(){return this.Pq.SNa}cga(Ca,
vb){2===vb.newState&&this.N6a.forEach(hc=>{hc.start();return!0});vb.newState||this.Ym.$("SendRTCMessagesWhileDisconnectedIsEnabled")&&!this.Nwe||this.N6a.forEach(hc=>{hc.stop();return!0});this.sa.raiseEvent("CSC",vb)}m$e(Ca){return Ca.toLowerCase()}m3(Ca,vb){if(!this.YO()){Ca=this.Kuh(vb.HFa);vb=this.Muh(vb.Hzd);var hc=new Ol.a(Ca,vb);vb=new Ga.a(0,1,0,()=>{this.sa.raiseEvent("PU",hc)},57);this.Hb.fc(vb)}}Kuh(Ca){const vb={};for(const Nc in Ca){var hc=Nc;const sd=this.fAh(Ca[Nc]);sd&&sd.Sd()?vb[this.m$e(hc)]=
sd:h.ULS.sendTraceTag(562661590,302,50,"No Valid User {0}",hc)}return vb}Muh(Ca){const vb=Array(Ca.length);for(let hc=0;hc<Ca.length;hc++)vb[hc]=this.m$e(Ca[hc]);return vb}$Gb(Ca,vb){if(!this.YO()){var hc={};Ca=vb.HFa;for(var Nc in Ca)hc[this.m$e(Nc)]=Ca[Nc];Nc=new Ga.a(0,1,0,()=>{this.sa.raiseEvent("PSU",new cf.a(vb.type,hc))},80);this.Hb.fc(Nc)}}dac(Ca,vb){if(!this.YO()){Ca=this.Muh(vb.fvd);var hc=new kc.a(Ca);Ca=new Ga.a(0,1,0,()=>{this.sa.raiseEvent("PSC",hc)},81);this.Hb.fc(Ca)}}Vaa(Ca,vb){this.dOg?
this.vCi(vb):(Ca=new Ga.a(0,1,0,()=>{this.vCi(vb)},58),this.Hb.fc(Ca))}vCi(Ca){var vb=Date.now();this.sa.raiseEvent("UN",Ca);vb=Date.now()-vb;500<=vb&&(this.Yod++,h.ULS.sendTraceTag(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",Ca.type,vb),this.ubl(Ca));this.aMe++}ubl(Ca){0>Ca.type||21<=Ca.type?h.ULS.sendTraceTag(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",Ca.type):this.vWb[Ca.type]++}rEm(){if(!this.lMg){var Ca=
{};Ca.TC=this.aMe;Ca.HRC=this.Yod;this.vWb&&0<this.Yod&&(Ca.TBC=this.vWb);this.Yod=this.aMe=0;this.vWb=null;h.ULS.sendTraceTag(42541603,302,50,"UpdateNotificationHeuristics: {0}",Ca);this.lMg=!0}}dispose(){this.N6a=new kf.a;this.Pq.cYc(Object(e.a)(this,this.cga,"onConnectionStateChanged"));this.Pq.$Ib(Object(e.a)(this,this.m3,"onPresenceUpdated"));this.Pq.f4d(Object(e.a)(this,this.$Gb,"onPersistentStateUpdated"));this.Pq.e4d(Object(e.a)(this,this.dac,"onPersistentStateCleared"));this.Pq.Ccc(Object(e.a)(this,
this.Vaa,"onUpdateNotificationReceived"));this.w8&&this.w8.continueWith(()=>{this.w8.jo||this.w8.Ki||this.w8.result.Itn(Object(e.a)(this,this.exi,"onAmIAloneChanged"))});this.Pq.disconnect();h.ULS.sendTraceTag(4564935,302,50,"Disposing of rtcProxyCompleted")}exi(){this.xrh()}xrh(){let Ca=!1;this.w8?this.w8.continueWith(()=>{this.w8.jo||this.w8.Ki||(Ca=!this.w8.result.amIAlone);this.Pq.connectionState||!Ca&&!this.JFj()?2!==this.Pq.connectionState||Ca||(this.disconnect(),h.ULS.sendTraceTag(4564937,
302,50,"Disconnecting because there are no other users in the doc")):(this.connect(),h.ULS.sendTraceTag(4564936,302,15,"Connecting because there are other authors in the doc"));!this.LQg&&Ca&&(h.ULS.sendTraceTag(4203466,302,50,"There are other real-time authors in this session"),this.LQg=!0)}):(this.connect(),h.ULS.sendTraceTag(589321547,302,50,"Connecting to rtc because Rtc Always On is enabled"))}mEc(){this.Nwe=!0;this.disconnect();h.ULS.sendTraceTag(4564938,302,50,"DisconnectForever")}}Object(l.a)(Bf,
"RtcProxy",null,[1199,10,947,1200]);class si extends Bf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,Tc,uj){super(Ca,vb,hc,Nc,sd,Id,uj);this.hda=null;this.TH=We;this.ud=Fd;this.rIa=Ff;this.htc=Ac;this.KIe=Qi;this.evb=Tc}get hJ(){return this.hda||(this.hda=this.KIe())}cga(Ca,vb){2===vb.newState&&h.ULS.sendTraceTag(4315102,302,50,"RTC Connected");this.moo();super.cga(Ca,vb)}moo(){this.hJ&&this.hJ.kU("RtcConnectionStatusLabel")}fAh(Ca){return id.m0e(ud(Ca),this.TH,this.ud,this.rIa,this.evb)}GXf(Ca,vb){return Object(ld.a)(Qf,
vb)?(Ca=new id(this.htc.fWh(),Ca,vb),Ce(Ca.bif())):super.GXf(Ca,vb)}}Object(l.a)(si,"WordRtcProxy",Bf,[]);class ag{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,Tc,uj){this.Vo=new m.a;this.L1g=!0;this.me=vb;this.Hb=hc;this.YO=Nc;this.lIa=sd;this.TH=Id;this.vra=We;this.rIa=Fd;this.htc=Ff;this.KIe=Ac;this.l1=Qi;this.evb=Tc;this.Oa=uj}CI(){this.meo();return this.Vo.task}JIc(){return de.a.then(this.CI(),Ca=>Ca)}meo(){if(this.L1g)if(this.L1g=!1,fb.App.$tf()&&fb.App.Xrf()){var Ca=u.AFrameworkApplication.af;
if(Ca){Ca=Fj.RealtimeChannel.createInstance("{"+u.AFrameworkApplication.userSessionId+"}",u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.oVi,Ca,this.l1,1,this.me,this.Oa.lb("RtcEndpointUrl"),void 0,void 0,null,this.Oa.$("FindSessionOnBootIsEnabled")?oa.a.instance.resolve("Common.IFindSessionUtils"):null,this.Oa.lb("RtcBootToken"));var vb=this.Oa.$("RtcAlwaysOnEnabled"),hc=new si(Ca,vb?null:fb.App.Ula(),this.Hb,this.YO,ag.Yel,this.lIa,this.TH,this.vra,this.rIa,this.htc,this.KIe,this.evb,
u.AFrameworkApplication.K);fb.App.YPn(hc);this.Oon(hc);hc.init();tl.App.K2a=hc;this.l1.execute(Nc=>{Nc.Z$a(()=>{hc.mEc()})});this.Vo.Eg(hc)}else h.ULS.sendTraceTag(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else h.ULS.sendTraceTag(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}Oon(Ca){const vb=oa.a.instance;vb.ha("WordEditor.Presence.WordRtcProxy",()=>Ca).as("Box4.Presence.IRtcProxy").as("Common.IRealtimeChannelBasic").singleInstance();
vb.resolve("Common.IRealtimeChannelBasic")}static Yel(){return!1}}Object(l.a)(ag,"WordRtcProxyProvider",null,[712,713]);class Xg{constructor(){this.W=null;this.Cl=!1}get name(){return"WordEditor.Presence"}init(){h.ULS.sendTraceTag(50995799,302,50,"PresencePackage Init");fb.App.Jnj&&(this.W.resolve("WordEditor.Presence.WordRtcProxyProvider").CI(),Zd.init(),this.W.resolve("WordEditor.Presence.WordPresenceUpdateMonitor"));fb.App.kCc&&zd.init();this.W.resolve("Common.App.Presence.AwayManager");this.W.resolve("Common.IPeopleInfoProvider");
if(Xg.ZLg){const Ca=this.W.resolve("WordEditor.IMainViewModeManager");Ca.Gvb(this.BJf);Xg.nve=1===Ca.Qw}}dispose(){if(!this.Cl){this.Cl=!0;Zd.CI().continueWith(()=>{Kd.a.YA(Zd.CI().result)});var Ca=this.W.resolve("Box4.Presence.MyPresenceUser");Ca&&Ca.sbc&&Ca.sbc.Iun(Zd.DAi)}}zc(Ca){this.W=Ca;this.W.ha("Box4.Presence.MyPresenceUser",()=>new pa).as("Box4.Presence.IMyPresenceUser").as("Common.IPresenceUser").as("Common.IPresenceConverter").singleInstance();Ca.ha("WordEditor.Presence.IWordPresenceCpFactory",
()=>new Bj(Ca.resolve("Box4.CpConversionManagerImpl"),Ca.resolve("Box4.IContentControlReader"))).singleInstance();Ca.ha("WordEditor.Presence.WordPresenceUpdateMonitor",()=>new Mi(new I.a(()=>fb.App.vd),Se.a.instance,Ca.resolve("WordEditor.Presence.WordRtcProxyProvider").JIc(),Ca.resolve("Box4.Presence.IMyPresenceUser"))).singleInstance();Ca.ha("WordEditor.Presence.WordRtcProxyProvider",()=>new ag(u.AFrameworkApplication.buildVersion,fb.App.xa.lq,Xa.a.instance,()=>u.AFrameworkApplication.Tk,oa.a.instance.resolve("Box4.Presence.IMyPresenceUser"),
oa.a.instance.Pa("WordEditor.ParagraphWordIdMapping"),oa.a.instance.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),()=>u.AFrameworkApplication.ta&&fb.App.xa.jb&&fb.App.xa.jb.Xc?fb.App.xa.jb.Xc.Ad:null,ki.instance,()=>oa.a.instance.Pa("WordEditor.IStatusBarUser"),oa.a.instance.$a("Common.ISessionExpirationManager"),oa.a.instance.resolve("WordEditor.Presence.IWordPresenceCpFactory"),u.AFrameworkApplication.K)).singleInstance().as("Box4.Presence.IRtcProxyProvider").as("Common.Interface.IRtcBasicProvider");
Ca.ha("Box4.Presence.PresenceControlProvider",()=>new bl(Xg.YPk(),jh.a.instance,oa.a.instance.$a("Common.IZoomManager"),oa.a.instance.resolve("Box4.ICoauthCashTelemetry"),ka.a.Lq(oa.a.instance.$a("Common.ISystemInitiatedFeedbackWithTimeLapse")),u.AFrameworkApplication.K,Ca.resolve("Common.IPeopleInfoProvider"))).singleInstance();Ca.ha("Common.App.Presence.AwayManager",()=>new Qe(oa.a.instance.resolve("Common.IPresenceUser"),oa.a.instance.resolve("WordEditor.Presence.WordRtcProxyProvider").JIc(),Zd.uGl(),
oa.a.instance.resolve("Common.IPresenceConverter"),Xa.a.instance,u.AFrameworkApplication.K.$("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:u.AFrameworkApplication.K.rc("AwayCoauthorThresholdMs",9E5),Object(e.a)(u.AFrameworkApplication.ya,u.AFrameworkApplication.ya.processAction,"processAction"),fb.App.xa.notificationBar,u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"))).singleInstance();Ca.ha("WordEditor.Presence.WordPresenceStatusProvider",()=>new Hf(ka.a.Lq(oa.a.instance.$a("Common.ICurrentPageCalculator")))).as("Common.IPresenceStatusProvider").singleInstance();
Ca.ha("Common.App.Presence.PeopleInfoProvider",()=>new Of(Ca.resolve("WordEditor.Presence.WordRtcProxyProvider").JIc(),fb.App.Ula().CWR(()=>fb.App.Ula().result.bB),Ca.resolve("Common.App.People.IPeopleColorUtils"),Ca.resolve("Common.IPresenceConverter"),ka.a.Lq(Ca.$a("Common.App.Presence.AwayManager")))).as("Common.IPeopleInfoProvider").singleInstance();Ca.ha("Box4.Presence.WordPresenceDataManager",()=>new ll(fb.App.xa.jb.Xc.Ad)).as("Box4.IPresenceDataManager").singleInstance()}BJf(Ca,vb){fb.App.xa&&
fb.App.xa.nC&&(Xg.Phd=null,Xg.nve=1===vb.q$b)}static get pDi(){if(!Xg.Phd&&fb.App.xa&&fb.App.xa.nC){const Ca=tl.App.En.nC;Xg.Phd=Xg.nve&&Xg.ZLg?Ca.getElementsByClassName("PaginatedContentContainerDisplayWrapper")[0]:Ca.getElementsByClassName("OutlineContainerDisplayWrapper")[0]}return Xg.Phd}static YPk(){const Ca=u.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"),vb=u.AFrameworkApplication.K.$("PresenceIgnoreEventOnExpandedTooltip"),hc=u.AFrameworkApplication.K.$("PresenceIpWidthAdjustForFlyout"),
Nc=new xc;Nc.add($b.multipleBrowsersImageClassName,yg.getImageClassWithCluster(u.AFrameworkApplication.mQ,"MoreUsersGlyph16"));Nc.add($b.multipleBrowserImageClusterPath,u.AFrameworkApplication.pr);Nc.add($b.peopleImageClassName,yg.getImageClassWithCluster(u.AFrameworkApplication.mQ,Ca?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));Nc.add($b.peopleImageClusterPath,u.AFrameworkApplication.pr);Nc.add($b.zIndex,1);Nc.add($b.rtl,u.AFrameworkApplication.isRtl);Nc.add($b.viewportBoundsCallback,
Xg.PQl);Nc.add($b.ignoreEventOnExpandedTooltip,vb);Nc.add($b.ipWidthAdjustForFlyout,hc);return Ca?new Af(Nc):new Sf(Nc)}static PQl(){return Xg.pDi?pf.a.getElementBounds(Xg.pDi):null}}Xg.nve=!0;Xg.ZLg=u.AFrameworkApplication.K.$("FlippedFlyoutForPaginationViewIsEnabled");Xg.Phd=null;Object(l.a)(Xg,"WordPresencePackage",null,[1,2]);var Mf=c(1010),li=c(1361),Kh=c(1016),Gj=c(126);class Hi{constructor(Ca,vb){this.QOe=Ca;this.paragraphId=vb}get opType(){return 2}get operation(){return this.QOe}}Object(l.a)(Hi,
"RttAppliedAddParagraphOp",null,[714]);class ch{constructor(Ca,vb){this.Twn=Ca;this.paragraphId=vb}get opType(){return 6}get operation(){return this.Twn}}Object(l.a)(ch,"RttAppliedReplaceSymbolRangeOp",null,[714]);class hm{constructor(Ca,vb){this.Xwn=Ca;this.paragraphId=vb}get opType(){return 1}get operation(){return this.Xwn}}Object(l.a)(hm,"RttAppliedReplaceTextRangeOp",null,[714]);class Wk{constructor(Ca,vb,hc){this.M8i=Ca;this.L9d=vb;this.iDc=hc}get opType(){return 4}get operation(){return this.M8i}get j1j(){return this.M8i.w_b()?
this.iDc:this.L9d}}Object(l.a)(Wk,"RttAppliedSplitParagraphOp",null,[714]);class Pl{constructor(){this.K5a=new Ea.a}Bvf(Ca){return Ca.toString()}iyc(Ca,vb){Ca=this.Bvf(Ca);this.K5a.ub(Ca)||this.K5a.Z(Ca,new M.a);this.K5a.J(Ca).add(vb)}gIf(Ca){switch(Ca.opType){case 1:var vb=Object(v.a)(hm,Ca);this.iyc(vb.paragraphId,Ca);break;case 6:vb=Object(v.a)(ch,Ca);this.iyc(vb.paragraphId,Ca);break;case 4:vb=Object(v.a)(Wk,Ca);this.iyc(vb.L9d,Ca);this.iyc(vb.iDc,Ca);break;case 2:vb=Object(v.a)(Hi,Ca),this.iyc(vb.paragraphId,
Ca)}}fVm(Ca){return this.uib(Ca)}uib(Ca){Ca=this.Bvf(Ca);if(!this.K5a.ub(Ca))return new M.a;const vb=this.K5a.J(Ca);this.K5a.remove(Ca);for(let hc of vb)hc.operation&&(hc.operation.F5=null);return vb}pDl(Ca){let vb;return({value:vb}=this.K5a.Bc(this.Bvf(Ca),vb)).returnValue?vb:new M.a}Eil(Ca){for(let vb of this.K5a.values){if(!vb.count)continue;if(2!==vb.J(0).opType)continue;const hc=vb.J(0);if(hc.QOe.hEf===Ca)return hc}return null}}Object(l.a)(Pl,"RttAppliedOpTracker",null,[693]);var oh=c(231),Pi;
(function(Ca){Ca[Ca.m7k=0]="expired";Ca[Ca.pGo=1]="dried"})(Pi||(Pi={}));Object(l.b)("RemoveChangeReason",Pi);class Qd{constructor(){this.Vwa=new oh.a}Q2j(Ca){if(!Ca)return h.ULS.sendTraceTag(7685333,355,15,"Cannot add a null change to RTTStore"),!1;const vb=Ca.Nc,hc=Ca.mj;this.Vwa.ub(vb)||this.Vwa.add(vb,new oh.a);this.Vwa.J(vb).Z(hc,Ca);return this.PRk(vb,hc)?(h.ULS.sendTraceTag(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",vb),this.Vwa.J(vb).remove(hc),
!1):!0}pgf(Ca,vb){if(!this.Vwa.ub(Ca))return null;Ca=this.Vwa.J(Ca);return Ca.ub(vb)?Ca.J(vb):null}iHd(Ca){const vb=new M.a;for(let hc of this.Vwa.keys){const Nc=this.Vwa.J(hc);for(let sd of Nc.keys){const Id=Nc.J(sd);Ca(Id)&&vb.add(Id)}}return vb}xPi(Ca,vb){let hc=null;({value:hc}=this.Vwa.Bc(Ca.Nc,hc)).returnValue?(Ca.activity.mGf(Pi[vb]),hc.remove(Ca.mj),hc.count||this.Vwa.remove(Ca.Nc)):h.ULS.sendTraceTag(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",
Ca.Nc,vb)}ASf(Ca){this.xPi(Ca,1)}DSf(Ca){this.xPi(Ca,0)}PRk(Ca,vb){if(!this.Vwa.ub(Ca))return!1;Ca=this.Vwa.J(Ca);if(!Ca.ub(vb))return!1;for(var hc=Ca.J(vb);hc;){hc=hc.Q_;if(hc===vb)return!0;if(!Ca.ub(hc))break;hc=Ca.J(hc)}return!1}}Object(l.a)(Qd,"RttDataStore",null,[691,692]);var Ql=c(298),lg=c(68),Mj=c(292),bi=c(16);class vl{constructor(Ca,vb){this.GXd=(hc,Nc)=>{4===this.Wp.opType?h.ULS.shipAssertTag(9204866,355,12===Nc.node.type||11===Nc.node.type,"Unexpected graph modification detected during RTT edit"):
h.ULS.shipAssertTag(9204867,355,!1,"Unexpected graph modification detected during RTT edit")};this.uib=()=>{h.ULS.shipAssertTag(9204868,355,!1,"Unexpected graph modification detected during RTT edit")};this.Vyi=()=>{h.ULS.shipAssertTag(9204869,355,!1,"Unexpected graph modification detected during RTT edit")};this.Wp=Ca;if(this.Tp=vb)Ca=this.Tp.Ve(12),Ca.Wt(this.GXd),Ca.Zu(this.uib),Ca.qp(this.Vyi)}dispose(){if(this.Tp){const Ca=this.Tp.Ve(12);Ca.oU(this.GXd);Ca.lba(this.uib);Ca.CX(this.Vyi)}}}Object(l.a)(vl,
"GraphChangeValidator",null,[10]);class kd{constructor(Ca,vb,hc,Nc){this.id=Ca;this.cpBegin=vb;this.cpEnd=hc;this.Huk=Nc}Zro(Ca){var vb=this.id===Ca.id;vb&&(vb=this.Huk.replace("\u00a0"," "),Ca=Ca.characterData.substr(this.cpBegin,this.cpEnd-this.cpBegin).replace("\u00a0"," "),vb=vb===Ca);return vb}}Object(l.a)(kd,"RttOpValidator",null,[736]);class yf{constructor(Ca,vb){this.F5=this.P4a=this.activity=null;this.opType=Ca;this.metadata=vb}Yif(){return""}serialize(){return null}}Object(l.a)(yf,"RttOp",
null,[711]);class Yd extends yf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){super(Ff,Fd);this.Nc=Ca;this.mj=vb;this.JQ=hc;this.i3=Nc;this.Q_=sd;this.Tlb=Id;this.YG=We}Dwh(){return this.JQ.isEqual(this.i3,!0)?new Fe.a(0,this.Nc,this.mj,this.JQ,void 0,void 0,void 0,this.YG):new Fe.a(1,this.Nc,this.mj,this.JQ,this.Nc,this.mj,this.i3,this.YG)}static Pej(Ca){let vb,hc;var Nc=Ca.xS;if(1===Nc.$2d&&(Nc.COa!==Nc.FDa||Nc.$3a!==Nc.vgc))return h.ULS.sendTraceTag(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),
hc=vb=null,Ca=Nc=-1,{returnValue:!1,JQ:hc,i3:vb,Nc:Ca,mj:Nc};if(Nc.YG)return hc=vb=null,Ca=Nc=-1,{returnValue:!1,JQ:hc,i3:vb,Nc:Ca,mj:Nc};vb=hc=Nc.JQ;1===Nc.$2d&&(vb=Nc.i3);Ca=Nc.COa;Nc=Nc.$3a;return{returnValue:!0,JQ:hc,i3:vb,Nc:Ca,mj:Nc}}}Object(l.a)(Yd,"RttReplaceRangeOp",yf,[]);var Rj=c(1359),fk=c(406),vg=c(588);class Ie extends vg.a{constructor(){super();this.RttStatusRecords=this.FileId=null}Tl(){return 110}static d$(Ca,vb){const hc=new Ie;hc.FileId=Ca;hc.RttStatusRecords=vb;return hc}}Object(l.a)(Ie,
"RttStatusRequest",vg.a,[]);class Gm{}Object(l.a)(Gm,"RttStatusOp",null,[]);class ej{constructor(){this.contentState=this.contentType=this.timeToRender=this.strictlySequentialId=this.packetVersion=this.clientType=this.clientId=this.packetId=null}}Object(l.a)(ej,"WireRttStatusOpRecord",null,[]);class Ph extends fk.a{constructor(){super();const {App:Ca}=c(159);this.JUb=new M.a;this.ZFe=new M.a;this.Xj=new Rj.a(u.AFrameworkApplication.K.rc("WordEditorRttStatusReplicatorIntervalMs",6E4));this.enabled=
1;Ca.R_.register(this)}Ftj(){const Ca=Date.now();for(let vb of this.JUb)vb.hHb&&1===vb.hHb&&(vb.hHb=2,vb.timeToRender=Ca-vb.metadata.e6f)}ffe(Ca){const vb=new Gm;vb.metadata=Ca.operation.metadata;vb.opType=Ca.opType;vb.hHb=1;this.JUb.add(vb)}get gna(){return"RttStatusReplicator"}z2(){return this.he&&2===this.he.status?!0:1===this.enabled&&this.Xj.IW()?this.QB():!1}QB(){for(let Ca of this.JUb)if(Ca.hHb&&2===Ca.hHb)return!0;return!1}oPa(){if(1===this._state){this._state=3;const vb=this.JUb.toArray().filter(hc=>
2===hc.hHb);var Ca=this.yKk(vb);Ca=Ie.d$(u.AFrameworkApplication.rootQuerySignature,Ca);vb.forEach(hc=>this.JUb.remove(hc));vb.forEach(hc=>this.ZFe.add(hc));this.he.Zr=Ca;this.he.mH="RttStatusRequest";this.he.status=1}else 3===this._state&&this.he&&2===this.he.status&&(this.Xj.e0(),2!==this.he.statusCode&&this.JUb.IA(0,this.ZFe),this.ZFe.clear(),this._state=1)}yKk(Ca){const vb=[];Ca.forEach(hc=>{const Nc=new ej;Nc.clientId=hc.metadata.clientId;Nc.clientType=hc.metadata.clientType;Nc.packetId=hc.metadata.packetId;
Nc.packetVersion=hc.metadata.packetVersion;Nc.strictlySequentialId=hc.metadata.strictlySequentialId;Nc.contentType=hc.opType;Nc.contentState=hc.hHb;Nc.timeToRender=hc.timeToRender;vb.push(Nc)});return vb}Oec(){return!0}kE(){}forceOutbound(){}}Object(l.a)(Ph,"RttStatusReplicator",fk.a,[]);class dg{constructor(Ca,vb,hc,Nc,sd,Id){this.packetId=Ca;this.clientId=vb;this.clientType=hc;this.e6f=Nc;this.packetVersion=sd;this.strictlySequentialId=Id}static create(Ca){let vb=null;null!=Ca.strictlySequentialId&&
(vb=Ca.strictlySequentialId);return new dg(Ca.packetId,Ca.clientId,Ca.client,Date.now(),Ca.version,vb)}}Object(l.a)(dg,"RttOpMetadata",null,[]);class Ll extends yf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff){super(4,Ff);this.Q_=0;this.Nc=Ca;this.mj=vb;this.offset=hc;this.YG=Nc;this.abg=sd;this.O5f=Id;this.Gee=We;this.P5f=Fd;this.abg===this.Nc?this.Q_=this.O5f:this.Gee===this.Nc?this.Q_=this.P5f:(h.ULS.sendTraceTag(8397766,355,10,"Bad data passed to RttSplitParagraphOp"),this.Q_=0)}w_b(){return this.Nc===
this.Gee}get q$n(){return this.Q_}get tvo(){return this.w_b()?this.abg:this.Gee}get Cbj(){return this.w_b()?this.O5f:this.P5f}serialize(){const Ca=new Fe.a(3,this.Nc,this.mj,this.offset,null,null,null,this.YG),vb=new tc(this.abg,this.O5f,this.Gee,this.P5f);return new Yb(this.metadata.packetId,this.metadata.clientId,1,4,Ca,null,void 0,void 0,void 0,void 0,vb,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){const vb=Ca.xS,hc=Ca.oLb;return new Ll(vb.COa,vb.$3a,vb.JQ,vb.YG,hc.FKf,hc.N5f,
hc.GKf,hc.Q5f,dg.create(Ca))}static kJl(Ca,vb,hc){if(1!==Ca.type)return null;const Nc=hc.EOa(Ca.j3.characterData,Ca.j3.qa);return new Ll(Ca.j3.Nc,Ca.j3.mj,hc.yic(Nc,Ca.y8i),Ca.YG,Ca.ivb.Nc,Ca.ivb.mj,Ca.Izc.Nc,Ca.Izc.mj,vb)}}Object(l.a)(Ll,"RttSplitParagraphOp",yf,[689,711]);class vf{constructor(Ca,vb,hc,Nc){this.nRm=()=>{this.ztb.Ftj()};this.dia=Ca;this.Esc=vb;this.Fia=hc;this.oub=Nc;null!=u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRttStatusReplicatorIsEnabled",
!1)&&(this.ztb=new Ph,Ql.GraphTransactionManager.instance.W$g(this.nRm))}$ek(Ca,vb,hc,Nc=null){if(vb.isDirty)return Nc&&Nc.properties.Z(vf.AEi,"1"),!1;const sd=new vl(Ca,vb.Ui);try{if(1===Ca.opType||6===Ca.opType){const Fd=Object(v.a)(Yd,Ca),Ff=this.oGk(Fd,vb);var Id=Ff.node.characterData;const Ac=10<=Ff.cpBegin?Ff.cpBegin-10:0;let Qi=Ff.cpEnd+10<=Id.length?Ff.cpEnd+10:Id.length;const Tc=Id.substr(Ac,Ff.cpBegin-Ac),uj=Id.substr(Ff.cpEnd,Qi-Ff.cpEnd);Qi=Qi+Fd.Tlb.length-(Ff.cpEnd-Ff.cpBegin);var We=
new kd(Ff.node.id,Ac,Qi,Tc+Fd.Tlb+uj);const oj=6===Fd.opType;Id="";oj&&(Id=Fd.font);if(!this.Cwn(Ff,Fd.Tlb,oj,Id,Nc))return!1;let ti;ti=1===Ca.opType?new hm(Fd,vb.id):new ch(Fd,vb.id);vb.Wka=Ca.Q_;Fd.P4a=We;Ca.F5=ti;hc.gIf(ti);null!=this.ztb&&this.ztb.ffe(ti)}else return 4===Ca.opType?this.Zek(Ca,vb,hc):!1}finally{sd&&sd.dispose()}return!0}Zek(Ca,vb,hc){const Nc=Object(v.a)(Ll,Ca);var sd=this.oub.EOa(vb.characterData,vb.qa);sd=this.oub.Jxb(sd,Nc.offset);if(!this.eii(vc.a.createTextRange(vb,0,Wa.ParagraphReader.textLength(vb))))return!1;
var Id=qf.GraphIterator.Za(vb);Id.Ab(10);if(this.x7b(Id))return!1;let We;Id=this.Fia.Rc(3);try{Id.Eb(vb);const Fd=vb.QX();try{const Ff=qf.GraphIterator.Za(vb);Ff.Ab(10);Ff.kd(11);let Ac=Ff.currentNode;Nc.w_b()&&(Ff.crf?Ac=null:(Ff.dH(),Ac=Ff.currentNode));Ff.mc();const Qi=this.Esc.Uxb();Ff.eH(Qi,Ac,89);Ff.Ei(Qi);We=vb.clone();const Tc=We.QX();try{We.setValue(Fg.a.Nc,Nc.tvo);We.setValue(Fg.a.mj,Nc.Cbj);We.isDirty=!1;Ff.Rf(We,2);Ff.Ei(We);this.dIk(vb,We);const uj=Nc.w_b()?We:vb,oj=Nc.w_b()?vb:We;uj.vN=
!0;oj.vN=!0;this.dia.dUf(this.Fbb(uj,sd,Wa.ParagraphReader.textLength(uj)),"",!1,"");this.dia.dUf(this.Fbb(oj,0,sd),"",!1,"");vb.Wka=Nc.q$n;We.Wka=Nc.Cbj}finally{Tc&&Tc.dispose()}}finally{Fd&&Fd.dispose()}Id.OPa()}finally{Id&&Id.dispose()}vb=new Wk(Nc,vb.id,We.id);Ca.F5=vb;hc.gIf(vb);null!=this.ztb&&this.ztb.ffe(vb);return!0}x7b(Ca){const vb=new qf.GraphIterator;vb.ed(Ca);vb.kd(11);return lg.ListReader.ei(vb)?(h.ULS.sendTraceTag(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}zal(Ca,
vb,hc){var Nc=vb.keb(Ca.Nc);if(Nc.equals(ee.a.nil))return null;Nc=hc.Db(Nc);if(!Nc||!Wa.ParagraphReader.nc(Nc)||!Nc.isConnected)return null;const sd=qf.GraphIterator.Za(Nc);if(!sd.Ab(23))return null;if(Ca.$ag){Ca=vb.keb(Ca.$ag);if(Ca.equals(ee.a.nil))return null;hc=hc.Db(Ca);if(!hc||!Wa.ParagraphReader.nc(hc)||!hc.isConnected)return null;hc=qf.GraphIterator.Za(hc);if(!hc.Ab(23))return null;hc.kd(11);hc.dH();hc.Ud();if(hc.currentNode!==Nc)return null}return this.x7b(sd)?null:sd}heo(Ca,vb,hc,Nc){const sd=
vb.currentNode,Id=this.Fia.Rc(3);try{Id.Eb(sd);vb.kd(11);const We=vb.currentNode;vb.mc();const Fd=this.Esc.Uxb();vb.eH(Fd,We,89);vb.Ei(Fd);const Ff=Mj.a.instance.createInstance(393230),Ac=Ff.QX();try{Ff.setValue(bi.a.mo,""),Ff.DCa=!0,Nc.WIb(Ff),Nc=[0],Ff.setValue(Fg.a.Iq,Nc),Ff.setValue(Fg.a.gt,Nc),Ff.DCa=!1,Ff.setValue(Fg.a.Nc,Ca.hEf),Ff.setValue(Fg.a.mj,Ca.gEf),Ff.isDirty=!1,vb.Rf(Ff,2),Ff.vN=!0,Ff.Wka=Ca.gEf}finally{Ac&&Ac.dispose()}Id.OPa();Ca.F5=new Hi(Ca,Ff.id);hc.gIf(Ca.F5);null!=this.ztb&&
this.ztb.ffe(Ca.F5)}finally{Id&&Id.dispose()}return!0}Fbb(Ca,vb,hc){return vb===hc?vc.a.Uc(Ca,vb):vc.a.createTextRange(Ca,vb,hc)}Cwn(Ca,vb,hc,Nc,sd=null){const Id=Ca.node;if(Ca.cpBegin!==Ca.cpEnd&&!this.eii(Ca))return sd&&sd.properties.Z(vf.Ogj,"1"),!1;sd=this.Fia.Rc(3);try{sd.Eb(Id);const We=Id.QX();try{Id.vN=!0,this.dia.dUf(Ca,vb,hc,Nc)}finally{We&&We.dispose()}sd.OPa()}finally{sd&&sd.dispose()}return!0}dIk(Ca,vb){vb.DCa=!0;vb.cwa(Ca.characterData);vb.Wka=Ca.Wka;vb.qa.clear();for(var hc=0;hc<Ca.qa.length;hc++){const Nc=
Ca.qa.J(hc).dsa(vb);vb.qa.add(Nc)}vb.yn();if(vb.wordRunProperties.length)for(Ca=0;Ca<vb.qa.length;Ca++){if((hc=vb.qa.J(Ca).formatting)&&-1!==hc.Ge)for(;vb.wordRunProperties.length<=hc.Ge;)vb.wordRunProperties.IZ(vb.wordRunProperties.length-1,256)}else h.ULS.sendTraceTag(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");vb.DCa=!1}Zuf(Ca){Ca=qf.GraphIterator.Za(Ca);Ca.Ab(23);Ca.mc();return{returnValue:89===Ca.role,iterator:Ca}}jTf(Ca){const vb=new qf.GraphIterator;vb.ed(Ca);
vb.mc();const hc=this.Fia.Rc(3);try{hc.Eb(vb.currentNode),Ca.Hg()}finally{hc&&hc.dispose()}}crn(Ca){if(Ca.anchor)if(({iterator:vb}=this.Zuf(Ca)).returnValue)this.jTf(vb);else{var vb=Ca.Mc.Am;var hc=this.Fia.Rc(3);try{hc.Eb(Ca),Ca.load(vb.Db(Ca.id)),Ca.anchor.SW(4)}finally{hc&&hc.dispose()}}}EVf(Ca,vb,hc){for(let Id=vb.count-1;0<=Id;Id--){var Nc=vb.J(Id);switch(Nc.opType){case 4:Nc=Object(v.a)(Wk,Nc);if(!Ca.id.equals(Nc.L9d)){h.ULS.shipAssertTag(9204885,355,Ca.id.equals(Nc.iDc));continue}Nc=hc.Db(Nc.iDc);
if(!Nc)break;if(!Nc||!Wa.ParagraphReader.nc(Nc)){h.ULS.shipAssertTag(9204886,355,!1);break}if(!Nc.isConnected)continue;var sd=({iterator:Nc}=this.Zuf(Nc)).returnValue;h.ULS.shipAssertTag(9204887,355,sd);sd&&this.jTf(Nc);break;case 2:(Nc=Object(v.a)(Hi,Nc),Ca.id.equals(Nc.paragraphId))?Ca.isConnected&&(sd=({iterator:Nc}=this.Zuf(Ca)).returnValue,h.ULS.shipAssertTag(16820002,355,sd),sd&&this.jTf(Nc)):h.ULS.shipAssertTag(16820001,355,!1)}}}oGk(Ca,vb){const hc=this.oub.EOa(vb.characterData,vb.qa),Nc=
this.oub.Jxb(hc,Ca.JQ);Ca=this.oub.Jxb(hc,Ca.i3);return Nc===Ca?vc.a.Uc(vb,Nc):vc.a.createTextRange(vb,Nc,Ca)}eii(Ca){const vb=Ca.node.qa,hc=Ca.cpBegin;Ca=Ca.cpEnd;for(let Nc=0;Nc<vb.length;Nc++){const sd=vb.J(Nc);if(sd.cp>=Ca)break;if(sd.cp>=hc){if(sd.Hf)return h.ULS.sendTraceTag(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(sd.blob)return h.ULS.sendTraceTag(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(sd.gf||sd.Ngb||sd.G6b)return h.ULS.sendTraceTag(8242649,
355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}}vf.AEi="ParagraphAlreadyDirty";vf.Ogj="UnsafeWetChange";Object(l.a)(vf,"RttEditor",null,[688]);var Ae=c(15),cb=c(1403),Eb=c(248);class ec{constructor(){this.B6c=new M.a}add(Ca){this.B6c.add(Ca);return!0}iHd(Ca){const vb=new M.a;for(let hc of this.B6c)Ca(hc)&&vb.add(hc);return vb}ASf(Ca){Ca.activity.mGf("dried");this.B6c.remove(Ca)}DSf(Ca){Ca.activity.mGf("expired");this.B6c.remove(Ca)}}Object(l.a)(ec,"RttAddParagraphDataStore",
null,[]);class Cc extends yf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd){super(2,Fd);this.Nc=Ca;this.mj=vb;this.Q_=hc;this.$ag=Nc;this.hEf=sd;this.gEf=Id;this.YG=We}serialize(){const Ca=new Fe.a(2,this.Nc,this.mj,null,this.$ag,null,null,this.YG),vb=new gb(this.Q_,this.hEf,this.gEf);return new Yb(this.metadata.packetId,this.metadata.clientId,1,3,Ca,null,void 0,void 0,vb,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){const vb=Ca.xS,hc=Ca.lXb;let Nc=null;null!=Ca.xS.FDa&&
(Nc=Ca.xS.FDa);return new Cc(vb.COa,vb.$3a,hc.R5f,Nc,hc.IKf,hc.Q_,vb.YG,dg.create(Ca))}static gJl(Ca,vb){return 3!==Ca.type?null:new Cc(Ca.kna.Nc,Ca.kna.mj,Ca.lNm.mj,Ca.lOa?Ca.lOa.Nc:null,Ca.Sua.Nc,Ca.Sua.mj,Ca.YG,vb)}}Object(l.a)(Cc,"RttAddParagraphOp",yf,[]);class Pc{constructor(Ca){this.MU=Ca}gMi(){this.MU&&this.MU.properties.Z(Pc.IHh,"1")}Ajn(Ca){this.MU&&(this.MU.properties.ub(Pc.wBf)||this.MU.properties.Z(Pc.wBf,(Ca-this.MU.startTime).toString()))}mGf(Ca){this.MU&&(this.MU.properties.Z(Pc.TQi,
Ca),this.MU.end())}Mkn(Ca){this.MU&&this.MU.properties.Z(Pc.HDi,Ca.toString())}Lkn(Ca){this.MU&&this.MU.properties.Z(Pc.aDi,Ca)}static Anf(Ca){Ca.I3(ai.a.DJb,Pc.IHh,cb.a.N$i);Ca.I3(ai.a.DJb,Pc.B8k,cb.a.N$i);Ca.I3(ai.a.DJb,Pc.wBf,cb.a.yik);Ca.I3(ai.a.DJb,Pc.TQi,cb.a.ssa);Ca.I3(ai.a.DJb,Pc.HDi,cb.a.ssa);Ca.I3(ai.a.DJb,Pc.aDi,cb.a.ssa)}static create(Ca){if(!Ca)return null;Ca=Ca.qo(ai.a.DJb,Pc.kuo);return new Pc(Ca)}}Pc.IHh="FailedToFindInitialParaID";Pc.B8k="FailedToFindInitialTextID";Pc.wBf="MsecUntilApplied";
Pc.TQi="RemovedBecause";Pc.HDi="PacketVersions";Pc.aDi="OperationType";Pc.kuo=48E4;Object(l.a)(Pc,"RttOpActivity",null,[]);var jd;(function(Ca){Ca[Ca.unknown=0]="unknown";Ca[Ca.sMo=1]="replaceTextRangeOp";Ca[Ca.VDo=2]="addParagraphOp";Ca[Ca.QFo=3]="deleteParagraphOp";Ca[Ca.sOo=4]="splitParagraphOp";Ca[Ca.dKo=5]="mergeParagraphOp";Ca[Ca.rMo=6]="replaceSymbolRangeOp"})(jd||(jd={}));Object(l.b)("RttOpType",jd);var pe=c(135);class ue extends Yd{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi){super(Nc,sd,
Id,We,Fd,Ff,Ac,Qi,6);this.font=Ca;this.legacy=vb}Yif(){return"OffsetStart: "+this.JQ+"OffsetEnd: "+this.i3}serialize(){const Ca=this.Dwh();return new Yb(this.metadata.packetId,this.metadata.clientId,1,7,Ca,null,this.Q_,this.Tlb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){let vb,hc,Nc,sd;if(!({JQ:vb,i3:hc,Nc,mj:sd}=Yd.Pej(Ca)).returnValue)return null;let Id,We;if(1===Ca.text.length)Id=!1,We=pe.AParagraphNode.IB;else if(2===Ca.text.length)if(ua.a.Kei(Ca.text,
0)&&ua.a.Ty(Ca.text,1))Id=!0,We=Ca.text;else return h.ULS.sendTraceTag(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",Ca.ft),null;else return h.ULS.sendTraceTag(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",Ca.ft),null;const Fd=Ca.P1c,Ff=dg.create(Ca);return new ue(Fd.q4f,Fd.r4f,Id,Nc,sd,vb,hc,Ca.WLb,We,Ca.xS.YG,Ff)}}Object(l.a)(ue,"RttReplaceSymbolRangeOp",Yd,[689,711]);class Od extends Yd{constructor(Ca,vb,hc,Nc,
sd,Id,We,Fd){super(Ca,vb,hc,Nc,sd,Id,We,Fd,1)}Yif(){return"OffsetStart: "+this.JQ+"OffsetEnd: "+this.i3+"TextAddedLength: "+this.Tlb.length}serialize(){const Ca=this.Dwh();return new Yb(this.metadata.packetId,this.metadata.clientId,1,2,Ca,null,this.Q_,this.Tlb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){let vb,hc,Nc,sd;if(!({JQ:vb,i3:hc,Nc,mj:sd}=Yd.Pej(Ca)).returnValue)return null;let Id="";Ca.text&&(Id=Ca.text);const We=dg.create(Ca);return new Od(Nc,
sd,vb,hc,Ca.WLb,Id,Ca.xS.YG,We)}static gIl(Ca,vb,hc){if(Ca.type)return null;const Nc=hc.EOa(Ca.j3.characterData,Ca.j3.qa);return new Od(Ca.j3.Nc,Ca.j3.mj,hc.yic(Nc,Ca.cpBegin),hc.yic(Nc,Ca.cpEnd),Ca.Sua.mj,Ca.Tua,Ca.YG,vb)}}Object(l.a)(Od,"RttReplaceTextRangeOp",Yd,[689,711]);class zf{constructor(Ca,vb,hc,Nc,sd,Id,We,Fd,Ff,Ac,Qi,Tc,uj,oj,ti,Th,di,Nj,im,Hg){this.Pq=null;this.Lve=this.R6g=!1;this.m$c=!0;this.QTg=0;this.z0g=this.UGe=this.B0g=this.y0g=this.A0g=this.e2g=!1;this.OIf=()=>{h.ULS.sendTraceTag(7685328,
355,50,"All prerequisite ready for RttManager");this.Pq=this.cda.result;h.ULS.sendTraceTag(7685330,355,50,"Subscribing to presence updates");this.Pq.B5(this.Vaa)};this.Vaa=(ah,Ji)=>{if(3===Ji.type||10===Ji.type)if(10===Ji.type)this.QTg="boolean"===typeof Ji.BM?Ji.BM?1:0:Ji.BM;else if(this.PSb.value&&!this.PSb.value.XKd)h.ULS.sendTraceTag(8454939,355,15,"RTT channel did not get disconnected on lock release");else if(Ji.BM){if(this.Xkn(),(ah=this.DVk(Ji.BM))&&1!==ah.metadata.clientType){this.Wkn();
if(this.Eo&&!this.Eo.vaa&&!Ae.a.NMa&&!Ae.a.Afa&&(u.AFrameworkApplication.Ne("1i00j689;ba0dg262"),this.e2g&&!Ae.a.NMa&&!Ae.a.Afa))return;if(2!==this.QTg)switch(this.IUb&&this.m$c&&(this.HUb.sMi(),this.m$c=!1),this.R6g||this.a4l(),ah.opType){case 1:case 6:case 4:if(!({Dg:ah}=this.R2j(ah)).returnValue)break;this.m4g?this.JWi(ah):this.Sfj(ah);break;case 2:this.zjc.add(ah),this.e9h(ah),this.m4g?this.JWi(ee.a.nil):this.Rfj(ah)}}}else h.ULS.sendTraceTag(7685331,355,15,"RTT packet was empty")};this.l7k=()=>
{const ah=this.Ci.value;if(ah){var Ji=this.kA()-zf.nrn,Jh=this.Sob.iHd(Bh=>Bh.metadata.e6f<Ji);0<Jh.count&&this.Bjn();var Dl=new Eb.a;for(let Bh of Jh)if(this.Sob.DSf(Bh),Bh.F5)switch(Bh.F5.opType){case 1:Dl.add(Bh.F5.paragraphId.toString());break;case 6:Dl.add(Bh.F5.paragraphId.toString());break;case 4:Dl.add(Bh.F5.L9d.toString()),Dl.add(Bh.F5.iDc.toString())}Jh=this.zjc.iHd(Bh=>Bh.metadata.e6f<Ji);for(let Bh of Jh)this.zjc.DSf(Bh),Bh.F5&&Dl.add(Bh.F5.paragraphId.toString());for(let Bh of Dl)(Dl=
ah.Db(ee.a.Pf(Bh)))?Dl.vN?(this.ytb.crn(Dl),Dl.vN||this.prc.value.fQi(Dl)):h.ULS.sendTraceTag(8765829,355,15,"Expiring wet change from paragraph with no applied changes"):h.ULS.sendTraceTag(8765828,355,15,"Expiring wet change with invalid object ID")}else this.Ci.iLd&&h.ULS.sendTraceTag(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")};this.ytb=Ca;this.Sob=vb;this.prc=hc;this.PSb=Nc;this.TH=sd;this.cda=Id;this.Ci=We;this.Hb=Fd;this.kA=Ff;this.oub=Ac;this.nd=Qi;this.yDe=
uj;this.Hc=oj;this.m4g=ti;this.HUb=Th;this.IUb=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RttPerfMetricsIsEnabled",!1);this.Qnb=di;this.iNe=Nj;this.utc=new tj.a(Pa.a.Sj());this.zjc=new ec;Tc.execute(zf.Anf);this.e2g=im;this.Eo=Hg}a4l(){const Ca=new Ga.a(3,2,zf.otn,this.l7k);this.Hb.fc(Ca);this.R6g=!0}init(){return this.cda?this.cda.continueWith(this.OIf):H.Task.C$(!1)}DVk(Ca){Ca=ud(Ca);if(!Ca)return null;switch(Ca.ft){case 2:return Od.create(Ca);
case 7:return ue.create(Ca);case 4:return Ll.create(Ca);case 3:return Cc.create(Ca);default:return h.ULS.sendTraceTag(8459668,355,50,"RTT packet is of unexpected operationType {0}",Ca.ft),null}}R2j(Ca){let vb=ee.a.nil;if(!this.Sob.Q2j(Ca))return{returnValue:!1,Dg:vb};this.e9h(Ca);if(!this.TH)return{returnValue:!1,Dg:vb};const hc=this.TH.keb(Ca.Nc);if(hc.equals(ee.a.nil)||!this.Ci.value.Db(hc))return Ca.activity.gMi(),{returnValue:!1,Dg:vb};this.vMi();return{returnValue:!0,Dg:hc}}JWi(Ca){Ca.equals(ee.a.nil)||
this.utc.add(Ca.toString());this.Lve||(Ca=new Ga.a(0,1,200,()=>{this.Vfo();this.Lve=!1},71),this.Hb.fc(Ca),this.Lve=!0)}TEn(Ca){Ca=new Ga.a(0,1,0,Ca,71);this.Hb.fc(Ca)}e9h(Ca){Ca.activity=Pc.create(this.nd);Ca.activity.Mkn(Ca.metadata.packetVersion);Ca.activity.Lkn(jd[Ca.opType])}Vfo(){var Ca=this.zjc.iHd(hc=>!hc.F5);for(let hc of Ca)this.Rfj(hc);if(this.utc.count){Ca=null;for(var vb of this.utc){vb=ee.a.Pf(vb);Ca=this.Ci.value.Db(vb);break}vb=this.Hc.Rc(3);try{vb.Eb(Ca);for(let hc of this.utc)this.Sfj(ee.a.Pf(hc))}finally{vb&&
vb.dispose()}this.utc.clear()}}Sfj(Ca){Ca=this.Ci.value.Db(Ca);let vb;const hc=this.Hc.Rc(3);try{hc.Eb(Ca);vb=this.nd.qo(ai.a.peh);const Nc=this.teh(Ca,vb);vb.end();Nc&&this.F5j(Nc)}finally{hc&&hc.dispose(),this.IUb&&(this.HUb.ZQf(1),this.m$c=!0)}}Rfj(Ca){var vb=this.ytb.zal(Ca,this.TH,this.Ci.value);vb&&(this.vMi(),this.ytb.heo(Ca,vb,this.Qnb,oa.a.instance.resolve("Box4.IParagraphEditor"))&&(vb=this.Ci.value.Db(Ca.F5.paragraphId),this.Meh(vb,Ca),this.IUb&&(this.HUb.ZQf(1),this.m$c=!0)))}F5j(Ca){this.yDe.continueWith(()=>
{if(1===Ca.opType){var vb=this.qGl(Ca);vb&&(this.yDe.result.POe(vb),this.yDe.result.k4d(!0))}})}qGl(Ca){const vb=Ca.serialize();if(2!==vb.ft||vb.xS.FDa&&vb.xS.COa!==vb.xS.FDa)return null;const hc=Ca.JQ.clone();0<Ca.Tlb.length&&(hc.Boh(),hc.cp+=Ca.Tlb.length);vb.ft=0;vb.text=null;vb.xS.$2d=0;vb.xS.JQ=hc;vb.xS.$3a=vb.WLb;vb.xS.FDa=null;vb.xS.vgc=null;vb.xS.i3=null;vb.WLb=null;return id.m0e(vb,this.TH,this.oub,()=>this.Ci.value,this.iNe.instance)}Meh(Ca,vb){return this.prc.value?this.prc.value.J1j(Ca,
vb.metadata.clientId).returnValue?!0:(h.ULS.sendTraceTag(7866379,355,15,"Unable to apply a wet change lock"),!1):(h.ULS.shipAssertTag(7866378,355,!!this.prc.value,"Unable to apply wet changes as LockManager unavailable"),!1)}seh(Ca,vb){this.teh(Ca,vb)}teh(Ca,vb){if(!Ca)return null;if(!Ca.anchor)return vb&&vb.properties.Z(zf.rvi,"1"),null;if(!Ca.hasProperty(Fg.a.Nc))return h.ULS.sendTraceTag(7619922,355,15,"Paragraph is missing the WordId property"),null;if(!Ca.hasProperty(Fg.a.mj))return h.ULS.sendTraceTag(8197722,
355,15,"Paragraph is missing the TextId property"),null;if(Ca.hasProperty(Fg.a.uBh)&&Ca.getValue(Fg.a.uBh))return h.ULS.sendTraceTag(16815506,355,50,"RTT edit disabled in paragraph"),null;const hc=Ca.getValue(Fg.a.Nc);var Nc=Ca.Wka;vb&&(vb.properties.Z(zf.hOm,Nc.toString()),vb.properties.Z(zf.jOm,hc.toString()));Nc=this.Sob.pgf(hc,Nc);if(!Nc)return vb&&vb.properties.Z(zf.evi,"1"),null;if(!this.Meh(Ca,Nc))return vb&&vb.properties.Z(zf.Nth,"1"),null;let sd=0,Id=null;for(;Nc;){if(!this.ytb.$ek(Nc,Ca,
this.Qnb,vb)){vb&&vb.properties.Z(zf.Xmj,"1");break}sd++;Nc.activity.Ajn(this.kA());Id=Nc;Nc=Ca.Wka;Nc=this.Sob.pgf(hc,Nc)}0<sd&&this.OLi();vb&&vb.properties.add(zf.Ymj,sd.toString());return Id}R3d(Ca){if(Ca.hasProperty(Fg.a.Nc)&&Ca.hasProperty(Fg.a.mj)){var vb=Ca.getValue(Fg.a.Nc),hc=Ca.ia(Fg.a.mj,0),Nc=this.nd.qo(ai.a.nOi),sd=this.Qnb.fVm(Ca.id);0<sd.count&&(this.ytb.EVf(Ca,sd,this.Ci.value),this.Krn(Ca,sd,hc));var Id=this.Qnb.Eil(vb);if(Id&&!Ca.id.equals(Id.paragraphId)){const We=this.Ci.value;
this.TEn(()=>{const Fd=this.Qnb.uib(Id.paragraphId),Ff=We.Db(Id.paragraphId);h.ULS.shipAssertTag(16820032,355,!!Ff,"Could not find added graph node");Ff&&(this.ytb.EVf(Ff,Fd,We),this.zjc.ASf(Id.QOe))})}this.Sob.pgf(vb,hc)||this.prc.value.fQi(Ca);this.seh(Ca,Nc);Nc.end()}}Krn(Ca,vb,hc){let Nc=!1;for(let Id=vb.count-1;0<=Id;Id--){var sd=vb.J(Id);switch(sd.opType){case 1:case 6:case 4:sd=Object(v.a)(689,sd.operation);break;default:continue}sd.Q_===hc&&(Nc=!0,sd.P4a&&!sd.P4a.Zro(Ca)&&h.ULS.sendTraceTag(8765831,
355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",sd.opType,sd.Yif(),Ca.id,sd.P4a.id,sd.P4a.cpBegin,sd.P4a.cpEnd));Nc&&this.Sob.ASf(sd)}Nc&&this.OLi()}PTc(Ca){const vb=this.Qnb.uib(Ca.id);0<vb.count&&(2===vb.J(0).opType&&vb.removeAt(0),this.ytb.EVf(Ca,vb,this.Ci.value))}k8d(Ca){var vb=this.Qnb.pDl(Ca.id);for(let hc of vb)if(4===hc.opType&&(vb=Object(v.a)(Wk,hc),Ca.id.equals(vb.j1j)))return!0;return!1}Xkn(){this.A0g||
(h.ULS.sendTraceTag(8704354,355,50,"Received a wet change"),this.A0g=!0)}Wkn(){this.y0g||(h.ULS.sendTraceTag(8185606,355,50,"Received a wet change that we could deserialize"),this.y0g=!0)}vMi(){this.B0g||(h.ULS.sendTraceTag(17147533,355,50,"Received a usable wet change"),this.B0g=!0)}OLi(){this.UGe||(h.ULS.sendTraceTag(8185607,355,50,"Successfully applied a wet change"),this.UGe=!0)}Bjn(){this.UGe||this.z0g||(h.ULS.sendTraceTag(8185608,355,15,"Failed to apply any wet changes so far"),this.z0g=!0)}static Anf(Ca){const vb=
[ai.a.peh,ai.a.nOi];for(let hc of vb)Ca.I3(hc,zf.Ymj,cb.a.ssa),Ca.I3(hc,zf.evi,cb.a.ssa),Ca.I3(hc,zf.rvi,cb.a.ssa),Ca.I3(hc,zf.Nth,cb.a.ssa),Ca.I3(hc,zf.Xmj,cb.a.ssa),Ca.I3(hc,vf.AEi,cb.a.ssa),Ca.I3(hc,vf.Ogj,cb.a.ssa);Pc.Anf(Ca)}}zf.otn=6E4;zf.nrn=18E4;zf.Ymj="WetChangeCount";zf.evi="NoChangesToApply";zf.rvi="NodeNotConnected";zf.Nth="CouldNotGetLock";zf.Xmj="WetChangeBlocked";zf.jOm="NodeWordId";zf.hOm="NodeTextId";Object(l.a)(zf,"RttManager",null,[690]);class Tf{constructor(Ca,vb){this.qVi=0;this.Aeb=
Ca;this.QCn=vb}sMi(){this.qVi=this.Aeb()}ZQf(Ca){const vb=this.Aeb()-this.qVi;0<=vb&&this.QCn.track(Math.round(vb),0===Ca?"CTB":"RTP")}}Object(l.a)(Tf,"RttPerfCounter",null,[687]);var dc=c(1830);class Oi{constructor(){this.Zuc=new dc.a}m6j(Ca,vb){this.Zuc.back()&&vb&&this.Zuc.back().gbb(Ca)||this.Zuc.enqueue(Ca)}aCl(){return this.Zuc.isEmpty?null:this.Zuc.dequeue()}}Object(l.a)(Oi,"RttSendDataStore",null,[686]);class Ci extends yf{constructor(Ca,vb,hc,Nc){super(3,Nc);this.Nc=Ca;this.mj=vb;this.YG=
hc}get Q_(){return 0}serialize(){const Ca=new Fe.a(4,this.Nc,this.mj,null,null,null,null,this.YG);return new Yb(this.metadata.packetId,this.metadata.clientId,1,5,Ca,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){const vb=Ca.xS;return new Ci(vb.COa,vb.$3a,vb.YG,dg.create(Ca))}static hJl(Ca,vb){return 4!==Ca.type?null:new Ci(Ca.k0b.Nc,Ca.k0b.mj,Ca.YG,vb)}}Object(l.a)(Ci,"RttDeleteParagraphOp",yf,[689,711]);class oi extends yf{constructor(Ca,
vb,hc,Nc,sd,Id,We,Fd){super(5,Fd);this.Zag=Ca;this.Bbj=vb;this.svo=hc;this.r$n=Nc;this.YG=sd;this.Lnj=Id;this.wgc=We}get Nc(){return this.Zag}get mj(){return this.Bbj}get Q_(){return this.Zag===this.Lnj?this.wgc:0}serialize(){const Ca=new Fe.a(5,this.Zag,this.Bbj,null,this.svo,this.r$n,null,this.YG),vb=new Jb(this.Lnj,this.wgc);return new Yb(this.metadata.packetId,this.metadata.clientId,1,6,Ca,null,void 0,void 0,void 0,vb,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ca){const vb=
Ca.xS,hc=Ca.dSc;return new oi(vb.COa,vb.$3a,vb.FDa,vb.vgc,vb.YG,hc.HKf,hc.wgc,dg.create(Ca))}static iJl(Ca,vb){return 2!==Ca.type?null:new oi(Ca.kna.Nc,Ca.kna.mj,Ca.lOa.Nc,Ca.lOa.mj,Ca.YG,Ca.fVd.Nc,Ca.fVd.mj,vb)}}Object(l.a)(oi,"RttMergeParagraphOp",yf,[689,711]);class Wg{constructor(Ca,vb,hc,Nc,sd,Id){this.Evc=this.ij=null;this.Kca=!1;this.YKe=this.J4g=0;this.Zmd=this.U5g=!1;this.XFe=0;this.OIf=()=>{h.ULS.sendTraceTag(8245954,355,50,"All prerequisites ready for RttSendManager");this.ij=this.cda.result;
this.ij.y3d(this)};this.pAi=(We,Fd)=>{if(this.ij&&2===this.ij.connectionState&&(We=Fd.FF,We.length))if(Fd.S9)100>this.YKe&&(this.YKe++,h.ULS.sendTraceTag(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",Fd.fkk,this.J4g,this.YKe));else{for(Fd=0;Fd<We.length;Fd++)if(!this.bpm(We[Fd]))return;for(Fd=0;Fd<We.length;Fd++){let Ff=We[Fd];this.y_g.m6j(Ff,!Ff.type&&!Fd)}this.Evc||this.Xzi(this.Evc,this.ij)}};this.cda=Ca;this.y_g=vb;this.Oca=hc;this.xt=Nc;this.vra=sd;this.HUb=
Id;this.IUb=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RttPerfMetricsIsEnabled",!1)}get Kp(){return this.Oca.value}init(){return this.cda?this.cda.continueWith(this.OIf):H.Task.C$(!1)}start(){this.Kca||(this.xt.Xc?(this.xt.Xc.FF.c$j(this.pAi),this.Kca=!0):h.ULS.sendTraceTag(522740420,355,10,"No activePage, RttSendManager not started"))}stop(){this.Kca&&(this.Kca=!1,this.xt.Xc.FF.Eun(this.pAi))}bpm(Ca){return Ca&&-1!==Ca.YG?Ca.type&&3!==
Ca.type&&1!==Ca.type?!1:!0:!1}rDm(){this.Zmd||(this.U5g||(h.ULS.sendTraceTag(8270468,355,50,"Preparing to send RTT change"),this.U5g=!0),!this.Zmd&&5>=this.XFe&&this.XFe++)}FDm(){!this.Zmd&&5>=this.XFe&&(h.ULS.sendTraceTag(8270469,355,50,"Sent Rtt Message"),this.Zmd=!0)}Xzi(Ca,vb){this.rDm();Ca&&(Ca.Ki||Ca.jo)&&h.ULS.sendTraceTag(8245956,355,15,"Task is faulted or cancelled with exception {0}",Ca.exception);this.IUb&&this.HUb.sMi();(Ca=this.jJl(this.y_g.aCl()))?(this.J4g++,this.Evc=vb.rO(3,Ce(Ca.serialize())),
this.FDm(),this.IUb&&this.HUb.ZQf(0),this.Evc.continueWith(hc=>{this.Xzi(hc,vb)})):this.Evc=null}jJl(Ca){if(!Ca)return null;if(!this.Kp)return h.ULS.sendTraceTag(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;const vb=new dg(ki.instance.fWh(),this.Kp.pj,1,0,0,te.instance.nCl());let hc=null;switch(Ca.type){case 0:hc=Od.gIl(Ca,vb,this.vra);break;case 4:hc=Ci.hJl(Ca,vb);break;case 3:hc=Cc.gJl(Ca,vb);break;case 2:hc=oi.iJl(Ca,vb);break;case 1:hc=Ll.kJl(Ca,
vb,this.vra)}return hc}}Object(l.a)(Wg,"RttSendManager",null,[681]);class Bk{constructor(){this.W=null;this.hAl=()=>fb.App.vd&&fb.App.vd.Mq?fb.App.vd.Mq:(h.ULS.sendTraceTag(7866377,304,15,"Unable to get the lock manager"),null)}get name(){return"WordEditor.RealTimeTyping"}zc(Ca){const vb=ka.a.Lq(Ca.$a("Box4.IOutlineElementEditor")),hc=ka.a.Lq(Ca.$a("Box4.IFeatureHelper")),Nc=ka.a.Lq(Ca.$a("Common.IActivityAggregationInfo")),sd=ka.a.Lq(Ca.$a("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator")),
Id=ka.a.Lq(Ca.$a("Box4.CompositionStateManager"));this.W=Ca;const We=new Be.a;H.Task.WAA.call(null,vb,hc,Nc,sd,Id).continueWith(()=>{Ca.ha("WordEditor.RealTimeTyping.IRttEditor",()=>new vf(Ca.resolve("Box4.ICharacterPropertiesEditor"),Ca.resolve("Box4.IOutlineElementEditor"),We,Ca.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Ca.register(Tf,"WordEditor.RttPerfCounter").as("WordEditor.IRttPerfCounter").singleInstance().Zd(()=>new Tf(pf.a.kf,Mf.a.vF(17,
1,new li.a(new Kh.a(.25)))));Ca.ha("WordEditor.RealTimeTyping.RttManager",()=>new zf(Ca.resolve("WordEditor.RealTimeTyping.IRttEditor"),new Qd(Gj.a.instance),new I.a(this.hAl),new I.a(()=>fb.App.S_),Ca.resolve("WordEditor.ParagraphWordIdMapping"),Ca.resolve("Box4.Presence.IRtcProxyProvider").CI(),new I.a(()=>fb.App.xa.jb&&fb.App.xa.jb.Xc?fb.App.xa.jb.Xc.Ad:(h.ULS.sendTraceTag(522740419,304,10,"No activePage or workspace."),null)),Xa.a.instance,()=>Date.now(),Ca.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),
Gj.a.instance,Ca.$a("Common.IActivityAggregationInfo"),Zd.CI(),We,u.AFrameworkApplication.K.$("WordEditorThrottleAndBatchRTTRendering"),Ca.resolve("WordEditor.IRttPerfCounter"),new Pl,Ca.$a("WordEditor.Presence.IWordPresenceCpFactory"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipUpdateGraphWhenComposing",!1),Ca.resolve("Box4.CompositionStateManager"))).as("WordEditor.RealTimeTyping.IRttManager").singleInstance();Ca.ha("WordEditor.RealTimeTyping.RttSendManager",
()=>new Wg(Ca.resolve("Box4.Presence.IRtcProxyProvider").CI(),new Oi,new I.a(()=>fb.App.vd),fb.App.xa.jb,Ca.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Ca.resolve("WordEditor.IRttPerfCounter"))).singleInstance();this.Bnf()})}Bnf(){this.W.resolve("WordEditor.RealTimeTyping.RttManager").init();this.W.resolve("WordEditor.RealTimeTyping.RttSendManager").init()}init(){}dispose(){}static main(){ra.a.instance.Pc(new Bk)}}Object(l.a)(Bk,"WordEditorRealTimeTypingPackage",null,
[1,2]);Type.registerNamespace("BPr");Type.registerNamespace("Box4.Presence");Type.registerNamespace("RealtimePresenceUI");Type.registerNamespace("WERTT");Type.registerNamespace("WordEditor.PeoplesWellControl");Type.registerNamespace("WordEditor.Presence");Type.registerNamespace("AppRealtimeChannel");Type.registerNamespace("Common.App.CoauthTelemetry");ia.main();Type.registerNamespace("Common.App.CollabControls");za.prototype.toString=Ma.a.prototype.toString;pa.prototype.toString=Ma.a.prototype.toString;
ra.a.instance.Pc(new Xg);Bk.main();Type.registerNamespace("RealtimePresenceUI");ra.a.instance.Pc(new ad);Type.registerNamespace("Common.App.RtcHostNotificationSubscription");qa.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16817908/wdjs/WordEditorDS.collab.js.map