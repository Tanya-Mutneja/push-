'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1009:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.globalThis=void 0;C=c(1192);O.globalThis=C},1021:function(C,O,c){function l(K,N=self){N.addEventListener("message",function S(P){if(P&&P.data){var {id:W,type:X,path:Y}=Object.assign({path:[]},P.data),ca=(P.data.ffh||[]).map(u);try{const ra=Y.slice(0,-1).reduce((oa,ka)=>oa[ka],K),sa=Y.reduce((oa,ka)=>oa[ka],K);switch(X){case "GET":var ha=
sa;break;case "SET":ra[Y.slice(-1)[0]]=u(P.data.value);ha=!0;break;case "APPLY":ha=sa.apply(ra,ca);break;case "CONSTRUCT":const oa=new sa(...ca);ha=Object.assign(oa,{[A]:!0});break;case "ENDPOINT":const {port1:ka,port2:ia}=new MessageChannel;l(K,ia);ha=m(ka,[ka]);break;case "RELEASE":ha=void 0;break;default:return}}catch(ra){ha={value:ra,[L]:0}}Promise.resolve(ha).catch(ra=>({value:ra,[L]:0})).then(ra=>{const [sa,oa]=v(ra);N.postMessage(Object.assign(Object.assign({},sa),{id:W}),oa);"RELEASE"===X&&
(N.removeEventListener("message",S),"MessagePort"===N.constructor.name&&N.close())})}});N.start&&N.start()}function e(K){if(K)throw Error("Proxy has been released and is not useable");}function a(K,N=[],G=function(){}){let P=!1;const S=new Proxy(G,{get(W,X){e(P);if(X===E)return()=>n(K,{type:"RELEASE",path:N.map(Y=>Y.toString())}).then(()=>{"MessagePort"===K.constructor.name&&K.close();P=!0});if("then"===X){if(0===N.length)return{then:()=>S};W=n(K,{type:"GET",path:N.map(Y=>Y.toString())}).then(u);
return W.then.bind(W)}return a(K,[...N,X])},set(W,X,Y){e(P);const [ca,ha]=v(Y);return n(K,{type:"SET",path:[...N,X].map(ra=>ra.toString()),value:ca},ha).then(u)},apply(W,X,Y){e(P);W=N[N.length-1];if(W===H)return n(K,{type:"ENDPOINT"}).then(u);if("bind"===W)return a(K,N.slice(0,-1));const [ca,ha]=h(Y);return n(K,{type:"APPLY",path:N.map(ra=>ra.toString()),ffh:ca},ha).then(u)},construct(W,X){e(P);const [Y,ca]=h(X);return n(K,{type:"CONSTRUCT",path:N.map(ha=>ha.toString()),ffh:Y},ca).then(u)}});return S}
function h(K){K=K.map(v);return[K.map(N=>N[0]),Array.prototype.concat.apply([],K.map(N=>N[1]))]}function m(K,N){J.set(K,N);return K}function v(K){for(const [N,G]of F)if(G.dlh(K)){const [P,S]=G.serialize(K);return[{type:"HANDLER",name:N,value:P},S]}return[{type:"RAW",value:K},J.get(K)||[]]}function u(K){switch(K.type){case "HANDLER":return F.get(K.name).deserialize(K.value);case "RAW":return K.value}}function n(K,N,G){return new Promise(P=>{const S=x();K.addEventListener("message",function Y(X){X.data&&
X.data.id&&X.data.id===S&&(K.removeEventListener("message",Y),P(X.data))});K.start&&K.start();K.postMessage(Object.assign({id:S},N),G)})}function x(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}C=c(0);const A=Symbol("Comlink.proxy"),H=Symbol("Comlink.endpoint"),E=Symbol("Comlink.releaseProxy"),L=Symbol("Comlink.thrown"),M=K=>"object"===typeof K&&null!==K||"function"===typeof K,F=new Map([["proxy",{dlh:K=>M(K)&&K[A],serialize(K){const {port1:N,
port2:G}=new MessageChannel;l(K,N);return[G,[G]]},deserialize(K){K.start();return a(K,[],void 0)}}],["throw",{dlh:K=>M(K)&&L in K,serialize({value:K}){return[K instanceof Error?{qfa:!0,value:{message:K.message,name:K.name,stack:K.stack}}:{qfa:!1,value:K},[]]},deserialize(K){if(K.qfa)throw Object.assign(Error(K.value.message),K.value);throw K.value;}}]]),J=new WeakMap;c.d(O,"a",function(){return I});class I{static Cvj(K){I.f7a=K;I.V0j=a(K,[],void 0)}static get Endpoint(){return I.f7a}static get Dvj(){return I.V0j}}
Object(C.a)(I,"WorkerUtils",null,[])},1036:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{}Object(C.a)(l,"WaterlineOverrideSettings",null,[])},1037:function(C,O,c){function l(x){return{scriptUrl:x,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}c.r(O);c.d(O,"UlsWorkerService",function(){return u});c.d(O,"ulsWorkerInsideInit",function(){return n});c.d(O,"ulsWorkerInsideScript",function(){return l});C=c(0);var e=c(848),a=c(977),h=c(23),m=c(2),v=c(855);class u{constructor(x,
A,H,E,L){this.h_j=new a.a(x,A,H,E,L)}HW(x){this.h_j.HW(x)}}Object(C.a)(u,"UlsWorkerService",null,[]);const n=({config:x,connection:A})=>{"Thread"===A.createMode&&e.setConfig(x);x=h.a.instance.Pa("Common.IRefreshableAppSettings");const H=new u(v.a.Ryd,!0,m.AFrameworkApplication.af,null!==x&&void 0!==x?x:m.AFrameworkApplication.K,x);return e.Endpoint.E0e(A,()=>H)}},1038:function(C,O,c){C=c(0);var l=c(447),e=c(543),a=c(683),h=c(244);class m extends h.a{constructor(){super();this.LowWaterline=this.HighWaterline=
this.FileId=null}Tl(){return 97}static d$(H,E,L){const M=new m;M.FileId=H;M.HighWaterline=E;M.LowWaterline=L;return M}}Object(C.a)(m,"GetActivitiesRequest",h.a,[]);class v extends h.a{constructor(H,E,L){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=H;this.Waterline=E;this.Settings=L}Tl(){return 107}static d$(H,E,L){return new v(H,E,L)}}Object(C.a)(v,"GetRelevantActivitiesRequest",h.a,[]);class u extends h.a{constructor(H,E){super();this.WaterlineOverrideSettings=this.FileId=null;
this.FileId=H;this.WaterlineOverrideSettings=E}Tl(){return 96}static d$(H,E){return new u(H,E)}}Object(C.a)(u,"GetWywaActivitiesRequest",h.a,[]);class n{}Object(C.a)(n,"RelevantActivitiesSettings",null,[]);class x extends h.a{constructor(){super();this.FileId=null}Tl(){return 109}static d$(H){const E=new x;E.FileId=H;return E}}Object(C.a)(x,"UpdateWaterlineRequest",h.a,[]);c.d(O,"a",function(){return A});class A{constructor(H,E,L,M,F){this.BOj=H;this.Lkd=E;this.$Ee=L;this.Lnb=M;this.Hyg=F}requestWYWAActivities(H){H=
u.d$(this.Lkd(),H);return l.a.then(this.t$(H,"wywa"),E=>E)}requestActivities(H,E){H=m.d$(this.Lkd(),H,E);return l.a.then(this.t$(H,"activities"),L=>L)}lyn(){const H=x.d$(this.Lkd());return l.a.then(this.t$(H,"waterline"),E=>E)}requestRelevantActivities(H,E){E=Object.assign(new n,{FirstDocumentOpen:E,MockDataEnabled:!1});H=v.d$(this.Lkd(),H,E);return l.a.then(this.t$(H,"relevant"),L=>L)}updateActivityState(H){return l.a.o2c(this.Hyg,E=>E.Uio(H.itemIds,H.activityStatesToSet,H.activityStatesToReset,
H.resetUnseenCount))}requestActivityFeed(){return l.a.o2c(this.Hyg,H=>H.getActivityFeed(null))}t$(H,E){const L={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.o2c(this.BOj,M=>M.iy(this.$Ee,L,e.a.Frh(H,this.Lnb),E)),M=>{if(!(M&&M.args&&M.args.data&&M.args.data.Ie))return null;({group:M}=a.a.g8(M.args.data.Ie));return M&&M.Responses&&M.Responses.length?M.Responses[0]:null})}}Object(C.a)(A,"SharedActivityRepository",null,[])},1192:function(C,O,c){C.exports=c(1193)()?globalThis:
c(1194)},1193:function(C){C.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1194:function(C){function O(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}C.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(c){return O()}try{return __global__?__global__:O()}finally{delete Object.prototype.FDo}}()},
1195:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.Mqi=void 0;var l=c(923);O.Mqi=function(e){return function(a){var h=e[a];switch(typeof h){case "boolean":return(0,l.getBooleanFeatureGate)(a,h);case "number":return(0,l.yWh)(a,h);case "string":return(0,l.getStringFeatureGate)(a,h);default:throw Error("Wrong defaultValue type");}}}},1196:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.Rqi=void 0;var l=c(924);O.Rqi=function(){return function(e){return(0,l.isChangeGateEnabled)(e)}}},
1197:function(C,O,c){function l(h){var m=(0,a.hYf)(void 0);(0,a.hYf)(function(){var v=void 0!==m?m():{};return e.__assign(e.__assign({},v),h)});return m}Object.defineProperty(O,"__esModule",{value:!0});O.H2m=O.F2m=void 0;var e=c(79),a=c(924);O.F2m=l;O.H2m=function(h,m){return l(m)}},1198:function(C,O,c){function l(h){function m(){return{}}for(var v,u,n={},x=0,A=Object.keys(h);x<A.length;x++){var H=A[x];n[H]=null===(v=h[H])||void 0===v?void 0:v.toString()}var E=null!==(u=(0,a.BYf)(void 0))&&void 0!==
u?u:m;(0,a.BYf)(function(){return e.__assign(e.__assign({},E()),n)});return E}Object.defineProperty(O,"__esModule",{value:!0});O.I2m=O.G2m=void 0;var e=c(79),a=c(923);O.G2m=l;O.I2m=function(h,m){return l(m)}},1368:function(C,O,c){c.d(O,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.FAo=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.VCo=1]="VoiceDictationBadge";a[a.WCo=2]="VoiceDictationPhrase"})(e||(e={}))},1467:function(C,O,c){c.r(O);c.d(O,
"Box4PasteSteward",function(){return ca});C=c(0);var l=c(23),e=c(2),a=c(17),h=c(127),m=c(60),v=c(5),u=c(8),n=c(32),x=c(77),A=c(9),H=c(141),E=c(11),L=c(3),M=c(20),F=c(6),J=c(68),I=c(191),K=c(40),N=c(93),G=c(43),P=c(47),S=c(33),W=c(475),X=c(474),Y=c(1676);class ca extends Y.a{constructor(ha,ra,sa,oa,ka,ia,La,va=null,Ga=null){super(ha,La,va,Ga);this._formatting=null;this.oHa=!1;this.oqb=null;this.uRb=-1;this.Urb=0;this.Dwc=new x.a;this.aIm=4294967295;n.a(4223754,307,G.OutlineElementReader.Nh(ha));this.uqb=
ra;this.uqb.tYb(this);this.hL=sa;this.hL.tYb(this);this.xp=oa;this.No=ka;this.hFm=ia;this.OCe=J.ListReader.ei(this.Ac);ca.H5l();ca.t5l();ca.b6l()}get Wta(){return null!=this.Sng?this.Sng:this.Sng=l.a.instance.Pa("Box4.IInternalLinkManager")}get qyd(){return this._formatting}get f_b(){return this.OCe&&!this.hL.yAa}get oyb(){return 0<this.Urb}reset(){super.reset();this._formatting=this.Hdf(!1)}nRe(ha){n.a(4223762,307,G.OutlineElementReader.Nh(this.Ac)||N.OutlineReader.Aw(this.Ac));this.g$b(!1);var ra=
new F.GraphIterator;ra.ed(this.Ac);ha=Y.a.Ug.zN(this.Ac,this.WIc(ha));this.gsd(ra,!1);n.a(4223763,307,ha===this.Ac.currentNode);n.a(4223764,307,E.ParagraphReader.nc(ha));-1!==this._formatting.Zs&&ca.paragraphEditor.tD(ha,this._formatting.Zs);if(ca.paragraphEditor.xp&&!this.t0.o5i){if(this._formatting.textIndent){({unit:ka,returnValue:oa}=ca.WUc(this._formatting.textIndent));var sa=!1;if(oa||!J.ListReader.wZ){if(0>oa){sa=!0;var oa=-1*oa}var ka=ca.Ywd(oa,ka);sa?ca.paragraphEditor.xp.Ckb(ha,ka):ca.paragraphEditor.xp.uba(ha,
ka)}}!this._formatting.marginLeft||ca.ae.aEb||J.ListReader.ei(ra)||({unit:ra,returnValue:sa}=ca.WUc(this._formatting.marginLeft),ra=ca.Ywd(sa,ra),ca.paragraphEditor.xp.noa(ha,1,ra))}(ca.Rd.og||M.a.instance.J(3)&&A.App.Ev.Xgc)&&ha.setValue(v.a.NDb,!0);this._formatting.lineSpacing&&ca.paragraphEditor.jC(ha,this._formatting.lineSpacing);if(this._formatting.$fc){ra=[];sa=[];ka=[];oa=this._formatting.$fc.split(" ");let va=1,Ga=0;for(let Oa=0;Oa<oa.length;Oa++){var ia=ca.CHk(oa[Oa]),La=ca.BHk(oa[Oa]);if(-1!==
ia)va=ia;else if(-1!==La)Ga=La;else{({unit:ia,returnValue:La}=ca.WUc(oa[Oa]));ia=ca.Ywd(La,ia);if(0<=ia&&ia<=this.aIm)ra.push(ia),sa.push(va),ka.push(Ga);else{n.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.$fc+" index: "+Oa);break}va=1;Ga=0}}0<ra.length&&ca.paragraphEditor.D3j(ha,ra,sa,ka)}this._formatting.paragraph=ha;this.oHa=!0}gsd(ha,ra){n.a(8128518,307,!ra);this.jU&&(0<this.jU&&this.xp.TDc(ha,this.jU),0>this.jU&&this.xp.OOa(ha,this.jU,0));ha&&this.No.n7d(ha,this.oyb);
this.jU=0}Ibe(ha){this.Dwc.add(ha)}sXe(){this.jU=0}Uaa(ha,ra=null){n.a(4223772,307,E.ParagraphReader.yh(this.Ac));const sa=this.Ac.currentNode;this._formatting.t7f(sa);if(!this.t0.C7f(this.Ac,ra,!1)){var oa=sa.qa.last,ka=S.a.rw(sa);this.oHa&&(oa.formatting=this._formatting.YP.Yf(oa),M.a.instance.J(6)&&sa.yn(),this.oHa=!1);ha=this.t0.Mkf(ha,ra);this.t0.CEa(this.Ac.currentNode,this._formatting.cba,ra);this.characterPropertiesEditor.replaceTextRange(ka,ha,void 0,void 0,L.a.paste)}}sDa(ha){this.t0.eQd&&
this.t0.aPd(ha)?(this.UF(),this.VF(ha)):(n.a(4223773,307,E.ParagraphReader.yh(this.Ac)),ha=S.a.rw(this.Ac.currentNode),this.characterPropertiesEditor.ifa(ha,ra=>new W.a(ra)))}Iib(){this.t0.Rkf(this.Ac)}eva(ha){if(ca.B0k(ha)){const ra=this.Ac.currentNode;E.ParagraphReader.nc(ra)&&(ra.Zac=ha.Q8e)}else this.uqb.eva(ha)}oDa(ha){this._formatting=ha;this.oHa=!0}nOa(ha){n.a(4223774,307,E.ParagraphReader.yh(this.Ac));n.a(4223775,307,!this.oqb);n.a(4223776,307,0>this.uRb);this.oqb=ha;this.uRb=E.ParagraphReader.textLength(this.Ac.currentNode)}mOa(){n.a(4223777,
307,E.ParagraphReader.yh(this.Ac));n.a(4223778,307,!!this.oqb);n.a(4223779,307,0<=this.uRb);let ha=S.a.createTextRange(this.Ac.currentNode,this.uRb,E.ParagraphReader.textLength(this.Ac.currentNode)),ra="",sa="";this.Wta&&({hSf:ra,QLh:sa}=this.Wta.v7f(H.HyperlinkReader.bMa(this.oqb))).returnValue&&(this.oqb=ra,sa&&(this.characterPropertiesEditor.replaceTextRange(ha,sa),ha=S.a.createTextRange(this.Ac.currentNode,this.uRb,E.ParagraphReader.textLength(this.Ac.currentNode))));ca.hyperlinkEditor.VG(ha,
this.oqb,!1);this.oHa=!0;this.oqb=null;this.uRb=-1}VF(ha){this.nRe(ha);this._formatting.Wbe(this.Ac.currentNode);this.t0.CEa(this.Ac.currentNode,this._formatting.cba,ha)}UF(){n.a(4223808,307,E.ParagraphReader.yh(this.Ac));ca.hyperlinkEditor.D4k(this.Ac.currentNode);K.OutlineElementNavigator.Xd(this.Ac)}Fib(){}Eib(){}sOa(){}p1a(){}vDa(){n.a(4223809,307,G.OutlineElementReader.Nh(this.Ac)||N.OutlineReader.Aw(this.Ac));let ha=!1;this.oyb||(ha=this.f_b||!0);ha||(this.jU+=1);this.Urb++}tDa(){this.Urb--;
let ha=!1;this.oyb||(ha=this.f_b||!0,this.No.LSf(this.Dwc));ha||--this.jU}rOa(ha){n.a(4223810,307,G.OutlineElementReader.Nh(this.Ac)||N.OutlineReader.Aw(this.Ac));n.a(4223811,307,!!ha.listStyleType);this.No.m7d(this.Ttm(ha))}uDa(){n.a(4223813,307,G.OutlineElementReader.Nh(this.Ac));e.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ca.ae.aEb&&J.ListReader.ei(this.Ac)){const ha=E.ParagraphReader.Rm(this.Ac.currentNode),ra=this.hFm.ZAb(this.Ac);
X.a.ae.WL||this.No.l7d(ra,ha,null)}}s1a(ha){this.uqb.s1a(ha)}Taa(ha){this.hL.Taa(ha)}Qaa(){this.hL.Qaa()}Saa(ha){this.hL.Saa(ha)}Raa(){this.hL.Raa()}Paa(ha){this.hL.Paa(ha)}Oaa(){this.hL.Oaa()}static get paragraphEditor(){return null!=ca.tqg?ca.tqg:ca.tqg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ca.Qlg?ca.Qlg:ca.Qlg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Rd(){return null!=ca.ztg?ca.ztg:ca.ztg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get rag(){return null!=
ca.eug?ca.eug:ca.eug=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Ufc(){return ca.jJe}static set Ufc(ha){ca.jJe=ha}static get ae(){return I.a.getInstance()}static H5l(){const ha=M.a.instance.J(8);ca.G1a[1]=ha?P.StyleReader.wordStyleIdHeading1:P.StyleReader.styleIdHeading1;ca.G1a[2]=ha?P.StyleReader.wordStyleIdHeading2:P.StyleReader.styleIdHeading2;ca.G1a[3]=ha?P.StyleReader.wordStyleIdHeading3:P.StyleReader.styleIdHeading3;ca.G1a[4]=ha?P.StyleReader.V4a:P.StyleReader.qwa;ca.G1a[5]=
ha?P.StyleReader.W4a:P.StyleReader.qQa;ca.G1a[6]=ha?P.StyleReader.X4a:P.StyleReader.rQa;ca.G1a[7]=ha?null:P.StyleReader.K3a}static t5l(){ca.Eua.unspecified=0;ca.Eua.defaultUnordered=1;ca.Eua.defaultOrdered=1;ca.Eua.none=0;ca.Eua.disc=1;ca.Eua.circle=2;ca.Eua.square=3;ca.Eua.decimal=1;ca.Eua.lowerAlpha=2;ca.Eua.lowerRoman=3;ca.Eua.upperAlpha=4;ca.Eua.upperRoman=5}static b6l(){ca.jJe=ca.rag.Np()}static CHk(ha){let ra=-1;if(!ha)return ra;ha=ha.toLowerCase();switch(ha){case "left":ra=1;break;case "center":ra=
3;break;case "right":ra=4;break;case "decimal":ra=6;break;case "bar":ra=7}return ra}static BHk(ha){let ra=-1;if(!ha)return ra;ha=ha.toLowerCase();switch(ha){case "blank":ra=0;break;case "dotted":ra=1;break;case "dashed":ra=2;break;case "lined":ra=3}return ra}static Dxb(ha){const ra=a.a.substring(ha,0,2),sa=a.a.substring(ha,2,4);return a.a.substring(ha,4,6)+sa+ra}static WUc(ha){let ra=0;const sa=ha.length;var oa=a.a.substring(ha,0,sa-2);oa=parseFloat(oa);ha=a.a.substr(ha,sa-2,2);switch(ha){case "in":ra=
3;break;case "px":ra=7;break;case "cm":ra=1;break;case "pt":ra=5;break;default:u.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ha),oa=0}return{returnValue:oa,unit:ra}}static Ywd(ha,ra){let sa=0;switch(ra){case 3:sa=h.a.GA(ha);break;case 7:sa=m.a.az(ha,0);break;case 1:sa=h.a.tWe(ha);break;case 5:sa=h.a.GA(h.a.iMf(ha));break;default:u.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
ha,ra)}return sa}static B0k(ha){return!!ha&&!!ha.Q8e&&""!==ha.Q8e}}ca.G1a=Array(8);ca.Eua={};ca.jJe=null;Object(C.a)(ca,"Box4PasteSteward",Y.a,[])},1489:function(C,O,c){C=c(0);var l=c(2),e=c(1883),a=c(8);const h=(v,u)=>{const n={};let x=null;switch(v){case 0:x="HtmlProcessor";var A=u.a;null!=A&&(n.SessionID=A);var H=u.b.toString();null!=H&&(n.Elements=H);var E=u.c.toString();null!=E&&(n.PrunedElements=E);var L=u.d.toString();null!=L&&(n.TransparentElements=L);var M=u.e.toString();null!=M&&(n.VoidElements=
M);var F=u.f.toString();null!=F&&(n.UnknownElements=F);break;case 1:x="WordConverter";var J=u.a;null!=J&&(n.SessionID=J);var I=u.b.toString();null!=I&&(n.BulletsConverted=I);var K=u.c.toString();null!=K&&(n.NumberedConverted=K);break;case 2:x="FormattingSteward";var N=u.a;null!=N&&(n.SourceApp=N);var G=u.b;null!=G&&(n.Browser=G);var P=u.c;null!=P&&(n.OperationId=P);var S=u.d.toString();null!=S&&(n.Lang=S);var W=u.e.toString();null!=W&&(n.TextDir=W);var X=u.f.toString();null!=X&&(n.Bold=X);var Y=u.g.toString();
null!=Y&&(n.Math=Y);var ca=u.h.toString();null!=ca&&(n.Italics=ca);var ha=u.i.toString();null!=ha&&(n.Underline=ha);var ra=u.j.toString();null!=ra&&(n.Strikethrough=ra);var sa=u.k.toString();null!=sa&&(n.Subscript=sa);var oa=u.l.toString();null!=oa&&(n.Superscript=oa);var ka=u.m.toString();null!=ka&&(n.Fontsize=ka);var ia=u.n.toString();null!=ia&&(n.Fontface=ia);var La=u.o.toString();null!=La&&(n.GrowFontsize=La);var va=u.p.toString();null!=va&&(n.ShrinkFontsize=va);var Ga=u.q.toString();null!=Ga&&
(n.FontColor=Ga);var Oa=u.r.toString();null!=Oa&&(n.FontHighlight=Oa);var Za=u.s.toString();null!=Za&&(n.ParagraphStyle=Za);var ja=u.t.toString();null!=ja&&(n.TextAlign=ja);var ba=u.u.toString();null!=ba&&(n.TextIndent=ba);var qa=u.v.toString();null!=qa&&(n.MarginLeft=qa);var Ma=u.w.toString();null!=Ma&&(n.ParagraphSpaceBefore=Ma);var Ia=u.x.toString();null!=Ia&&(n.ParagraphSpaceAfter=Ia);var wa=u.y.toString();null!=wa&&(n.LineSpace=wa);var za=u.z.toString();null!=za&&(n.CellShadingColor=za);var pa=
u.ba.toString();null!=pa&&(n.StyleDefinition=pa);var Ba=u.bb.toString();null!=Ba&&(n.TabStops=Ba);break;case 3:x="SemanticEvents";var Ra=u.a;null!=Ra&&(n.SessionID=Ra);var fb=u.b.toString();null!=fb&&(n.Text=fb);var Va=u.c.toString();null!=Va&&(n.LineBreak=Va);var ib=u.d.toString();null!=ib&&(n.Image=ib);var Xa=u.e.toString();null!=Xa&&(n.File=Xa);var qb=u.f.toString();null!=qb&&(n.FormattingChange=qb);var rb=u.g.toString();null!=rb&&(n.Anchor=rb);var nb=u.h.toString();null!=nb&&(n.Paragraph=nb);
var Tb=u.i.toString();null!=Tb&&(n.Math=Tb);var Zb=u.j.toString();null!=Zb&&(n.List=Zb);var Hb=u.k.toString();null!=Hb&&(n.ListItem=Hb);var Sa=u.l.toString();null!=Sa&&(n.RenderAugmentation=Sa);var ua=u.m.toString();null!=ua&&(n.Span=ua);break;case 4:x="SemanticTableEvents";var Fa=u.a;null!=Fa&&(n.SessionID=Fa);var Pa=u.b.toString();null!=Pa&&(n.Tables=Pa);var Ea=u.c.toString();null!=Ea&&(n.TableRow=Ea);var lb=u.d.toString();null!=lb&&(n.TableCell=lb);var zb=u.e.toString();null!=zb&&(n.TablePart=
zb);break;case 5:x="HtmlEvents";var Xb=u.a;null!=Xb&&(n.OperationId=Xb);var ub=u.b;null!=ub&&(n.SourceApp=ub);var Pb=u.c;null!=Pb&&(n.Browser=Pb);var yc=null==u.d?null:u.d.toString();null!=yc&&(n.Text=yc);var bc=null==u.e?null:u.e.toString();null!=bc&&(n.A=bc);var Ka=null==u.f?null:u.f.toString();null!=Ka&&(n.Abbr=Ka);var Bb=null==u.g?null:u.g.toString();null!=Bb&&(n.Acronym=Bb);var tb=null==u.h?null:u.h.toString();null!=tb&&(n.Address=tb);var Kb=null==u.i?null:u.i.toString();null!=Kb&&(n.Applet=
Kb);var Ib=null==u.j?null:u.j.toString();null!=Ib&&(n.Area=Ib);var Wa=null==u.k?null:u.k.toString();null!=Wa&&(n.B=Wa);var vc=null==u.l?null:u.l.toString();null!=vc&&(n.Base=vc);var Lc=null==u.m?null:u.m.toString();null!=Lc&&(n.Basefont=Lc);var Gb=null==u.n?null:u.n.toString();null!=Gb&&(n.Bdo=Gb);var pc=null==u.o?null:u.o.toString();null!=pc&&(n.Big=pc);var Fc=null==u.p?null:u.p.toString();null!=Fc&&(n.Blockquote=Fc);var ob=null==u.q?null:u.q.toString();null!=ob&&(n.Body=ob);var Fb=null==u.r?null:
u.r.toString();null!=Fb&&(n.Br=Fb);var gb=null==u.s?null:u.s.toString();null!=gb&&(n.Button=gb);var Jb=null==u.t?null:u.t.toString();null!=Jb&&(n.Caption=Jb);var Yb=null==u.u?null:u.u.toString();null!=Yb&&(n.Center=Yb);var tc=null==u.v?null:u.v.toString();null!=tc&&(n.Cite=tc);var Ec=null==u.w?null:u.w.toString();null!=Ec&&(n.Code=Ec);var Vc=null==u.x?null:u.x.toString();null!=Vc&&(n.Col=Vc);var Hd=null==u.y?null:u.y.toString();null!=Hd&&(n.Colgroup=Hd);var qd=null==u.z?null:u.z.toString();null!=
qd&&(n.Dd=qd);var me=null==u.ba?null:u.ba.toString();null!=me&&(n.Del=me);var Zc=null==u.bb?null:u.bb.toString();null!=Zc&&(n.Dfn=Zc);var Dc=null==u.bc?null:u.bc.toString();null!=Dc&&(n.Dir=Dc);var ud=null==u.bd?null:u.bd.toString();null!=ud&&(n.Div=ud);var Ce=null==u.be?null:u.be.toString();null!=Ce&&(n.Dl=Ce);var ee=null==u.bf?null:u.bf.toString();null!=ee&&(n.Dt=ee);var Uf=null==u.bg?null:u.bg.toString();null!=Uf&&(n.Em=Uf);var te=null==u.bh?null:u.bh.toString();null!=te&&(n.Fieldset=te);var Fe=
null==u.bi?null:u.bi.toString();null!=Fe&&(n.Font=Fe);var Qf=null==u.bj?null:u.bj.toString();null!=Qf&&(n.Form=Qf);var id=null==u.bk?null:u.bk.toString();null!=id&&(n.Frame=id);var Gg=null==u.bl?null:u.bl.toString();null!=Gg&&(n.Frameset=Gg);var ad=null==u.bm?null:u.bm.toString();null!=ad&&(n.H=ad);var Kd=null==u.bn?null:u.bn.toString();null!=Kd&&(n.Head=Kd);var jh=null==u.bo?null:u.bo.toString();null!=jh&&(n.Hr=jh);var Qe=null==u.bp?null:u.bp.toString();null!=Qe&&(n.Html=Qe);var zc=null==u.bq?null:
u.bq.toString();null!=zc&&(n.I=zc);var uc=null==u.br?null:u.br.toString();null!=uc&&(n.Iframe=uc);var Ed=null==u.bs?null:u.bs.toString();null!=Ed&&(n.Img=Ed);var Of=null==u.bt?null:u.bt.toString();null!=Of&&(n.Input=Of);var $b=null==u.bu?null:u.bu.toString();null!=$b&&(n.Ins=$b);var xc=null==u.bv?null:u.bv.toString();null!=xc&&(n.Isindex=xc);var Yc=null==u.bw?null:u.bw.toString();null!=Yc&&(n.Kbd=Yc);var wd=null==u.bx?null:u.bx.toString();null!=wd&&(n.Label=wd);var le=null==u.by?null:u.by.toString();
null!=le&&(n.Legend=le);var uf=null==u.bz?null:u.bz.toString();null!=uf&&(n.Li=uf);var yg=null==u.ca?null:u.ca.toString();null!=yg&&(n.Link=yg);var pb=null==u.cb?null:u.cb.toString();null!=pb&&(n.Map=pb);var Wb=null==u.cc?null:u.cc.toString();null!=Wb&&(n.Math=Wb);var Oc=null==u.cd?null:u.cd.toString();null!=Oc&&(n.Menu=Oc);var nd=null==u.ce?null:u.ce.toString();null!=nd&&(n.Meta=nd);var ve=null==u.cf?null:u.cf.toString();null!=ve&&(n.Noframes=ve);var nf=null==u.cg?null:u.cg.toString();null!=nf&&
(n.Noscript=nf);var pf=null==u.ch?null:u.ch.toString();null!=pf&&(n.Object=pf);var Mg=null==u.ci?null:u.ci.toString();null!=Mg&&(n.Ol=Mg);var Jg=null==u.cj?null:u.cj.toString();null!=Jg&&(n.Optgroup=Jg);var rh=null==u.ck?null:u.ck.toString();null!=rh&&(n.Option=rh);var Tg=null==u.cl?null:u.cl.toString();null!=Tg&&(n.P=Tg);var ak=null==u.cm?null:u.cm.toString();null!=ak&&(n.Param=ak);var ci=null==u.cn?null:u.cn.toString();null!=ci&&(n.Pre=ci);var Af=null==u.co?null:u.co.toString();null!=Af&&(n.Q=Af);
var Ef=null==u.cp?null:u.cp.toString();null!=Ef&&(n.S=Ef);var Ue=null==u.cq?null:u.cq.toString();null!=Ue&&(n.Samp=Ue);var Df=null==u.cr?null:u.cr.toString();null!=Df&&(n.Script=Df);var Sf=null==u.cs?null:u.cs.toString();null!=Sf&&(n.Select=Sf);var Se=null==u.ct?null:u.ct.toString();null!=Se&&(n.Small=Se);var Ii=null==u.cu?null:u.cu.toString();null!=Ii&&(n.Span=Ii);var hg=null==u.cv?null:u.cv.toString();null!=hg&&(n.Strike=hg);var Fg=null==u.cw?null:u.cw.toString();null!=Fg&&(n.Strong=Fg);var qf=
null==u.cx?null:u.cx.toString();null!=qf&&(n.Style=qf);var Cg=null==u.cy?null:u.cy.toString();null!=Cg&&(n.Sub=Cg);var Hh=null==u.cz?null:u.cz.toString();null!=Hh&&(n.Sup=Hh);var aj=null==u.da?null:u.da.toString();null!=aj&&(n.Tables=aj);var df=null==u.db?null:u.db.toString();null!=df&&(n.Tbody=df);var ld=null==u.dc?null:u.dc.toString();null!=ld&&(n.Td=ld);var dj=null==u.dd?null:u.dd.toString();null!=dj&&(n.Textarea=dj);var Yh=null==u.de?null:u.de.toString();null!=Yh&&(n.Tfoot=Yh);var Nl=null==u.df?
null:u.df.toString();null!=Nl&&(n.Th=Nl);var ij=null==u.dg?null:u.dg.toString();null!=ij&&(n.Thead=ij);var ck=null==u.dh?null:u.dh.toString();null!=ck&&(n.Title=ck);var Mk=null==u.di?null:u.di.toString();null!=Mk&&(n.Tr=Mk);var Wf=null==u.dj?null:u.dj.toString();null!=Wf&&(n.Tt=Wf);var cg=null==u.dk?null:u.dk.toString();null!=cg&&(n.U=cg);var bl=null==u.dl?null:u.dl.toString();null!=bl&&(n.Ul=bl);var tl=null==u.dm?null:u.dm.toString();null!=tl&&(n.Var=tl);var ki=null==u.dn?null:u.dn.toString();null!=
ki&&(n.Unknown=ki);break;case 6:x="List";var ul=u.a;null!=ul&&(n.SessionID=ul);var Cf=u.b.toString();null!=Cf&&(n.MaxListLevel=Cf)}n.Table=x;return Sys.Serialization.JavaScriptSerializer.serialize(n)};c.d(O,"a",function(){return m});class m{static get zma(){null==m.Vqb&&(m.Vqb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return m.Vqb}static get Tfi(){null==m.bve&&(m.bve=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));
return m.bve}static YZ(v){a.ULS.sendTraceTag(524038472,307,50,v)}static wTh(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;u.f=0;return u}static hAm(v){m.zma||m.YZ(h(0,v))}static TOh(v){const u={};u._sessionID=v;return u}static Pjf(v){const u={};u.a=v;u.b=0;u.c=0;return u}static MEm(v){m.zma||m.YZ(h(1,v))}static vTh(v,u){const n={};n.c=e.a[v];n.a=u;return n}static gAm(v,u){m.Tfi&&v&&(v.b=u,m.YZ(h(5,v)))}static j_h(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;
u.m=0;return u}static oDm(v){m.zma||m.YZ(h(3,v))}static k_h(v){const u={};u.a=v;u.b=0;u.c=0;u.d=0;u.e=0;return u}static pDm(v){m.zma||m.YZ(h(4,v))}static Nef(v,u){const n={};n.b=e.a[v];n.c=u;n.d=0;n.e=0;n.f=0;n.g=0;n.h=0;n.i=0;n.j=0;n.k=0;n.l=0;n.m=0;n.n=0;n.o=0;n.p=0;n.q=0;n.r=0;n.s=0;n.t=0;n.w=0;n.x=0;n.y=0;n.z=0;n.u=0;n.v=0;n.ba=0;n.bb=0;return n}static Lzm(v,u){m.Tfi&&v&&(v.a=u,m.YZ(h(2,v)))}static Zzl(v){const u={};u.a=v;u.b=-1;return u}static LAm(v){!m.zma&&v&&0<=v.b&&m.YZ(h(6,v))}}m.Vqb=null;
m.bve=null;Object(C.a)(m,"UsageEditor",null,[])},1504:function(C,O,c){c.d(O,"a",function(){return a});C=c(0);var l=c(2),e=c(6);class a{static get Slb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static Odb(h,m=!1){const v=e.GraphIterator.Za(h);v.rd();return(m?v.Pb(4):v.y6(4))?4:e.GraphIterator.Za(h).Ab(36)?16:e.GraphIterator.Za(h).Ab(14)?2:e.GraphIterator.Za(h).Ab(38)?32:1}}Object(C.a)(a,"ConstructTypeHelper",null,[])},1517:function(C,
O,c){c.d(O,"a",function(){return ia});C=c(0);var l=c(23),e=c(60),a=c(127);O=c(78);var h=c(5),m=c(16),v=c(8),u=c(123),n=c(64),x=c(708),A=c(194),H=c(38),E=c(6),L=c(211),M=c(93),F=c(30),J=c(88),I=c(22),K=c(391),N=c(1467),G=c(229),P=c(270),S=c(707),W=c(14),X=c(48),Y=c(40),ca=c(132),ha=c(43),ra=c(284),sa=c(152),oa=c(568),ka=c(56);class ia{static get q0l(){return ia.eIj}static get x0l(){return ia.iIj}static get v0l(){return ia.hIj}static get Sg(){return null!=ia.Iig?ia.Iig:ia.Iig=G.ContextSetEditor.instance}static get Fk(){return null!=
ia.qsg?ia.qsg:ia.qsg=l.a.instance.resolve("Box4.ITableEditor")}static get kC(){return null!=ia.hsg?ia.hsg:ia.hsg=l.a.instance.Pa("Box4.Styles.ITableCellspacingReader")}static Fbn(La,va){const Ga=La.currentNode;I.forEachCell(La,va.rowSpan,va.colSpan,(Oa,Za,ja)=>{const ba=Oa.currentNode;ba!==Ga&&(ba.gg=!0,ia.xAh(Oa),!ja&&1<=va.colSpan&&(ba.colSpan=va.colSpan),ia.K_i(Oa,va.rha,Za,ja,va.rowSpan,va.colSpan))})}static qcn(La,va){I.forEachCell(La,va.rowSpan,va.colSpan,Ga=>{ia.pfk(Ga);ia.xAh(Ga)})}static pfk(La){La=
La.currentNode;La.gg=!0;La.U2=!0;La.blb=!0}static xAh(La){La&&(La.Pb(1),Object(u.a)(x.a,La.currentNode)&&La.Hg())}static bgk(La,va,Ga){0<va&&(La=Object(n.a)(A.TableCellNode,La.currentNode))&&(La.width=Ga?va:e.a.rn(va,0))}static yek(La,va,Ga){if(La=Object(n.a)(K.TableNode,La.currentNode))0<va&&(La.fe=e.a.az(va,0)),0<Ga&&(La.lv=e.a.az(Ga,0))}static $fk(La,va){void 0!==va&&null!==va&&La.currentNode.properties.setValue(h.a.Hoa,ia.x0l[va+""])}static ofk(La,va){void 0!==va&&null!==va&&""!==va&&(va=parseInt(N.Box4PasteSteward.Dxb(va),
16),La.currentNode.properties.setValue(m.a.cI,va))}static tak(La){if(La){if(v.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(ka.a)("AdjustingColumnWidthAfterPaste",!0),16==La.type){var va=new E.GraphIterator;va.set(La);if(va.Ab(14)){var Ga=J.a(va),Oa=F.TableCellReader.SN(La);if(va.kd(14)){La=va.currentNode;var Za=H.TableReader.Jea(va),ja=Array.clone(Za);va=H.TableReader.YGd(va);var ba=0,qa=0;for(var Ma=0;Ma<Za.length;Ma++)Ma>=Ga&&Ma<Ga+Oa?va[Ma]>Za[Ma]&&(ba+=va[Ma]-
Za[Ma],ja[Ma]=va[Ma]):qa+=Za[Ma]>va[Ma]?Za[Ma]-va[Ma]:0;(null==qa||0>=qa||isNaN(qa))&&v.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==ba||0>=ba||isNaN(ba))&&v.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(qa<ba)for(Ga=0;Ga<Za.length;Ga++)ja[Ga]=va[Ga];else for(Ma=0;Ma<Za.length;Ma++)if((Ma<Ga||Ma>=Ga+Oa)&&Za[Ma]>va[Ma]){let Ia=(Za[Ma]-va[Ma])/qa;ja[Ma]-=Ia*ba;(null==ja[Ma]||0>=ja[Ma]||isNaN(ja[Ma]))&&v.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",
Ia)}Ga=sa.a.Lba+(ia.kC?ia.kC.Ata(La):0);for(Za=0;Za<ja.length;Za++)if(null==ja[Za]||0>=ja[Za]||isNaN(ja[Za]))v.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),ja[Za]=e.a.rn(Ga,0);La.Mx=ja}}}}else v.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static XPl(La){var va=new E.GraphIterator;va.ed(La);if((La=L.OutlineNavigator.AVf(va))&&M.OutlineReader.Aw(va)){va=La.wg(h.a.Oo);const Ga=La.wg(h.a.marginLeft);La=La.wg(h.a.marginRight);return va-Ga-La}return 0}static llm(La){return!(void 0===
La||null===La||1===La)}static cKn(La,va,Ga,Oa,Za){if(void 0===va||null===va||""!==va){switch(va){case "thin":va=a.a.k0d(.25);break;case "initial":case "medium":va=a.a.k0d(.5);break;case "thick":va=a.a.k0d(1);break;default:va=ia.NLl(va,Ga,Oa)}Za.currentNode.properties.setValue(La,va)}}static bKn(La,va,Ga){void 0!==va&&null!==va&&va&&Ga.currentNode.properties.setValue(La,ia.v0l[va+""])}static $Jn(La,va,Ga){void 0!==va&&null!==va&&""!==va&&(va=parseInt(N.Box4PasteSteward.Dxb(va),16),Ga.currentNode.properties.setValue(La,
va))}static NLl(La,va,Ga){let Oa=0;const Za=({unit:La}=N.Box4PasteSteward.WUc(La)).returnValue;switch(La){case 5:Oa=a.a.k0d(Za);break;case 1:Oa=a.a.luk(Za);break;case 3:Oa=a.a.z8h(Za);break;case 7:Oa=e.a.s7m(Za,Ga)}if(6===va||7===va||10===va)Oa/=3;return Math.round(Oa)}static OLl(La,va){let Ga=0;const Oa=({unit:La}=N.Box4PasteSteward.WUc(La)).returnValue;switch(La){case 5:Ga=a.a.yva(Oa);break;case 1:Ga=a.a.sWe(Oa);break;case 3:Ga=a.a.bCa(Oa);break;case 7:Ga=e.a.rn(Oa,va)}return Ga}static A6d(La,va,
Ga,Oa,Za,ja,ba){if(Za&&(!ba||16===Za.Le||ba||14!==Za.Le)&&12!==Ga){if(ba)switch(Oa){case 5:Oa=h.a.qha;var qa=h.a.Wa;var Ma=h.a.Va;var Ia=0;break;case 4:Oa=h.a.pha;qa=h.a.qb;Ma=h.a.pb;Ia=1;break;case 0:Oa=h.a.nha;qa=h.a.Ua;Ma=h.a.Ta;Ia=0;break;case 3:Oa=h.a.oha;qa=h.a.ob;Ma=h.a.nb;Ia=1;break;default:return}else switch(Oa){case 5:Oa=h.a.Klb;qa=h.a.U3a;Ma=h.a.NLb;Ia=0;break;case 4:Oa=h.a.Jlb;qa=h.a.T3a;Ma=h.a.MLb;Ia=1;break;case 0:Oa=h.a.Hlb;qa=h.a.R3a;Ma=h.a.KLb;Ia=0;break;case 3:Oa=h.a.Ilb;qa=h.a.S3a;
Ma=h.a.LLb;Ia=1;break;default:return}void 0!==Za.currentNode&&null!==Za.currentNode&&(ia.llm(Ga)?(ia.$Jn(Oa,La,Za),ia.bKn(qa,Ga,Za),ia.cKn(Ma,va,Ga,Ia,Za)):ja||ba||Za.currentNode.properties.setValue(qa,"nil"))}}static K_i(La,va,Ga,Oa,Za,ja){Oa||(ia.heh(va,La,!1,!1),ia.MRe(va,La,!0,!1));Oa===ja-1&&ia.MRe(va,La,!0,!1);Ga||ia.Ieh(va,La,!0,!1);Ga===Za-1&&ia.Pdh(va,La,!0,!1)}static Odh(La,va,Ga,Oa){La&&(ia.Ieh(La,va,Ga,Oa),ia.MRe(La,va,Ga,Oa),ia.Pdh(La,va,Ga,Oa),ia.heh(La,va,Ga,Oa))}static Ieh(La,va,Ga,
Oa){ia.A6d(La.borderTopColor,La.borderTopWidth,La.borderTopStyle,5,va,Ga,Oa)}static MRe(La,va,Ga,Oa){ia.A6d(La.borderRightColor,La.borderRightWidth,La.borderRightStyle,4,va,Ga,Oa)}static Pdh(La,va,Ga,Oa){ia.A6d(La.borderBottomColor,La.borderBottomWidth,La.borderBottomStyle,0,va,Ga,Oa)}static heh(La,va,Ga,Oa){ia.A6d(La.borderLeftColor,La.borderLeftWidth,La.borderLeftStyle,3,va,Ga,Oa)}static B6d(La,va,Ga){if(Ga&&16===Ga.Le&&""!==La){switch(va){case 3:va=h.a.ZEa;var Oa=0;break;case 2:va=h.a.zO;Oa=1;
break;case 0:va=h.a.XEa;Oa=0;break;case 1:va=h.a.wM;Oa=1;break;default:return}(La=ia.OLl(La,Oa))&&Ga.currentNode.properties.setValue(va,La)}}static Udk(La,va){va&&(ia.Tfk(va,La),ia.jfk(va,La),ia.aek(va,La),ia.Jek(va,La))}static Tfk(La,va){ia.B6d(La.fuk,3,va)}static jfk(La,va){ia.B6d(La.euk,2,va)}static aek(La,va){ia.B6d(La.cuk,0,va)}static Jek(La,va){ia.B6d(La.duk,1,va)}static fek(La,va,Ga,Oa){var Za=0;const ja=Array(La.length);var ba=0;Oa&&(ba=(ba=a.a.p3c(ia.XPl(va)))?ba:1);for(Oa=0;Oa<La.length;Oa++)ja[Oa]=
0<ba?ba/100*La[Oa]:e.a.rn(La[Oa],0),Za+=ja[Oa];La=Ga.getValue(m.a.iz);Oa=new E.GraphIterator;Oa.ed(va);va=0;if(F.TableCellReader.SZ(Oa)){if(La=I.returnToContainingCell(Oa))va=La.width;ba=J.a(Oa);Oa=I.returnToContainingTable(Oa);if(-1!==ba&&ba<=Oa.Mx.length){let qa=0;for(let Ma=ba;Ma<ba+La.colSpan&&Ma<Oa.Mx.length;Ma++)qa+=Oa.Mx[Ma];va=Math.min(va,qa);va===qa&&(va-=e.a.rn(ia.gNm,0))}}else if(La)for(ba=0;ba<La.length;ba++)va+=La[ba];if(0<va&&Za>va&&Za)for(Za=va/Za,va=0;va<ja.length;va++)ja[va]*=Za;
Ga.setValue(m.a.iz,ja)}static kfk(La,va){La.currentNode.setValue(h.a.N_,e.a.rn(va,1))}static UQn(La){var va,Ga;v.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(ka.a)("SettingTableSelectionBounds",!0);var Oa=La.ib,Za=La.Jg;La=ia.Sg.ZP(Za,16);if(Za=ia.Sg.AS(Za,14))if(Za=Za.node,!Za||14!==Za.type)v.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!La)v.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(Ga=null===
(va=null===Oa||void 0===Oa?void 0:Oa.kb)||void 0===va?void 0:va.Oe)||void 0===Ga?0:Ga.Qa)&&Oa.kb.Oe.Qa.contextId===W.a.K_&&P.TableBorderSelectionCache.fMa()&&0<P.TableBorderSelectionCache.fMa().length)){P.TableBorderSelectionCache.qMc(Za);va=P.TableBorderSelectionCache.F7;va.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;va.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;va.topMostRowSelected=Number.MAX_SAFE_INTEGER;va.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(Ga=0;Ga<La.length;Ga++){if(La.getContext(Ga).contextId!==
W.a.tableCell)return;Oa=La.getContext(Ga).node;if(!F.TableCellReader.rr(Oa)){var ja=new E.GraphIterator;ja.set(Oa);if(ja.Ab(14)&&I.getContainingTable(ja)===Za){ja.kd(14);ja=F.TableCellReader.kBa(ja,Oa);if(!ja)return;Array.add(P.TableBorderSelectionCache.fMa(),new S.a(Oa,ja.rowIndex,ja.eo,Oa.rowSpan,Oa.colSpan));va.leftMostColumnSelected=Math.min(va.leftMostColumnSelected,ja.eo);va.rightMostColumnSelected=Math.max(va.rightMostColumnSelected,ja.eo);va.topMostRowSelected=Math.min(va.topMostRowSelected,
ja.rowIndex);va.bottomMostRowSelected=Math.max(va.bottomMostRowSelected,ja.rowIndex)}}}P.TableBorderSelectionCache.F7=va}}else v.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static oWi(La){if(La&&14===La.type){v.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(ka.a)("ScalingColumnWidthForCCP",!0);var va=new E.GraphIterator;va.set(La);if(va.rd()&&H.TableReader.Pv(va)){var Ga=La.Mx,Oa=H.TableReader.YGd(va),Za=I.returnToContainingCell(va),ja=I.getContainingTable(va);
if(Za&&ja){var ba=J.a(va),qa=F.TableCellReader.SN(Za);if(va.kd(14)){var Ma=H.TableReader.Jea(va);va=0;for(let Ia=ba;Ia<ba+qa;Ia++)va+=Ma[Ia];ba=sa.a.EI(Za,ja,h.a.wM,h.a.za,0);Za=sa.a.EI(Za,ja,h.a.zO,h.a.Aa,0);va-=e.a.rn(ba+Za,0);(null==va||0>=va||isNaN(va))&&v.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",ba,Za);Za=0;for(ja=0;ja<Ga.length;ja++)Za+=Ga[ja];Za=va/Za;(null==Za||0>=Za||isNaN(Za))&&v.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");
ja=0;for(ba=0;ba<Ga.length;ba++)Ga[ba]*=Za,Ga[ba]<Oa[ba]&&(Ga[ba]=Oa[ba]),ja+=Ga[ba];ja>va&&(Ga=Array.clone(Oa));Oa=sa.a.Lba+(ia.kC?ia.kC.Ata(La):0);for(va=0;va<Ga.length;va++)if(null==Ga[va]||0>=Ga[va]||isNaN(Ga[va]))v.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),Ga[va]=e.a.rn(Oa,0);Oa=new X.GraphTransaction(4);Oa.Eb(La);La.Mx=Ga;Oa.dispose()}}}else v.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else v.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static Vwn(La){if(!La||
!H.TableReader.TQd(La)||1!=La.Mp())return v.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;v.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(ka.a)("ReplaceTableContentForExternalPaste",!0);let va=new E.GraphIterator;va.set(La.currentNode);va.Ab(14);Y.OutlineElementNavigator.Fe(va);let Ga=new E.GraphIterator;Ga.set(La.currentNode);Ga.Ab(14);if(!Ga.kd(14)||!va||14!=va.currentNode.type)return null;if(La=I.getContainingTableCell(va))if(La=
F.TableCellReader.kBa(Ga,La)){if(P.TableBorderSelectionCache.lKc())var Oa=this.gKl();else{Oa=H.TableReader.$f(va.currentNode)-(H.TableReader.$f(Ga.currentNode)-La.rowIndex);var Za=H.TableReader.Yg(va.currentNode)-(H.TableReader.Yg(Ga.currentNode)-La.eo);this.j6j(Ga,Oa,Za);Oa=new ra.a(La.eo,H.TableReader.Yg(Ga.currentNode)-1,La.rowIndex,H.TableReader.$f(Ga.currentNode)-1)}if(!Oa)return null;Za=Oa.bottomMostRowSelected-Oa.topMostRowSelected+1;var ja=Oa.rightMostColumnSelected-Oa.leftMostColumnSelected+
1;Za=Math.min(Za,H.TableReader.$f(va.currentNode));ja=Math.min(ja,H.TableReader.Yg(va.currentNode));for(let ba=0;ba<Za;ba++){I.moveToCell(Ga,ba+Oa.topMostRowSelected,Oa.leftMostColumnSelected);I.moveToCell(va,ba,0);for(let qa=0;qa<ja;qa++)ba==La.rowIndex-Oa.topMostRowSelected&&qa==La.eo-Oa.leftMostColumnSelected||this.Cti(va,Ga),I.moveToNextColumn(Ga),I.moveToNextColumn(va);Ga.it(14);va.it(14)}I.moveToCell(Ga,La.rowIndex,La.eo);La.rowIndex-Oa.topMostRowSelected<H.TableReader.$f(va.currentNode)&&La.eo-
Oa.leftMostColumnSelected<H.TableReader.Yg(va.currentNode)?I.moveToCell(va,La.rowIndex-Oa.topMostRowSelected,La.eo-Oa.leftMostColumnSelected):va=null;this.Cti(va,Ga);Ga.it(14);I.moveToCell(Ga,Oa.topMostRowSelected,Oa.leftMostColumnSelected);Ga.Ud();return Ga.currentNode}}static R5m(La){if(La&&H.TableReader.TQd(La)&&1==La.Mp()){v.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(ka.a)("PasteTableBelowTable",!0);var va=new E.GraphIterator;va.set(La.currentNode);La=ca.a.Za(La.currentNode);
va.ro()&&La.ro()&&(Y.OutlineElementNavigator.e3(La,!1,!0),ha.OutlineElementReader.Nh(La)&&1==La.Mp()&&(Y.OutlineElementNavigator.Fe(va),Y.OutlineElementNavigator.Fe(La),va&&La&&va.currentNode!=La.currentNode&&H.TableReader.isTable(va)&&H.TableReader.isTable(La)&&this.WJm(va,La)&&(v.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),va.Hg(),va.Hg())))}else v.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static Cti(La,va){if(va&&F.TableCellReader.isTableCell(va)){var Ga=
va.Mp();if(La&&F.TableCellReader.isTableCell(La)&&La.EA())for(;La.EA();)La.Ud(),va.Rf(La.currentNode,La.role),La.Hg();else Ga--;for(;0<Ga--;)va.Ud(),va.Hg()}}static WJm(La,va){if(!H.TableReader.isTable(La)||!H.TableReader.isTable(va))return!1;var Ga=H.TableReader.Yg(La.currentNode),Oa=H.TableReader.Yg(va.currentNode);if(Ga!=Oa)return v.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;Ga=H.TableReader.$f(La.currentNode);Oa=H.TableReader.$f(va.currentNode);
let Za=new X.GraphTransaction(4);Za.Eb(va.currentNode);va.currentNode.setValue(m.a.swa,Ga+Oa);for(Za.dispose();La.EA();){La.Ud();va.Rf(La.currentNode,1);Ga=new E.GraphIterator;Ga.set(La.currentNode);La.Hg();Ga.Ud();do Ga.currentNode&&16==Ga.currentNode.type&&(Ga.currentNode.SG=va.currentNode);while(Ga.Ht())}return!0}static j6j(La,va,Ga){v.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(ka.a)("AddRowAndColumnForExternalCCP",!0);ia.Wxa=oa.a.t3b;0<va&&
(I.moveToLastRow(La),v.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+va),this.Fk.insertRows(La,!1,va,this.Wxa),v.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),La.kd(14));0<Ga&&(v.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+Ga),this.Fk.insertColumns(La,H.TableReader.Yg(La.currentNode),!1,Ga,this.Wxa),v.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static gKl(){return P.TableBorderSelectionCache?P.TableBorderSelectionCache.F7:null}}ia.gNm=
8;ia.ezh="Table Grid";ia.Wxa=null;ia.eIj=O.a.V3("MsoNormalTable","Normal Table","MsoTableGrid",ia.ezh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3",
"Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6",
"Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3",
"Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5",
"MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");ia.iIj=O.a.V3("0","center","1","top","2","center","3","bottom");ia.hIj=O.a.V3("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(C.a)(ia,"Box4TableStewardHelper",null,[])},1520:function(C,O,c){c.d(O,"a",function(){return S});C=c(0);var l=c(77),e=c(126),a=c(23),h=c(170),m=c(2),v=c(200),u=c(5),n=c(96),x=c(66),A=c(9),H=c(48),E=c(595),L=c(229),M=c(246),F=c(11),J=
c(68),I=c(261),K=c(21),N=c(14),G=c(297),P=c(3);class S{static get Sg(){return L.ContextSetEditor.instance}static get ag(){return M.a.instance}static get Kc(){return e.a.instance}static xw(){return S.Km||(S.Km=a.a.instance.$a("Box4.IExternalSelectionManager"))}static get gy(){return null!=S.wqg?S.wqg:S.wqg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static pOl(){this.iN||(this.iN=new l.a,this.iN.add(P.a.Wv),this.iN.add(P.a.font),this.iN.add(P.a.GX),this.iN.add(P.a.ika),this.iN.add(P.a.bold),
this.iN.add(P.a.setItalic),this.iN.add(P.a.superscript),this.iN.add(P.a.subscript),this.iN.add(P.a.sWa),this.iN.add(P.a.Tza),this.iN.add(P.a.aKa),this.iN.add(P.a.vWe),this.iN.add(P.a.bKa),this.iN.add(P.a.rWa),this.iN.add(P.a.ML),this.iN.add(P.a.sM),this.iN.add(P.a.clearFormatting),this.iN.add(P.a.bbb),this.iN.add(P.a.fBc));return this.iN}static m6b(W){return S.pOl().contains(W)?!0:!1}static Cv(W,X,Y,ca,ha){var ra=!0;if(!X.view.ye)return 2;var sa=X.view,oa=sa.Cb;oa&&oa.ib.kb||(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.noSelection}),
ra=!1);S.Sg.jAa(K.ImageReader.eOc,sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.CZe}),ra=!1);if(S.Sg.jAa(K.ImageReader.k_a,sa.Cb.Jg))return S.Kc.Zb(n.a.vf,{["Reason"]:x.a.cCc}),8;var ka=!S.m6b(W);S.ag.t6b(sa.Cb.Jg,ka)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.dE}),ra=!1);S.Sg.jAa(K.ImageReader.UOd,sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.xZe}),ra=!1);S.Sg.jAa(G.c,sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.yZe}),ra=!1);S.Sg.jAa(I.a.grf,sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.wZe}),ra=!1);S.Sg.Swa(F.ParagraphReader.HT,
sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.uN}),ra=!1);S.xw()&&S.xw().instance&&S.xw().instance.KT(sa.Cb.Jg)&&(S.Kc.Zb(n.a.vf,{["Reason"]:x.a.externalSelection}),ra=!1);var ia=null;oa&&oa.ib.kb&&(ia=oa.ib.kb);W===P.a.Q9d&&ia&&ia.MC&&F.ParagraphReader.oK(ia.Qa.node)&&!J.ListReader.sr&&(ra=!1);if(1===Y||!ra||!ia)return ra?32:8;ra=W===P.a.a9b||W===P.a.mZb||W===P.a.hdc||W===P.a.j2b;sa=W===P.a.fIb||W===P.a.Dyb||W===P.a.tcc;ka=W===P.a.VPa||W===P.a.WPa||W===P.a.jC;const La=new H.GraphTransaction(15);La.Eb(ia.Qa.node);
ia=new l.a;let va=!1;if(ra||sa||ka)h.a.mark(7121),X=S.Sg.jMh(X.rk);else{h.a.mark(7119);X=E.OutlineElementGeneralizer.qla(oa.ib,!0);if(!X)return S.Kc.Zb(n.a.hla,{["Reason"]:x.a.dCd}),La.dispose(),8;oa=W===P.a.RZa||W===P.a.xfb;X.zw&&oa&&(va=S.hYl(ia,X))}(W===P.a.leftJustify||W===P.a.a9b||W===P.a.centerJustify||W===P.a.mZb||W===P.a.rightJustify||W===P.a.hdc||W===P.a.fullJustify||W===P.a.j2b)&&X.zw&&1<X.length&&S.iYl(X)&&(ha||(ha={}),Object.getType(ha)===Object&&(ha.InContextSet=!0));m.AFrameworkApplication.ya.Vf(X,
W,Y,!0,ca,ha);va&&S.sOm(ia,X,ha);La.dispose();A.App.xa.updateCommandUI();ra||sa||ka?h.a.mark(7122):h.a.mark(7120);return 32}static hYl(W,X){if(!X.zw)return!1;let Y=!1,ca=!1;for(let ra=0;ra<X.length;ra++)if(X.getContext(ra).Xk){var ha=X.getContext(ra).node;ha&&(ha=S.gy.ceb(ha),2===ha.specialIndentType?(Y=!0,W.add(ra)):1!==ha.specialIndentType&&ha.specialIndentType||(ca=!0))}return ca&&Y}static sOm(W,X,Y){if(X.zw)for(let ha=0;ha<W.count;ha++){var ca=X.getContext(W.J(ha));if(!ca.Xk)continue;ca=ca.node;
const ra=S.gy.ceb(ca);2!==ra.specialIndentType||v.a.OZ(Y.value,ra.HA)||ca.setValue(u.a.fe,ra.HA-ra.Fba)}}static T_f(W,X){let Y=!0;X.contextId!==N.a.paragraph?Y=!1:S.ag.R_a(X)?(S.Kc.Zb(n.a.Vm,{["Reason"]:x.a.dE}),Y=!1):S.xw()&&S.xw().instance&&S.xw().instance.KT(X)?(S.Kc.Zb(n.a.Vm,{["Reason"]:x.a.externalSelection}),Y=!1):X.Xk&&(X=X.node,F.ParagraphReader.nc(X)&&X.EP&&(S.Kc.Zb(n.a.Vm,{["Reason"]:x.a.uN}),Y=!1));return{returnValue:1!==W&&Y,Ix:Y?32:8}}static iYl(W){if(!W.zw)return!1;let X=1;for(let ca=
0;ca<W.length;ca++){var Y=W.getContext(ca);if(Y&&Y.Xk&&Y.contextId===N.a.paragraph&&(Y=Y.node))if(Y=F.ParagraphReader.Lv(Y),!ca)X=Y;else if(Y!==X)return!0}return!1}}S.Km=null;S.iN=null;Object(C.a)(S,"FormattingActionHelper",null,[])},1522:function(C,O,c){c.d(O,"a",function(){return e});c.d(O,"b",function(){return a});var l=c(2);const e=h=>{switch(h){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;
case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var h;return null===(h=l.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1530:function(C,O,c){c.r(O);C=c(0);var l=c(8),e=c(1881),a=c(1541),h;(function(Oa){Oa[Oa.external=0]="external";Oa[Oa.msa=1]="msa";Oa[Oa.aad=2]="aad"})(h||(h={}));Object(C.b)("AuthorityType",
h);class m{}Object(C.a)(m,"OAuthResult",null,[]);class v{constructor(Oa){this.jOj=Oa}initialize(){return Promise.resolve(0)}vTd(){return Promise.resolve(0)}Qoa(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new m,{IsSuccess:!0,Token:this.jOj}))}gce(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X$d(){return!1}MJc(){return"MockAuthTokenStrategy"}}
Object(C.a)(v,"MockAuthTokenStrategy",null,[309]);var u=c(1583);class n{static get(Oa,Za,ja){if(!ja)return Oa;let ba=0;return Promise.race([Oa,new Promise(qa=>{ba=window.setTimeout(()=>{qa(Za)},ja)})]).then(qa=>{window.clearTimeout(ba);return Promise.resolve(qa)}).catch(()=>{window.clearTimeout(ba);return Promise.resolve(Za)})}}Object(C.a)(n,"PromiseWithTimeout",null,[]);var x=c(2),A=c(1473);class H{constructor(Oa,Za,ja,ba,qa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=Oa;this.scope=Za;this.silentLogin=ja;this.options=ba;this.correlationId=qa}}Object(C.a)(H,"TokenRequestParameters",null,[315]);var E=c(15),L=c(23);class M{constructor(){this.V6g=null;let Oa=x.AFrameworkApplication.K.lb(x.AFrameworkApplication.Cha),Za=x.AFrameworkApplication.K.lb(x.AFrameworkApplication.sce);this.EVb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Oa&&""!==Oa?Oa:"Unspecified",Za&&""!==Za?Za:"Unspecified")}initialize(){return new Promise(Oa=>
{L.a.instance.$a("Common.App.WopiIdentity.IWopiIdentity").execute(Za=>{this.V6g=Za;Oa(0)})})}re(Oa){const Za=["HTTPS:","API:"];let ja=!1;const ba=Oa.toLocaleUpperCase();for(const qa of Za)if(ba.startsWith(qa)){ja=!0;break}return ja||this.Yfm(Oa)?Oa+"/.default":Oa}Yfm(Oa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Oa)}vTd(){return Promise.resolve(0)}Qoa(Oa,Za,ja,ba,qa,Ma,Ia){if(E.a.mNa){qa=A.a.Bto;if(!qa)return Za=Object.assign(new m,{IsSuccess:!1,
ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Za);if(!Array.contains(qa,Oa))return Za=Object.assign(new m,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Oa}),Promise.resolve(Za)}Oa=this.re(ja);ja=new H(ja,Oa,!ba,null,x.AFrameworkApplication.userSessionId);return this.V6g.getAccessToken(ja,Za,Ia).then(wa=>Object.assign(new m,{IsSuccess:!0,Token:wa.accessToken}),wa=>Object.assign(new m,{IsSuccess:!1,ErrorCode:wa}))}gce(){return Promise.resolve(Object.assign(new m,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X$d(){return!1}MJc(){return this.EVb}}Object(C.a)(M,"ParentFrameTokenStrategy",null,[309]);var F=c(44),J=c(1337),I=c(77);class K{constructor(){this.reject=this.resolve=null;this.startTime=0;this.ZIi=this.Agh=null}}Object(C.a)(K,"PromiseWrapper",null,[]);class N{constructor(Oa=0){this.wx=0;this.Ftc=!1;this.Ex=new I.a;this._timeout=Oa}enqueue(Oa){return new Promise((Za,
ja)=>{this.Ex.add(Object.assign(new K,{ZIi:Oa,resolve:Za,reject:ja}));this.process()})}process(){if(this.Ftc||this.wx===this.Ex.count)return!1;const Oa=this.Ex.J(this.wx++);try{this.Ftc=!0,Oa.ZIi().then(Za=>{this.Ftc=!1;this.RYe(Oa,Za,null,!0)}).catch(Za=>{this.Ftc=!1;this.RYe(Oa,null,Za,!1)})}catch(Za){this.Ftc=!1,this.RYe(Oa,null,Za,!1)}return!0}RYe(Oa,Za,ja,ba){if(ba){const qa=()=>{Oa.resolve(Za);this.process()};0<this._timeout?window.setTimeout(()=>{qa()},this._timeout):qa()}else{const qa=()=>
{Oa.reject(ja);this.process()};0<this._timeout?window.setTimeout(()=>{qa()},this._timeout):qa()}}}Object(C.a)(N,"PromiseQueue",null,[]);class G{constructor(){this.correlationId=this.resolve=null}}Object(C.a)(G,"ResolveWithCorrelation",null,[]);var P=c(64),S=c(154),W=c(930),X=c(87);class Y extends S.a{constructor(Oa,Za,ja,ba,qa,Ma,Ia){super(!1,!1,!0);this.JCg=this.Cxa=null;this.Yqa=Oa;this.ISj=ja;this.Rt=ba;this.a_j=qa;this.Jqb=Ma;this.GG=document.createElement("iframe");this.GG.id="SharedAuthInteractiveFrame";
this.GG.setAttribute("name","SharedAuthInteractiveFrame");this.GG.setAttribute("title","SharedAuthInteractiveFrame");this.GG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.GG.style.border="0";this.GG.style.height="48px";this.GG.style.width="190px";$addHandler(this.GG,"error",Object(F.a)(this,this.PZm,"onSharedAuthFrameError"));Oa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Yqa,Za,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",x.AFrameworkApplication.userType);Ia&&(Oa+="&vnext=1");this.GG.src=Oa;this.UCj=new Promise(wa=>{this.JCg=wa});this.KCg=!1}gQa(){this.Cxa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ISj,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:x.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(F.a)(this,this.wLk,"createFrame"),["resolveDialogStyles"]:this.JCg}};this.Gd=5;this.Vh(CommonUIStrings.l_SignIn,Object(F.a)(this,this.aUn,"sharedAuthConsentDialogHandler"),
this.Cxa)}Pjj(Oa=!1,Za=5){this.Cxa&&this.Cxa.bodyControls&&(!0!==Object(P.a)(Object,this.Cxa.bodyControls).frameLoaded&&(Object(P.a)(Object,this.Cxa.bodyControls).frameLoaded=!0),Oa!==Object(P.a)(Object,this.Cxa.bodyControls).frameLoadSuccess&&(Object(P.a)(Object,this.Cxa.bodyControls).frameLoadSuccess=Oa),Za!==this.Cxa.dialogButtonsOption&&(this.Cxa.dialogButtonsOption=null,this.Gd=Za),this.update(this.Cxa))}$_n(Oa,Za){const ja=new W.a(X.a.eUn);ja.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:x.AFrameworkApplication.isRtl,["messageCorrelationId"]:Oa,["dialogStyles"]:Za};this.Rt.T2a(ja,this.GG.contentWindow,this.Yqa)}xLh(){this.Pjj(!1,6)}get j3i(){return this.GG}get sXk(){return this.UCj.then(Oa=>{this.KCg=!0;return Oa})}get tXk(){return this.KCg}PZm(){this.xLh()}wLk(){return this.GG}aUn(Oa){0===Oa&&(this.a_j.reject(Object.assign(new m,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Jqb(null))}}
Object(C.a)(Y,"SharedAuthConsentDialog",S.a,[316]);var ca=c(935),ha=c(83),ra=c(113),sa=c(37),oa=c(121),ka=c(160);class ia{constructor(){this.GG=null;this.fcd=0;this.TSb=this.lWb=this.Fie=this.Jqb=this.u9=this.c5g=null;this.Rt=new ca.a(null,null);this.jpd=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.EVb="SharedAuthTokenStrategy "+(this.jpd?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.Yqa=A.a.cUn;this.g1g=
A.a.bUn;this.kEg=A.a.enableConsoleLogging;this.ZDj=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.nXj=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",this.jpd);this.v9a={};this.rJj=new N(1500)}MJc(){return this.EVb}initialize(){var {OAuthManager:Oa}=c(1530);if("loadFrame"in this.v9a)return this.v9a.loadFrame.Agh;if(!this.Yqa)return ha.Health.instance.recordKpiFailure(Oa.kpiName,
"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Oa=this.z$d("loadFrame");this.fcd=sa.a.kf();var Za=this.Yqa+this.g1g+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+x.AFrameworkApplication.userSessionId+"&WacUserType="+x.AFrameworkApplication.userType;this.jpd&&(Za+="&vnext=1");this.GG=document.createElement("iframe");this.Vnf(this.GG);this.GG.style.cssText=
"height:0;width:0;display:none;";this.GG.id="SharedAuthFrame";this.GG.setAttribute("name","SharedAuthFrame");this.GG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.GG.setAttribute("title","SharedAuthFrame");this.GG.src=Za;document.body.appendChild(this.GG);Za=sa.a.kf()-this.fcd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Za,this.GG.src);return Oa}vTd(Oa){this.Fie=Oa;const Za=
new W.a(X.a.m3i);Za.Values=this.fgh(Oa);Oa=this.z$d("initFrame");this.Rt.T2a(Za,this.GG.contentWindow,this.Yqa);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Oa}Qoa(Oa,Za,ja,ba,qa,Ma){const Ia=new W.a(X.a.fUn),wa=this.nZh();Ia.Values=this.mfj(Oa,Za,ja,ba,qa,Ma,wa);Oa=this.z$d(wa);ba&&x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.rJj.enqueue(()=>new Promise(za=>{this.cfo(Ma,
Ia,za,wa)})):(this.Rt.T2a(Ia,this.GG.contentWindow,this.Yqa),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Za));return Oa}cfo(Oa,Za,ja,ba){const qa=this.v9a[ba];qa&&(this.lWb=Za,this.Jqb=Object.assign(new G,{resolve:ja,correlationId:ba}),this.u9=new Y(this.Yqa,this.g1g,Oa,this.Rt,qa,ja,this.jpd),this.u9.gQa())}nZh(){return oa.a.create().toString()}mfj(Oa,Za,ja,ba,qa,Ma,Ia){const wa={};wa.appName=Oa;wa.appId=Za;wa.target=ja;wa.withPopup=ba;
wa.claims=qa;wa.promptMessage=Ma;wa.messageCorrelationId=Ia;return wa}Vnf(Oa){$addHandler(Oa,"load",Object(F.a)(this,this.xVm,"onIFrameLoaded"));$addHandler(Oa,"error",Object(F.a)(this,this.xib,"onIFrameError"));this.Rt.AVa(this.Yqa);this.Rt.Av(X.a.p3i);this.Rt.fC(X.a.p3i,Object(F.a)(this,this.qZm,"onScriptLoaded"));this.Rt.Av(X.a.o3i);this.Rt.fC(X.a.o3i,Object(F.a)(this,this.pZm,"onScriptInitialized"));this.Rt.Av(X.a.k3i);this.Rt.fC(X.a.k3i,Object(F.a)(this,this.aVm,"onGetTokenResponse"));this.Rt.Av(X.a.q3i);
this.Rt.fC(X.a.q3i,Object(F.a)(this,this.wWm,"onLoginResponse"));this.Rt.Av(X.a.n3i);this.Rt.fC(X.a.n3i,Object(F.a)(this,this.UVm,"onInteractiveFlowReady"));this.Rt.Av(X.a.l3i);this.Rt.fC(X.a.l3i,Object(F.a)(this,this.jVm,"onHideDialog"));this.Rt.Av(X.a.i3i);this.Rt.fC(X.a.i3i,Object(F.a)(this,this.rGf,"onCloseDialog"))}z$d(Oa){const Za=new K;Za.startTime=sa.a.kf();const ja=new Promise((ba,qa)=>{Za.resolve=ba;Za.reject=qa});Za.Agh=ja;this.v9a[Oa]=Za;return ja}xVm(){const Oa=sa.a.kf()-this.fcd;l.ULS.sendTraceTag(572346566,
3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Oa)}xib(Oa){const {OAuthManager:Za}=c(1530),ja=sa.a.kf()-this.fcd,ba=Object.assign(new ka.a,{durationMs:ja});ha.Health.instance.recordKpiFailure(Za.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ba);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ja,this.kEg?JSON.stringify(Oa):"")}qZm(Oa){const {OAuthManager:Za}=c(1530),ja=this.v9a.loadFrame;var ba=sa.a.kf()-ja.startTime,qa=Oa.Values.AuthLibrary.toString();
Oa=Oa.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Oa,qa,ba);qa&&(this.EVb="SharedAuthTokenStrategy "+qa);qa=Boolean.parse(Oa);qa||(Oa=ra.a.jF(),void 0!==Oa&&null!==Oa&&(Oa.set("AuthLibrary",this.MJc()),ba=Object.assign(new ka.a,{durationMs:ba,extendedProperties:Oa}),ha.Health.instance.recordKpiFailure(Za.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ba)));ja.resolve(qa?0:1)}pZm(Oa){if(Oa.Values.interactive&&
this.lWb&&this.lWb.Values.messageCorrelationId){const ja=this.lWb.Values.messageCorrelationId.toString();if(Oa.Values.interactive&&this.u9){this.u9.sXk.then(ba=>{this.Rt.T2a(this.lWb,this.u9.j3i.contentWindow,this.Yqa);this.u9.$_n(ja,ba);this.u9.Pjj(!0);this.lWb=null});return}}Oa=this.v9a.initFrame;const Za=sa.a.kf()-Oa.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Za);Oa.resolve(0)}aVm(Oa){if(Oa.Values.messageCorrelationId&&Oa.Values.messageCorrelationId.toString()){var Za=
Oa.Values.messageCorrelationId.toString(),ja=this.v9a[Za];if(ja){var ba=sa.a.kf()-ja.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ba);Oa.Values.isSuccess&&Oa.Values.isSuccess?ja.resolve(Oa.Values.response):ja.reject(Oa.Values.response);this.Ifj(Za)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}UVm(){if(this.u9.tXk)this.u9.xLh();
else if(this.Fie&&this.u9){const Oa=new W.a(X.a.m3i);Oa.Values=this.fgh(this.Fie,!0);this.Rt.T2a(Oa,this.u9.j3i.contentWindow,this.Yqa)}}jVm(){this.u9&&this.u9.uLd()}rGf(Oa){Oa.Values.cancelled&&Oa.Values.cancelled&&Oa.Values.messageCorrelationId&&this.Ifj(Oa.Values.messageCorrelationId.toString());this.u9&&this.u9.hide()}fgh(Oa,Za=!1){const ja={};ja.appIds=this.ekl();ja.upn=Oa.loginHint;ja.authority=Oa.authority;ja.authorityType=Object(e.a)(h,Oa.authorityType);ja.tenantId=Oa.tenantId;ja.correlationId=
x.AFrameworkApplication.userSessionId;ja.enableConsoleLogging=this.kEg;ja.enablePopupFlash=this.ZDj;ja.skipUpnCheck=this.nXj;ja.interactive=Za;return ja}ekl(){const Oa=[],Za=A.a.dRe;for(let ja in Za)Array.add(Oa,Za[ja]);return Oa}gce(Oa,Za,ja,ba,qa,Ma){const Ia=new W.a(X.a.dUn),wa=this.nZh();Ia.Values=this.mfj(Oa,Za,ja,ba,qa,Ma,wa);this.c5g=Ia;Oa=this.z$d(wa);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Za);this.PYn();return Oa}X$d(){return!0}PYn(){this.TSb||
(this.TSb=new J.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.TSb.id=16,this.TSb.RPd=!1,this.TSb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Rt.T2a(this.c5g,this.GG.contentWindow,this.Yqa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),x.AFrameworkApplication.ta.Rb.BJa(this.TSb,!0)||l.ULS.sendTraceTag(555049438,
3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}wWm(Oa){if(Oa.Values.messageCorrelationId&&Oa.Values.messageCorrelationId.toString()){var Za=this.v9a[Oa.Values.messageCorrelationId.toString()];if(Za){var ja=sa.a.kf()-Za.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ja);Oa.Values.isSuccess&&Oa.Values.isSuccess?Za.resolve(Oa.Values.response):Za.reject(Oa.Values.response)}else l.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Ifj(Oa){this.Jqb&&this.Jqb.correlationId===Oa&&(this.Jqb.resolve(null),this.Jqb=null)}}Object(C.a)(ia,"SharedAuthTokenStrategy",null,[309]);class La{constructor(Oa){this.n5=Oa;this.EVb="UnsupportedAuthTokenStrategy Reason="+a.a[this.n5]}initialize(){return Promise.resolve(0)}vTd(){return Promise.resolve(0)}Qoa(){return Promise.resolve(Object.assign(new m,
{IsSuccess:!1,ErrorCode:a.a[this.n5],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.n5]+"]"}))}gce(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X$d(){return!1}MJc(){return this.EVb}}Object(C.a)(La,"UnsupportedAuthTokenStrategy",null,[309]);var va=c(1459);c.d(O,"OAuthManager",function(){return Ga});class Ga{constructor(Oa=null){this.Xha=
0;this.gca=null;this.qtb=0;const Za=sa.a.kf();this.YIj=this.yWk(Oa).then(ja=>ja?this.h3l():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Za)),ja=ra.a.jF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.bK()),ja=Object.assign(new ka.a,{durationMs:Math.floor(sa.a.kf()-Za),extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyPickFailed",!1,!0,ja)),Promise.resolve(1))).then(ja=>
0!==ja?Promise.resolve(ja):this.Aum())}zWk(){var Oa=A.a.eLm;Oa&&0<Oa.length?(this.Xha=1,this.gca=new v(Oa)):x.AFrameworkApplication.K.$("IsO365ConsumerHost")||x.AFrameworkApplication.K.$("IsO365CommercialHost")?x.AFrameworkApplication.K.$("IsAnonymousUser")?(this.Xha=2,this.gca=new La(this.Xha)):(Oa=u.a.getAuthContext().loginHint)&&Oa.length?A.a.rLc?(this.Xha=1,this.gca=new M):(this.Xha=1,this.gca=new ia):(this.Xha=3,this.gca=new La(this.Xha)):(this.Xha=4,this.gca=new La(this.Xha))}bK(){return this.gca?
this.gca.MJc()||"Unknown":"None"}yWk(Oa=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Za=sa.a.kf();return x.AFrameworkApplication.K.dvl().then(ja=>{ja?(this.zWk(),Oa&&(this.gca=Oa),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",A.a.clientVersion,A.a.appVersion,A.a.T_k,this.bK(),Math.floor(sa.a.kf()-Za))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(sa.a.kf()-Za));return Promise.resolve(ja)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(sa.a.kf()-Za));return Promise.resolve(!1)})}h3l(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.bK());const Oa=sa.a.kf();return n.get(this.gca.initialize(),2,A.a.BOf).then(Za=>{if(0===Za)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.bK(),Math.floor(sa.a.kf()-Oa));else if(1===Za){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Oa));var ja=ra.a.jF();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.bK()),ja=Object.assign(new ka.a,{durationMs:Math.floor(sa.a.kf()-Oa),extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitFailed",!1,!0,ja))}else 2===Za&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.bK(),Math.floor(sa.a.kf()-Oa)),ja=ra.a.jF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.bK()),ja=Object.assign(new ka.a,{durationMs:Math.floor(sa.a.kf()-Oa),extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitTimedOut",!1,!0,ja)));return Promise.resolve(Za)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Oa));return Promise.resolve(1)})}Aum(){l.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.bK());const Oa=sa.a.kf();return n.get(this.gca.vTd(u.a.getAuthContext()),2,A.a.BOf).then(Za=>{if(0===Za)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.bK(),Math.floor(sa.a.kf()-Oa));else if(1===Za){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Oa));var ja=ra.a.jF();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.bK()),ja=Object.assign(new ka.a,
{durationMs:Math.floor(sa.a.kf()-Oa),extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyLoadFailed",!1,!0,ja))}else 2===Za&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Oa)),ja=ra.a.jF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.bK()),ja=Object.assign(new ka.a,{durationMs:Math.floor(sa.a.kf()-Oa),extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,
"StrategyLoadTimedOut",!1,!0,ja)));return Promise.resolve(Za)},()=>{l.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.bK(),Math.floor(sa.a.kf()-Oa));return Promise.resolve(1)})}Qoa(Oa,Za,ja=null){return this.mhc(Oa,Za,!1,null,"",ja)}nfj(Oa,Za,ja,ba,qa=null){return this.mhc(Oa,Za,!0,ja,ba,qa)}mhc(Oa,Za,ja,ba,qa,Ma,Ia=0){Ia+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
Oa,this.GJb(Oa,Za),this.bK(),Ia);var wa=ra.a.jF();void 0!==wa&&null!==wa&&(wa.set("AuthLibrary",this.bK()),wa.set("AppName",Oa),wa.set("Target",this.GJb(Oa,Za)),ha.Health.instance.recordKpiUsage(Ga.kpiName,0,"WacOAuthFC",wa));if(!A.a.isEnabled){var za;return this.Txf((za=new m,za.IsSuccess=!1,za.Token=null,za.ErrorCode="NotEnabled",za.ErrorMessage="OAuthManager is disabled.",za),Oa)}const pa=A.a.dRe[Oa];if(void 0===pa||null===pa){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
Oa);var Ba;return this.Txf((Ba=new m,Ba.IsSuccess=!1,Ba.Token=null,Ba.ErrorCode="DisallowedApp",Ba.ErrorMessage="Disallowed appName: "+Oa,Ba),Oa)}const Ra=sa.a.kf(),fb=this;wa=this.YIj.then(qb=>fb.B$l(Oa,pa,Za,ja,ba,qa,Ma,qb));za=ja?0:A.a.BOf;let Va;Ba=(Va=new m,Va.IsSuccess=!1,Va.Token=null,Va.ErrorCode="authTokenStrategy_timeout",Va.ErrorMessage="Auth Strategy timed out after ["+za+"] ms when fetching token",Va);let ib=this,Xa=this;return n.get(wa,Ba,za).then(qb=>Ia<=Ga.vIm&&(qb.ErrorCode===Ga.mcj||
qb.ErrorCode===Ga.V5n)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ia,Math.floor(sa.a.kf()-Ra)),ib.mhc(Oa,Za,ja,ba,qa,Ma,Ia)):qb.ErrorCode===Ga.Cki&&!ja&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ia,Ga.IEh),Ga.g3k&&ib.gca.X$d()&&ib.gca.gce(Oa,pa,Za,ja,ba,qa).then(rb=>Promise.resolve(ib.YTd(rb,Oa,Za,pa,Ra))).catch(()=>{let rb;const nb=(rb=new m,rb.IsSuccess=!1,rb.Token=
null,rb.ErrorCode="authTokenStrategy_failure",rb.ErrorMessage="LoginPopup failed, GetToken could not be called",rb);return Promise.resolve(ib.YTd(nb,Oa,Za,pa,Ra))}),Ga.IEh)?ib.mhc(Oa,Za,!0,ba,qa,Ma,Ia):Promise.resolve(ib.YTd(qb,Oa,Za,pa,Ra))).catch(()=>{let qb;const rb=(qb=new m,qb.IsSuccess=!1,qb.Token=null,qb.ErrorCode="authTokenStrategy_failure",qb.ErrorMessage="Auth Strategy failed with an unknown error",qb);return Promise.resolve(Xa.YTd(rb,Oa,Za,pa,Ra))})}B$l(Oa,Za,ja,ba,qa,Ma,Ia,wa){return 1===
wa||2===wa?this.Txf(Object.assign(new m,{IsSuccess:!1,Token:null,ErrorCode:1===wa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Oa):this.gca.Qoa(Oa,Za,ja,ba,qa,Ma,Ia).then(za=>Promise.resolve(this.Avi(za,!0,Oa))).catch(za=>Promise.resolve(this.Avi(za,!1,Oa)))}YTd(Oa,Za,ja,ba,qa){const Ma={};qa=sa.a.kf()-qa;Ma.IsSuccess=Oa.IsSuccess;Ma.ErrorCode=Oa.IsSuccess?"Success":Oa.ErrorCode||"";Ma.ErrorMessage=Oa.IsSuccess?"Success":this.GJb(Za,Oa.ErrorMessage||"");Ma.Target=
this.GJb(Za,ja||"");Ma.TimeInMS=Math.floor(qa);Ma.AuthLibrary=this.bK();Ma.AppName=Za;Ma.AuthorityType=Object(e.a)(h,u.a.yEd());Ma.UserType=this.mQl(u.a.getAuthContext());Ma.IsAuthSupportedInSession=a.a[this.Xha];Ma.RequestCount=++this.qtb;Ma.AppId=ba;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ma));Oa.IsSuccess||(ja=ra.a.jF(),void 0!==ja&&null!==ja&&(ja.set("AppName",Za),ja.set("AuthLibrary",this.bK()),ja.set("ErrorCode",Oa.ErrorCode),ja.set("ErrorMessage",this.GJb(Za,Oa.ErrorMessage)),Za=
Object.assign(new ka.a,{durationMs:qa,extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"TryGetTokenFailure",!1,!0,Za)));return Oa}Txf(Oa,Za){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Za,this.GJb(Za,Oa.ErrorMessage));const ja=ra.a.jF();void 0!==ja&&null!==ja&&(ja.set("AppName",Za),ja.set("AuthLibrary",this.bK()),ja.set("ErrorCode",Oa.ErrorCode),ja.set("ErrorMessage",this.GJb(Za,Oa.ErrorMessage)),Za=Object.assign(new ka.a,
{extendedProperties:ja}),ha.Health.instance.recordKpiFailure(Ga.kpiName,"FailureBeforeGetToken",!1,!0,Za));return Promise.resolve(Oa)}sei(Oa){return Oa===va.a.bbe}GJb(Oa,Za){return this.sei(Oa)&&Za?"REDACTED":Za}mQl(Oa){return x.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!Oa.loginHint||1>Oa.loginHint.length?"empty":-1<Oa.loginHint.indexOf("guest#")?"guest":-1<Oa.loginHint.indexOf("ext#")?"external":0>Oa.upn.indexOf("@")?"no-at":"supported"}Ham(){return 1===this.Xha}Avi(Oa,Za,ja){let ba=
null,qa=null,Ma=null,Ia=null;Oa?Oa.ErrorCode||Oa.ErrorMessage?(qa=Oa.ErrorCode?Oa.ErrorCode:Ga.GGh,Ma=Oa.ErrorMessage?Oa.ErrorMessage:"No message"):Oa.Token?Za?ba=Oa.Token:(qa=Ga.uqn,Ma="A rejected promise returned a token."):(qa=Ga.GGh,Ma=JSON.stringify(Oa)):(qa=Ga.WNm,Ma="No result came from Auth Token Strategy");Oa&&Oa.Telemetry&&!this.sei(ja)&&(Ia=Oa.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ia)));if(qa===Ga.BLm||qa===Ga.Dbo)qa=Ga.mcj,Ma="Auth Library Timed Out";qa===Ga.Mhk&&
-1<Ma.indexOf(Ga.e1j)&&(qa=Ga.Cki);if(qa||Ma)ba=null;return Object.assign(new m,{IsSuccess:!!ba,Token:ba,ErrorCode:qa,ErrorMessage:Ma,Telemetry:Ia})}static get IEh(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get g3k(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ga.Dbo="token_renewal_error";Ga.GGh="Exception";Ga.WNm="NoResult";Ga.uqn="RejectToken";
Ga.BLm="monitor_window_timeout";Ga.mcj="Timeout";Ga.V5n="authTokenStrategy_timeout";Ga.Mhk="login_required";Ga.e1j="AADSTS50058";Ga.Cki="Cookies Disabled";Ga.kpiName="OAuthManager";Ga.vIm=2;Object(C.a)(Ga,"OAuthManager",null,[273])},1531:function(C,O,c){c.r(O);C=c(0);var l=c(2),e=c(104),a=c(23),h=c(60),m=c(373),v=c(44),u=c(48),n=c(6);class x{C3e(ob,Fb,gb){return 1===gb?32:x.HUk(Fb.node)}static HUk(ob){const Fb=new n.GraphIterator;Fb.set(ob);Fb.ro();ob=new u.GraphTransaction(7);ob.Qu(Fb);Fb.Hg();ob.dispose();
return 32}}Object(C.a)(x,"DeleteOutlineLevelContentStrategy",null,[]);var A=c(106),H=c(183),E=c(67),L=c(229),M=c(19),F=c(24),J=c(11),I=c(109),K=c(40),N=c(211),G=c(93),P=c(33);class S{constructor(ob){this.xm=null;this.Cja=ob}get gwb(){return null!=this.shg?this.shg:this.shg=a.a.instance.Pa("Box4.IAutoCorrectRules")}get $V(){return null!=this.uhg?this.uhg:this.uhg=a.a.instance.Pa("Box4.IAutoCorrectScheduler")}get fM(){return null!=this.$pg?this.$pg:this.$pg=a.a.instance.Pa("Box4.Pages.IPageContentEditor")}get xK(){return null!=
this.ypg?this.ypg:this.ypg=a.a.instance.Pa("Box4.IOutlineEditor")}get zi(){return this.xm||(this.xm=this.Cja())}dmi(ob,Fb,gb){if(this.xK&&S.wi){var Jb=L.ContextSetEditor.Cff(Fb);ob=Jb.node;M.SelectionEditor.qk(Jb)&&(Jb=P.a.Uc(ob,J.ParagraphReader.textLength(ob)));var Yb=I.FormattingReader.language(I.FormattingReader.Qr(Jb));Jb=n.GraphIterator.Za(gb.ld);S.qh.YYc(Jb);var tc=ob=null;if(Jb)for(let Ec=Jb.Pb(1);Ec&&!tc;Ec=Jb.xi(1))G.OutlineReader.kua(Ec)&&(tc=Ec);if(Jb&&!tc){if(!this.fM||!this.xK)return;
ob=new u.GraphTransaction(7);ob.Qu(Jb);tc=this.fM.Sxd(Jb);this.xK.E5(Jb,!0);Yb&&(K.OutlineElementNavigator.Fe(Jb),Jb=P.a.Uc(Jb.currentNode,0),S.wi.g7d(I.FormattingReader.Qr(Jb),Yb))}Yb=F.SelectionFactory.xo(tc,!0);gb.Cb.setSelection(Yb);M.SelectionEditor.zf(Fb)&&(gb=n.GraphIterator.Za(Fb.node),gb.ro(),N.OutlineNavigator.AVf(gb),this.gwb&&this.$V&&G.OutlineReader.Uz(gb,Fb,!0)&&(Fb=this.gwb.G9e(Fb,-1,!1,E.a.px))&&this.$V.BWi(Fb));this.zi&&this.zi.KF();ob&&ob.dispose()}}static get wi(){return null!=
S.olg?S.olg:S.olg=a.a.instance.Pa("Box4.IFormattingEditor")}static get instance(){return null!=S.Png?S.Png:S.Png=S.Hl()}static Hl(){return new S(()=>a.a.instance.Pa("Box4.IUndoManager"))}static get qh(){return H.PageNavigator.instance}}Object(C.a)(S,"TitleViewEditor",null,[]);var W=c(53),X=c(442),Y=c(646),ca=c(22),ha=c(14),ra=c(297),sa=c(3);class oa{constructor(){this.KCj=new x}Vb(ob){const Fb=Object(v.a)(this.$zh,this.$zh.K3e,"deleteView"),gb=Object(v.a)(this,this.C3e,"deleteOutlineLevelContent"),
Jb=Object(v.a)(this.Pzh,this.Pzh.MUk,"deleteParagraphContent");this.FRf(ob,Fb,gb,Jb);ob.pa(sa.a.backspace,ha.a.Wc,Jb);ob.pa(sa.a.backspace,ha.a.Hd,Jb);ob.pa(sa.a.backspace,ha.a.endOfParagraph,e.ActionManager.uZ);ob.pa(sa.a.backspace,ha.a.outline,gb);ob.pa(sa.a.backspace,ha.a.view,Fb);ob.Vc(sa.a.backspace,1124);ob.pa(sa.a.Dsa,ha.a.Wc,e.ActionManager.uZ);ob.pa(sa.a.Dsa,ha.a.Hd,Jb);ob.pa(sa.a.Dsa,ha.a.endOfParagraph,e.ActionManager.uZ);ob.pa(sa.a.Dsa,ha.a.outline,gb);ob.pa(sa.a.Dsa,ha.a.view,Fb);ob.gb(sa.a.nyd,
ha.a.view,Fb,1124);ob.pa(sa.a.XG,ha.a.Wc,Jb);ob.pa(sa.a.XG,ha.a.Hd,Jb);ob.pa(sa.a.XG,ha.a.endOfParagraph,e.ActionManager.uZ);ob.pa(sa.a.XG,ha.a.outline,gb);ob.pa(sa.a.XG,ha.a.view,Fb);ob.Vc(sa.a.XG,1124);ob.gb(sa.a.S1e,ha.a.view,Fb,1124);ob.gb(sa.a.Oka,ha.a.view,oa.Oka,1028)}FRf(){}C3e(ob,Fb,gb,Jb,Yb){return this.KCj.C3e(ob,Fb,gb,Jb,Yb)}static get qh(){return H.PageNavigator.instance}static get Ug(){return null!=oa.Bpg?oa.Bpg:oa.Bpg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get fM(){return null!=
oa.Xpg?oa.Xpg:oa.Xpg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get xK(){return null!=oa.xpg?oa.xpg:oa.xpg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Wb(){return null!=oa.xkg?oa.xkg:oa.xkg=a.a.instance.Pa("Box4.IFeatureHelper")}static Oka(ob,Fb,gb,Jb,Yb){Jb=Fb.view;if(!Jb.Cb||!Jb.Cb.ib.kb||M.SelectionEditor.Dm(Jb.Cb.ib.kb))return 8;if(1===gb)return 32;gb=Jb.Cb.ib;const tc=gb.kb;var Ec=tc.Qa,Vc=null,Hd=!1;if(gb.JI){if(Ec.contextId===ha.a.outline&&1===gb.length){for(ob=
n.GraphIterator.Za(Ec.node);ob.Ud();)ob.Hg();oa.xK.E5(ob,!0);K.OutlineElementNavigator.Fe(ob);ob=F.SelectionFactory.xe(ob.currentNode,0);Jb.Cb.setSelection(ob);return 32}var qd=Ec.node;Vc=null;if(ra.c(Ec)){var me=qd.Be(Jb.Sb);me&&(me=me.nMo)&&0<=me.width&&0<=me.height&&(Vc=new X.a(h.a.rn(me.x,0),h.a.rn(me.y,1)));Vc||(Vc=Y.a(qd))}else Vc=Y.a(Ec.node);Ec=n.GraphIterator.Za(Ec.node);Ec.ro();oa.qh.YYc(Ec);qd=oa.fM.Sxd(Ec);Y.b(qd,Vc.x,Vc.y);oa.xK.E5(Ec,!0);Vc=F.SelectionFactory.xo(qd,!0)}else if(1===gb.length){Hd=
gb.last;Ec=W.a.Rxb(Hd);if(oa.Wb&&oa.Wb.isFeatureEnabled(23)&&L.ContextSetEditor.instance.K1f(Ec).returnValue)return 2;Hd=Hd.Tc;Hd=!gb.Bw&&(M.SelectionEditor.qk(Hd)||J.ParagraphReader.em(Hd)||M.SelectionEditor.J6(Hd))}Hd&&(Hd=M.SelectionEditor.Qj(tc,!1,!1,void 0,!1),Jb.Cb.setSelection(Hd),l.AFrameworkApplication.ya.Vf(Fb,sa.a.newLine,2,!1,null,Yb),Vc=Jb.Cb.ib.kb,Jb.Cb.setSelection(tc));Yb||(Yb=new m.DictionaryPropertySet);Yb.setValue(A.a.zEc,!0);l.AFrameworkApplication.ya.Vf(Fb,sa.a.XG,2,!0,null,Yb);
if(Vc&&Vc.Qa.Sd)return Jb.Cb.setSelection(Vc),32;gb.JI&&S.instance.dmi(ob,Fb.rk,Jb);M.SelectionEditor.Dm(Jb.Cb.ib.kb)||l.AFrameworkApplication.ya.Vf(Fb,sa.a.newLine,2,!1,null,Yb);return 32}static GUk(ob,Fb){if(1===Fb)return 32;Fb=new u.GraphTransaction(7);Fb.Eb(ob);oa.Ug.kPa(ob);Fb.dispose();return 32}}Object(C.a)(oa,"ADeleteActor",null,[]);var ka=c(9),ia=c(246),La=c(254),va=c(20),Ga=c(159),Oa=c(1462);class Za{UTk(ob,Fb,gb){({DeleteActor:ob}=c(1531));if(1===gb)return 32;gb=ka.App.xa.lq.jg("ModelUpdate",
"DeleteAnchoredObject");Fb=Fb.node;const Jb=new n.GraphIterator;Jb.set(Fb);Jb.Ab(12);const Yb=Jb.gp(12);if(Za.ag.HOc(Yb))return 2;ob.QWb(Yb);ob=new u.GraphTransaction(7);ob.Eb(Fb);Jb.Hg();ob.dispose();gb.stop();return 32}static get ag(){return ia.a.instance}}Object(C.a)(Za,"DeleteAnchoredObjectStrategy",null,[]);var ja=c(59),ba=c(17),qa=c(123),Ma=c(64),Ia=c(115),wa=c(693),za=c(107);class pa{get ag(){return ia.a.instance}MUk(ob,Fb,gb,Jb,Yb){if(1===gb)return 32;Jb=ob===sa.a.backspace;if(this.ag.xh){if(this.ag.Dei(Fb)&&
pa.nsa&&(gb=Fb.clone(),gb.Tb+=1,--gb.Fb,this.ag.d8b(gb)))return pa.nsa.iOi([gb]),32;if(this.ag.msf(Fb,Jb))return 2}if(pa.xw()&&pa.xw().instance&&pa.xw().instance.KT(Fb))return 4;var tc=Fb.node;let Ec=Fb.cpBegin;gb=Fb.cpEnd;let Vc=Fb.Fb,Hd=Fb.Tb;const qd=J.ParagraphReader.text(tc),me=qd.length;let Zc=!1;if(Ec===gb){if(Jb&&!Ec||!Jb&&Ec===me)return 2;Jb?({cp:Ec,returnValue:Zc}=this.ag.Ati(tc,Ec),Zc||({cp:Ec,fka:Vc,returnValue:Zc}=this.ag.zti(Fb,Ec,Vc)),Zc||(Ec--,ba.a.Ty(qd,Ec)&&Ec--),ob=sa.a.cTe):({cp:gb,
returnValue:Zc}=this.ag.WLm(tc,gb),Zc||({cp:gb,fka:Hd,returnValue:Zc}=this.ag.VLm(Fb,gb,Hd)),Zc||(gb++,ba.a.Ty(qd,gb)&&gb++),ob=sa.a.zzh)}Fb=Ec===gb?P.a.Uc(tc,Ec):P.a.createTextRange(tc,Ec,gb);Zc&&this.ag.xh&&(Jb?Fb.Fb=Vc:Fb.Tb=Hd);if(!this.ag.d8b(Fb))return 2;this.QWb(tc);Jb=new u.GraphTransaction(15);Jb.Al=ob;Jb.Eb(tc);tc=Object(qa.a)(wa.a,Yb)&&Yb.jYa;if(pa.Rd.og&&!tc){tc=pa.Rd.ZVa();try{const Dc=pa.Ph.f1c(Fb);let ud;if(({type:ud}=Dc.YId()).returnValue){const Ce=Object(Ma.a)(89,Yb);Ce&&Ce.ia(Ia.a.wqf,
!1)||!za.a.tA&&4===ud?pa.Rd.L1a=ud:pa.Rd.ys(ud)}Yb=0;for(let Ce=Dc.length-1;0<=Ce;--Ce){let ee;const Uf=({cRd:ee}=Dc.getContext(Ce)).returnValue;ee?(pa.hyperlinkEditor.cib(Uf,null),Yb+=pa.Oj.Pkb(Uf,2),pa.Oj.rxd=gb+Yb):this.Qzh(Uf)}}finally{tc&&tc.dispose()}}else this.Qzh(Fb);Jb.dispose();return 32}QWb(){}static get Rd(){return null!=pa.jtg?pa.jtg:pa.jtg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Oj(){return null!=pa.Wsg?pa.Wsg:pa.Wsg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=
pa.Dtg?pa.Dtg:pa.Dtg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=pa.Rlg?pa.Rlg:pa.Rlg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static xw(){return pa.Km||(pa.Km=a.a.instance.$a("Box4.IExternalSelectionManager"))}static get nsa(){pa.Tpb||(pa.Tpb=a.a.instance.$a("Box4.ContentControl.IContentControlOperator"));return pa.Tpb.instance}}pa.Km=null;pa.Tpb=null;Object(C.a)(pa,"ADeleteParagraphContentStrategy",null,[]);var Ba=c(185),
Ra=c(793),fb=c(235),Va=c(90),ib=c(77),Xa=c(86);class qb extends pa{constructor(){super()}get characterPropertiesEditor(){return null!=this.Phg?this.Phg:this.Phg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get vq(){return null!=this.Ghg?this.Ghg:this.Ghg=a.a.instance.$a("Box4.ContentControlConfigSettings")}get Z9b(){return null!=this.kpg?this.kpg:this.kpg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get Wda(){return null!=this.lig?this.lig:this.lig=a.a.instance.resolve("Box4.IContentControlChpHelper")}Qzh(ob){this.$Tk(ob)}Hak(ob,
Fb,gb,Jb){this.vq.instance&&this.vq.instance.xh&&(ob.cpBegin===Fb.cpBegin?ob.Fb=Fb.Fb:gb&&(ob.Fb=gb.Jb&&gb.Jb.length?0:-1),ob.Tb=Jb)}QWb(ob){const {DeleteActor:Fb}=c(1531);Fb.QWb(ob)}$Tk(ob){var Fb=ob.node;const gb=fb.b([new Ba.a(ob.cpBegin,ob.cpEnd)],this.yPl(ob));var Jb=new Xa.a,Yb=[];qb.OAk(Fb,gb,Jb,Yb);for(let tc of Jb.keys)1<Jb.J(tc)&&Ra.a.Zwi(ja.a.Pf(tc));this.Ern(Fb,Yb);this.Z9b.hBc(Fb);Fb=ob.Tb;Jb=!!this.vq.instance&&this.vq.instance.xh;for(Yb=gb.length-1;0<=Yb;Yb--)Fb=this.deleteRange(ob,
gb[Yb],Fb,Jb)}yPl(ob){const Fb=[],gb=ob.node;var Jb=Va.f(gb,Ec=>Ec.eka);for(var Yb of Jb)Jb=Yb.Ob.cp,Fb.push(new Ba.a(Jb,Jb+1));Yb=J.ParagraphReader.QLa(gb);for(var tc of Yb)tc.QS&&qb.Rem(tc,ob)||Fb.push(tc);tc=!!this.vq.instance&&this.vq.instance.rma;this.vq.instance&&this.vq.instance.xh||!tc||!gb.yw||(qb.qsh&&qb.qsh.Dqn(ob),this.Wda&&Fb.push(...this.Wda.adf(gb).toArray()));return fb.a(Fb)}Ern(ob,Fb){const gb=new ib.a;for(let Jb of Fb)for(Fb=0;Fb<Jb.length;){Fb=this.QTh(Jb,Fb,0);if(-1===Fb)break;
let Yb=this.QTh(Jb,Fb+1,3);if(-1===Yb)break;if(Jb.J(Fb).QS)for(;Yb>=Fb;){const tc=Jb.J(Yb);gb.add(tc.Ge);Jb.remove(tc);Yb--}Fb=Yb+1}ob.Hga(va.a.instance.J(6),gb)}QTh(ob,Fb,gb){for(;Fb<ob.length;Fb++){const Jb=ob.J(Fb);if(1===Jb.EQ&&Jb.Wl===gb)return Fb}return-1}deleteRange(ob,Fb,gb,Jb){let Yb=Fb.begin,tc=Fb.end;Fb=null;Jb&&(Fb=ob.node.qa.ii(Yb));Yb<tc&&(Jb=P.a.createTextRange(ob.node,Yb,tc),this.Hak(Jb,ob,Fb,gb),this.characterPropertiesEditor.replaceTextRange(Jb,"",void 0,void 0,sa.a.Czc));return gb=
Fb&&Fb.Jb&&Fb.Jb.length?Fb.Jb.length:-1}static get qsh(){return null!=qb.xig?qb.xig:qb.xig=a.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator")}static Rem(ob,Fb){return ob.begin>=Fb.cpBegin&&ob.end<=Fb.cpEnd}static OAk(ob,Fb,gb,Jb){let Yb=0;ob=ob.qa;for(let tc of Fb)for(;Yb<ob.length;){Fb=ob.J(Yb);if(Fb.cp>=tc.begin&&Fb.cp<tc.end&&(Fb.gf&&Fb.gf.uFk&&Jb.push(Fb.gf),Fb.Lh))for(let Ec=0;Ec<Fb.Lh.length;Ec++){const Vc=Fb.Lh.J(Ec).sn.toString();gb.ub(Vc)?gb.Z(Vc,gb.J(Vc)+1):gb.Z(Vc,1)}++Yb}}}
Object(C.a)(qb,"DeleteParagraphContentStrategy",pa,[]);class rb{static get lG(){return La.a.instance}static hVk(ob,Fb,gb){if(1===gb)return 32;ob=Fb.node;return rb.lG.Ltd(ob)?oa.GUk(ob,gb):32}}Object(C.a)(rb,"DeleteUnsupportedObjectStrategy",null,[]);var nb=c(170),Tb=c(334),Zb=c(126),Hb=c(299),Sa=c(8),ua=c(1001),Fa=c(43),Pa=c(132),Ea=c(654),lb=c(441),zb=c(548),Xb=c(595),ub=c(832),Pb=c(186),yc=c(147),bc=c(291),Ka=c(528),Bb=c(38),tb=c(135);class Kb{constructor(ob,Fb,gb,Jb){this.cto=ob;this.C7=gb;this.Ed=
Jb;this.actionId=Fb}}Object(C.a)(Kb,"DeleteActionData",null,[]);var Ib=c(979),Wa=c(191),vc=c(865);class Lc{constructor(ob,Fb,gb,Jb,Yb,tc,Ec,Vc,Hd){this.Rzh=ob;this.ag=Fb;this.lG=gb;this.hyperlinkEditor=Jb;this.GI=Yb;this.Tn=tc;this.EEi=Ec;this.characterPropertiesEditor=Vc;this.Rd=Hd}static get gHm(){if(null!=Lc.Pfd)return Lc.Pfd;l.AFrameworkApplication.Ne("8d987234-t;c44i0588-c");Lc.Pfd=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MarkOeNodeForDeletionWhenBackspaceUsed",
!1);return Lc.Pfd}Dco(ob){return!M.SelectionEditor.Dk(ob)&&!M.SelectionEditor.eaa(ob)}uKl(ob,Fb,gb){let Jb,Yb,tc,Ec;if(!Fb&&ob&&ob.MC&&(Jb=ob.Qa)&&M.SelectionEditor.zf(Jb)&&this.Tn.nc(Jb.node)&&(Yb=Jb.node.qa.ii(Jb.cpBegin))&&Yb.vl&&(tc=this.jnl(Yb))&&tc.hyperlink.MF&&(Ec=this.kKl(ob,tc.cp)))return Ec;if(!ob)return null;if(!gb)return ob;Fb=M.SelectionEditor.$Xa(ob,!Fb,{hC:!1,Xs:!0,jE:!0,jG:!0});return F.SelectionFactory.KB(ob,Fb.Qa,!1)}jnl(ob){const Fb=ob.paragraph.qa;let gb=null;ob=ob.cp;for(let Jb=
0;Jb<Fb.length;Jb++){const Yb=Fb.J(Jb);if(Yb.cp>=ob)break;Yb.vl&&(gb=null);Yb.hyperlink&&(gb=Yb)}return gb}kKl(ob,Fb){var gb=M.SelectionEditor.cBa(ob,{hC:!1,Xs:!1,jE:!0,jG:!0});if(!gb||!gb.MC||gb.Qa.node!==ob.Qa.node)return null;gb=gb.Qa;if(gb.cpBegin!==gb.cpEnd)return null;const Jb=this.Tn.text(gb.node);for(let Yb=gb.cpBegin-1;Yb>=Fb;Yb--)if(!ba.a.gv(Jb.charCodeAt(Yb)))return F.SelectionFactory.KB(ob,P.a.Uc(gb.node,Yb+1),!1);return F.SelectionFactory.KB(ob,P.a.Uc(gb.node,Fb),!1)}K3e(ob,Fb,gb,Jb,
Yb){var tc,Ec;if(1===gb)return 32;vc.a.$Jf&&(gb=null===(Ec=null===(tc=Fb.view)||void 0===tc?void 0:tc.Cb)||void 0===Ec?void 0:Ec.Jg)&&L.ContextSetEditor.instance.wyh(gb).filter(J.ParagraphReader.HT).forEach(Vc=>{var Hd;return null===(Hd=J.ParagraphReader.ULa(Vc.node))||void 0===Hd?void 0:Hd.U7d("delete_selection")});Ec=!1;ob===sa.a.S1e?(ob=sa.a.XG,Ec=!0):ob===sa.a.nyd?(ob=sa.a.backspace,Ec=!0):ob===sa.a.Dsa&&(Fb=new zb.a(ka.App.xa.jb.Fc));if(!Fb.view.ye)return 2;yc.GrippersManager.instance.aB(!1);
tc=ob===sa.a.XG;gb=bc.a.lSh(Fb);if(Ec&&this.ag.xh&&gb&&M.SelectionEditor.Dm(gb)&&this.ag.msf(gb.Qa,!tc,!0))return 2;Ec=this.uKl(gb,tc,Ec);return this.jVk(ob,Fb,Jb,Yb,Ec,tc)}jVk(ob,Fb,gb,Jb,Yb,tc){const Ec=Fb.view,Vc=Ec.Cb;var Hd=Jb,qd=Jb;ob===sa.a.Dsa&&(qd=Hd=null,Yb=new Pb.Selection(Jb,!0));if(!Yb)return 32;const me=new Kb(Fb,ob,gb,qd),Zc=this.ZUn(Hd,tc);if(this.ag.xh&&Lc.nsa&&1===Vc.ib.length&&M.SelectionEditor.Dm(Yb)&&Yb.MC&&Lc.nsa.ZFn(Yb.Qa,tc))return 32;let Dc;tc?nb.a.mark(Dc=5009):nb.a.mark(Dc=
5011);Hd=new u.GraphTransaction(15);Hd.Al=ob;Hd.Eb(Ec.ld);let ud=null,Ce=({EEn:ud}=this.epl(ob,Jb,Vc,Yb,ud)).returnValue;qd=null;({x9d:qd}=L.ContextSetEditor.instance.K1f(Ce)).returnValue&&(Ce=qd);if(!Ce)return Hd.dispose(),32;this.ag.xh&&Lc.nsa&&(qd=L.ContextSetEditor.instance.qN(Ce),Lc.nsa.iOi(qd));this.Ldj(Ce);const ee=this.Oil(Ce,Yb,tc);let Uf=null;tc?Uf=new ub.a(Yb):ee&&(Uf=new ub.a(ee));let te=!1;qd=Lc.fj;if(M.SelectionEditor.zf(Ce)){const Fe=Ib.a.dHd(Ec.ld,Zc);qd.Qd(()=>{this.VTk(Fb,gb,Jb,
Ce,tc,Uf,Yb,Fe,Vc,Zc,me,ee)},"DVS:DAIPC")}else this.Rd.og?(qd.Qd(()=>{this.Cco(ob,Ec.ld,Ce,tc,Yb,Vc,Zc,me,Uf)},"DVS:TCDC"),te=!0):qd.Qd(()=>{te=this.NFi(ob,Ec.ld,Ce,Vc,Zc,me,Uf,ud)},"DVS:PUD");this.Acl(Vc);this.fTi(Ce);Hd.dispose();nb.a.mark(Dc+1);return ob===sa.a.Dsa?te?32:8:32}NFi(ob,Fb,gb,Jb,Yb,tc,Ec,Vc){Fb=Ib.a.dHd(Fb,Yb);this.Dco(gb)&&Fb.j4a(gb);ob=Lc.Kc.qo(ob);ob.properties.Z("CountOfParagraphsDeleted",this.Tn.A_e(gb).toString());gb=this.kZk(gb,Jb,Yb,Fb,tc,Ec,Vc);ob.end();return gb}Cco(ob,Fb,
gb,Jb,Yb,tc,Ec,Vc,Hd){var qd=0,me=null;const Zc=L.ContextSetEditor.instance.qN(gb),Dc=Zc[Zc.length-1];if(Dc.contextId===ha.a.paragraph||Dc.contextId===ha.a.endOfParagraph){var ud=n.GraphIterator.Za(Dc.node);ud.rd();K.OutlineElementNavigator.Xd(ud);K.OutlineElementNavigator.Wr(ud,!0,!1)&&(me=K.OutlineElementNavigator.Fe(ud))&&(qd=this.Tn.textLength(me))}else qd=this.Tn.textLength(Dc.node)-Dc.cpEnd;ud=Object(Ma.a)(89,Vc.Ed);if(ud=!!ud&&ud.ia(Ia.a.wqf,!1))this.LFi(ob,Fb,gb,tc,Ec,Vc,Hd,!1,ud);else{ud=
this.Rd.ZVa();try{this.LFi(ob,Fb,gb,tc,Ec,Vc,Hd,!0)}finally{ud&&ud.dispose()}}if(Jb){if(gb.zw){ob=Zc.length-1;do Yb=Zc[ob],ob--;while(!Yb.node.isConnected&&0<=ob)}else Yb=gb;if(!this.Tn.nc(Yb.node))return;switch(Dc.contextId){case ha.a.paragraph:case ha.a.endOfParagraph:qd=me&&me.isConnected?0:qd;break;case ha.a.Wc:case ha.a.Hd:break;default:qd=0}qd=F.SelectionFactory.xe(Yb.node,this.Tn.textLength(Yb.node)-qd);Yb.gl===qd.Qa.cpBegin&&(qd.Qa.Fb=Yb.Fb)}else{qd=Yb.Qa.node;if(!this.Tn.nc(qd))return;me=
Yb.Qa.contextId===ha.a.paragraph?0:Yb.Qa.contextId===ha.a.endOfParagraph?this.Tn.textLength(qd):Yb.Qa.cpBegin;qd=F.SelectionFactory.xe(qd,me)}W.a.instance.setSelection(qd)}LFi(ob,Fb,gb,Jb,Yb,tc,Ec,Vc,Hd=!1){gb=this.Ggl(Jb,gb);gb=Lc.Ph.f1c(gb);({type:me}=gb.YId()).returnValue&&(Vc&&4!==me?this.Rd.ys(me):za.a.tA||(this.Rd.L1a=me));for(Vc=gb.length-1;0<=Vc;--Vc){var qd=void 0;var me=({cRd:qd}=gb.getContext(Vc)).returnValue;qd?(qd=Hd&&me.contextId===ha.a.endOfParagraph&&Vc===gb.length-1,this.hyperlinkEditor.cib(me,
2),qd||Lc.Oj.Pkb(me,2)):this.NFi(ob,Fb,me,Jb,Yb,tc,Ec,null)}}Ggl(ob,Fb){if(Object(qa.a)(lb.a,Fb)){ob=Xb.OutlineElementGeneralizer.qla(ob.ib,!0);for(let gb=0;gb<ob.length;gb++)if(ob.getContext(gb).contextId===ha.a.table)return ob}return Fb}epl(ob,Fb,gb,Jb,Yb){ob===sa.a.Dsa?(ob=Tb.a.qAa(Fb),Yb=Ka.SelectionReferenceFactory.instance.Wxb()):(Yb=null,ob=1===gb.ib.length?W.a.Rxb(Jb):gb.Jg);return{returnValue:ob,EEn:Yb}}xsk(ob){return!ob.Xk||ob.contextId!==ha.a.paragraph||!this.Tn.nc(ob.node)||this.Rd.og||
this.ag.bQd(ob)?!1:!0}Ldj(ob){if(ob.zw)for(let Fb=0;Fb<ob.length;Fb++)this.Ldj(ob.getContext(Fb));else this.xsk(ob)&&(ob.node.Mtd=!0)}fTi(ob){if(ob.zw)for(let Fb=0;Fb<ob.length;Fb++)this.fTi(ob.getContext(Fb));else ob.Xk&&(ob=ob.node)&&this.Tn.nc(ob)&&(ob.Mtd=!1)}Oil(ob,Fb,gb){if(ob.Xk&&M.SelectionEditor.zf(ob)&&!gb){const Jb=ob.node;let Yb=ob.cpBegin,tc=-1;if(({cp:Yb}=this.ag.Ati(Jb,Yb)).returnValue)return F.SelectionFactory.xe(Jb,Yb);if(({cp:Yb,fka:tc}=this.ag.zti(ob,Yb,tc)).returnValue)return Fb=
F.SelectionFactory.xe(Jb,Yb),Fb.Qa.Fb=tc,Fb.Qa.Tb=tc,Fb}Fb=M.SelectionEditor.$Xa(Fb,!gb,{hC:!0,Xs:!1,jE:!1,jG:!0});this.ag.xh&&M.SelectionEditor.Dk(ob)&&(Fb.Qa.Tb=Fb.Qa.Fb=gb?ob.Tb:ob.Fb);return Fb}VTk(ob,Fb,gb,Jb,Yb,tc,Ec,Vc,Hd,qd,me,Zc){const Dc=Lc.fj;!M.SelectionEditor.Uz(Jb.node,Jb,Yb)||this.ag.xh&&this.ag.Dei(Jb)?Dc.Qd(()=>{this.zUk(Jb,Yb,tc,Ec,Vc,Hd,qd,me)},"DVS:IPM"):Dc.Qd(()=>{let ud,Ce;({response:ud,KX:Ce}=this.yUk(ob,Fb,gb,Jb,Yb,Ec,Vc,Hd,me,Zc));Lc.zvi(Vc,32===ud);Ce&&Lc.$na(Hd,tc)},"DVS:ISE")}pVl(ob,
Fb){Wa.a.aX&&(Fb.Ed||(Fb.Ed=new m.DictionaryPropertySet),Fb.Ed.setValue(Ia.a.Xma,"delete"),Fb.Ed.setValue(Ia.a.Hfa,"backspace"));var gb=ob.kW;let Jb=Lc.hd.XN(gb);const Yb=Ea.a.Wrm;if(null===Yb||void 0===Yb?0:Yb.glm(gb,Jb)){Wa.a.aX&&Fb.Ed.setValue(Ia.a.Hfa,"backspace-autocorrect");gb=Yb.rej+" ";let tc=P.a.Uc(ob,0);this.characterPropertiesEditor.replaceTextRange(tc,gb);ob=F.SelectionFactory.xe(ob,gb.length);W.a.instance.setSelection(ob);Sa.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",
Yb.rej)}return l.AFrameworkApplication.ya.Vf(Fb.cto,Jb.ur?sa.a.wH:sa.a.dA,2,!1,Fb.C7,Fb.Ed)}OUl(ob,Fb,gb,Jb,Yb){let tc=!1;0<this.EEi.r2(ob).mt&&(Yb=l.AFrameworkApplication.ya.Vf(Fb,sa.a.tcc,2,!1,gb,Jb),tc=!0);return{vT:tc,response:Yb}}VUl(ob,Fb,gb,Jb,Yb){let tc=!1;0<this.EEi.zF(ob).mt&&(Yb=l.AFrameworkApplication.ya.Vf(Fb,sa.a.OXc,2,!1,gb,Jb),tc=!0);return{vT:tc,response:Yb}}VVl(ob,Fb,gb,Jb,Yb){let tc=!1;Lc.xp.Kwb(ob)&&(Yb=l.AFrameworkApplication.ya.Vf(Fb,sa.a.XF,2,!1,gb,Jb),tc=!0);return{vT:tc,response:Yb}}ATl(ob,
Fb,gb,Jb,Yb,tc,Ec,Vc,Hd,qd){const me=new Pa.a;me.ed(Fb);let Zc=!1;if(K.OutlineElementNavigator.hDa(me,!1,!ob,!1)){qd=!0;Hd=32;Zc=!0;(new n.GraphIterator).ed(me);K.OutlineElementNavigator.Fe(me);const ud=me.currentNode;vc.a.$Jf&&J.ParagraphReader.tka(ud)&&J.ParagraphReader.ULa(ud).U7d("delete_ip");var Dc=new n.GraphIterator;Dc.set(Ec);(Dc=this.Tn.isEmpty(Dc))&&Yb&&M.SelectionEditor.J6(Yb.Qa)?(gb.j4a(tc),K.OutlineElementNavigator.Fe(Fb),Lc.Ug.kPa(Fb.currentNode)):ud.HI?(gb.j4a(tc),K.OutlineElementNavigator.Xd(me),
me.Hg()):ob&&Dc?this.ag.Xgi(Ec)&&!({KX:qd}=this.sIi(ob,Ec,ud,Yb,qd)).returnValue&&(gb.j4a(tc),Lc.No.gEa(Fb),this.Rzh.U9m(Ec),Fb.Hg()):Bb.TableReader.isTable(me)?(gb.j4a(tc),ob&&(ca.moveToFirstRow(me),ca.moveToFirstColumn(me),N.OutlineNavigator.f7(me),K.OutlineElementNavigator.Fe(me),Vc.setSelection((new ub.a(F.SelectionFactory.xe(me.currentNode,0))).restore())),Hd=2,qd=!1):this.Tn.nc(ud)&&(1==this.Tn.textLength(ud)&&(Vc=Va.e(ud),1==Vc.length&&8==Vc[0].li&&(Vc=P.a.createTextRange(ud,0,1),this.characterPropertiesEditor.replaceTextRange(Vc,
"",void 0,void 0,sa.a.Czc))),({KX:qd}=this.sIi(ob,Ec,ud,Yb,qd)).returnValue||(Lc.gHm&&Jb.actionId==sa.a.backspace&&gb.a7f(Ec),this.Rzh.WTk(ob,gb,tc,Fb,Ec,me)))}return{vT:Zc,response:Hd,KX:qd}}sIi(ob,Fb,gb,Jb,Yb){if(this.Rd.og){if(Lc.osa){const tc=Object(qa.a)(tb.AParagraphNode,gb)?Lc.osa.UDb(gb):!1,Ec=Object(qa.a)(tb.AParagraphNode,Fb)?Lc.osa.UDb(Fb):!1;if(tc!==Ec)return{returnValue:!1,KX:Yb};if(!za.a.tA&&Ec)return this.ag.xh&&Lc.sgk(Fb,gb,ob)&&this.Rd.ys(4),{returnValue:!1,KX:Yb}}ob=ob?Fb:gb;if(!Object(qa.a)(tb.AParagraphNode,
ob))return{returnValue:!1,KX:Yb};Fb=ob.qa.last;gb=l.AFrameworkApplication.userName;if(!Fb.Zi||Fb.Zi.authorName!==gb)return Lc.Oj.zKb(ob,2),Jb&&(W.a.instance.setSelection(Jb),Yb=!1),{returnValue:!0,KX:Yb}}return{returnValue:!1,KX:Yb}}iVl(ob,Fb,gb,Jb,Yb,tc,Ec,Vc){Fa.OutlineElementReader.dfm(Fb,ob)||({response:Ec,KX:Vc}=Lc.c_k(gb,Jb,ob,tc,Yb,Ec,Vc));return{vT:!1,response:Ec,KX:Vc}}yUk(ob,Fb,gb,Jb,Yb,tc,Ec,Vc,Hd,qd){let me=!1,Zc=2;const Dc=Jb.node;let ud=void 0,Ce=!1;const ee=Lc.fj;if(!Yb){if(Dc.kW)return ee.Qd(()=>
{Zc=this.pVl(Dc,Hd)},"DVS:HLOE"),{response:Zc,KX:me};ee.Qd(()=>{({response:Zc,vT:Ce}=this.OUl(Dc,ob,Fb,gb,Zc))},"DVS:HIOD");if(Ce)return{response:Zc,KX:me};ee.Qd(()=>{({response:Zc,vT:Ce}=this.VUl(Dc,ob,Fb,gb,Zc))},"DVS:HWPF");if(Ce)return{response:Zc,KX:me};ud=this.uUh(Dc);ee.Qd(()=>{({response:Zc,vT:Ce}=this.VVl(ud,ob,Fb,gb,Zc))},"DVS:HPOB");if(Ce)return{response:Zc,KX:me}}null!==ud&&void 0!==ud?ud:ud=this.uUh(Dc);ee.Qd(()=>{({response:Zc,vT:Ce,KX:me}=this.ATl(Yb,ud,Ec,Hd,qd,Jb,Dc,Vc,Zc,me))},"DVS:HAOE");
if(Ce)return{response:Zc,KX:me};ee.Qd(()=>{({response:Zc,vT:Ce,KX:me}=this.iVl(Yb,ud,Fb,gb,Ec,tc,Zc,me))},"DVS:HFLOE");return{response:Zc,KX:me}}hVn(ob){return M.SelectionEditor.Dk(ob)||this.lG.aki(ob)||M.SelectionEditor.eaa(ob)}ZUn(ob,Fb){return ob&&ob.hasProperty(A.a.zEc)?!ob.ia(A.a.zEc,!1):!Fb}static get hd(){return null!=Lc.Uog?Lc.Uog:Lc.Uog=a.a.instance.resolve("Box4.List.IListReader")}static get No(){return null!=Lc.Log?Lc.Log:Lc.Log=a.a.instance.resolve("Box4.List.IListEditor")}static get Ug(){return null!=
Lc.Jpg?Lc.Jpg:Lc.Jpg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get xp(){return ua.a.fBb}static get Oj(){return null!=Lc.$sg?Lc.$sg:Lc.$sg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=Lc.Ftg?Lc.Ftg:Lc.Ftg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Kc(){return Zb.a.instance}static get nsa(){Lc.Tpb||(Lc.Tpb=a.a.instance.$a("Box4.ContentControl.IContentControlOperator"));return Lc.Tpb.instance}static get osa(){return null!=
Lc.Cig?Lc.Cig:Lc.Cig=a.a.instance.Pa("Box4.IContentControlReader")}static get fj(){return Hb.a.instance}Acl(ob){if(1===ob.ib.length&&(ob=ob.ib.J(0),M.SelectionEditor.Dm(ob))){var Fb=ob.Qa;ob=Fb.node;Fb=Fb.cpBegin;var gb=this.Tn.text(ob);Fb<gb.length&&0<Fb&&" "===gb.charAt(Fb-1)&&" "===gb.charAt(Fb)&&this.characterPropertiesEditor.replaceTextRange(P.a.createTextRange(ob,Fb-1,Fb),"\u00a0")}}Iik(ob,Fb){if(!Fb.hyperlink.ogb){const gb=new u.GraphTransaction(15);try{gb.Eb(ob.node),this.GI.VQ(ob,Fb)}finally{gb&&
gb.dispose()}Fb.hyperlink.MF&&this.Rd.ys(2)}}static c_k(ob,Fb,gb,Jb,Yb,tc,Ec){if(gb=M.SelectionEditor.$Xa(Jb,!gb,{hC:!1,Xs:!1,jE:!1,jG:!0})){Jb=F.SelectionFactory.KB(Jb,gb.Qa);tc=32;for(gb=0;gb<Jb.length;++gb){Yb.j4a(Jb.J(gb));const Vc=l.AFrameworkApplication.ya.Vf(Jb.J(gb),sa.a.XG,2,!0,ob,Fb);2!==Vc&&(tc=Vc)}32===tc&&(Ec=!0)}return{response:tc,KX:Ec}}kZk(ob,Fb,gb,Jb,Yb,tc,Ec){let Vc=!1;this.iVn(ob)?(Vc=Lc.e5e(ob,!0,Fb,gb,Jb,Yb))&&Lc.GFa(tc,Fb,Ec):this.hVn(ob)?(Vc=Lc.e5e(ob,!1,Fb,gb,Jb,Yb))&&Lc.GFa(tc,
Fb,Ec):(Jb.normalize(),Lc.GFa(tc,Fb,Ec));return Vc}static GFa(ob,Fb,gb){gb&&gb.$na()||Lc.$na(Fb,ob)}static e5e(ob,Fb,gb,Jb,Yb,tc){Jb||G.OutlineReader.cNa(ob)||(gb=Lc.l3c(gb))&&Yb.ARn(gb);ob=32===l.AFrameworkApplication.ya.Vf(ob,tc.actionId,2,Fb,tc.C7,tc.Ed);Lc.zvi(Yb,ob);return ob}static zvi(ob,Fb){Fb?ob.normalize():ob.cancel()}static $na(ob,Fb){Fb&&Lc.fj.Qd(()=>{const gb=Fb.restore();gb&&ob.setSelection(gb)},"DVS:RS")}zUk(ob,Fb,gb,Jb,Yb,tc,Ec,Vc){let Hd;!Fb&&({hyperlink:Hd}=this.GI.a7b(ob)).returnValue?
(gb=new ub.a(Jb),this.Iik(ob,Hd),Yb.normalize(),Lc.$na(tc,gb)):Lc.e5e(ob,!1,tc,Ec,Yb,Vc)&&(Fb&&this.Rd.og?(Fb=Lc.Oj.rxd)?(tc.setSelection(F.SelectionFactory.xe(ob.node,Fb)),Lc.Oj.rxd=null):Lc.$na(tc,gb):Lc.$na(tc,gb))}static sgk(ob,Fb,gb){gb?(gb=ob,ob=Fb):gb=Fb;Fb=Lc.osa.z7b(gb,!1);ob=Lc.osa.z7b(ob,!0);return!(Fb&&ob)}iVn(ob){return ob.zw||G.OutlineReader.cNa(ob)||this.Tn.em(ob)}static l3c(ob){return(ob=Xb.OutlineElementGeneralizer.qla(ob.ib,!0))&&1===ob.length&&(ob=ob.getContext(0).node,Bb.TableReader.eX(ob))?
ob:null}uUh(ob){const Fb=new n.GraphIterator;Fb.set(ob);Fb.rd();K.OutlineElementNavigator.Xd(Fb);return Fb}}Lc.Tpb=null;Lc.Pfd=null;Object(C.a)(Lc,"ADeleteViewStrategy",null,[]);class Gb{WTk(ob,Fb,gb,Jb,Yb,tc){const Ec=tc.currentNode;K.OutlineElementNavigator.Xd(tc);ob?(Fb.a7f(tc.currentNode),Gb.ag.Pfi(gb,Yb,Ec,!1)||Gb.Ug.merge(Jb,tc,!1,!1)):Gb.ag.Pfi(gb,Ec,Yb,!0)||Gb.Ug.merge(tc,Jb,!1,!1)}U9m(ob){ob&&J.ParagraphReader.nc(ob)&&(Oa.a.HXc(ob),Gb.r1k.lQe(ob))}static get Ug(){return null!=Gb.Epg?Gb.Epg:
Gb.Epg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get r1k(){return null!=Gb.kjg?Gb.kjg:Gb.kjg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get ag(){return ia.a.instance}}Object(C.a)(Gb,"DeleteParagraphNodeStrategy",null,[345]);class pc extends Lc{constructor(ob,Fb,gb,Jb,Yb,tc,Ec,Vc){super(new Gb,ob,Fb,gb,Jb,Yb,tc,Ec,Vc)}}Object(C.a)(pc,"DeleteViewStrategy",Lc,[]);c.d(O,"DeleteActor",function(){return Fc});class Fc extends oa{constructor(ob,Fb,gb,Jb,Yb,tc,Ec,Vc,Hd,qd,me){super();
this.deleteParagraph=(Zc,Dc)=>{Zc=Dc.node;Oa.a.HXc(Zc);this.xoe.lQe(Zc);this.nl&&this.nl.instance&&Ga.App.yee&&this.nl.instance.mIf(Zc);Zc.yw&&(this.qm.Cqn(Zc,!this.xh),this.xh&&this.SGg.instance&&this.SGg.instance.Qhj(Zc));return 0};this.fzd=(Zc,Dc,ud)=>{2==ud&&(Zc=l.AFrameworkApplication.breadcrumbFolderUrl,Zc&&0!=Zc.length||(Zc=l.AFrameworkApplication.breadcrumbBrandUrl),ka.App.Uzb(Zc));return 32};this.LCj=new qb;this.jCg=new Za;this.MCj=new pc(ia.a.instance,La.a.instance,tc,Ec,Vc,Hd,qd,me);this.qm=
ob;this.ioc=Fb;this.SGg=gb;this.xoe=Jb;this.nl=Yb}get xh(){return this.ioc.instance?this.ioc.instance.xh:!1}get $zh(){return this.MCj}get Pzh(){return this.LCj}FRf(ob,Fb,gb,Jb){const Yb=rb.hVk,tc=Object(v.a)(this.jCg,this.jCg.UTk,"deleteAnchoredObject");ob.pa(sa.a.backspace,ha.a.anchoredObject,tc);ob.pa(sa.a.backspace,ha.a.unsupportedObject,Yb);ob.pa(sa.a.XG,ha.a.anchoredObject,tc);ob.pa(sa.a.XG,ha.a.unsupportedObject,Yb);ob.pa(sa.a.backspace,ha.a.paragraph,this.deleteParagraph);ob.pa(sa.a.XG,ha.a.paragraph,
this.deleteParagraph);ob.pa(sa.a.Dsa,ha.a.paragraph,this.deleteParagraph);ob.pa(sa.a.fzd,ha.a.view,this.fzd);ob.Vc(sa.a.Dsa,64);super.FRf(ob,Fb,gb,Jb)}static QWb(ob){va.a.instance.J(4)&&ka.App.vd.Pp&&ka.App.vd.Mq.KG(ob)}}Object(C.a)(Fc,"DeleteActor",oa,[])},1534:function(C,O,c){C=c(0);class l{constructor(v,u,n,x){this.KBj=v;this.tUj=u;this.rUj=n;this.uUj=x}get a_e(){return this.KBj}get lVf(){return this.tUj}get iVf(){return this.rUj}get resultType(){return this.uUj}}Object(C.a)(l,"SearchContext",
null,[1150]);class e{f1e(v,u,n,x){var A=n-u;let H;if(100<=A)A=u,H=n;else{A=Math.max(0,u+Math.ceil(A/2)-50);H=Math.min(v.length,A+100);A=Math.max(0,H-100);let L;if(A&&" "!==v.charAt(A-1)){L=Math.min(u,A+10);for(var E=A;E<L;++E)if(" "===v.charAt(E)){A=E+1;break}}if(H!==v.length&&" "!==v.charAt(H))for(L=Math.max(n,H-10),E=H-1;E>=L;--E)if(" "===v.charAt(E)){H=E;break}}v=v.substring(A,H);return new l(v,u-A,n-A,x)}$xd(v){return this.f1e(v.UWh(),v.begin,v.end,"")}}Object(C.a)(e,"SearchContextFactory",null,
[1135]);var a=c(135),h=c(1522);c.d(O,"a",function(){return m});class m extends e{constructor(){super()}$xd(v){let u=v.begin,n=v.end;const x=({begin:u,end:n}=m.yEl(v,u,n)).returnValue;v=h.a(v.type);return this.f1e(x,u,n,v)}static get instance(){return null!=m.Tmg?m.Tmg:m.Tmg=new m}static yEl(v,u,n){v=v.UWh();return m.SOi(v,u,n)}static SOi(v,u,n){const x=a.AParagraphNode.nU(v);if(x.length<v.length){v=v.substring(0,u);const A=a.AParagraphNode.nU(v);v=v.length-A.length;u-=v;n-=v}return{returnValue:x,
begin:u,end:n}}}Object(C.a)(m,"EditorSearchContextFactory",e,[])},1536:function(C,O,c){C=c(0);var l=c(2),e=c(23),a=c(310),h=c(712),m=c(24),v=c(9),u=c(134),n=c(53),x=c(657),A=c(211),H=c(260),E=c(93),L=c(33),M=c(11),F=c(3),J=c(5),I=c(594),K=c(1019);class N{create(){return new K.a}}Object(C.a)(N,"FootnoteEndnoteContainerNodeFactory",null,[417]);var G=c(549);c.d(O,"a",function(){return P});class P{constructor(S,W,X,Y,ca,ha,ra,sa,oa){this.Tod=null;P.ga=S;this.GE=X;this.jCe=Y;this.oBj=ha;this.Yc=ra;this.hb=
ca;this.xOj=sa;this.vCj=oa;P.Dh=W}JVd(S,W){this.v4k(S);S.Pb(7);this.GE.qei(S,W)||S.yf(7)}v4k(S){if(this.jCe.Sgi(S)){var W=!1,X=!1;if(S.Pb(7)){do{const Y=S.currentNode;if(37===Y.type)switch(Y.getValue(J.a.n6)){case 0:X=!0;break;case 1:W=!0}}while(S.xi(7))}X||this.W8g(S,0);W||this.W8g(S,1)}}W8g(S,W){const X=this.oBj.create(1074135124);X.setValue(J.a.n6,W);S.Rf(X,7)}oGn(S){S&&this.AXi(S.nla)}AXi(S){S&&(S=m.SelectionFactory.xe(S.Ob.paragraph,S.Ob.cp+1),this.hb.setSelection(S))}VMm(S){let W=this.xOj(S);
void 0!==W&&null!==W?this.GE.uma(W)&&(W=this.GE.tXh(W)):W=S;return this.vCj(W)}B0n(){this.Tod?P.Dh.notificationBar.removeEntry(this.Tod):this.Tod=P.Dh.notificationBar.usa(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);P.Dh.notificationBar.qA(this.Tod)}uek(S,W){S=this.Yc.pBa(S,37,37);let X=!1;if(S.Ud()){do{const Y=S.currentNode;this.GE.nuf(Y)?this.Zdh(Y,W):X=!0}while(S.xj())}X&&this.B0n()}Zdh(S,W){I.e(S,X=>{P.wfl(X,W);return!0},12)}PXl(S,W){S=this.GE.XFd(S,
W);return S?(S=this.Yc.Zf(S))?S.EA():!1:!1}bSh(S,W){S=this.GE.XFd(S,W);S=this.Yc.Zf(S);if(S.Ud()){do if(W=S.currentNode,1===W.getValue(J.a.ola))return W;while(S.xj())}return null}static rIc(){return new P(l.AFrameworkApplication.ya,v.App.xa,G.a.instance,u.PageReader.instance,n.a.instance,new N,new x.a,A.OutlineNavigator.TMm,H.WordSectionNavigator.a3e)}static get instance(){return null!=P.dng?P.dng:P.dng=P.rIc()}static get paragraphEditor(){return null!=P.rqg?P.rqg:P.rqg=e.a.instance.resolve("Box4.IParagraphEditor")}static wfl(S,
W){W.Seb?P.paragraphEditor.xp.uba(S,E.OutlineReader.EL(S)):P.paragraphEditor.xp.uba(S,0);S=L.a.createTextRange(S,0,M.ParagraphReader.textLength(S));P.ga.Vf(S,F.a.font,2,!0,new a.a,new h.a(W.fontName));P.ga.Vf(S,F.a.Wv,2,!0,new a.a,new h.a(W.fontSize))}}P.ga=null;P.Dh=null;Object(C.a)(P,"FootnoteEndnoteEditor",null,[480])},1541:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(l||(l={}));Object(C.b)("SupportStatus",l)},1552:function(C,O,c){c.d(O,"a",function(){return M});C=c(0);var l=c(373),e=c(59),a=c(23),h=c(106),m=c(8),v=c(123),u=c(64),n=c(14),x=c(109),A=c(548),H=c(135),E=c(141),L=c(11);class M{constructor(F,J,I,K,N,G=null,P="",S=!0,W=!1){this.ZXa=this.k$d=this.dkb=this.fJi=this.y4d=null;this.hOc=!1;this.tnf=null;this.cFf=0;this.context=F;this.ve=F.view;this.Dz=
J;this.Ed=N;this.KQ=I;this.C7=K;this.Xva=this.failed=!1;this.IZd=null;this.u_a=this.t7b=!1;this.o1n=M.WZe(F);this.browserName=P;this.flj=S;this.Duf=W;this.YQa=!1;this.k_b=0;if(F=Object(v.a)(89,N)?N:null){this.fJi=new l.DictionaryPropertySet;this.fJi.Bs(F);I=F.ia(h.a.XUc,e.a.nil);this.pBc=I!=e.a.nil?I.toString():e.a.create().toString();if(F.ia(h.a.vFi,!1)){this.t7b=!0;this.u_a=F.ia(h.a.u_a,!1);this.IZd=G;for(G=this.ve.Cb.Jg;G.zw;)G=G.getContext(0);if(N=Object(u.a)(H.AParagraphNode,G.node)){I=0;K=L.ParagraphReader.textLength(N);
switch(G.contextId){case n.a.Hd:I=G.cpBegin;K=G.cpEnd;break;case n.a.endOfParagraph:I=K}this.y4d=x.FormattingReader.TFd(G.node,I,G.Fb);m.ULS.shipAssertTag(6305503,307,!!this.y4d);N=E.HyperlinkReader.CIc(N);for(const X of N)X.cpEnd<=I||X.cpBegin>=K||M.hyperlinkEditor.VQ(G.node,X.hyperlink)}}this.Xva=F.ia(h.a.Xva,!1);this.YQa=F.ia(h.a.YQa,!1);this.dkb=F.ia(h.a.dkb,null)}else this.pBc=e.a.create().toString();J&64&&(this.Xva=!0)}static get hyperlinkEditor(){return null!=M.Hlg?M.Hlg:M.Hlg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static WZe(F){if(F){if(F.zw){for(let J=
0;J<F.length;J++)if(M.WZe(F.getContext(J)))return!0;return!1}if(Object(v.a)(A.a,F))return M.WZe(F.rk);if(L.ParagraphReader.nc(F.node)&&F.node.vN)return!0}return!1}}Object(C.a)(M,"ClipboardActionArguments",null,[])},1553:function(C,O,c){c.d(O,"a",function(){return I});C=c(0);var l=c(23),e=c(59),a=c(48),h=c(650),m=c(134),v=c(657),u=c(183),n=c(20),x=c(9),A=c(117),H=c(5),E=c(860),L=c(763),M=c(549),F=c(1493),J=c(1536);class I{constructor(K,N,G,P,S,W){this.GE=K;this.nHa=G;this.jCe=P;this.Ume=S;this.Yc=
W}O7l(K,N,G){const P=this.tUh(N,K.node),S=K.node.Mc;if(!S)return null;const W=new a.GraphTransaction(15);W.Eb(K.node);W.Al=G;G=this.P7l(P,N);I.Q7l(G,S,K,N);W.dispose();return G}tUh(K,N){const G=this.Yc.Ck();G.set(N);G.Ab(7);G.kd(7);this.nHa.JVd(G,K);return G}P7l(K,N){const G=L.a.createNode();G.properties.setValue(H.a.n6,N);K.Rf(G,8);this.Ume.zKk(G,N);return G}static get characterPropertiesEditor(){return null!=I.Ohg?I.Ohg:I.Ohg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get aca(){return I.KC||
(I.KC=new h.WACStyleSet)}static set aca(K){I.KC=K}static rIc(){const {FootnoteEndnoteDefaultContentInserter:K}=c(1614);return new I(M.a.instance,F.a.instance,J.a.instance,m.PageReader.instance,K.instance,new v.a)}static get instance(){return null!=I.Hng?I.Hng:I.Hng=I.rIc()}static get qh(){return I.nB||(I.nB=u.PageNavigator.instance)}static set qh(K){I.nB=K}static Q7l(K,N,G,P){n.a.instance.J(4)&&x.App.vd.Pp&&x.App.vd.Mq.KG(G.node);const S=new A.a;S.setValue(H.a.Z1b,K.id);S.setValue(H.a.n6,P);const W=
N.Lu(S,e.a.create());I.characterPropertiesEditor.ifa(G,X=>E.a.getInstance(X,W,K.id),I.ROh(G.node,P))}static ROh(K,N){let G=null;(K=I.qh.pu(K))&&(K=I.aca.ZN(K))&&(G=K.Bta(N?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return G}}I.KC=null;I.nB=null;Object(C.a)(I,"FootnoteEndnoteInserter",null,[616])},1558:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{static wwn(e,a){l.KBe=e;l.VEe=a}static twn(e,a){l.TEe=e;l.bVa=a}static lZh(){return l.TEe===
l.bVa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.bVa,l.KBe,l.VEe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.TEe,l.bVa,l.KBe,l.VEe)}}l.TEe=0;l.bVa=0;l.KBe=null;l.VEe=null;Object(C.a)(l,"ReplaceAllContext",null,[])},1576:function(C,O,c){c.r(O);C=c(0);var l=c(1891),e=c(59),a=c(2),h=c(332),m=c(23),v=c(1818),u=c(9),n=c(8),x=c(243),A=c(1893),H=c(13),E=c(18),L=c(1534);class M{constructor(bc="",Ka="",Bb=!1,tb=!1){this.Aim=Bb;this.Ylm=tb;this.actionId=
bc;this.MEa=Ka}}Object(C.a)(M,"SearchEntryPointContext",null,[]);class F{constructor(bc){this.fda=null;this.xu=!1;this.HM=bc}initialize(){this.fZ();this.ez();this.O5(0)}ez(){this.fda.ez()}dispose(){this.HM=null}FJc(){return!1}get mF(){return this.fda?this.fda.mF:0}O5(bc){this.fda.O5(bc)}get isVisible(){return this.xu}fPe(bc){this.fda&&this.fda.WDo(bc)}PPi(bc){this.fda&&this.fda.mMo(bc)}ckj(bc){this.fda&&this.fda.APo(bc)}aoh(){this.fda&&this.fda.cFo()}X5d(bc){this.fda&&this.fda.X5d(bc)}}Object(C.a)(F,
"FindReplacePane",null,[301,10]);var J=c(57),I=c(1365),K=c(1030),N=c(155),G=c(164),P=c(1020),S=c(80),W=c(82),X=c(83),Y=c(56),ca=c(28),ha=c(439),ra=c(1465),sa=c(409),oa=c(1475),ka=c(697),ia=c(86),La=c(1058);class va{constructor(bc){this.r4j=(Ka,Bb)=>{this.Uod.ub(Ka)?this.Uod.Z(Ka,Bb):this.Uod.add(Ka,Bb);(Ka=this.Rjl(Ka))&&this.Qai(Bb,Ka,this.Msh(sa.a.getTypeName()))};this.Uod=new ia.a;this.PU=new ia.a;this.annotationType=ra.RoleDetectionAnnotation.getTypeName();bc.zmn(this.r4j)}GF(bc,Ka){let Bb;const tb=
bc.parentPath.substr(bc.parentPath.lastIndexOf("\\")+1),Kb=bc.content;if(!Kb||this.Elm(Kb))""!==tb&&({value:Bb}=this.Uod.Bc(tb,Bb)).returnValue&&this.Qai(Bb,bc,this.Msh(Ka)),Ka===sa.a.getTypeName()?(Ka=null,({value:Ka}=this.PU.Bc(tb,Ka)).returnValue?this.PU.Z(tb,bc):this.PU.add(tb,bc)):Ka===oa.a.getTypeName()&&this.PU.remove(tb)}Qai(bc,Ka,Bb){const tb=this.bzl(Ka);Ka=this.Sjl(Ka);0<Ka&&bc(Bb,tb,Ka)}Sjl(bc){try{return Number.parseInvariant(bc.id.substr(2))}catch(Ka){n.ULS.sendTraceTag(554747009,367,
10,Ka.toString())}return-1}Rjl(bc){let Ka;return({value:Ka}=this.PU.Bc(bc,Ka)).returnValue?Ka:null}qVc(bc){if(bc)for(const Ka of bc)this.GF(Ka,"AugLoop_Core_AddOperation")}bzl(bc){if(bc=bc.content)switch(bc.roleType){case ra.RoleType.Heading1:return 1;case ra.RoleType.Heading2:return 2;case ra.RoleType.Heading3:return 3;case ra.RoleType.Heading4:return 4;case ra.RoleType.Heading5:return 5;case ra.RoleType.Heading6:return 6;case ra.RoleType.Heading7:return 7;case ra.RoleType.Heading8:return 8;case ra.RoleType.Heading9:return 9}return-1}Elm(bc){bc=
bc.roleType;return bc===ra.RoleType.Heading1||bc===ra.RoleType.Heading2||bc===ra.RoleType.Heading3||bc===ra.RoleType.Heading4||bc===ra.RoleType.Heading5||bc===ra.RoleType.Heading6||bc===ra.RoleType.Heading7||bc===ra.RoleType.Heading8||bc===ra.RoleType.Heading9}Msh(bc){if(bc===sa.a.getTypeName()||bc===ka.a.getTypeName())return La.a.OOe;if(bc===oa.a.getTypeName())return La.a.hzd;throw Error.create("Invalid operation type");}}Object(C.a)(va,"RoleDetectionAnnotationHandler",null,[54]);var Ga=c(165),Oa=
c(75),Za=c(1127),ja=c(53),ba=c(77),qa=c(44),Ma=c(192),Ia=c(183),wa=c(556);class za extends Ma.a{constructor(bc,Ka){super(bc,Ka,u.App.Tba);this.NRd=null;this.Yeb=this.yYb=0;this.headingsReady=!1;this.SOa=this.vab=0;this.qpi=!1;this.PSg=this.JIg=this.REg=null}get rRd(){return!0}get iHh(){return this.REg}get WVd(){return this.PSg}lmj(){this.headingsReady&&(this.JIg.style.display="none",this.Yeb||this.yYb?(this.iHh.style.display="none",this.container.style.display="block"):(this.container.style.display=
"none",this.iHh.style.display="block"))}get MZ(){return super.MZ|240}static d1e(bc,Ka,Bb){var tb=u.App.xa.jb.Xc;if(tb&&(tb=Ia.PageNavigator.instance.tT(tb))){const Kb=new za(new wa.a,m.a.instance.resolve("Box4.IHtmlViewRootFactory"));Kb.Yeb=0;Kb.yYb=0;Kb.NRd=null;Kb.Aab(bc);Kb.REg=Ka;Kb.JIg=Bb;Kb.vB(tb);Kb.headingsReady=!0;Kb.lmj();Kb.PSg=null;return Kb}return null}}Object(C.a)(za,"WordNavigationPaneHeadingsView",Ma.a,[312,184,143,10]);class pa{constructor(bc){this.PU=new ia.a;this.dUg=bc}GF(bc,Ka){Ka===
sa.a.getTypeName()?(Ka=null,({value:Ka}=this.PU.Bc(bc.id,Ka)).returnValue?this.PU.Z(bc.id,bc):this.PU.add(bc.id,bc)):Ka===oa.a.getTypeName()&&this.PU.remove(bc.id);this.dUg&&this.dUg()}qVc(bc){if(bc)for(const Ka of bc)this.GF(Ka,sa.a.getTypeName())}p2b(){var bc;let Ka=[];if(0<(null===(bc=this.PU)||void 0===bc?void 0:bc.count))for(const Bb of this.PU.values)Ka.push(Bb);return Ka}}Object(C.a)(pa,"ContractEntityAnnotationHandler",null,[54]);var Ba=c(3);class Ra{constructor(bc){this.ga=bc}wSm(){this.cancelSearch()}AUm(bc){this.ga.Xb(E.a.jJd,
2,bc)}kIf(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Ba.a.Mwb,2)}sZm(){this.ga.processAction(Ba.a.findOnPage,2)}onSearchQueryChanged(bc){this.ga.Xb(Ba.a.OCd,2,bc)}Y_m(){this.ga.processAction(E.a.replace,2)}Z_m(){this.ga.processAction(E.a.replaceAll,2)}U_m(){this.ga.processAction(H.a.L9e,2)}V_m(){this.ga.processAction(H.a.$9e,2)}X_m(){this.ga.processAction(Ba.a.Q0d,2)}W_m(){this.ga.processAction(Ba.a.jWd,2)}Tbc(bc){this.ga.Xb(E.a.Tbc,2,bc)}}Object(C.a)(Ra,"FindReplaceActions",null,
[311]);var fb=c(335);class Va{}Va.AO=fb.a.bdb;Va.Jac=0;Va.Bsa="FindReplaceTaskPaneData";Va.ZQ=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(C.a)(Va,"FindReplaceConstants",null,[]);var ib=c(760);class Xa{gfj(bc){var Ka,Bb,tb;return ha.a.geb(null===(tb=null===(Bb=null===(Ka=u.App.xa)||void 0===Ka?void 0:Ka.jb)||void 0===Bb?void 0:Bb.Xc)||void 0===tb?void 0:tb.Ad,bc)}clearSelection(){if(this.Cxe){const bc=this.gfj(this.Cxe);bc&&bc.jka()}this.Cxe=this.h0g=null}eGn(bc){this.clearSelection();
if(bc){const Ka=this.gfj(bc.parentPath);if(Ka){const Bb=bc.content;Bb&&(this.h0g=bc.id,Ka.SPa([new ib.a(Bb.range.start,Bb.range.start+Bb.range.length)]),Ka.vzf(0,1));this.Cxe=bc.parentPath}}}}Object(C.a)(Xa,"RangeAnnotationContentSelector",null,[]);var qb=c(1558);class rb{constructor(bc){this.HMj=bc}get Fj(){return this.HMj.value}qCl(bc){bc=this.Fj.TYa(bc);return this.jfm(bc)?null:bc}jfm(bc){return bc.id===this.Fj.dBa.id}static get instance(){return null!=rb.vmg?rb.vmg:rb.vmg=rb.fE()}static fE(){const bc=
new x.a(()=>v.FindManager.instance.Fj);return new rb(bc)}}Object(C.a)(rb,"SearchResultOrder",null,[]);var nb=c(11),Tb=c(291);class Zb{constructor(bc){this.Wxe=bc}get NPa(){return this.Wxe.value}getSelectedText(){var bc=this.NPa.eta;if(bc){const Ka=bc.cpBegin,Bb=bc.cpEnd-Ka;if(0<Bb&&(bc=bc.node,nb.ParagraphReader.nc(bc)))return bc.characterData.substr(Ka,Bb)}return null}static getInstance(){return Zb.Hl()}static Hl(){const bc=new x.a(()=>Tb.a.instance);return new Zb(bc)}}Object(C.a)(Zb,"SelectionHelper",
null,[]);var Hb=c(34),Sa=c(160),ua=c(436),Fa=c(843),Pa=c(230),Ea=c(437),lb=c(1766),zb=c(390);class Xb extends Ma.a{constructor(bc,Ka,Bb){super(bc,Ka,u.App.Tba);this.i2a=Bb;this.o5h=!1}get rRd(){return!0}get MZ(){return super.MZ|248}static d1e(bc){var Ka=u.App.xa.jb.Xc;const Bb=zb.a.instance.Rc(3);return Ka&&(Ka=Ia.PageNavigator.instance.tT(Ka))?(bc=new Xb(new wa.a,m.a.instance.resolve("Box4.IHtmlViewRootFactory"),bc),Bb.Bec(bc.Sb),bc.vB(Ka),Bb.dispose(),bc.o5h=!0,bc):null}}Object(C.a)(Xb,"WordNavigationPaneReactHeadingsView",
Ma.a,[184,143,10]);class ub extends F{constructor(bc,Ka,Bb,tb,Kb,Ib,Wa,vc,Lc,Gb,pc,Fc,ob){var Fb,gb,Jb;super(bc);this.Hpb=Va.AO;this.SYj="FindReplaceTaskPaneProps";this.Ub=J.FocusManager.instance();this.LRa=this.RIa=this.IY=this.hJe=null;this.uOb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.c7c=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.zgd=(null===(Fb=a.AFrameworkApplication.K)||void 0===Fb?void 0:Fb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",
!1))||(null===(gb=a.AFrameworkApplication.K)||void 0===gb?void 0:gb.$("NavPaneReactHeadings"));this.vOj=null===(Jb=a.AFrameworkApplication.K)||void 0===Jb?void 0:Jb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.Qij=()=>{this.isVisible&&this.ryd===A.a.intelligentPlaceholder&&this.om()};this.oA=new I.a;this.AHg=Ka;this.JGa=A.a.headings;this.Dxc=l.a.initial;this.Ypa=new ba.a;this.UO="";this.Mnc={matchCase:!1,matchWholeWord:!1};this.UEe="";this.IGe=null;this.pP=Bb;
this.T1g=!1;this.Etb=tb;this.hb=Kb;this.LOj=Ib;this.gza=Wa;this.zG=vc;this.vhd=!0;this.e5=this.d5=!1;this.Jf=Lc;this.BG=Gb;this.Hb=pc;this.m4=Fc;this.CAg=ob;this.zie&&this.gza.gqn(()=>{this.om()})}get QJe(){return 1}get zie(){return this.uOb&&this.c7c&&!!this.Jf}get Aie(){return this.uOb&&this.vOj&&!!this.Jf}get headingsReady(){return this.zgd?this.BG.headingsReady:this.Lbd?this.Lbd.headingsReady:!1}set headingsReady(bc){this.zgd?this.BG.headingsReady=bc:this.Lbd&&(this.Lbd.headingsReady=bc)}get ryd(){return this.JGa}d6i(){this.JGa=
A.a.headings;this.om()}eZn(){this.JGa=A.a.contracts;this.om()}X5i(){this.JGa=A.a.find;Y.a("NavigationPaneFind");this.om()}M6i(){this.JGa=A.a.replace;this.om()}q6i(){this.JGa=A.a.intelligentPlaceholder;this.om()}F0c(bc){this.T1g=bc;this.om()}FJc(){return this.ryd===A.a.replace}get mF(){return this.Dxc}O5(bc){this.Dxc=bc;this.om()}fPe(bc){this.q6j(bc);this.om()}q6j(bc){const Ka=this.LOj(bc[bc.length-1]);if(Ka){let Bb=-1;for(let tb=0;tb<this.Ypa.count;tb++)if(Ka.id===this.Ypa.J(tb).id){Bb=tb;break}-1===
Bb?n.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Ypa.IA(Bb,this.kth(bc))}else this.Ypa.addRange(this.kth(bc))}PPi(bc){for(let Ka of bc)for(bc=this.Ypa.count-1;0<=bc;bc--)if(this.Ypa.J(bc).id===Ka.id){this.Ypa.removeAt(bc);break}this.om()}ckj(bc){for(let Ka of bc)for(bc=this.Ypa.count-1;0<=bc;bc--)if(this.Ypa.J(bc).id===Ka.id){this.Ypa.Z(bc,this.jth(Ka));break}this.om()}aoh(){this.Ypa.clear();this.IGe=null;this.om()}X5d(bc){this.IGe=bc?bc.id:null;this.om()}kth(bc){if(!bc)return new ba.a;
const Ka=new ba.a;for(let Bb of bc)Ka.add(this.jth(Bb));return Ka}jth(bc){const Ka=this.Etb.$xd(bc);return{id:bc.id,searchBeginIndex:Ka.lVf,searchEndIndex:Ka.iVf,searchResult:Ka.a_e}}bde(){}Yoo(){var bc={};this.HM.Tbc(bc);bc=bc[K.a.Value];this.hJe=ca.c(bc)?"":bc;this.om()}OLa(){return this.UO}pBb(){return this.UEe}DYf(bc){this.UO=bc;this.om()}clearSearch(){}initialize(){this.mmd=window.performance.now();const bc=this.Ub.re(this.Hpb);bc.parent=N.AFrame.Qp;bc.XL=!0;this.fZ();this.O5(l.a.initial)}tO(){this.isVisible?
(n.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),G.UISurfaces.fu().then(bc=>{bc.setSelectedTaskPane(this.Hpb,this.QJe);this.I7();this.vhd&&this.w1i(!0);return null}).catch(bc=>{ub.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],bc)})):(this.K0c(),this.vhd&&this.w1i(!1))}w1i(bc){const Ka=this.AHg();Ka?this.UO=Ka:bc&&this.UO||(this.UO="");this.HM.onSearchQueryChanged(this.UO)}$la(){G.UISurfaces.fu().then(bc=>{bc.hideTaskPane(this.Hpb,
this.QJe);return null}).catch(bc=>{ub.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],bc)})}fZ(){this.pP.FKa();this.IY=this.pP.G_b(this.Ub);this.e4j()}K0c(){G.UISurfaces.fu().then(bc=>{this.mmd=window.performance.now();bc.showTaskPane(this.Hpb,this.AB());bc=[Object.assign(new Hb.a,{name:"Tab",string:this.JGa})];const Ka=window.performance.now()-this.mmd;Y.a("NavigationPaneOpen",!0,Ka,bc);return null}).catch(bc=>{ub.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],
bc)})}om(){G.UISurfaces.fu().then(bc=>{bc.updateTaskPane(this.Hpb,this.AB());return null}).catch(bc=>{ub.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],bc)})}AB(){const bc={activeTab:A.a.initial};this.oA.mKb(bc);return Object.assign(new P.a,{title:Va.ZQ,hideHeader:!1,width:320,location:this.QJe,contentProps:bc,onOpen:()=>{this.xu=!0;this.Epn();this.Mmn();this.vhd&&this.I7();u.App.xa.updateCommandUI();u.App.xa.GVa(this.Qij)},onClose:()=>{try{const Ka=window.performance.now();
this.vba();this.xu=!1;this.Dho();this.eio();this.HM.kIf();this.hJe="";this.Dxc=l.a.initial;u.App.xa.ycc(this.Qij);u.App.xa.updateCommandUI();const Bb=window.performance.now()-Ka;Y.a("NavigationPaneClose",!0,Bb)}catch(Ka){ub.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ka)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}Epn(){this.zie&&!this.RIa&&ha.a.Qm().then(()=>{this.RIa=new va(this.gza);this.Jf.mb(this.RIa,this.RIa.annotationType);this.Jf.getAnnotationsByType(this.RIa.annotationType).then(bc=>
{this.RIa.qVc(bc)})})}eio(){this.zie&&this.RIa&&(this.Jf.sc(this.RIa,this.RIa.annotationType),this.RIa=null)}zdo(){if(this.Aie){var bc=new lb.ContractEntitySignal;bc=Object.assign(new Fa.a,{parentPath:["Signal",Pa.a.getTypeNameFor(bc)],items:[Object.assign(new Ea.a,{body:bc})]});this.m4.getAugLoopRuntimeManager().submitOperation(Object.assign(new ua.a,{operation:bc}))}}Mmn(){this.Aie&&!this.LRa&&ha.a.Qm().then(()=>{this.LRa=new pa(this.om);this.Jf.mb(this.LRa,lb.ContractEntityAnnotation.getTypeName());
this.zdo();this.Jf.getAnnotationsByType(lb.ContractEntityAnnotation.getTypeName()).then(bc=>{this.LRa.qVc(bc)})})}Dho(){this.Aie&&this.LRa&&(this.Jf.sc(this.LRa,lb.ContractEntityAnnotation.getTypeName()),this.LRa=null)}e4j(){this.oA.AK(this.Gtl());this.oA.AK(this.Itl());this.oA.AK(this.bwl());this.oA.AK(this.jpl());this.oA.AK(this.Uxl());this.oA.AK(this.sil());this.oA.AK(this.onLinkExecute());this.oA.AK(this.onPivotTabExecute());this.oA.AK(this.YKl());this.oA.AK(this.CNl());this.oA.AK(this.Bxl());
this.oA.AK(this.sOl());this.oA.AK(this.eIl())}sOl(){return bc=>{bc.autoDetectedHeadingsToggleDisabled=this.gza?!this.gza.fik():!0}}CNl(){return bc=>{bc.type=this.SYj}}onLinkExecute(){return bc=>{bc.onLinkExecute=()=>{this.HM.sZm()}}}onPivotTabExecute(){return bc=>{bc.onPivotTabExecute=Ka=>{switch(Ka){case A.a.headings:this.d6i();break;case A.a.replace:this.M6i();break;case A.a.contracts:this.eZn();break;case A.a.intelligentPlaceholder:this.q6i();break;default:this.X5i()}ca.b(this.UO)&&(this.UO=this.AHg(),
this.UO||(this.UO=""),ca.b(this.UO)||(this.HM.onSearchQueryChanged(this.UO),this.om()))}}}YKl(){return bc=>{bc.showOutOfSyncNotification=this.T1g}}Itl(){return bc=>{bc.findSearchBoxContent={onSearchQueryChanged:Ka=>{this.UO=Ka;this.om();this.HM.onSearchQueryChanged(Ka)},findOptions:this.Mnc,matchCase:this.d5,matchWholeWord:this.e5,findSearchText:this.UO,onClearButtonExecute:()=>{void 0!==this.UO&&null!==this.UO&&""!==this.UO&&(this.UO="",this.hb.setSelection(null),this.HM.wSm())},onMatchCaseExecute:()=>
{this.Mnc.matchCase=!this.Mnc.matchCase;this.d5=!this.d5;this.om();this.HM.U_m()},onMatchWholeWordExecute:()=>{this.Mnc.matchWholeWord=!this.Mnc.matchWholeWord;this.e5=!this.e5;this.om();this.HM.V_m()},onMenuClose:()=>{if(this.IY)this.IY.onMenuClose()},onMenuOpen:()=>{if(this.IY)this.IY.onMenuOpen()}}}}sil(){return bc=>{bc.activeTab=this.ryd}}Bxl(){return bc=>{bc.autoDetectedHeadingsToggleState=this.gza?this.gza.TSe:!1;this.BG.RFc=bc.autoDetectedHeadingsToggleState;!bc.autoDetectedHeadingsToggleState&&
this.gza&&this.gza.Mgc(!1)}}Gtl(){return bc=>{const Ka={onReplaceAllExecute:()=>{this.HM.Z_m()},onReplaceExecute:()=>{this.HM.Y_m()},onReplaceQueryChanged:Bb=>{this.UEe=Bb;this.om()},replaceSearchText:this.UEe};bc.findReplaceContent={searchResults:this.Ypa.toArray(),replaceSearchBoxContent:Ka,onNextSearchResultExecute:()=>{this.HM.W_m()},onPrevSearchResultExecute:()=>{this.HM.X_m()},onSearchResultSelected:Bb=>{const {FindReplaceUIManager:tb}=c(1576);this.HM.AUm(Bb);tb.Soi(1)},selectedResultId:this.IGe,
summaryLabel:this.hJe,explanationText:this.$sl(this.Dxc),haveTooManySearchResults:this.Dxc===l.a.tooManyResults}}}$sl(bc){switch(bc){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return qb.a.lZh();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}eIl(){return bc=>{bc.replaceFollowUpsWithCommentsIsEnabled=
!0}}Uxl(){return bc=>{var Ka=this.zG.fjl();const Bb=[];for(let tb of Ka)Ka=this.zG.rEd(tb.Mc,tb.id),Bb.push({id:tb.id.toString(),intelligentPlaceholderAnchorText:Ka});bc.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Bb,onIntelligentPlaceholderInputExecute:tb=>{this.UO=tb;this.JGa=A.a.find;this.om();this.HM.onSearchQueryChanged(tb)},onSearchResultSelected:tb=>{this.om();tb=e.a.Pf(tb);this.zG.pGn(tb)}}}}bwl(){return bc=>{let Ka=()=>{};this.gza&&(Ka=Object(qa.a)(this.gza,this.gza.Mgc,
"toggleAutoDetectedHeadings"));bc.headingsContent={onHeaderInputExecute:Bb=>{this.UO=Bb;this.JGa=A.a.find;this.om();Y.a("NavigationPaneFind");this.HM.onSearchQueryChanged(Bb)},renderHeadingContent:(Bb,tb,Kb)=>{this.Hb.fc(new S.a(0,1,100,()=>{var Ib=window.performance.now()-this.mmd;if(this.zgd){var Wa=this.BG.r7;this.headingsReady=!0;this.om();Kb.style.display="none";Wa.first&&(Bb.style.display="block");this.Hb.fc(new S.a(1,1,0,()=>{Xb.d1e(this)}))}else this.Lbd=za.d1e(Bb,tb,Kb),this.om();Wa=window.performance.now()-
this.mmd;Y.a("NavigationPaneHeadingsLoaded",!0,Wa,[Object.assign(new Hb.a,{name:"NavPaneReactHeadings",bool:this.zgd})]);Ib=[Object.assign(new Hb.a,{name:"HeadingFetchStart",double:Ib}),Object.assign(new Hb.a,{name:"HeadingFetchFinished",double:Wa})];Y.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Ib)}))},autoDetectedHeadingsToggle:Ka,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.BG.r7,onHeadingChevronClick:Bb=>{this.BG.b7k(Bb);this.om()},onClickHeading:Bb=>
{if(this.Hb.hv){n.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",Bb);const tb=window.performance.now();this.Hb.fc(new S.a(0,1,0,()=>{this.BG.onClickHeading(Bb);this.om();const Kb=window.performance.now()-tb;Y.a("NavigationPaneAsyncOnClickHeadingItem",!0,Kb)}))}else this.BG.onClickHeading(Bb),this.om()},onClickBookmark:Bb=>{if(this.Hb.hv){n.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",
Bb);const tb=window.performance.now();this.Hb.fc(new S.a(0,1,0,()=>{this.BG.onClickBookmark(Bb);this.om();const Kb=window.performance.now()-tb;Y.a("NavigationPaneAsyncOnClickHeadingItem",!0,Kb)}))}else this.BG.onClickBookmark(Bb),this.om()},onShareHeadingClick:Bb=>{this.BG.onShareHeadingClick(Bb)},bookmarkIconUrl:Ga.a.Sh("BookmarkDefault.png")}}}ipl(){var bc,Ka=null===(bc=this.LRa)||void 0===bc?void 0:bc.p2b();if(Ka){bc=Array(Ka.length);let Bb=0;for(const tb of Ka)(Ka=tb.content)&&(bc[Bb++]={id:tb.id,
type:Ka.type,value:Ka.value});return bc}return null}jpl(){return bc=>{bc.contractsContent={onHeaderInputExecute:Ka=>{this.UO=Ka;this.JGa=A.a.find;this.om();Y.a("NavigationPaneFind");this.HM.onSearchQueryChanged(Ka)},contractEntities:this.ipl(),selectedEntityId:this.CAg.h0g,onEntitySelected:Ka=>{var Bb;const tb=null===(Bb=this.LRa)||void 0===Bb?void 0:Bb.p2b();if(tb)for(const Kb of tb)if(Kb.id===Ka){this.CAg.eGn(Kb);break}this.om()}}}}O0i(bc){this.vhd=bc}fno(bc){this.Hb.fc(new S.a(0,1,0,()=>{this.BG.t9f(bc)&&
this.om()}))}rUl(bc){this.Hb.fc(new S.a(0,1,0,()=>{const Ka=this.BG.iIb;this.BG.EUk(bc)?this.om():0===this.BG.iIb&&0<Ka&&this.om()}))}H8f(bc,Ka){this.Hb.fc(new S.a(0,1,0,()=>{const Bb=this.BG.iIb;this.BG.H8f(bc,Ka)?this.om():0<this.BG.iIb&&0===Bb&&this.om()}))}YTk(bc){this.Hb.fc(new S.a(0,1,0,()=>{const Ka=this.BG.iIb;this.BG.ZTk(bc)?this.om():0===this.BG.iIb&&0<Ka&&this.om()}))}YRn(bc){this.BG.lbo(bc);this.om()}f9f(bc){this.BG.f9f(bc)&&this.om()}A3e(bc){this.BG.A3e(bc)&&this.om()}Vdn(){return 0<
this.BG.iIb}I7(){this.Ub.Kg(this.Hpb);n.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}vba(){if(this.Z_a()){var bc;(bc=Oa.InteractiveViewManager.instance.yd)?(bc=bc.sI,n.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(bc=this.Ub.NS,n.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Ub.Kg(bc)}}Z_a(){return!!this.Ub.pg&&this.Ub.pg.name===this.Hpb}static getInstance(){return ub.Hl()}static Hl(){return new ub(new Ra(a.AFrameworkApplication.ya),
Object(qa.a)(Zb.getInstance(),Zb.getInstance().getSelectedText,"getSelectedText"),Za.a.instance,L.a.instance,ja.a.instance,Object(qa.a)(rb.instance,rb.instance.qCl,"getNextSearchResult"),m.a.instance.Pa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),m.a.instance.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),m.a.instance.Pa("Box4.AugmentationLoop.IAnnotationStorage"),m.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),W.a.instance,
m.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new Xa)}static recordQosError(bc,Ka,Bb){const tb=Object.assign(new Sa.a,{extendedProperties:new Map});Bb&&tb.extendedProperties.set("exception",Bb);X.Health.instance.recordQosError(bc,Ka,!1,!0,!1,!1,tb)}}Object(C.a)(ub,"ReactFindReplacePane",F,[300,301,10]);var Pb=c(1522);c.d(O,"FindReplaceUIManager",function(){return yc});class yc{constructor(bc,Ka,Bb=null,tb=null,Kb=null,Ib=null){this.l9c=this.Y0=0;this.e5=this.d5=this.nub=!1;this.Ql=
this.oTg=this.Sha=null;this.FCa=this.Nve=!1;this.ih=bc;this.Ep=Bb;this.Etb=tb;this.SPg=Kb;this.me=Ib;yc.RYb=new M}get Htf(){return this.Nve}set Htf(bc){bc!==this.Nve&&(this.Nve=bc,this.Umh())}W7d(bc){this.Y0=bc;this.update();this.Y0||this.mF!==l.a.searchComplete&&this.mF!==l.a.tooManyResults?0<this.Y0&&this.mF===l.a.noMatchesFound?this.O5(l.a.searchComplete):this.Y0>yc.Ucj&&this.mF!==l.a.tooManyResults&&(n.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.O5(l.a.tooManyResults)):
this.O5(l.a.noMatchesFound)}w6d(bc){this.l9c=bc;this.FCa&&this.update();this.SPg&&!this.SPg.value.qYc&&this.XXf()}reset(){}Y9e(){this.me&&(this.Ql=this.me.jg("UserAction","Find"));if(this.FCa||!this.mF)this.FCa=!1,n.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.O5(l.a.searching)}I1b(){var bc;this.FCa=!0;let Ka=this.Y0?l.a.searchComplete:l.a.noMatchesFound;if(this.mF!==l.a.tooManyResults&&v.FindManager.instance){const Bb=v.FindManager.instance.Fj;0<Bb.yha&&(Bb.yha>yc.Ucj?Ka=l.a.tooManyResults:
this.foo(Bb))}this.O5(Ka);this.update();this.Ql&&(this.Ql.stop(),this.Ql=null);yc.fXi=e.a.create().toString();yc.Soi(0,this.Sbb,this.OLa().length,this.Y0);Object(Pb.b)()&&(null===(bc=this.ih)||void 0===bc?0:bc.isVisible)&&(bc={},a.AFrameworkApplication.ya.Xb(H.a.t2d,2,bc),bc[h.a.On]&&a.AFrameworkApplication.ya.Xb(H.a.CNd,2,{CommandValueId:{query:this.OLa(),matchCase:this.d5,matchWholeWordOnly:this.e5,totalResultLimit:-1}}))}foo(bc){const Ka=bc.dBa;let Bb=Ka;const tb=[];do tb[tb.length]=Bb,Bb=bc.TYa(Bb);
while(Ka!==Bb);this.ih.fPe(tb);this.Sha&&this.ih.X5d(this.Sha)}update(){this.ih&&this.ih.Yoo()}get mF(){return this.ih.mF}get Sbb(){return this.ih.ryd}Jkb(bc){this.Htf=bc}Umh(){if(this.Htf)switch(this.mF){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.ih.F0c(!0)}else this.ih.F0c(!1)}O5(bc){if(this.ih.isVisible){switch(bc){case l.a.noMatchesFound:case l.a.searchComplete:this.mF===l.a.tooManyResults&&(bc=l.a.tooManyResults)}this.ih&&(this.ih.O5(bc),this.Umh());this.update();
this.XXf()}}qLa(bc,Ka){const Bb=this.FCa&&this.mF!==l.a.tooManyResults;switch(bc){case 0:Bb&&this.ih.fPe(Ka);break;case 1:Bb&&this.ih.PPi(Ka);break;case 4:Bb&&this.ih.ckj(Ka);break;case 2:this.ih.aoh();break;case 3:this.Sha=Ka[0],Bb&&0<this.Y0&&this.ih.X5d(this.Sha)}}get matchCase(){return this.d5}set matchCase(bc){this.d5!==bc&&(this.d5=bc,this.sij())}get matchWholeWord(){return this.e5}set matchWholeWord(bc){this.e5!==bc&&(this.e5=bc,this.sij())}sij(){this.ih.bde()}OLa(){return this.ih.OLa()}pBb(){return this.ih.pBb()}DYf(bc){this.ih.DYf(bc)}clearSearch(){this.ih.clearSearch()}get N6i(){return 0<
this.Y0&&this.mF!==l.a.replaceAllInProgress&&this.mF!==l.a.replaceAllComplete}LJn(bc){let Ka="";bc?Ka=0<this.Y0?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.OLa(),this.pBb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.OLa(),this.pBb()):bc||0<this.Y0&&(Ka=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.XXf(Ka)}dispose(){this.ih.dispose()}FJc(){return this.ih.FJc()}FOn(bc,Ka=!0){bc!==
this.Sbb&&(bc===A.a.headings?(n.ULS.sendTraceTag(9056651,367,50,""),this.ih.d6i()):bc===A.a.find?this.ih.X5i():bc===A.a.replace?this.ih.M6i():bc===A.a.intelligentPlaceholder&&(Ka||this.ih.O0i(Ka),this.ih.q6i()))}aB(bc,Ka=!0){this.ih.O0i(Ka);bc?(this.nub||this.eof(),this.ih.tO(),this.Y0||this.mF===l.a.noMatchesFound?a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.ih.O5(l.a.searchComplete):this.O5(l.a.initial)):this.ih.$la()}eof(){this.nub||
(this.ih.initialize(),this.nub=!0)}XXf(bc=""){var Ka=this.sIl();Ka&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,bc,Ka));this.Etb&&Ka&&this.Sha&&this.mF!==l.a.tooManyResults&&this.mF!==l.a.replaceAllInProgress&&(Ka=this.Etb.$xd(this.Sha),bc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,bc,Ka.a_e));(Ka=this.Zsl())&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
bc,Ka));this.Ep&&bc&&this.oTg!==bc&&(this.oTg=bc,this.Ep.sendNotification(bc,!0))}sIl(){let bc="";switch(this.mF){case l.a.startSearch:bc=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:bc=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.l9c,this.Y0);break;case l.a.tooManyResults:this.FCa&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.l9c,this.Y0));break;case l.a.noMatchesFound:bc=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;
break;case l.a.replaceAllInProgress:bc=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:bc=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return bc}Zsl(){let bc="";switch(this.mF){case l.a.initial:bc=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.Atl());break;case l.a.noMatchesFound:bc=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;
case l.a.replaceAllComplete:bc=qb.a.lZh();break;case l.a.tooManyResults:bc=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return bc}Atl(){let bc="";this.d5&&this.e5?bc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.d5?bc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.e5&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return bc}static getInstance(bc){return yc.Hl(bc)}static Hl(bc){const Ka=ub.getInstance();return new yc(Ka,bc,m.a.instance.resolve("Common.Utils.IAriaNotifier"),L.a.instance,new x.a(()=>v.FindManager.instance.aJb),u.App.xa.lq)}static Soi(bc,Ka=-1,Bb=-1,tb=-1){n.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:bc,["SearchComplete.ResultsCount"]:tb,["SearchOpsCorrelation"]:yc.fXi,["ActionId"]:yc.RYb.actionId,["SourceControlId"]:yc.RYb.MEa,["IsNavPanOpenedAlready"]:yc.RYb.Aim,
["IsSearchFromNavPane"]:yc.RYb.Ylm,["CurrentTab"]:Ka,["QueryLength"]:Bb})}static jqk(bc,Ka,Bb){Ka=void 0!==Ka&&null!==Ka?void 0===Ka.SourceControlId||null===Ka.SourceControlId?"Unknown":Ka.SourceControlId:bc===E.a.clb?"FindKeyboardShorcut":bc===E.a.elb?"ReplaceKeyboardShorcut":"Unknown";switch(bc){case E.a.bfc:bc="ShowHeadingsPane";break;case E.a.clb:bc="ShowFindPane";break;case E.a.elb:bc="ShowReplacePane";break;case E.a.ffc:bc="ShowIntelligentPlaceholderPane";break;case E.a.d4a:bc="ToggleNavigationPane";
break;default:bc="Unknown"}yc.RYb=new M(bc,Ka,Bb,!0)}}yc.Ucj=100;yc.fXi=null;yc.RYb=null;Object(C.a)(yc,"FindReplaceUIManager",null,[286,276,10])},1577:function(C,O,c){c.r(O);C=c(0);var l=c(155),e=c(84),a=c(67),h=c(2),m=c(23),v=c(57),u=c(1061),n=c(130),x=c(9),A=c(8),H=c(18),E=c(335),L=c(500),M=c(1493),F=c(1733),J=c(27),I=c(289),K=c(7),N=c(477),G=c(19),P=c(273),S=c(53),W=c(549),X=c(1615);class Y{constructor(Xa,qb,rb,nb,Tb,Zb,Hb,Sa){this.aTg=this.DXg=this.GGg=this.wG=this.t5a=this.UNb=this.tqe=this.pme=
this.Yne=this.VM=this.h5=this.k5=null;this.Pce=()=>{const ua=this.dja.GAb(this.wG),Fa=this.dja.Nul(this.wG);this.pme.innerText=ua.toString();this.tqe.innerText=Fa.toString();F.a.aKb(this.k5,1===ua?!1:!0);F.a.aKb(this.h5,ua===Fa?!1:!0)};this.gMn=()=>{const ua=this.Ub.getRegion(E.a.hYa);let Fa;if(this.crb)if(this.VM&&!this.VM.disabled)Fa=this.VM;else if(this.k5.disabled){if(this.h5.disabled)return;Fa=this.h5}else Fa=this.k5;else if(this.h5.disabled)if(this.k5.disabled)if(this.VM&&!this.VM.disabled)Fa=
this.VM;else return;else Fa=this.k5;else Fa=this.h5;Fa.focus();ua.Wj.qy(Fa)};this.Pna=(ua,Fa)=>{(ua=Fa.kl.kb)&&this.VM&&F.a.aKb(this.VM,G.SelectionEditor.Dm(ua)?!0:!1)};this.GXe=()=>{if(!this.h5.disabled){const ua=this.dja.igb(this.wG)?H.a.DDf:H.a.CDf;this.ga.processAction(ua,2)}return!0};this.HXe=()=>{if(!this.k5.disabled){const ua=this.dja.igb(this.wG)?H.a.FDf:H.a.EDf;this.ga.processAction(ua,2)}return!0};this.FXe=()=>{this.VM&&!this.VM.disabled&&this.ga.processAction(H.a.Oli,2);return!0};this.Ub=
Xa;this.ga=nb;this.kg=Tb;this.le=Zb;this.hb=Hb;this.dja=rb;this.Y5=document.createElement("div");this.Y5.classList.add("FootnoteEndnoteActionBarControl");this.crb=Sa;this.Y5.style.zIndex=String(P.a.wAd);this.Y5.style.position="relative";this.Hmc=document.createElement("div");this.Hmc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.crb=Sa;this.Y5.appendChild(this.Hmc);this.XIk();this.Y5.appendChild(this.UNb);this.Y5.appendChild(this.t5a);this.wY=e.KeyInputManager.lc(a.a.h0,0);this.b5l();
this.a5l()}uea(Xa){A.ULS.shipAssertTag(4520065,308,this.dja.uma(Xa));if(this.wG!==Xa){this.wG=Xa;this.Pce();Xa=this.dja.igb(this.wG);this.vLk(Xa);this.wG.Jah(this.Pce);let qb,rb;this.crb&&(qb=this.dja.GAb(this.wG)-1,rb=this.dja.GAb(this.wG)+1);Xa?(this.h5.title=this.crb&&!this.h5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,rb.toString()):WordEditorIntl.WordEditorStrings.L_NextFootnote,this.k5.title=this.crb&&!this.k5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
qb.toString()):WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.h5.title=this.crb&&!this.h5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,rb.toString()):WordEditorIntl.WordEditorStrings.L_NextEndnote,this.k5.title=this.crb&&!this.k5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,qb.toString()):WordEditorIntl.WordEditorStrings.L_PrevEndnote);this.cEa()}}Gyb(){this.wG&&(this.VM&&this.VM.parentNode===this.UNb&&this.UNb.removeChild(this.VM),
this.Eha(),this.wG.hun(this.Pce),this.wG=null)}dispose(){this.Ub.re(E.a.hYa).Er(this.wY)}vLk(Xa){3===this.ga.mode&&(Xa=Xa?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.VM=this.F_e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Xa,null),J.a.Jq(this.VM,J.a.Eda,Xa),this.UNb.appendChild(this.VM))}XIk(){this.UNb=document.createElement("div");this.UNb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");
this.t5a=document.createElement("div");this.t5a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.k5=this.F_e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.t5a.appendChild(this.k5);this.pme=N.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.t5a.appendChild(this.pme);this.Yne=N.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.Yne.innerText=
" / ";this.t5a.appendChild(this.Yne);this.tqe=N.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.t5a.appendChild(this.tqe);this.h5=this.F_e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.t5a.appendChild(this.h5)}F_e(Xa,qb,rb,nb){Xa=F.a.SWa(Xa,qb,rb,nb,void 0===nb||null===nb);Xa.setAttribute(J.a.Bh,J.a.J1);return Xa}b5l(){const Xa=this.Ub.re(E.a.hYa);Xa.parent=n.AppFrame.Qp;Xa.bindAction(this.wY,H.a.q$);Xa.wda(this.gMn)}a5l(){var Xa=
new I.DOMFocusListing(()=>this.Y5);Xa.fEa=!1;Xa.Rn(2);Xa.Rn(1);Xa=this.Ub.qtd(this.Y5,this.Ub.re(E.a.hYa),Xa);Xa.fPa();Xa.$T=!0}cEa(){this.VM&&(this.kg.mb(K.a.click,this.VM,this.FXe),this.GGg=this.le.Ijb(this.VM,this.FXe,a.a.hs));this.kg.mb(K.a.click,this.k5,this.HXe);this.DXg=this.le.Ijb(this.k5,this.HXe,a.a.hs);this.kg.mb(K.a.click,this.h5,this.GXe);this.aTg=this.le.Ijb(this.h5,this.GXe,a.a.hs);this.hb.tB(this.Pna)}Eha(){this.VM&&(this.kg.sc(K.a.click,this.VM,this.FXe),this.le.umb(this.VM,this.GGg));
this.kg.sc(K.a.click,this.k5,this.HXe);this.le.umb(this.k5,this.DXg);this.kg.sc(K.a.click,this.h5,this.GXe);this.le.umb(this.h5,this.aTg);this.hb.Iga(this.Pna)}static Iul(){return Y.Jul()}static Jul(){return new Y(v.FocusManager.instance(),X.a.instance,W.a.instance,h.AFrameworkApplication.ya,x.App.xa.jz,x.App.xa.oy,S.a.instance,!!x.App.instance&&x.App.instance.Ygb)}}Object(C.a)(Y,"FootnoteEndnoteActionBarControl",null,[623]);var ca=c(206),ha=c(13),ra=c(1536),sa=c(1696);class oa{constructor(Xa,qb,
rb,nb,Tb,Zb,Hb,Sa,ua,Fa,Pa,Ea){this.QD=null;this.TR=!1;this.sv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.LTb=Xa;this.N0b=qb;this.njc=rb;this.nQj=nb;this.$Ae=Tb;this.Nl=Zb;this.C7a=Hb;this.kg=Sa;this.eWg=ua;this.iDj=Pa;this.Yq=this.LTb.ownerDocument.createElement("div");this.Yq.id="FootnoteEndnoteControlOverlay";this.Yq.className="EditingSurfaceOverlay";this.DH=this.kpl();this.y_(!1);this.LTb.appendChild(this.Yq);this.LTb.appendChild(this.DH);this.N0b.bind();this.hg=null;this.ga=Ea;
this.nHa=Fa}fzn(){const Xa=this.eWg();Xa&&Xa.yi&&(Xa.lkb=0,Xa.zrd())}thj(Xa){if(this.yzc){const qb=this.yzc.nla;qb&&(qb.nrf=Xa)}}get iH(){return this.TR}get yzc(){return this.QD}get dialog(){return this.hg}get Kn(){return null!=this.wlg?this.wlg:this.wlg=m.a.instance.$a("Common.IZoomManager")}k0e(){this.hg=sa.a.Rul()}JYc(){this.hg=null}show(Xa=!0){this.TR||(this.thj(!0),this.iDj(),this.y_(!0),this.ez(),Xa&&this.setFocus())}setFocus(){this.TR&&(this.N0b.setInitialSelection(),this.nQj())}update(){this.TR&&
(this.QD.isConnected?this.njc.Pce():this.dismiss())}dismiss(Xa=!1,qb=!1){this.TR&&(this.thj(!1),this.j8(),this.fzn(),this.y_(!1),this.$Ae(qb),this.hg&&(this.ga.processAction(ha.a.bEc,2),this.hg=null),!Xa&&this.QD&&this.QD.isConnected&&this.nHa.oGn(this.QD),this.Gyb())}Oxn(Xa){const qb=null!==this.Kn.instance?this.Kn.instance.vj:1;this.DH.style.width=Xa.Urh*qb+"px";this.sv.style.width=Xa.mCc*qb+"px";this.DH.style.marginLeft=Xa.TZb*qb+"px";this.Nl?this.sv.style.marginRight=Xa.TZe*qb+"px":this.sv.style.marginLeft=
Xa.b_b*qb+"px";if(Xa=this.eWg())Xa=Xa.BK,this.DH.style.bottom=Xa.offsetHeight-Xa.clientHeight+"px"}uea(Xa){A.ULS.shipAssertTag(4520073,308,this.C7a.uma(Xa));this.QD!==Xa&&(this.QD=Xa,this.N0b.uea(Xa),this.njc.uea(this.QD))}dispose(){this.dismiss();this.N0b.dispose();this.njc.dispose()}ez(){this.kg&&this.kg.mb(K.a.click,this.Yq,this.onClick)}j8(){this.kg&&this.kg.sc(K.a.click,this.Yq,this.onClick)}kpl(){let Xa;Xa=document.createElement("div");Xa.classList.add("FootnoteEndnoteControl");this.sv=document.createElement("div");
this.sv.classList.add("FootnoteEndnoteContent");this.sv.appendChild(this.N0b.Y5);this.sv.appendChild(this.njc.Y5);Xa.appendChild(this.sv);return Xa}y_(Xa){Xa=(this.TR=Xa)?"":"none";this.Yq.style.display=Xa;this.DH.style.display=Xa}Gyb(){this.QD&&(this.N0b.Gyb(),this.njc.Gyb(),this.QD=null)}static pHd(){const Xa=x.App.xa.jb.Fc;return Xa&&Xa.yi?Xa:null}static Mul(Xa,qb,rb,nb,Tb){return new oa(Xa,qb,rb,nb,Tb,h.AFrameworkApplication.isRtl,W.a.instance,ca.a.instance,oa.pHd,ra.a.instance,oa.dZk,h.AFrameworkApplication.ya)}static dZk(){h.AFrameworkApplication.ya.Xb(ha.a.cfb,
2,!0)}}Object(C.a)(oa,"FootnoteEndnoteControl",null,[622]);var ka=c(801),ia=c(6),La=c(211),va=c(40),Ga=c(11),Oa=c(24),Za=c(90),ja=c(1614),ba=c(370),qa=c(946),Ma=c(579),Ia=c(1411),wa=c(75),za=c(123);class pa extends ba.a{constructor(Xa,qb,rb,nb,Tb,Zb,Hb,Sa,ua,Fa,Pa,Ea,lb,zb,Xb,ub,Pb){super(E.a.Dea,rb,nb,Tb,Hb,Sa,ua,Fa,Pa,Ea,lb,zb,Xb,ub,Pb);this.FAg=Xa;this.oUa=Zb;this.oUa.Z1c=this;qb(this);this.features.c4f=!0}get rei(){return!0}Jjf(){const Xa=this.FAg.$af(this);return qa.ViewReference.vF(this,Xa)}Z4e(Xa){Object(za.a)(pa,
Xa)||this.FAg.W4e()}IJc(){return Ma.a.$si}onResize(){super.onResize();this.oUa.RFh()}vB(Xa,qb=null){super.vB(Xa,qb);this.oUa.EFh(this.ld.Ui)}detach(){this.oUa.QFh();super.detach()}ODd(){this.onResize()}static QWa(){const {FootnoteEndnoteControlManager:Xa}=c(1577);return new pa(Xa.instance,Ia.a.hZe,x.App.xa.jb,wa.InteractiveViewManager.instance,()=>m.a.instance.resolve("Box4.IUndoManager"),m.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),h.AFrameworkApplication.ya,m.a.instance.resolve("Box4.IHtmlViewRootFactory"),
m.a.instance.resolve("Box4.IInteractiveEventNotifier"),m.a.instance.$a("Box4.ITextMetricsAdapter"),m.a.instance.resolve("Box4.IRotatingCoordinateConverter"),m.a.instance.$a("Common.IZoomManager"),m.a.instance.Pa("Box4.IContentControlViewElementManager"),m.a.instance.Pa("Box4.CpConversionManagerImpl"),m.a.instance.Pa("Box4.ContentControlConfigSettings"),m.a.instance.Pa("Box4.IContentControlReader"),m.a.instance.Pa("Box4.IContentControlBoundaryNavigator"))}}Object(C.a)(pa,"FootnoteEndnoteEditView",
ba.a,[]);class Ba{constructor(Xa,qb,rb,nb=!1){this.Npb=null;this.Bue=this.Bxg=!1;this.Nel=()=>{const Tb=String.format("{0} {1}",this.Bue?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.lw.sendNotification(Tb,!0)};this.Ub=Xa;this.dja=qb;this.xca=rb();this.hdd=nb;this.Y5=document.createElement("div");this.Y5.classList.add("FootnoteEndnoteEditControl");
this.Hmc=document.createElement("div");this.Hmc.classList.add("FootnoteEndnoteEditControlDividerElement");this.Wub=(new ka.a(this.Y5,"WACViewPanel_FootnoteEndnoteEditControl")).BE;this.Y5.appendChild(this.Hmc);this.Y5.appendChild(this.Wub)}get lw(){return null!=this.lhg?this.lhg:this.lhg=m.a.instance.resolve("Common.Utils.IAriaNotifier")}uea(Xa){A.ULS.shipAssertTag(4520077,308,this.dja.uma(Xa));this.Npb!==Xa&&(this.Npb=Xa,this.ISe(this.Npb),this.Bue=this.dja.igb(this.Npb),this.hdd?(this.xca.dKb(J.a.osd),
this.Ub.re(E.a.Dea).vda(this.Nel)):this.xca.p_i(this.Bue?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,J.a.osd))}Gyb(){const Xa=W.a.instance.igb(this.Npb)?"Footnote":"Endnote";A.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Xa,["CalloutHeight"]:this.Y5.scrollHeight});this.ecb();this.Npb=null}bind(){this.Bxg||(this.xca.Aab(this.Wub),this.Bxg=!0)}setInitialSelection(){const Xa=this.fKl();
Xa?this.xca.setSelection(Xa):this.xca.J_c()}dispose(){this.ecb()}ISe(Xa){this.ecb();this.xca.vB(Xa,Xa.Ui)}ecb(){this.xca.detach()}fKl(){let Xa=0;var qb=null,rb=ia.GraphIterator.Za(this.Npb);La.OutlineNavigator.f7(rb);if((rb=va.OutlineElementNavigator.Fe(rb))&&Ga.ParagraphReader.nc(rb)){if(qb=Ba.Fyl(rb)){Xa=qb.Ob.cp+1;qb=ja.FootnoteEndnoteDefaultContentInserter.dzh;const nb=qb.length;Xa+nb<=Ga.ParagraphReader.textLength(rb)&&rb.characterData.substr(Xa,nb)===qb&&(Xa+=nb)}qb=Oa.SelectionFactory.xe(rb,
Xa)}return qb}static Oul(){return Ba.Pul()}static Pul(){return new Ba(v.FocusManager.instance(),W.a.instance,()=>pa.QWa(),h.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Fyl(Xa){Xa=Za.i(Xa,10);return 0<Xa.length?Xa[Xa.length-1]:null}}Object(C.a)(Ba,"FootnoteEndnoteEditControl",null,[621]);var Ra=c(1160);class fb{constructor(Xa,qb){this.Gya=Xa;this.Nl=qb}V3b(Xa,qb){Xa=this.Gya.V3b(Xa);var rb=qb.clientWidth;const nb=qb.scrollLeft,Tb=Xa.Urh;let Zb=Xa.TZb,Hb=Xa.TZb,
Sa=fb.GAf,ua=fb.HAf,Fa=Tb,Pa=Xa.mCc;this.Nl?ua=Xa.TZe-Hb:Sa=Xa.b_b-Zb;rb<Tb&&(Zb=Math.max(Zb-nb,0),Fa=rb-Zb,this.Nl?(rb=qb.scrollWidth-nb-rb,Hb=qb.scrollWidth-Xa.TZb-Tb,ua=Math.max(Xa.TZe-rb-Hb,fb.HAf),Pa=Fa-ua-fb.GAf):(Sa=Math.max(Xa.b_b-nb-Zb,fb.GAf),Pa=Fa-Sa-fb.HAf));return new Ra.a(Zb,Fa,Sa,ua,Pa)}}fb.GAf=25;fb.HAf=50;Object(C.a)(fb,"FootnoteEndnoteViewPositionProvider",null,[]);class Va{constructor(Xa,qb=0,rb=0){this.clientWidth=Xa;this.scrollLeft=qb;this.scrollWidth=rb?rb:Xa}}Object(C.a)(Va,
"PageViewScrollContainerSizeInfo",null,[]);c.d(O,"FootnoteEndnoteControlManager",function(){return ib});class ib{constructor(Xa,qb,rb,nb,Tb,Zb,Hb,Sa){this.JD=null;this.I7=()=>{this.Ro.LG(E.a.Dea);this.Ro.LG(E.a.hYa);this.Ro.Rw(l.AFrame.Wo);this.Ub.ayc(E.a.Dea);this.Ub.Kg(E.a.Dea)};this.oMn=ua=>{this.Ro.Rw(E.a.Dea);this.Ro.Rw(E.a.hYa);this.Ro.LG(l.AFrame.Wo);this.Ub.ADc(E.a.Dea);(ua||this.Ub.pg&&(this.Ub.pg.name===E.a.Dea||this.Ub.pg.name===E.a.hYa))&&this.Ub.Kg(l.AFrame.Wo)};this.Ub=Xa;this.Ro=qb;
this.sGj=rb;this.tGj=nb;this.rGj=Tb;this.Gya=Zb;this.aqa=Hb;this.MY=Sa;this.wY=e.KeyInputManager.lc(a.a.h0,0);this.Xnf();this.wS()}get control(){return this.JD}get dialog(){return this.control.dialog}get Jci(){return this.control.iH}k0e(){this.control.k0e()}JYc(){this.control.JYc()}bind(Xa){this.SEk(Xa)}P0f(Xa){if(this.control.yzc!==Xa.LWa)this.control.dismiss();else if(this.Jci)return;this.v0b();this.control.uea(Xa.LWa);this.control.show(Xa.n8d)}v0b(){if(this.MY){const Xa=new u.a(!0);this.MY.YDa(Xa)}}FX(){this.control.setFocus()}E3c(){this.control.update()}W4e(Xa,
qb=!1){this.v0b();this.control.dismiss(Xa,qb)}Mxn(Xa){const qb=ib.pHd().BK;Xa=this.Gya.V3b(Xa,new Va(qb.clientWidth,qb.scrollLeft,qb.scrollWidth));this.control.Oxn(Xa)}dispose(){this.control.dispose();this.Ub.re(E.a.Dea).Er(this.wY)}$af(Xa){A.ULS.shipAssertTag(4520074,308,!!this.control);A.ULS.shipAssertTag(4520075,308,!!this.control.yzc);return this.abf(this.control.yzc.id,Xa)}SEk(Xa){const qb=this.tGj(),rb=this.rGj();this.JD=this.sGj(Xa,qb,rb,this.I7,this.oMn)}Xnf(){const Xa=this.Ub.re(E.a.Dea);
Xa.parent=3===h.AFrameworkApplication.ya.mode?n.AppFrame.sF:n.AppFrame.bXc;this.Ub.wOe(E.a.Dea);Xa.bindAction(this.wY,H.a.q$)}wS(){this.Ro.wS(E.a.Dea);this.Ro.wS(E.a.hYa)}abf(Xa,qb){return()=>{const rb=ib.pHd().ld.Mc.Db(Xa);this.aqa.j1b();if(!rb.isConnected)return A.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.P0f(new L.a(rb,!0));return qb}}static Hl(){const Xa=new fb(m.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),h.AFrameworkApplication.isRtl);
return new ib(v.FocusManager.instance(),x.App.xa.ov,oa.Mul,Ba.Oul,Y.Iul,Xa,M.a.instance,m.a.instance.resolve("Box4.IPasteFloatieEventSource"),m.a.instance.resolve("Common.IAppSettingsManager"))}static pHd(){const Xa=x.App.xa.jb.Fc;return Xa&&Xa.yi?Xa:null}static get instance(){return null!=ib.zng?ib.zng:ib.zng=ib.Hl()}}Object(C.a)(ib,"FootnoteEndnoteControlManager",null,[579])},1596:function(C,O,c){c.d(O,"a",function(){return x});C=c(0);var l=c(8),e=c(44),a=c(155),h=c(2),m=c(7),v=c(143),u=c(153),
n=c(23);class x{constructor(A,H){this.rt=null;this.Sjd=!1;this.J8a=0;this.GOg="";this.Mje={};this.Fze=A;this.Ub=H;this.zUg=Object(e.a)(this,this.XHf,"onModalMouseWheel");this.BNg=!!h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Rb.Ima;this.gw=!!h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Rb.S2}onMenuOpen(){0<this.J8a?this.J8a++:(this.J8a++,h.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>
{window.setTimeout(Object(e.a)(this,this.lJi,"pushTransientFocusScope"),0)}):this.lJi(),this.showModal())}lJi(){this.Ub&&this.Ub.zK(a.AFrame.Tna,!0)}aml(){const A=u.f(),H=appChrome.selectors.getShyState();return String.format("{0}{1}",A,this.BNg&&H.isActive&&1===H.state?"_ShyRibbon":"")}FOl(A){var H=0;if(this.gw){if(this.Mje[A])return this.Mje[A];(H=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
H=H?H.offsetTop:0;this.Mje[A]=H}return H}showModal(){if(!this.rt)if(this.rt=this.createElement("div"),this.rt.setAttribute("id","ReactModalDiv"),this.rt.style.position="absolute",this.rt.style.bottom="0px",this.rt.style.left="0px",this.rt.style.right="0px",this.rt.style.backgroundColor="white",this.rt.style.opacity="0.0",this.gw){var A=document.getElementById("regionComposerRoot");A&&A.appendChild(this.rt)}else this.Fze.appendChild(this.rt);A=this.aml();if(A!==this.GOg){const H=this.FOl(A),E=appChrome.selectors.getShyState();
this.BNg&&E.isActive&&1===E.state&&u.a("getRibbonHeight")?this.rt.style.top=String.format("{0}px",H+appChrome.api.getRibbonHeight(u.f())):this.rt.style.top=String.format("{0}px",H);this.GOg=A}this.rt.style.display="block";this.rt.style.visibility="visible";this.rt.style.zIndex="1000";this.Sjd||(window.addEventListener("wheel",this.zUg,!0),this.NPd()?v.a.instance.mb(m.a.hM,this.rt,Object(e.a)(this,this.gYd,"onModalPointerUp")):v.a.instance.mb(m.a.pointerDown,this.rt,Object(e.a)(this,this.fYd,"onModalPointerDown")),
this.Sjd=!0)}onMenuClose(){this.J8a--;0<this.J8a||(0>this.J8a?this.J8a=0:this.z6h())}pGf(){this.J8a=0;this.V4e();this.z6h()}createElement(A){A=document.createElement(A);A.setAttribute("unselectable","on");return A}y6h(){this.Ub&&this.Ub.pg&&this.Ub.pg.name===a.AFrame.Tna&&!h.AFrameworkApplication.uc.hv&&this.Ub.RQ(a.AFrame.Tna,!1);this.rt&&(this.rt.style.zIndex="-1",this.rt.style.visibility="hidden",this.rt.style.display="none");this.Sjd&&(window.removeEventListener("wheel",this.zUg,!0),this.NPd()?
v.a.instance.sc(m.a.hM,this.rt,Object(e.a)(this,this.gYd,"onModalPointerUp")):v.a.instance.sc(m.a.pointerDown,this.rt,Object(e.a)(this,this.fYd,"onModalPointerDown")),this.Sjd=!1)}z6h(){this.NPd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.y6h()},0)}):this.y6h()}fYd(){this.oEc();this.FBh();this.pGf();this.Bkb();return!0}gYd(){this.oEc();this.FBh();this.pGf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Bkb()},0)});return!0}Bkb(){4===h.AFrameworkApplication.ta.Rb.ko&&
h.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?h.AFrameworkApplication.ta.Bkb():this.Ub.Kg(a.AFrame.Wo)}XHf(A){A.stopPropagation()}oEc(){const A=n.a.instance.Pa("Common.IReactContextualUILauncher");A&&A.oEc()}V4e(){const A=n.a.instance.Pa("Common.IReactContextualUILauncher");A&&A.V4e()}FBh(){h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Rb.fNa&&(this.NPd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}NPd(){return h.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(C.a)(x,"ReactModalDiv",null,[])},1601:function(C,O,c){c.d(O,"a",function(){return e});c.d(O,"b",function(){return a});c.d(O,"c",function(){return h});var l=c(2);const e=(m,v)=>{const u=RegExp("mailto:(.*)").exec(m.url);v.email=u&&2===u.length?u[1]:m.url;v.resolveState=m.Jx.charAt(35)===c(1685).ACommentFormatTranslator.lhk?1:0},a=(m,v)=>{v.contentId=m.Jx},h=(m,v,u)=>{v.contentId=m.Jx;v.isCurrentUser=u.email===l.AFrameworkApplication.K.lb("UserPrincipalName")}},1602:function(C,O,c){c.d(O,
"a",function(){return a});C=c(0);var l=c(1008),e=c(5);class a{constructor(h,m){this.NM=this.Jsc=null;this.fb=h;this.k6a=m}get key(){return"COMMENT"}get qw(){return WordEditorIntl.WordEditorStrings.L_Comment}get Hka(){return this.NM}reset(h){this.NM=h.node}qFa(h){let m=null;if(this.Jsc&&this.Nci(h,this.Hka,this.Jsc))return m=Object.assign(new l.a,{YF:this.key,contentObject:this.Jsc}),{returnValue:!0,VE:m};this.Jsc=null;const v=this.k6a.F0e(this.Hka);if(this.k6a.Ypf(v)){let u=v.Ud();for(;u;){if(this.Nci(h,
this.Hka,u))return this.Jsc=u,m=Object.assign(new l.a,{YF:this.key,contentObject:u,description:this.Qdb()}),{returnValue:!0,VE:m};u=v.xj()}}return{returnValue:!1,VE:m}}Nci(h,m,v){if(this.j5i(v))return!1;const u=this.k6a.Z3b(v,!0),n=this.k6a.Z3b(v,!1);return u&&n&&this.fb.IOc(m,u,n)&&(m=this.k6a.ota(u,v.id,!0))&&(u!==this.Hka||m.Ob.cp<=h)&&(v=this.k6a.ota(n,v.id,!1))&&(n!==this.Hka||v.Ob.cp>h||v.Ob.cp>=h)?!0:!1}j5i(h){return h.ia(e.a.NF,!1)}Qdb(){return null}}Object(C.a)(a,"CommentDetailsProvider",
null,[298,299])},1607:function(C,O,c){c.d(O,"a",function(){return e});C=c(0);O=c(173);var l=c(112);class e extends O.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(C.a)(e,"DocumentTypeClassifierAnnotation",O.a,[])},1610:function(C,O,c){c.d(O,"a",function(){return n});
C=c(0);var l=c(2),e=c(83),a=c(8),h=c(44),m=c(96),v=c(66),u=c(642);class n{constructor(x,A,H,E,L,M){this.HCe=null;this.wXg=0;this.nd=E;this.te=A;this.v4=L;this.vse=H;this.Qkc=l.AFrameworkApplication.C0f();this.zke=x.appSettings.ChromeClipboardAccessOperationTimeout;this.HH=0;this.nAj=M;this.vEj=x.$("EnableExternalPasteSupportOnMobileIsEnabled")}get GOa(){return this.v4.GOa}process(x,A){if(!this.HH)return this.O5m(A);if(1===this.HH)return this.prepareForPaste(x,A);if(2===this.HH)return this.HH=3,this.HCe(x,
A);3===this.HH&&this.v4.A1i(x,A);return!1}O5m(x){let A=!0;this.vEj&&(A=!(x.Dz&1));this.te.N2&&A||x.Dz&512?(this.HCe=x.Dz&2?Object(h.a)(this.v4,this.v4.paste,"paste"):Object(h.a)(this.v4,this.v4.iFi,"pasteInternal"),this.HH=2):(this.Qkc?(this.HH=1,this.wXg=Date.now()):this.HH=2,this.HCe=Object(h.a)(this.v4,this.v4.paste,"paste"));u.a.fCm(x);return!0}prepareForPaste(x,A){x=!0;if(this.vse.value.nHi())this.HH=2;else{const H=Date.now()-this.wXg;H>this.zke&&(a.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",
H),this.nd.Zb(m.a.hla,{["Reason"]:v.a.$Ci}),A.KQ&&(A.KQ.fail("Prepare for paste timed out",!1),e.Health.instance.recordQosError("PreparePasteTimedOut",[u.a.M_d],!1,!0,!0,!1,null)),A.failed=!0,x=!1,this.nAj.vzn())}return x}}Object(C.a)(n,"ClipboardOperationPasteProcessor",null,[704])},1611:function(C,O,c){c.d(O,"a",function(){return P});C=c(0);O=c(238);var l=c(2),e=c(83),a=c(56),h=c(106),m=c(8),v=c(123),u=c(64),n=c(1881),x=c(44),A=c(20),H=c(3),E=c(96),L=c(66),M=c(1063),F=c(19),J=c(53),I=c(1552),K=
c(1612),N=c(642),G=c(160);class P extends O.a{constructor(S,W,X,Y,ca,ha,ra,sa,oa,ka,ia,La,va,Ga,Oa,Za,ja,ba,qa,Ma,Ia,wa,za,pa,Ba,Ra,fb,Va=!0){super();this.bia=this.rB=null;this.SK=this.wz=0;this.r$a=this.JGe=this.Z8=this.Gf=null;this.ZO=!1;this.hS=!0;this.mIg=!1;this.init(S);this.ll("ClipboardOperation");this.Bfb(oa,W,ca,ha,ra);this.nd=ka;this.He=ia;this.te=La;this.Hc=va;this.yzg=Ga;this.Azg=Oa;this.zzg=Za;this.Mke=ja;this.XOb=ba;this.Nke=qa;this.Qkc=sa;this.Fkc=Ma;this.aJa=Ia;this.S_j=Va;this.HC=
wa;this.Jd=za;this.xm=pa;this.MY=Ba;this._context=Y;this.kda=Ra;this.lVb=fb;ra&&Object(v.a)(89,ra)&&(this.Z8=Object(u.a)(709,ra.ia(h.a.csa,null)));this.Z8||(this.Z8=this.kda.o1c());this.unb=void 0===X||null===X?"NotAvailable":Object(n.a)(K.a,X);this.Z8.zdk(this.unb.split(", "));S=this._context;if(this.lVb){if(!P.alh(S,this.Mke,this.nd,this.Z8,Va)){this.dr=8;this.finish();return}this.Gf=S.view;this.ZO=3===this.Gf.OEb;this.wz=0;this.SK=X;this.r$a=ja.GOa}else{if(!S.view.ye){this.nd.Zb(E.a.vf,{["Reason"]:L.a.sGb});
this.Z8.fail("Not in interactive view",!0);this.dr=8;this.finish();return}this.Gf=S.view;if(!this.Gf.Cb){this.nd.Zb(E.a.vf,{["Reason"]:L.a.noSelection});this.Z8.fail("No selection manager",!0);this.dr=8;this.finish();return}this.ZO=3===this.Gf.OEb;this.wz=0;this.SK=X;this.r$a=ja.GOa;if(Va&&!(this.r$a&&this.r$a.kb&&this.r$a.length)){this.nd.Zb(E.a.vf,{["Reason"]:L.a.noSelection});this.Z8.fail("No selection when one required",!0);this.dr=8;this.finish();return}}ja=F.SelectionEditor.Dm(this.r$a.kb);
ja=!(this.SK&16&&ja);ja=qa.Ibm(X,this.Jg)&&ja;1!==this.behavior&&ja||(ja||this.Z8.fail("Clipboard operation disabled for selection",!0),this.dr=ja?32:8,this.ooa());!this.mIg&&this.te.mi&&(a.b("IPadCCP"),this.mIg=!0)}get Jg(){this.JGe||(this.JGe=J.a.NYb(this.r$a));return this.JGe}iba(){super.iba();this.r$a=null}run(){this.wz||this.setup();1===this.wz&&this.process();2===this.wz&&this.teardownSync();3===this.wz&&this.teardownAsync();4===this.wz&&this.finish()}setup(){if(this.SK&256&&this.Qkc){this.gF||
this.XOb.Dwk(this,this.SK,this.unb);this.gF.run();if(this.gF.inProgress)return;this.hS=this.gF.kga;this.Uud();if(!this.hS){this.Z8.fail("No access to system clipboard",!0);this.dr=8;this.wz=4;this.KTd();return}}else m.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.SK,this.unb,this.te.dF,this.actionId);this.SK&32&&!this.He.EOd(this.Gf.Cb.Jg)?(m.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.nd.Zb(E.a.vf,{["Reason"]:L.a.A2e}),this.Z8.fail("Cut not allowed",
!0),this.Fkc.show(),this.dr=8,this.wz=4):(this.SK&16||this.SK&32)&&A.a.instance.J(3)&&this.HC.CQd(this.Gf.Cb.ib.kb)?(this.Z8.fail("Selected content deleted in coauthoring",!0),this.Jd.ZKb(),this.dr=8,this.wz=4):(this.SK&4096&&(this.MY.bcc(Object.assign(new M.a,{PNc:!0,OQ:this.unb})),this.xm.undo()),this.Nke.a$m(this.SK),!this.Gf.ld&&l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")?(this.Z8.fail("Interactive view has null target node",!0),this.dr=
8,this.wz=4):(this.rB=this.Hc.Rc(15),this.rB.Al=this.actionId,this.rB.Eb(this.Gf.ld),this.wz=1))}process(){if(!this.gF){m.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.SK,this.unb,this.te.dF);m.ULS.shipAssertTag(6305507,307,!this.bia);this.bia=new I.a(this._context,this.SK,this.Z8,this.C7,this.zD,void 0,this.te.dF,this.S_j,this.ZO);let S;S=this.SK&65536?Object(x.a)(this.yzg,this.yzg.process,"process"):this.SK&64?Object(x.a)(this.Azg,this.Azg.process,"process"):
this.SK&1?Object(x.a)(this.Mke,this.Mke.process,"process"):Object(x.a)(this.zzg,this.zzg.process,"process");this.SK&16&&this.Gf.Cb.zwa.uLh();this.aJa.create(this,S,this.bia).ll("ClipboardAction")}m.ULS.shipAssertTag(6305536,307,!!this.gF);this.gF.run();this.gF.inProgress||(this.Uud(),this.wz=this.fh?2:3)}teardownSync(){this.bia.t7b&&(this.rB.Al=H.a.typing);this.bia.hOc&&this.rB.dDa(this.bia.tnf,this.bia.cFf);this.rB.dispose();this.dr=this.bia.failed?8:32;this.wz=4}teardownAsync(){if(this.gF){if(this.gF.run(),
this.gF.inProgress)return}else if(this.bia.t7b&&(this.rB.Al=H.a.typing),this.rB.zEa(this),this.bia.hOc&&this.rB.dDa(this.bia.tnf,this.bia.cFf),this.rB.dispose(),this.PNe)return;this.dr=this.bia.failed?8:32;this.wz=4}finish(){this.MY.bcc(Object.assign(new M.a,{PNc:!1}));this.ooa();32===this.response?m.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.SK,this.unb,this.te.dF):m.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",
+this.endTime-+this.startTime,this.SK,this.unb,this.te.dF);this.kda.sea(this.Z8);P.zjn&&this.Jym()}KTd(){const S=!!(this.SK&1),W=this._context.view;W&&N.a.KTd(S,W.Cb,this.te.dF)}Jym(){if(!(this.SK&4||this.SK&64)){var S=new Map;S.set("isCopy",String.format("{0}",!!(this.SK&16)));S.set("isIPad",String.format("{0}",this.te.mi));e.Health.instance.recordKpiUsage(N.a.jmh,0,N.a.kWe,S);this.hS||(S=Object.assign(new G.a,{extendedProperties:S}),e.Health.instance.recordKpiFailure(N.a.jmh,N.a.Ztk,!0,!0,S))}}static get zjn(){null==
P.BEe&&(P.BEe=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return P.BEe}static QQf(S,W,X,Y){S&&S.Zb(E.a.vf,{["Reason"]:X});W&&W.fail(Y,!0)}static alh(S,W,X=null,Y=null,ca=!0){return S.view.ye?S.view.Cb?!ca||W.GOa&&W.GOa.kb&&W.GOa.length?!0:(P.QQf(X,Y,L.a.noSelection,"Paste target is invalid"),!1):(P.QQf(X,Y,L.a.noSelection,"No selection manager"),!1):(P.QQf(X,Y,L.a.sGb,"Not in interactive view"),!1)}}P.BEe=null;Object(C.a)(P,"ClipboardOperation",O.a,
[])},1612:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.paste=1]="paste";e[e.textOnly=2]="textOnly";e[e.overtype=4]="overtype";e[e.copy=16]="copy";e[e.deleteSelection=32]="deleteSelection";e[e.move=64]="move";e[e.useSystemClipboard=256]="useSystemClipboard";e[e.forceInternalClipboard=512]="forceInternalClipboard";e[e.reformatPastedContent=4096]="reformatPastedContent";e[e.pasteAsPlainText=8192]="pasteAsPlainText";e[e.showPlaceholderGlossary=65536]="showPlaceholderGlossary";
e[e.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";e[e.noSpacesAdjustment=262144]="noSpacesAdjustment"})(l||(l={}));Object(C.b)("ClipboardActionFlags",l)},1613:function(C,O,c){var l=this&&this.nR||(Object.create?function(a,h,m,v){void 0===v&&(v=m);var u=Object.getOwnPropertyDescriptor(h,m);if(!u||("get"in u?!h.oG:u.writable||u.configurable))u={enumerable:!0,get:function(){return h[m]}};Object.defineProperty(a,v,u)}:function(a,h,m,v){void 0===v&&(v=m);a[v]=
h[m]}),e=this&&this.__exportStar||function(a,h){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(h,m)||l(h,a,m)};Object.defineProperty(O,"__esModule",{value:!0});e(c(1757),O);e(c(1758),O);C.exports.IntentIds||Object.defineProperty(C.exports,"IntentIds",{enumerable:!0,get:function(){return C.exports.IntentIds}});C.exports.ObjectSchemaType||Object.defineProperty(C.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return C.exports.ObjectSchemaType}});C.exports.ObjectSemantic||
Object.defineProperty(C.exports,"ObjectSemantic",{enumerable:!0,get:function(){return C.exports.ObjectSemantic}});C.exports.SearchSuggestionAnnotation||Object.defineProperty(C.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return C.exports.SearchSuggestionAnnotation}});C.exports.SearchSuggestionSignal||Object.defineProperty(C.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return C.exports.SearchSuggestionSignal}});C.exports.SequenceType||Object.defineProperty(C.exports,
"SequenceType",{enumerable:!0,get:function(){return C.exports.SequenceType}})},1614:function(C,O,c){c.r(O);c.d(O,"FootnoteEndnoteDefaultContentInserter",function(){return L});C=c(0);var l=c(23),e=c(59),a=c(2),h=c(40),m=c(657),v=c(33),u=c(5),n=c(16),x=c(44),A=c(1173),H=c(866),E=c(1553);class L{constructor(M,F,J,I,K=null){this.Yc=M;this.gAj=F;this.Nl=J;L.Kh=I;this.cBg=K||L.mMk}get xK(){return null!=this.upg?this.upg:this.upg=l.a.instance.resolve("Box4.IOutlineEditor")}zKk(M,F){var J=this.Yc.Ck();J.set(M);
this.xK.Gfb(J,null,!0);L.Kh.qKb(J.currentNode,this.Nl);M=h.OutlineElementNavigator.Fe(J);L.a8.J7d(F?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,M);J=this.cBg(J.currentNode);L.characterPropertiesEditor.replaceTextRange(J,L.dzh);this.R7l(M,F)}R7l(M,F){var J=this.gAj(131073);J.setValue(u.a.Gq,1===F?36:35);J.setValue(u.a.eka,!0);J.setValue(n.a.e8,!0);const I=M.Mc.Lu(J,e.a.create());J=this.cBg(M);L.characterPropertiesEditor.ifa(J,K=>H.a.getInstance(K,I,!0),
E.a.ROh(M,F))}static Hl(){return new L(new m.a,Object(x.a)(A.a.instance,A.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get a8(){return null!=L.Irg?L.Irg:L.Irg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=L.Whg?L.Whg:L.Whg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=L.Mng?L.Mng:L.Mng=L.Hl()}static mMk(M){return v.a.Uc(M,
0)}}L.dzh=" ";L.Kh=null;Object(C.a)(L,"FootnoteEndnoteDefaultContentInserter",null,[653])},1615:function(C,O,c){c.d(O,"a",function(){return m});C=c(0);var l=c(657),e=c(549),a=c(1493),h=c(1553);class m{constructor(v,u){this.aqa=u}pJd(v,u,n){return(v=this.aqa.aWh(v.node,n?v.cpBegin:v.cpEnd,u))?v.s2():null}w3h(v,u){return(v=this.aqa.CGl(v.node,v.cpBegin,u))?v.s2():null}static rIc(){return new m(e.a.instance,a.a.instance,new l.a,h.a.instance)}static get instance(){return null!=m.lng?m.lng:m.lng=m.rIc()}}
Object(C.a)(m,"FootnoteEndnoteNavigator",null,[615])},1625:function(C,O,c){c.d(O,"a",function(){return m});C=c(0);var l=c(1678),e=c(2),a=c(42),h=c(23);class m{constructor(v,u,n,x,A,H){this.Cqa=v;this.Dqa=u;this.yse=n;this.gY=x;this.R9c=A;this.oOb=H}get e6i(){return!this.Dqa&&!this.yse}get uwi(){return 2===this.oOb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get lGh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get M7h(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Zeb(){return CommonUIStrings.l_OICErrorHelpLink}get l6h(){return"OICFailure"}get icon(){return 3}get $pd(){return 2===
this.oOb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get PKa(){return CommonUIStrings.l_DefaultDialogTitle}nin(v){this.Ewi(v)}ptm(v){this.Ewi(v)}Ewi(v){let u=10;1===v?(h.a.instance.resolve("Common.IOfficeTrialExperience").rwf(this.oOb),u=3):2===v&&((!this.yse||this.yse(this.gY))&&this.Dqa&&l.a.instance.yNk(this.Dqa,this.Cqa,this.gY),u=5);(0===v||1===v)&&this.Cqa&&this.Cqa(this.gY);e.AFrameworkApplication.zYc(a.a.OCi,this.R9c,u);this.dispose()}dispose(){this.gY=
this.Dqa=this.Cqa=null}}Object(C.a)(m,"AOICErrorDialogWithTrial",null,[10])},1676:function(C,O,c){C=c(0);var l=c(2),e=c(15),a=c(23),h=c(593),m=c(1489),v=c(1369),u=c(32);class n{constructor(Ba,Ra=null){this.MOj=Ba;this.OV=Ra||m.a.Nef(e.a.uwb,"")}get ay(){return this.MOj}get Jc(){return this.OV}WYf(Ba){this.Jc.d++;return this.ay.WYf(Ba)}yec(Ba){this.Jc.e++;return this.ay.yec(Ba)}$F(Ba){this.Jc.f++;return this.ay.$F(Ba)}Ekb(Ba){this.Jc.h++;return this.ay.Ekb(Ba)}K3(Ba){this.Jc.i++;return this.ay.K3(Ba)}Q7(Ba){this.Jc.j++;
return this.ay.Q7(Ba)}soa(Ba){this.Jc.k++;return this.ay.soa(Ba)}xba(Ba){this.Jc.l++;return this.ay.xba(Ba)}S6d(Ba){this.Jc.m++;return this.ay.S6d(Ba)}Y2a(Ba,Ra=!1){this.Jc.n++;return this.ay.Y2a(Ba,Ra)}tkf(){this.Jc.o++;return this.ay.tkf()}M1f(){this.Jc.p++;return this.ay.M1f()}Ks(Ba){this.Jc.q++;return this.ay.Ks(Ba)}ewa(Ba){this.Jc.r++;return this.ay.ewa(Ba)}mec(Ba){this.Jc.g++;return this.ay.mec(Ba)}R_c(Ba){return this.ay.R_c(Ba)}Gkb(Ba){this.Jc.s++;return this.ay.Gkb(Ba)}y7d(Ba){this.Jc.s++;
return this.ay.y7d(Ba)}q1e(Ba){this.Jc.ba++;return this.ay.q1e(Ba)}C6d(Ba){this.Jc.s++;return this.ay.C6d(Ba)}Fkb(Ba){this.Jc.s++;return this.ay.Fkb(Ba)}wKb(Ba){this.Jc.t++;return this.ay.wKb(Ba)}P7d(Ba){this.Jc.u++;return this.ay.P7d(Ba)}Zga(Ba){this.Jc.v++;return this.ay.Zga(Ba)}MZf(Ba){this.Jc.bb++;return this.ay.MZf(Ba)}CEa(Ba){return this.ay.CEa(Ba)}H7(Ba){this.Jc.z++;return this.ay.H7(Ba)}LUf(){return this.ay.LUf()}$ga(Ba,Ra){this.Jc.w++;this.Jc.x++;return this.ay.$ga(Ba,Ra)}jC(Ba){this.Jc.y++;
return this.ay.jC(Ba)}clearFormatting(){return this.ay.clearFormatting()}clone(){return new n(this.ay.clone(),this.Jc)}}Object(C.a)(n,"FormattingStewardUsageCollector",null,[405]);class x extends n{constructor(Ba,Ra=null){super(Ba,Ra)}get h7(){return this.ay}get Zs(){return this.h7.Zs}set Zs(Ba){this.h7.Zs=Ba}get textIndent(){return this.h7.textIndent}get marginLeft(){return this.h7.marginLeft}get $fc(){return this.h7.$fc}get KDa(){return this.h7.KDa}get lineSpacing(){return this.h7.lineSpacing}get gJ(){return this.h7.gJ}get leftIndent(){return this.h7.leftIndent}get cba(){return this.h7.cba}get paragraph(){return this.h7.paragraph}set paragraph(Ba){this.h7.paragraph=
Ba}get YP(){return this.h7.YP}get fgc(){return this.h7.fgc}Wbe(Ba){return this.h7.Wbe(Ba)}t7f(Ba){return this.h7.t7f(Ba)}clone(){const Ba=this.ay.clone();return new x(Ba,this.Jc)}}Object(C.a)(x,"FormattingStewardUsageCollector",n,[781,405]);var A=c(11),H=c(68),E=c(311),L=c(853),M=c(40),F=c(211),J=c(93),I=c(43),K=c(59),N=c(373),G=c(146),P=c(17),S=c(83),W=c(60),X=c(16),Y=c(5),ca=c(45),ha=c(160),ra=c(522),sa=c(374),oa=c(20),ka=c(120),ia=c(47),La=c(63),va=c(198),Ga=c(1545),Oa=c(172),Za=c(33),ja=c(1294),
ba=c(685);class qa{constructor(Ba,Ra,fb,Va,ib,Xa,qb,rb,nb,Tb,Zb=null){this.GD=this._paragraph=null;this.jid=0;this.Ryg=this.kid=null;this.V8=0;this.Csb=this.fgc=this.leftIndent=this.gJ=this.erc=this.KDa=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=Ba;this.ng=Ra;this.nS=fb;this.DC=Va;this.pz=ib;this.bRb=Xa;this.Aia=qb;this.IPb=rb;this.vSa=nb;this.Lpb=Tb;Zb?(u.a(4223818,307,!!Zb.GD),this.GD=Zb.GD.dsa(this.paragraph),this.jid=Zb.Qac,this.kid=Zb.XKf,Zb.KDa&&(this.KDa=new ja.a,
this.KDa.afterSpacing.value=Zb.KDa.afterSpacing.value,this.KDa.beforeSpacing.value=Zb.KDa.beforeSpacing.value),Zb.lineSpacing&&(this.erc=Zb.lineSpacing.clone()),this.V8=Zb.V8,this.fgc=Zb.fgc.clone(),this._textIndent=Zb.textIndent,this._marginLeft=Zb.marginLeft,this._tabStops=Zb.$fc,this.gJ=Zb.gJ,this.leftIndent=Zb.leftIndent,Zb.cba&&(this.Csb=Zb.cba)):(this.GD=new va.a(this.paragraph,0),this.GD.formatting=new Oa.a(this.GD,K.a.nil),Ra=Za.a.rw(Ba),Ra=this.pz.Qr(Ra),this.iLn(Ra),this.rYn(Ba)?(this.bRb.FMn(this.GD.formatting,
Ra),Ba.hasProperty(X.a.Zh)?this.V8=Ba.getValue(X.a.Zh):this.V8=0):this.V8=-1,this.jid=0,this.KDa=this.kid=null,this.Lpb&&(this.KDa=this.bRb.zBa(Ba),this.erc=this.bRb.WLa(Ba),this.gJ=this.bRb.Y3b(Ba),this.leftIndent=this.bRb.qT(Ba)),this.fgc=new N.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(Ba){u.a(4223816,307,!!Ba&&A.ParagraphReader.nc(Ba));this._paragraph=Ba}get YP(){return this.GD.formatting}get Qac(){return this.jid}get XKf(){return this.kid}get xB(){return this.Ryg}get Zs(){return this.V8}set Zs(Ba){u.a(4223817,
307,1===Ba||2===Ba||3===Ba||6===Ba);this.V8=Ba}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get $fc(){return this._tabStops}get lineSpacing(){return this.erc}get cba(){return this.Csb}get oc(){return this.DC}iLn(Ba){const Ra=this.pz.language(Ba);Ra&&this.ng.XYf(this.GD.formatting,Ra,0,Ba.cache.PDb,!1)}rYn(Ba){if(!oa.a.instance.J(10))return!0;Ba=this.oc.rf(this.oc.Ao(Ba));return Ba===ia.StyleReader.d5c||Ba===ia.StyleReader.wordStyleIdNormal||Ba===ia.StyleReader.Zmb||
Ba===ia.StyleReader.styleIdNormal}WYf(Ba){(Ba=h.a.qg(Ba))&&this.ng.g7d(this.GD.formatting,Ba.LCID);return!0}yec(){return!1}$F(Ba){this.ng.$F(this.GD.formatting,Ba);return!0}Ekb(Ba){this.ng.setItalic(this.GD.formatting,Ba);return!0}K3(Ba){this.ng.K3(this.GD.formatting,Ba);return!0}Q7(Ba){this.ng.Q7(this.GD.formatting,Ba);return!0}soa(Ba){this.ng.soa(this.GD.formatting,Ba);return!0}xba(Ba){this.ng.xba(this.GD.formatting,Ba);return!0}S6d(Ba){if(0>=Ba)return!1;this.ng.Wv(this.GD.formatting,Ba);return!0}Y2a(Ba,
Ra){if(!Ba||""===Ba)return!1;if(({VKh:fb}=G.FontUtils.Qfj(Ba)).returnValue)return this.ng.z_(this.GD.formatting,fb.fontName),!0;var fb=!1;const Va=G.FontUtils.jOa(Ba);Ra&&this.Pgb(Va,this.Aia)&&(this.Aia.eea(Ba),fb=!0);if(this.Pgb(Va,this.IPb)||this.Pgb(Va,this.vSa))fb=!0;fb&&this.ng.z_(this.GD.formatting,Va);return fb}Pgb(Ba,Ra){return!!Ra&&Ra.isEnabled&&Ra.Pgb(Ba)}tkf(){this.ng.U3h(this.GD.formatting);return!0}M1f(){this.ng.e7i(this.GD.formatting);return!0}Ks(Ba){var {Box4PasteSteward:Ra}=c(1467);
if(null===Ba||""===Ba)return!1;Ba=Ra.Dxb(Ba);Ra=null;this.cba&&this.cba.hasOwnProperty(Y.a.listLevel.id.toString())&&(Ra=this.cba[Y.a.listLevel.id.toString()]);this.ng.Ks(this.GD.formatting,Ba,Ra);return!0}ewa(Ba){const {Box4PasteSteward:Ra}=c(1467);if(!Ba||""===Ba||!qa.kSl().contains(Ba))return!1;this.ng.ewa(this.GD.formatting,Ra.Dxb(Ba));return!0}mec(Ba){this.ng.mec(this.GD.formatting,Ba);return!0}R_c(Ba){let Ra=0;switch(P.a.mh(Ba)){case "small-caps":Ra=1;break;case "uppercase":Ra=2}this.ng.Yl(this.GD.formatting,
ca.a.capitalization,Ra);return!0}H7(Ba){const {Box4PasteSteward:Ra}=c(1467);if(!Ba||""===Ba)return!1;this.fgc.setValue(X.a.cI,parseInt(Ra.Dxb(Ba),16));return!0}Fkb(Ba){return 0>=Ba?!1:this.y7d(this.oc.d0h(Ba))}Gkb(Ba){this.clearFormatting();this.jid=Ba;return!0}q1e(Ba){var {Box4PasteSteward:Ra}=c(1467),fb=new Map;fb.set("Source","CreateStyleCCP_FormattingSteward");S.Health.instance.recordKpiUsage(ka.a.Bnj,0,ka.a.LB,fb);fb=La.a.aMl(Ba);Ba=[];Ba.push(fb);(Ba=La.a.lOe(Ba,this.paragraph))?(Ra.Ufc=this.oc.Np(),
u.b(593078085,3017,50,"Custom style created via paste.")):(Ra=new Map,Ra.set("Source","CreateStyleCCP_FormattingSteward"),Ra.set("IsStyleNull",(!fb).toString()),Ra=Object.assign(new ha.a,{extendedProperties:Ra}),S.Health.instance.recordKpiFailure(ka.a.Bnj,"UnableToCreateStyle",!1,!0,Ra));return Ba}y7d(Ba){const {Box4PasteSteward:Ra}=c(1467);return Ba&&0<Ba.length&&Ra.Ufc&&Ra.Ufc.wh(Ba)?(this.kid=Ba,!0):!1}C6d(Ba){const {Box4PasteSteward:Ra}=c(1467);return Ba&&0<Ba.length&&Ra.Ufc&&Ra.Ufc.wh(Ba)?(this.Ryg=
Ba,!0):!1}t7f(Ba){if(this.xB){Ba=this.oc.Sx(Ba);if(!Ba)return u.a(41968715,307,!1),!1;(Ba=Ba.wh(this.xB))&&this.ng.Skb(this.GD.formatting,Ba);return!0}return!1}$ga(){return!1}jC(Ba){if(!Ba)return!1;const Ra=parseFloat(P.a.substring(Ba,0,P.a.mh(Ba).indexOf("px")));if(!isNaN(Ra))return this.erc=new ba.a(3,W.a.az(Ra,1)),!0;Ba=parseFloat(P.a.substring(Ba,0,P.a.mh(Ba).indexOf("%")));return isNaN(Ba)?!1:(this.erc=new ba.a(2,Ba/100),!0)}wKb(Ba){let Ra=0;if(!Ba||""===Ba)return!1;switch(Ba){case "left":Ra=
1;break;case "center":Ra=2;break;case "right":Ra=3;break;case "justify":Ra=6}if(!Ra)return!1;this.Zs=Ra;return!0}P7d(Ba){this._textIndent=Ba;return!0}Zga(Ba){this._marginLeft=Ba;return!0}MZf(Ba){this._tabStops=Ba;return!0}CEa(Ba){this.Csb=JSON.parse(Ba);return this.cba?!0:!1}clearFormatting(){this.GD.formatting=new Oa.a(this.GD,K.a.nil);return!0}LUf(){this.V8=0;return!0}Wbe(Ba){var {Box4PasteSteward:Ra}=c(1467);if(!oa.a.instance.J(10))return!1;if(0<this.Qac&&Ra.G1a[this.Qac]){u.a(4223819,307,1<=this.Qac);
u.a(4223820,307,7>=this.Qac);Ra=this.oc.Sx(Ba);if(!Ra)return u.a(4223821,307,!1),!1;Ra=Ra.wh(c(1467).Box4PasteSteward.G1a[this.Qac]);this.nS.pM(Ra,Ba,!1);return!0}if(this.XKf){Ra=this.oc.Sx(Ba);if(!Ra)return u.a(41968716,307,!1),!1;Ra=Ra.wh(this.XKf);this.nS.pM(Ra,Ba,!1);return!0}return!1}clone(){return new qa(this.paragraph,this.ng,this.nS,this.DC,this.pz,this.bRb,this.Aia,this.IPb,this.vSa,this.Lpb,this)}static kSl(){qa.YY||(qa.YY=new ra.a(sa.a.Sj()),qa.YY.add(Ga.a.yellow),qa.YY.add(Ga.a.pmi),qa.YY.add(Ga.a.Qeh),
qa.YY.add(Ga.a.XLh),qa.YY.add(Ga.a.blue),qa.YY.add(Ga.a.red),qa.YY.add(Ga.a.tui),qa.YY.add(Ga.a.teal),qa.YY.add(Ga.a.green),qa.YY.add(Ga.a.purple),qa.YY.add(Ga.a.hri),qa.YY.add(Ga.a.Owi),qa.YY.add(Ga.a.gray),qa.YY.add(Ga.a.O7i),qa.YY.add(Ga.a.black));return qa.YY}}qa.YY=null;Object(C.a)(qa,"FormattingSteward",null,[781,405]);class Ma{C7f(){return!1}Mkf(Ba){return Ba}Rkf(){}CEa(){}m7d(){}aPd(){return!1}get eQd(){return!1}jC(){}$ga(){}G7d(){}get o5i(){return!1}}Object(C.a)(Ma,"NoOpPasteStewardBridge",
null,[230]);var Ia=c(77);class wa{constructor(Ba,Ra){this.KOm=Ba;this.LOm=Ra||"Normal"}}Object(C.a)(wa,"NoteTagInfoBox4",null,[]);const za=Ba=>{const Ra=new Ia.a;for(const fb of Ba)Ba=new wa(fb.KOm,fb.LOm),Ra.add(Ba);return Ra};c.d(O,"a",function(){return pa});class pa{constructor(Ba,Ra,fb=null,Va=null){this.hel=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.RWg=0;this.Ac=Ba;this.Z4=Ra;this.t0=Va||new Ma;this.Jc=fb||m.a.Nef(e.a.uwb,"")}get characterPropertiesEditor(){return null!=
this.Nhg?this.Nhg:this.Nhg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.Nkg?this.Nkg:this.Nkg=a.a.instance.Pa("Box4.IFontService")}get AAa(){return null!=this.Sig?this.Sig:this.Sig=a.a.instance.Pa("Box4.CustomFontService")}get H2k(){return null!=this.qjg?this.qjg:this.qjg=a.a.instance.Pa("Box4.IEmbeddedFontService")}reset(){}get HDc(){return this.Hdf(!1)}Hdf(Ba){u.a(4223770,307,I.OutlineElementReader.Nh(this.Ac));const Ra=M.OutlineElementNavigator.Fe(this.Ac);
M.OutlineElementNavigator.Xd(this.Ac);u.a(4223771,307,!!Ra&&A.ParagraphReader.nc(Ra));Ba=new qa(Ra,pa.wi,pa.iR,pa.oc,pa.ndb,pa.Ifl,this.fontService,this.AAa,this.H2k,this.hel,void 0,Ba);return new x(Ba,this.Jc)}Uaa(){}sDa(){}Iib(){}eva(){}oDa(){}nOa(){}mOa(){}VF(){}UF(){}Fib(){}Eib(){}sOa(){}p1a(){}vDa(){}tDa(){}rOa(){}uDa(){}s1a(){}g$b(Ba){I.OutlineElementReader.Nh(this.Ac)?(pa.Ug.Uta(this.Ac,!0),M.OutlineElementNavigator.Wr(this.Ac,!1,!1)):J.OutlineReader.Aw(this.Ac)?F.OutlineNavigator.f7(this.Ac)?
Ba?(this.Ac.Hg(),pa.xK.E5(this.Ac,!1)):pa.Ug.WIb(this.Ac):pa.xK.E5(this.Ac,!1):u.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ac.Le)}WIc(Ba){let Ra=null;if(Ba&&Ba.p7&&Ba.cultureName)try{Ra=Object.assign(new L.a,{languageId:h.a.qg(Ba.cultureName).LCID})}catch(fb){u.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Ba.cultureName,fb)}Ra||null==this.Z4||(Ra=Object.assign(new L.a,{languageId:this.Z4}));return Ra}get jU(){return this.RWg}set jU(Ba){this.RWg=Ba}gsd(){}Ibe(){}sXe(){}get f_b(){return!1}get oyb(){return!1}Ttm(Ba){let Ra=
1;if(Ba.Ifi){var fb=0;switch(Ba.listStyleType){case 1:Ra=0;break;case 7:Ra=1;break;case 8:Ra=2;break;case 9:Ra=3;break;case 10:Ra=4;break;case 11:Ra=5}}else switch(fb=1,Ba.listStyleType){case 1:Ra=0;break;case 3:Ra=1;break;case 4:Ra=2;break;case 5:Ra=3}let Va;fb=(Va=H.ListReader.wZ)?E.a.KP(fb,Ra,za(Ba.vna),Ba.listId,Ba.listLevel,Ba.levelText,Ba.font):E.a.KP(fb,Ra,za(Ba.vna));3!==Ba.xr&&(fb.b4=Ba.xr);Ba.Ifi&&!Ba.Gbi&&(fb.$z=Va&&0<Ba.listId&&0<=Ba.listLevel&&!Ba.Vac?Ba.Ffc:Ba.iRk);!fb.ur||3!==fb.listStyle&&
5!==fb.listStyle||(fb.Zs="right");v.a.qOc&&((Ba=Ba.cxf)&&fb.propertySet.Bs(Ba),fb.h2b=!0);this.t0.m7d(this.Ac);return fb}Taa(){}Qaa(){}Saa(){}Raa(){}Paa(){}Oaa(){}static get Ug(){return null!=pa.Lpg?pa.Lpg:pa.Lpg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get xK(){return null!=pa.Apg?pa.Apg:pa.Apg=a.a.instance.resolve("Box4.IOutlineEditor")}static get wi(){return null!=pa.qlg?pa.qlg:pa.qlg=a.a.instance.resolve("Box4.IFormattingEditor")}static get iR(){return null!=pa.cug?pa.cug:pa.cug=
a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get oc(){return null!=pa.Hug?pa.Hug:pa.Hug=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get ndb(){return null!=pa.slg?pa.slg:pa.slg=a.a.instance.resolve("Box4.IFormattingReader")}static get Ifl(){return null!=pa.tlg?pa.tlg:pa.tlg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}pa.Cf=null;Object(C.a)(pa,"Box4PasteStewardBase",null,[761,373,374])},1678:function(C,O,c){C=c(0);var l=c(44),e=c(8),a=c(2),h=c(42),m=c(355),
v=c(23);class u{constructor(I,K,N,G){this.Uye=null;this.R9c=G;this.Cqa=I;this.Dqa=K;this.gY=N;this.w1g=this.KFb.jWn;I=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.wNj=I[0];this.vNj=I[1]}get KFb(){return this.Uye||(this.Uye=v.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Zeb(){return CommonUIStrings.l_OICErrorHelpLink}get r0c(){return this.w1g}get Hqi(){return this.wNj}get Gqi(){return this.vNj}get Fqi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.w1g?
3:2}get GFc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get xwd(){return!!this.Dqa}get HFc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get PKa(){return CommonUIStrings.l_DefaultDialogTitle}xQf(I){this.gTc(I)}Swf(I){this.gTc(I)}gTc(I){let K=10;this.Dqa&&1===I&&(this.Dqa(this.gY),K=1);this.Cqa&&this.Cqa(this.gY);this.WQ(K)}AGb(){m.Redirect.showHelp("OICFailure");this.WQ(2)}pFf(){this.KFb.Pli();this.WQ(4)}WQ(I){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.R9c,I);a.AFrameworkApplication.zYc(h.a.MCi,this.R9c,I)}dispose(){this.gY=this.Cqa=this.Dqa=null}}Object(C.a)(u,"AOICErrorDialog",null,[10]);var n=c(29),x=c(142);class A extends u{constructor(I,K,N,G){super(I,K,N,G);this.G8a=this.KE=null;I=document.createElement("span");I.id="errorMessageText";I.innerText=this.errorMessage;I.appendChild(document.createElement("br"));I.appendChild(document.createElement("br"));this.KE=document.createElement("a");this.KE.href="#";this.KE.innerText=this.Zeb;I.appendChild(this.KE);
n.a.addHandler(this.KE,"click",Object(l.a)(this,this.AGb,"oicErrorHelpLinkHandler"));K=new x.StandardDialog;K.lg=this.id;this.r0c?(N=document.createElement("span"),G=document.createElement("span"),N.innerText=this.Hqi,G.innerText=this.Gqi,this.G8a=document.createElement("a"),this.G8a.href="#",this.G8a.innerText=this.Fqi,I.appendChild(document.createElement("br")),I.appendChild(N),I.appendChild(this.G8a),I.appendChild(G),n.a.addHandler(this.G8a,"click",Object(l.a)(this,this.pFf,"oicErrorMacOfferLinkHandler"))):
this.xwd&&(I.appendChild(document.createElement("br")),I.appendChild(document.createElement("br")),N=document.createElement("span"),N.innerText=this.GFc,I.appendChild(N));this.xwd?(K.Gd=1,K.We(1,this.HFc)):K.Gd=0;K.Tv(this.PKa,null,this.icon,Object(l.a)(this,this.Swf,"legacyOICErrorDialogHandler"),I);K.J3("errorMessageText")}dispose(){this.KE&&(n.a.removeHandler(this.KE,"click",Object(l.a)(this,this.AGb,"oicErrorHelpLinkHandler")),this.KE=null);this.G8a&&(n.a.removeHandler(this.G8a,"click",Object(l.a)(this,
this.pFf,"oicErrorMacOfferLinkHandler")),this.G8a=null);super.dispose()}}Object(C.a)(A,"OICErrorDialog",u,[]);class H{constructor(I,K,N){this.Cqa=K;this.Dqa=I;this.gY=N}get id(){return"OICErrorDialogWithDownload"}get mGh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Zeb(){return CommonUIStrings.l_OICErrorHelpLink}get GFc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get HFc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get PKa(){return CommonUIStrings.l_DefaultDialogTitle}xQf(I){this.gTc(I)}Swf(I){this.gTc(I)}gTc(I){let K=
10;1===I&&(this.Dqa(this.gY),K=1);this.Cqa&&this.Cqa(this.gY);this.WQ(K)}AGb(){m.Redirect.showHelp("OICFailure");this.WQ(2)}WQ(I){a.AFrameworkApplication.zYc(h.a.NCi,3,I)}dispose(){this.gY=this.Dqa=this.Cqa=null}}Object(C.a)(H,"AOICErrorDialogWithDownload",null,[10]);class E extends H{constructor(I,K,N){super(I,K,N);this.KE=null;I=document.createElement("span");I.id="errorMessageText";I.innerText=this.mGh;I.appendChild(document.createElement("br"));I.appendChild(document.createElement("br"));this.KE=
document.createElement("a");this.KE.href="#";this.KE.innerText=this.Zeb;I.appendChild(this.KE);n.a.addHandler(this.KE,"click",Object(l.a)(this,this.AGb,"oicErrorHelpLinkHandler"));I.appendChild(document.createElement("br"));I.appendChild(document.createElement("br"));K=document.createElement("span");K.innerText=this.GFc;I.appendChild(K);K=new x.StandardDialog;K.lg=this.id;K.Gd=1;K.We(1,this.HFc);K.Tv(this.PKa,null,this.icon,Object(l.a)(this,this.Swf,"legacyOICErrorDialogHandler"),I);K.J3("errorMessageText")}dispose(){this.KE&&
(n.a.removeHandler(this.KE,"click",Object(l.a)(this,this.AGb,"oicErrorHelpLinkHandler")),this.KE=null);super.dispose()}}Object(C.a)(E,"OICErrorDialogWithDownload",H,[]);var L=c(154);class M extends u{constructor(I,K,N,G){super(I,K,N,G);K={["errorMessage"]:this.errorMessage};K.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Zeb,["onExecute"]:P=>{this.AGb(P)}};this.r0c?(K.macOfficePreLinkText=this.Hqi,K.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Fqi,
["onExecute"]:P=>{this.pFf(P)}},K.macOfficePostText=this.Gqi):this.xwd&&(K.errorFileDownloadOffer=this.GFc);I=new L.a(!1,!1,!0);this.xwd?(I.Gd=1,I.We(1,this.HFc)):I.Gd=0;I.lg=this.id;K={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:K};I.Vh(this.PKa,Object(l.a)(this,this.xQf,"reactOICErrorDialogHandler"),K)}}Object(C.a)(M,"ReactOICErrorDialog",u,[]);class F extends H{constructor(I,K,N){super(I,K,N);K={["errorMessage"]:this.mGh,["errorFileDownloadOffer"]:this.GFc};K.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Zeb,["onExecute"]:G=>{this.AGb(G)}};I=new L.a(!1,!1,!0);I.Gd=1;I.We(1,this.HFc);I.lg=this.id;K={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:K};I.Vh(this.PKa,Object(l.a)(this,this.xQf,"reactOICErrorDialogHandler"),K)}}Object(C.a)(F,"ReactOICErrorDialogWithDownload",H,[]);c.d(O,"a",function(){return J});class J{constructor(){this.vqa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Rb.NA}xNk(I,K,N){this.vqa?new M(I,K,null,N):new A(I,K,null,N)}yNk(I,
K,N){this.vqa?new F(I,K,N):new E(I,K,N)}zNk(I,K,N,G,P){const {ReactOICErrorDialogWithTrial:S}=c(1772),{OICErrorDialogWithTrial:W}=c(1773);this.vqa?new S(I,K,N,null,G,P):new W(I,K,N,null,G,P)}static get instance(){return J._instance||(J._instance=new J)}}J._instance=null;Object(C.a)(J,"OICErrorDialogFactory",null,[1090])},1679:function(C,O,c){c.r(O);C=c(0);var l=c(332),e=c(1754),a=c(932),h=c(373),m=c(2),v=c(59),u=c(23),n=c(104),x=c(84),A=c(67),H=c(1400),E=c(126),L=c(37),M=c(15),F=c(275),J=c(106),I=
c(8),K=c(243),N=c(123),G=c(64),P=c(320),S=c(14),W=c(33),X=c(3),Y=c(9),ca=c(130),ha=c(548),ra=c(53),sa=c(1611),oa=c(1610),ka=c(642),ia=c(238);class La extends ia.a{constructor(wa,za,pa,Ba,Ra,fb){super();this.init(wa);this.ll("DummyClipboardOperation");this.Bfb(m.AFrameworkApplication.ya,za,Ba,Ra,fb);this._context=pa;this.dr=8;this.ooa()}run(){this.$7a=!0;this.g_c(this._context);this.W1a();this.dr=32}}Object(C.a)(La,"DummyClipboardOperation",ia.a,[]);ia=c(1519);class va extends ia.a{constructor(wa,
za,pa,Ba,Ra){super(wa,za,Ra);this.Yj=pa;this.rHe=Ba}phc(wa){let za;if(this.mP&&!wa)return I.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Ksa:null};za=null;if(this.rHe&&!this.mP){const pa=this.properties.ia(J.a.oFi,"");pa&&(za=this.Yj.ejb(pa))}za||(za=this.Yj.ejb(wa));return{returnValue:!0,Ksa:za}}}Object(C.a)(va,"HtmlStringImportStrategy",ia.a,[]);var Ga=c(1755);class Oa extends Ga.a{constructor(wa,za,pa,Ba,Ra){super(wa,za,pa,Ba,Ra)}LXh(){return this.properties.ia(J.a.$ac,
"")}phc(wa){m.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.M1g){if(this.Yj)return wa=this.Yj.iLf(wa,!0),{returnValue:!0,Ksa:wa};I.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.phc(wa)}SQc(wa){wa=super.SQc(wa);return wa.length&&" "!==wa?wa:"\u00a0"}}Object(C.a)(Oa,"MultiLinePlainTextImportStrategy",Ga.a,[]);class Za extends ia.a{constructor(wa,za,pa){super(wa,za,pa)}phc(wa){({ClipboardActor:za}=
c(1679));if(this.mP&&!wa)return I.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Ksa:null};var za=za.P5m;za.innerText=wa;return{returnValue:!0,Ksa:za}}}Object(C.a)(Za,"PlainTextImportStrategy",ia.a,[]);var ja=c(96),ba=c(66);class qa{constructor(wa){this.qua=this.ktf=!1;this.ida=wa}nHi(){this.ktf||(this.ktf=!0,this.qua=!1,this.ida.prepareForPaste(()=>{this.qua=!0}));return this.qua}$ej(){this.ktf=!1;const wa=this.ida.paste();return wa?wa.hasChildNodes()?{returnValue:!0,Iwd:wa}:
(I.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),qa.Kc.Zb(ja.a.a0,{["Reason"]:ba.a.G8e}),{returnValue:!1,Iwd:wa}):(I.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),qa.Kc.Zb(ja.a.wzb,{["Reason"]:ba.a.v4f}),{returnValue:!1,Iwd:wa})}static get Kc(){return E.a.instance}}Object(C.a)(qa,"SystemClipboardImportStrategy",null,[710]);var Ma=c(261);c.d(O,"ClipboardActor",function(){return Ia});class Ia{constructor(wa,za,pa,Ba,Ra,fb,Va,ib,Xa,qb,rb,nb,Tb,Zb,Hb,Sa,ua,Fa){this.C7c=null;
this.XHa=0;this.wbd=this.sxc=!1;this.$nb=l.a.On;this.J0c=()=>{const Pa=Array(1);Pa.push("PasteRecoveryFloatie");var Ea=this.MRj.RLa();Ea=Object.assign(new e.a,{x:Ea.x,y:Ea.y});this.UK.showFloatie(Ea,Pa,1);return 32};this.jCb=()=>{this.UK.QZ&&this.UK.tw();return 32};this.UJi=(Pa,Ea,lb,zb,Xb)=>{if(1===lb)return 32;Xb[a.a.On]=!1;return 32};this.a1k=(Pa,Ea,lb,zb,Xb,ub)=>{I.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Pb=ub.DataTransfer;ub=Pb.getData("text/html");Pb=Pb.getData("text/plain");
let yc=!1;const bc=new h.DictionaryPropertySet;0<ub.length?(I.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),bc.setValue(J.a.PQ,ub),yc=!0):0<Pb.length&&(I.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),bc.setValue(J.a.$ac,Pb),yc=!0);if(yc){const Ka=this.yx.J(Ea);return this.jvd.create(Pa,Ea,Ka,new K.a(()=>this.ZDc(Ka,bc)),lb,zb,Xb,bc)}return null};this.KPf=(Pa,Ea,lb,zb,Xb)=>{if(Ea="object"===typeof Xb?Xb:null)this.mVb?this.fKn(Pa,this.XHa,
Ea):Pa===X.a.$1d?(Pa=this.XHa!==X.a.reformatPastedContent&&this.XHa!==X.a.aPa&&this.XHa!==X.a.Iva,Ea[this.$nb]=this.XHa===X.a.reformatPastedContent||Pa):Pa===X.a.a2d?Ea[this.$nb]=this.XHa===X.a.aPa:Pa===X.a.GPf&&(Ea[this.$nb]=this.XHa===X.a.Iva);return 32};this.gW=(Pa,Ea,lb,zb,Xb,ub)=>{if(m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)){if((m.AFrameworkApplication.protectFile||m.AFrameworkApplication.kM)&&!m.AFrameworkApplication.izb)return new La(Pa,
Ea,lb,zb,Xb,ub)}else if(m.AFrameworkApplication.protectFile)return new La(Pa,Ea,lb,zb,Xb,ub);if(Ma.a.ufa(lb)&&Ma.a.K6b())return new La(Pa,Ea,lb,zb,Xb,ub);let Pb=this.yx.J(Ea);1!==zb&&Pb&1&&(this.XHa=Ea);if(1!==zb){var yc=Object(N.a)(89,ub)?ub:null;ub?(Pb&1&&(this.C7c=yc),yc=yc?yc.ia(J.a.OQ,0):0,Ea===X.a.paste&&yc===X.a.lWa?Pb=this.yx.J(X.a.Q1):Ea===X.a.t7&&yc===X.a.Rab&&(Pb=this.yx.J(X.a.N_d))):!ub&&Pb&4096&&(ub=this.C7c,yc=Object(N.a)(89,ub)?ub:null)&&(yc=yc.ia(J.a.XUc,v.a.nil),I.ULS.sendTraceTag(575255109,
307,50,"Reformatting operation occurred. CorrelationId: {0}",yc))}return this.jvd.create(Pa,Ea,Pb,new K.a(()=>this.ZDc(Pb,ub)),lb,zb,Xb,ub)};this.$an=(Pa,Ea,lb,zb,Xb)=>this.CVe(Pa,Ea,lb,Xb);this.Zan=(Pa,Ea,lb,zb,Xb)=>this.CVe(Pa,Ea,lb,Xb);this.Yan=(Pa,Ea,lb,zb,Xb)=>this.CVe(Pa,Ea,lb,Xb);this.FVd=(Pa,Ea,lb,zb,Xb,ub)=>{ub=W.a.Uc(ra.a.instance.ib.kb.Qa.node,ub);return this.gW(Pa,Ea,lb,zb,Xb,ub)};this.rAj=wa;this.ida=za;this.nd=pa;this.Yj=Ba;this.ga=fb;this.$7c=qb;this.XOb=rb;this.Wd=nb;this.eg=Tb;this.Ub=
Xa;this.lVb=Zb;this.mVb=Hb;this.MRj=Sa;this.UK=ua;this.yve=Fa;ib&&(this.sxc=ib.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.wbd=this.mVb&&ib.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.yx=new P.a;this.yx.Z(X.a.paste,257);this.yx.Z(X.a.t7,8449);this.yx.Z(X.a.Q1,1);this.yx.Z(X.a.YZa,1);this.yx.Z(X.a.Svb,1);this.yx.Z(X.a.Aza,1);this.yx.Z(X.a.oNd,513);this.yx.Z(X.a.reformatPastedContent,4097);this.yx.Z(X.a.aPa,12289);this.yx.Z(X.a.Iva,131073);this.yx.Z(X.a.qLf,7);this.yx.Z(X.a.pLf,
1);this.yx.Z(X.a.N_d,8193);this.yx.Z(X.a.copy,272);this.yx.Z(X.a.Wzc,16);this.yx.Z(X.a.cut,304);this.yx.Z(X.a.FUe,48);this.yx.Z(X.a.EVd,64);this.yx.Z(X.a.FVd,64);this.yx.Z(X.a.showPlaceholderGlossary,65536);this.yx.Z(X.a.Z5e,1);this.wbd&&this.yx.Z(X.a.ijb,this.yx.J(X.a.N_d))}get oli(){return this.XHa}set oli(wa){this.XHa=wa}get wQa(){return null!=this.csg?this.csg:this.csg=u.a.instance.Pa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.xsg?this.xsg:this.xsg=u.a.instance.Pa("Common.Utils.Telemetry.ITelemetry")}get jvd(){return this.rAj.value}get W7n(){return this.ida}Vb(){this.ga.gb(X.a.Jen,
S.a.application,this.UJi,97);this.ga.gb(X.a.Ken,S.a.application,this.UJi,97);this.ga.gb(X.a.$1d,S.a.application,this.KPf,97);this.ga.gb(X.a.a2d,S.a.application,this.KPf,97);this.ga.gb(X.a.GPf,S.a.application,this.KPf,97);this.ga.vS(X.a.FUe,S.a.view,this.gW,1028);this.ga.U$a(X.a.Wzc,S.a.view,this.gW);this.ga.vS(X.a.Z5e,S.a.view,this.a1k,1028);this.ga.vS(X.a.Q1,S.a.view,this.gW,1028);this.ga.vS(X.a.YZa,S.a.view,this.gW,1028);this.ga.vS(X.a.Svb,S.a.view,this.gW,1028);this.ga.vS(X.a.Aza,S.a.view,this.gW,
1028);this.lVb&&this.ga.gb(X.a.lWa,S.a.view,this.Yan,1028);this.mVb&&this.ga.gb(X.a.Rab,S.a.view,this.Zan,1028);this.ga.vS(X.a.paste,S.a.view,this.gW,1028);this.ga.vS(X.a.t7,S.a.view,this.gW,1028);this.ga.vS(X.a.N_d,S.a.view,this.gW,1028);this.ga.vS(X.a.pLf,S.a.view,this.gW,1028);this.ga.vS(X.a.qLf,S.a.view,this.gW,1028);this.ga.vS(X.a.reformatPastedContent,S.a.view,this.gW,1028);this.ga.vS(X.a.aPa,S.a.view,this.gW,1028);this.ga.pa(X.a.fJb,S.a.view,n.ActionManager.Of);this.ga.pa(X.a.uFi,S.a.view,
n.ActionManager.Of);this.ga.pa(X.a.rFi,S.a.view,n.ActionManager.Of);this.ga.pa(X.a.sFi,S.a.view,n.ActionManager.Of);this.ga.pa(X.a.tFi,S.a.view,n.ActionManager.Of);this.ga.pa(X.a.qFi,S.a.view,n.ActionManager.Of);this.ga.U$a(X.a.EVd,S.a.view,this.gW);this.ga.U$a(X.a.FVd,S.a.view,this.FVd);this.ga.U$a(X.a.oNd,S.a.view,this.gW);this.ga.U$a(X.a.showPlaceholderGlossary,S.a.view,this.gW);this.wbd&&(this.ga.gb(X.a.VYb,S.a.view,this.$an,1028),this.ga.vS(X.a.ijb,S.a.view,this.gW,1028));this.ga.pa(X.a.Dxh,
S.a.view,n.ActionManager.Of);this.ga.pa(X.a.cyh,S.a.view,n.ActionManager.Of);this.yve&&(this.ga.gb(X.a.J0c,S.a.view,this.J0c,96),this.ga.gb(X.a.jCb,S.a.view,this.jCb,96))}y3(){if(this.Ub){const wa=this.Ub.re(ca.AppFrame.sF);this.wbd&&wa.bindAction(x.KeyInputManager.lc(A.a.pnb,x.KeyInputManager.Mh|4),X.a.VYb)}else I.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}fKn(wa,za,pa){switch(za){case X.a.aPa:case X.a.t7:case X.a.ijb:za=X.a.a2d;break;case X.a.Iva:za=
X.a.GPf;break;default:za=X.a.$1d}pa[this.$nb]=wa===za}BFl(){const wa=Object(N.a)(89,this.C7c)?this.C7c:null;return wa?wa.ia(J.a.XUc,v.a.nil):v.a.nil}CVe(wa,za,pa,Ba){if(1===pa){if(!Object(N.a)(ha.a,za)||!this.$7c||Ma.a.ufa(za)&&Ma.a.K6b())return 8;pa=new K.a(()=>this.ZDc(this.yx.J(X.a.Q1),Ba));const Ra=this.$7c.create(pa,Object(G.a)(89,Ba));pa=new oa.a(m.AFrameworkApplication.K,H.a.instance,pa,E.a.instance,Ra,this.XOb);return sa.a.alh(za,pa)?32:8}if(2===pa){if(this.qVn(Y.App.vVa))return this.lWa(wa);
Y.App.jcc(()=>{this.lWa(wa)});return 32}return 2}lWa(wa){if(!this.Wd)return I.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var za=this.Wd.KLa();if(!za)return I.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;za=za.Hn;if(!za)return I.ULS.sendTraceTag(592454659,307,10,"No document"),8;I.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",wa);this.eg.Z2k(wa);wa=L.a.qzb(za,"paste");za=this.eg.bYk();I.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",
za);if(wa)return I.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),32;this.HUl();I.ULS.sendTraceTag(592454662,307,10,"execCommand failed");return 8}HUl(){this.wQa&&(this.wQa.aLb(),ka.a.KTd(!0,ra.a.instance,M.a.dF));if(this.telemetry){const wa=this.telemetry.o1c();wa.WXb("CallExecCommandPasteOperation");wa.fail("call to execCommand('paste') failed",!0);this.telemetry.sea(wa)}}qVn(wa){let za=!1;this.Ub?this.Ub.pg?za=!this.Ub.Jqf(this.Ub.pg.name):I.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):
I.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(za){I.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Ub.pg.name);if(1>wa)return I.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Ub.GKh();return!1}return!0}ZDc(wa,za){return wa&256?new qa(this.W7n):wa&2?wa&4096?new va(za,this.nd,this.Yj,Y.App.instance.aOc,Y.App.instance.bQa):new Za(za,this.nd,Y.App.instance.bQa):za.hasProperty(J.a.$ac)?new Oa(za,this.nd,this.Yj,this.sxc,Y.App.instance.bQa):new va(za,
this.nd,this.Yj,Y.App.instance.aOc,Y.App.instance.bQa)}static get P5m(){return F.a.jId("Box4PasteScratchPad")}$kh(wa,za,pa,Ba){const Ra=m.AFrameworkApplication.protectFile||m.AFrameworkApplication.kM;return m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&Ra&&!m.AFrameworkApplication.izb?8:(wa=this.gW(null,wa?X.a.cut:X.a.copy,za,1,pa,Ba))?wa.response:8}}Object(C.a)(Ia,"ClipboardActor",null,[])},1685:function(C,
O,c){c.r(O);C=c(0);var l=c(17),e=c(1885),a=c(1734);class h extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(C.a)(h,"IsMeAtMentionOptionalAttributes",a.a,[]);class m{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(C.a)(m,"DeltaAttributes",null,[]);var v=c(1546),u=c(11),n=c(76),x=c(16),A=c(8),H=c(1601);c.d(O,"ACommentFormatTranslator",function(){return E});
class E{constructor(L){this.wf=L}Adk(L,M){const F=u.ParagraphReader.text(M);let J=null,I=null,K=null,N=0;var G=0,P=!1;let S="";for(M.qa||F&&F.length&&"\n"!==F||A.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");N<M.qa.length;){const X=M.qa.J(N),Y=X.cp;var W=X.formatting?X.formatting.hn:null;S+=l.a.substring(F,P?G+1:G,Y);X.vl&&J&&(G=new e.a,G.fullName=S.startsWith("@")?S.substr(1):S,H.a(J,G),P=new h,H.c(J,P,G),L.pof(S,G,P,!0),S="",J=null);X.vl&&I&&(G=
K||new m,G.link=I.url,L.m$h(S,G),S="",I=null);J&&I||""===S||(this.wf.kwb&&K?(L.y$h(S,K),K=null):L.kfa(S),S="");X.hyperlink&&(X.hyperlink.Jx?J=X.hyperlink:X.hyperlink.url&&(I=X.hyperlink));this.wf.kwb&&W&&(K=new m,K.weight=W.ia(x.a.bold,!1)?v.a.FAf:0,K.italic=W.ia(x.a.italic,!1),K.underline=W.ia(x.a.underline,!1),K.strikethrough=W.ia(x.a.strikethrough,!1),this.wf.ADb&&(W.hasProperty(x.a.highlight)&&(G=W.getValue(x.a.highlight),K.highlight=n.a.PC(G)),W.hasProperty(x.a.fontColor)&&(W=W.getValue(x.a.fontColor),
K.color=n.a.PC(W))));G=Y;P=!!X.blob;N++}}}E.khk="_@_";E.lhk="Z";Object(C.a)(E,"ACommentFormatTranslator",null,[424])},1696:function(C,O,c){C=c(0);var l=c(154),e=c(17),a=c(27),h=c(23),m=c(2),v=c(236),u=c(159);class n{static get vg(){return l.a.Rx(n.tl,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}n.tl="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(C.a)(n,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var x=c(18),A=c(3);c.d(O,"a",function(){return H});class H extends l.a{constructor(E,L,M){super();this.eIg=!1;this.fV=null;this.Kel=F=>{switch(F){case 1:this.ga.processAction(x.a.eLh,2);break;case 2:this.ga.processAction(x.a.fLh,2);break;case 0:this.ga.processAction(x.a.gLh,2)}};this.pp=L;this.WK=!1;this.WQb=H.nel;this.Dh=E;this.ga=M;this.lg="FootnoteEndnoteFormattingOptionsDialog";this.Gd=2;this.vg=n.vg;this.We(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.We(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Vh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.Kel,null);this.Seb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.fV}set fontName(E){this.fV=E;if(E=document.getElementById("FontSizeComboBox"))E.focus(),this.Dh.updateCommandUI()}get fontSize(){return this.WQb}get Seb(){return this.eIg}set Seb(E){this.eIg=E;this.L7m()}eU(){this.otd("FontStyleComboBox",
"FontPlaceholder",x.a.EDd.toString(),x.a.DJi.toString(),x.a.kVc.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.otd("FontSizeComboBox","FontPlaceholder",x.a.FDd.toString(),A.a.eWc.toString(),x.a.lVc.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const E=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.GZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),L=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.GZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.$zc("NoStyle","IndentPlaceholderStyles",
x.a.iLh.toString(),x.a.EJi.toString(),E,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.$zc("FirstLineIndent","IndentPlaceholderStyles",x.a.hLh.toString(),x.a.mPf.toString(),L,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}otd(E,L,M,F,J,I,K){M=v.c(E,M,!0,!0,F,J,e.a.Ff(I),!0,K);this.Exd(E,L,M,"Medium")}$zc(E,L,M,F,J,I,K){M=v.g(E,M,F,e.a.Ff(J),e.a.Ff(I),K);this.Exd(E,L,M,"Large",I)}Exd(E,L,M,F,J=null){L=document.getElementById(L);
this.pp.rza(E,M);M=this.pp.yYa(E,F);J&&a.a.Wrd(M,String.format("{0}Label",E),J);L.appendChild(M);this.pp.iM(E)}L7m(){this.pp.iM("NoStyle");this.pp.iM("FirstLineIndent")}dispose(){this.WK||(this.pp.VA("FontStyleComboBox"),this.pp.VA("FontSizeComboBox"),this.pp.VA("NoStyle"),this.pp.VA("FirstLineIndent"),this.WK=!0);this.Dh.updateCommandUI();super.dispose()}static get GQa(){return h.a.instance.resolve("Common.IStandaloneRootController").M3}static Sul(){return new H(u.App.En,H.GQa,m.AFrameworkApplication.ya)}static Rul(){return H.Sul()}}
H.nel=-1;Object(C.a)(H,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1723:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(e,a){this.Gi=this.lfd=0;this.DHg=a;this.KYj=e}Whb(){return this.lfd-this.Gi>=this.KYj}reset(){this.Gi=this.lfd=this.DHg()}update(){this.lfd=this.DHg()}}Object(C.a)(l,"TimeBasedTaskYieldStrategy",null,[371])},1734:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(){this.contentId=""}}Object(C.a)(l,"AtMentionOptionalAttributes",
null,[])},1757:function(C,O){Object.defineProperty(O,"__esModule",{value:!0});O.ObjectSchemaType=O.ObjectSemantic=O.SequenceType=O.InputMethod=O.CommandSurface=O.IntentIds=void 0;(function(c){c.Logging="Logging";c.KeyPhrases="KeyPhrases";c.ZeroTermMenu="ZeroTermMenu"})(O.IntentIds||(O.IntentIds={}));(function(c){c.Canvas="Canvas";c.KeyboardShortcut="KeyboardShortcut";c.ClassicRibbon="ClassicRibbon";c.SimplifiedRibbon="SimplifiedRibbon";c.ContextMenu="ContextMenu";c.Floatie="Floatie";c.SearchBox="SearchBox";
c.QuickAccessToolbar="QuickAccessToolbar"})(O.CommandSurface||(O.CommandSurface={}));(function(c){c.Unknown="Unknown";c.Keyboard="Keyboard";c.Mouse="Mouse";c.Touch="Touch";c.Pen="Pen";c.Voice="Voice"})(O.InputMethod||(O.InputMethod={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(O.SequenceType||(O.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";c.CanvasContext="CanvasContext"})(O.ObjectSemantic||
(O.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext"})(O.ObjectSchemaType||(O.ObjectSchemaType={}))},1758:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.SearchSuggestionAnnotation=O.SearchSuggestionSignal=void 0;const l=c(259);class e{constructor(h){l.SchemaObject.assign(e,this,h)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(h){return l.SchemaObject.matchesTypesFor(h,
[e.getTypeName()])}}O.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(h){l.SchemaObject.assign(a,this,h)}get metadata(){return this.M_}set metadata(h){this.M_=h}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(h){return l.SchemaObject.matchesTypesFor(h,[a.getTypeName()])}}O.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1766:function(C,
O,c){var l=this&&this.nR||(Object.create?function(a,h,m,v){void 0===v&&(v=m);var u=Object.getOwnPropertyDescriptor(h,m);if(!u||("get"in u?!h.oG:u.writable||u.configurable))u={enumerable:!0,get:function(){return h[m]}};Object.defineProperty(a,v,u)}:function(a,h,m,v){void 0===v&&(v=m);a[v]=h[m]}),e=this&&this.__exportStar||function(a,h){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(h,m)||l(h,a,m)};Object.defineProperty(O,"__esModule",{value:!0});e(c(1767),O);e(c(1768),O);e(c(1769),
O);e(c(1770),O);C.exports.ContractEntityAnnotation||Object.defineProperty(C.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return C.exports.ContractEntityAnnotation}});C.exports.ContractEntitySignal||Object.defineProperty(C.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return C.exports.ContractEntitySignal}})},1767:function(C,O){Object.defineProperty(O,"__esModule",{value:!0})},1768:function(C,O){Object.defineProperty(O,"__esModule",{value:!0})},1769:function(C,O,
c){Object.defineProperty(O,"__esModule",{value:!0});O.ContractEntityAnnotation=void 0;const l=c(259);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}O.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),
B_:e.getBaseTypes()}},1770:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.ContractEntitySignal=void 0;const l=c(259);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}O.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1772:function(C,O,c){c.r(O);
c.d(O,"ReactOICErrorDialogWithTrial",function(){return h});C=c(0);var l=c(44);O=c(1625);var e=c(355),a=c(154);class h extends O.a{constructor(m,v,u,n,x,A){super(m,v,u,n,x,A);v={["errorMessage"]:this.lGh,["offerString"]:this.uwi};m=new a.a(!1,!1,!0);this.e6i?(m.Gd=1,v.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Zeb,["onExecute"]:()=>{e.Redirect.showHelp(this.l6h)}}):(m.Gd=4,m.We(2,this.M7h));m.We(1,this.$pd);m.lg=this.id;v={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:v};
m.Vh(this.PKa,Object(l.a)(this,this.nin,"reactOICErrorDialogWithTrialHandler"),v)}}Object(C.a)(h,"ReactOICErrorDialogWithTrial",O.a,[])},1773:function(C,O,c){c.r(O);c.d(O,"OICErrorDialogWithTrial",function(){return a});C=c(0);var l=c(44);O=c(1625);var e=c(142);class a extends O.a{constructor(h,m,v,u,n,x){super(h,m,v,u,n,x);h=document.createElement("span");h.innerText=this.lGh;h.appendChild(document.createElement("br"));h.appendChild(document.createElement("br"));m=document.createElement("span");m.innerText=
this.uwi;h.appendChild(m);m=new e.StandardDialog;this.e6i?(m.Gd=1,m.DOe(this.Zeb,this.l6h)):(m.Gd=4,m.We(2,this.M7h));m.We(1,this.$pd);m.lg=this.id;m.Tv(this.PKa,null,this.icon,Object(l.a)(this,this.ptm,"legacyOICErrorDialogWithTrialHandler"),h)}}Object(C.a)(a,"OICErrorDialogWithTrial",O.a,[])},1775:function(C,O,c){var l=this&&this.nR||(Object.create?function(a,h,m,v){void 0===v&&(v=m);Object.defineProperty(a,v,{enumerable:!0,get:function(){return h[m]}})}:function(a,h,m,v){void 0===v&&(v=m);a[v]=
h[m]}),e=this&&this.__exportStar||function(a,h){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(h,m)||l(h,a,m)};Object.defineProperty(O,"__esModule",{value:!0});e(c(1776),O);e(c(1777),O);C.exports.SearchProviderAnnotation||Object.defineProperty(C.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return C.exports.SearchProviderAnnotation}});C.exports.SearchProviderSignal||Object.defineProperty(C.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return C.exports.SearchProviderSignal}})},
1776:function(C,O){Object.defineProperty(O,"__esModule",{value:!0})},1777:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});O.SearchProviderAnnotation=O.SearchProviderSignal=void 0;const l=c(259);class e{constructor(h){l.SchemaObject.assign(e,this,h)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(h){return l.SchemaObject.matchesTypesFor(h,[e.getTypeName()])}}O.SearchProviderSignal=e;e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(h){l.SchemaObject.assign(a,this,h)}get metadata(){return this.M_}set metadata(h){this.M_=h}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(h){return l.SchemaObject.matchesTypesFor(h,[a.getTypeName()])}}O.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1814:function(C,O,c){function l(ma){Type.registerNamespace("WordEditor.Comments");
Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ma?J.Yon():J.main();tl.main(ma);df.main(ma);x.a.instance.Pc(new Hl,0,ma);x.a.instance.Pc(new kj,0,ma);gi(ma);Mn(ma)}var e=c(0),a=c(8),h=c(1530),m=c(1541),v=c(2),u=c(83),n=c(1473),x=c(179),A=c(36),H=c(37),E=c(15),L=c(78),M=c(23),F=c(160);class J{get name(){return"Common.App.OAuth.OAuthPackage"}zc(ma){ma.register(273,"Common.App.OAuth.IOAuthManager").singleInstance().Zd(()=>new h.OAuthManager)}init(){const ma=
M.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Xfo(ma)}Xfo(ma){const bb=v.AFrameworkApplication.K.lb("FileSource");if(v.AFrameworkApplication.K.$("IsO365ConsumerHost")||v.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===bb){var Ab=n.a.sIk;if(Ab&&Ab.IsEnabled){var ac=Ab.Application,sc=n.a.authority;if(void 0!==ac&&null!==ac&&ac.length&&void 0!==sc&&null!==sc&&sc.length){var Sc=m.a[ma.Xha],Cd=E.a.dF,ke=ma.bK();try{var Dd=new Map;void 0!==Dd&&null!==Dd?(Dd.set("SupportStatus",
Sc),Dd.set("Browser",Cd),Dd.set("AuthStrategy",ke)):Dd=null}catch(mf){Dd=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Dd);var $d=H.a.kf();ma.Qoa("Core",ac).then(mf=>{const jg=Math.floor(H.a.kf()-$d);Sc=m.a[ma.Xha];Cd=E.a.dF;ke=ma.bK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',jg,mf.IsSuccess,Sc,mf.ErrorCode,
bb,Cd,ke);Dd&&(Dd.set("SupportStatus",Sc),Dd.set("Browser",Cd),Dd.set("AuthStrategy",ke));var ge=Object.assign(new F.a,{durationMs:jg,extendedProperties:Dd});if(mf.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",ge),ge=Ab.Endpoint){var ng=H.a.kf();v.AFrameworkApplication.af.pXb(ge,1,null,{["Authorization"]:"Bearer "+mf.Token},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Sg=>{var qj=Math.floor(H.a.kf()-ng),wi=null;Sg.jo?Sg="Canceled":Sg.Ki?Sg="Faulted":(wi=Sg.result,
Sg=wi.succeeded?"Completed":"Failed");qj={["TaskResult"]:Sg,["BrowserTokenDurationMS"]:jg,["BrowserValidationDurationMS"]:qj};wi&&(qj.HttpStatus=wi.args.data.Df,wi.succeeded&&(wi=A.a(wi.args.data.Ie),qj.ServerValidationDurationMS=wi.ElapsedMilliseconds,qj.ServerValidationResult=wi.ValidatedToken,qj.KMSI=wi.KMSI,qj.Scopes=wi.Scopes,qj.TokenExpirationS=Math.floor(parseInt(wi.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===Sg?50:15,L.a.toJSON(qj))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",
mf.ErrorCode,!1,!1,ge)}).catch(mf=>{var jg=Math.floor(H.a.kf()-$d);jg=Object.assign(new F.a,{durationMs:jg,extendedProperties:Dd});u.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+mf.toString(),!1,!1,jg)})}}}}dispose(){}static main(){x.a.instance.Pc(new J)}static Yon(){x.a.instance.Pc(new J,0,!0)}}Object(e.a)(J,"OAuthPackage",null,[1,2]);var I=c(299),K=c(386),N=c(17);class G{constructor(){this.ild=new K.a}Kfo(ma,bb){if(!ma)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),
!1;ma=N.a.mh(ma);if(this.ild.ub(ma))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ma),!1;this.ild.Z(ma,bb);return!0}Vgf(ma){if(!ma)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ma=N.a.mh(ma);return this.ild.ub(ma)?this.ild.J(ma):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",ma),null)}}Object(e.a)(G,"SdxPaneSuppressionManager",null,[]);var P=c(243),S=c(269),
W=c(9);class X{constructor(ma){this.pAe=0;this.XOj=ma}Whb(){return this.pAe>=this.XOj}reset(){this.pAe=0}update(){this.pAe++}}Object(e.a)(X,"NodeCountBasedTaskYieldStrategy",null,[371]);var Y=c(1723);class ca{constructor(){this.a_c=new Set}KNi(ma){this.a_c.add(ma)}Tho(ma){this.a_c.delete(ma)}FZm(){return()=>{this.a_c.forEach(ma=>{ma.onSessionClose()})}}GZm(){return()=>{this.a_c.forEach(ma=>{ma.onSessionConnect()})}}HZm(){return()=>{this.a_c.forEach(ma=>{ma.onSessionDisconnect()})}}}Object(e.a)(ca,
"AlSessionLifeEventNotifier",null,[354]);var ha=c(1354),ra=c(79),sa=c(70),oa=c(80),ka=c(59),ia=c(5),La=c(1465),va=c(173),Ga=c(409),Oa=c(1475),Za=c(697),ja=c(230),ba=c(424),qa=c(677),Ma=c(450),Ia=c(532);class wa{constructor(){this.token=null}}Object(e.a)(wa,"ReleaseAnnotationParameters",null,[]);class za{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(za,"SetAnnotationMetadataParameters",null,[]);class pa{constructor(){this.id=this.parentPath=null;this.value=0}}Object(e.a)(pa,"SetAnnotationStateParameters",
null,[]);var Ba=c(522),Ra=c(374),fb=c(77),Va=c(86),ib=c(594),Xa=c(1191),qb=c(321),rb=c(744),nb=c(11),Tb=c(439);class Zb extends Sys.EventArgs{constructor(ma,bb){super();this.annotation=ma;this.eab=bb}}Object(e.a)(Zb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Hb=c(974);class Sa{constructor(ma){this.$Qe=this.annotations=null;if(!ma)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(ma.items&&0<ma.items.length){const bb=Sa.AHd(ma.parentPath);
this.annotations=Array(ma.items.length);let Ab=0;for(const ac of ma.items){const sc=Object.assign(new Hb.a,{id:ac.id,parentPath:bb,content:ac.body,annotationType:ja.a.getTypeNameFor(ac.body),parentRevId:ma.parentRevId});this.annotations[Ab++]=sc}this.$Qe=ja.a.getTypeNameFor(ma)}}static AHd(ma){return ma?ma.join("\\"):""}}Object(e.a)(Sa,"AnnotationOperation",null,[]);class ua extends Sys.EventArgs{constructor(ma,bb){super();this.annotationType=ma;this.activated=bb}}Object(e.a)(ua,"AnnotationActivationEventArgs",
Sys.EventArgs,[]);class Fa extends Sys.EventArgs{constructor(ma,bb){super();this.annotation=ma;this.opType=bb}}Object(e.a)(Fa,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Pa{constructor(){this.newState=this.oldState=0;this.handlers=new fb.a}}Object(e.a)(Pa,"AnnotationResultStateUpdateData",null,[]);var Ea=c(482),lb=c(968);class zb{constructor(){this.XQe=this.rck=this.YQe=null}}Object(e.a)(zb,"AnnotationCallbacks",null,[]);class Xb{constructor(ma,bb,Ab,ac,sc,Sc){this.KWb=null;this.wtc=new K.a(0);
this.Nxc=new K.a;this.S6c=new K.a;this.Kid=new Ea.a;this.qIf=null;this.Hh=ma;this.NHa=bb;this.NH=Ab;this.BD=ac;this.FY=sc;this.Ic=Sc}$to(ma,bb,Ab,ac){this.BD.$5b(ma)&&this.Hh.Qd(()=>{if(!this.KWb){this.KWb=new K.a;var sc=nb.ParagraphReader.ww(Tb.a.getRootNode(),!0,!0);for(const Sc of sc)Sc&&(sc=Sc.ia(ia.a.Nc,0))&&(this.KWb.add(sc,Sc.id),this.wtc.Z(Sc.id.toString(),sc))}this.NHa.pIf(ma,(Sc,Cd)=>{if(Sc){var ke=this.BD.tVh(ma);Sc.contentDescriptor.jv===ke&&((ke=this.pvl(Sc))?Sc.dab?(ke=this.M_e(Sc,ke))&&
(Cd?Ab(Cd,Sc.contentDescriptor):bb(ke,Sc.contentDescriptor)):ac(Sc.contentDescriptor):this.zTk(Sc,Object.assign(new zb,{YQe:bb,rck:Ab,XQe:ac})))}})},"PAS:FEPAOT")}pvl(ma){if(3===ma.contentDescriptor.jv){let bb;return({value:bb}=this.KWb.Bc(ma.contentDescriptor.paragraphId)).returnValue?bb:null}if(4===ma.contentDescriptor.jv)return ka.a.nil;a.ULS.sendTraceTag(592525442,Xb.Hi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Ufm(ma,bb){if(3===ma.contentDescriptor.jv)return bb=
this.FY.value.Db(bb).getValue(ia.a.mj),ma.contentDescriptor.mj===bb;if(4===ma.contentDescriptor.jv&&bb===ka.a.nil)return!0;a.ULS.sendTraceTag(592525443,Xb.Hi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}zTk(ma,bb){if(3===ma.contentDescriptor.jv){const Ab=ma.contentDescriptor.paragraphId;this.Nxc.ub(Ab)||this.Nxc.add(Ab,new fb.a);this.Nxc.J(Ab).add(ac=>{12===ac.type&&this.KWb.add(Ab,ac.id);ma.dab?(ac=this.M_e(ma,ac.id))&&bb.YQe(ac,ma.contentDescriptor):bb.XQe(ma.contentDescriptor)})}else if(4===
ma.contentDescriptor.jv)if(ma.dab){const Ab=this.M_e(ma,ka.a.nil);Ab&&bb.YQe(Ab,ma.contentDescriptor)}else bb.XQe(ma.contentDescriptor);else a.ULS.sendTraceTag(592525444,Xb.Hi,15,"DelayCallbackForAnnotation: Unsupported content type")}M_e(ma,bb){if(this.Ufm(ma,bb)){if(bb=this.BD.iOm(ma.dab,ma.contentDescriptor,bb.toString()))return this.S6c.Z(bb.id,ma.o2a),bb}else this.Ic.isFeatureEnabled(93)&&this.NH.pyc(ma);return null}Gjj(ma,bb){let Ab=this.BD.eFd(ma);Ab&&(bb===Oa.a.getTypeName()?this.qeo(ma,Ab):
this.eeo(ma,Ab))}qeo(ma,bb){this.BD.$5b(ma.annotationType)&&(this.NH.gPa(this.FY.value,bb,ma.annotationType),this.S6c.remove(ma.id))}eeo(ma,bb){if(this.BD.$5b(ma.annotationType)){bb=Object.assign(new lb.a,{dab:this.BD.vck(ma),contentDescriptor:bb,annotationType:ma.annotationType});bb=this.NH.addAnnotation(this.FY.value,bb);this.S6c.Z(ma.id,bb);const Ab=this.BD.G2h(ma.annotationType);Ab&&this.Kid.contains(Ab)&&(this.Hh.Qd(()=>{var ac=nb.ParagraphReader.ww(Tb.a.getRootNode(),!0,!0);if(ac&&0<ac.count){const sc=
new fb.a;for(const Sc of ac)(ac=Xb.wHd(Sc))&&sc.add(ac);0<sc.count&&this.NH.X9g(this.FY.value,Ab,sc.toArray())}},"PAS:TAOCPA"),this.Kid.remove(Ab))}}Dib(ma){if(this.KWb)if(ma){var bb=ma.ia(ia.a.Nc,0);if(bb&&(this.wtc.Z(ma.id.toString(),bb),({value:bb}=this.Nxc.Bc(bb)).returnValue))for(const Ab of bb)Ab(ma)}else a.ULS.sendTraceTag(592525445,Xb.Hi,10,"OnParagraphNodeConnected: Invalid node")}jAi(ma,bb){if(ma){var Ab=ma.id.toString();ma=ma.ia(ia.a.Nc,0);var ac=0;({value:ac}=this.wtc.Bc(Ab)).returnValue&&
(3===bb?(this.Nxc.remove(ac),this.wtc.remove(Ab)):2===bb?this.wtc.Z(Ab,ma):a.ULS.sendTraceTag(592525447,Xb.Hi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Xb.Hi,10,"UpdatePersistedAnnotations: Invalid node")}YHl(ma){let bb;return({value:bb}=this.S6c.Bc(ma)).returnValue?bb:ka.a.nil}Qpo(ma,bb,Ab){ma?bb?this.NHa.PXh(ma,ac=>{if(ac){const Cd=Xb.wHd(bb,Ab);if(Cd){var sc=Array(ac.length),Sc=!1;for(let ke=0;ke<ac.length;ke++)if(Sc||
Cd!==ac[ke])sc[ke]=ac[ke];else{const Dd=Xb.wHd(bb);if(!Dd)return;Sc=!0;sc[ke]=Dd;ac[ke]=Dd}Sc&&this.NH.X9g(this.FY.value,ma,sc)}}}):a.ULS.sendTraceTag(588863697,Xb.Hi,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Xb.Hi,10,"UpdateWorkflowParagraphVersion: null workflowType")}APn(ma){ma?this.Kid.add(ma):a.ULS.sendTraceTag(588863698,Xb.Hi,10,"SetPendingWorkflow: null workflowType")}Ayk(ma){ma?this.Kid.remove(ma):a.ULS.sendTraceTag(588105731,Xb.Hi,10,"ClearPendingWorkflow: null workflowType")}static wHd(ma,
bb=0){if(!ma)return null;bb||(bb=ma.ia(ia.a.mj,0));ma=nb.ParagraphReader.eQ(ma);if(bb&&ma)return String.format("{0}{1}{2}",ma,Xb.A4m,bb);a.ULS.sendTraceTag(588091606,Xb.Hi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",bb?"valid":"0",ma?"valid":"0");return null}}Xb.Hi=389;Xb.A4m="-";Object(e.a)(Xb,"PersistedAnnotationStorage",null,[368]);class ub{constructor(){this.config=this.token=null}}Object(e.a)(ub,"UpdateAnnotationConfigParameters",null,[]);var Pb=c(137),yc=c(1171),bc=
c(337),Ka=c(1364);class Bb{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg=null,ge){this.N9a=ge;this.sa=new sa.a;this.fxa=new Va.a;this.r8=new Va.a;this.ED=new Va.a;this.gie=new Va.a;this.omc=new Ba.a(Ra.a.Sj());this.MBe=new fb.a;this.kOb=new Va.a;this.cie=new Va.a;this.T6c=new Va.a;this.lOb=new Va.a;this.Kjc=new Va.a;this.U6c=new Va.a;this.a9c=new Va.a;this.Kgd=[];this.Lgd=[];this.Drc=null;this.YOj=new Ba.a(Ra.a.Sj());this.eie=new Map;this.PPb=new Map;this.Rkc=null;this.Uha=new Va.a;this.sDc=null;
this.ZQk=()=>{if(this.Kgd.length||this.Lgd.length)try{0<this.Kgd.length&&this.$Gm(),0<this.Lgd.length&&this.rho()}finally{this.Oyk()}else this.Hb.Ye(this.Drc),this.Drc=null};this.Kyk=()=>{const ng=new fb.a;for(const Sg of this.ED.values)if(ng.add(Sg),ng.count===Bb.gPj)break;for(const Sg of ng)this.j0b(Sg),this.QJb(Sg,Oa.a.getTypeName());this.ED.count||(this.Hb.Ye(this.Rkc),this.Rkc=null)};this.cUm=(ng,Sg)=>{for(const qj of Sg.pk)ng=qj.intent,!ng.type&&this.YUn(ng.intent,qj.cpBegin,qj.cpEnd,qj.b9b)&&
this.j0b(ng.intent)};this.MJj=ma.$("AugLoopAnnotationsAttachingIsEnabled");this.tVj=ma.NB("SendReleaseMessageAnnotationList")||[];this.Ic=$d;this.gGa=jg;this.NHa=Sc;this.NH=Cd;this.Ms=Ab;this.BD=ke;this.h9=Dd;this.FY=ac;this.Hh=bb;this.Hb=sc;M.a.instance.resolve("Box4.ICharacterPropertiesEditor").Y8j(this.cUm);this.LL=mf;this.jxj=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.DJj=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1);this.N9a&&this.NVl()}get bOi(){return this.lOb}set bOi(ma){this.lOb=ma}mb(ma,bb){a.ULS.sendTraceTag(41521862,Bb.Hi,50,"New registration for annotation type: {0}.",bb);this.addHandler(ma,bb);this.KNe(bb).catch(Ab=>{a.ULS.sendTraceTag(594396739,Bb.Hi,10,"Failed to activate annotation type {0}: {1}",bb,Ab.toString())})}addHandler(ma,bb){if(ma&&bb&&""!==bb){var Ab=null;({value:Ab}=this.lOb.Bc(bb,Ab)).returnValue?Ab.add(ma):(Ab=new fb.a,Ab.add(ma),this.lOb.add(bb,Ab))}else a.ULS.sendTraceTag(41521861,
Bb.Hi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ma,!bb,""===bb)}sc(ma,bb){a.ULS.sendTraceTag(41521863,Bb.Hi,50,"Unregister handler for annotation type: {0}.",bb);let Ab=null;({value:Ab}=this.lOb.Bc(bb,Ab)).returnValue&&(Ab.remove(ma),Ab.count||(a.ULS.sendTraceTag(41521864,Bb.Hi,50,"Unregister all handlers for annotation type: {0}.",bb),this.lOb.remove(bb),this.lRm(bb)))}O1i(ma){this.sDc||(this.sDc=this.LL.Rc(2),this.sDc.Eb(ma))}Oyk(){var ma;
null===(ma=this.sDc)||void 0===ma?void 0:ma.dispose();this.sDc=null}uuh(){this.Drc||(this.Drc=new oa.a(4,2,100,this.ZQk,141),this.Hb.fc(this.Drc))}$Gm(){let ma;ma=Array.dequeue(this.Kgd);const bb=Tb.a.aJc(this.FY.value,ma);if(bb)if(bb.Ui){this.O1i(bb);var Ab=null;if(({value:Ab}=this.Kjc.Bc(ma,Ab)).returnValue){this.Kjc.remove(ma);for(const ac of Ab)this.aHm(bb,ac)}else a.ULS.sendTraceTag(50663568,Bb.Hi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.YOj.add(ma);else a.ULS.sendTraceTag(50436127,
Bb.Hi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}aHm(ma,bb){var Ab=bb.content.range;Ab=new Xa.a(0,Ab.start,Ab.start+Ab.length,ka.a.create(),bb,ac=>{this.gie.Z(bb.id,ac.toString())});this.Ms.E9b(ma,Ab);this.sa.cfa&&this.sa.raiseEvent(Bb.J$b,new Fa(bb,Ga.a.getTypeName()))}eri(ma){const bb=Tb.a.zeb(ma.parentPath);let Ab=null;({value:Ab}=this.Kjc.Bc(bb,Ab)).returnValue||(Ab=new fb.a,this.Kjc.add(bb,Ab),this.Kgd.push(bb));Ab.add(ma);this.uuh()}cHm(ma,bb){this.Hh.Qd(()=>{let Ab;
if(({value:Ab}=this.r8.Bc(ma,Ab)).returnValue){var ac=this.S4i(ma);for(const sc of Ab){let Sc;({value:Sc}=this.ED.Bc(sc,Sc)).returnValue&&bb(Sc)&&Bb.bDb(Sc)&&(this.eri(Sc),ac&&this.sa.raiseEvent(Bb.J$b,new Fa(Sc,Oa.a.getTypeName())))}}},"AS:MIFAT")}sho(ma,bb){this.Hh.Qd(()=>{let Ab;if(({value:Ab}=this.r8.Bc(ma,Ab)).returnValue)for(const ac of Ab){let sc;({value:sc}=this.ED.Bc(ac,sc)).returnValue&&bb(sc)&&Bb.bDb(sc)&&this.k8f(sc)}},"AS:UIFAT")}rRm(ma){var bb=Tb.a.gK(ma);let Ab=null;if(({value:Ab}=
this.fxa.Bc(bb,Ab)).returnValue){bb=0;for(var ac=new fb.a;Ab.count>bb;){var sc=Ab.J(bb),Sc=null;({value:Sc}=this.ED.Bc(sc,Sc)).returnValue&&Bb.bDb(Sc)?this.BD.l0c(ma,Sc)?this.j0b(Sc,!this.Ic.isFeatureEnabled(93)):(sc=Sc.content.range,Sc=new Xa.a(0,sc.start,sc.start+sc.length,ka.a.create(),Sc),ac.add(Sc),bb++):bb++}0<ac.count&&this.Ms.Gzf(ma,ac)}}rho(){let ma="";ma=Array.dequeue(this.Lgd);const bb=Tb.a.aJc(this.FY.value,ma);if(bb&&12===bb.type){this.O1i(bb);var Ab=null;({value:Ab}=this.U6c.Bc(ma,Ab)).returnValue?
(this.Ms.l8f(ac=>Ab.contains(ac.intent),bb,0),this.U6c.remove(ma)):a.ULS.sendTraceTag(50663570,Bb.Hi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,Bb.Hi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}k8f(ma){let bb;({value:bb}=this.gie.Bc(ma.id,bb)).returnValue||(bb=Tb.a.zeb(ma.parentPath));this.gie.remove(ma.id);var Ab=null;({value:Ab}=this.U6c.Bc(bb,Ab)).returnValue||(Ab=new fb.a,this.U6c.add(bb,Ab),this.Lgd.push(bb));
Ab.add(ma);this.uuh();Ab=null;({value:Ab}=this.Kjc.Bc(bb,Ab)).returnValue&&Ab.remove(ma)}W4j(ma){const bb=ma.id;var Ab=ma.annotationType;const ac=ma.parentPath;if(this.BD.wgb(ma)){var sc=Tb.a.geb(this.FY.value,ac);if(sc&&(sc=sc.ia(ia.a.mj,0).toString(),ma.parentRevId&&sc!==ma.parentRevId))return!1}sc=null;({value:sc}=this.r8.Bc(Ab,sc)).returnValue||(sc=new fb.a,this.r8.add(Ab,sc));sc.add(bb);Ab=null;({value:Ab}=this.fxa.Bc(ac,Ab)).returnValue||(Ab=new fb.a,this.fxa.add(ac,Ab));Ab.add(bb);this.ED.add(bb,
ma);this.Zto(ma);return!0}Zto(ma){let bb=this.BD.iNh(ma);if(0===bb.length)this.KBh(ma);else{let Ab=!1;this.NHa.MXm(bb,ma.annotationType,(ac,sc)=>{this.ED.ub(ma.id)?(sc=this.BD.Ogb(ma,Tb.a.Vjl(ma)),!ac&&sc?this.p9f(ma,10,!1):ac&&this.p9f(ma,ac),Ab||(this.KBh(ma),Ab=!0)):sc.eQa=!0})}}KBh(ma){const bb=Bb.bDb(ma);bb&&this.eri(ma);!bb&&this.sa.cfa&&this.sa.raiseEvent(Bb.J$b,new Fa(ma,Ga.a.getTypeName()))}lhj(ma,bb,Ab){let ac=!0;this.Hh.Qd(()=>{if(Ab.startsWith(Tb.a.Pyb)){var sc=ma.id,Sc=null;if(bb===Oa.a.getTypeName())this.j0b(ma);
else if(({value:Sc}=this.ED.Bc(sc,Sc)).returnValue)a.ULS.sendTraceTag(41418891,Bb.Hi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",sc,ma.annotationType),this.ED.Z(sc,ma);else if(!this.W4j(ma)){ac=!1;return}bb===Ga.a.getTypeName()&&Ab!==Tb.a.Pyb&&this.MBe.add(ma.annotationType)}this.QJb(ma,bb)},"AS:UAS");return ac}QKn(ma){if(ma)for(const bb of ma)this.QJb(bb,Za.a.getTypeName()),ma=bb.content,this.a9c.ub(ma.categoryName)?this.a9c.Z(ma.categoryName,bb):this.a9c.add(ma.categoryName,
bb);else a.ULS.sendTraceTag(592802119,Bb.Hi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}B8j(ma){this.sa.addHandler(Bb.J$b,ma)}sah(ma){this.sa.addHandler(Bb.ixi,ma)}Z5b(ma){return this.kOb.ub(ma)}A8j(ma){this.sa.addHandler(Bb.TWd,ma)}Wtn(ma){this.sa.removeHandler(Bb.TWd,ma)}S4i(ma){return!Tb.a.lf(ma)&&rb.a(ma)&&this.sa.cfa}j0b(ma,bb=!0){if(this.ED.ub(ma.id)){var Ab=this.ED.J(ma.id);this.ED.remove(ma.id);var ac=null;({value:ac}=this.fxa.Bc(ma.parentPath,ac)).returnValue?
(ac.remove(ma.id),Bb.bDb(Ab)&&this.k8f(Ab)):a.ULS.sendTraceTag(50734169,Bb.Hi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");ac=null;({value:ac}=this.r8.Bc(ma.annotationType,ac)).returnValue?ac.remove(ma.id):a.ULS.sendTraceTag(50734170,Bb.Hi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.S4i(ma.annotationType)?this.sa.raiseEvent(Bb.J$b,new Fa(Ab,Oa.a.getTypeName())):this.QJb(ma,Oa.a.getTypeName());bb&&this.h9.Gjj(Ab,Oa.a.getTypeName())}}Lbf(ma,
bb,Ab=!1){const ac=new fb.a;var sc;if(!({value:sc}=this.r8.Bc(ma,sc)).returnValue)return ac;for(const Sc of sc)this.ED.ub(Sc)?(ma=this.ED.J(Sc),(sc=this.BD.eFd(ma))&&(bb.equals(sc)||Ab&&bb.overlaps(sc))&&ac.add(ma)):a.ULS.sendTraceTag(577843217,Bb.Hi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Sc);return ac}Lcm(ma){return ja.a.getTypeNameFor(ma)===bc.a.getTypeName()}Oci(ma){var bb,Ab;return(null===(Ab=null===(bb=this.N9a)||void 0===bb?void 0:bb.pVh)||void 0===
Ab?void 0:Ab.call(bb))===yc.a.Oic&&ma&&0===ma.priority?this.N9a.g2c(ma.context.substr(ma.startInContext,ma.range.length)):!1}Nbn(ma){this.Hh.Qd(()=>{a.ULS.T7(Bb.Hi,100)&&a.ULS.sendTraceTag(41418894,Bb.Hi,100,"Operation of type {0} with path {1} received",ja.a.getTypeNameFor(ma),ma.parentPath.join("\\"));try{const bb=new Sa(ma);for(const Ab of bb.annotations){bb.$Qe===Ga.a.getTypeName()&&rb.b(Ab,!1);if(this.Lcm(Ab.content)&&this.Oci(Ab.content)){this.SQa(Ab,70);continue}const ac=Ab.parentPath,sc=bb.$Qe;
sc===Oa.a.getTypeName()&&this.uOi(Ab,ac);if(sc===Ga.a.getTypeName()&&rb.a(Ab.annotationType)){const Cd=Tb.a.zeb(ac);if(Ab.content.isHotCritique&&this.DJj){this.PPb.set(Cd,Date.now());continue}}const Sc=Ab.annotationType;if(Tb.a.lf(Sc)||Sc!==ba.a.getTypeName())if(!Tb.a.lf(Sc)&&rb.a(Sc)&&Ab.content&&0==Ab.content.priority&&Pb.a.R2){const Cd=Tb.a.zeb(ac);Cd&&Cd==Pb.a.ril()&&a.ULS.sendTraceTag(539870169,Bb.Hi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible")}else sc!==Oa.a.getTypeName()&&
this.omc.contains(ac)?a.ULS.sendTraceTag(41418897,Bb.Hi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",ac,Ab.id):this.jhj(Ab,ac,sc);else a.ULS.sendTraceTag(595342670,Bb.Hi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",ac)}}catch(bb){a.ULS.sendTraceTag(41418898,Bb.Hi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",bb.message,bb.stack)}},"AS:PO")}drn(ma){if(ma&&ma.annotationType&&
this.BD.$5b(ma.annotationType)){var bb;if(({value:bb}=this.r8.Bc(ma.annotationType,bb)).returnValue&&(ma=this.BD.eFd(ma)))for(const Ab of bb){let ac;({value:ac}=this.ED.Bc(Ab,ac)).returnValue&&(bb=this.BD.eFd(ac))&&(ma.equals(bb)||ma.overlaps(bb))&&this.j0b(ac)}}}QJb(ma,bb){this.Hh.Qd(()=>{let Ab=null;if(({value:Ab}=this.bOi.Bc(ma.annotationType,Ab)).returnValue)for(const ac of Ab)ac.GF(ma,bb)},"AS:SATH")}Jyk(){a.ULS.sendTraceTag(50860999,Bb.Hi,50,"ClearStorage: Initiated Clearing Storage");this.Rkc||
(this.Rkc=new oa.a(4,2,100,this.Kyk,142),this.Hb.fc(this.Rkc))}activateAnnotation(ma,bb){let Ab;if(({value:Ab}=this.T6c.Bc(ma,Ab)).returnValue){if(Ab.contains(bb))return Promise.resolve(null);Ab.add(bb)}else{let ac;this.T6c.add(ma,(ac=new fb.a,ac.add(bb),ac))}return this.KNe(ma)}KNe(ma){a.ULS.sendTraceTag(41521865,Bb.Hi,50,"ActivateAnnotation: Activating annotation type {0}.",ma);if(this.kOb.ub(ma))return Promise.resolve(null);var bb=null;if(({value:bb}=this.cie.Bc(ma,bb)).returnValue)return bb;this.a2j(ma);
bb=null;this.gGa&&(bb=this.gGa());if(bb){const Ab=new Ia.a;Ab.annotationType=ma;this.jxj&&(this.Uha.ub(ma)||this.Uha.Z(ma,new Pa),Ab.stateUpdateHandler=(ac,sc)=>{this.Uha.J(ma).oldState=ac;this.Uha.J(ma).newState=sc;for(const Sc of this.Uha.J(ma).handlers)Sc(ma,ac,sc)});bb=bb.activateAnnotation(Ab);this.cie.add(ma,bb);return bb.then(ac=>{this.cie.remove(ma);this.kOb.add(ma,ac.token);this.khj(ac.token,ma);this.sa.raiseEvent(Bb.TWd,new ua(ma,!0));this.LVl(ma);return ac})}return Promise.reject(Error.create("Error during annotation activation"))}LVl(ma){const bb=
this.BD.G2h(ma);bb&&this.NHa.PXh(bb,Ab=>{if(this.h9.qIf){var ac=nb.ParagraphReader.ww(Tb.a.getRootNode(),!0,!0);if(ac&&0<ac.count){let sc=0;for(const Sc of ac){ac=Xb.wHd(Sc);if(!ac)continue;let Cd=!1;for(;sc<Ab.length;){if(ac===Ab[sc]){Cd=!0;break}sc++}if(!Cd){this.h9.qIf(bb);break}sc++}}}})}a2j(ma){this.h9.$to(ma,(bb,Ab)=>{0<this.Lbf(ma,Ab,!0).count||this.lhj(bb,Ga.a.getTypeName(),bb.parentPath)},(bb,Ab)=>{if(3!==Ab.jv)a.ULS.sendTraceTag(591541786,Bb.Hi,15,"Annotation moved to unsupported location type: {0}",
Ab.jv);else if(bb.jv!==Ab.jv)a.ULS.sendTraceTag(591541787,Bb.Hi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",bb.jv,Ab.jv);else{bb=this.Lbf(ma,bb);for(const sc of bb){const Sc=sc.content;bb=Tb.a.geb(this.FY.value,sc.parentPath);if(!bb){a.ULS.sendTraceTag(591541788,Bb.Hi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Ms.l8f(Cd=>Cd.intent===Sc,bb,0))break;var ac=Ab.Kra;ac=new Xa.a(0,ac,ac+Ab.Jra,null,Sc);this.Ms.E9b(bb,
ac)}}},bb=>{for(const Ab of this.Lbf(ma,bb))this.j0b(Ab,!1)})}releaseAnnotation(ma,bb){let Ab;if(({value:Ab}=this.T6c.Bc(ma,Ab)).returnValue){Ab.contains(bb)&&Ab.remove(bb);if(0<Ab.count)return Promise.resolve(!1);this.T6c.remove(ma)}a.ULS.sendTraceTag(593790408,Bb.Hi,50,"ReleaseAnnotation: Releasing annotation type {0}.",ma);return this.DYi(ma)}lRm(ma){var bb=null;if(({value:bb}=this.r8.Bc(ma,bb)).returnValue){a.ULS.sendTraceTag(41418899,Bb.Hi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ma);for(const Ab of bb)if(bb=null,({value:bb}=this.ED.Bc(Ab,bb)).returnValue){const ac=bb.parentPath;let sc=null;({value:sc}=this.fxa.Bc(ac,sc)).returnValue&&(sc.remove(Ab),sc.count||this.fxa.remove(ac));this.ED.remove(Ab);Bb.bDb(bb)&&this.k8f(bb)}this.r8.remove(ma)}Array.contains(this.tVj,ma)&&this.DYi(ma)}DYi(ma){let bb=null,Ab=null;this.gGa&&(Ab=this.gGa());if(Ab){if(({value:bb}=this.kOb.Bc(ma,bb)).returnValue){const ac=new wa;ac.token=bb;this.kOb.remove(ma);this.sa.raiseEvent(Bb.TWd,new ua(ma,
!1));return Ab.releaseAnnotation(ac)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}umi(){this.Hh.Qd(()=>{if(this.MJj){var ma=Tb.a.getRootNode();if(ma){var bb=new Va.a;ib.e(ma,Ab=>{var ac=Tb.a.gK(Ab),sc=null;if(({value:sc}=this.fxa.Bc(ac,sc)).returnValue)for(const Sc of sc)ac=null,({value:ac}=this.ED.Bc(Sc,ac)).returnValue&&(ac.parent=Ab,ac.nOc=!0,ac.wHb=2,bb.ub(ac.annotationType)||bb.Z(ac.annotationType,new fb.a),bb.J(ac.annotationType).add(Sc),
sc=null,({value:sc}=this.r8.Bc(ac.annotationType,sc)).returnValue&&sc.remove(ac.id));return!0},12);for(const Ab of this.r8.keys)if(ma=null,({value:ma}=this.r8.Bc(Ab,ma)).returnValue)for(const ac of ma)if(ma=null,({value:ma}=this.ED.Bc(ac,ma)).returnValue){let sc=null;ma.parentPath===Tb.a.Pyb?(ma.wHb=1,ma.parent=null):({value:sc}=this.ED.Bc(ma.parentPath,sc)).returnValue?(ma.wHb=3,ma.parent=sc):(ma.wHb=0,ma.parent=null,a.ULS.sendTraceTag(41554060,Bb.Hi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ma.id));ma.nOc=!0;bb.ub(ma.annotationType)||bb.Z(ma.annotationType,new fb.a);bb.J(ma.annotationType).add(ac)}else a.ULS.sendTraceTag(41997840,Bb.Hi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",ac);else a.ULS.sendTraceTag(41997841,Bb.Hi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",Ab);this.r8=bb;this.MBe.clear()}else a.ULS.sendTraceTag(41554058,Bb.Hi,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Bb.Hi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}uck(ma){this.Nbn(ma)}C_m(ma,bb){this.Hh.Qd(()=>{const Ab=bb?bb+String.format("\\{0}",ma.id):Tb.a.gK(ma);a.ULS.sendTraceTag(41418900,Bb.Hi,50,"OnTileDeleted: Tile delete event received for tile {0}.",Ab);this.omc.contains(Ab)||this.omc.add(Ab);var ac=null;if(({value:ac}=this.fxa.Bc(Ab,ac)).returnValue){a.ULS.sendTraceTag(41418901,Bb.Hi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",ac.count,
Ab);for(const sc of ac)ac=null,({value:ac}=this.ED.Bc(sc,ac)).returnValue&&(this.QJb(ac,Oa.a.getTypeName()),this.sa.cfa&&this.sa.raiseEvent(Bb.J$b,new Fa(ac,Oa.a.getTypeName())),this.ED.remove(sc));this.fxa.remove(Ab)}},"AS:OTD")}B_m(ma){ma=Tb.a.gK(ma);this.omc.remove(ma)&&a.ULS.sendTraceTag(41418902,Bb.Hi,50,"OnTileAdded: Deleted tile {0} was re-added.",ma)}Rno(ma){if(ma){a.ULS.sendTraceTag(50436131,Bb.Hi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ma.count);var bb=new Va.a;
for(var Ab of ma)ma=null,({value:ma}=bb.Bc(Ab.parentPath,ma)).returnValue||(ma=new Va.a,bb.add(Ab.parentPath,ma)),ma.Z(Ab.id,Ab);for(const ac of bb){bb=Tb.a.geb(this.FY.value,ac.key);if(!bb){a.ULS.sendTraceTag(50436160,Bb.Hi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}Ab=new qb.a([0]);for(let sc=0,Sc=bb.qa.length;sc<Sc;sc++)ma=bb.qa.J(sc),ma.pk&&Ab.I4a(ma.pk,void 0,(Cd,ke)=>{if(ke){var Dd=null,$d=ke.intent;$d&&({value:Dd}=ac.value.Bc($d.id,Dd)).returnValue&&($d=new qa.a,
$d.start=ke.Ob.cp,$d.length=Cd.Ob.cp-$d.start,Dd.content.range=$d,Dd.eOa=!1)}})}}else a.ULS.sendTraceTag(50436130,Bb.Hi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ma){a.ULS.sendTraceTag(593049729,Bb.Hi,50,"GetAnnotationsByType: Method called for type {0}.",ma);return this.KNe(ma).then(()=>{const bb=new fb.a;this.Hh.Qd(()=>{if(Tb.a.lf(ma)||ma!==ba.a.getTypeName()){this.MBe.contains(ma)&&this.umi();var Ab=null;if(({value:Ab}=this.r8.Bc(ma,Ab)).returnValue){a.ULS.sendTraceTag(41418903,
Bb.Hi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ma);var ac=new fb.a;for(const sc of Ab)Ab=null,({value:Ab}=this.ED.Bc(sc,Ab)).returnValue&&(Ab.eOa&&ac.add(Ab),bb.add(Ab));ac&&0<ac.count&&Bb.bDb(ac.J(0))&&this.Rno(ac)}}else for(ac of this.a9c.values)bb.add(ac);bb.count||a.ULS.sendTraceTag(41418904,Bb.Hi,50,"GetAnnotationsByType: No annotations found for type {0}!",ma)},"AS:GABT");return bb},bb=>{a.ULS.sendTraceTag(41418905,Bb.Hi,10,"Exception occurred while fetching annotations of type {0}: {1}",
ma,bb);return null})}Cdb(ma){let bb=null;return({value:bb}=this.ED.Bc(ma,bb)).returnValue?bb:null}vNh(ma){let bb=null;if(this.fxa.ub(ma))for(const Ab of this.fxa.J(ma))if(ma=this.Cdb(Ab))bb||(bb=new fb.a),bb.add(ma);return bb}hFb(ma){return(ma=this.Cdb(ma))?(ma.nOc||this.umi(),ma):null}SQa(ma,bb){this.oRn(ma,bb);this.p9f(ma,bb);this.QJb(ma,Za.a.getTypeName())}ejo(ma,bb){this.Omo(ma,bb);this.zOn(ma,Tb.a.Ujl(ma));this.QJb(ma,Za.a.getTypeName())}fjo(ma,bb){ma=this.BD.iNh(ma);for(const Ab of ma)this.NH.e9f(this.FY.value,
Ab,bb)}oRn(ma,bb){let Ab=null;this.gGa&&(Ab=this.gGa());Ab&&(ma=this.Wjl(ma,bb))&&Ab.setAnnotationState(ma)}p9f(ma,bb,Ab=!0){if(ma&&Bb.Kbi(ma)){var ac=this.Cdb(ma.id);!ma.content||ac&&ma.content===ac.content||Tb.a.setAnnotationState(ma,bb);ac&&ac.content&&Tb.a.setAnnotationState(ac,bb);Ab&&this.sa.cfa&&(70===bb||60===bb)&&this.sa.raiseEvent(Bb.ixi,new Zb(ma,bb))}}Wjl(ma,bb){let Ab=null;ma&&(Ab=Object.assign(new pa,{id:ma.id,value:bb}),Tb.a.lf(ma.parentPath)||(Ab.parentPath=ma.parentPath.split("\\")));
return Ab}zOn(ma,bb){const Ab=this.gGa?this.gGa():null;Ab&&(ma=this.Tjl(ma,bb))&&Ab.setAnnotationMetadata(ma)}Omo(ma,bb){if(ma&&Bb.Kbi(ma)){var Ab=this.Cdb(ma.id);!ma.content||Ab&&ma.content==Ab.content||Tb.a.mZi(ma,bb);Ab&&Ab.content&&Tb.a.mZi(Ab,bb)}}Tjl(ma,bb){if(!ma)return null;const Ab=new za;Ab.id=ma.id;Ab.value=bb;Tb.a.lf(ma.parentPath)||(Ab.parentPath=ma.parentPath.split("\\"));return Ab}YUn(ma,bb,Ab,ac){const sc=ma.content;if(this.BD.wgb(ma)&&sc){const Sc=sc.range.start+sc.range.length;if(0<
ac&&Sc<=Ab||0>ac&&Sc<=Ab+ac)return!1;if(0<ac&&sc.range.start>=bb||0>ac&&sc.range.start>=Ab)return sc.range.start+=ac,!1}return!this.Ic.isFeatureEnabled(62)&&sc&&sc.M_?(ma=this.BD.Ogb(ma,60),!(60===sc.M_.state&&ma)):!0}F8g(ma,bb){this.Uha.ub(bb)||this.Uha.Z(bb,new Pa);this.Uha.J(bb).handlers.add(ma);ma(bb,this.Uha.J(bb).oldState,this.Uha.J(bb).newState)}wOi(ma,bb){this.Uha.ub(bb)&&this.Uha.J(bb).handlers.contains(ma)&&this.Uha.J(bb).handlers.remove(ma)}static Kbi(ma){ma=ja.a.getBaseTypesFor(ma.content);
return Array.contains(ma,va.a.getTypeName())}static bDb(ma){if(void 0===ma.content||null===ma.content||""===Tb.a.zeb(ma.parentPath))return!1;const bb=ja.a.getBaseTypesFor(ma.content);return Array.contains(bb,Ma.a.getTypeName())&&ma.annotationType!==La.RoleDetectionAnnotation.getTypeName()}djo(ma){ma?(this.eie.AugLoop_Text_Critique=ma,ma=this.Z5b("AugLoop_Text_Critique")?this.kOb.J("AugLoop_Text_Critique"):null,this.khj(ma,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Bb.Hi,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}khj(ma,bb){if(ma&&this.eie[bb]){const Ab=new ub;Ab.token=ma;Ab.config=this.eie[bb];this.gGa&&(this.gGa().updateAnnotationConfig(Ab),a.ULS.sendTraceTag(540615553,Bb.Hi,50,"Annotation configuration has been updated for annotation type: {0}.",bb))}}uOi(ma,bb){let Ab=null;({value:Ab}=this.ED.Bc(ma.id,Ab)).returnValue&&(ma.annotationType=Ab.annotationType);bb=Tb.a.zeb(bb);this.PPb.has(bb)&&rb.a(ma.annotationType)&&this.PPb.delete(bb)}jhj(ma,bb,Ab){this.drn(ma);this.lhj(ma,Ab,bb)&&
this.h9.Gjj(ma,Ab)}gPa(ma){const bb=ma.parentPath,Ab=Oa.a.getTypeName();this.uOi(ma,bb);this.SQa(ma,70);this.omc.contains(bb)||this.jhj(ma,bb,Ab)}eAl(ma){const bb=new fb.a;ma=this.r8.Bc(ma).value;if(null===ma)return bb;for(const Ab of ma)ma=this.ED.Bc(Ab).value,null!==ma&&bb.push(ma);return bb}NVl(){Object(ra.__awaiter)(this,void 0,void 0,function*(){yield Object(Ka.b)();this.HOi()})}HOi(){const ma=this.eAl(bc.a.getTypeName());for(const bb of ma)this.Oci(bb.content)&&this.gPa(bb)}}Bb.Hi=389;Bb.J$b=
"OnAnnotationOperation";Bb.ixi="OnAnnotationLocalStateChange";Bb.TWd="OnAnnotationActivationChange";Bb.gPj=20;Object(e.a)(Bb,"AnnotationStorage",null,[370]);class tb{constructor(){this.T5d=null;this.t0c=!1}}Object(e.a)(tb,"AugmentationLoopStateManager",null,[367]);var Kb=c(187),Ib=c(683),Wa=c(64),vc=c(92),Lc=c(599),Gb=c(244);class pc extends Gb.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=
this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}Tl(){return 102}static construct(ma,bb,Ab,ac,sc,Sc){const Cd=new pc;Cd.ExpectedEndRevisionId=ma;Cd.OriginString=bb;Cd.Authorization=Ab;Cd.AugLoopSeedUrl=ac;Cd.FileId=sc;Cd.SeedBatchesInParallelIsEnabled=Sc;Cd.AddDocumentKindTypeToPathIsEnabled=!0;Cd.CheckOnDemandNodeVersionEnabled=!0;Cd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Cd}}Object(e.a)(pc,"FullFileAugLoopSeedingRequest",
Gb.a,[]);class Fc{constructor(){this.authToken=this.url=this.gDi=null}}Object(e.a)(Fc,"ReseedingTaskInfo",null,[]);class ob{constructor(ma,bb,Ab,ac,sc,Sc){this.B8=null;this.PGg=!1;this.VPb=null;this.kFe=0;this.IVc=(Cd,ke)=>{Cd=ke.X9;this.VPb&&vc.AT(Cd,Dd=>Dd===this.VPb)&&(ke.httpStatusCode!==Kb.a.yD||ke.oD||2!==ke.$Lf?ke.httpStatusCode!==Kb.a.yD||ke.oD||1!==ke.$Lf?this.fUi(()=>{a.ULS.sendTraceTag(50861003,ob.Hi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
ke.httpStatusCode,ke.oD,ke.$Lf,ke.Zt)}):(this.fN.t0c=!1,this.B8.YIb(this.IVc),this.Jf.Jyk(),a.ULS.sendTraceTag(50861002,ob.Hi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Cd=Object(Wa.a)(Fc,this.VPb),this.hKi(ke.LBn,Cd.gDi,Cd.url,Cd.authToken)):this.fUi(()=>{a.ULS.sendTraceTag(50861001,ob.Hi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.N9k=Cd=>{if(void 0===Cd||null===Cd||void 0===Cd.data||null===Cd.data||void 0===Cd.data.Ie||
null===Cd.data.Ie)a.ULS.sendTraceTag(41445393,ob.Hi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Cd.data.Df!==Kb.a.yD)a.ULS.sendTraceTag(41445394,ob.Hi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Cd.data.Df);else try{let ke;({group:ke}=Ib.a.g8(Cd.data.Ie)).returnValue?ke.Responses&&ke.Responses.length?(Cd=null,ke&&ke.Responses&&ke.Responses.length&&(Cd=ke.Responses[0])?(this.W8.Fmb(Cd),Cd.StatusCode?
a.ULS.sendTraceTag(41445398,ob.Hi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Cd.StatusCode):a.ULS.sendTraceTag(41445399,ob.Hi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Cd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,ob.Hi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,ob.Hi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,ob.Hi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(ke){a.ULS.sendTraceTag(41445400,ob.Hi,10,"FileSeedingSuccessCallback: {0}",ke.message)}};this.M9k=Cd=>{void 0===Cd||null===Cd||void 0===Cd.data||null===Cd.data||void 0===Cd.data.Ie||null===Cd.data.Ie?a.ULS.sendTraceTag(41445401,ob.Hi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,ob.Hi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Cd.data.Df)};this.gyj=ma.$("AugLoopServerSideSeedingIsEnabled");this.eyj=ma.$("AugLoopReseedingIsEnabled");this.fyj=ma.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.BRg=ma.rc("MaxReseedingRetries",1);this.rg=bb;this.Zbd=Ab;this.fN=ac;this.W8=sc;this.Jf=Sc;W.App.xa&&W.App.xa.jb&&W.App.xa.jb.Xc&&W.App.xa.jb.Xc.contentReplicator&&(this.B8=W.App.xa.jb.Xc.contentReplicator)}w6l(ma,
bb,Ab){if(this.gyj){var ac=this.fN.T5d;ac&&ac.trim().length?this.PGg?this.eyj&&(a.ULS.sendTraceTag(50861E3,ob.Hi,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.kFe=0,this.B8?(this.fN.t0c=!0,this.B8.xXb(this.IVc),this.VPb=Object.assign(new Fc,{gDi:ma,url:bb,authToken:Ab}),this.B8.kE(null,null,this.VPb)):a.ULS.sendTraceTag(592814793,ob.Hi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,ob.Hi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),
this.hKi(ac,ma,bb,Ab),this.PGg=!0):a.ULS.sendTraceTag(41445391,ob.Hi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,ob.Hi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}fUi(ma){this.kFe<this.BRg?(a.ULS.sendTraceTag(594384E3,ob.Hi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.kFe,this.BRg),this.B8.kE(null,null,this.VPb)):(this.fN.t0c=!1,this.B8.YIb(this.IVc),ma())}hKi(ma,bb,Ab,ac){const sc=pc.construct(ma,bb,ac,Ab,v.AFrameworkApplication.rootQuerySignature,this.fyj);a.ULS.sendTraceTag(595178454,ob.Hi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Zbd.HCb.execute(()=>{this.r6j(sc)})}r6j(ma){a.ULS.sendTraceTag(595178453,ob.Hi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.rg.Mj(W.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Lc.b(ma),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.N9k,this.M9k,ma);a.ULS.sendTraceTag(42016906,ob.Hi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}ob.Hi=389;Object(e.a)(ob,"FullFileAugLoopSeedingService",null,[]);class Fb{constructor(){}}Object(e.a)(Fb,"RuntimeManagerInitializationTracker",null,[]);class gb{getAugLoopRuntimeManager(){return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}}
Object(e.a)(gb,"AlFactoryWrapper",null,[366]);class Jb{Qm(){return Tb.a.Qm()}}Object(e.a)(Jb,"UtilsWrapper",null,[365]);var Yb=c(593),tc=c(60),Ec=c(16),Vc=c(45),Hd=c(106),qd=c(1882),me=c(6),Zc=c(109),Dc=c(169),ud=c(33),Ce=c(252),ee=c(428),Uf=c(105),te=c(191);class Fe{constructor(ma,bb,Ab,ac,sc){this.Oa=ma;this.Cf=Ab;this.kp=ac;this.Ce=sc;this.pma=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.IsCaptionDetectionEnabled",!1)}static get ae(){return te.a.getInstance()}EMn(ma,bb){ma.listType=
this.Xzl(bb);ma.outlineLevel=nb.ParagraphReader.xBa(bb);ma.indentation=Fe.pff(this.kp.qT(bb));ma.alignment=Fe.wbf(nb.ParagraphReader.Lv(bb));ma.isInsideTable=this.isInsideTable(bb);ma.isInsideTOC=bb.Ur;ma.rightIndentation=Fe.pff(this.kp.cZa(bb));var Ab=this.kp.Y3b(bb);ma.specialIndentType=Fe.oLl(Ab);ma.specialIndentBy=Fe.pff(Ab);ma.listType!==qd.e.NoList&&this.hOn(bb,ma);this.hRn(bb,ma);Ab=[];this.pma&&(Ab=this.Qan(bb));ma.formattedRanges=this.Zul(bb,Ab);this.pma&&null!=Ab&&(ma.objectReferences=0<
Ab.length?Ab:void 0)}Zul(ma,bb){var Ab=ma.qa?ma.qa.length:0,ac=Zc.FormattingReader.Qr(ud.a.create(ma));let sc=Uf.a.WG,Sc=0,Cd=Uf.a.VJ/2;ac&&(Cd=Zc.FormattingReader.Jn(ac,Ec.a.fontSize,Uf.a.VJ)/2,sc=Zc.FormattingReader.Jn(ac,Ec.a.font,Uf.a.WG),Sc=Zc.FormattingReader.language(ac));ac="Normal";var ke=this.Ce.Ao(ma);ke&&(ac=ke.getValue(Vc.a.ja)||"Normal",ke.hasProperty(Ec.a.font)&&(sc=ke.getValue(Ec.a.font)));if(Ab){--Ab;ke=[];let Sg=null,qj=void 0,wi=null;this.pma&&ma.hasProperty(Ec.a.wn)&&(wi=ma.getValue(Ec.a.wn));
const Ki=ma.properties.ia(ia.a.lea,null);for(let Zi=0;Zi<Ab;Zi++){var Dd=ma.qa.J(Zi),$d=ma.Mc,mf=null;this.pma&&(mf=Fe.bjf(ma,wi,Zi));Dd.Hf&&(Sg=Fe.wko($d,Dd.Hf,Sg));Dd.hyperlink&&Dd.hyperlink.url?qj=Dd.hyperlink.url:Dd.vl&&(qj=void 0);var jg=ma.qa.J(Zi+1).cp-1;$d=Dd.cp;jg=jg-Dd.cp+1;let eh=!1,Zl=!1,nl=!1,mb=Cd,nc=0,Wc=0,vd=ac,Md=void 0,tf=Sc,If=sc,fg;if(Dd.formatting){var ge=Dd.formatting;eh=Zc.FormattingReader.Jn(ge,Ec.a.bold,!1);Zl=Zc.FormattingReader.Jn(ge,Ec.a.italic,!1);nl=Zc.FormattingReader.Jn(ge,
Ec.a.underline,!1);mb=Zc.FormattingReader.Jn(ge,Ec.a.fontSize,2*Cd)/2;nc=Zc.FormattingReader.Jn(ge,Vc.a.capitalization,0);Wc=Zc.FormattingReader.Jn(ge,Ec.a.fontColor,0);tf=Zc.FormattingReader.language(ge)||Sc;If=Zc.FormattingReader.Jn(ge,Ec.a.font,sc);vd=ac;var ng=ge.hn;ng&&(ng=ng.ia(Vc.a.xB,null))&&!ng.equals(ka.a.nil)&&ge.paragraph.Mc&&(ge=ge.paragraph.Mc.Db(ng))&&(vd=(new Dc.a(ge)).getValue(Vc.a.ja))}this.pma&&(fg=this.Fgf(mf),null!=fg&&this.E$g(bb,mf,fg,ke.length,qd.b.Inline));Sg&&(Md=0<Sg.count);
Dd={isDeleted:this.mdm(Ki,Dd,Zi,qj),fontFamily:If,fontWeight:eh?qd.d.Bold:qd.d.Normal,fontSize:mb,italic:Zl,underline:nl?qd.h.SingleLine:qd.h.None,capitalization:Fe.fth(nc),color:Wc,styleName:vd,isFollowUp:Md,languageId:Fe.Wsh(tf),start:$d,length:jg,link:qj,isReference:Fe.isReference(Dd)?!0:void 0,objectType:null!==fg&&void 0!==fg?fg:void 0};mf=0<ke.length?ke[ke.length-1]:void 0;Fe.Nsk(mf,Dd)?mf.length+=Dd.length:ke.push(Dd)}return ke}return[{fontFamily:sc,fontWeight:qd.d.Normal,fontSize:Cd,italic:!1,
underline:qd.h.None,capitalization:Fe.fth(0),color:0,styleName:ac,isFollowUp:void 0,languageId:Fe.Wsh(Sc),start:0,length:ma.characterData.length}]}mdm(ma,bb,Ab,ac){if(this.KA()){if(bb.blob||bb.formatting&&bb.formatting.cache&&bb.formatting.cache.PDb||ac)return!0;if(ma&&Ab<ma.length)return ma[Ab]}return bb.fi?!0:!1}KA(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static Nsk(ma,bb){return!!ma&&!!bb&&ma.start+
ma.length===bb.start&&ma.isDeleted===bb.isDeleted&&ma.fontFamily===bb.fontFamily&&ma.fontWeight===bb.fontWeight&&ma.fontSize===bb.fontSize&&ma.italic===bb.italic&&ma.underline===bb.underline&&ma.capitalization===bb.capitalization&&ma.color===bb.color&&ma.highlightColor===bb.highlightColor&&ma.styleName===bb.styleName&&void 0===ma.link&&void 0===bb.link&&ma.languageId===bb.languageId&&!ma.isReference&&!bb.isReference&&!ma.isFollowUp&&!bb.isFollowUp&&void 0===ma.objectType&&void 0===bb.objectType}Xzl(ma){const bb=
new me.GraphIterator;bb.set(ma);bb.Ab(11);bb.kd(11);return(ma=this.Cf.Gs(bb))?Fe.FHk(ma.listType):qd.e.NoList}hOn(ma,bb){const Ab=this.Cf.BF(ma);if(Ab){Ab.hasProperty(ia.a.listID)&&(bb.listId=Ab.getValue(ia.a.listID).toString());const ac=this.$Uh(ma,Ab,Ec.a.font);ma=this.$Uh(ma,Ab,Ec.a.fontSize);ac&&(bb.bulletAndNumberFontFamily=ac);ma&&(bb.bulletAndNumberFontSize=ma)}}isInsideTable(ma){const bb=new me.GraphIterator;bb.set(ma);return bb.Ab(14)}hRn(ma,bb){bb.spacingBeforeParagraph=this.J_h(ma,ia.a.tga,
ia.a.yna,ia.a.zj);bb.spacingAfterParagraph=this.J_h(ma,ia.a.sga,ia.a.xna,ia.a.ra);bb.lineSpacing=this.WLa(ma)}J_h(ma,bb,Ab,ac){if(nb.ParagraphReader.Jn(ma,bb,!1))return 0;bb=nb.ParagraphReader.Jn(ma,Ab,-1);if(0<=bb)return bb*Ce.a.pHb/100;ma=nb.ParagraphReader.Jn(ma,ac,-1);return 0<=ma?ma/20:0}$Uh(ma,bb,Ab){if(Fe.ae.WL){if(ma=this.isl(ma),null!=ma&&null!=ma.cache)return ma.cache.getValue(Ab)}else if(bb.hasProperty(Ab))return bb.getValue(Ab)}isl(ma){var bb;ma=null===(bb=ma.qa)||void 0===bb?void 0:bb.last;
return null!=ma&&ma.Xh?ma.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}WLa(ma){const bb=nb.ParagraphReader.Jn(ma,ia.a.va,Ce.a.va);ma=nb.ParagraphReader.Jn(ma,ia.a.ua,Ce.a.lineSpacing);switch(bb){case 0:return ma/240;case 1:return ma/20;default:return 0}}static wko(ma,bb,Ab){for(let ac=0;ac<bb.length;ac++){const sc=bb.J(ac),Sc=sc.Rj,Cd=ma.Db(Sc);Cd&&Cd.ia(ia.a.NF,!1)&&(Ab||(Ab=new Ba.a(new ee.a)),sc.Oc?Ab.add(Sc):Ab.remove(Sc))}return Ab}static Wsh(ma){return(ma=
Yb.a.qg(ma))&&ma.name?ma.name.toLowerCase():void 0}static pff(ma){return ma?2===ma.unit?Math.floor(tc.a.Uwb(ma.value)/20):Math.floor(ma.value/20):0}static oLl(ma){if(!ma)return qd.g.Initial;switch(ma.specialIndentType){case 1:return qd.g.FirstLine;case 2:return qd.g.Hanging;default:return qd.g.Initial}}static fth(ma){switch(ma){case 2:return qd.c.AllCaps;case 1:return qd.c.SmallCaps;default:return qd.c.NoCaps}}static wbf(ma){switch(ma){case 1:return qd.a.Left;case 3:return qd.a.Right;case 2:return qd.a.Center;
case 6:return qd.a.Justified;case 0:return qd.a.None;default:return qd.a.Other}}static FHk(ma){switch(ma){case 15:return qd.e.Any;case 1:return qd.e.Bullet;case 42:return qd.e.Invalid;case 13:return qd.e.Lim;case 14:return qd.e.Nil;case 16:return qd.e.NoList;case 0:return qd.e.Numbered;default:return qd.e.Invalid}}static isReference(ma){return ma.blob&&(7===ma.blob.li||10===ma.blob.li)||ma.Lh&&0<ma.Lh.length||ma.Hf&&0<ma.Hf.length||ma.Jb&&0<ma.Jb.length?!0:!1}static bjf(ma,bb,Ab){return null==bb?
null:bb[Ab]&&!bb[Ab].equals(ka.a.nil)&&ma.Mc?ma.Mc.Db(bb[Ab]):null}Fgf(ma){if(null==ma)return null;if(ma.hasProperty(ia.a.Gq)){var bb=ma.getValue(ia.a.Gq);if(Fe.mGi.has(bb))return Fe.mGi.get(bb)}if(ma.hasProperty(ia.a.Z1b)&&null!=ma.getValue(ia.a.Z1b))return qd.f.FootnoteEndnote;if(ma.hasProperty(ia.a.pageBreak)&&ma.getValue(ia.a.pageBreak))return qd.f.PageBreak;if(ma.hasProperty(ia.a.rEb)&&ma.getValue(ia.a.rEb))return qd.f.Tab;bb=!1;ma.hasProperty(Hd.a.N6)?bb=ma.getValue(Hd.a.N6):ma.hasProperty(ia.a.vfa)&&
(bb=ma.getValue(ia.a.vfa));return bb&&ma.hasProperty(ia.a.imageType)&&1==ma.getValue(ia.a.imageType)?qd.f.Image:null}static egm(ma){return ma.hasProperty(ia.a.P4b)&&0<=ma.getValue(ia.a.P4b)?!0:!1}bji(ma){return Fe.T6n.has(ma)}$vh(ma,bb,Ab,ac){return null==ma||null==bb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):ac===qd.b.Inline&&null==Ab?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),
null):ac===qd.b.Floating&&null!=Ab?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>Ab?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Fe.egm(ma)?null:this.bji(bb)?{referencedPath:["session","doc","main",ma.id.toString()],formattedRangeIndex:Ab,anchorMode:null!==ac&&void 0!==ac?ac:qd.b.Unspecified,anchoredObjectType:ac==qd.b.Floating?bb:
void 0}:null}E$g(ma,bb,Ab,ac,sc){bb=this.$vh(bb,Ab,ac,sc);null!=bb&&null!=ma&&ma.push(bb)}Qan(ma){const bb=[];if(null==ma)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),bb;let Ab=null;ma.hasProperty(ia.a.D5)&&(Ab=ma.getValue(ia.a.D5));if(null!=Ab)for(let ac=0;ac<Ab.length;++ac){const sc=Fe.bjf(ma,Ab,ac),Sc=this.Fgf(sc);null!=Sc&&this.E$g(bb,sc,Sc,null,qd.b.Floating)}return bb}fsh(ma){if(null==ma||!ma.hasProperty(Ec.a.wn))return!1;const bb=
ma.getValue(Ec.a.wn);for(let ac=0;ac<bb.length;ac++){var Ab=Fe.bjf(ma,bb,ac);Ab=this.Fgf(Ab);if(this.bji(Ab))return!0}return!1}}Fe.mGi=new Map([[5,qd.f.Image],[11,qd.f.TextBox],[7,qd.f.Chart],[6,qd.f.SmartArt],[10,qd.f.Drawing],[2,qd.f.EquationObject],[4,qd.f.Ink],[19,qd.f.PageBreak],[23,qd.f.FootnoteEndnote],[24,qd.f.FootnoteEndnote],[35,qd.f.FootnoteEndnoteReferenceMark],[36,qd.f.FootnoteEndnoteReferenceMark],[0,qd.f.Other]]);Fe.T6n=new Set([qd.f.Image,qd.f.TextBox,qd.f.Chart,qd.f.SmartArt,qd.f.Drawing,
qd.f.Ink]);Object(e.a)(Fe,"FormattingExtractor",null,[363]);var Qf=c(1039);class id extends Sys.EventArgs{constructor(ma){super();this.J4b=ma}}Object(e.a)(id,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Gg extends Sys.EventArgs{constructor(ma){super();this.K6=ma}}Object(e.a)(Gg,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class ad{constructor(ma,bb,Ab){this.QSc=ma;this.graphNode=bb;this.fullPath=Ab}}Object(e.a)(ad,"NodeEvent",null,[390]);class Kd{constructor(){this.Zte=this.Nre=!1;this.krb=
null;this.sa=new sa.a;this.Y8=new K.a(0);this.x7a=new Qf.a(Ra.a.Sj());this.Wrb=new Qf.a(Ra.a.Sj());this.Jgd=[]}gah(ma){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ma)}pyk(){this.Y8=new K.a(0);this.J4b=!1}get J4b(){return this.Nre}set J4b(ma){this.Nre!==ma&&(this.Nre=ma,this.sa.raiseEvent("HasNodeEventsChangedKey",new id(ma),this))}get K6(){return this.Zte}set K6(ma){this.Zte!==ma&&(this.Zte=ma,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Gg(ma),this))}IJb(ma,bb){this.x7a.ub(ma)||
this.x7a.Z(ma,bb)}jEn(ma,bb){this.Wrb.Z(ma,bb)}Ojl(ma){let bb=null;this.Wrb.ub(ma)&&(bb=this.Wrb.J(ma),this.Wrb.remove(ma));return bb}k3d(ma,bb){if(ma)if(this.K6){var Ab=3!==bb&&4!==bb&&5!==bb||!this.x7a.ub(String.format("{0}",ma.id))?Tb.a.gK(ma):this.x7a.J(String.format("{0}",ma.id));if(({value:ac}=this.Y8.Bc(Ab)).returnValue)if(ac||3!==bb)if(5===ac&&3===bb){if(ma=Ab.split("\\").pop(),this.Wrb.ub(ma)){var ac=this.Wrb.J(ma);ac===Ab?(this.Eyf(Ab,bb),this.Y8.add(Ab,bb)):(this.Wrb.Z(ma,Ab),this.x7a.Z(ma,
ac),this.npi(Ab),this.Y8.remove(Ab),this.Eyf(Ab,bb),this.Y8.add(ac,5))}}else ac&&(4!==ac||0!==bb&&3!==bb&&5!==bb)&&(this.Eyf(Ab,bb),this.Y8.add(Ab,bb));else this.npi(Ab),this.Y8.remove(Ab);else this.OEm(Ab,bb),this.Jgd.push(ma),this.Y8.add(Ab,bb);this.J4b=0<this.Y8.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}OEm(ma,bb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",
ma,bb)}Eyf(ma,bb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ma,bb)}npi(ma){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ma)}hFk(){let ma=null;var bb=!1;let Ab=null;for(;this.Jgd.length&&!bb;){Ab=Array.dequeue(this.Jgd);if(!Ab)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.x7a.ub(String.format("{0}",Ab.id))?(ma=this.x7a.J(String.format("{0}",Ab.id)),this.x7a.remove(String.format("{0}",
Ab.id)),this.Jgd.push(Ab)):ma=Tb.a.gK(Ab);bb=this.Y8.ub(ma)}if(!bb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.pyk(),null;bb=this.Y8.J(ma);this.Y8.remove(ma);this.J4b=0<this.Y8.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ma,bb);return new ad(bb,Ab,ma)}Zkn(ma){this.krb=ma}iFk(){if(!this.krb)return null;for(var ma=0;ma<this.krb.length;ma++){var bb=this.krb.J(ma);bb=Tb.a.gK(bb.node);if(this.Y8.ub(bb))return null}ma=this.krb;
this.krb=null;return ma}Hyk(){this.krb=null}Z3n(){this.K6=!0}Dem(ma){return this.Y8.ub(ma.id.toString())}}Object(e.a)(Kd,"NodeEventsCollection",null,[362]);var jh=c(1435),Qe=c(1363),zc=c(308),uc=c(128);class Ed extends Qe.a{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf){super();this.rcd=new jh.a;this.i7a=!1;this.Wmc=null;this.fga=(jg,ge)=>{(jg=ge.node)&&this.p3a(jg)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Tb.a.zWn(jg,this.Yia.K6,this.uOb,this.jVj)&&(this.Yia.k3d(jg,0),
this.mij(jg)));this.Yia.K6&&this.h9.Dib(jg)};this.rxi=(jg,ge)=>{jg=ge.node;this.Yia.IJb(String.format("{0}",jg.id),Tb.a.gK(jg))};this.ZGb=(jg,ge)=>{(jg=ge.node)&&this.p3a(jg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Yia.K6&&this.Yia.k3d(jg,3));this.Yia.K6&&this.h9.jAi(jg,3)};this.l3=(jg,ge)=>{jg=ge.node;ge=ge.property;jg&&this.Axj.has(ge)&&this.p3a(jg)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Yia.K6&&(this.Yia.k3d(jg,2),ge===
ia.a.mj&&this.mij(jg)));this.Yia.K6&&ge===ia.a.Nc&&this.h9.jAi(jg,2)};this.sxi=(jg,ge)=>{(jg=ge.node)&&nb.ParagraphReader.nc(jg)&&!this.Bmc.has(jg)&&!this.$oe.has(jg)&&(this.Bmc.add(jg),this.rX())};this.lAi=(jg,ge)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(jg=ge.node)&&this.Jf.rRm(jg)};this.xEf=()=>{this.u0c()?this.lU():this.i7a&&!this.Yia.K6&&this.RQa()};this.oB=bb;this.Yia=Ab;this.jVj=uc.b(ac.T5d);this.uOb=ma.$("AugLoopOperationsAreEnabled");this.Jf=sc;this.h9=Sc;this.BD=Cd;
this.Hb=ke;this.Ms=Dd;this.NH=$d;this.Bmc=new Set;this.$oe=new Set;mf.koa(this,7);this.Axj=new Set([Ec.a.mo,Ec.a.bold,Ec.a.italic,Ec.a.underline,Ec.a.font,Ec.a.fontSize,Ec.a.fontColor,Vc.a.capitalization,Ec.a.Zh,Ec.a.wn,ia.a.tga,ia.a.yna,ia.a.zj,ia.a.sga,ia.a.xna,ia.a.ra,ia.a.va,ia.a.ua,ia.a.listID,ia.a.NQ,ia.a.fe,ia.a.ova,ia.a.lv,ia.a.mj])}get index(){return 7}get UTc(){return this.Wmc}set UTc(ma){this.Wmc=ma;this.h9.qIf=ma?()=>{this.Wmc()}:null}init(){this.u0c()&&this.lU();this.Yia.gah(this.xEf)}lU(){this.oB?
(this.i7a=!0,this.oB.Wt(this.fga),this.oB.WV(this.rxi),this.oB.Zu(this.ZGb),this.oB.qp(this.l3),this.oB.Rah(this.lAi),this.oB.N8j(this.sxi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}RQa(){this.oB?(this.i7a=!1,this.oB.oU(this.fga),this.oB.kba(this.rxi),this.oB.lba(this.ZGb),this.oB.CX(this.l3),this.oB.EQi(this.lAi),this.oB.bun(this.sxi)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}XLd(ma){ma&&
this.rcd.add(ma.id,ma.ia(ia.a.mj,0))}mij(ma){this.rcd.ub(ma.id)?(this.h9.Qpo(ha.a.E9d,ma,this.rcd.J(ma.id)),this.rcd.remove(ma.id)):(this.h9.Ayk(ha.a.E9d),this.UTc&&this.UTc())}p3a(ma){const bb=W.App.xa.jb.Fc;return!!bb&&bb.Sr&&!!bb.ld&&!!bb.ld.Mc&&!!ma&&!!ma.Mc&&ma.Mc.id===bb.ld.Mc.id}run(){if(0!==this.Bmc.size){var ma=[];for(let bb of this.Bmc)ma.push(bb),this.$oe.add(bb),100<=ma.length&&(this.iFh(ma),ma=[]);0<ma.length&&this.iFh(ma);this.Bmc.clear()}}iFh(ma){const bb=new oa.a(4,1,500,()=>{for(let Ab of ma)this.$oe.delete(Ab),
this.updateAnnotationRangeData(Ab)},158);this.Hb.fc(bb)}updateAnnotationRangeData(ma){var bb=this.Ms.MYa(ma,0,ac=>this.aYn(ac.intent));if(0<bb.count)for(const ac of bb){bb=this.h9.YHl(ac.intent.id);var Ab=ma.Wka;const sc=nb.ParagraphReader.eQ(ma);ac.end<ac.begin||(Ab=zc.a.bDc(sc,Ab,ac.begin,ac.end-ac.begin,ac.begin,ac.end-ac.begin,ma),this.NH.nSf(ma.Mc,bb,Ab))}}aYn(ma){return!!ma&&this.BD.wgb(ma)&&!!ma.content}u0c(){return!this.i7a&&this.Yia.K6}}Object(e.a)(Ed,"ParagraphNodeEventHandler",Qe.a,[360]);
var Of=c(976),$b=c(389),xc=c(565),Yc=c(112);class wd extends xc.a{constructor(){super();this.H_=Object.assign(new Yc.a,{T_:wd.getTypeName(),B_:wd.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(wd,"DeltaUpdateOperation",xc.a,[]);var le=c(437);class uf{constructor(){this.referencedPath=null}}Object(e.a)(uf,"ItemReference",null,[]);class yg extends le.a{constructor(){super();this.op=this.deltas=this.delta=
this.parentPath=null}}Object(e.a)(yg,"ItemWithPath",le.a,[]);var pb=c(956);class Wb extends pb.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new Yc.a,{T_:Wb.getTypeName(),B_:Wb.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(Wb,"MoveOperation",pb.a,[]);var Oc=c(470);class nd extends Oc.a{constructor(){super();this.selectedRanges=null;this.H_=
Object.assign(new Yc.a,{T_:nd.getTypeName(),B_:nd.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(nd,"SelectionSignal",Oc.a,[]);class ve extends nd{constructor(){super();this.content=null;this.H_=Object.assign(new Yc.a,{T_:ve.getTypeName(),B_:ve.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}
Object(e.a)(ve,"SelectionContentSignal",nd,[]);class nf{constructor(){this.range=this.tileReference=null}}Object(e.a)(nf,"TextTileRange",null,[]);var pf=c(1595),Mg=c(436),Jg=c(145),rh=c(40),Tg=c(19),ak=c(291);class ci{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke){this._augLoopRuntimeManager=this.uad=null;this.zHe=!1;this.nja=this.Exe=this.Bld=null;this.Gbl=()=>{if(W.App.lostSession||$b.SessionStatusManager.instance&&$b.SessionStatusManager.instance.Bo)v.AFrameworkApplication.Ne("a596e684;c81e6109"),v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Hb.Ye(this.uad));this.Hh.Qd(()=>{var Dd;const $d=ak.a.instance.eta;this.KA()&&this.Wuk($d);for(this.Hwc.reset();this.zTa.J4b&&!this.Hwc.Whb();){let ge;ge=this.zTa.hFk();if(!ge||!ge.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");
this.Hwc.update();continue}if(!this.iWn(ge)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",ge.graphNode.id);this.Hwc.update();continue}const ng=ge.graphNode.id.toString();var mf=-1,jg=!0;$d&&Tg.SelectionEditor.zf($d)&&ng==$d.node.id.toString()&&(mf=$d.cpBegin,jg=!1);let Sg=null;if(this.Ftb.contains(ng))switch(ge.QSc){case 3:this.Ftb.remove(ng);Sg=3;break;default:Sg=ge.QSc}else switch(ge.QSc){case 0:case 1:this.Ftb.add(ng);Sg=0;break;case 2:this.Ftb.add(ng);
Sg=0;break;case 3:this.Ftb.remove(ng);Sg=3;break;default:Sg=ge.QSc}if(null!=Sg){mf=this.Igf(ge.graphNode,ge.fullPath,Sg,mf,jg);if(4==Sg||5==Sg){if(mf.prevParentPath.join()!==mf.parentPath.join()){jg=Object.assign(new Oa.a,{parentPath:mf.prevParentPath,items:mf.items});const qj=Object.assign(new Ga.a,{parentPath:mf.parentPath,items:mf.items,prevId:mf.prevId,nextId:mf.nextId});this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,{operation:jg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,
{operation:qj}));ge.graphNode.type===Jg.a.table&&this.lYi(ge.graphNode,mf.parentPath).forEach(wi=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,{operation:wi}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,{operation:mf}));if(this.o7c&&this.nja&&this.nja[0]==ng)switch(Sg){case 3:this.nja=null;break;case 0:case 1:case 2:case 4:case 5:this.nja[1]=null===(Dd=this.Yrb.dBb(ge.graphNode))||void 0===Dd?void 0:Dd.QHc(ge.graphNode)}a.ULS.sendTraceTag(40776388,
389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",ja.a.getTypeNameFor(mf),ng);switch(Sg){case 0:case 4:case 5:this.Jf.B_m(ge.graphNode);break;case 3:this.Jf.C_m(ge.graphNode,mf.parentPath.join("\\"))}}this.Hwc.update()}(Dd=this.zTa.iFk())&&this.hSi(Dd)},"TV:FPEFO")};this.Pna=(Dd,$d)=>{var mf;if($d.kl&&$d.kl.length){if(this.o7c)if(Dd=Tb.a.DCl($d.kl),!Dd)this.nja=null;else if(!this.nja||this.nja[0]!=Dd.id.toString()){const jg=this.zTa.Dem(Dd)?null:null===
(mf=this.Yrb.dBb(Dd))||void 0===mf?void 0:mf.QHc(Dd);this.nja=[Dd.id.toString(),jg]}this.zHe&&(this.sii()?this.zTa.Zkn($d.kl.kb):this.G1i(!1))}};this.Oa=ma;this.zTa=bb;this.Hb=Ab;this.Hwc=ac;this.dyj=this.Oa.$("AugLoopOperationsAreEnabled");this.Ftb=new Ba.a(Ra.a.Sj());this.Jf=sc;this.Hh=Sc;this.Yrb=Cd;this.hb=ke;this.RD=new P.a(()=>W.App.xa.jb.Xc.Ad);this.o7c=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.tB(this.Pna);Tb.a.Qm().then(()=>{this._augLoopRuntimeManager=
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();v.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Oa.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new pf.a,{handler:Dd=>{this.Jf.uck(Dd)}}));this.dyj&&this.zTa.Z3n();this.P4n()}).catch(()=>{})}Wuk(ma){const bb=[],Ab=this.Jf.PPb.entries();for(let ac=0;ac<this.Jf.PPb.size;ac++){const sc=Ab.next();(2E3<=Date.now()-sc.value[1]||
ma.node.id!=sc.value[0])&&bb.push(sc.value[0])}bb.forEach(ac=>{this.Jf.PPb.delete(ac);(ac=Tb.a.aJc(this.RD.value,ac))?this.Ido(ac):a.ULS.sendTraceTag(520734497,389,50,"checkAndTriggerProofingForDelayedNodes: Stale node.")})}iWn(ma){return 3===ma.QSc||Tb.a.t5i(ma.graphNode)}P4n(){!this.uad&&this.zTa.K6&&(this.uad=new oa.a(4,2,this.Oa.rc("NodeEventsFiringInterval",500),this.Gbl,131),this.Hb.fc(this.uad))}lYi(ma,bb){var Ab,ac=[];const sc=me.GraphIterator.Za(ma),Sc=sc.Mp();for(var Cd=0;Cd<Sc;Cd++){let ke=
sc.EF(Cd);ke.type===Jg.a.outlineElement&&(ke=rh.OutlineElementNavigator.Fe(sc));const Dd=ke.id.toString(),$d=null===(Ab=this.Yrb.dBb(ke))||void 0===Ab?void 0:Ab.Cxb(ke);ac.push(Object.assign(new le.a,{body:$d,id:Dd,revId:Tb.a.ijf(ke)}));sc.kd(ma.type)}bb.push(ma.id.toString());Ab=[];Ab.push(Object.assign(new Ga.a,{parentPath:bb.slice(),items:ac,prevId:null}));for(ac=0;ac<Sc;ac++)Cd=sc.EF(ac),Cd.type===Jg.a.outlineElement&&(Cd=rh.OutlineElementNavigator.Fe(sc)),0<sc.Mp()&&(Ab=Ab.concat(this.lYi(Cd,
bb))),sc.kd(ma.type);bb.pop();return Ab}aMa(ma){return ma.split("\\").slice(0,-1)}Igf(ma,bb,Ab,ac=-1,sc=!0){var Sc;let Cd=null,ke=null;const Dd=ma.id.toString();var $d=null;3!==Ab&&($d=Tb.a.ipk(ma));if($d)for(let mf=0;mf<$d.length;mf++)if($d[mf]===Dd){ke=mf+1<$d.length?$d[mf+1]:null;Cd=mf?$d[mf-1]:null;break}$d=null===(Sc=this.Yrb.dBb(ma))||void 0===Sc?void 0:Sc.Cxb(ma,ac,sc);ac=[Object.assign(new le.a,{body:$d,id:Dd,revId:Tb.a.ijf(ma)})];switch(Ab){case 0:case 1:return Object.assign(new Ga.a,{parentPath:this.aMa(bb),
items:ac,prevId:Cd,nextId:ke});case 4:return Object.assign(new Wb,{parentPath:this.aMa(Tb.a.gK(ma)),prevParentPath:this.aMa(bb),items:ac,prevId:Cd,nextId:ke});case 5:return Ab=this.zTa.Ojl(Dd),Object.assign(new Wb,{parentPath:this.aMa(null!==Ab&&void 0!==Ab?Ab:Tb.a.gK(ma)),prevParentPath:this.aMa(bb),items:ac,prevId:Cd,nextId:ke});case 2:return Object.assign(new Za.a,{parentPath:this.aMa(bb),items:ac});case 3:return Object.assign(new Oa.a,{parentPath:this.aMa(bb),items:ac});default:return a.ULS.sendTraceTag(42084322,
389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",Ab,Dd),Object.assign(new pb.a,{parentPath:this.aMa(bb),items:ac,prevId:Cd,nextId:ke})}}VOl(ma){return this.nja&&this.nja[0]===ma?this.nja[1]:null}vIn(ma){var bb;if(!this.o7c)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Tb.a.t5i(ma))return!1;const Ab=ma.id.toString();var ac=this.Ftb.contains(Ab)?2:0;ac=this.Igf(ma,Tb.a.gK(ma),ac);this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,
{operation:ac}));this.Ftb.add(Ab);this.nja=[Ab,null===(bb=this.Yrb.dBb(ma))||void 0===bb?void 0:bb.QHc(ma)];return!0}sHn(ma,bb){var Ab;if(this.o7c){var ac=ma.id.toString(),sc=this.aMa(Tb.a.gK(ma));bb=[Object.assign(new yg,{id:ac,revId:Tb.a.ijf(ma),parentPath:sc,delta:bb})];sc=Object.assign(new wd,{parentPath:sc,items:bb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,{RFo:sc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",ac);this.nja=[ac,null===(Ab=this.Yrb.dBb(ma))||
void 0===Ab?void 0:Ab.QHc(ma)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}Bgk(ma,bb){if(ma.tileReference.referencedPath.length!==bb.tileReference.referencedPath.length||ma.range.start!==bb.range.start||ma.range.length!==bb.range.length)return!1;for(let Ab=0;Ab<ma.tileReference.referencedPath.length;Ab++)if(ma.tileReference.referencedPath[Ab]!==bb.tileReference.referencedPath[Ab])return!1;return!0}xgk(ma,bb){if(ma.selectedRanges.length!==bb.selectedRanges.length||
ma.content!==bb.content)return!1;for(let Ab=0;Ab<ma.selectedRanges.length;Ab++)if(!this.Bgk(ma.selectedRanges[Ab],bb.selectedRanges[Ab]))return!1;return!0}hSi(ma){var bb;if(ma){var Ab=new fb.a,ac="";for(let Cd=0;Cd<ma.length;Cd++){var sc=ma.J(Cd),Sc=(null===(bb=this.Yrb.dBb(sc.node))||void 0===bb?void 0:bb.Cxb(sc.node)).content;ac+=Sc;Sc=sc.cpBegin<Sc.length?sc.cpBegin:-1;Sc=Object.assign(new qa.a,{start:Sc,length:sc.cpEnd-sc.cpBegin});const ke=sc.node.id.toString();sc=this.aMa(Tb.a.gK(sc.node));
sc.push(ke);Ab.add(Object.assign(new nf,{range:Sc,tileReference:Object.assign(new uf,{referencedPath:sc})}))}ma=Object.assign(new ve,{selectedRanges:Ab.toArray(),content:ac});this.Exe&&this.xgk(ma,this.Exe)||(bb=this.Bld?this.Bld:ka.a.create().toString(),Ab=[Object.assign(new le.a,{body:ma,id:bb})],this.Bld?bb=Object.assign(new Za.a,{parentPath:["session","doc"],items:Ab}):(this.Bld=bb,bb=Object.assign(new Ga.a,{parentPath:["session","doc"],items:Ab})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,
{operation:bb})),this.Exe=ma)}}aRn(ma){this.sii()&&this.G1i(ma)}G1i(ma){(this.zHe=ma)?this.hSi(this.hb.ib.kb):this.zTa.Hyk()}sii(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSendSelectionSignalToAugloop",!1)}Ido(ma){ma=this.Igf(ma,Tb.a.gK(ma),2);this._augLoopRuntimeManager.submitOperation(Object.assign(new Mg.a,{operation:ma}))}KA(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}
Object(e.a)(ci,"TileView",null,[361]);var Af=c(46),Ef=c(110);class Ue{constructor(ma){Ef.a.assign(Ue,this,ma)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ma){return Ef.a.matchesTypesFor(ma,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class Df{constructor(ma){Ef.a.assign(Df,this,ma)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ma){return Ef.a.matchesTypesFor(ma,[Df.getTypeName()])}}
Df.H_={T_:Df.getTypeName(),B_:Df.getBaseTypes()};class Sf{constructor(ma){Ef.a.assign(Sf,this,ma)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ma){return Ef.a.matchesTypesFor(ma,[Sf.getTypeName()])}}Sf.H_={T_:Sf.getTypeName(),B_:Sf.getBaseTypes()};class Se{constructor(ma){Ef.a.assign(Se,this,ma)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ma){return Ef.a.matchesTypesFor(ma,
[Se.getTypeName()])}}Se.H_={T_:Se.getTypeName(),B_:Se.getBaseTypes()};class Ii{constructor(ma){Ef.a.assign(Ii,this,ma)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ma){return Ef.a.matchesTypesFor(ma,[Ii.getTypeName()])}}Ii.H_={T_:Ii.getTypeName(),B_:Ii.getBaseTypes()};var hg;(function(ma){ma[ma.Top=0]="Top";ma[ma.Center=1]="Center";ma[ma.Bottom=2]="Bottom"})(hg||(hg={}));var Fg;(function(ma){ma[ma.none=
0]="none";ma[ma.firstRow=32]="firstRow";ma[ma.lastRow=64]="lastRow";ma[ma.firstCol=128]="firstCol";ma[ma.lastCol=256]="lastCol";ma[ma.noHBand=512]="noHBand";ma[ma.noVBand=1024]="noVBand";ma[ma.nwCell=160]="nwCell";ma[ma.neCell=288]="neCell";ma[ma.swCell=192]="swCell";ma[ma.seCell=320]="seCell";ma[ma.defaultLook=1184]="defaultLook"})(Fg||(Fg={}));Object(e.b)("TableLookFlags",Fg);class qf{Cxb(ma){if(ma)switch(ma.type){case 14:return this.FPk(ma);case 15:return new Ue;case 16:return this.EPk(ma)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}FPk(ma){var bb=ma.Mx||[];let Ab=0;for(let ac=0;ac<bb.length;ac++)Ab+=bb[ac];bb=bb.map((ac,sc)=>({columnId:sc.toString(),widthPercent:0!=Ab?100*ac/Ab:0}));return new Se({columnDefs:bb,tableLook:ma.properties.ia(ia.a.tableLook,Fg.defaultLook),complexTable:ma.properties.ia(ia.a.complexTable,!1),floatingTable:ma.properties.ia(ia.a.lei,!1)})}EPk(ma){return new Df({rowspan:ma.properties.ia(ia.a.rowSpan,1),colspan:ma.properties.ia(ia.a.colSpan,1),borderInfo:{topBorder:{color:ma.properties.ia(ia.a.Klb,
0),size:ma.properties.ia(ia.a.NLb,4),style:ma.properties.ia(ia.a.U3a,"single")},leftBorder:{color:ma.properties.ia(ia.a.Ilb,0),size:ma.properties.ia(ia.a.LLb,4),style:ma.properties.ia(ia.a.S3a,"single")},rightBorder:{color:ma.properties.ia(ia.a.Jlb,0),size:ma.properties.ia(ia.a.MLb,4),style:ma.properties.ia(ia.a.T3a,"single")},bottomBorder:{color:ma.properties.ia(ia.a.Hlb,0),size:ma.properties.ia(ia.a.KLb,4),style:ma.properties.ia(ia.a.R3a,"single")}},verticalAlignment:ma.properties.ia(ia.a.Hoa,hg.Top),
ghostCell:ma.properties.ia(ia.a.ghostCell,!1),renderCell:ma.properties.ia(ia.a.renderCell,!1),skippedCell:ma.properties.ia(ia.a.skippedCell,!1),fillColor:ma.properties.ia(Ec.a.cI,0),verticalMerge:ma.properties.ia(Af.a.vMerge,null)})}QHc(ma){return null===ma||void 0===ma?void 0:ma.properties}}Object(e.a)(qf,"TableElementNodeToTileConverter",null,[359]);class Cg{constructor(ma,bb,Ab){this.Op=bb;this.rwa=Ab;this.zBd=!1;this.Wmc=null;this.XBi=(ac,sc)=>{this.Gva(sc.node,0)};this.TBi=(ac,sc)=>{ac=sc.node;
this.rwa.IJb(ac.id.toString(),Tb.a.gK(ac))};this.YBi=(ac,sc)=>{this.Gva(sc.node,3)};this.XYd=(ac,sc)=>{this.Gva(sc.node,2)};this.$Bi=(ac,sc)=>{this.Gva(sc.node,0)};this.aCi=(ac,sc)=>{this.Gva(sc.node,3)};this.ZBi=(ac,sc)=>{ac=sc.node;this.rwa.IJb(ac.id.toString(),Tb.a.gK(ac))};this.YYd=(ac,sc)=>{this.Gva(sc.node,2)};this.VBi=(ac,sc)=>{this.Gva(sc.node,0)};this.UBi=(ac,sc)=>{ac=sc.node;this.rwa.IJb(ac.id.toString(),Tb.a.gK(ac))};this.WBi=(ac,sc)=>{this.Gva(sc.node,3)};this.VYd=(ac,sc)=>{var Sc;ac=
sc.node;if(sc.property===ia.a.ghostCell){if(sc=ac.gg?ac:null===(Sc=ac.Oua)||void 0===Sc?void 0:Sc.controlCell){Sc=me.GraphIterator.Za(sc);var Cd=Sc.Mp();for(var ke=0;ke<Cd;ke++){Sc.EF(ke);var Dd=rh.OutlineElementNavigator.Fe(Sc);this.rwa.IJb(Dd.id.toString(),String.format("{0}\\{1}",Tb.a.gK(sc),Dd.id));this.Gva(Dd,4);Sc.kd(16)}}}else if(sc.property===Ec.a.$e){sc=me.GraphIterator.Za(ac);Sc=sc.Mp();let $d=null;Cd=[];for(ke=0;ke<Sc;ke++){sc.EF(ke);Dd=rh.OutlineElementNavigator.Fe(sc);this.rwa.jEn(Dd.id.toString(),
String.format("{0}\\{1}",Tb.a.gK(ac),Dd.id));if(14!==Dd.type){if($d=Tb.a.gK(Dd))this.rwa.IJb(Dd.id.toString(),$d),this.Gva(Dd,5)}else Cd.push(Dd);sc.kd(16)}$d&&Cd.forEach(mf=>{this.rwa.IJb(mf.id.toString(),String.format("{0}\\{1}",$d.split("\\").slice(0,-1).join("\\"),mf.id));this.Gva(mf,5)})}this.Gva(ac,2)};this.xEf=()=>{this.u0c()?this.lU():this.zBd&&!this.rwa.K6&&this.RQa()};this.uOb=ma.$("AugLoopOperationsAreEnabled")}get UTc(){return this.Wmc}init(){this.u0c()&&this.lU();this.rwa.gah(this.xEf)}lU(){const {Maj:ma,
wae:bb,Aaj:Ab}=this.FRh();if(ma&&bb&&Ab){this.zBd=!0;var ac=this.TBi,sc=this.YBi,Sc=this.XYd;ma.Wt(this.XBi);ma.WV(ac);ma.Zu(sc);ma.qp(Sc);ac=this.ZBi;sc=this.aCi;Sc=this.YYd;bb.Wt(this.$Bi);bb.WV(ac);bb.Zu(sc);bb.qp(Sc);ac=this.UBi;sc=this.WBi;Sc=this.VYd;Ab.Wt(this.VBi);Ab.WV(ac);Ab.Zu(sc);Ab.qp(Sc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}RQa(){const {Maj:ma,wae:bb,Aaj:Ab}=this.FRh();if(ma&&bb&&Ab){this.zBd=!1;var ac=this.TBi,sc=
this.YBi,Sc=this.XYd;ma.oU(this.XBi);ma.kba(ac);ma.lba(sc);ma.CX(Sc);ac=this.ZBi;sc=this.aCi;Sc=this.YYd;bb.oU(this.$Bi);bb.kba(ac);bb.lba(sc);bb.CX(Sc);ac=this.UBi;sc=this.WBi;Sc=this.VYd;Ab.oU(this.VBi);Ab.kba(ac);Ab.lba(sc);Ab.CX(Sc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}Gva(ma,bb){ma&&this.p3a(ma)&&this.rwa.K6&&this.uOb&&this.rwa.k3d(ma,bb)}FRh(){return{Maj:this.Op.Ve(14),wae:this.Op.Ve(15),Aaj:this.Op.Ve(16)}}p3a(ma){const bb=
W.App.xa.jb.Fc;return!!bb&&bb.Sr&&!!bb.ld&&!!bb.ld.Mc&&!!ma&&!!ma.Mc&&ma.Mc.id===bb.ld.Mc.id}u0c(){return!this.zBd&&!!this.rwa.K6}}Object(e.a)(Cg,"TableNodeEventHandler",null,[360]);class Hh{constructor(ma,bb){this.GEi=ma;this.y8n=bb}dBb(ma){return ma?14===ma.type||15===ma.type||16===ma.type?this.y8n:12===ma.type?this.GEi:null:null}}Object(e.a)(Hh,"NodeToTileConverterHolder",null,[358]);var aj=c(390);class df{get name(){return"Box4.AugmentationLoop"}zc(ma){this.W=ma;const bb=this.W.resolve("Common.IAppSettingsManager"),
Ab=bb.$("AugLoopTaskUseTimeBasedYieldStrategy"),ac=new Kd,sc=Ab?new Y.a(bb.rc("AugLoopTaskAllowedRunTimeBeforeYielding",10),H.a.kf):new X(bb.rc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>I.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new tb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Ed(bb,W.App.ik.ml.Ve(12),ac,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),v.AFrameworkApplication.uc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();Tb.a.q8d()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",
()=>new Cg(bb,W.App.ik.ml,ac)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new G).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new Fe(this.W.resolve("Common.IAppSettingsManager"),this.W.Pa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>
new ha.a(new P.a(()=>W.App.xa.jb.Xc.Ad),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new Xb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new P.a(()=>W.App.xa.jb.Xc.Ad),ma.resolve("Box4.IFeatureHelper"))).singleInstance();const Sc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",
()=>new Bb(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new P.a(()=>W.App.xa.jb.Xc.Ad),v.AFrameworkApplication.uc,this.W.Pa("Box4.IIntelligenceReader"),this.W.Pa("Box4.IIntelligenceEditor"),this.W.Pa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Pa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ma.resolve("Box4.IFeatureHelper"),aj.a.instance,()=>{try{return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}catch(Cd){return a.ULS.sendTraceTag(50935320,
389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Cd),null}},Sc)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new Hh(new Of.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new qf)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new ci(bb,ac,v.AFrameworkApplication.uc,sc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new Jb).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new gb).singleInstance()}init(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",
!1)&&v.AFrameworkApplication.cZ.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(v.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ma=new ob(this.W.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.af,W.App.wha,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),S.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),
bb=new ca;this.W.register(354,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().oro(()=>bb);v.AFrameworkApplication.Ne("b8afb343;bjdjj400");const Ab=Tb.a.zum(this.W.resolve("Common.IDynamicScriptLoaderProvider").LD,this.W.resolve("Common.App.OAuth.IOAuthManager"),ma,this.W.resolve("Common.ISharedDependencyLoader"),bb);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Fb(Ab)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();
Tb.a.q8d()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ma){x.a.instance.Pc(new df,0,ma);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(df,"Box4AugmentationLoopPackage",null,[1,2]);var ld=c(619),dj=c(48),Yh=c(14),Nl=c(446),ij=c(1122);class ck{constructor(ma,
bb,Ab,ac=null,sc=null,Sc=null){this.KS=new ij.a(bb,ac,sc,Sc);this.Ob=ma;this.Oc=Ab}get type(){return this.KS.type}get id(){return this.KS.id}get intent(){return this.KS.intent}Yf(ma){return new ck(ma,this.type,this.Oc,this.id,this.intent,this.KS.cva)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.KS,this.Oc)}}Object(e.a)(ck,"IntentObject",null,[174]);var Mk=c(505),Wf=c(150),cg=c(231);class bl{constructor(){this.Knc=new Wf.a}Lqd(ma,bb,Ab,ac,sc=null,Sc=null,Cd=null){ma=ma.w$(bb,
ma.qa.leo(bb));ma.pk||(ma.pk=new Mk.a(ma));ma.pk.add(new ck(ma,Ab,ac,sc,Sc,Cd));ma.isFromErrorRangeSplit=!0}iPi(ma){return ma.Ob&&ma.Ob.pk&&ma.Ob.pk.aYc(bb=>bb===ma,[ma.type])?!0:!1}nsn(ma,bb){if(ma.type===bb.type&&ma.Oc&&!bb.Oc&&ma.Ob&&ma.Ob.pk&&ma.Ob.pk.contains(ma)&&bb.Ob&&bb.Ob.pk&&bb.Ob.pk.contains(bb)){var Ab=[ma.type];ma.Ob.pk.aYc(ac=>ac===ma,Ab);bb.Ob.pk.aYc(ac=>ac===bb,Ab)}}gso(ma,bb,Ab){if(!bb)return!1;Ab=new qb.a([Ab]);for(let ac=0;ac<ma.length;ac++){const sc=ma.J(ac);if(!sc.pk)continue;
let Sc=!0;Ab.I4a(sc.pk,void 0,Cd=>{Cd.id&&bb.equals(Cd.id)&&(Sc=!1)});if(!Sc)return!1}return!0}X9m(ma,bb,Ab,ac){let sc=null,Sc=null;bb=new qb.a([bb]);const Cd=ma.qa;for(let ke=0;ke<Cd.length;ke++){const Dd=Cd.J(ke);if(!Dd.pk)continue;let $d=!0;bb.I4a(Dd.pk,void 0,(mf,jg)=>{if(jg){var ge=jg.Ob.cp<Ab,ng=mf.Ob.cp>ac;ge&&mf.Ob.cp<=Ab||jg.Ob.cp>=ac&&ng||(ge&&ng?$d=!1:ge?sc=mf:ng?Sc=jg:this.nsn(jg,mf))}});if(!$d)return!1}if(sc){if(!this.iPi(sc))return!1;this.Lqd(ma,Ab,sc.type,sc.Oc,sc.id,sc.intent,sc.KS.cva)}if(Sc){if(!this.iPi(Sc))return!1;
this.Lqd(ma,ac,Sc.type,Sc.Oc,Sc.id,Sc.intent,Sc.KS.cva)}return!0}b0f(ma){let bb;return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:bb}=this.Knc.Bc(ma.type,bb)).returnValue?bb.b0f(ma):!0}bHm(ma,bb){if(this.b0f(bb)){var Ab=bb.id,ac=bb.type,sc=bb.begin,Sc=bb.end;if(({cpEnd:Sc}=bl.Ylj(ma,sc,Sc)).returnValue){if(Nl.a(ac)){if(!this.gso(ma.qa,Ab,ac))return}else if(!this.X9m(ma,ac,sc,Sc))return;this.Lqd(ma,sc,ac,!0,Ab,bb.intent,bb.KS.cva);this.Lqd(ma,
Sc,ac,!1,Ab,bb.intent,bb.KS.cva)}}}T_d(ma,bb){W.App.xa.t7e(ma,()=>{const Ab=new dj.GraphTransaction(2);try{Ab.Eb(ma);const ac=ma.QX();try{const sc=ma.rZ();try{bb()}finally{sc&&sc.dispose()}}finally{ac&&ac.dispose()}}finally{Ab&&Ab.dispose()}})}E9b(ma,bb){this.T_d(ma,()=>{this.bHm(ma,bb)})}dHm(ma,bb){if(bb.count){var Ab=new Ea.a,ac=new cg.a;for(var sc of bb){var Sc=sc.value;Nl.a(sc.key)||Sc.Sc((ke,Dd)=>ke.begin!==Dd.begin?ke.begin-Dd.begin:ke.end-Dd.end);if(bl.lso(Sc))for(var Cd of Sc)Sc=Cd.end,({cpEnd:Sc}=
bl.Ylj(ma,Cd.begin,Sc)).returnValue&&(Sc=Sc!==Cd.end?new Xa.a(Cd.type,Cd.begin,Sc,Cd.id,Cd.intent,Cd.KS.cva):Cd,Ab.add(Sc.begin),Ab.add(Sc.end),bl.F4j(ac,Sc))}ma.YAd(Ab);ma=ma.qa;for(Ab=0;Ab<ma.length;Ab++){sc=ma.J(Ab);if(Cd=sc.pk)for(const Dd of bb.keys)Cd.bQi(Dd);let ke;({value:ke}=ac.Bc(sc.cp,ke)).returnValue||(ke=null);if(ke){Cd||(Cd=sc.pk=new Mk.a(sc));for(const Dd of ke)Cd.add(Dd.Yf(sc))}sc.isFromErrorRangeSplit=!0}}}Gzf(ma,bb){const Ab=new Wf.a;for(const ac of bb){let sc;({value:sc}=Ab.Bc(ac.type,
sc)).returnValue||(sc=new fb.a,Ab.Z(ac.type,sc));sc.add(ac)}this.T_d(ma,()=>{this.dHm(ma,Ab)})}uho(ma,bb){ma=ma.qa;for(let Ab=0;Ab<ma.length;Ab++){const ac=ma.J(Ab);ac.pk&&ac.pk.bQi(bb)}}whc(ma,bb){this.T_d(ma,()=>{this.uho(ma,bb)})}tho(ma,bb,Ab){let ac=!1;bb=bb.qa;Ab=[Ab];for(let sc=0;sc<bb.length;sc++){const Sc=bb.J(sc);Sc.pk&&(ac=Sc.pk.aYc(ma,Ab)||ac)}return ac}l8f(ma,bb,Ab){let ac=!1;this.T_d(bb,()=>{ac=this.tho(ma,bb,Ab)});return ac}iUh(ma,bb,Ab,ac){return!ma||0>Ab||ac>ma.characterData.length||
Ab>ac?new fb.a:this.MYa(ma,bb,sc=>Math.max(sc.begin,Ab)<=Math.min(sc.end,ac))}MYa(ma,bb,Ab){return bl.Xxl(ma,bb,Ab)}static Xxl(ma,bb,Ab){const ac=new fb.a;ma=ma.qa;bb=new qb.a([bb]);if(!ma)return ac;for(let sc=0;sc<ma.length;sc++){const Sc=ma.J(sc);Sc.pk&&bb.I4a(Sc.pk,void 0,(Cd,ke)=>{ke&&(Cd=new Xa.a(ke.type,ke.Ob.cp,Cd.Ob.cp,ke.id,ke.intent,ke.KS.cva),Ab(Cd)&&ac.add(Cd))})}return ac}LIc(ma,bb){const Ab=new fb.a;if(!bl.Uom(ma.contextId))return Ab;let ac;const sc=ma.node;ma.contextId!==Yh.a.paragraph?
(ac=ma.cpBegin,ma=ma.cpEnd):(ac=0,ma=sc.characterData.length);Ab.addRange(this.iUh(sc,bb,ac,ma));return Ab}pon(ma){this.Knc.ub(0)||this.Knc.Z(0,ma)}static Ylj(ma,bb,Ab){ma=nb.ParagraphReader.textLength(ma);if(bb>=ma)return{returnValue:!1,cpEnd:Ab};Ab>ma&&(Ab=ma);return{returnValue:!0,cpEnd:Ab}}static lso(ma){if(!ma.count)return!0;const bb=new ld.a,Ab=ma.J(0).type,ac=Nl.a(Ab);let sc=-1;for(const Sc of ma){if(Sc.type!==Ab||(Nl.c(Sc.type)?Sc.begin>Sc.end:Sc.begin>=Sc.end))return!1;if(ac){ma=Sc.id;if(!ma||
ma.equals(ka.a.nil)||bb.contains(ma))return!1;bb.add(ma)}else if(-1===sc)sc=Sc.end;else if(sc>Sc.begin)return!1}return!0}static F4j(ma,bb){let Ab;({value:Ab}=ma.Bc(bb.begin,Ab)).returnValue||(Ab=new fb.a,ma.Z(bb.begin,Ab));Ab.add(new ck(null,bb.type,!0,bb.id,bb.intent,bb.KS.cva));({value:Ab}=ma.Bc(bb.end,Ab)).returnValue||(Ab=new fb.a,ma.Z(bb.end,Ab));Ab.add(new ck(null,bb.type,!1,bb.id,bb.intent,bb.KS.cva))}static Uom(ma){return ma===Yh.a.Hd||ma===Yh.a.Wc||ma===Yh.a.paragraph}}Object(e.a)(bl,"IntentRangeEditor",
null,[364]);class tl{constructor(){this.W=null}get name(){return"Box4.Intent"}zc(ma){this.W=ma;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new bl).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ma){x.a.instance.Pc(new tl,0,ma);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(e.a)(tl,"PackageManager",null,[1,2]);var ki=c(991),ul=c(123),Cf=c(1367);class gm{constructor(ma){this.wFm=ma;this.sFm=
[]}get handler(){return this.wFm}get dla(){return this.sFm}}Object(e.a)(gm,"RegisteredListener",null,[]);class zd{constructor(ma,bb){this.type=0;this.payload=null;this.type=ma;this.payload=bb}}Object(e.a)(zd,"OfficeSharedCommentsEvent",null,[897]);class dk{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(e.a)(dk,"ViewContainerEvent",null,[897]);var Bj=c(577);class tj{constructor(ma){this.azf=!1;this.ana=new fb.a;this.yUd=ma}Onn(ma){ma=new gm(ma);
this.ana.add(ma)}Jgj(ma){for(let bb=0;bb<this.ana.count;++bb)if(this.ana.J(bb).handler===ma){this.ana.removeAt(bb);break}}JPa(ma=!1){const bb=()=>{if(v.AFrameworkApplication.Tk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let sc=0;sc<this.ana.count;++sc){const Sc=this.ana.J(sc);for(;0<Sc.dla.length;){var Ab=Array.dequeue(Sc.dla);if(Object(ul.a)(dk,Ab)){var ac=Sc.handler;ac(Ab)}else Object(ul.a)(zd,Ab)&&(ac=Sc.handler,ac(Ab.type,
Ab.payload))}}};ma?bb():this.azf||(this.azf=!0,Bj.a.E1(this.yUd,()=>{bb();this.azf=!1},Cf.a.Gdl))}}Object(e.a)(tj,"GenericEventHost",null,[]);class mk{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=
null}}Object(e.a)(mk,"BasicEventPayload",null,[968]);class Tm{constructor(ma){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ma}}Object(e.a)(Tm,"CommentContextDetails",null,[]);class sm{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(sm,"ContextChangeWithSelectedThreadIndex",null,[968]);class Xl{constructor(){this.tasks=
this.comments=null}}Object(e.a)(Xl,"LoadCommentsNoVirtualization",null,[968]);class ni extends tj{constructor(ma){super(ma);this.d_g=0}qQn(ma){this.d_g=ma}xon(ma,bb,Ab,ac,sc,Sc){ma=new gm(ma);Sc&&Array.enqueue(ma.dla,this.QJk(Sc,this.d_g));Sc=bb?bb.length:0;Array.enqueue(ma.dla,this.Euh(Sc,Ab,ac,0));Sc&&Array.enqueue(ma.dla,this.Avh(bb,sc));this.ana.add(ma);this.JPa()}zhc(ma){this.Jgj(ma)}oHn(ma,bb,Ab,ac=0){this.RCb(this.Euh(ma,bb,Ab,ac));this.JPa()}pHn(ma,bb,Ab){this.RCb(this.pKk(ma,bb,Ab));this.JPa()}KHn(ma,
bb){this.RCb(this.Avh(ma,bb));this.JPa()}selectComment(ma){this.RCb(this.xwh(ma,6));this.JPa()}highlightComment(ma){this.RCb(this.xwh(ma,7));this.JPa()}u9f(ma,bb){this.RCb(this.pNk(ma,bb));this.JPa()}GMf(ma,bb){this.RCb(this.kPk(ma,bb));this.JPa()}QJk(ma,bb=0){const Ab=new mk;Ab.modelCapabilityFlags=ma;Ab.richTextCapabilityFlags=bb;return new zd(12,Ab)}Euh(ma,bb,Ab,ac){const sc=new mk;sc.numberOfComments=ma;sc.numberOfThreads=bb;sc.contextDetails=Object.assign(new Tm(Ab),{nextPopulatedContextDetails:ac});
sc.contextDrafts=null;sc.rehydrationDrafts=null;return new zd(0,sc)}pKk(ma,bb,Ab){const ac=new mk;ac.comments=ma;ac.numberOfThreads=bb;ac.tasks=Ab;return new zd(2,ac)}Avh(ma,bb){const Ab=new Xl;Ab.comments=ma;Ab.tasks=bb;return new zd(1,Ab)}xwh(ma,bb){const Ab=new mk;Ab.commentId="";ma&&(Ab.commentId=ma);return new zd(bb,Ab)}pNk(ma,bb){const Ab=new mk;Ab.changes=[];Ab.contextDetails=Object.assign(new Tm(bb),{nextPopulatedContextDetails:ma});return new zd(10,Ab)}kPk(ma,bb){const Ab=new mk;Ab.commentId=
ma;Ab.smartReplies=bb;return new zd(15,Ab)}RCb(ma){for(let bb=0;bb<this.ana.count;++bb)Array.enqueue(this.ana.J(bb).dla,ma)}}Object(e.a)(ni,"OfficeSharedCommentsEventHost",tj,[957]);var uh=c(206),yh=c(167),ll=c(233);class dn{constructor(){this.iHe=this.nvg=!1;this.mS=this.Ym=this.lKg=this.rQg=this.rpd=this.PTb=this.N3g=this.Vzg=this.LD=this.Jvc=null}initialize(ma,bb,Ab,ac=null,sc=null,Sc=null,Cd=null,ke=null,Dd=null,$d=null){this.LD=ma;this.Vzg=bb;this.N3g=Ab;this.PTb=ac;this.rpd=sc;this.rQg=Sc;this.lKg=
Cd;this.Ym=ke;this.nvg=!0;this.mS=Dd;this.Jvc=$d}cNd(ma=null,bb=null){if(!this.nvg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Ab,ac)=>{ac(Bj.a.RC(-2130915313))});if(this.iHe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.Jvc||(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.Jvc=appResourceLoader.loadChunk("sharedComments"):
this.Jvc=this.LD.loadScript("sharedComments"));return this.Jvc.then(()=>{ma&&ma();this.iHe||(this.mS&&this.mS.execute(Ab=>{Ab.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),bb&&bb(),sharedComments.instantiate(this.Vzg,this.N3g,this.PTb,this.rpd,this.rQg,this.lKg,this.Ym));this.iHe=!0})}}Object(e.a)(dn,"CommentActivationManager",null,[1E3]);class Gl extends tj{constructor(ma){super(ma)}jqn(ma){this.Onn(ma)}mio(ma){this.Jgj(ma)}t2i(ma){ma=
this.lKk(ma);for(let bb=0;bb<this.ana.count;++bb)Array.enqueue(this.ana.J(bb).dla,ma);this.JPa(!0)}lKk(ma){const bb=new dk;bb.eventType=3;bb.viewContainerVisibilityState=ma;return bb}cel(){const ma=this.jQk();for(let bb=0;bb<this.ana.count;++bb)Array.enqueue(this.ana.J(bb).dla,ma);this.JPa(!0)}jQk(){const ma=new dk;ma.eventType=2;return ma}}Object(e.a)(Gl,"ViewContainerEventHost",tj,[866]);var Ol=c(44);class Bg{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(Bg,"CommentUIActionPayload",
null,[]);var Ak=c(320);class ek{constructor(ma,bb){this.ga=ma;this.tnb=bb;this.qjc=new Ak.a;for(let Ab of this.tnb)this.qjc.Z(Ab.value.canvasActionId,Ab.key),ma=Ab.value,ma.delayActionsUntilRegistration||this.pa(ma)}pa(ma){ma.withFlags?this.ga.gb(ma.canvasActionId,ma.canvasContextId,Object(Ol.a)(this,this.$7g,"actionHandler"),97):this.ga.pa(ma.canvasActionId,ma.canvasContextId,Object(Ol.a)(this,this.$7g,"actionHandler"))}cPa(ma,bb){this.tnb.ub(ma)&&(this.tnb.J(ma).delayActionsUntilRegistration&&this.pa(this.tnb.J(ma)),
this.tnb.J(ma).registeredCallback=bb)}$7g(ma,bb,Ab,ac,sc){if(this.qjc.ub(ma)){var Sc=this.qjc.J(ma);if(!this.tnb.ub(Sc))return 8;const Cd=this.tnb.J(Sc);if(Cd.preCallback){const ke=Cd.preCallback(ma,bb,Ab,ac,sc);if(2!==ke)return ke}if(!Cd.registeredCallback)return 1===Ab?8:2;Sc=Object.assign(new Bg,{actionType:Sc});1===Ab&&(Sc.actionBehavior=1);Sc=Cd.registeredCallback(Sc);return Cd.postCallback?Cd.postCallback(Sc,ma,bb,Ab,ac,sc):Sc?32:8}return 2}}Object(e.a)(ek,"OfficeSharedCommentsActionHost",null,
[959]);var tg=c(1730),Be=c(57),ai=c(122),Zd=c(1417),Hf=c(13),Mi=c(30),de=c(657),Fj=c(1127),kf=c(130),cf=c(307),kc=c(53),zh=c(22),Bf=c(1011),si=c(1004),ag=c(1516),Xg=c(155),Mf=c(7),li=c(41),Kh=c(698),Gj=c(499),Hi=c(18),ch=c(1888);class hm{constructor(ma){this.V4=ma;this.ebc=new K.a;this.EZa=new K.a;this.n5l();this.p_l=[new ch.a(li.a.nqh,li.a.fCk),new ch.a(li.a.Svd,li.a.eCk),new ch.a(li.a.eqh,li.a.WBk),new ch.a(li.a.Mvd,li.a.VBk),new ch.a(li.a.oqh,li.a.hCk),new ch.a(li.a.Tvd,li.a.gCk)]}p2a(ma){this.V4.p2a(ma);
this.qrn(ma)}Msf(ma,bb){return!!ma&&!!ma.objectId&&bb.contains(ka.a.Pf(ma.objectId))}a0a(ma){ma=Object(Wa.a)(411,ma);return!!ma&&!!ma.objectId}qrn(ma){for(let bb of this.p_l)ma.classList.remove(bb.className,bb.xKc);ma.classList.remove(li.a.gMf,li.a.Vvd,li.a.fqh,li.a.Uvd,hm.idg)}n5l(){const ma=new K.a,bb=new K.a;ma.add(0,null);ma.add(1,li.a.Svd);ma.add(2,li.a.nqh);ma.add(3,li.a.Vvd);bb.add(0,null);bb.add(1,li.a.Mvd);bb.add(2,li.a.eqh);bb.add(3,li.a.fqh);this.EZa.Z(1,ma);this.EZa.Z(2,bb);this.EZa.Z(3,
bb);this.ebc.add(0,null);this.ebc.add(1,li.a.Tvd);this.ebc.add(2,li.a.oqh);this.ebc.add(3,li.a.Uvd)}}hm.idg="CommentImportant";Object(e.a)(hm,"CommentHighlightUtils",null,[]);class Wk{constructor(){this.BAd=0;this.jxb=null}}Object(e.a)(Wk,"CommentGuidsInElementInfo",null,[]);class Pl{constructor(){this.q5h=!1;this.rka=this.iHb=null;this.JOa=this.oCb=0}}Object(e.a)(Pl,"HighlightInfoForElement",null,[]);class oh{constructor(){this.M8h=this.O8h=this.N8h=-1;this.G6h=[];this.IZb=[];this.eMc=this.fMc=-1;
this.nci=!1}}Object(e.a)(oh,"HighlightInfoForElementsInPara",null,[]);class Pi{constructor(){this.i8f=this.YHf=null}}Object(e.a)(Pi,"OnAnchorMouseOutData",null,[]);var Qd=c(1453);class Ql{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke){this.gle=ma;this.x8=bb;this.Lj=Ab;this.K0=ac;this.ga=sc;this.Hb=Sc;this.sj=Cd;this.ETa=this.aj=null;this.KSm=Dd=>{if(!this.aj||this.K0.pPd)return!0;if(Dd=Dd.Dp){if(this.aj.aA&&Dd[0].toString()===this.aj.aA.objectId)return!0;this.ETa&&Dd[0].equals(this.ETa.i8f[0])?this.Hb.Ye(this.ETa.YHf):
(this.ETa&&(this.Hb.Ye(this.ETa.YHf),this.ga.Xb(Hf.a.Wvd,2,this.ETa.i8f)),this.aj.eq.oci(Dd[0])&&!this.sj.pn||this.ga.Xb(Hf.a.xYe,2,Dd));this.ETa=null}return!0};this.JSm=Dd=>{if(this.K0.pPd)return!0;const $d=Dd.Dp;$d&&(Dd=new oa.a(2,1,0,()=>{this.ga.Xb(Hf.a.Wvd,2,$d);this.ETa=null}),this.Hb.fc(Dd),this.ETa=Object.assign(new Pi,{YHf:Dd,i8f:$d}));return!0};this.Oxi=Dd=>{const $d=new oa.a(2,1,0,()=>{if(this.aj&&!this.aj.eq.Ry){var mf=Dd.Dp;if(!mf)mf=W.App.xa.fp.pg,this.aj.aA&&(!mf||mf.name!==Xg.AFrame.CL&&
mf.name!==Xg.AFrame.hr)&&this.aj.clearSelection();else if(!this.aj.aA||mf.toString()!==this.aj.aA.objectId)if(mf=this.aj.eq.zZ(mf.toString()))mf=Object.assign(new Zd.a,{commentId:mf.id,sO:!1,F3:1}),this.ga.Xb(Hi.a.selectComment,2,mf)}});this.Hb.fc($d);return!1};ke.execute(Dd=>{this.aj=Dd})}Gih(ma,bb,Ab,ac){const sc=new oh,Sc=[],Cd=this.x8.a0a(bb)?bb.objectId:null;for(let $d=0,mf=ma.length;$d<mf;$d++){var ke=ma[$d],Dd=Qd.g(ke);const jg=Qd.d(ke);ke=new ld.a;const ge=new Pl;if(Dd){const ng=new Gj.a(Qd.c);
Dd=this.FIh(Dd,Cd,ng);0<Dd.length&&(this.Jlo(Dd,Ab,ke,ge,Cd,ac),Sc.push(Object.assign(new Wk,{BAd:$d,jxb:ng})))}jg&&(Dd=this.FIh(jg,Cd),0<Dd.length&&(this.Llo(Dd,Ab,ke,ge,sc,Cd,ac,$d),this.eko(Sc,Dd,$d,ge)));0<Ab.count&&this.Mlo(bb,Ab,ge,ac);this.cko(Sc,ge);sc.G6h.push(ge)}return sc}ceh(ma,bb,Ab){let ac=!1;for(let sc=0,Sc=ma.length;sc<Sc;sc++){const Cd=ma[sc],ke=bb.G6h[sc],Dd=Kh.a(Cd);if(1!==Dd&&2!==Dd&&3!==Dd)continue;const $d=3===Dd||2===Dd&&-1!==Cd.className.indexOf(li.a.Mta);this.x8.p2a(Cd);this.A5j(Cd,
ke,$d,ac);this.t4j(Cd,sc,Dd,ke,bb,Ab);this.u4j(Cd,sc,bb,ke);ac=$d}}FIh(ma,bb,Ab=null){const ac=[];for(let sc=0;sc<ma.length;sc++)this.gle.R3i(ma[sc],ma[sc].toString()===bb)&&(ac.push(ma[sc]),Ab&&Ab.add(ma[sc]));return ac}Jlo(ma,bb,Ab,ac,sc,Sc){var Cd;let ke=!1,Dd=!1;for(let mf of ma){bb.add(mf);Ab.add(mf);var $d=mf.toString();$d===sc?($d=Sc?1:2,ac.JOa=$d,ac.oCb=$d):this.Msf(this.aj.aA,bb)&&($d===(null===(Cd=this.aj.aA)||void 0===Cd?void 0:Cd.objectId)&&(Dd=!0),ke=!0)}0<ma.length&&!ac.JOa&&(ac.JOa=
Dd?1:3,ac.oCb=ke?1:3)}Llo(ma,bb,Ab,ac,sc,Sc,Cd,ke){var Dd,$d;const mf=new Gj.a(Qd.c);Cd=Cd?1:2;let jg=!1;for(let ge of ma){const ng=ge.toString();bb.contains(ge)||(ng===Sc?sc.M8h=ke:(sc.N8h=ke,ac.JOa=3,(null===(Dd=this.aj.aA)||void 0===Dd?void 0:Dd.objectId)===ng&&(sc.O8h=ke,ac.JOa=1)),mf.add(ge));ng===(null===($d=this.aj.aA)||void 0===$d?void 0:$d.objectId)&&(jg=!0);bb.remove(ge);Ab.contains(ge)&&this.Klo(ac,ge,ng,Sc,Cd);ng===Sc&&(ac.JOa=Cd)}0<ma.length&&!ac.JOa&&(ac.JOa=jg?1:3);0<mf.count&&sc.IZb.push(Object.assign(new Wk,
{BAd:ke,jxb:mf}))}eko(ma,bb,Ab,ac){0!==ma.length&&(bb.forEach(sc=>{for(let Sc=ma.length-1;0<=Sc;Sc--){const Cd=ma[Sc];if(Cd.jxb.contains(sc)){Cd.BAd===Ab&&(ac.rka?ac.rka.push(sc):ac.rka=[sc]);Cd.jxb.remove(sc);break}}}),ma=ma.filter(sc=>0<sc.jxb.count))}Mlo(ma,bb,Ab,ac){var sc,Sc;this.Msf(ma,bb)?Ab.oCb=ac?1:2:Ab.oCb||(Ab.oCb=null!=(null===(sc=this.aj.aA)||void 0===sc?void 0:sc.objectId)&&bb.contains(ka.a.Pf(null===(Sc=this.aj.aA)||void 0===Sc?void 0:Sc.objectId))?1:3);Ab.iHb||(Ab.iHb=[]);for(let Cd of bb)Ab.iHb.push(Cd)}cko(ma,
bb){if(0<ma.length){bb.rka||(bb.rka=[]);for(let Ab of ma[ma.length-1].jxb)bb.rka.push(Ab)}}Klo(ma,bb,Ab,ac,sc){ma.q5h=!0;ma.iHb||(ma.iHb=[]);ma.iHb.push(bb);Ab===ac&&(ma.oCb=sc)}Msf(ma,bb){return!!ma&&!!ma.objectId&&bb.contains(ka.a.Pf(ma.objectId))}A5j(ma,bb,Ab,ac){!bb.JOa||Ab||ac||((Ab=this.x8.ebc.J(bb.JOa))&&ma.classList.add(Ab),bb.q5h&&ma.classList.add(li.a.gMf))}t4j(ma,bb,Ab,ac,sc,Sc){ac=this.x8.EZa.J(Ab).J(ac.oCb);bb<sc.M8h?ac=Sc?this.x8.EZa.J(Ab).J(1):this.x8.EZa.J(Ab).J(2):bb<sc.N8h&&!ac&&
(ac=bb<sc.O8h?this.x8.EZa.J(Ab).J(1):this.x8.EZa.J(Ab).J(3));ac&&(bb=sc.nci,ma.classList.add(ac),bb&&ma.classList.add(hm.idg))}u4j(ma,bb,Ab,ac){ac.rka||(ac.rka=this.Ynl(bb,Ab)||ac.iHb);bb=null;ac.rka&&0<ac.rka.length&&(this.Lj.mb(Mf.a.pX,ma,this.KSm,ac.rka),this.Lj.mb(Mf.a.Vfa,ma,this.JSm,ac.rka),bb=ac.rka[0]);this.Lj.mb(Mf.a.click,ma,this.Oxi,bb);this.Lj.mb(Mf.a.kJ,ma,this.Oxi,bb)}Ynl(ma,bb){for(;0<bb.IZb.length&&bb.IZb[0].BAd===ma;)bb.IZb.splice(0,1);if(0<bb.IZb.length){ma=[];for(let Ab of bb.IZb[0].jxb)ma.push(Ab);
return ma}return null}}Object(e.a)(Ql,"AllMarkupModeHighlightChangeHandler",null,[404]);var lg=c(1428);class Mj extends lg.a{constructor(ma){super(100,25);this.ojc=new K.a(0);this.Vwj=6E4;this.Cdl=()=>{const bb=this.ojc.keys;if(bb.length){var Ab="";for(let ac=0;ac<bb.length;ac++)Ab+=bb.J(ac)+":"+this.ojc.J(bb.J(ac))+";";this.Vna(Ab);this.ojc=new K.a(0)}};this.Enb=new fb.a;this.Enb.add(1);this.Enb.add(6);this.Enb.add(2);this.Enb.add(4);this.Enb.add(10);this.Enb.add(11);this.wf=ma;ma.RQf&&window.setInterval(this.Cdl,
this.Vwj)}aEa(ma){this.wf.ngo&&this.wf.RQf&&(this.Enb.contains(ma)?this.ljn(ma):this.Vna(ma+""))}ljn(ma){this.ojc.Z(ma,this.ojc.Py(ma,0)+1)}}Object(e.a)(Mj,"CommentActionInTypingRecorder",lg.a,[416]);var bi=c(1546),vl=c(200);class kd{static Dsn(ma){ma&&ma.atmention&&delete ma.atmention.isCurrentUser;return ma}}Object(e.a)(kd,"DeltaFormatHelpers",null,[]);class yf{constructor(){this.optional=this.attributes=null}}Object(e.a)(yf,"Operation",null,[]);class Yd extends yf{constructor(){super();this.insert=
null}}Object(e.a)(Yd,"DeltaOperation",yf,[]);class Rj{constructor(){this.ops=null}}Object(e.a)(Rj,"Delta",null,[]);var fk=c(121),vg=c(20),Ie=c(198),Gm=c(172),ej=c(47),Ph=c(76),dg=c(141),Ll=c(517),vf=c(1173),Ae=c(1685);class cb extends Ae.ACommentFormatTranslator{constructor(ma,bb){super(ma);this.Ce=bb}m6f(ma){const bb=new bi.a;for(let Ab=0;Ab<ma.length;Ab++){const ac=ma[Ab];ac.pDb=!0;this.Adk(bb,ac);bb.kfa("\n")}return[bb.$Hc()]}Zao(ma,bb){ma=bi.a.P2b(ma[0]);ma=this.t$m(ma);const Ab=new fb.a;let ac=
0,sc=null,Sc=null;for(;ac<ma.ops.length;){const Cd=ma.ops[ac];sc||(sc=vf.a.instance.createInstance(393230),sc.pDb=!0,sc.lh(ia.a.Nc,vl.a.ZF()),bb(sc),sc.qa.clear(),sc.cwa(""));"\n"===Cd.insert?(Sc=this.qxf(sc,Sc),this.HSn(sc),Ab.add(sc),sc=null):Sc=this.Bvm(sc,Cd,Sc);ac++}return Ab.toArray()}HSn(ma){if(vg.a.instance.J(6)){var bb=ma.pkh();for(let Ab=0;Ab<bb;Ab++)ma.wordRunProperties.Iq.Z(Ab,cb.BNm),ma.wordRunProperties.gt.Z(Ab,cb.fEf)}}qxf(ma,bb){var Ab=ma.XAd();Ab.cp===ma.characterData.length?Ab.Xh=
!0:(Ab=Object.assign(new Ie.a(ma,ma.characterData.length),{Xh:!0}),ma.qa.add(Ab));Ab=ma.qa.last;if(bb){bb=!!bb.Jx;const ac=this.Erh(ma,Ab,!bb,bb,null);Ab.formatting=ac;bb&&(ma=this.Crh(ma,Ab),Ab.zT=ma.Bj);Ab.vl=!0;bb=null}Ab.cp||Ab.formatting||(Ab.formatting=new Gm.a(Ab,ka.a.nil));return bb}Bvm(ma,bb,Ab){const ac=ma.XAd(),sc=!!bb.attributes&&!!bb.attributes.link,Sc=!!bb.attributes&&!!bb.attributes.atmention,Cd=this.Erh(ma,ac,sc,Sc,bb);ac.formatting=Cd;Ab&&(Ab.Jx&&(Ab=this.Crh(ma,ac),ac.zT=Ab.Bj),
ac.vl=!0,Ab=null);if(sc||Sc)this.bvm(ac,ma,bb),Ab=ac.hyperlink;ma.cwa(ma.characterData+bb.insert);return Ab}Crh(ma,bb){bb=new Gm.a(bb,ka.a.create());let Ab=this.Vxd();Ab.setValue(ia.a.oEb,!0);Ab=ma.Mc.UQ(Ab);bb.Bj=Ab.id;return bb}Erh(ma,bb,Ab,ac,sc){bb=new Gm.a(bb,ka.a.create());let Sc=vf.a.instance.createInstance(1179649);if(Ab||ac)Sc.setValue(Ec.a.MA,!0),Sc.setValue(Ec.a.P6,!0),Ab&&this.sKn(ma,Sc);this.wf.kwb&&sc&&sc.attributes&&this.rQn(sc.attributes,Sc);Sc=ma.Mc.UQ(Sc);bb.Bj=Sc.id;return bb}sKn(ma,
bb){vg.a.instance.J(8)&&(ma=this.Ce.Sx(ma))&&(ma=ma.wh(ej.StyleReader.rNb))&&bb.setValue(Vc.a.xB,ma.id)}rQn(ma,bb){this.kKb(ma.weight>=bi.a.FAf,bb,Ec.a.bold,!0);this.kKb(ma.italic,bb,Ec.a.italic,!0);this.kKb(ma.underline,bb,Ec.a.underline,!0);this.kKb(ma.underline,bb,Ec.a.underlineType,Uf.a.BMb);this.kKb(ma.strikethrough,bb,Ec.a.strikethrough,!0);if(this.wf.ADb){if(Ph.a.UPc(ma.highlight)){var Ab=Ph.a.$eb(ma.highlight);this.kKb(!!ma.highlight,bb,Ec.a.highlight,Ph.a.Lga(Ab))}Ph.a.UPc(ma.color)&&(Ab=
Ph.a.$eb(ma.color),this.kKb(!!ma.color,bb,Ec.a.fontColor,Ph.a.Lga(Ab)))}}kKb(ma,bb,Ab,ac){ma&&bb.setValue(Ab,ac)}bvm(ma,bb,Ab){if(Ab.attributes&&Ab.attributes.atmention){var ac=dg.HyperlinkReader.bMa(Ab.attributes.atmention.email);Ab=Ab.optional&&Ab.optional.atmention&&Ab.optional.atmention.contentId?Ab.optional.atmention.contentId:cb.khl(1===Ab.attributes.atmention.resolveState);ac=new Ll.a(ma,ac,!0,void 0,void 0,void 0,Ab);this.eJk(ac,bb.Mc);ma.hyperlink=ac}else bb=dg.HyperlinkReader.bMa(Ab.attributes.link),
ac=this.OLk(ma.paragraph.qa.first),ma.hyperlink=new Ll.a(ma,bb,!1,ac.Bj)}OLk(ma){let bb=this.qwh();bb=ma.paragraph.Mc.UQ(bb);ma=new Gm.a(ma,ka.a.nil);ma.Bj=bb.id;return ma}eJk(ma,bb){var Ab=String.format(' HYPERLINK "{0}"',ma.url),ac=ma.Jx;const sc=this.Vxd();sc.setValue(ia.a.Gq,15);sc.setValue(ia.a.Jx,ac);sc.setValue(ia.a.lNa,!0);sc.setValue(ia.a.fieldInstruction,Ab);ma.Era(bb.UQ(sc).id);ac=this.Vxd();ac.setValue(ia.a.Gq,47);ac.setValue(ia.a.fieldInstruction,Ab);ma.Era(bb.UQ(ac).id);Ab=this.Vxd();
Ab.setValue(ia.a.Gq,16);ma.Era(bb.UQ(Ab).id)}qwh(){const ma=vf.a.instance.createInstance(1179649);ma.setValue(Ec.a.MA,!0);ma.setValue(Ec.a.P6,!0);ma.setValue(Ec.a.isHidden,!0);return ma}Vxd(){const ma=this.qwh();ma.setValue(Ec.a.e8,!0);return ma}t$m(ma){const bb=new fb.a;for(let Ab=0;Ab<ma.ops.length;Ab++){const ac=ma.ops[Ab];ac.optional=kd.Dsn(ac.optional);if(-1!==ac.insert.indexOf("\n")&&"\n"!==ac.insert){const sc=ac.insert.split("\n");for(let Sc=0;Sc<sc.length;Sc++)if(Ab!==ma.ops.length-1||Sc!==
sc.length-1||sc[Sc])bb.add(Object.assign(new Yd,{insert:sc[Sc],attributes:ac.attributes,optional:ac.optional})),Sc!==sc.length-1&&bb.add(Object.assign(new Yd,{insert:"\n"}))}else bb.add(ac)}return Object.assign(new Rj,{ops:bb.toArray()})}static khl(ma){return Ae.ACommentFormatTranslator.khk+fk.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ma?"Z":"")}}cb.BNm=0;cb.fEf=0;Object(e.a)(cb,"CommentDeltaFormatTranslator",Ae.ACommentFormatTranslator,[]);var Eb=c(1602),ec=c(1499);class Cc{constructor(ma,
bb,Ab){this.ek=ma;this.K=bb;this.ES=Ab}get userPrincipalName(){return this.K.lb("UserPrincipalName")}$C(ma){return this.ek.$C(ma)}Vbm(ma){ma=this.ek.$C(ma);return ma?!ma.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}HNc(ma){return this.ek.HNc(ma)}isCurrentUserMentioned(ma){var bb,Ab;ma=this.ek.Onl(ma);for(const ac of ma){ma=bi.a.P2b(ac.text[0]);let sc=0;for(;ma.ops&&sc<ma.ops.length;){const Sc=null===(Ab=null===(bb=ma.ops[sc])||void 0===bb?void 0:bb.attributes)||
void 0===Ab?void 0:Ab.atmention;if(Sc&&Sc.email===this.userPrincipalName)return!0;sc++}}return!1}ETc(){this.ES.Sna("OnContentFilterUpdate")}}Object(e.a)(Cc,"CommentFilterActor",null,[415]);var Pc=c(84),jd=c(1884),pe=c(873),ue=c(600);class Od{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d){this.ki=ma;this.Hb=bb;this.Hh=Ab;this.pRa=ac;this.wf=sc;this.sj=Sc;this.x4=Cd;this.Ch=ke;this.FS=Dd;this.fJ=$d;this.Kpb=null;this.tKe=0;this.Ced=!1;this.djd=0;this.LMb=this.U0c=this.azg=this.nqc=this.Xub=!1;this.updateViewportInfo=
()=>{this.FS.A0f()&&this.Ch.updateViewportInfo(this.Ced,this.DJf)};this.jib=()=>{this.Ch.Gja.lua()&&(this.mcc(this.Ch.Gja.Fc),this.Ch.Gja.xcc(this.jib))};this.DJf=()=>{this.C4a();this.FS.CJf()};this.q3f=()=>{!this.Xub&&this.FS.U_f()&&(this.djd=this.zMe.scrollTop,this.Xub=!0,this.pRa.aEa(2))};this.pRf=(mf,jg)=>{this.Xub&&(mf=this.zMe.scrollTop,mf-this.djd?(this.nqc||jg.hee||this.updatePosition(),this.nqc||1!==jg.hee||this.C4a(),this.pQe(mf),this.FS.yIf()):this.nqc=this.Xub=!1)};this.zMe=this.Ch.$ba;
this.uga=ue.a.NZd;this.Ls=this.Ch.Ls;this.Ch.srh()}get TOd(){return this.FS.Ztf()}get uga(){return this.Ch.uga}set uga(ma){this.Ch.uga=ma}get Veh(){return"1"===this.Ls.rE.style.opacity}d3i(ma){this.U0c||(this.U0c=!0,this.Ch.NGi(),this.Kpb=ma(this.Ls.gCa,this.Ch.SPi,()=>{this.updatePosition()}),this.Ch.boi(this.Kpb),this.FS.initialize(this.Kpb,this),this.Ch.initialize(this.Kpb,this.FS.lib),this.Ch.sNi(),this.Ch.Y2i(),this.Ch.Z2i(),this.Ch.c3i(this.FS.yTe,this.FS.HYd,this.FS.GYd),this.YRf())}b0c(){}m8d(){return this.Ch.W3i()}setInitialActiveContainerId(ma,
bb,Ab=null){this.Ch.setInitialActiveContainerId(ma,0,Ab)}updatePosition(){if(!this.LMb&&this.TOd&&this.ki.D4b()){var ma=H.a.kf()-this.tKe<ue.a.Ljj;ma||this.Ced||this.C4a(ma)}}BSe(){this.C4a()}KPa(ma,bb,Ab){this.Ch.KPa(ma,bb,Ab)}deleteContainer(ma,bb,Ab=!1){this.Ch.deleteContainer(ma,bb,()=>{this.ki.jlf()||this.Ch.Rlf();this.FS.KGf()},Ab)}addContainer(ma,bb,Ab){this.Ch.addContainer(ma,bb,Ab,this.Ch.mf,this.FS.ZIc,this.FS.wFf)}zFi(ma){this.LMb=!0;ma();this.LMb=!1}oYc(ma,bb,Ab){this.Ch.oYc(ma,bb,Ab)}sZb(){this.Ch.sZb()}fkj(){const ma=
"1"===this.Ls.rE.style.opacity;switch(!0){case ma&&!this.ki.jlf():this.Ch.Rlf();break;case !ma&&this.ki.jlf():this.Ch.lfc()}}z6f(ma=!0){this.FS.w0f&&this.Ch.Pcj(ma)}static $Qh(ma,bb=null){const Ab=new Va.a;for(let ac of ma)ac.Kf||ac.Rq!==jd.a.beingCreated&&(!bb||bb(ac))&&Od.l3j(Ab,ac.objectId,ac);return Ab}static l3j(ma,bb,Ab){let ac;({value:ac}=ma.Bc(bb,ac)).returnValue||(ac=[],ma.Z(bb,ac));ac.push(Ab)}mcc(ma){ma&&(ma.Lja(()=>{this.updateViewportInfo()}),this.djd=this.zMe.scrollTop,ma.bbh(this.q3f),
ma.cbh(this.pRf))}YRf(){this.Ch.mf?this.mcc(this.Ch.mf):this.Ch.Gja?this.Ch.Gja.vXb(this.jib):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}pQe(ma){this.Ls.rE.style.top=ma-this.djd+"px";this.nqc=!1}C4a(ma=!1){ma=new oa.a(0,1,0,()=>{this.A5e()},129,void 0,!ma);this.Hb.fc(ma);this.Ced=!0;this.nqc=this.Xub;this.pRa.aEa(10)}hhf(ma){return this.Ch.ZWa({contentAnchorPositions:ma.contentAnchorPositions})}A5e(){this.Ced=!1;if(this.Ls.gCa&&this.Kpb&&this.ki.D4b()){this.Ch.mBd();
var ma=0;this.Hh.Qd(()=>{ma=this.Ch.vFd()},"FCM:UP:GET");var bb=null,Ab=null;this.Hh.Qd(()=>{const ac=this.FS.IPh(ma,this.Ch.mf);bb=ac.TCk;Ab=this.hhf(ac)},"FCM:UP:GP");this.Hh.Qd(()=>{this.Xub?(this.Ch.rEh(Ab),this.Xub=!1):this.Kpb.emitEvent(3,Ab);this.x4.P2d()},"FCM:UP:RC");this.Kpb.setFirstCommentRenderDone();"0"===this.Ls.rE.style.opacity&&0<bb.count&&!this.sj.pn&&this.Hh.Qd(()=>{this.Ch.lfc()},"FCM:UP:SFC");this.wf.Sib&&!this.azg&&0<bb.count&&(Bj.a.E1(this.Hb,this.Ch.Boi,Cf.a.Aoi),this.azg=!0);
this.tKe=H.a.kf();this.pRa.aEa(6)}else this.tKe=H.a.kf()}}Object(e.a)(Od,"FloatingCommentManager",null,[394,395]);var zf=c(101),Tf=c(95),dc=c(1429),Oi;(function(ma){ma[ma.GNo=0]="singleHint";ma[ma.nKo=1]="multiHint";ma[ma.tMo=2]="resolvedHint";ma[ma.oKo=3]="multiResolvedHint";ma[ma.entryPoint=4]="entryPoint";ma[ma.unknown=void 0]="unknown"})(Oi||(Oi={}));Object(e.b)("CommentIconType",Oi);var Ci=c(153),oi=c(1087);const Wg={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",
[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[Oi.unknown]:""},Bk={[1]:"ShowAllCommentsHover_16x16x32",[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",[Oi.unknown]:""},Ca={[1]:"ShowAllComments_16x16x32",[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",
[Oi.unknown]:""},vb=(ma,bb)=>{bb===Oi.unknown&&a.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${ma}`);switch(ma){case 1:return Wg[bb];case 2:return Bk[bb];case 3:return Ca[bb];default:return""}},hc={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Oi.unknown]:""},Nc={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter",
"OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Oi.unknown]:[]},sd=(ma,bb)=>{switch(ma){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(bb){case 3:return oi.a.uqh;
case 2:return oi.a.vqh;case 1:return oi.a.wqh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(bb){case 3:return oi.a.rqh;case 2:return oi.a.sqh;case 1:return oi.a.tqh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(bb){case 3:return oi.a.xqh;case 2:return oi.a.yqh;
case 1:return oi.a.zqh}}},Id=(ma,bb)=>{Ci.a("renderIcon")&&appChrome.api.renderIcon(ma,bb)};class We{}We.a7h=16;We.D_l=1;We.wnf=20;We.moj=2;Object(e.a)(We,"CommentIconConstants",null,[]);class Fd{constructor(){this.Nvd=0;this.kzc=!1}}Object(e.a)(Fd,"CommentHintCensus",null,[]);class Ff{constructor(ma,bb,Ab,ac,sc){this.Yzg=ma;this.NWb=Ab;this.eDj=ac;this.rxb=sc;this.yJa=-1;this.fle=new Set(bb)}get y(){if(-1!==this.yJa)return this.yJa;const ma=Sys.UI.DomElement.getBounds(this.Yzg),bb=this.Yzg.getClientRects();
return this.yJa=0<bb.length&&bb[0]?this.eDj?ma.y/this.NWb+We.moj:Math.floor(bb[0].height)/(2*this.NWb)+ma.y/this.NWb-We.a7h/2:0}get Rvd(){return Array.from(this.fle)}f7j(ma){this.fle=new Set([...this.fle,...ma])}}Object(e.a)(Ff,"HintInfo",null,[422]);class Ac extends dc.a{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng){super();this.wf=ma;this.kg=bb;this.Lj=Ab;this.HD=ac;this.ga=sc;this.ki=$d;this.ypa=mf;this.pRa=jg;this.sj=ge;this.MAj=ng;this.m8c=new Map;this.nqb=this.Htb=null;this.Qgc={Sgc:-1,
tEf:-1}}HKb(ma){let bb=!1;W.App.Inj&&ma.Yb.yi?I.a.instance.Qd(()=>{bb=Qd.m(ma,!0)},"CHA:SCIVE"):I.a.instance.Qd(()=>{bb=Qd.l(ma.htmlElement,!0)},"CHA:SCI");return bb}Nxb(ma){const bb=this.zoom,Ab=ma.o7,ac=ma.dCa;let sc=0;if(this.wf.oEi)for(let ke=0;ke<ma.B2.length;ke++)if(0<ma.B2[ke].width){sc=ke;break}const Sc=ma.Fwb(1,We.wnf,bb,sc);this.pRa.aEa(1);let Cd=[];ac.forEach((ke,Dd)=>{const $d=ma.B2[Dd].y/bb;ke=this.bMk(this.owl(ke,Dd),mf=>this.QLk(Ab,mf,mf.y-$d,Sc),()=>Ac.INk(Ab));Cd=Cd.concat(ke)});
return Cd}bMk(ma,bb,Ab){Ab=Ab();const ac=[];for(let sc of ma){ma=bb(sc);for(let Cd of sc.Rvd)this.m8c.set(Cd.toString(),ma);const Sc=this.AWh(sc.Rvd);this.Gij(Sc,ma);null==Ab.rxb&&(Ab.rxb=sc.rxb);Ab.appendChild(ma);ac.push(ma)}this.a5b(this.nqb);this.gfb(this.Htb);return[Ab]}A0k(ma,bb){ma=null===ma||void 0===ma?void 0:ma.querySelectorAll("."+Ac.rDi);return 0<(null===ma||void 0===ma?void 0:ma.length)&&ma[0]&&(ma=Array.from(ma[0].querySelectorAll(Ac.iCk)))?this.EFn(ma,bb):!1}EFn(ma,bb){let Ab=0,ac=
ma.length-1,sc;for(;ac>=Ab;){sc=Math.floor((ac-Ab)/2+Ab);const Sc=ma[sc];if(Sc.offsetTop>=bb-2&&Sc.offsetTop<=bb+2)return!0;Sc.offsetTop>bb+2?ac=sc-1:Ab=sc+1}return!1}AWh(ma){var bb,Ab;let ac=0,sc=0;for(let Sc of ma)if(this.ki.Zsf(Sc)){if(this.wf.contentFilterApiEnabled&&this.sj.pn&&(ma=this.ki.zZ(Sc.toString()),null===(Ab=(bb=this.MAj).isContentInFilteredContent)||void 0===Ab||!Ab.call(bb,ma.id)))continue;this.ki.oci(Sc)?sc+=1:ac+=1}bb=new Fd;bb.Nvd=ac+sc;bb.kzc=0===ac;return bb}Ehc(ma){if(ma=this.m8c.get(ma.objectId)){var bb=
Qd.g(ma);bb=this.AWh(bb);this.Gij(bb,ma)}}Gij(ma,bb){let Ab,ac;if(this.wf.contentFilterApiEnabled&&0===ma.Nvd)bb.style.display="none";else if(1===ma.Nvd?(Ab=ma.kzc?2:0,ac=ma.kzc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ma.Nvd&&(Ab=ma.kzc?3:1,ac=ma.kzc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),bb.style.display=
"block",this.wf.rKa){if(ma=bb.firstElementChild)this.X_i(ma,Ab),ma.title=ac+". "+ma.title,Id(hc[Ab],ma)}else if(ma=bb.firstElementChild)this.X_i(ma,Ab),ma.alt=ac,ma.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(3,Ab))}X_i(ma,bb){ma.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;zf.a.yl(ma,Ac.Aqh,bb)}owl(ma,bb){ma=this.RLk(ma,bb);ma.sort((Ab,ac)=>Ab.y-ac.y);return this.JJm(ma)}RLk(ma,bb){const Ab=[],ac=this.wf.yq,sc=this.zoom;ma=Qd.f(ma,!0);for(let Sc=
0,Cd=ma.length;Sc<Cd;Sc++){const ke=ma[Sc],Dd=Qd.g(ke);Dd&&Ab.push(new Ff(ke,Dd,sc,ac,bb))}return Ab}JJm(ma){let bb=null;const Ab=[];for(let ac=0;ac<ma.length;ac++)bb&&Math.abs(ma[ac].y-bb.y)<We.a7h+We.D_l?bb.f7j(ma[ac].Rvd):(bb=ma[ac],Ab.push(bb));return Ab}QLk(ma,bb,Ab,ac){const sc=ma.Ng.ownerDocument,Sc=sc.createElement("div");Sc.className=Ac.pqh;Sc.style.top=Ab+"px";Sc.style.left=ac+"px";Sc.style.right="auto";Sc.style.zIndex="40";zf.a.yl(Sc,li.a.IBc,bb.Rvd);this.wf.rKa?(bb=sc.createElement("span"),
this.K3c(bb,Sc),Id(hc[0],bb),this.UA(bb,ma)):(bb=sc.createElement("img"),this.K3c(bb,Sc),bb.src=v.AFrameworkApplication.pr,bb.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(3,0)),bb.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument,this.UA(bb,ma));return Sc}K3c(ma,bb){ma.title=CommonUIStrings.l_CommentHintTooltip;ma.setAttribute("role","button");bb.appendChild(ma)}UA(ma,bb){this.kg.uE(Mf.a.click,ma,this.kVm.bind(this),
bb);this.kg.mb(Mf.a.XC,ma,this.nVm.bind(this));this.Lj.mb(Mf.a.pX,ma,this.pVm.bind(this));this.Lj.mb(this.wf.rKa?Mf.a.uK:Mf.a.Vfa,ma,this.oVm.bind(this));this.HD.mb(ma,this.mVm.bind(this))}static INk(ma){ma=ma.Ng.ownerDocument.createElement("div");ma.className=Ac.rDi;return ma}mVm(){return!0}nVm(){return!0}kVm(ma){const bb=Qd.g(ma.Fv.parentNode);ma.eventName===Mf.a.kJ&&(this.ypa.qXe(),this.loh());this.ga.Xb(Hf.a.qqh,2,bb);return!0}pVm(ma){this.rBa(this.nqb)!==ma.Fv&&(ma=Qd.g(ma.Fv.parentNode),this.ga.Xb(Hf.a.xYe,
2,ma));return!0}oVm(){this.ga.processAction(Hf.a.Wvd,2);return!0}a5b(ma){this.loh();this.nqb=ma;this.wek()}wek(){this.xek(this.rBa(this.nqb),this.rBa(this.Htb))}gfb(ma){this.cyk();this.Htb=ma;if(ma=this.rBa(this.Htb)){const bb=this.iGd(ma);this.wf.rKa?this.W6d(ma,bb,1):ma.className=Tf.getImageClass(vb(1,bb))}}rBa(ma){if(!ma)return null;let bb=null;if(ma=this.ki.zZ(ma))if(ma=ma.Kf?this.ki.$C(ma.Kf):ma)bb=ma.objectId;return bb&&this.m8c.has(bb)?this.m8c.get(bb).firstChild:null}loh(){this.eyk(this.rBa(this.nqb),
this.rBa(this.Htb))}eyk(ma,bb){if(ma){const Ab=this.iGd(ma);bb=ma===bb?1:3;this.wf.rKa?this.W6d(ma,Ab,bb):ma.className=Tf.getImageClass(vb(bb,Ab));this.nqb=null}}xek(ma,bb){ma&&(ma.title=0<this.Qgc.tEf&&1<this.Qgc.Sgc?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Qgc.tEf,this.Qgc.Sgc):CommonUIStrings.l_CommentHintTooltip,bb!==ma&&(bb=this.iGd(ma),this.wf.rKa?this.W6d(ma,bb,2):ma.className=Tf.getImageClass(vb(2,bb))))}cyk(){var ma=this.rBa(this.nqb);
const bb=this.rBa(this.Htb);if(bb){const Ab=this.iGd(bb);ma=ma===bb?2:3;this.wf.rKa?this.W6d(bb,Ab,ma):bb.className=Tf.getImageClass(vb(ma,Ab));this.Htb=null}}W6d(ma,bb,Ab){this.jgm()?this.UMn(ma,Ab):this.NOn(ma,bb,Ab)}UMn(ma,bb){ma=null===ma||void 0===ma?void 0:ma.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ma||void 0===ma?void 0:ma.length)&&(ma[0].style.fill=2===bb||1===bb?"Highlight":"ButtonText")}NOn(ma,bb,Ab){bb=Nc[bb];for(let sc=0;sc<bb.length;sc++){var ac=bb[sc];const Sc=sd(ac,
Ab);if(!this.Qcm(Sc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Sc}.`);break}ac=null===ma||void 0===ma?void 0:ma.querySelectorAll("."+ac);0<(null===ac||void 0===ac?void 0:ac.length)&&(ac[0].style.fill=`var(${Sc})`)}}jgm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(ma){return!1}}iGd(ma){return zf.a.Db(ma,Ac.Aqh)}Qcm(ma){var bb;const Ab=document.getElementById(kf.AppFrame.FEc);return!(null===(bb=null===Ab||void 0===Ab?void 0:
Ab.style)||void 0===bb||!bb.getPropertyValue(ma))}}Ac.pqh="clip16x16 HintContainer";Ac.iCk=".clip16x16.HintContainer";Ac.rDi="OutlineElementHintMargin";Ac.Aqh="CommentIconType";Object(e.a)(Ac,"CommentHintActor",dc.a,[410]);var Qi=c(975);class Tc extends Qi.a{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d){super();this.vi=ma;this.ir=bb;this.ek=Ab;this.taskManager=ac;this.jqd=sc;this.ES=Sc;this.Ch=Cd;this.getSelectedText=ke;this.Cxo=Dd;this.$h=$d;this.rTc=()=>{};this.DXd=()=>{};this.swg=!1;this.ruk={[0]:()=>
this.Czh(),[1]:()=>this.pfc.BSe(),[2]:()=>this.Czh()};this.CJf=()=>{this.jqd.aEa(11)};this.yTe=mf=>{if(this.ir.kwb)for(let jg of Qd.t)mf.bindAction(Pc.KeyInputManager.IF(jg),Hi.a.fVe)};this.HYd=()=>{this.DXd()};this.GYd=(mf,jg)=>{if(mf.name!==Xg.AFrame.hr&&jg){var ge=this.ek.Js?this.ek.Js.id:"";this.vi.HGb||(this.vi.HGb=Bj.a.E1(this.taskManager,()=>{this.rTc(ge)}))}};this.DBi=()=>{};this.lib=()=>{this.M5i()};this.wFf=(mf,jg)=>{0===jg&&(this.ES.P2d(),this.jqd.aEa(0))};this.KGf=()=>{this.jqd.aEa(5)};
this.ZIc=mf=>{let jg=0;const ge=this.ek.kT();for(let ng=0;ng<ge.length;ng++){if(ge[ng].Kf||ge[ng].done)continue;if((ge[ng].Rq===jd.a.beingCreated?ge[ng].Ny.draftId:ge[ng].id)===mf.contentId)break;const Sg=this.Sw.getContentAnchorPosition(ge[ng].id);!Sg||4<Math.abs(mf.anchorTop-Sg.anchorTop)||jg++}return jg};this.bxi=()=>{this.ES.P2d()};this.yIf=()=>{this.jqd.aEa(2)};this.M5i=()=>{if(!this.swg&&this.Ch.$ba){const mf=this.Ch.$ba.getElementsByClassName(Ac.pqh);for(let jg=0;jg<mf.length;jg++)mf[jg].style.opacity=
"1";this.swg=!0}}}get w0f(){return this.DZ()}get D5e(){return this.Cxo.z_h()}initialize(ma,bb){this.Sw=ma;this.pfc=bb;this.vXc()}pMn(ma,bb){this.DXd=ma;this.rTc=bb}RPh(ma,bb){return{PVa:this.Aol(ma,bb),containerContentByType:{}}}IPh(ma,bb){const Ab=Od.$Qh(this.ek.kT(),this.ek.Yta),ac=[],sc=Qd.e(!0);var Sc=this.ek.kT();bb=this.xbn(bb,Sc,Ab);!bb.pNf&&bb.contentAnchorPosition&&(ac.push(bb.contentAnchorPosition),bb.contentAnchorPosition=null);for(Sc=0;Sc<sc.length;Sc++){const Cd=sc[Sc],ke=Qd.g(Cd);if(ke)for(let Dd=
0;Dd<ke.length;Dd++){const $d=this.getContentAnchorPosition(ma,Ab,Cd,ke[Dd]);$d&&(ac.push($d),bb.pNf&&bb.contentAnchorPosition&&$d.contentId===bb.pNf.id&&(ac.push(bb.contentAnchorPosition),bb.contentAnchorPosition=null))}}bb.contentAnchorPosition&&ac.splice(0,0,bb.contentAnchorPosition);return{TCk:Ab,contentAnchorPositions:ac}}Ztf(){var ma;return!(null===(ma=this.Sw)||void 0===ma||!ma.getAreContainersEnabled())}DZ(){return this.ek.D4b()}U_f(){return this.DZ()}x0c(){return this.DZ()}A0f(){return this.Sw&&
this.Ch.$ba&&this.DZ()}sBi(ma){0!==ma&&this.rTc(this.ek.Js?this.ek.Js.id:"")}getContentAnchorPosition(ma,bb,Ab,ac){let sc=null;return({value:sc}=bb.Bc(ac.toString(),sc)).returnValue?(bb=sc[0])&&!bb.Kf?Object.assign(Object.assign({},new pe.a),{anchorTop:(ue.a.fIc(Ab)-ma)/this.Ch.l$,anchorLeft:0,containerContentType:0,contentId:bb.id}):null:null}xbn(ma,bb,Ab){var ac,sc;const Sc={};"CREATE"===(null===(sc=null===(ac=this.ek.Ry)||void 0===ac?void 0:ac.Ny)||void 0===sc?void 0:sc.sessionType)&&(ac=this.Ch.$ba.querySelectorAll(Qd.b),
ma=this.Ch.rNh((0<ac.length?ac[0]:null)||this.getSelectedText(),this.ek.Ry.Ny.draftId,0,ma),Sc.pNf=this.kFl(bb,Ab),Sc.contentAnchorPosition=ma);return Sc}kFl(ma,bb){var Ab=Array.indexOf(ma,this.ek.Ry);for(--Ab;-1<Ab;Ab--)if(bb.ub(ma[Ab].objectId))return ma[Ab]}Aol(ma,bb){return this.IPh(ma,bb).contentAnchorPositions}vXc(){this.ES.Dga("OnAfterTrackChangeMarkupViewChange",(ma,bb)=>{if(bb)this.ruk[bb.Vi]()})}Czh(){const ma=Qd.i();if(0!==ma.length){var bb=Od.$Qh(this.ek.kT()),Ab=this.ek.YJ;for(let ac=
0;ac<ma.length;ac++){const sc=Qd.g(ma[ac]);for(let Sc=0;Sc<sc.length;Sc++){let Cd;({value:Cd}=bb.Bc(sc[Sc].toString(),Cd)).returnValue&&(Cd.forEach(ke=>{var Dd;ke&&!ke.Kf&&(this.pfc.deleteContainer(ke.id,0,!1),(null===(Dd=Ab.aA)||void 0===Dd?void 0:Dd.id)===ke.id&&Ab.clearSelection())}),this.$h.Kg(Xg.AFrame.Wo))}}}}}Object(e.a)(Tc,"CommentFloatingContainerActor",Qi.a,[414]);var uj=c(1431),oj=c(1889),ti=c(190);class Th extends uj.a{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd){super();this.OMj=ma;this.k6a=
bb;this.gle=Ab;this.Hh=sc;this.x8=ke;this.x4=Dd;this.aj=null;this.Vi=1;ac.execute($d=>{this.aj=$d});this.hqa=[];this.jlc=new ti.ScriptSharpLegacyMap;this.Fmn(Sc,Cd);this.vXc()}get Mi(){return this.OMj.value}get commentEditor(){return this.k6a}get ama(){return!!this.aj}get nCb(){return 0}get ffb(){return this.hqa}get XIg(){return this.jlc.ub(this.Vi)?this.jlc.J(this.Vi):this.jlc.J(0)}a0a(ma){return this.x8.a0a(ma)}oeb(ma,bb){if(ma=Object(Wa.a)(411,ma))for(let Ab of this.Qbn(ma))bb.add(Ab)}uOa(ma,bb){this.ama&&
this.Hh.Qd(()=>{this.DXm(ma,bb)},"CHA:OPHC")}DXm(ma,bb){if(this.aj.eq.D4b()){var Ab=this.Qy.JKa,ac=new Ba.a(new ee.a),sc=bb.e2a("*"),Sc=this.bol(Ab),Cd=!!Ab&&!Ab.action||!!Sc&&Sc===this.aj.aA,ke;this.Hh.Qd(()=>{this.gle.nDl(ma.id,ac,null===Sc||void 0===Sc?void 0:Sc.objectId)},"OPHC:GOI");this.Hh.Qd(()=>{ke=this.XIg.Gih(sc,Sc,ac,Cd);ke.nci=this.lci(Ab)&&0===Ab.action},"OPHC:BHI");this.Hh.Qd(()=>{this.XIg.ceh(sc,ke,Cd)},"OPHC:AH")}}bol(ma){let bb=null;!this.lci(ma)||0!==ma.action&&2!==ma.action||(bb=
this.Qy.JKa.JF);return bb||this.aj.aA}Qbn(ma){if(!ma)return[];ma=this.Mi.Db(ka.a.Pf(ma.objectId));return this.commentEditor.tHd(ma,null)}sOi(){return!1}rH(ma,bb,Ab){this.ama&&(ma=Object.assign(new oj.a,{action:ma,type:0,JF:bb,mO:Ab}),this.Qy.rH(ma))}qXe(){this.ama&&(this.rH(3,this.aj.g5b,this.aj.g5b),this.aj.g5b=null)}Fmn(ma,bb){this.jlc.add(1,ma);this.jlc.add(0,bb)}vXc(){this.x4.Dga("OnBeforeTrackChangeMarkupViewChange",(ma,bb)=>{bb&&bb.dEf!==this.Vi&&(this.Vi=bb.dEf)})}lci(ma){return ma&&0===ma.type}}
Object(e.a)(Th,"CommentHighlightActor",uj.a,[412,350]);var di=c(996),Nj=c(383),im=c(545),Hg=c(1462);class ah{constructor(ma,bb){this.FCk=ma;this.rFf=bb}}Object(e.a)(ah,"CommentEndParaIdBeforeChangeInfo",null,[]);var Ji=c(1547);class Jh{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke){this.Ewf=ma;this.vi=bb;this.ek=Ab;this.ES=ac;this.Op=sc;this.fj=Sc;this.cCk=Cd;this.ir=ke;this.mob=null;this.ybn=(Dd,$d)=>{(Dd=$d.commentNode)&&!Qd.s(Dd)&&($d=this.ek.Jcf(Dd),ka.a.Jp($d.q1c,$d.lFc)||this.gij($d,Dd)||this.fnh($d.$za,
$d.pKa,Dd)||this.v9f(Dd))};this.ERm=(Dd,$d)=>{$d.property===ia.a.Tsa&&(Dd=Qd.h($d.node,ka.a.nil),this.mob=new ah($d.node.id,Dd))};this.MSm=(Dd,$d)=>{Dd=$d.node;if($d.property===ia.a.Tsa&&Dd){var mf=Qd.k(Dd,ka.a.nil);$d=Qd.h(Dd,ka.a.nil);var jg=this.mob?this.Ad.Db(this.mob.rFf):null;!Qd.s(Dd)&&mf&&!mf.equals($d)&&this.mob&&Dd.id.equals(this.mob.FCk)&&!mf.equals(this.mob.rFf)&&jg&&jg.isConnected&&this.NOe(this.mob.rFf,Dd.id);$d&&this.vi.hx.ub($d)&&(mf=this.vi.hx.J($d),mf.zZa&&(a.ULS.shipAssertTag(572835481,
327,!!mf.dM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),mf.dM&&mf.dM.contains(Dd.id)&&(mf.dM.remove(Dd.id),mf.dM.count||(mf.zZa=!1),this.vi.fU.ub(Dd.id)?this.vi.fU.J(Dd.id).remove($d):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.PTc=(Dd,$d)=>{Dd=$d.node.id;this.vi.hx.ub(Dd)&&this.Isn(Dd)};this.oRm=(Dd,$d)=>{$d&&$d.node&&this.DRa.ub($d.node)&&(Dd=this.DRa.J($d.node).MZd,this.DRa.ub(Dd)||(Dd=this.DRa.J($d.node),
this.fnh(Dd.e2e?Dd.currentNode:Dd.MZd,Dd.e2e?Dd.MZd:Dd.currentNode,Dd.commentNode)||this.v9f(Dd.commentNode)),this.DRa.remove($d.node))};this.PSm=(Dd,$d)=>{const mf=Dd.Rj;if(!$d&&this.y9a.ub(mf)){var jg;(jg=this.y9a).Z(mf,jg.J(mf)&(Dd.Oc?-2:-3));this.y9a.J(mf)||(this.v9f(this.Ad.Db(mf)),this.y9a.remove(mf))}};this.DRa=new im.a(new di.a);this.y9a=new Qf.a(Qd.c);this.ES.Dga("OnCommentNodeAdded",this.ybn);this.ir.contentFilterApiEnabled?(this.ES.Dga("OnCommentPaneOpen",this.O9l.bind(this)),this.ES.Dga("OnCommentPaneClose",
this.N9l.bind(this)),this.ES.Dga("OnContentFilterUpdate",this.ETc.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Dd=>{this.ES.Dga(Dd,this.M9l.bind(this))});ma=this.Op.Ve(12);ma.Zu(this.PTc);ma.Wt(this.oRm);this.Op.Ve(40).Fvb(this.ERm);this.Op.Ve(40).qp(this.MSm);Nj.a.dPa(this.PSm)}get fy(){return this.Ewf.value}get Ad(){return this.fy.Ad}nDl(ma,bb,Ab){if(this.o4m(ma))for(let ac of this.vi.hx.J(ma).dM)!this.R3i(ac,Ab===ac.toString())||bb.add(ac)}R3i(ma,bb){const Ab=this.Ad.Db(ma),
ac=Qd.s(Ab);if(!Ab||ac)return!1;ma=this.ek.zZ(ma.toString());return!ma||this.ir.contentFilterApiEnabled&&this.vi.pn&&!this.cCk.isContentInFilteredContent(ma.id)||!this.vi.pn&&!this.ek.Yta(ma)&&!bb?!1:!0}o4m(ma){return this.V3m(ma)}v9f(ma){if(ma){var bb=Hg.a.tHd(ma,null),Ab=new Ea.a;for(let ac=1;ac<bb.length-1;ac++)this.NOe(bb[ac].id,ma.id),Ab.add(bb[ac]);Kh.b(Ab)}}V3m(ma){if(!this.vi.cX)return!1;let bb=null;if(({value:bb}=this.vi.hx.Bc(ma,bb)).returnValue)return bb.zZa;let Ab=!1;this.fj.Qd(()=>{const ac=
Qd.e();for(let sc=0;sc<ac.length;sc++)Ab=this.lno(ac[sc],ma,Ab);Ab||(this.vi.hx.add(ma,new Ji.a),this.vi.hx.J(ma).zZa=!1)},"CHORA:PHOC");return Ab}lno(ma,bb,Ab){ma=Qd.g(ma);if(!ma)return Ab;for(let ac=0;ac<ma.length;ac++){const sc=this.Ad.Db(ma[ac]);sc&&!Qd.s(sc)&&(Ab=Ab||this.Puk(sc,bb))}return Ab}Puk(ma,bb){var Ab=this.ek.Jcf(ma);if(this.gij(Ab,ma))return!1;var ac=Ab.q1c;const sc=Ab.lFc;Ab=Ab.$za;if(ac!==ka.a.nil&&(ac.equals(sc)||ac.equals(bb)))return!1;for(ac=nb.ParagraphReader.eh(Ab,!1);ac&&!ac.id.equals(sc);){if(ac.id.equals(bb))return this.NOe(bb,
ma.id),!0;ac=nb.ParagraphReader.eh(ac,!1)}return!1}NOe(ma,bb){this.vi.fU.ub(bb)||this.vi.fU.add(bb,new Ba.a(new ee.a));this.vi.fU.J(bb).add(ma);this.vi.hx.ub(ma)?this.vi.hx.J(ma).dM||(this.vi.hx.J(ma).dM=new Ba.a(new ee.a)):this.vi.hx.add(ma,new Ji.a(!0));this.vi.hx.J(ma).zZa=!0;this.vi.hx.J(ma).dM.add(bb)}Isn(ma){if(this.vi.hx.J(ma).dM)for(let bb of this.vi.hx.J(ma).dM)this.vi.fU.ub(bb)?this.vi.fU.J(bb).remove(ma):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");
this.vi.hx.remove(ma)}M9l(){const ma=new Ea.a;for(let bb of this.ek.kT())bb.Kf||bb.Rq===jd.a.beingCreated||this.ek.Yta(bb)||this.ek.x9f(bb,ma);Kh.b(ma)}O9l(){this.ipf("OnCommentPaneOpen")}ETc(){this.ipf("OnContentFilterUpdate")}N9l(){this.ipf("OnCommentPaneClose")}ipf(ma){const bb=new Ea.a;for(let Ab of this.ek.kT())Ab.Kf||Ab.Rq===jd.a.beingCreated||this.ek.YJ.Zkh(ma,Ab)||this.ek.x9f(Ab,bb);Kh.b(bb)}gij(ma,bb){let Ab=!1;if(!ma.j$d||!ma.OAd){Ab=!0;if(!ma.$za||!ma.pKa)return a.ULS.sendTraceTag(571025377,
327,15,"Anchor para nodes missing, start={0}, end={1}",!ma.$za,!ma.pKa),!0;ma.j$d||this.DRa.ub(ma.$za)||this.DRa.add(ma.$za,{commentNode:bb,currentNode:ma.$za,MZd:ma.pKa,e2e:!0});ma.OAd||this.DRa.ub(ma.pKa)||this.DRa.add(ma.pKa,{commentNode:bb,currentNode:ma.pKa,MZd:ma.$za,e2e:!1})}return Ab}fnh(ma,bb,Ab){ma=Hg.a.ota(ma,Ab.id,!0);bb=Hg.a.ota(bb,Ab.id,!1);let ac;ma||({value:ac}=this.y9a.Bc(Ab.id,ac),this.y9a.Z(Ab.id,ac&1));bb||({value:ac}=this.y9a.Bc(Ab.id,ac),this.y9a.Z(Ab.id,ac&2));return!ma||!bb}}
Object(e.a)(Jh,"CommentHighlightOnRestActor",null,[413]);var Dl=c(347),Bh=c(348),Ge=c(742);class Wd{constructor(ma,bb){this.Wub=ma;this.wia=bb}getViewContainer(){return this.Wub}registerForViewContainerEvents(ma){this.wia.jqn(ma)}unregisterForViewContainerEvents(ma){this.wia.mio(ma)}}Object(e.a)(Wd,"ViewContainerProvider",null,[865]);class Pd{constructor(ma,bb,Ab,ac){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ma;this.appLocale=bb;this.uiCulture=Ab;
this.dataCulture=ac}}Object(e.a)(Pd,"LocalizationDetails",null,[]);var rf=c(1124),ie=c(1476);class rd{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng,Sg,qj,wi,Ki,Zi,eh,Zl,nl,mb,nc,Wc,vd,Md,tf,If,fg,ea){this.wq=ma;this.ek=bb;this.KZb=Ab;this.lZ=ac;this.ir=sc;this.vi=Sc;this.mDd=Cd;this.b5b=ke;this.kq=Dd;this.wc=$d;this.dynamicScriptLoader=mf;this.VBn=jg;this.$h=ge;this.EYe=ng;this.BYe=Sg;this.g8g=qj;this.ato=wi;this.E_=Ki;this.ES=Zi;this.ADn=eh;this.N7k=Zl;this.Bwi=nl;this.bto=mb;this.lxb=nc;
this.FS=Wc;this.Ch=vd;this.fJ=Md;this.QZe=tf;this.B1a=If;this.Xvd=fg;this.dGk=ea;this.Wcd=this.STa=null;this.gKg=!1;this.iBe=[];this.c_g=this.hKg=!1;this.initialize=(Ua,sb)=>{this.n4l(sb)};this.WRk=Ua=>Ph.a.p_e(Ua);this.QSm=()=>{this.D9h()};this.qul=(Ua,sb,Lb)=>{Ua=Object.assign(Object.assign({},new rf.a),{containerPanel:Ua,paneOpenedCallback:sb,paneClosedCallback:Lb,ulsLogger:new Dl.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:v.AFrameworkApplication.isRtl&&this.ir.Sib,
viewportInfo:this.Ch.Adf(),destroyAllContainersCallback:()=>{this.vi.pn||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.ir.nDd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.ir.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.ir.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.ir.contentNavigationApiEnabled,
contentFilterApiEnabled:this.ir.contentFilterApiEnabled,returnToDraftFixEnabled:this.ir.returnToDraftFixEnabled}});this.ir.contentNavigationApiEnabled&&(Ua.sidetrackContentNavigationApi=this.QZe,Ua.featureGateApiSettings=this.FS.D5e,Ua.telemetryDetails=this.Bwi,this.ir.contentFilterApiEnabled&&(Ua.contentFilterAPI=this.dGk));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Ua)};this.FUm=Ua=>{2!==this.wq.mode&&3!==this.wq.mode&&this.ek.Js&&Ua===this.ek.Js.id&&this.wq.clearSelection();
W.App.xa.updateCommandUI(!0)};this.Qxi=(Ua,sb)=>{this.Bv("onCSCStart",window.performance.now());this.S$a&&!Ua&&(this.Z0m(),this.Bv("openInFishbowl",!0));this.KZb.W$a&&this.ir.Byb&&this.wc.processAction(Hf.a.newComment,2);sb&&sb();this.Bv("onCSCEnd",window.performance.now())};this.ES.Dga("OnCommentInit",this.initialize);this.ES.Dga("OnCommentRenderedOnce",this.QSm);this.FS.pMn(()=>{},this.FUm)}get WGa(){return this.wq}get S$a(){return this.vi.S$a}Bv(ma,bb){this.B1a.Bv(ki.a.comments,ma,bb,!0)}n4l(ma){if(this.vi.cX)ma&&
ma.kDa&&ma.kDa();else if(this.gKg)(null===ma||void 0===ma?0:ma.kDa)&&this.iBe.push(ma.kDa);else{var bb=this.ir.OKc;this.Bv("hasCommentOnBoot",bb);bb?this.lxb.logKpiUsage(ie.a.FBc,0):Bh.a.w$b("canvas","floatingComments");this.gKg=!0;this.Bv("initInProgress",!0);this.ek.initialize(this.wq);this.KZb.initialize(this.wq,null);this.KZb.$2i(this.wq);this.b5b.g5l(this.lZ.XQn);this.Bv("InitAMSetup",window.performance.now());Ge.a.Lq(this.N7k).continueWith(Ab=>{(this.STa=Ab.result)||a.ULS.sendTraceTag(574734881,
327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.EYe.initialize(this.STa);this.WGa.rYe.initialize(this.WGa,this.ek,this.STa,this.EYe);this.g8g.initialize(this.dynamicScriptLoader,this.WGa.rYe,this.Bwi,this.STa,new Wd(this.ato,this.bto),this.rVh(),"",this.EYe.z_h(),this.E_,W.App.c8d);this.Bv("AMInitialized",window.performance.now());this.ir.contentNavigationApiEnabled?(W.App.Nzb?W.App.Nzb:this.Ch.Tmi()).then(()=>{this.Bv("FCMLoaded",window.performance.now());this.b0c();
this.cNd(ma)}):this.cNd(ma)})}}v9m(){var ma;this.ir.ADb&&(null===(ma=sharedComments.setDarkModeColorHandler)||void 0===ma?void 0:ma.call(sharedComments,this.WRk))}cNd(ma){this.Wcd=this.g8g.cNd(void 0,this.v9m.bind(this));this.rMc(ma);this.vi.cX=!0;this.ir.$1f&&this.BYe.initialize()}rMc(ma){if(!this.vi.CCb){this.Bv("InitCSStart",window.performance.now());var bb=this.kq.jg("Task","InitiateCommentingSession");this.lxb.logKpiUsage(ie.a.Bqh,0);try{const Ab=this.kq.jg("Task","InitiateCommentingSession-UpdateModel");
this.Xvd.E4l();Ab.stop();this.Bv("initAtBoot",window.performance.now());this.ir.yq&&this.ek.D4b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",H.a.kf()));ai.a.get_instance().EK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.vi.CCb=!0;this.Wcd.then(()=>{this.Bv("SCLoaded",window.performance.now());this.Ch.Y4l();this.Bv("FCMInitiated",window.performance.now());if(this.ir.yq){let sc=!1;if(this.S$a){var ac=
this.lZ.YEd(this.S$a);ac?(v.AFrameworkApplication.Ne("3ge3g205;cha3g788"),ac=this.lZ.ZEd(ac,0),ac)?this.ek.Yta(ac)||(sc=!0,this.$0m(ac)):(sc=!0,this.b1a()):sc=!0}ac=ma?ma.Fyi:null;this.ir.contentNavigationApiEnabled?this.Qxi(sc,ac):this.Yum(sc,ac)}ma&&ma.kDa&&ma.kDa();for(let sc of this.iBe)sc();this.hKg&&this.D9h();this.iBe=[]})}catch(Ab){a.ULS.CK(539567713,327,10,Ab,`Comments Initialization Failed: ${Ab}`),this.lxb.logKpiFailure(ie.a.Bqh,"CommentsInitializationFailed",{isInternal:!0},{name:ie.a.JZb,
isInternal:!0})}finally{bb.stop(),this.Bv("InitCSEnd",window.performance.now())}this.wc.processAction(Hf.a.dqh,2)}}$0m(ma){this.wc.processAction(Hf.a.UX,2);this.FS.M5i();Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.lZ.selectComment(ma,Object.assign(Object.assign({},new Zd.a),{sO:!0,F3:1}));this.$h.Kg(Xg.AFrame.hr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-v.AFrameworkApplication.bW)},Cf.a.kGn);this.lxb.OA(Hf.a.vYe);
v.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}b1a(){this.wc.processAction(Hf.a.b1a,2)}Yum(ma,bb){(W.App.Nzb?W.App.Nzb:this.Ch.Tmi()).then(()=>{this.Bv("FCMLoaded",window.performance.now());this.b0c();this.Qxi(ma,bb)}).catch(Ab=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+Ab.toString())})}b0c(){this.fJ.trackChangeInSidetrackEnabled?(this.mDd.b0c(),this.Bv("STSet",window.performance.now())):this.mDd.d3i(this.qul)}D9h(){this.c_g||
(this.vi.cX&&this.Wcd?(this.Wcd.then(()=>{const ma=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.ADn.execute(bb=>{ma.registerSafelinksNavigator(bb.ohc.bind(bb))});this.VBn.execute(bb=>{bb.Imn(ma)})}),this.c_g=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.hKg=!0))}rVh(){return new Pd(v.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.dataCulture)}Z0m(){this.lZ.uXi(this.S$a,
Object.assign(Object.assign({},new Zd.a),{q0f:!1,BNc:!0}));this.lxb.OA(Hf.a.vYe)}}Object(e.a)(rd,"CommentInitActor",null,[]);class Nk{constructor(ma,bb,Ab,ac,sc,Sc,Cd){this.kg=ma;this.Lj=bb;this.HD=Ab;this.ga=ac;this.NAj=sc;this.Ni=Sc;this.wf=Cd;this.Ode=this.xSa=null}get zoom(){let ma=1;this.Ni&&this.Ni.instance&&(ma=this.Ni.instance.vj);return 0<ma?ma:1}d9k(ma,bb){if(!this.Ode||!ma.dCa||bb>=ma.dCa.length)return null;const Ab=this.zoom,ac=ma.o7,sc=ma.Fwb(1,We.wnf,Ab,this.wf.oEi?bb:0);return this.$Kk(ma.dCa[bb],
ac,(this.Ode.y-ma.B2[bb].y)/Ab+We.moj,sc)}$Kk(ma,bb,Ab,ac){if(this.xSa)return(bb=this.xSa.parentElement)&&bb.removeChild(this.xSa),this.WZi(ma,this.xSa,Ab,ac),this.xSa;const sc=bb.Ng.ownerDocument,Sc=sc.createElement("div");Sc.className=Nk.aCk;this.WZi(ma,Sc,Ab,ac);this.wf.rKa?(ma=sc.createElement("span"),this.K3c(ma,Sc),Id(hc[4],ma),this.BNi(ma,bb)):(ma=sc.createElement("img"),this.K3c(ma,Sc),ma.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(3,4)),ma.src=v.AFrameworkApplication.pr,
ma.alt=CommonUIStrings.l_CommentNewCommentButton,this.BNi(ma,bb));return this.xSa=Sc}K3c(ma,bb){ma.title=CommonUIStrings.l_CommentNewCommentButton;ma.setAttribute("role","button");bb.appendChild(ma)}BNi(ma,bb){this.kg.uE(Mf.a.click,ma,this.kUm.bind(this),bb);this.kg.mb(Mf.a.XC,ma,this.mUm.bind(this));this.wf.rKa||(this.Lj.mb(Mf.a.pX,ma,this.oUm.bind(this)),this.Lj.mb(Mf.a.Vfa,ma,this.nUm.bind(this)));this.HD.mb(ma,this.lUm.bind(this))}qLd(){if(this.xSa){const ma=this.xSa.parentElement;ma&&ma.removeChild(this.xSa)}}WZi(ma,
bb,Ab,ac){this.NAj.A0k(ma,Ab)?bb.style.left=ac+We.wnf+"px":bb.style.left=ac+"px";bb.style.top=Ab+"px";bb.style.right="auto";bb.style.display="block";bb.style.position="absolute";bb.style.overflow="hidden";bb.style.cursor="default";bb.style.zIndex="40"}mUm(){return!0}kUm(ma){this.ga.PG=30;this.ga.processAction(Hf.a.newComment,2);ma=ma.Fv;this.wf.rKa?Id(hc[4],ma):ma.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(3,4));ma=ma.parentElement;(null===ma||void 0===ma?0:ma.parentElement)&&
ma.parentElement.removeChild(ma);return!0}oUm(ma){ma.Fv.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(2,4));return!0}nUm(ma){ma.Fv.className=Tf.getImageClassWithCluster(v.AFrameworkApplication.mQ,vb(3,4));return!0}lUm(){return!0}}Nk.aCk="clip16x16 EntryPointContainer";Object(e.a)(Nk,"CommentMarginEntryPointActor",null,[]);var bh=c(94),yi=c(452),Db=c(216),Ic=c(26),Jd=c(115);class Ne{constructor(ma,bb,Ab,ac,sc,Sc,Cd){this.Ewf=ma;this.Usm=bb;this.eq=Ab;this.vi=ac;this.ir=sc;this.zYe=
Sc;this.lxb=Cd;this.SIi=new Set;this.pFb=new Set;this.lUc=new Db.a;this.Sda=this.XEd()}get fy(){return this.Ewf.value}get Ad(){return this.fy.Ad}get cAa(){return this.Usm.value}XEd(){const ma=new me.GraphIterator;ma.set(this.fy);this.cAa.X0a(ma);return ma}E4l(){this.vi.CCb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",Ic.Debug.oYa());this.ir.contentNavigationApiEnabled||(this.ir.OKc&&this.C4l(),this.eq.Lzi())}URm(){this.eq.Lzi()}d7l(ma){const bb=
[];for(let Ab of ma)ma=Ab.Rj.toString(),Ab.Oc&&(this.SIi.has(ma)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",Ab.Rj):(this.SIi.add(ma),(ma=this.n3j(Ab))&&bb.push(ma)));this.dUi();return bb}n3j(ma){var bb=this.Ad.Db(ma.Rj);this.Sda.Ei(bb);if(40!==this.Sda.Le||!bb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!bb,!ma.Rj),this.Sda=39===this.Sda.Le?
this.Sda:this.XEd(),null;bb=this.eq.Axd(this.Sda);let Ab;if(({index:Ab}=this.eq.cce(bb)).returnValue)if(this.eq.iOe(bb,Ab),this.pFb.add(bb.objectId),bb.Kf)this.n$e(bb);else return{contentId:bb.id,containerContentType:0,u7:{Fd:ma.Ob.cp,cM:ma.paragraph.xn}};else this.lUc.add(bb);return null}n$e(ma){if(ma.Kf){var bb=this.eq.$C(ma.Kf);if(bb&&bb.Kf){const Ab=this.eq.$C(bb.Kf);Ab&&(Ab.Kf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ma.Kf=bb.Kf,a.ULS.sendTraceTag(523270217,
327,15,`Comment reply id pointing to another reply. objectid: ${ma.objectId} parentObjectId: ${bb.objectId}`)))}}}C4l(){const ma=new K.a(0),bb=bh.a.Zp(this.eq.TFa),Ab=new Set;this.ir.n2m&&!yi.a.isEnabled&&this.n5j(bb,ma);let ac=this.XEd(),sc=new Set;const Sc=new Set,Cd=new dj.GraphTransaction(2);try{if(Cd.Qu(ac),ac.fq(1)){for(;bb.moveNext();){if(!nb.ParagraphReader.yh(bb.iterator))continue;const Dd=bb.iterator.currentNode,$d=nb.ParagraphReader.rAb(Dd);yi.a.isEnabled&&this.hHm(Dd,$d,ma);Ab.add(Dd.id.toString());
this.lIi($d,Sc,ac,sc)}this.dUi();const ke=this.dol(Ab);0<ke.length&&this.mBn(ke,Ab,ac,Sc)}}finally{Cd&&Cd.dispose()}0==this.pFb.size&&this.ir.OKc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");ec.a.kBm(sc,Sc,this.Ad)}lIi(ma,bb,Ab,ac){for(let sc of ma)ma=sc.Rj.toString(),(this.ir.yq?!sc.Oc:sc.Oc)?bb.has(ma)||ac.add(ma):bb.has(ma)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",sc.Rj):(bb.add(ma),this.o3j(sc,
Ab))}mBn(ma,bb,Ab,ac){const sc=this.wEl(ma);ec.a.Qvk(sc);const Sc=new Set,Cd=new Set;sc.forEach(Dd=>{bb.has(Dd.id.toString())||Cd.has(Dd.id.toString())||(Cd.add(Dd.id.toString()),Dd=nb.ParagraphReader.rAb(Dd),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Dd.length} CommentRangeObjects`),this.lIi(Dd,ac,Ab,Sc))});const ke=[];ma.forEach(Dd=>{this.pFb.has(Dd)||ke.push(Dd)});0<ke.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${ke.length} Failed To Load on Retry: ${ke.join(",")}`),
this.lxb.logKpiFailure(ie.a.FBc,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:ie.a.JZb,isInternal:!0}))}wEl(ma){const bb=[];ma.forEach(Ab=>{if(Ab=this.zYe.GPh(Ab))Ab=Qd.k(Ab),(Ab=this.Ad.Db(Ab))&&Ab.Ui&&bb.push(Ab)});return bb}o3j(ma,bb){const Ab=this.Ad.Db(ma.Rj);bb.Ei(Ab);40===bb.Le&&Ab?(ma=this.eq.Axd(bb),({index:bb}=this.eq.cce(ma)).returnValue?(this.eq.iOe(ma,bb),this.pFb.add(ma.objectId),ma.Kf&&this.n$e(ma)):this.lUc.add(ma)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!Ab,!ma.Rj),39===bb.Le||this.XEd())}dol(ma){let bb=[];const Ab=this.zYe.Xnl();if(this.pFb.size===Ab.length)return bb;Ab.forEach(ac=>{!this.pFb.has(ac)&&ec.a.gpm(ac,ma,this.zYe,this.Ad)&&bb.push(ac)});return bb}dUi(){for(let ma=0;ma<this.lUc.length;ma++){const bb=this.lUc.J(ma);let Ab;({index:Ab}=this.eq.cce(bb)).returnValue?(this.eq.iOe(bb,Ab),this.pFb.add(bb.objectId),bb.Kf&&this.n$e(bb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ParentId: {2}",
bb.kMa,bb.HXa,bb.Kf))}this.lUc.clear()}n5j(ma,bb){ma.Xm(Ab=>{if(11===Ab.Le){var ac=Ab.currentNode;const sc=ac.ia(Jd.a.HYe,null),Sc=ac.ia(Jd.a.FYe,null);Ab=!!sc&&0<sc.length;const Cd=!!Sc&&0<Sc.length;Ab&&sc.forEach(Dd=>{const $d=this.Ad.Db(Dd);$d&&!Qd.s($d)&&bb.add(Dd,0)});Cd&&Sc.forEach(Dd=>{bb.ub(Dd)&&bb.remove(Dd)});(ac=ac.ia(Ec.a.gI,null))&&ac.forEach(Dd=>{const $d=this.Ad.Db(Dd);nb.ParagraphReader.nc($d)&&!this.vi.hx.ub(Dd)&&this.vi.hx.add(Dd,new Ji.a)});const ke=bb.keys;for(let Dd=0;Dd<ke.length;Dd++){ac&&
0<bb.J(ke.J(Dd))&&(this.vi.fU.ub(ke.J(Dd))||this.vi.fU.add(ke.J(Dd),new Ba.a(new ee.a)),ac.forEach(mf=>{const jg=this.Ad.Db(mf);nb.ParagraphReader.nc(jg)&&(this.vi.hx.J(mf).dM||(this.vi.hx.J(mf).dM=new Ba.a(new ee.a)),this.vi.fU.J(ke.J(Dd)).add(mf),this.vi.hx.J(mf).zZa=!0,this.vi.hx.J(mf).dM.add(ke.J(Dd)))}));let $d;bb.Z($d=bb.keys.J(Dd),bb.J($d)+1)}return Ab||Cd}return!0},null)}hHm(ma,bb,Ab){ma&&(this.Auj(bb,Ab),this.vi.hx.ub(ma.id)||this.vi.hx.add(ma.id,new Ji.a),Ab.forEach((ac,sc)=>{0<sc&&(this.vi.fU.ub(ac)||
this.vi.fU.add(ac,new Ba.a(new ee.a)),this.vi.hx.J(ma.id).dM||(this.vi.hx.J(ma.id).dM=new Ba.a(new ee.a)),this.vi.fU.J(ac).add(ma.id),this.vi.hx.J(ma.id).zZa=!0,this.vi.hx.J(ma.id).dM.add(ac));Ab.Z(ac,sc+1);return!0}))}Auj(ma,bb){ma.forEach(Ab=>{if(Ab.Oc){const ac=this.Ad.Db(Ab.Rj);ac&&!Qd.s(ac)&&bb.Z(Ab.Rj,0)}else bb.ub(Ab.Rj)&&bb.remove(Ab.Rj)})}}Object(e.a)(Ne,"CommentModelBootLoader",null,[409]);var Ee=c(1007);class $f{constructor(ma){this.Dqh=ma;this.Pnc=null;this.iSg=void 0;this.jSg=null;this.Dsc=
new Map;this.voe=new Map}aqn(){Ee.a.dPa(this.bko.bind(this))}bko(ma,bb){let Ab=ma.id.toString();var ac=ma.getValue(ia.a.hE).toString();bb?(this.Dsc.delete(Ab),this.voe.delete(ac)):(this.Dsc.set(Ab,ma),this.voe.set(ac,ma));0===this.Dsc.size&&this.Pnc&&(ma=+new Date-+this.Pnc,this.Pnc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ma}`));bb||this.iSg!==ac||(bb=+new Date-+this.jSg,a.ULS.sendTraceTag(541878464,
327,15,`Deeplinked Comment added after deeplink navigation failed: ${bb}`),ac=new F.a,ac.durationMs=bb,this.Dqh.logKpiFailure(ie.a.Ovd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:ac},{name:ie.a.jqh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ac}));this.Pnc||(this.Pnc=new Date)}set bLm(ma){this.iSg=ma;this.jSg=new Date;if(ma=this.Vnl(ma))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ma.id} present but failed to load`),ma=new F.a,this.Dqh.logKpiFailure(ie.a.Ovd,
"CommentPresentButFailedToLoad",{isInternal:!0},{name:ie.a.jqh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ma})}Xnl(){return[...this.Dsc.keys()]}Vnl(ma){return this.voe.get(ma)}GPh(ma){return this.Dsc.get(ma)}}Object(e.a)($f,"CommentNodeTracker",null,[]);class sf{constructor(ma,bb,Ab,ac,sc){this.FVf=ma;this.eq=bb;this.lZ=Ab;this.YJ=ac;this.vi=sc;this.FVf.TNi(this)}get contentType(){return 0}xXi(ma,bb,Ab){0===bb?(bb=this.eq.HNc(ma),this.lZ.selectComment(bb?this.eq.Ry:this.eq.$C(ma),
Object.assign(new Zd.a,{sO:Ab||bb,F3:1}))):this.YJ.clearSelection()}v4i(ma){return this.vi.pn||this.eq.HNc(ma.contentId)?!0:this.eq.Yta(this.eq.$C(ma.contentId))}}Object(e.a)(sf,"CommentReviewSuggestionContentActor",null,[408]);class Ke{constructor(ma){this.Xvd=ma;this.W3f=new Set([12])}get R$i(){return this.W3f}initialize(){}Zmi(ma){if(!nb.ParagraphReader.nc(ma.node))return[];ma=nb.ParagraphReader.rAb(ma.node);return this.Xvd.d7l(ma)}zxi(){this.Xvd.URm()}}Object(e.a)(Ke,"CommentReviewSuggestionContentProvider",
null,[407]);var sh=c(62),Re=c(104),dh=c(261),Ck=c(1518);class mh{constructor(){this.commentId=null;this.jPc=!1}}Object(e.a)(mh,"CommentToSelectOnPaneLoadData",null,[]);class vh{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng,Sg){this.wq=ma;this.eq=bb;this.bAa=Ab;this.lZ=ac;this.ES=sc;this.vi=Sc;this.mDd=Cd;this.ir=ke;this.KZb=Dd;this.n0a=$d;this.wc=mf;this.Fwf=jg;this.$h=ge;this.fj=ng;this.CCk=Sg;this.wc.pa(Hf.a.XKb,sh.a.frame,this.wq.XKb.bind(this.wq));this.wc.pa(Hf.a.iAd,sh.a.frame,this.iAd.bind(this));
this.wc.pa(Hf.a.sYe,sh.a.frame,this.ISm.bind(this));this.wc.pa(Hf.a.PBk,sh.a.frame,this.HSm.bind(this));this.wc.pa(Hf.a.Dui,sh.a.frame,this.XWm.bind(this));this.wc.pa(Hf.a.HBh,sh.a.frame,this.STm.bind(this));this.wc.pa(Hf.a.qqh,sh.a.frame,this.lVm.bind(this));this.wc.gb(Hf.a.xYe,sh.a.frame,this.gek.bind(this),64);this.wc.gb(Hf.a.Wvd,sh.a.frame,this.rrn.bind(this),64);this.wc.pa(Hi.a.selectComment,sh.a.frame,this.lZ.gGn.bind(this.lZ));this.ir.xtm&&this.wc.pa(Hi.a.kSd,sh.a.frame,this.kSd.bind(this));
this.a9g(Hi.a.LDc,!1);this.a9g(Hi.a.t3e,!0);this.wc.gb(Hi.a.Yvd,sh.a.frame,this.Yvd.bind(this),64);this.wc.pa(Hi.a.Oni,sh.a.frame,Re.ActionManager.Of);this.ir.kwb&&this.wc.pa(Hi.a.fVe,sh.a.frame,this.Mpk.bind(this));this.wc.pa(Hi.a.Bzh,sh.a.frame,(qj,wi)=>dh.a.ufa(wi.rk)&&dh.a.K6b()?8:32)}get ek(){return this.eq}get mode(){return this.wq.mode}get aA(){return this.wq.aA}get Mz(){return this.ir.yq}get Mi(){return this.n0a.value}get Cb(){return this.Fwf.value}get YJ(){return this.wq}iAd(ma,bb,Ab,ac,
sc){return sc?sc?(ma=this.lZ.YEd(sc.NavigationId))&&this.lZ.ZEd(ma,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}ISm(ma,bb,Ab,ac,sc){sc&&this.ES.Sna("OnCommentInit",Object.assign(Object.assign({},new Ck.a),{kDa:()=>{var Sc=this.lZ.YEd(sc.NavigationId);if(Sc){var Cd=this.lZ.ZEd(Sc,1);Cd?this.KZb.isVisible?(this.EZc(Cd,1),this.$h.iC(Xg.AFrame.hr)):this.ek.Yta(Cd)?(Sc=
Qd.r(Cd),this.lZ.selectComment(Cd,Object.assign(Object.assign({},new Zd.a),{sO:!Sc,F3:1})),this.$h.iC(Xg.AFrame.CL)):(this.vi.pn||this.wc.processAction(Hf.a.UX,2),Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.EZc(Cd,1)},Cf.a.EZc)):this.wc.processAction(Hf.a.b1a,2)}}}));return 32}HSm(ma,bb,Ab,ac,sc){sc?(ma=this.ek.NHc(sc))?this.YJ.N$b(ma.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.YJ.N$b(null);return 32}XWm(ma,bb,Ab,ac,sc){if(sc){if(this.vi.CCb){for(ma=
0;ma<sc.length;ma++)this.ek.SZi(sc[ma]);this.wq.RIb()}else this.ek.k7j(sc);this.wBm(sc)}return 32}STm(ma,bb,Ab,ac,sc){if(sc)if(this.vi.CCb){for(ma=0;ma<sc.length;ma++)this.ek.SZi(sc[ma],!0);this.wq.RIb()}else this.ek.oyk();return 32}lVm(ma,bb,Ab,ac,sc){this.Mz||this.vi.pn||this.wc.processAction(Hf.a.UX,2);if(sc){ma=null;if(!this.aA||2!==this.mode&&3!==this.mode){if(!sc)return 8;if(this.Mz)ma=this.G$k(sc);else for(bb=0;bb<sc.length&&(ma=this.ek.zZ(sc[bb].toString()),this.mDd.TOd&&(!ma||ma.done));bb++);
}else ma=this.aA;this.EZc(ma,1);ma&&this.vi.cX&&this.$h.Kg(this.Mz&&!this.vi.pn?Xg.AFrame.CL:Xg.AFrame.hr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}gek(ma,bb,Ab,ac,sc){var Sc;if(!sc)return 32;if(sc&&0<sc.length){bb=ma=Ab=0;ac=!1;for(let Cd=0;Cd<sc.length;Cd++)sc[Cd].toString()===(null===(Sc=this.aA)||void 0===Sc?void 0:Sc.objectId)?(ac=!0,ma++):this.eq.Zsf(sc[Cd])&&(ac&&0===Ab&&(Ab=Cd,bb=ma),ma++);(Sc=this.eq.zZ(sc[Ab].toString()))?
(this.bAa.Qgc.tEf=bb+1,this.bAa.Qgc.Sgc=ma,this.YJ.N$b(Sc.id)):(sc=sc[Ab],this.Mi.Db(sc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${sc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",sc.toString()))}return 32}rrn(){this.YJ.N$b(null);return 32}a9g(ma,bb){this.wc.pa(ma,sh.a.frame,(Ab,ac,sc)=>this.xTm(sc,bb))}kSd(ma,bb,Ab){2===Ab&&(ma=this.ek.LL.Rc(7),ma.Eb(this.ek.TFa),bb=
new bi.a,bb.kfa(`${String.fromCodePoint(128077)} \n`),this.eq.Sxb(kc.a.instance.ib.kb,void 0,bb),this.CCk.qLd(),ma.dispose());return 32}xTm(ma,bb=!1){if(2===ma)ma=this.ek.LL.Rc(15),ma.Eb(this.ek.TFa),this.fj.Qd(()=>{this.LDc(bb)},"ECM:DAC"),ma.dispose();else if(1===ma&&!this.ek.D4b())return 2;return 32}LDc(ma=!1){this.wq.mode=1;const bb=this.ek.kT();for(let Ab of bb)Ab.Rq===jd.a.beingCreated||ma&&!Ab.done||Ab.Kf||this.wq.deleteComment(Ab);this.$h.Kg(Xg.AFrame.Wo);0<(ma?this.ek.kT().filter(Ab=>Ab.done):
this.ek.kT()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ma):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ma)}Yvd(ma,bb,Ab){if(2===Ab)if(ma=this.$h.pg.name,ma!==Xg.AFrame.hr&&ma!==Xg.AFrame.CL){!this.Mz||this.vi.pn?(this.vi.pn||this.wc.processAction(Hf.a.UX,2),this.$h.Kg(Xg.AFrame.hr)):this.$h.Kg(Xg.AFrame.CL);var ac=this.Cb.ib.kb;if(!ac||!ac.Qa)return 2;ma=ac.Qa.cpBegin;bb=ac.Qa.node;
ac=!!this.aA&&(Tg.SelectionEditor.Dm(ac)||ac.dO)&&Qd.q(this.aA,bb,this.Mi,ma);ma=!!this.aA&&(2===this.mode||3===this.mode);if(ac||ma)return this.YJ.zXi(this.aA.id,!0),32;ac=this.Mz&&!this.vi.pn?this.ek.HPh(!0,!0):null;this.YJ.qGn(ac)}else this.ek.Js&&(this.wq.b5b.tXi(this.ek.Js,!0),this.wq.b5b.gfb(null===(ac=this.ek.Js)||void 0===ac?void 0:ac.objectId)),this.$h.Kg(Xg.AFrame.Wo);return 32}Mpk(){return 4}wBm(ma){const bb=new Set;for(let Ab=0;Ab<ma.length;Ab++){const ac=this.ek.NHc(ma[Ab]);ac&&bb.add(ac.Kf?
ac.Kf:ac.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",bb.size.toString())}EZc(ma,bb){ma?this.KZb&&!this.vi.cX?this.vi.lbb=Object.assign(new mh,{commentId:ma.id,jPc:!1}):this.lZ.selectComment(ma,Object.assign(new Zd.a,{sO:!!bb,F3:bb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}G$k(ma){let bb=null,Ab=!1;for(let ac=0;ac<ma.length;ac++){const sc=ma[ac].toString();if(this.ek.Zsf(ma[ac])){bb||(bb=sc);if(Ab&&this.ek.Js.objectId!==
sc)return this.ek.zZ(sc);Ab=Ab||!!this.ek.Js&&this.ek.Js.objectId===sc}}return bb?this.ek.zZ(bb):null}}Object(e.a)(vh,"CommentsActionManager",null,[]);var zg=c(203),zi=c(39),Qh=c(164),Rl=c(1732),kh=c(538),nk=c(34),Lh;(function(ma){ma[ma.lFo=0]="commentDeeplink";ma[ma.catchUpActivity=1]="catchUpActivity"})(Lh||(Lh={}));Object(e.b)("DeeplinkSource",Lh);class Rh{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge){this.ga=ma;this.ki=bb;this.tv=Ab;this.hle=ac;this.VO=sc;this.e1g=Sc;this.Ub=Cd;this.sj=
ke;this.wf=Dd;this.orb=$d;this.jle=mf;this.TK=jg;this.YHe=!1;this.XQn=ng=>{if(this.wf.yq&&!this.sj.pn){const Sg=new oa.a(0,1,0,()=>{this.DZi(ng)},136,void 0,!0);v.AFrameworkApplication.uc.fc(Sg)}else this.DZi(ng)};ge.execute(ng=>{this.VH=ng})}get eq(){return this.ki}get Cb(){return this.orb.value}sEh(ma){let bb=ma.Rq===jd.a.beingCreated?ma.Ny.draftId:ma.id,Ab=null;ma.Kf&&(bb=ma.Kf,Ab=()=>{this.e1g.selectComment(ma.id)});this.VO.setInitialActiveContainerId(bb,0,Ab)}gGn(ma,bb,Ab,ac,sc){if(!sc.commentId)return 2;
ma=this.ki.$C(sc.commentId);if(!ma)return 2;this.pkb(ma,sc);return 32}wXi(ma,bb){var Ab,ac;if(ma){var sc=(null===(ac=null===(Ab=this.ki.Ry)||void 0===Ab?void 0:Ab.Ny)||void 0===ac?void 0:ac.draftId)===ma?this.ki.Ry:this.ki.$C(ma);this.selectComment(sc,bb)}}selectComment(ma,bb){ma&&this.pkb(ma,bb)}uXi(ma,bb){var Ab=this.YEd(ma);Ab&&((Ab=this.ZEd(Ab,0))?bb.q0f?(this.sj.lbb=Object.assign(new mh,{commentId:Ab.id,jPc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.pkb(Ab,Object.assign(new Zd.a,{commentId:Ab.id,F3:1,sO:!0,BNc:!0})),this.wf.yq&&void 0!==ma&&null!==ma&&this.sEh(Ab),Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.Ub.Kg(this.wf.yq&&!this.sj.pn?Xg.AFrame.CL:Xg.AFrame.hr)},Cf.a.rMn),zg.a.instance.Xf(zi.a.yyh,(new Date).getTime()),ma=this.wf.yq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ma+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ma,(new Date).getTime()-v.AFrameworkApplication.bW)):
this.ga.processAction(Hf.a.b1a,2))}YEd(ma){let bb=null;var Ab=null;if(N.a.q7b(ma))bb=ma;else if(({Iv:Ab}=A.d(ma)).returnValue&&(ma=Ab))return kh.a.comment in ma&&(bb=ma[kh.a.comment]),bb;bb||(Ab=Ab?Object.keys(Ab):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",Ab?Ab.join(","):"Not Json."));return bb?bb.toString():null}ZEd(ma,bb){const Ab=this.ki.NHc(ma),ac=0===bb;ac&&this.TK.logKpiUsage(ie.a.Ovd,0);if(!Ab){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",
ma,bb);const sc=new nk.a;sc.name="DeepLinkSource";sc.string=Lh[bb];this.TK.logActivity("CommentDeeplinkNotFound",{dataFields:[sc]});ac&&(bb=new F.a,bb.extendedProperties=new Map([["ErrorLevel","warning"]]),this.TK.logKpiFailure(ie.a.Ovd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:bb}),this.jle.bLm=ma)}return Ab}DZi(ma){this.YHe=!0;this.Cb.setSelection(ma);this.YHe=!1}pkb(ma,bb){if(ma){this.sj.HGb&&(v.AFrameworkApplication.uc.Ye(this.sj.HGb),this.sj.HGb=null);var Ab=this.ki.Js,
ac=this.eq.fhf(ma),sc=2===bb.F3,Sc={};sc&&(Sc.TriggeredByFindReplace=!0);if(this.sj.pn)sc&&(Sc.PaneAlreadyOpen=!0),Qh.UISurfaces.fu().then(Cd=>{Cd.setSelectedTaskPane(Rl.a.Zvd);return null});else if(ma.Rq!==jd.a.beingCreated&&!this.eq.Yta(ma))this.sj.cX?this.ga.processAction(Hi.a.UX,2):this.sj.lbb=Object.assign(new mh,{commentId:ma.id,jPc:bb.BNc}),sc&&(Sc.OpeningPaneToSelect=!0);else if(this.wf.yq){const Cd=ac.Rq===jd.a.beingCreated;Cd?this.VO.KPa(ac.Ny.draftId,0,bb.sO):this.VO.KPa(ac.id,0,bb.sO);
!Cd&&sc&&(Sc.SelectingDHC=!0)}Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.sj.cX&&(bb.sO&&this.Ub.Kg(this.wf.yq&&!this.sj.pn?Xg.AFrame.CL:Xg.AFrame.hr),bb.BNc&&this.eq.Yta(ma)||!bb.sO&&!bb.F3||this.e1g.selectComment(ma.id))},Cf.a.GYf);sc=this.eq.fhf(Ab);this.wf.jsa&&this.VH&&sc&&sc.id!==ac.id&&this.VH.fireEvent(9,{comment:sc});this.ki.selectComment(ma);this.wf.jsa&&this.VH&&ma.Rq===jd.a.normal&&!ma.Kf&&this.VH.fireEvent(8,{comment:ma});this.hle.highlightComment(ma,!0);this.tv.rH(0,ac,Ab);W.App.xa.updateCommandUI(!0);
0<Object.keys(Sc).length&&this.TK.OA(Hi.a.selectComment,{customData:Sc})}}}Object(e.a)(Rh,"CommentSelectionActor",null,[406]);class wf extends Oc.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Yc.a,{T_:wf.getTypeName(),B_:wf.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(wf,"CommentSmartReplySignal",Oc.a,[]);class lc extends va.a{constructor(){super();this.DomainName=
this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Yc.a,{T_:lc.getTypeName(),B_:lc.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(e.a)(lc,"SmartReply",va.a,[]);var Bm=c(843);class Rd{constructor(ma){this.xpa=ma}x_b(ma,bb){return Object.assign(new Bm.a,{parentPath:["Signal",wf.getTypeName()],items:[Object.assign(new le.a,{body:Object.assign(new wf,{commentId:ma,
comment:bb})})]})}GMf(ma){const bb=new fb.a;if(ma&&ma.CommentId&&ma.ResultSets&&0<ma.ResultSets.length&&ma.ResultSets[0].Documents&&0<ma.ResultSets[0].Documents.length){for(const Ab of ma.ResultSets[0].Documents)bb.add(Ab.Caption);0<bb.count&&this.xpa.GMf(ma.CommentId,bb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return lc.getTypeName()}}Object(e.a)(Rd,"BaseCommentSmartReplyProvider",null,[1037]);class qe extends Rd{constructor(ma,
bb,Ab,ac){super(ma);this.Jf=bb;this.OJ=Ab;this.hyj=ac}initialize(){this.OJ.Qm().then(()=>{this.Jf.mb(this,Rd.prototype.getTypeName.call(this))})}invoke(ma,bb){this.OJ.Qm().then(()=>{this.hyj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Mg.a,{operation:this.x_b(ma,bb)}))})}GF(ma,bb){ma&&ja.a.getTypeNameFor(ma.content)===this.getTypeName()&&bb===Ga.a.getTypeName()?this.GMf(ma.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(qe,"CommentSmartReplyProvider",
Rd,[54]);var ok=c(29),jj=c(134),Di=c(159),td=c(617);class rn{constructor(ma,bb,Ab,ac,sc,Sc){this.Oa=ma;this.Ic=bb;this.Ax=Ab;this.Uxe=ac;this.jle=sc;this.fJ=Sc;this.wqb=!1;this.jle.aqn();this.KAj=this.UCl();this.RQf&&(ok.a.addHandler(window.self,Mf.a.Xbh,()=>{this.wqb=!0}),ok.a.addHandler(window.self,Mf.a.Ybh,()=>{this.wqb=!1}))}get fy(){return this.Ax?this.Ax.value:null}get cAa(){return this.Uxe.value}get ngo(){return this.wqb}get OKc(){return 0<this.KAj}get yq(){return this.fJ.yq}get IYk(){return!0}get mik(){return Object(td.a)()?
!1:this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get Sib(){return this.Oa.$("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get ULb(){return this.Ic.isFeatureEnabled(123)&&!Di.App.DOc}get uHn(){return this.Ic.isFeatureEnabled(35)&&this.Oa.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get rKa(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentSVGIconsEnabled",!1)}get GZl(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.HiddenRibbonCommentFocusFixEnabled",
!1)}get oEi(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageViewIndicatorPositionFixEnabled",!1)}get QBk(){return this.Oa.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get RQf(){return this.Oa.$("RecordCommentActionsInTypingIsEnabled")}get ivi(){return this.Oa.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get Byb(){return this.yq&&!this.OKc&&!this.Oa.lb("BootActivityNavigationId")&&E.a.Ys}get kwb(){return this.Ic.isFeatureEnabled(6)}get mhk(){return this.Oa.$("AtMentionUserFloodGateCampaignIsEnabled")}get dCk(){return this.Oa.$("CommentFriendlyTimestampsIsEnabled")}get DYk(){return this.Oa.lb("DisabledChangeGatesInSharedComments")}get nDd(){return this.fJ.nDd}get jLb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get mab(){return this.Ic.isFeatureEnabled(15)}get $1f(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get zX(){return this.Oa.lb("PresenceUserId")}get removePersonalInformation(){return Di.App.Hee&&!!jj.PageReader.instance&&jj.PageReader.instance.Tea(W.App.xa.jb.Xc).removePersonalInformation}get ADb(){return this.Ic.isFeatureEnabled(52)}get Fcb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get yum(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",
!1)}get u9n(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get VCk(){return this.Oa.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get JCk(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get xtm(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.fJ.contentNavigationApiEnabled}get n2m(){return this.Ic.isFeatureEnabled(89)}get jsa(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.fJ.contentFilterApiEnabled}get returnToDraftFixEnabled(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReturnToDraftFixEnabled",!1)}UCl(){if(this.fy&&this.cAa){const ma=new me.GraphIterator;ma.set(this.fy);this.cAa.X0a(ma);let bb=0;39===ma.Le&&(bb=ma.Mp());return bb}return-1}}Object(e.a)(rn,"CommentsSettings",null,[]);var dd=c(1544),Ok=c(1331);class Rg{constructor(ma){this.x8=ma}Gih(ma,bb,Ab){const ac=new oh;bb=this.x8.a0a(bb)?bb.objectId:
null;if(!bb)return ac;bb=ka.a.Pf(bb);if(Ab.contains(bb))return ac.fMc=0,ac.eMc=ma.length,ac;for(let Sc=0,Cd=ma.length;Sc<Cd;Sc++){var sc=ma[Sc];Ab=Qd.g(sc);sc=Qd.d(sc);Ab&&Ok.a.Yrh(Ab,bb)&&(ac.fMc=Sc);if(sc&&Ok.a.Yrh(sc,bb)){ac.eMc=Sc;break}}return ac}ceh(ma,bb,Ab){const ac=-1===bb.fMc&&-1===bb.eMc,sc=-1<bb.fMc?bb.fMc:-1;bb=-1<bb.eMc?bb.eMc:ma.length;const Sc=!ac&&sc===bb;var Cd=!1;for(let ke=0;ke<ma.length;ke++){const Dd=ma[ke],$d=Kh.a(Dd);if(1!==$d&&2!==$d&&3!==$d)continue;this.x8.p2a(Dd);if(ac||
ke<sc||ke>bb)continue;const mf=3===$d||2===$d&&-1!==Dd.className.indexOf(li.a.Mta),jg=Ab?1:2;this.cfk(ke,sc,bb,jg,mf,Cd,Dd,Sc);if(ke!==bb||Sc)(Cd=this.x8.EZa.J($d).J(jg))&&Dd.classList.add(Cd),Cd=mf}}cfk(ma,bb,Ab,ac,sc,Sc,Cd,ke){ma!==bb&&ma!==Ab||sc||Sc||((ma=this.x8.ebc.J(ac))&&Cd.classList.add(ma),ke&&Cd.classList.add(li.a.gMf))}}Object(e.a)(Rg,"DefaultHighlightChangeHandler",null,[404]);var Cm;(function(ma){ma[ma.success=0]="success";ma[ma.noSelection=1]="noSelection";ma[ma.invalidContent=2]="invalidContent"})(Cm||
(Cm={}));Object(e.b)("AnchorCreationResult",Cm);var vj=c(75),Hm=c(24),vq=c(293),Gh=c(246),wc=c(1186);class Og{}Object(e.a)(Og,"EditorAnchorInfo",null,[421]);class Ri{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke){this.Ysm=ma;this.Fwf=bb;this.ek=Ab;this.SZa=ac;this.bAa=sc;this.hu=Sc;this.ES=Cd;this.ir=ke;this.W0g=null;this.SZa.Kjb(this.bAa);this.ir.contentFilterApiEnabled&&(this.ES.Dga("OnCommentPaneOpen",this.Vlo.bind(this)),this.ES.Dga("OnCommentPaneClose",this.Ulo.bind(this)),this.ES.Dga("OnContentFilterUpdate",
this.ETc.bind(this)))}get Cb(){return this.Fwf.value}get Mi(){return this.Ysm.value}initialize(){}g5l(ma){this.W0g=ma}dispose(){}gfb(ma){this.bAa.gfb(ma)}a5b(ma){this.bAa.a5b(ma)}highlightComment(ma){this.tXi(ma,!1);this.bAa.gfb(ma.objectId)}Ehc(ma){this.bAa.Ehc(ma)}rBa(ma){return this.bAa.rBa(ma)}ETc(){this.qge("OnContentFilterUpdate")}Vlo(){this.qge("OnCommentPaneOpen")}Ulo(){this.qge("OnCommentPaneClose")}qge(ma){const bb=[],Ab=new Set;for(let sc of this.ek.kT())if(!sc.Kf&&sc.Rq!==jd.a.beingCreated&&
!this.ek.YJ.Zkh(ma,sc)){var ac=this.JDl(sc);Ab.has(ac.id.toString())||(Ab.add(ac.id.toString()),(ac=ac.Be(vj.InteractiveViewManager.instance.yd.Sb))&&bb.push(ac))}bb.forEach(sc=>{this.SZa.Fhc(sc)})}JDl(ma){var bb,Ab;const ac=null===(bb=this.Mi)||void 0===bb?void 0:bb.Db(ma.objectId);if(!ac)return null;ma=Qd.k(ac);bb=null===(Ab=this.Mi)||void 0===Ab?void 0:Ab.Db(ma);return ec.a.aXh(bb)}tXi(ma,bb){if(!ma.Rq){var Ab=this.Mi.Db(ka.a.Pf(ma.objectId)),ac=Hg.a.E$(Ab,this.Mi,!0);Ab=Hg.a.E$(Ab,this.Mi,!1);
if(ac&&Ab){const sc=ac.Ob.paragraph;ac=ac.Ob.cp;if(this.pmm(sc,ac))W.App.xa.updateCommandUI(!0);else{ac=Hm.SelectionFactory.xe(sc,ac);Ab=ud.a.Uc(Ab.Ob.paragraph,Ab.Ob.cp);if(Ri.ag.naa(ac.Qa)||Ri.ag.naa(Ab))ma.j7b=!0,ma.U0a();ma=bb?Hm.SelectionFactory.KB(ac,Ab):ac;this.W0g(ma)}}}}byk(){this.bAa.a5b(null);this.bAa.gfb(null)}cJk(){let ma=new Og;return{returnValue:Cm.success,anchor:ma}}pmm(ma,bb){if(ma&&Object(ul.a)(wc.PageView,this.hu.yd)){var Ab=ma.Be(this.hu.yd.Sb);ma=document.getElementById(kf.AppFrame.SFa);
if(Ab&&ma){bb=vq.a.tq(Ab,bb);if(!bb)return!1;bb=bb.y;Ab=Sys.UI.DomElement.getBounds(ma).y;ma=ma.offsetHeight;if(bb>=Ab&&bb<=Ab+ma)return!0}}return!1}static get ag(){return Gh.a.instance}static getInstance(){return Ri.Hl()}static Hl(){return Ri._instance||(Ri._instance=new Ri(new P.a(()=>W.App.xa.jb.Xc.Ad),new P.a(()=>kc.a.instance),M.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),M.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,M.a.instance.resolve("WordEditor.Comments.CommentHintActor"),
vj.InteractiveViewManager.instance,M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}Ri._instance=null;Object(e.a)(Ri,"EditorCommentHintManager",null,[402,403,10]);var vi=c(1886),gh=c(371),pk=c(1132);class ml extends tg.a{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng,Sg,qj,wi,Ki,Zi,eh,Zl,nl,mb,nc,Wc,vd){super(Cd);this.Ci=bb;this.orb=ke;this.rYe=$d;this.ypa=mf;this.llc=jg;this.VO=ge;this.wf=ng;this.Ep=Sg;this.nob=
qj;this.sj=wi;this.x4=Ki;this.me=eh;this.TK=Zl;this.Hh=nl;this.FS=nc;this.wYe=Wc;this.c6h=this.U2g=this.RSa=null;this.jib=()=>{this.Xwa.lua()&&(this.LNi(this.Xwa.Fc),this.Xwa.xcc(this.jib))};this.mSc=Md=>{2===Md.mode?this.pC=1:1===Md.mode&&(this.pC=0);this.ki.Ry&&0===this.pC?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.ki.Ry.Ny.sessionType):this.sj.cX&&(this.Mz||this.z0.isVisible)&&this.RIb()};this.ZQm=()=>{this.sj.CCb?
this.mode=0:this.pC=0};this.yDa=(Md,tf)=>{var If;Md=tf.kl.kb;if((this.Mz||this.Yaa&&this.Yaa.isVisible)&&!this.nob.YHe&&Md){tf=Tg.SelectionEditor.Dm(Md);var fg=Md.dO;null!==(If=this.c6h)&&void 0!==If&&If.s$||(If=this.eq.$fb(this.ga,!1),1!==this.mode||tf&&!fg||!If?this.llc.qLd():this.PMk(Md));2!==this.mode&&3!==this.mode&&this.wf.QBk&&this.Heo(Md,tf,fg)}};this.Nvk=()=>{if(this.ek&&this.ek.Ry&&(!W.App.uNa||!W.App.xpf)){var Md=this.ek.Ry;Md.Ny.sessionType!==vi.a.metadata&&(a.ULS.sendTraceTag(545640771,
327,15,`Draft Comment of type:${Md.Rq} present on app shutdown`),(Md=ec.a.csl(Md))&&this.TK.logKpiFailure(Md,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:ie.a.JZb,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.hRm=()=>{if(this.sj.cX){var Md=()=>!0;this.Mz&&!this.sj.pn&&(Md=tf=>this.eq.Yta(tf));Md=this.eq.qcf(Md);this.RIb(Md)}};this.ga=Cd;this.pC=1===this.ga.mode?0:1;this.z0=sc;this.ki=ac;this.L8=Sc;this.Ub=Dd;this.$on();Ab.Jjb(this.ypa);this.Cb.tB(this.yDa);ma.CWR(()=>ma.result.cB.IVa(this.ZQm));
v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.FVa(this.mSc);this.x4.Dga("OnAfterTrackChangeMarkupViewChange",this.hRm);v.AFrameworkApplication.FK&&v.AFrameworkApplication.FK(this.Nvk);vd.execute(Md=>{this.VH=Md});mb.execute(Md=>{Md.HGk.execute(tf=>{this.c6h=tf})})}$on(){this.Xwa&&(this.Xwa.lua()?this.LNi(this.Xwa.Fc):this.Xwa.vXb(this.jib))}LNi(ma){ma.Lja(()=>{this.I4n()})}get Xwa(){var ma;return null===(ma=Di.App.En)||void 0===ma?void 0:ma.jb}get Cb(){return this.orb.value}get ek(){return this.ki}get eq(){return this.ki}get Mz(){return this.wf.yq}get Sui(){return!0}get g5b(){return this.RSa}set g5b(ma){this.RSa=
ma}get mode(){return super.mode}set mode(ma){ma!==this.pC&&(super.mode=ma,this.U0a())}get aA(){return this.model&&this.model.Js?this.model.Js.Kf?this.model.$C(this.model.Js.Kf):this.model.Js:null}get Mi(){return this.Ci.value}get N5i(){return!1}get removePersonalInformation(){return this.wf.removePersonalInformation}RIb(ma=null,bb=null){const Ab=this.eq,ac=!this.pC,sc=this.Yaa.bCk,Sc=Ab.eHd();sc.u9f(Sc?5:1,ac);ma=this.wf.jLb&&ma?ma:Ab.Lcf(this.wf.jLb&&this.Mz&&!this.sj.pn);sc.pHn(ma,Sc,Ab.GRa);this.a9f();
bb&&a.ULS.sendTraceTag(572281362,327,50,bb)}FTc(ma,bb,Ab=!1){this.sj.pn?this.VO.fkj():bb?this.VO.deleteContainer(ma.Rq===jd.a.beingCreated?ma.Ny.draftId:ma.id,0,Ab):this.Thn(ma)}Thn(ma){const {cao:bb}=this.ki.sxl(ma),Ab=this.L8.rBa(ma.objectId);Ab&&this.VO.addContainer(ma.id,Ab.parentElement,0,bb)}DXi(ma){const bb=this.aA;this.GZc();this.ypa.rH(0,this.ki.Js,bb);this.Mz&&this.ki.Js&&!this.sj.pn&&this.VO.KPa(this.ki.Js.id,0,1===ma)}rGn(){const ma=this.aA;this.HZc();this.ypa.rH(0,this.ki.Js,ma);this.Mz&&
this.ki.Js&&!this.sj.pn&&this.VO.KPa(this.ki.Js.id,0,!1)}Ehc(ma){this.L8.Ehc(ma)}J2k(ma,bb){this.VO.addContainer(ma,null,0,bb)}d6m(ma){this.VO.zFi(ma)}L2k(ma,bb){this.VO.oYc(ma,bb,0)}glo(){this.VO.BSe()}vXi(ma){if(ma&&(2!==this.mode||ma.Rq===jd.a.beingCreated)){var bb=this.ki.Js;bb!==ma&&(this.ki.selectComment(ma),this.z0.isVisible?this.sj.cX?(this.z0.selectComment(ma,1),this.wia.selectComment(ma.id)):this.sj.lbb=Object.assign(new mh,{commentId:ma.id,jPc:!1}):this.Mz&&!ma.done&&(this.zXi(ma.id,!1),
this.wia.selectComment(ma.id)),!this.z0.isVisible&&this.Mz&&ma.done||(this.b5b.gfb(ma.objectId),this.ypa.rH(0,this.aA,bb)))}}rMc(){}d7e(){this.sj.CCb=!1}tvb(ma){this.wf.ivi&&this.ki.Js&&this.clearSelection();super.tvb(ma);this.TK.logKpiUsage(ie.a.DYe,0);this.a9f();if(this.Mz){const bb=this.ki.eOl(ma.draftId);this.J2k(ma.draftId,bb)}}addReply(ma,bb){this.TK.logKpiUsage(ie.a.awd,0);super.addReply(ma,bb)}ksa(ma){this.Mz&&null!=ma.Ny&&this.ki.NOi(ma.Ny.draftId);super.ksa(ma);this.L8.gfb(ma.objectId);
a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Qd.a(ma));this.TK.logKpiUsage(ie.a.hqh,0);this.Rvk(ma);ec.a.Lso(ma,this.Mi,this.TK);this.TK.OA(Hi.a.gqh,{succeeded:!0,customData:{actionType:ma.Kf?vi.a.reply:vi.a.create}})}nbb(ma){super.nbb(ma);this.TK.OA(Hi.a.gqh,{succeeded:!0,customData:{actionType:vi.a.edit}})}Rvk(ma){if(ma.Kf){var bb=this.ki.fhf(ma);if(bb.Syc&&bb.Tyc){var Ab=this.Mi.Db(ka.a.Pf(bb.Tyc));bb=bb.Tyc===bb.Syc?null:this.Mi.Db(ka.a.Pf(bb.Syc));ec.a.xdg(Ab,ma,!0);ec.a.xdg(bb,
ma,!1)}}}MDc(ma){super.MDc(ma);this.aA&&this.aA.id===ma.id&&(super.clearSelection(),this.Mz&&this.VO.sZb());if(this.Mz)if(Qd.r(ma)){var bb=[];let Ab=null;for(let ac of this.model.kT())ac!==ma&&(ac.Kf===ma.Kf&&bb.push(ac),ac.id===ma.Kf&&(Ab=ac));Ab&&Ab.id&&Ab.objectId&&!Ab.done&&this.eq.NF(Ab.objectId)&&!this.eq.kGi(Ab.objectId)&&!bb.length&&this.FTc(Ab,!0)}else bb=ma.Rq===jd.a.beingCreated,ma.done||this.FTc(ma,!0),bb&&this.ki.NOi(ma.Ny.draftId)}editComment(ma,bb){1===this.mode&&ma&&(this.ki.UEc(ma,
bb),vi.a.edit===bb.sessionType&&this.TK.logKpiUsage(ie.a.mqh,0),this.wf.ULb&&3!==vi.a.tff(bb.sessionType)?this.nob.selectComment(ma,Object.assign(new Zd.a,{sO:!1,F3:0})):this.wf.mab||this.nob.selectComment(ma,Object.assign(new Zd.a,{sO:!1,F3:0})))}U5d(ma){this.Mz&&!this.sj.pn||super.U5d(ma)}deleteComment(ma){ma.Rq!==jd.a.beingCreated&&this.eq.Nzh(ka.a.Pf(ma.objectId));this.RSa&&this.RSa.id===ma.id&&(this.ki.Js&&this.RSa.id===this.ki.Js.id?this.RSa=null:this.ypa.qXe());!this.ki.Js||this.ki.Js.id!==
ma.id&&this.ki.Js.Kf!==ma.id?this.ki.Js&&this.ypa.rH(0,this.ki.Js,null):void 0===ma.Kf||null===ma.Kf?this.clearSelection():this.ki.selectComment(this.ki.$C(ma.Kf));ma.j7b&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Qd.a(ma));super.deleteComment(ma);a.ULS.sendTraceTag(50426377,327,50,`${Qd.a(ma)} deleted by user action. DurableId: ${ma.HXa}`)}Rwb(ma,bb){super.Rwb(ma,bb);this.Mz&&!this.sj.pn&&bb&&(this.ki.Js&&this.ki.Js.id===ma.id&&this.clearSelection(),
this.g5b&&this.g5b.id===ma.id&&this.ypa.qXe())}qGn(ma=null){(ma=this.eq.Tnl(ma))?this.nob.selectComment(ma,Object.assign(new Zd.a,{sO:!0,F3:1})):this.DXi(1)}PMk(ma){var bb=ma.Qa.node;let Ab=rh.OutlineElementNavigator.Sk(bb);this.Hh.Qd(()=>{const sc=me.GraphIterator.Za(Ab);let Sc=null;do sc.ro()&&(Sc=sc.parentNode?rh.OutlineElementNavigator.Sk(sc.parentNode):null)&&(Ab=Sc,sc.set(Ab));while(Sc)},"ECM:FOOE");if(null===Ab||void 0===Ab?0:Ab.xD)for(var ac of Ab.xD)if(ac&&ac instanceof gh.a){const sc=pk.a.dwh(ac);
this.llc.Ode=this.q9k(bb,ma);ma=this.Vqk(sc);if(bb=this.llc.d9k(sc,ma))sc.dCa[ma].appendChild(bb),ac.lx(bb);break}}q9k(ma,bb){let Ab;for(let ac of ma.xD)if(ac&&ac){Ab=ac;break}ma=bb.Qa.gl;bb=!(null===Ab||void 0===Ab||!Ab.Tm)&&0<Ab.Tm.length;return 0>ma||!bb||null===Ab||void 0===Ab||!Ab.eop?null:vq.a.eZ(ma,Ab,!1,!1)}Vqk(ma){var bb;if(!ma.B2||2>ma.B2.length)return 0;let Ab=0;const ac=null===(bb=this.llc.Ode)||void 0===bb?void 0:bb.y;for(bb=1;bb<ma.B2.length;bb++)if(ac>=ma.B2[bb].y-2)Ab=bb;else break;
return Ab}U0a(){W.App.uNa&&(W.App.Neb=2===this.mode||3===this.mode);1!==this.mode&&this.llc.qLd()}Heo(ma,bb,Ab){const ac=this.Ub.pg;let sc=null;if(bb||Ab){bb=ma.Qa.cpBegin;ma=ma.Qa.node;if(this.aA&&Qd.q(this.aA,ma,this.Mi,bb))return;sc=this.KBl(ma,bb)}sc?!this.Mz||this.sj.pn?Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.vXi(sc)},Cf.a.iGn):this.vXi(sc):!this.ki.Js||ac&&ac.name===Xg.AFrame.CL||this.clearSelection()}KBl(ma,bb){let Ab=null;const ac=this.model.kT();for(let sc=ac.length-1;0<=sc;sc--){const Sc=
ac[sc];if(Sc.objectId&&!(Sc.Kf||this.Mz&&!this.Yaa.isVisible&&Sc.done)&&Qd.q(Sc,ma,this.Mi,bb)){Ab=Sc;break}}return Ab}selectComment(ma,bb=1){this.nob.wXi(ma,Object.assign(new Zd.a,{sO:1===bb,F3:bb}))}zXi(ma,bb){const Ab=this.ki.$C(ma);Ab?this.Mz&&!Qd.r(Ab)&&Ab.Rq!==jd.a.beingCreated&&this.VO.KPa(ma,0,bb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ma=this.model.Js;this.wf.jsa&&this.VH&&ma&&this.VH.fireEvent(9,{comment:ma});super.clearSelection();
this.ypa.rH(1,ma,ma);this.Mz&&ma&&this.VO.sZb()}Slm(){var ma;return 500>(null===(ma=this.U2g)||void 0===ma?void 0:ma.ri)}N$b(ma,bb=1){if(!this.wf.ivi||!this.ki.Ry){var Ab=this.ki.$C(ma),ac=null;Ab||(ac=this.RSa);var sc=this.Slm(),Sc=!1;1===bb&&this.wia&&(sc?Sc=!0:this.wia.highlightComment(ma));ma?Ab?sc?Sc=!0:this.L8.a5b(Ab.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.L8.a5b(null);Ab?sc?Sc=!0:(this.RSa=Ab,this.ypa.rH(2,Ab,ac)):(this.RSa=
null,this.ypa.rH(3,null,ac));Sc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}I4n(){this.me&&(this.U2g=this.me.jg("UserAction","StartScrollDetectionStopwatch"))}notify(ma,bb){this.Ep.sendNotification(ma,bb)}a9f(){this.wYe.onContentChanged()}Zkh(ma,bb){var Ab,ac;switch(ma){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.eq.Yta(bb)===this.wYe.isContentInFilteredContent(bb.id);case "OnContentFilterUpdate":return!(null===(ac=
(Ab=this.wYe).isContentInFilterUpdateDiff)||void 0===ac?0:ac.call(Ab,bb.id));default:return!0}}static getInstance(){return ml.Hl()}static Hl(){ml.Og||(ml.Og=new ml(W.App.Ula(),new P.a(()=>W.App.xa.jb.Xc.Ad),M.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,M.a.instance.resolve("Common.Comments.ICommentModel"),M.a.instance.resolve("Common.Comments.ICommentPane"),Ri.getInstance(),v.AFrameworkApplication.ya,new P.a(()=>kc.a.instance),Be.FocusManager.instance(),M.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
M.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),M.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),M.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings"),M.a.instance.resolve("Common.Utils.IAriaNotifier"),M.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),M.a.instance.resolve("WordEditor.Comments.CommentsState"),M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
Di.App.En.jb.Fc,W.App.xa.lq,M.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),I.a.instance,M.a.instance.$a("WordEditor.HeaderFooter.HeaderFooterControlOwner"),M.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),M.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),M.a.instance.$a("WordEditor.Extension.RichApiEventManager")),ml.Og.CKb=!0);return ml.Og}}ml.Og=null;Object(e.a)(ml,"EditorCommentManager",tg.a,[399,400,401,10]);var co=
c(1672);class Im{constructor(ma,bb,Ab,ac){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ma;this.body=bb;this.confirmButton=Ab;this.cancelButton=ac}}Object(e.a)(Im,"ViewContainerModalDialogStrings",null,[]);var Kn=c(332);c(1438);class jm{constructor(ma,bb){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ma;this.canvasContextId=bb}}Object(e.a)(jm,
"CommentUIAction",null,[]);var Xk=c(1020);class Vf{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng,Sg,qj,wi){this.ga=ma;this.kg=bb;this.le=Ab;this.Ub=ac;this.Ro=sc;this.Dh=Sc;this.pP=Cd;this.xpa=ke;this.rpd=Dd;this.xMe=$d;this.Hb=mf;this.VO=jg;this.wf=ge;this.sj=ng;this.nob=Sg;this.x4=qj;this.tia=wi;this.hle=this.aj=null;this.$0g=this.wvg=!1;this.iuc=null;this.VZn=(Ki,Zi,eh)=>2!==eh||this.sj.cX?1===eh?32:2:(this.x4.Sna("OnCommentInit",Object.assign(new Ck.a,{kDa:()=>{this.ga.processAction(Hf.a.UX,
2)}})),32);this.$8h=(Ki,Zi,eh)=>1!==eh||this.sj.cX?2:8;this.j2j=(Ki,Zi,eh)=>{if(1===eh)return!this.$fb()||this.W$a?8:this.sj.cX?2:32;if(!this.sj.cX)return this.W$a=!0,this.x4.Sna("OnCommentInit",Object.assign(new Ck.a,{kDa:()=>{this.yq||this.sj.pn||this.ga.processAction(Hf.a.UX,2)}})),32;this.yq||this.sj.pn||this.ga.processAction(Hf.a.UX,2);(this.yq||this.sj.pn)&&this.Ub.Kg(this.sj.pn?Xg.AFrame.hr:Xg.AFrame.CL);return 2};this.QTk=(Ki,Zi,eh)=>1===eh&&$b.SessionStatusManager.instance.Tj?8:2;this.mYk=
(Ki,Zi,eh,Zl)=>1!==Zl||(this.yq||this.isVisible)&&this.aj.model.Js?Ki||this.aj.model.Js?32:8:8;this.cfb=(Ki,Zi,eh,Zl,nl)=>{if(1===eh||!this.sj.pn)return 32;if(!this.yq&&2===eh&&(2===this.aj.mode||3===this.aj.mode))return nl=new Im(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.rpd.invokeModalConfirmationDialog(()=>{this.YSm(Ki,Zi,eh,Zl)},()=>{this.bSm()},nl),32;this.sLd();if(this.yq)return 32;
nl&&this.qEh();return 32};this.CIb=(Ki,Zi,eh,Zl,nl)=>{if(1===eh)return 32;nl[Kn.a.On]=this.isVisible;return 32};this.qjc=this.ZIk()}get isVisible(){return this.sj.pn}get W$a(){return this.wvg}set W$a(ma){this.wvg=ma}get gUn(){return"SharedCommentsTaskPaneProps"}get HUc(){return null}get Eui(){return null}get MN(){return this.Ro}get Yaa(){return null}get bCk(){return this.xpa}get yq(){try{return this.wf.yq}catch(ma){return!1}}rVh(){return new Pd(v.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.dataCulture)}ZIk(){const ma=new Wf.a,bb=new jm(Hf.a.newComment,sh.a.frame);bb.preCallback=this.j2j;const Ab=new jm(Hi.a.oEf,sh.a.frame),ac=new jm(Hi.a.sNf,sh.a.frame),sc=new jm(Hi.a.deleteComment,sh.a.frame);sc.preCallback=this.QTk;sc.postCallback=this.mYk;this.yq&&(Ab.preCallback=this.$8h,ac.preCallback=this.$8h);const Sc=new jm(Hf.a.UX,sh.a.frame);Sc.preCallback=this.VZn;ma.Z(6,Sc);ma.Z(0,bb);ma.Z(1,Ab);ma.Z(2,ac);ma.Z(3,sc);return ma}$2i(ma){this.$0g||
(this.QYj=this.UHd(),this.pP.FKa(),this.tTn(),this.pTn(ma),this.$0g=!0)}pTn(ma){this.aj=ma;this.hle=ma.b5b;this.aj.wGh=this.xpa}initialize(ma){this.$2i(ma);this.Vb()}Znf(){this.iuc&&this.Ub.Kg(Xg.AFrame.hr);this.W$a&&!this.yq?(this.ga.processAction(Hf.a.newComment,2),this.W$a=!1):this.sj.lbb&&Bj.a.E1(v.AFrameworkApplication.uc,()=>{const ma=this.sj.lbb.commentId,bb=this.sj.lbb.jPc;this.ga.Xb(Hi.a.selectComment,2,Object.assign(new Zd.a,{commentId:ma,F3:1,sO:!0,BNc:bb}));bb&&(Bj.a.E1(v.AFrameworkApplication.uc,
()=>{this.Ub.Kg(Xg.AFrame.hr)},Cf.a.GYf),zg.a.instance.Xf(zi.a.yyh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-v.AFrameworkApplication.bW);this.sj.lbb=null},Cf.a.hGn)}dispose(){}N3(){}selectComment(){this.isVisible||this.yq||this.r6i();this.Dh.updateCommandUI(!0)}Vb(){this.ga.pa(Hf.a.cfb,sh.a.frame,this.cfb);this.ga.gb(Hf.a.CIb,sh.a.frame,this.CIb,96)}U0a(){-1!==this.aj.mode&&(this.aj.mode||this.qEh())}qEh(){const ma=
this.aj,bb=ma.eq,Ab=bb.eHd(),ac=bb.Lcf(this.wf.jLb&&this.wf.yq&&!this.sj.pn);this.xpa.oHn(ac.length,Ab,!ma.mode,Ab?5:1);this.xpa.KHn(ac,bb.GRa)}tTn(){const ma=this.Ub.re(Xg.AFrame.hr);ma.parent=Xg.AFrame.Qp;ma.XL=!0;ma.cVf=!0;ma.Qhc=!0;ma.uvb((bb,Ab)=>{ue.a.Ykh(Ab.name)&&(this.sj.HGb=Bj.a.E1(this.Hb,()=>{Ab.name!==Xg.AFrame.CL&&2!==this.aj.mode&&3!==this.aj.mode&&(this.aj.clearSelection(),this.Dh.updateCommandUI(!0));this.sj.HGb=null},Cf.a.NSm))});this.Ro.wS(Xg.AFrame.hr);if(this.wf.kwb)for(let bb of Qd.t)ma.bindAction(Pc.KeyInputManager.IF(bb),
Hi.a.fVe)}eMn(){this.iuc&&this.xMe.cel()}Tmh(){this.zFj&&this.eMn()}YSm(ma,bb,Ab,ac){const sc=this.aj,Sc=sc.eq.Ry;Sc&&Sc.Ny?sc.rYe.endCommentSession(Sc.Ny.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.cfb(ma,bb,Ab,ac,!0);Bj.a.E1(this.Hb,()=>{this.Dh.updateCommandUI(!0)},Cf.a.fCn)}bSm(){this.iuc&&this.Ub.Kg(Xg.AFrame.hr);this.Dh.updateCommandUI(!0)}$Da(ma){ma.Er(this.Ub.EV);ma.Er(this.Ub.FV)}XKb(ma,bb,Ab){if(1===Ab)return 32;this.r6i();return 32}r6i(){this.isVisible||
(this.sj.cX?(this.eZk(),this.sj.pn=!0,this.x4.P2d(),this.Ub.ayc(Xg.AFrame.hr),this.yq&&this.wf.jLb&&this.aj.RIb(this.aj.model.qcf(()=>!0)),this.zFj=!0,Qh.UISurfaces.fu().then(ma=>{ma.showTaskPane(Rl.a.Zvd,this.QYj);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.aj.N$b(null),this.Dh.updateCommandUI(!0),this.$Da(this.Ub.re(Xg.AFrame.hr)),this.x4.Sna("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.x4.Sna("OnCommentInit",
Object.assign(new Ck.a,{kDa:()=>{this.sj.pn||this.ga.processAction(Hf.a.UX,2)}})))}eZk(){this.ga.Xb(Hi.a.q$,2,null);this.ga.Xb(Hi.a.WS,2,null)}$fb(){return this.tia.$fb(this.ga,!1)}tvb(){}show(){this.isVisible||this.ga.processAction(Hf.a.UX,2)}editComment(){return 2}sLd(){this.aj.paneClosing();this.sj.pn=!1;if(this.yq&&this.wf.jLb){const bb=this.aj.model;this.aj.RIb(bb.qcf(Ab=>bb.Yta(Ab)))}var ma=Be.FocusManager.instance();ma.pg&&ma.pg.name===Xg.AFrame.hr&&ma.Kg(this.yq&&(2===this.aj.mode||3===this.aj.mode||
this.aj.ek.Js)?Xg.AFrame.CL:ma.NS);this.Ro.Rw(Xg.AFrame.hr);this.Ub.ADc(Xg.AFrame.hr);Qh.UISurfaces.fu().then(bb=>{bb.hideTaskPane(Rl.a.Zvd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.yq&&(ma=this.aj.model.Js)&&this.jko(ma);this.x4.Sna("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}jko(ma){ma.done?this.aj.clearSelection():this.nob.sEh(ma)}t_m(ma=null){this.xMe.t2i(3);this.Znf();if(ma){this.Tmh();ok.a.MRf(ma,
[Mf.a.contextMenu]);const bb=this.Ub.re(Xg.AFrame.hr);this.kg.nyc(Xg.AFrame.hr,ma,bb.Qhc)}}kYm(ma){this.Ro.LG(Xg.AFrame.hr);1!==ma&&Bj.a.E1(v.AFrameworkApplication.uc,()=>{this.Ub.iC(Xg.AFrame.hr)},Cf.a.GYf)}onTaskPaneClose(){this.sj.cX&&this.xMe.t2i(1)}UHd(){const ma={type:this.gUn,wHo:this.Tmh};return Object.assign(new Xk.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ma,hideHeader:!1,width:300,location:2,onOpen:bb=>{this.iuc=bb;this.t_m(bb);this.VO.z6f(!0)},onClose:()=>{this.iuc=
null;this.ga.Xb(Hf.a.cfb,2,!0);this.Dh.updateCommandUI(!0);this.onTaskPaneClose();this.VO.z6f(!1)},onShow:bb=>{this.kYm(bb)}})}UX(){return 32}}Object(e.a)(Vf,"OfficeSharedCommentPane",null,[10,392,393]);var Te=c(1600),Hk=c(142);class El{constructor(ma,bb){this.containerType="full-pane";this.identifier=null;this.ga=ma;this.identifier=bb}openView(){this.ga.processAction(Hf.a.XKb,2)}closeView(){this.ga.Xb(Hf.a.cfb,2,!0)}invokeModalConfirmationDialog(ma,bb,Ab){const ac=new Hk.StandardDialog;Ab&&Ab.title&&
Ab.body&&Ab.confirmButton&&Ab.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),Ab=new Im("","","",""));ac.Gd=1;ac.We(1,Ab.confirmButton);ac.We(0,Ab.cancelButton);ac.Tv(Ab.title,Ab.body,1,sc=>{1===sc?ma():bb()})}}Object(e.a)(El,"ViewContainerAPI",null,[385,386]);class pj{constructor(ma,bb,Ab){this.sco=ma;this.vi=bb;this.jFa=Ab;this.ie=new sa.a;this.sco.execute(ac=>{this.jFa.z3d("OnBeforeTrackChangeMarkupViewChange",(sc,Sc)=>{Sc&&Sc.dEf!==
ac.Vi&&this.ie.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Sc)});this.jFa.z3d("OnAfterTrackChangeMarkupViewChangeEventKey",(sc,Sc)=>{Sc&&Sc.Vi===ac.Vi&&(dd.a.Vi=ac.Vi,this.ie.raiseEvent("OnAfterTrackChangeMarkupViewChange",Sc))})})}Dga(ma,bb){this.ie.addHandler(ma,bb)}Sna(ma,bb){this.ie.raiseEvent(ma,bb)}P2d(){this.vi.rQf||(this.vi.rQf=!0,this.ie.raiseEvent("OnCommentRenderedOnce"))}}Object(e.a)(pj,"WordCommentEventsActor",null,[]);var Sj=c(1729);class Fn{constructor(){this.insertIndex=0;this.author=
this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(Fn,"InitCommentSessionResult",null,[]);class gk extends Fn{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(gk,"BeginDraftingHostResult",Fn,[]);var eo=c(1919),Dg=c(1887),Ml=c(1005);class Mm{constructor(ma,bb,Ab,ac,sc,Sc,Cd,ke,Dd,$d,mf,jg,ge,ng,Sg){this.taskManager=ma;this.xpa=bb;this.owj=Ab;this.qdo=ac;this.BYe=sc;this.ir=Sc;this.Qs=Cd;this.$h=ke;this.E_=Dd;this.wc=$d;this.fj=
mf;this.lZ=jg;this.vi=ge;this.DCk=ng;this.BCk=Sg;this.PTb=this.f5=this.vm=null;this.UAj="WordWebCommitNewCommentActivity";this.VAj="WordWebCommitTaskActivity";this.RAj="WordWebCommentReactionActivity";this.kle=null}get tia(){return this.f5}e$m(ma){var bb;const Ab=this.tia.Ry,ac=this.f5.kT();if(ac&&Ab){const sc=Ml.a.Vcb(null!==(bb=Ab.authorId)&&void 0!==bb?bb:"");bb=new Sj.a(Ab.authorId,Ab.nYb,Ab.author,null!==sc&&void 0!==sc?sc:"",!0);ma.author=bb;ma.insertIndex=Array.indexOf(ac,Ab);ma.authorName=
Ab.author;ma.authorIdentity="";return null}return Bj.a.RC(-2130915320)}initialize(ma,bb,Ab,ac){this.vm=ma;this.f5=bb;this.PTb=Ab;this.kle=ac}beginDraftingAsync(ma){if(!ma)return new Promise((ac,sc)=>{sc(Bj.a.RC(-2130915327))});const bb=new gk,Ab=vi.a.tff(ma.sessionType);return void 0===Ab||null===Ab?new Promise((ac,sc)=>{sc(Bj.a.RC(-2130915317))}):new Promise((ac,sc)=>{Bj.a.E1(this.taskManager,()=>{if(1!==this.vm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.vm.mode),sc(Bj.a.RC(-2130915325));else{this.umh();try{switch(Ab){case 0:if(!this.vm.Yaa.$fb()){sc(Bj.a.RC(-2130915326));return}this.DCk.qLd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ma.draftId}`);this.vm.tvb(ma);break;case 1:if(!ma.threadId||""===ma.threadId){sc(Bj.a.RC(-2130915324));return}if(this.ir.$1f){let ke=this.f5.$C(ma.threadId);if(ke){const Dd=this.f5.CPh(ke,!1),$d=eo.a.sAb(ke,Dd,ke.authorId===this.ir.zX);$d&&this.BYe.invoke(ma.threadId,$d)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.vm.mode)}this.vm.addReply(ma.threadId,ma);break;case 3:if(!ma.threadId||""===ma.threadId){sc(Bj.a.RC(-2130915324));return}var Sc=this.f5.$C(ma.threadId);if(!Sc){sc(Bj.a.RC(-2130915323));return}this.vm.editComment(Sc,ma);break;case 2:if(!ma.commentId||""===ma.commentId){sc(Bj.a.RC(-2130915324));return}let Cd=this.f5.$C(ma.commentId);if(!Cd){sc(Bj.a.RC(-2130915323));return}this.vm.editComment(Cd,ma)}}catch(Cd){sc(Cd);this.VSi();a.ULS.sendTraceTag(553677466,
327,10,`Drafting Exception ${Cd} on Session ${Ab}`);return}(Sc=this.e$m(bb))?sc(Sc):ac(bb);this.VSi()}},Cf.a.beginDraftingAsync)})}commit(ma,bb,Ab){const ac=this.tia.Ry;if(!ac)throw Bj.a.RC(-2130915320);var sc=ac.Ny;if(!sc)throw Bj.a.RC(-2130915320);const Sc=vi.a.tff(sc.sessionType);if(void 0===Sc||null===Sc)throw Bj.a.RC(-2130915317);if(ma!==sc.draftId)throw Bj.a.RC(-2130915327);let Cd=!1,ke=!1;sc=!1;switch(Sc){case 3:if(!Ab)throw Bj.a.RC(-2130915327);break;case 0:this.fj.Qd(()=>{if(!this.vm.Yaa.$fb())throw Bj.a.RC(-2130915326);
ac.text=[bb];this.vm.Mz&&!this.vi.pn?this.vm.d6m(()=>{this.vm.ksa(ac);this.vm.L2k(ma,ac.id)}):this.vm.ksa(ac);ke=Ab&&null!=Ab.Task;Cd=this.vm.Mz;Bj.a.E1(this.taskManager,()=>{this.pkb(ac.id)},Cf.a.pkb)},"WESCA:C:C");break;case 1:this.fj.Qd(()=>{ac.text=[bb];this.vm.ksa(ac);ke=Ab&&null!=Ab.Task;Cd=this.vm.Mz},"WESCA:C:R");break;case 2:this.fj.Qd(()=>{ac.text=[bb];this.vm.nbb(ac);this.qIi(Hi.a.Bym)},"WESCA:C:E");break;default:throw Bj.a.RC(-2130915322);}Ab&&(Ab.Resolve&&(this.UZi(ac,Ab.Resolve.isResolved),
Ab.Resolve.isResolved&&!this.vi.pn&&this.vm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),Ab.Task&&this.vm.cDk(ac,Ab.Task),Ab.Reaction&&(sc=this.ir.JCk,Ab.Reaction.isActive?this.vm.Aqd(ac,Ab.Reaction.reactionType):this.vm.Q3d(ac,Ab.Reaction.reactionType)));this.ir.VCk&&ke&&this.E_.execute(Dd=>Dd.logActivity(this.VAj,"CommentsTasksFpsIsEnabled"));Cd&&this.E_.execute(Dd=>{Dd.logActivity(this.UAj,"CommentsFpsIsEnabled")});sc&&this.E_.execute(Dd=>{Dd.logActivity(this.RAj,"CommentReactionsFpsIsEnabled")});
return ac.id}endCommentSession(ma){const bb=this.tia.Ry;if(bb){if(bb.Ny&&bb.Ny.draftId!==ma)throw Bj.a.RC(-2130915327);if(bb.Rq===jd.a.beingCreated)this.vm.deleteComment(bb),!this.vm.Mz||bb.Kf||this.vi.pn||this.$h.Kg(Xg.AFrame.Wo);else{if(3!==this.vm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}bb.Rq=jd.a.normal;bb.GPa=Dg.a.succeeded;bb.Ny=null;this.vm.WVe()}}this.Qs&&this.Qs.updateCommandUI(!0);this.tia.eHd()||this.xpa.u9f(1,
!this.vm.mode)}deleteComment(ma){(ma=this.f5.$C(ma))?(this.vm.deleteComment(ma),this.vm.Mz&&!this.vi.pn?ma.Kf||this.$h.Kg(Xg.AFrame.Wo):this.$h.iC(Xg.AFrame.hr),this.qdo.m0f(ma)&&this.qIi(Hi.a.Oni)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ma){this.pkb(ma,0)}highlightComment(ma){this.vm.N$b(ma,0)}setThreadResolvedState(ma,bb){(ma=this.f5.$C(ma))&&this.UZi(ma,bb)}UZi(ma,bb){if(ma.Kf&&""!==ma.Kf)throw Bj.a.RC(-2130915321);this.vm.Rwb(ma,bb);bb&&!this.vi.pn&&
this.$h.Kg(Xg.AFrame.Wo)}presentLinkToComment(ma){var bb=this.f5.$C(ma);bb?(bb=this.tia.xFd(bb))?(ma={["nav"]:btoa(`{"${kh.a.comment}":${bb}}`),["mode"]:"copy"},this.BCk.OA(Hi.a.presentLinkToComment),this.wc.Xb(Hf.a.$cb,2,ma)):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ma):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ma)}selectFirstThreadInNextCommentContext(){this.vm.DXi(0)}selectLastThreadInPreviousCommentContext(){this.vm.rGn()}registerForCommentEvents(ma){const bb=
this.tia.Lcf(this.ir.jLb&&this.ir.yq&&!this.vi.pn),Ab=this.tia.GRa,ac=this.tia.eHd(),sc=!this.vm.mode;this.xpa.qQn(this.kle.JIl());this.kle.eBl().then(Sc=>{this.xpa.xon(ma,bb,ac,sc,Ab,Sc);this.xpa.u9f(ac?5:1,sc);this.Qs&&this.Qs.updateCommandUI(!0)})}unregisterForCommentEvents(ma){this.xpa.zhc(ma)}registerForAction(ma,bb){this.owj.cPa(ma,bb)}unregisterForAction(){}checkAtMentionCapability(){return this.PTb?this.PTb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),
new Promise(ma=>{ma(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}umh(){const ma=this.vm.Mz&&!this.vi.pn?Xg.AFrame.CL:Xg.AFrame.hr;if(ma===Xg.AFrame.hr){if(!this.vi.pn)return;Qh.UISurfaces.fu().then(bb=>{bb.setSelectedTaskPane(Rl.a.Zvd);return null})}this.$h.iC(ma)}pkb(ma,bb=1){this.umh();const Ab=this.ir.GZl?1===bb||0===bb:1===bb;this.lZ.wXi(ma,Object.assign(new Zd.a,{F3:bb,sO:Ab}))}VSi(){this.vm.Yaa.W$a&&
(this.vm.Yaa.W$a=!1)}qIi(ma){this.wc.processAction(ma,2)}}Object(e.a)(Mm,"WordEditorSharedCommentAPI",null,[382,383]);class Ln{constructor(ma,bb,Ab,ac,sc,Sc,Cd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ma;this.parentId=bb;this.commentBody=Ab;this.author=ac;this.date=sc;this.commentFlags=Sc;this.usersByReactionType=Cd}}Object(e.a)(Ln,"OfficeSharedCommentModel",null,[]);c(1584);class Pk{constructor(ma,
bb){this.Oa=ma;this.n0a=bb;this.x8g="AD";this.klc=new K.a;this.jMe=new K.a;this.Phk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.Xzg=new ld.a}get userPrincipalName(){return this.Oa.lb("UserPrincipalName")}get R1a(){return this.Oa.lb("PresenceProvider")}get zX(){return this.Oa.lb("PresenceUserId")}get Mi(){return this.n0a.value}wvi(ma){const bb=this.Phk.exec(ma);return bb?bb[1]:ma}y_h(ma,bb=!1){let Ab=0;ma.done&&(Ab=ma.Kf&&""!==ma.Kf?Ab|4:Ab|8);ma.lsh&&(Ab|=2);bb&&(Ab|=1);this.m0f(ma)&&(Ab|=16);ma.Asf&&(Ab|=
32);this.zYl(ma)||(Ab|=128);return Ab}zYl(ma){return ma?(ma=this.Mi.Db(ma.objectId))?ma.hasProperty(ia.a.T5):!1:!1}m0f(ma){if(!ma)return!1;if(void 0===ma.authorId||null===ma.authorId||""===ma.authorId)return this.qyf(ma.id,ma.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.zX||null===this.zX||""===this.zX)return this.qyf(ma.id,ma.objectId,"PresenceUserId null or empty"),!1;if(this.zX==ma.authorId&&ma.nYb==this.R1a)return!1;const bb=this.YBd(ma.authorId),Ab=this.YBd(this.zX);if(this.R1a===
this.x8g&&bb&&Ab&&bb[0]!=this.userPrincipalName&&bb[1]!=Ab[1])return!0;this.qyf(ma.id,ma.objectId,"Unknown");return!1}isCurrentUser(ma){if(!ma||void 0===ma.authorId||null===ma.authorId||""===ma.authorId||void 0===this.zX||null===this.zX||""===this.zX)return!1;if(this.zX==ma.authorId&&ma.nYb==this.R1a)return!0;ma=this.YBd(ma.authorId);const bb=this.YBd(this.zX);return this.R1a===this.x8g&&ma&&bb?ma[0]==this.userPrincipalName||ma[1]==bb[1]:!1}YBd(ma){if(void 0===ma||null===ma)return null;ma=ma.split("::");
return 3===ma.length?ma.slice(1,3):null}qyf(ma,bb,Ab){ma&&!this.Xzg.contains(ma)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${bb}; reason: ${Ab}`),this.Xzg.add(ma))}SLh(ma,bb){var Ab;if(!ma)return null;const ac=ma.yQd;let sc=!1;1===bb&&(sc=!0);bb=ma.author?this.wvi(ma.author):"";const Sc=Ml.a.Vcb(null!==(Ab=ma.authorId)&&void 0!==Ab?Ab:"");Ab=new Sj.a(ma.authorId?ma.authorId:"",ma.nYb,bb,null!==Sc&&void 0!==Sc?Sc:"",this.isCurrentUser(ma));return new Ln(ma.id?ma.id:
"",ma.Kf?ma.Kf:"",ma.text&&ma.text.length?ma.text[0]:null,Ab,ma.date||ac?ma.date:new Date,this.y_h(ma,sc),this.A_h(ma.usersByReactionType))}rgl(ma,bb,Ab){const ac=[],sc=new K.a;if(!ma)return ac;for(let Sc of ma)Sc.Rq!==jd.a.beingCreated&&Ab(Sc)&&(Sc.id&&this.klc.ub(Sc.id)?(ma=this.klc.J(Sc.id),ma=this.eNk(Sc,ma,bb),ac.push(ma),sc.Z(Sc.id,ma)):Sc.id?(ma=this.SLh(Sc,bb),ac.push(ma),sc.Z(Sc.id,ma)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.klc=sc;return ac}$ll(ma,bb,Ab){const ac=
[];for(let sc of ma)sc.Rq!==jd.a.beingCreated&&Ab(sc)&&(sc.id&&this.klc.ub(sc.id)?ac.push(this.klc.J(sc.id)):sc.id&&ac.push(this.SLh(sc,bb)));return ac}eNk(ma,bb,Ab){var ac=ma.yQd,sc=1===Ab;Ab=ma.Kf?ma.Kf:"";const Sc=ma.text&&ma.text.length?ma.text[0]:null,Cd=ma.author?this.wvi(ma.author):"",ke=ma.authorId?ma.authorId:"",Dd=ma.nYb?ma.nYb:"",$d=Ml.a.Vcb(ke);ac=ma.date||ac?ma.date:new Date;sc=this.y_h(ma,sc);const mf=this.isCurrentUser(ma),jg=this.A_h(ma.usersByReactionType);return bb.parentId===Ab&&
bb.commentBody===Sc&&bb.author.DisplayName===Cd&&bb.author.UserId===ke&&bb.author.Provider===Dd&&bb.author.IsCurrentUser===mf&&bb.date===ac&&bb.commentFlags===sc&&this.ugk(bb.usersByReactionType,jg)?bb:(bb=new Sj.a(ke,Dd,Cd,null!==$d&&void 0!==$d?$d:"",mf),new Ln(ma.id,Ab,Sc,bb,ac,sc,jg))}ugk(ma,bb){if(!ma&&!bb)return!0;if(!bb||!ma)return!1;var Ab=Object.keys(ma);if(Ab.length!==Object.keys(bb).length)return!1;for(let ac of Ab){if(!(ac in bb))return!1;Ab=ma[ac];const sc=bb[ac];if(Ab.length!==sc.length)return!1;
for(let Sc=0;Sc<Ab.length;Sc++)if(!this.jgk(Ab[Sc],sc[Sc]))return!1}return!0}jgk(ma,bb){return ma||bb?ma&&bb&&ma.UserId===bb.UserId&&ma.Provider===bb.Provider&&ma.Email===bb.Email&&ma.DisplayName===bb.DisplayName&&ma.IsCurrentUser===bb.IsCurrentUser?!0:!1:!0}A_h(ma){if(!ma)return null;const bb={},Ab=this.Oa.lb("PresenceUserId");for(let sc of Object.keys(ma)){const Sc=[];var ac=ma[sc];for(let Cd of ac){ac=Cd.UserId===Ab;let ke;this.jMe.ub(Cd.UserId)?(ke=this.jMe.J(Cd.UserId),ke.IsCurrentUser=ac):(ke=
new Sj.a(Cd.UserId,Cd.Provider,Cd.DisplayName,Cd.Email,ac),this.jMe.add(Cd.UserId,ke));Sc.push(ke)}bb[sc]=Sc}return bb}}Object(e.a)(Pk,"WordEditorSharedCommentModelTranslator",null,[381]);class Tj{constructor(){this.Ym=null;this.i7c=this.BXg=this.Cwg=this.M3g=this.z6g=this.ZSg=this.CZg=!1}z_h(){this.Ym||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.F1i());return this.Ym}eBl(){return new Promise((ma,bb)=>{this.i7c?ma(this.OVh()):
this.rZi().then(()=>{ma(this.OVh())}).catch(Ab=>{bb(Ab)})})}OVh(){this.i7c||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ma;ma=33;this.Cwg&&(ma|=2);this.CZg&&(ma|=8);this.z6g&&(ma|=16);this.ZSg&&(ma|=4);this.M3g&&(ma|=64);this.BXg&&(ma|=128);return ma}}Object(e.a)(Tj,"OfficeSharedCommentsAppCapabilities",null,[958]);class Ro extends Tj{constructor(ma){super();this.STa=null;this.wf=ma;
this.xRn();this.F1i()}xRn(){this.M3g=this.wf.ULb;this.z6g=!1;this.BXg=this.ZSg=this.CZg=!0}initialize(ma){this.STa=ma;this.rZi()}JIl(){let ma=120;this.wf.ADb&&(ma|=1536);return ma}F1i(){this.Ym={};this.Ym.LivePersonaPicker="true";this.Ym.PersonaColor="true";this.Ym.DiscreteHostedComments=this.wf.IYk.toString();this.Ym.NewCommentButton="true";this.Ym.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.wf.DYk;this.Ym.CommentsFluentUI="true";this.Ym.CommentTasks=this.wf.ULb.toString();this.Ym.CommentTasksFromReply=
this.Ym.CommentTasks;this.Ym.CommentsFluentUIV2="true";this.Ym.CommentFriendlyTimestamps=this.wf.dCk.toString();this.Ym.AtMentionFloodgateSurvey=this.wf.mhk.toString();this.Ym.HyperlinksInComments="true";this.Ym.NewModelState="true";this.Ym.LogDraftCommentIdPair="true";this.Ym.RichTextFormattingInWeb=this.wf.kwb.toString();this.Ym.NoDiscardOnFocusLoss="true";this.Ym.NewResolvedCardDesignInWeb="true";this.Ym.RichContentEditIntegration="true";this.Ym.HyperlinksWithDisplayText="true";this.Ym.SmartReplies=
this.wf.$1f.toString();this.Ym.NewBorderAndFocusLookInWeb="true";this.Ym.LinkToComment="true";this.Ym.TaskPaneWithNewInfrastructure="true";this.Ym.CommentReactions=this.wf.mab.toString();this.Ym.WebThemeIntegration="true";this.Ym.NewSelectionInteractions="true";this.Ym.QuillInitializationTelemetry="true";this.Ym.PersonaIconImageForWeb="true";this.Ym.HighlightsAndFontColorInWebComments=this.wf.ADb.toString();this.Ym.TruncationUIWithReadMoreText="true";this.Ym.CtrlEnterTip="true";this.Ym.AtMentionHintMessage=
"true";this.Ym.LivePersonaCardForWeb=this.wf.yum.toString();this.Ym.TaskHistoryRecordIDs=this.wf.u9n.toString();this.Ym.ContentNavigation=this.wf.contentNavigationApiEnabled.toString()}rZi(){return new Promise((ma,bb)=>{this.STa?this.STa.atMentionsEnabledAsync().then(Ab=>{this.Cwg=Ab;this.i7c=!0;ma(this.i7c)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),bb(Bj.a.RC(-2130915320)))})}}
Object(e.a)(Ro,"WordSharedCommentsAppCapabilities",Tj,[380]);class Qk{constructor(){this._initialized=!1;this.UCk={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:ie.a.d9e,vetoPillar:7};this.B9n={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:Te.a.d9e,vetoPillar:7}}get B1a(){return null!=this.Ppg?this.Ppg:this.Ppg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UV(ma){this.B1a.UV(ki.a.comments,ma,!0)}get name(){return"WordEditor.Comments"}zc(ma){this.W=
ma;this.UV("CPConfigStart");ma.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Bf.a(u.Health.instance,new si.a,this.UCk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ma.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Bf.a(u.Health.instance,new si.a,this.B9n)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();ma.ha("WordEditor.Comments.CommentNodeTracker",()=>new $f(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
ma.ha("WordEditor.Comments.CommentsSettings",()=>new rn(v.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new P.a(()=>W.App.xa.jb.Xc),new P.a(()=>ag.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();ma.ha("WordEditor.Comments.CommentsState",()=>new dd.a).singleInstance();ma.ha("WordEditor.Comments.WordCommentEventsActor",()=>new pj(ma.$a("Box4.TrackChange.ITrackChangeManager"),
ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ma.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Pk(v.AFrameworkApplication.K,new P.a(()=>W.App.xa.jb.Xc.Ad))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();ma.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new cb(ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
ma.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new ni(v.AFrameworkApplication.uc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ma.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Mj(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();ma.ha("WordEditor.Comments.EditorCommentModel",co.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
ma.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new Ne(new P.a(()=>W.App.xa.jb.Xc),new P.a(()=>ag.a.instance),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ma.ha("WordEditor.Comments.ICommentFilterActor",()=>new Cc(ma.resolve("WordEditor.Comments.IEditorCommentModel"),
v.AFrameworkApplication.K,ma.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ma.resolve("WordEditor.Comments.ICommentFilterActor");ma.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Jh(new P.a(()=>W.App.xa.jb.Xc),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"),ma.resolve("Box4.INotebookManager").ml,I.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ma.ha("WordEditor.Comments.CommentHighlightUtils",()=>new hm(ma.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ma.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Rg(ma.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();ma.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new Ql(ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ma.resolve("WordEditor.Comments.CommentHighlightUtils"),v.AFrameworkApplication.ta.U_,v.AFrameworkApplication.ta.eFa,v.AFrameworkApplication.ya,v.AFrameworkApplication.uc,ma.resolve("WordEditor.Comments.CommentsState"),ma.$a("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ma.ha("WordEditor.Comments.CommentHighlightActor",()=>new Th(new P.a(()=>W.App.xa.jb.Xc.Ad),ma.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ma.$a("WordEditor.Comments.IEditorCommentManager"),I.a.instance,ma.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ma.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ma.resolve("WordEditor.Comments.CommentHighlightUtils"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();ma.ha("WordEditor.Comments.CommentHintActor",()=>new Ac(ma.resolve("WordEditor.Comments.CommentsSettings"),uh.a.instance,yh.a.instance,
ll.a.instance,v.AFrameworkApplication.ya,Mi.TableCellReader.Ghm,zh.moveToLastRenderedCellOfTheRow,new de.a,ma.$a("Box4.ContentControlConfigSettings"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.ICommentHighlightActor"),ma.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();
ma.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Nk(uh.a.instance,yh.a.instance,ll.a.instance,v.AFrameworkApplication.ya,ma.resolve("WordEditor.Comments.ICommentHintActor"),ma.$a("Common.IZoomManager"),ma.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance();ma.ha("WordEditor.Comments.ViewContainerAPI",()=>new El(v.AFrameworkApplication.ya,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();ma.ha("Common.Comments.CommentActivationManager",
()=>new dn).as("Common.Comments.ICommentActivationManager").singleInstance();ma.ha("Common.Comments.ViewContainerEventHost",()=>new Gl(v.AFrameworkApplication.uc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ma.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new qe(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();ma.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new Ro(ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.UV("CPConfigEnd")}init(){this.UV("CPInitStart");this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{try{this.Wm(),this.UV("CPInitEnd")}catch(ma){throw a.ULS.CK(524300632,
327,10,ma,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ma),this.B1a.Bv(ki.a.comments,"CPInitException",ma,!0),ma;}})}Wm(){const ma=this.W.resolve("WordEditor.Comments.CommentsSettings");this.UV("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new Vf(v.AFrameworkApplication.ya,v.AFrameworkApplication.ta.jz,v.AFrameworkApplication.ta.oy,v.AFrameworkApplication.ta.fp,v.AFrameworkApplication.ta.ov,W.App.xa,Fj.a.instance,
this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),v.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();
this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new ek(v.AFrameworkApplication.ya,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").qjc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Mm(v.AFrameworkApplication.uc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),ma,W.App.xa,v.AFrameworkApplication.ta.fp,this.W.$a("Common.ISystemInitiatedFeedback"),v.AFrameworkApplication.ya,I.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();
tg.a.factory=ml.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",ml.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new Tc(this.W.resolve("WordEditor.Comments.CommentsState"),ma,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),v.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${kf.AppFrame.SFa} .${cf.a.f0b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),v.AFrameworkApplication.ta.fp)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const bb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),Ab=bb.trackChangeInSidetrackEnabled;Ab&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").wNi(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));
this.W.ha("WordEditor.Comments.FloatingCommentManager",()=>new Od(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),v.AFrameworkApplication.uc,I.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),bb)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",
()=>Ab?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new Rh(v.AFrameworkApplication.ya,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Ri.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
v.AFrameworkApplication.ta.fp,this.W.resolve("WordEditor.Comments.CommentsState"),ma,new P.a(()=>kc.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.$a("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new rd(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Ri.getInstance(),W.App.xa.lq,v.AFrameworkApplication.ya,this.W.resolve("Common.IDynamicScriptLoaderProvider").LD,this.W.$a("WordEditor.Comments.ICommentRibbonCommandHandler"),v.AFrameworkApplication.ta.fp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.$a("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.$a("Common.App.SafeLinks.ISafeLinksManager"),this.W.$a("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),bb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new vh(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.W.resolve("Common.Comments.ICommentPane"),new P.a(()=>W.App.xa.jb.Xc.Ad),v.AFrameworkApplication.ya,
new P.a(()=>kc.a.instance),Be.FocusManager.instance(),I.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ma.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new Ke(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",()=>new sf(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const ac=ma.yq,sc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");
sc&&ac&&(this.W.resolve("WordEditor.Comments.CommentsState").S$a=Qk.gOh(),ma.Byb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Sna("OnCommentInit"));ec.a.bCm();ma.OKc&&W.App.xa.jb.kFh();tg.a.instance&&(ma.Byb||ai.a.get_instance().Gl(4,()=>{this.OSm(ac)},11).continueWith(()=>{this.B4l()}),this._initialized=!0);this.Emn(this.W.$a("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}B4l(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Sna("OnCommentInit")}OSm(ma){ma||
this.rSl()}rSl(){const ma=Qk.gOh();ma&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-v.AFrameworkApplication.bW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Sna("OnCommentInit",Object.assign(new Ck.a,{kDa:()=>{tg.a.instance.Yaa.isVisible||v.AFrameworkApplication.ya.processAction(Hf.a.UX,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").uXi(ma,Object.assign(new Zd.a,{q0f:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").OA(Hf.a.vYe))}Emn(ma,
bb,Ab){ma&&ma.execute(ac=>{ac.w3(new Eb.a(bb,Ab))})}dispose(){this._initialized&&(tg.a.instance&&tg.a.instance.dispose(),this._initialized=!1)}static gOh(){return v.AFrameworkApplication.K.lb("BootActivityNavigationId")}}Object(e.a)(Qk,"PackageManager",null,[1,2]);const Mn=ma=>{const bb=M.a.instance.$a("Box4.IPackageBootPerfLogger"),Ab=window.performance.now();bb.execute(ac=>{ac.Bv(ki.a.comments,"CPMain",Ab,!0)});x.a.instance.Pc(new Qk,0,ma)};var po=c(1819);class ln{isComment(ma){return Hg.a.isComment(ma)}lOd(ma){return Hg.a.lOd(ma)}Ypf(ma){return Hg.a.Ypf(ma)}zGf(ma,
bb){Hg.a.zGf(ma,bb)}DGf(ma,bb){Hg.a.DGf(ma,bb)}F0e(ma){return Hg.a.F0e(ma)}X0a(ma){return ag.a.instance.X0a(ma)}deleteComment(ma,bb){Hg.a.deleteComment(ma,bb)}ezd(ma,bb){Hg.a.ezd(ma,bb)}Pjb(ma){Hg.a.Pjb(ma)}E$(ma,bb,Ab){return Hg.a.E$(ma,bb,Ab)}ota(ma,bb,Ab){return Hg.a.ota(ma,bb,Ab)}Z3b(ma,bb){return Hg.a.Z3b(ma,bb)}MHc(ma,bb,Ab,ac=null){return Hg.a.MHc(ma,bb,Ab,ac)}cXb(ma,bb,Ab,ac){Hg.a.cXb(ma,bb,Ab,ac)}zqd(ma,bb,Ab,ac){return Hg.a.zqd(ma,bb,Ab,ac)}get oDb(){return Hg.a.oDb}set oDb(ma){Hg.a.oDb=
ma}q1a(ma,bb){Hg.a.q1a(ma,bb)}HXc(ma){Hg.a.HXc(ma)}wSf(ma){Hg.a.wSf(ma)}tHd(ma,bb){return Hg.a.tHd(ma,bb)}AGf(ma,bb){Hg.a.AGf(ma,bb)}CGf(ma,bb){Hg.a.CGf(ma,bb)}iXd(ma,bb,Ab,ac,sc,Sc){Hg.a.iXd(ma,bb,Ab,ac,sc,Sc)}y7e(ma,bb){Hg.a.y7e(ma,bb)}CVc(ma,bb,Ab,ac){return Hg.a.CVc(ma,bb,Ab,ac)}GVc(ma,bb,Ab,ac){return Hg.a.GVc(ma,bb,Ab,ac)}}Object(e.a)(ln,"CommentEditorProxy",null,[379]);class Nn{constructor(){this.W=null}get OLb(){return null!=this.jsg?this.jsg:this.jsg=(()=>this.W.$a("WordEditor.ITableEditor"))()}get B1a(){return null!=
this.Qpg?this.Qpg:this.Qpg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UV(ma){this.B1a.UV(ki.a.comments,ma,!0)}get name(){return"WordEditor.CommentsInteractive"}zc(ma){this.W=ma;this.UV("CIPConfigStart");ma.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new ln).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.UV("CIPConfigEnd")}init(){this.UV("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm();this.UV("CIPInitEnd")})}Wm(){this.I_l()}dispose(){}I_l(){Nj.a.dPa(Hg.a.DGf);
po.a.nrd(Hg.a.AGf);po.a.zyc(Hg.a.CGf);po.a.T8j(Hg.a.LSm);this.OLb.execute(bb=>{bb.OPe(Hg.a.q1a)});const ma=W.App.ik.ml;ma.Ve(39).qp(Hg.a.zGf);po.a.c8j(Hg.a.RRm);po.a.U7j(Hg.a.iRm);yi.a.isEnabled&&ma.Ve(12).Zu(Hg.a.Gsj)}}Object(e.a)(Nn,"PackageManager",null,[1,2]);const gi=ma=>{const bb=M.a.instance.$a("Box4.IPackageBootPerfLogger"),Ab=window.performance.now();bb.execute(ac=>{ac.Bv(ki.a.comments,"CIPMain",Ab,!0)});x.a.instance.Pc(new Nn,0,ma)};var wq=c(1918),wm=c(183),Co=c(1599);class en{constructor(ma,
bb,Ab,ac,sc,Sc,Cd){this.kJa=ma;this.A9=bb;this.s5=Ab;this.Yc=ac;this.MGj=sc;this.tAe=Sc;this.Arb=Cd;Co.a.S8j((ke,Dd)=>{this.Z6j(Dd.graphNode,Dd.RBk)});Co.a.t9j((ke,Dd)=>{this.nIk(Dd.graphNode,Dd.Qzk)})}yGd(){var ma=this.MGj();const bb=this.Yc.Ck();bb.set(ma);if(this.A9.ago(bb))return bb;bb.set(ma);wm.PageNavigator.instance.DQ(bb);ma=this.s5.HPk(bb.currentNode);bb.Ei(ma);return bb}GId(ma){const bb=this.yGd();let Ab=null;this.A9.JDd(bb,ac=>{this.s5.Y0h(ac)===ma&&(Ab=ac);return!Ab});return Ab}U0h(ma){const bb=
this.yGd();let Ab=null;this.A9.JDd(bb,ac=>{this.s5.g4b(ac)===ma&&(Ab=ac);return!Ab});return Ab}soi(ma,bb,Ab){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ma,bb,Ab)}Z0h(){const ma=this.yGd(),bb=[];this.A9.JDd(ma,Ab=>{bb.push(this.s5.Y0h(Ab));return!0});return bb}Jbb(ma,bb){if(!bb.length)return this.Arb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const Ab=this.yGd(),ac=fk.a.create().toString(),
sc=new Db.a;for(let Sc of bb)sc.add(Sc),this.soi(Sc.type,ac,Sc.completion);bb=this.kJa.FXf(sc);this.s5.Jbb(Ab.currentNode,ac,ma,bb);this.tAe();return ac}Ye(ma){(ma=this.GId(ma))?(this.s5.Ye(ma),this.tAe()):this.Arb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}g4b(ma){ma=this.GId(ma);return ma?this.s5.g4b(ma):(this.Arb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}V0h(ma){return this.s5.g4b(ma)}X0h(ma){ma=
this.GId(ma);if(!ma)return this.Arb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ma=this.s5.cif(ma);return this.kJa.n0b(ma).toArray()}Jdk(ma,bb){if(!bb.length)return this.Arb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const Ab=this.GId(ma);if(!Ab)return this.Arb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const ac=this.s5.cif(Ab),sc=this.kJa.n0b(ac);
for(let Sc of bb)sc.add(Sc),this.soi(Sc.type,ma,Sc.completion);ma=this.kJa.FXf(sc);ma!==ac&&(this.s5.ZQn(Ab,ma),this.tAe());return!0}Z6j(ma,bb){if(bb=this.U0h(bb)){const Ab=this.Yc.Ck();Ab.set(ma);this.s5.fc(bb.clone(),this.s5.n5k(bb,Ab))}}fMi(ma,bb,Ab){if(bb.ub(ma))return bb.J(ma);const ac=fk.a.create().toString();bb.add(ma,ac);Ab&&this.Arb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return ac}nIk(ma,bb){const Ab=new cg.a;var ac=
this.Yc.Ck();ac.set(ma);ac.Pb(38)&&this.A9.JDd(ac,sc=>{const Sc=this.s5.g4b(sc);void 0!==Sc&&null!==Sc&&Ab.add(Sc,sc);return!0});for(let sc of bb)if(ma=null,({value:ma}=Ab.Bc(sc.key,ma)).returnValue)if(sc.value===sc.key)ma=this.U0h(sc.key),this.s5.LRn(ma,parseInt(sc.key));else{ma=this.s5.cif(ma);if(!ma||""===ma){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ma=this.kJa.n0b(ma);ac=new Va.a;for(let Sc=0;Sc<ma.length;Sc++){if(ma.J(Sc).commentId){const Cd=
Number.parseInvariant(ma.J(Sc).commentId);bb.ub(Cd)?ma.J(Sc).commentId=bb.J(Cd).toString():ma.J(Sc).commentId=null}ma.J(Sc).recordId=this.fMi(ma.J(Sc).recordId,ac,!1);-1===ma.J(Sc).type&&(ma.J(Sc).undoId=this.fMi(ma.J(Sc).undoId,ac,!0))}this.Jbb(sc.value,ma.toArray())}}static nr(){return new en(M.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),M.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new de.a,()=>W.App.xa.jb.Xc,()=>
{M.a.instance.$a("Common.Interface.IEditNotificationManager").execute(ma=>{ma.uAd()})},!0)}}Object(e.a)(en,"TaskActor",null,[389]);var Sl=c(1098);class sn{create(){return new Sl.a}}Object(e.a)(sn,"TaskContentNodeFactory",null,[417]);var Ym=c(1026);class rk{create(){return new Ym.a}}Object(e.a)(rk,"TaskNodeFactory",null,[417]);class Yl{constructor(ma,bb,Ab,ac,sc,Sc){this.A9=ma;this.Hc=bb;this.Yc=Ab;this.LYj=ac;this.OYj=sc;this.xOb=Sc}rOk(ma,bb,Ab){const ac=this.OYj.create(1074135162);ac.setValue(ia.a.taskId,
ma);ac.setValue(ia.a.SLb,bb);ac.setValue(ia.a.wwa,Ab);return ac}i4b(ma){const bb=this.Hc.Rc(4);bb.Eb(ma);this.xOb();return bb}Y0h(ma){return this.A9.uEb(ma)?ma.getValue(ia.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}g4b(ma){return this.A9.uEb(ma)?ma.hasProperty(ia.a.SLb)?ma.getValue(ia.a.SLb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}cif(ma){return this.A9.uEb(ma)?ma.getValue(ia.a.wwa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}HPk(ma){if(7!==ma.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const bb=this.i4b(ma);try{const Ab=this.LYj.create(1074135161),ac=this.Yc.Ck();ac.set(ma);ac.A1(Ab,38,Yl.q9n);return Ab}finally{bb&&bb.dispose()}}Jbb(ma,bb,Ab,ac){if(!this.A9.xuf(ma))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const sc=this.i4b(ma);try{const Sc=this.rOk(bb,Ab,ac),Cd=this.Yc.Ck();Cd.set(ma);Cd.A1(Sc,1,new ka.a(fk.a.Cka(Ab.toString()),1));return Sc}finally{sc&&
sc.dispose()}}Ye(ma){if(this.A9.uEb(ma))if(ma.anchor&&ma.anchor.mr){var bb=ma.anchor.mr.zr.node;if(this.A9.xuf(bb)){var Ab=this.i4b(bb);try{const ac=this.Yc.Ck();ac.set(bb);ac.Ei(ma.anchor.node);ac.Hg()}finally{Ab&&Ab.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}ZQn(ma,bb){if(this.A9.uEb(ma)){var Ab=
this.i4b(ma);try{ma.setValue(ia.a.wwa,bb)}finally{Ab&&Ab.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}LRn(ma,bb){if(this.A9.uEb(ma)){var Ab=this.i4b(ma);try{const ac=ma.hasProperty(ia.a.SLb)?ma.getValue(ia.a.SLb):null;void 0===ac||null===ac||ac===bb?ma.lh(ia.a.SLb,bb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{Ab&&Ab.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}n5k(ma,bb){if(!bb.fq(38)){const Ab=this.Yc.Ck();
Ab.set(ma);Ab.Ab(71);Ab.kd(71);ma=ib.a(Ab.currentNode,ma.Di().Mc,!0);bb.Rf(ma,38)}return bb.Pb(38)}fc(ma,bb){if(this.A9.xuf(bb)){var Ab=this.i4b(bb);try{const ac=this.Yc.Ck();ac.set(bb);ac.Rf(ma,1)}finally{Ab&&Ab.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static nr(){return new Yl(M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new aj.a,new de.a,new sn,new rk,()=>{Di.App.En.jb.Xc.FF.S9(10)})}}Yl.q9n=new ka.a(fk.a.Pf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(Yl,"TaskEditor",null,[384]);class Um{constructor(ma,bb){this.Ax=ma;this.DTb=bb}uEb(ma){return!!ma&&72===ma.type}Qnm(ma){return!!ma&&71===ma.Le}xuf(ma){return!!ma&&71===ma.type}ago(ma){ma.set(this.Ax.value);this.DTb.DQ(ma);return!!ma.Pb(38)}JDd(ma,bb){if(ma&&bb)if(this.Qnm(ma))for(var Ab=!0,ac=ma.Pb(1);Ab&&ac;)this.uEb(ac)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",ac.type),Ab=bb(ac),ac=ma.yf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ma.Le);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static nr(){return new Um(new P.a(()=>W.App.xa.jb.Xc),wm.PageNavigator.instance)}}Object(e.a)(Um,"TaskNavigator",null,[387]);class kj{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}dispose(){}zc(ma){this.W=ma;ma.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new wq.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ma.ha("WordEditor.Tasks.TaskNavigator",()=>Um.nr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ma.ha("WordEditor.Tasks.TaskEditor",()=>Yl.nr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ma.ha("WordEditor.Tasks.TaskActor",()=>en.nr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}Wm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(123)}}Object(e.a)(kj,"TasksPackage",null,[1,2]);var fj=c(67),km=c(1596),cl=c(440),Ig=c(74);class lm{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(lm,"TaskPaneGroupAppProps",null,[]);var Nm=c(140);class xf{static hDk(ma,bb){Be.FocusManager.nJ()&&(yh.a.instance.sza(ma,bb,!1),Nm.a.instance.sza(ma,bb,!1),v.AFrameworkApplication.ta.ov.wS(ma))}}Object(e.a)(xf,"ReactTaskPaneManagerUtils",null,[]);var xj=c(116),mg=c(289);class Vi{constructor(){this.type=
null}}Object(e.a)(Vi,"SampleTaskPaneProps",null,[]);var wl=c(1597);class Wi{constructor(){this.entry=null;this.show=!1}}Object(e.a)(Wi,"AnimationBatchEntry",null,[]);var gl=c(280),pm=c(1114),Zm=c(100);class mm{constructor(){this.oWg=[];this.pWg=[];this.yja={};this.CGa=this.BGa=null;this.Jnd=!1;this.IY=null;this.Fkd=this.sfd=0;this.Ijc=[];this.zve=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Rb.Dgb;this.gw=!1}initialize(){this.Jnd=!1;(this.gw=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Rb.S2)&&
this.t1e()}v1e(ma,bb,Ab,ac){bb=this.IId(bb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.t1e();const sc=document.createElement("div");sc.id=bb;sc.className=mm.Ito;sc.style.width="0";this.zve||(this.W3j(Ab,bb,sc),this.yja[bb]=ma.v1e(bb,Ab,ac,sc));return sc}t1e(){this.Jnd||this.ITn()}W3j(ma,bb,Ab){let ac=null,sc=null;0===ma?(ac=this.BGa,sc=this.oWg):1===ma&&(ac=this.CGa,sc=this.pWg);if(ac){ma=!1;for(let Sc=0;Sc<sc.length;Sc++)if(!ma)sc[Sc]===bb&&(ma=!0);else if(sc[Sc]in this.yja){this.I8l(ac,
Ab,this.yja[sc[Sc]]);return}ac.appendChild(Ab)}}I8l(ma,bb,Ab){ma.insertBefore(bb,Ab.element)}RZk(ma){ma=this.IId(ma);if(ma in this.yja){const bb=this.yja[ma];bb.element.parentNode.removeChild(bb.element);delete this.yja[ma]}}V6i(ma){ma=this.IId(ma);ma in this.yja&&(ma=this.yja[ma])&&!ma.isVisible&&(this.h6i(ma,!0),this.Abh(ma.position,!0,this.nkh(ma,!0)),1===ma.position&&1<L.a.count(this.yja)&&this.CEm())}d_l(ma){ma=this.IId(ma);ma in this.yja&&(ma=this.yja[ma])&&ma.isVisible&&(this.h6i(ma,!1),this.Abh(ma.position,
!1,this.nkh(ma,!1)))}G_b(ma){if(this.IY)return this.IY;const bb=document.createElement("div");document.body.appendChild(bb);bb&&(this.IY=new km.a(bb,ma));return this.IY}h6i(ma,bb){ma.element&&(ma.isVisible=bb,this.Ijc.push(Object.assign(new Wi,{entry:ma,show:bb})));0===ma.position?this.sfd+=bb?1:-1:this.Fkd+=bb?1:-1;1===this.Ijc.length&&window.setTimeout(Object(Ol.a)(this,this.B4n,"startPaneAnimation"),0);this.gw&&ma.element&&ma.element.parentNode&&(0===ma.position&&!this.sfd||1===ma.position&&!this.Fkd?
(ma.element.parentNode.style.minHeight="0px",ma.element.parentNode.style.height="0px",ma.element.parentNode.style.overflow="hidden"):(ma.element.parentNode.style.minHeight="",ma.element.parentNode.style.height="",ma.element.parentNode.style.overflow=""))}B4n(){this.fAi();var ma=vc.where(vc.asEnumerable(this.Ijc),sc=>0===sc.entry.position),bb=vc.where(ma,sc=>!sc.show);if(vc.any(bb)&&vc.Ct(bb)!==vc.Ct(ma)){for(var Ab of bb)Ab.entry.element.style.width="0";ma=vc.where(ma,sc=>sc.show)}bb=vc.where(vc.asEnumerable(this.Ijc),
sc=>1===sc.entry.position);Ab=vc.where(bb,sc=>!sc.show);if(vc.any(Ab)&&vc.Ct(Ab)!==vc.Ct(bb)){for(var ac of Ab)ac.entry.element.style.width="0";bb=vc.where(bb,sc=>sc.show)}for(let sc of vc.concat(ma,bb))ma=sc.entry,Zm.WacAirSpace.uU(ma.element,gl.a.d1f),ac=new pm.a(ma.element),sc.show?ac.VQe(0,ma.width):ac.VQe(ma.width,0),Zm.WacAirSpace.animate(ac,null,null);this.Ijc.length=0}fAi(){}nkh(ma,bb){let Ab=ma.width;ma=0===ma.position?this.sfd:this.Fkd;if(bb&&1===ma||!bb&&!ma)Ab+=1;return Ab}ITn(){this.Jnd||
(this.BGa||(this.BGa=document.createElement("div"),this.BGa.id=mm.Gto,this.BGa.className=mm.Hmj,Sys.UI.DomElement.addCssClass(this.BGa,"alignLeft"),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Rb.Q6&&Sys.UI.DomElement.addCssClass(this.BGa,"FlexBoxLayout"),this.zve&&Sys.UI.DomElement.addCssClass(this.BGa,mm.Fmj),this.A$g(0,this.BGa)),this.CGa||(this.CGa=document.createElement("div"),this.CGa.id=mm.Hto,this.CGa.className=mm.Hmj,Sys.UI.DomElement.addCssClass(this.CGa,"alignRight"),v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Rb.Q6&&Sys.UI.DomElement.addCssClass(this.CGa,"FlexBoxLayout"),this.zve&&Sys.UI.DomElement.addCssClass(this.CGa,mm.Fmj),this.A$g(1,this.CGa)),this.dCi(this.BGa,this.CGa),this.Jnd=!0)}dCi(){}vza(ma,bb){Array.add(1===ma?this.pWg:this.oWg,bb)}IId(ma){return ma+"-Entry"}CEm(){let ma=0;for(const bb of L.a.WN(this.yja)){const Ab=Object(Wa.a)(1023,this.yja[bb]);Ab&&Ab.isVisible&&1===Ab.position&&ma++}2===ma?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ma&&
a.ULS.sendTraceTag(595179605,320,50,ma+" simultaneous panes open")}}mm.Gto="WACTaskPaneContainerLeft";mm.Hto="WACTaskPaneContainerRight";mm.Hmj="WACTaskPaneContainer";mm.Ito="WACTaskPaneEntry";mm.Fmj="WACReactTaskPaneContainer";Object(e.a)(mm,"BaseTaskPaneManager",null,[1024]);var Vm=c(399),Zg=c(313);class sp extends mm{constructor(ma,bb){super();this.qsc=this.psc=this.BMe=this.AMe=0;this.ga=ma;this.UKg=bb}A$g(ma,bb){const Ab=W.App.xa.nC;Ab.parentNode&&(ma?1===ma&&(this.gw?((ma=Object(Zg.a)("FarPane"))&&
ma.appendChild(bb),bb.classList.add("regionComposer"),W.App.xa.Bu.registerBoundingWindowRectsChanged("farPane",(ac,sc)=>{"DP"===sc||3===sc?bb.classList.add("DL"):bb.classList.remove("DL")})):Ab.parentNode.insertBefore(bb,Ab.nextSibling)):this.gw?((ma=Object(Zg.a)("NearPane"))&&ma.appendChild(bb),bb.classList.add("regionComposer")):Ab.parentNode.insertBefore(bb,Ab))}Abh(ma,bb,Ab){this.gw||(bb=bb?Ab:-Ab,ma?this.qsc+=bb:this.psc+=bb)}fAi(){if(!this.gw){var ma=W.App.xa.nC;Zm.WacAirSpace.uU(ma,gl.a.d1f);
if(this.AMe!==this.psc){const bb=new Vm.a(ma);bb.hck(this.AMe,this.psc,this.UKg);Zm.WacAirSpace.animate(bb,null,Object(Ol.a)(this,this.rLh,"forceInteractiveViewRefreshOutline"));this.AMe=this.psc}this.BMe!==this.qsc&&(ma=new Vm.a(ma),ma.ick(this.BMe,this.qsc,this.UKg),Zm.WacAirSpace.animate(ma,null,Object(Ol.a)(this,this.rLh,"forceInteractiveViewRefreshOutline")),this.BMe=this.qsc)}}rLh(){vj.InteractiveViewManager.instance.forEach(ma=>{ma.ODd()})}}Object(e.a)(sp,"TaskPaneManager",mm,[]);var Xi=c(335);
class Gn extends sp{constructor(ma,bb){super(ma,bb);this.EV=Pc.KeyInputManager.lc(fj.a.px,0);this.FV=Pc.KeyInputManager.lc(fj.a.px,4);this.oFe=this.asc=null;this.YPg="AccCheckerTaskPane";this.sa=new sa.a;this.isPaneOpen=!1;this.Jge=this.wpe=null;this.vza(0,"SampleTaskPane");this.vza(0,Xi.a.bdb);this.vza(1,Xi.a.hhk);this.vza(1,"CustomTaskPane");this.vza(1,Xi.a.Uof);this.vza(1,Xg.AFrame.hr);this.vza(1,Xg.AFrame.u8g);this.vza(1,Xg.AFrame.p8g);this.vza(1,Xi.a.WDd);this.vza(1,Xi.a.XDc);this.vza(1,Xi.a.FFc);
this.gLj=(this.hwg=!!v.AFrameworkApplication.ta&&!!v.AFrameworkApplication.ta.Rb)&&v.AFrameworkApplication.ta.Rb.xtf;this.jKj=Di.App.DEb;this.qKj=this.hwg&&v.AFrameworkApplication.ta.Rb.YOc;this.initialize();ma.gb(Hi.a.v1f,Yh.a.application,Gn.v1f,96)}get Xdi(){null==this.Jge&&(this.Jge=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.Jge}get Q4d(){if(!W.App.xa||!W.App.xa.nC)return null;
this.oFe||(this.oFe=new km.a(W.App.xa.nC,Be.FocusManager.instance()));return this.oFe}Vb(){}dCi(ma,bb){const Ab=cl.a.instance,ac=Be.FocusManager.instance(),sc=Ig.EventHandlerManager.instance,Sc=this;Qh.UISurfaces.fu().then(Cd=>{Sc.asc=Sc.G_b(ac);let ke;Cd.renderTaskPaneGroups(ma,bb,(ke=new lm,ke.middleContainer=W.App.xa.nC,ke.onTabStripFocus=()=>{ac.iC(Xi.a.agc)},ke.onOpen=(Dd,$d)=>{Sc.ytf(Dd)&&xf.hDk(Dd,$d);sc.uOe($d,"focus",Sc.RZh(Dd,ac),!0);var mf=Sc.Dfi(Dd),jg=Cd.selectors.getTabbedTaskPaneCount(mf?
1:2);mf=mf?Xi.a.gae:Xi.a.agc;1===jg&&(Ab.Dra(mf),this.isPaneOpen=!0,this.JKi({isPaneOpen:this.isPaneOpen,ogc:$d}));$d=Sc.Gef(Dd);if(jg=ac.re($d))jg.bCc=mf,Sc.ZXn(Dd)&&(jg.Er(Sc.EV),jg.Er(Sc.FV)),Ab.nei($d)&&Ab.Rw($d);this.Xdi&&this.UBd&&this.UBd.tw(!0)},ke.onClose=(Dd,$d)=>{Sc.ytf(Dd);const mf=Sc.Dfi(Dd),jg=mf?Xi.a.gae:Xi.a.agc;Cd.selectors.getTabbedTaskPaneCount(mf?1:2)||(Ab.Rw(jg),this.isPaneOpen=!1,this.JKi({isPaneOpen:this.isPaneOpen,ogc:$d}));sc.zSf($d,"focus",Sc.RZh(Dd,ac),!0);this.Xdi&&this.UBd&&
this.UBd.tw(!0)},ke.setFocusCallback=(Dd,$d)=>{Sc.ytf(Dd)&&$d&&(Dd=ac.re(Sc.Gef(Dd)),Dd.Iyk(),Dd.wda($d))},ke.onOverflowMenuOpen=()=>{if(Sc.asc)Sc.asc.onMenuOpen()},ke.onOverflowMenuClose=()=>{if(Sc.asc)Sc.asc.onMenuClose()},ke.onShow=(Dd,$d)=>{2===$d&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{ac.Kg(Dd)},0)})},ke.onHide=(Dd,$d,mf)=>{mf&&1!==$d&&ac.Kg(ac.NS)},ke.onResizeStart=()=>{if(W.App.xa&&(W.App.xa.nC.className=kf.AppFrame.gag,Sc.Q4d))Sc.Q4d.onMenuOpen()},ke.onResizeEnd=()=>{if(W.App.xa&&
(xj.a.Nhi()||(W.App.xa.nC.className+=" "+W.App.xa.Jlh),Sc.Q4d))Sc.Q4d.onMenuClose()},ke));this.eha(Xi.a.agc,ac,bb,Sc);this.eha(Xi.a.gae,ac,ma,Sc);return null})}eha(ma,bb,Ab,ac){const sc=bb.re(ma);sc.parent=Xg.AFrame.Qp;sc.XL=!0;yh.a.instance.sza(ma,Ab,!1);Nm.a.instance.sza(ma,Ab,!1);ma=new mg.DOMFocusListing(()=>Ab);ma.Rn(3);ma.Rn(2);ma.Rn(4);ma.Rn(1);bb.aka(()=>Ab,sc,ma).$T=!0;sc.Er(ac.EV);sc.Er(ac.FV)}Gef(ma){return ma===this.YPg?Xi.a.C7g:ma}RZh(ma,bb){return()=>{bb.iC(this.Gef(ma))}}ZXn(ma){return ma===
this.YPg?!1:!0}Wem(ma){return ma===Xi.a.bdb}ytf(ma){return this.Wem(ma)||ma===Xi.a.C7g||0<=ma.indexOf("AppForOfficePanel")||ma===Xi.a.WDd||ma===Xi.a.Uof&&this.gLj||ma===Xi.a.XDc&&this.jKj||ma===Xi.a.FFc&&this.qKj||ma===wl.a.Vzb?!0:!1}Dfi(ma){return ma===Xi.a.bdb||"SampleTaskPane"===ma}static BNl(){return new Gn(v.AFrameworkApplication.ya,v.AFrameworkApplication.isRtl)}static v1f(ma,bb,Ab,ac,sc){if(1===Ab)return 32;Qh.UISurfaces.fu().then(Sc=>{Sc.showTaskPane(sc,Object.assign(new Xk.a,{title:"Sample Task Pane",
width:320,location:2,contentProps:Object.assign(new Vi,{type:"SampleTaskPaneProps"})}));return null});return 32}IJa(ma){this.sa.addHandler("onPaneToggle",ma)}hYc(ma){this.sa.removeHandler("onPaneToggle",ma)}JKi(ma){this.sa.raiseEvent("onPaneToggle",ma)}get UBd(){this.wpe||(this.wpe=M.a.instance.Pa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.wpe}}Object(e.a)(Gn,"TaskPaneManager",sp,[388]);class Hl{constructor(){this.rS=null}get name(){return"WordEditor.TaskPaneManager"}zc(){}init(){this.rS=
Gn.BNl();this.rS.Vb();W.App.xa.Rlb=this.rS}dispose(){}}Object(e.a)(Hl,"PackageManager",null,[1,2]);c.d(O,"a",function(){return l})},1819:function(C,O,c){C=c(0);var l=c(23),e=c(2),a=c(721),h=c(170),m=c(70),v=c(56),u=c(5),n=c(46),x=c(16),A=c(8),H=c(44),E=c(77),L=c(438),M=c(20),F=c(442),J=c(6),I=c(594),K=c(207),N=c(68),G=c(227),P=c(21),S=c(1073),W=c(40),X=c(93),Y=c(43),ca=c(766),ha=c(30),ra=c(88),sa=c(22),oa=c(58);class ka{constructor(Pa,Ea,lb,zb){this.nzd=this.lzd=null;this.c1c=Pa;this.sae=Ea;this.f8i=
lb;this.g8i=zb}}Object(C.a)(ka,"TableSimplificationInformation",null,[]);var ia=c(90),La=c(33),va=c(475),Ga=c(254),Oa=c(908),Za=c(1517),ja=c(297),ba=c(3),qa=c(9),Ma=c(107),Ia=c(134),wa=c(19),za=c(270),pa=c(38),Ba=c(287),Ra=c(11),fb=c(645),Va=c(568);class ib extends Sys.EventArgs{constructor(Pa){super();this.yo=Pa}}Object(C.a)(ib,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var Xa=c(1686);class qb extends Xa.a{constructor(Pa,Ea,lb,zb){super(Pa,Ea,{});this.MPa=[];for(Pa=0;Pa<lb.length;Pa++)this.MPa.push(...lb.J(Pa).toArray());
this.kAa=0;this.Yw=zb;this.yo={}}}Object(C.a)(qb,"BasicInternalCopyArguments",Xa.a,[]);class rb extends Sys.EventArgs{constructor(Pa,Ea){super();this.yo=Ea;this.MPa=[];for(Ea=0;Ea<Pa.length;Ea++)this.MPa.push(...Pa.J(Ea).toArray())}}Object(C.a)(rb,"BeforeCopyArguments",Sys.EventArgs,[]);class nb extends Sys.EventArgs{constructor(Pa){super();this.yo=Pa}}Object(C.a)(nb,"BeforePasteArguments",Sys.EventArgs,[]);class Tb extends Sys.EventArgs{constructor(Pa,Ea,lb,zb){super();this.paragraph=Pa;this.cpBegin=
Ea;this.cpEnd=lb;this.yo=zb}}Object(C.a)(Tb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var Zb=c(1727),Hb=c(1728);class Sa{constructor(Pa,Ea,lb,zb,Xb,ub,Pb,yc,bc){this.dgc=Pa;this.source=Ea;this.target=lb;this.gKf=zb;this.rowIndex=Xb;this.eo=ub;this.uWa=Pb;this.jFi=yc;this.ve=bc}}Object(C.a)(Sa,"CoreInternalTablePasteArguments",null,[]);class ua extends Sys.EventArgs{constructor(Pa,Ea,lb,zb,Xb){super();this.operation=Pa;this.ZCi=Ea;this.original=lb;this.clone=zb;this.yo=Xb}}Object(C.a)(ua,"ParagraphCopyPasteArguments",
Sys.EventArgs,[]);c.d(O,"a",function(){return Fa});class Fa{constructor(Pa,Ea,lb,zb,Xb,ub,Pb,yc,bc,Ka,Bb,tb,Kb,Ib,Wa){this.PV=this.Ns=null;this.nAe=!1;this.U8=this.Wxa=null;this.fTb=ub;this.kp=Pb;this.tj=Pa;this.FJe=Ea;this.IJ=lb;this.Kh=zb;this.AG=Xb;this.Oa=yc;this.Hc=Ka;this.kpd=bc.create(2097162);this.HRf(this.kpd);this.roe=bc.create(2097162);this.HRf(this.roe);this.DMe=bc.create(2097162);this.HRf(this.DMe);this.Und=this.kpd;this.oY=Bb;this.s1=tb;this.Jd=Kb;this.Gvc=Ib;this.yVj=Ib.substr(0,3);
this.S4=Wa}get paragraphEditor(){return null!=this.oqg?this.oqg:this.oqg=l.a.instance.resolve("Box4.IParagraphEditor")}get Wb(){return null!=this.skg?this.skg:this.skg=l.a.instance.Pa("Box4.IFeatureHelper")}get Ou(){return this.Ns?this.Ns.Ou:0}get uxb(){return this.Ns.kb.uxb}get Usa(){return this.Ns.kb.Usa}get vha(){return this.Und}get Lbj(){return this.DMe}get GZe(){return this.Ns.JI&&!this.nAe}B2i(){this.nAe=!0}get CCi(){return!this.Ns.JI}get Zoa(){return fb.a.instance}get Yjm(){return this.Oa.$("InternalPasteTableWithReplacingCellIsEnabled")}HRf(Pa){var Ea=
new Oa.a(-1);this.fTb.ml.FJa(Ea);const lb=new J.GraphIterator;lb.set(Ea);e.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");Ea=3;this.Oa&&this.Oa.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(Ea=0);Ea=this.Hc.Rc(Ea);Ea.Qu(lb);lb.Rf(Pa,80);Ea.dispose()}gxd(Pa,Ea=null){Pa=Pa.Cb;this.Ns=Pa.ib.clone();this.nAe=!1;Pa=J.GraphIterator.Za(Pa.W_);const lb=J.GraphIterator.Za(this.vha),zb=this.Hc.Rc(3,ba.a.internalCopy);zb.Qu(lb);
Pa.Pb(82);do Pa.currentNode.cNb(null);while(Pa.xi(82));Pa=new a.a(Ea,Object(H.a)(this,this.fyk,"clearInternalClipboard"),new qb(Pa,lb,this.Ns,zb));Pa.ll("InternalCopy");Pa.fh=!Ea||Ea.fh;Pa.run()}fyk(Pa,Ea){h.a.mark(5566);Ea=Ea.target;if(Ea.Ud())return Ea.Hg(),!0;Pa.ui(Object(H.a)(this,this.OFc,"executeCopy"));return!0}OFc(Pa,Ea){Ea=new Zb.a(Ea,null);const lb=new a.a(Pa,Object(H.a)(this,this.zCc,"coreCopySetup"),Ea);lb.ll("ExecuteCoreCopyToInternalClipboard");this.Uan(Ea);lb.run();Pa.ui(Object(H.a)(this,
this.Xdo,"trimNewText"));return!0}zCc(Pa,Ea){if(!Ea.source.Ud())return Ea.Pi&&(Ea.Pi.Mud=null),A.ULS.shipAssertTag(6305560,307,!1),!1;Pa.ui(Object(H.a)(this,this.Eth,"coreCopyIteration"));return!0}Eth(Pa,Ea){const lb=Ea.insertAfter,zb=Ea.source,Xb=Ea.target,ub=zb.currentNode;var Pb=this.CCi;if(!ub.xfa)return Pa.ui(Object(H.a)(this,this.yCc,"coreCopyIncrement")),!0;Ea.Pi.GKb&&(Ea.GKb=!0);if(!this.Pvk(Ea))return Ea.Jha.pCa.c++,Pa.ui(Object(H.a)(this,this.yCc,"coreCopyIncrement")),!0;if(!Ea.GKb&&(ub.s1b()&&
Ea.Jha.pCa.c++,ub.s1b()||Pb&&!ub.zgb(this.Ou)))return Pa.ui(Object(H.a)(this,this.yCc,"coreCopyIncrement")),!0;if(!Ea.GKb&&Pb&&!ub.gz)return zb.EA()&&(Ea.Cde=!0,Ea=new a.a(Pa,Object(H.a)(this,this.zCc,"coreCopySetup"),new Zb.a(Ea,lb)),Ea.ll("RecursiveCoreCopyToInternalClipboard"),Ea.run()),Pa.ui(Object(H.a)(this,this.yCc,"coreCopyIncrement")),!0;Pb=Xb.currentNode.Di().Ad;Pb=I.a(ub,Pb,!0);Pb.v6b=!0;this.Zoa.l3d(Ea.Jha.OBb,Pb);Xb.eH(Pb,lb,18===zb.parentNode.type?1:zb.role);Xb.Ei(Pb);Ea.insertAfter=
Pb;Ra.ParagraphReader.nc(Pb)&&(this.hbn(Pa,Object(H.a)(this,this.zCc,"coreCopySetup"),ub,Pb,Ea),this.gbn(Pa,ub,Pb));this.XFh(ub,Pb);zb.EA()&&(A.ULS.shipAssertTag(6305562,307,!Ea.Cde),Ea=new a.a(Pa,Object(H.a)(this,this.zCc,"coreCopySetup"),new Zb.a(Ea,null)),Ea.ll("RecursiveCoreCopyToInternalClipboard"),Ea.run());Pa.ui(Object(H.a)(this,this.pIk,"coreCopyIterationPostProcessing"));return!0}pIk(Pa,Ea){var lb=Ea.source;const zb=Ea.target;var Xb=zb.currentNode,ub=lb.currentNode;Ra.ParagraphReader.yh(zb)&&
(Ea.SKf[ub.id.toString()]=Xb);if(Ra.ParagraphReader.nc(Xb)){if(0<Ra.ParagraphReader.t0h(ub))if(0<this.kp.zF(ub).mt)ub.setValue(u.a.DOa,0);else{const Pb=this.kp.r2(ub).mt;this.paragraphEditor.xp.uba(Xb,Pb)}if(!this.uNc&&this.S4.kFi){lb.mc();if(!pa.TableReader.Pv(zb)&&lb.JCa&&!this.Usa)for(const Pb of this.S4.UKf)Xb.removeProperty(Pb);lb.Ei(ub)}}if(M.a.instance.J(6)&&Ra.ParagraphReader.nc(Xb)){for(ub=0;ub<Xb.wordRunProperties.length;ub++)Xb.wordRunProperties.Iq.Z(ub,Ba.CharacterPropertiesEditor.GQ),
Xb.wordRunProperties.gt.Z(ub,Ba.CharacterPropertiesEditor.cU);A.ULS.shipAssertTag(6305564,307,M.a.instance.J(4));A.ULS.shipAssertTag(6305565,307,!!qa.App.vd);(this.Jd.og||M.a.instance.J(3)&&qa.App.Ev.Xgc)&&Xb.setValue(u.a.NDb,!0);Xb.Vg(u.a.Dzb,u.a.tEi,u.a.MKf);M.a.instance.J(3)&&Ra.ParagraphReader.nc(Xb)&&Xb.Vg(u.a.hNa)}this.CCi&&(this.WFh(zb),pa.TableReader.isTable(zb)&&(Xb=this.Ns.BN(),Xb.moveNext(),(Xb=ha.TableCellReader.kBa(lb,Xb.current.node))||(Xb=new ca.a(0,0)),lb=new ka(Xb,zb,pa.TableReader.Jea(lb),
pa.TableReader.Mhf(lb)),this.FJe.value.pzn(lb)));Y.OutlineElementReader.Nh(zb)&&!zb.fq(2)&&(this.Kh.zN(zb),zb.mc());zb.mc();Ea.Pi&&(Ea.Pi.Mud=Ea.insertAfter);Pa.ui(Object(H.a)(this,this.yCc,"coreCopyIncrement"));return!0}yCc(Pa,Ea){Ea.Cde&&(Ea.insertAfter=Ea.Mud,Ea.Cde=!1);if(!Ea.source.Ht()){Ea.Pi&&(Ea.Pi.Mud=Ea.insertAfter);const lb=Ea.source;11!==lb.Le||lb.YIc(-1)||this.Lbn(Pa,lb.currentNode,Ea.target.currentNode,Ea);return!1}Pa.ui(Object(H.a)(this,this.Eth,"coreCopyIteration"));return!0}Pvk(Pa){const Ea=
Pa.source;if(Y.OutlineElementReader.Nh(Ea)&&Ea.Peb(12)){const lb=Ea.Ud();if(Ra.ParagraphReader.nc(lb)&&lb.ia(u.a.AM,null))return Ea.mc(),Pa.GKb=!1;Ea.mc()}else if(Ra.ParagraphReader.nc(Ea.Gn)&&Ea.Gn.ia(u.a.AM,null))return!1;return!0}gbn(Pa,Ea,lb){Ea=ia.e(Ea);lb=ia.e(lb);for(let zb=0;zb<Ea.length;zb++)Ea[zb].dGf(lb[zb],Pa,Object(H.a)(this,this.zCc,"coreCopySetup"))}Xdo(Pa,Ea){if(Ea.kAa>=Ea.MPa.length)return Fa.sa.raiseEvent("AfterTrimCompleteOnCopy",new ib(Ea.yo)),Pa.ui(Object(H.a)(this,this.oIk,"copyTeardown")),
!0;Pa=Ea.MPa[Ea.kAa];var lb=Pa.node,zb=Pa.cpBegin;let Xb=Pa.cpEnd;if(!wa.SelectionEditor.ju(Pa))if(!Ea.kAa&&wa.SelectionEditor.qk(Pa))Xb=zb=Ra.ParagraphReader.textLength(lb);else if(Ra.ParagraphReader.em(Pa))zb=0,Xb=Ra.ParagraphReader.textLength(lb);else if(wa.SelectionEditor.eaa(Pa)){A.ULS.shipAssertTag(6305568,307,!Ea.kAa);var ub=J.GraphIterator.Za(lb);zb=ub.Ab(12);A.ULS.shipAssertTag(6305569,307,zb);lb=ub.origin;Xb=zb=Ra.ParagraphReader.textLength(lb)}else{if(X.OutlineReader.XPd(Pa))for(Pa=K.a.Zp(Pa.node);Pa.moveNext();)ub=
Pa.currentNode,Ra.ParagraphReader.nc(ub)&&Ea.MPa.push(La.a.createTextRange(ub,0,Ra.ParagraphReader.textLength(ub)));Ea.kAa++;return!0}ub=Ea.SKf[lb.id.toString()];A.ULS.shipAssertTag(6305570,307,!!ub);if(!ub)return A.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Ea.kAa,["SelectedContextsLength"]:Ea.MPa.length,["SelectedNodeType"]:lb.type,["ContextId"]:Pa.contextId}),Ea.kAa++,!0;lb=ia.e(ub);let Pb,yc=!1;for(Pb=lb.length-1;0<=Pb;Pb--)if(!lb[Pb].Rza)if(4===lb[Pb].li)lb[Pb].Ob.blob=
null,lb[Pb].Ob.blob=new va.a(lb[Pb].Ob),Ea.Jha.pCa.e++;else{lb[Pb].Ob.blob=null;if(M.a.instance.J(6)&&-1!==lb[Pb].Ge){var bc=lb[Pb].Ob.formatting,Ka=void 0,Bb=void 0;bc&&-1===bc.Ge?(Bb=lb[Pb].Ge+1,Ka=lb[Pb].g3-1,bc.Ge=lb[Pb].Ge):(Ka=lb[Pb].g3,Bb=lb[Pb].Ge);for(bc=0;bc<Ka;bc++)ub.wordRunProperties.removeAt(Bb,16);0<Ka&&(yc=!0)}Ka="";ja.f(lb[Pb])?(Ka=" ",Ea.Jha.pCa.f++):ja.g(lb[Pb])&&(Bb=ja.b(lb[Pb]))&&(Ka=ja.a(Bb),Ea.Jha.pCa.g++);Bb=lb[Pb].Ob.cp;Bb>=zb&&Bb<Xb&&(Fa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(ub,
Bb,Bb+1),Ka,void 0,void 0,void 0,void 0,!0),Xb=Xb-1+Ka.length,Ea.Jha.pCa.i++)}yc&&ub.yn();this.Ssn(ub);Fa.sa.raiseEvent("BeforeTrimOnCopy",new Tb(ub,zb,Xb,Ea.yo));lb=Ra.ParagraphReader.textLength(ub);Xb<lb&&Fa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(ub,Xb,lb),"",void 0,void 0,void 0,void 0,!0);0<zb&&Fa.characterPropertiesEditor.replaceTextRange(La.a.createTextRange(ub,0,zb),"",void 0,void 0,void 0,void 0,!0);this.DTl(ub,Ea.Jha.pCa);Ra.ParagraphReader.textLength(ub)||Ea.kAa!==
Ea.MPa.length-1||!wa.SelectionEditor.ju(Pa)||Ma.a.ACa&&ub.yw||(Pa=J.GraphIterator.Za(ub),Pa.Ab(25)&&(W.OutlineElementNavigator.Xd(Pa),this.Kh.yXa(Pa),Ea.kAa&&(this.Ns.kb.Usa=!0)));this.Wb.isFeatureEnabled(92)&&Ea.kAa==Ea.MPa.length-1&&!this.Usa&&ub.Vg(n.a.s3,n.a.aba,n.a.Ana,n.a.rva,n.a.q7);this.Zoa.hXc(Ea.Jha.y_d,Ea.Jha.Ywb,Ea.Jha.Bab,ub);Ea.kAa++;return!0}Ssn(Pa){const Ea=Pa.qa;if(M.a.instance.J(6)&&Ea){var lb=new E.a,zb=new E.a;for(let Xb=0;Xb<Ea.length;Xb++){const ub=Ea.J(Xb);ub.oj&&lb.add(ub);
if(!Ma.a.ACa&&ub.Jb){for(let Pb=0;Pb<ub.Jb.length;Pb++)zb.add(ub.Jb.J(Pb).Ge);ub.Jb=null}}Pa.Hga(!0,zb);for(const Xb of lb)Xb.oj=null}}oIk(Pa,Ea){this.vha.cNb(null);Ea.Yw.dispose();h.a.mark(5567);this.pOm();this.PV=Ea.Jha;this.Fni("Copy");this.Jbm&&A.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get Jbm(){return!J.GraphIterator.Za(this.vha).Ud()}ilj(){this.Und=this.DMe}hlj(){this.Und=this.kpd}Eqo(){this.Und=this.roe}get Kom(){return this.vha===this.kpd}get Udm(){return this.vha===
this.roe}moh(){const Pa=J.GraphIterator.Za(this.vha);for(;Pa.Ud();)Pa.Hg()}Fni(Pa){const Ea=this.PV.pCa.b;Pa+="-"+Ea;this.PV.pCa.b=Pa;this.PV.OBb.b=Pa;this.PV.y_d.b=Pa;this.PV.Ywb.b=Pa;this.PV.Bab.b=Pa;this.Zoa.yAm(this.PV.pCa);this.Zoa.ayf(this.PV.OBb);this.Zoa.Doi(this.PV.y_d);this.Zoa.Pxf(this.PV.Ywb);this.Zoa.Nxf(this.PV.Bab);this.PV.pCa.b=Ea;this.PV.OBb.b=Ea;this.PV.y_d.b=Ea;this.PV.Ywb.b=Ea;this.PV.Bab.b=Ea}gFi(Pa,Ea,lb,zb,Xb=null,ub=null){this.Fni("Paste");Ea=J.GraphIterator.Za(Ea);const Pb=
J.GraphIterator.Za(this.vha);var yc=null;Xb&&(yc=new F.a(X.OutlineReader.Pyh,X.OutlineReader.oTk),yc=Xb.equals(new F.a(-1,-1))?new F.a(0,0):Xb.J$d(yc));if(this.kai())if(Pb.Ud(),P.ImageReader.Ov(Pb.currentNode))Xb=Pb.currentNode,Pb.mc(),Pb.eH(this.Kh.Uxb(),null,1),Pb.Ud(),Pb.eH(Xb,null,2),Pb.mc(),Pb.Ei(Xb),Pb.Hg(),this.B2i();else if(G.isFloatingEmbeddedFileNode(Pb.currentNode)){Xb=Pb.currentNode;Pb.mc();Pb.eH(this.Kh.Uxb(),null,1);Pb.Ud();var bc=this.Kh.zN(Pb);bc=La.a.Uc(bc,0);Fa.characterPropertiesEditor.replaceTextRange(bc,
"<<"+G.getEmbeddedFileName(Xb)+">>",void 0,void 0,void 0,void 0,!0);Pb.mc();Pb.mc();Pb.Ei(Xb);Pb.Hg();this.B2i()}this.oY&&this.oY.$sf(lb)||!this.Yjm||!this.Hji(Pb,Ea)?(h.a.mark(5564),Pb.currentNode.cNb(null),Pa={},Pa[Fa.Umf]=zb,N.ListReader.M2(lb)&&(Pa[S.a.qai]=!0),lb=new Hb.a(Pb,Ea,lb,yc,Pa),zb=new a.a(ub,Object(H.a)(this,this.BCc,"corePasteSetup"),lb),zb.ll("ExecuteCorePasteFromInternalClipboard"),zb.fh=!ub||ub.fh,this.Van(lb),zb.run()):(Pb.currentNode.cNb(null),A.ULS.sendTraceTag(7869376,307,50,
"Begin internal paste table in table"),this.Uwn(ub,Pb,Ea,yc,Pa),A.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}hji(Pa){if(Pa&&Pa.Sd){const Ea=J.GraphIterator.Za(this.vha);return this.Hji(Ea,Pa)}return!1}Hji(Pa,Ea){if(ha.TableCellReader.Mma(Ea)&&1===Pa.Mp()){Pa.Pb(1);if(Y.OutlineElementReader.Nh(Pa)){W.OutlineElementNavigator.Fe(Pa);if(pa.TableReader.isTable(Pa)){pa.TableReader.LA(Pa.currentNode)&&A.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");
if(Ea.Ab(14)&&!pa.TableReader.LA(sa.getContainingTable(Ea))){if(A.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.U6)return!0}else if(A.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.uNc&&!this.U6)return!0;if(this.U6)return!0}W.OutlineElementNavigator.Xd(Pa)}Pa.mc()}return!1}Uwn(Pa,Ea,lb,zb,Xb){let ub,Pb;let yc;Object(v.a)("ReplaceTableCellsFromClipboardTable",!0);lb.Ab(14);ub=oa.a.Rr(lb);Pb=ra.a(lb);lb.kd(14);var bc=pa.TableReader.$f(lb.currentNode);
yc=pa.TableReader.Yg(lb.currentNode);const Ka=pa.TableReader.$f(Ea.currentNode),Bb=pa.TableReader.Yg(Ea.currentNode);A.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",bc,yc,Ka,Bb,ub,Pb);if(this.U6&&za.TableBorderSelectionCache.lKc())this.KRn(),bc=Math.min(this.Fae+1,bc),yc=Math.min(this.$4f+1,yc),this.$4f-this.o9n==yc-1&&(this.Waj==this.Fae?Pb=0:this.Fae-this.Waj==bc-1&&(lb.Ud(),ub=oa.a.Rr(lb),Pb=ra.a(lb)));
else{this.Wxa=Va.a.t3b;const tb=ub+Ka-bc;0<tb&&(sa.moveToLastRow(lb),A.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+tb),this.FJe.value.insertRows(lb,!1,tb,this.Wxa),A.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),lb.kd(14));const Kb=Pb+Bb-yc;if(0<Kb){A.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Kb);try{this.FJe.value.insertColumns(lb,yc,!1,Kb,this.Wxa)}catch(Ib){throw A.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Ib.toString()),Ib;}A.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}(0<tb||0<Kb)&&Object(v.a)("InsertRowsAndColumnsForInternalCCP",!0)}bc=this.Lml(bc,yc,Ka,Bb,ub,Pb);A.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Pa=new a.a(Pa,Object(H.a)(this,this.T5m,"pasteTableOperationRun"),new Sa(null,Ea,lb,zb,ub,Pb,bc,null,Xb));Pa.ll("ExecuteCorePasteTableInTable");Pa.fh=!1;Pa.run()}T5m(Pa,Ea){if(Ea.dgc){if(Ea.dgc.inProgress)return!0;ha.TableCellReader.isTableCell(Ea.source)||Ea.source.kd(16);if(this.cMm(Ea))return!1}else pa.TableReader.isTable(Ea.target)||
Ea.target.kd(14),pa.TableReader.isTable(Ea.source)||Ea.source.kd(14),sa.moveToCell(Ea.target,Ea.rowIndex,Ea.eo),sa.moveToCell(Ea.source,0,0);if(ha.TableCellReader.gg(Ea.source)||ha.TableCellReader.gg(Ea.target))return!0;this.H5m(Ea,Pa);return!0}pOm(){if(this.uNc){for(var Pa=J.GraphIterator.Za(this.vha),Ea=Pa.currentNode;14!==Pa.Le;)if(Ea=Pa.Ud(),!Ea){A.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.Bvi(Ea)}}tOm(Pa){this.uNc&&
this.Bvi(Pa)}Tao(Pa){const Ea=J.GraphIterator.Za(Pa);this.IJ.Gfb(Ea,null,!0);Pa.gg=!1;Pa.rowSpan=1;Pa.colSpan=1}Bvi(Pa){if(Pa&&14===Pa.type){A.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Ea={},lb=pa.TableReader.$f(Pa),zb=pa.TableReader.Yg(Pa),Xb=J.GraphIterator.Za(Pa);sa.forEachCellInTable(Xb,(ub,Pb,yc)=>{const bc={};ub=ub.currentNode;if(16===ub.type)if(ub.gg)Fa.frh(Pb,yc)in Ea||(this.Tao(ub),bc.IsGhostCell="->false");else{Fa.Vln(Pa,ub,Pb,yc,lb,(Bb,tb,Kb)=>{bc.rowSpan=
String.format("{0}:{1}->{2}",Bb,tb,Kb)});Fa.Uln(Pa,ub,yc,Pb,zb,(Bb,tb,Kb)=>{bc.colSpan=String.format("{0}:{1}->{2}",Bb,tb,Kb)});const Ka=String.format("{0},{1}-{2},{3}",Pb,yc,Pb+ub.rowSpan,yc+ub.colSpan);for(let Bb=0;Bb<ub.rowSpan;Bb++)for(let tb=0;tb<ub.colSpan;tb++)if(Bb||tb)Ea[Fa.frh(Pb+Bb,yc+tb)]=Ka}if(0<L.a(bc).length){if(void 0===bc.IsGhostCell||null===bc.IsGhostCell){if(void 0===bc.rowSpan||null===bc.rowSpan)bc.rowSpan=ub.rowSpan;if(void 0===bc.colSpan||null===bc.colSpan)bc.colSpan=ub.colSpan}A.ULS.sendTraceTag(39175904,
307,50,"NormalizeTable: [{0},{1}]: {2}.",Pb,yc,bc)}return!0});Fa.j1k(Ea)}}DTl(Pa,Ea){if(Pa&&Ra.ParagraphReader.nc(Pa)){var lb=0,zb=J.GraphIterator.Za(Pa);for(zb.Pb(6);!zb.qr;){var Xb=zb.currentNode;zb.xi(6);P.ImageReader.Ov(Xb)?P.ImageReader.Etf(Xb)?J.GraphIterator.Za(Xb).Peb(59)?A.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.g_e(Xb,La.a.Uc(Pa,lb),!0),Ea.d++,lb++):(Xb=J.GraphIterator.Za(Xb),Xb.Ab(12),Xb.Hg(),
Ea.h++):A.ULS.shipAssertTag(6305571,307,!1)}}}get uNc(){return!!this.Oa&&this.Oa.$("ComplexTableCellPasteWithFormattingIsEnabled")}Lml(Pa,Ea,lb,zb,Xb,ub){const Pb=[];let yc,bc,Ka,Bb;this.U6&&za.TableBorderSelectionCache.lKc()?(yc=Math.min(Pa,Xb+lb),bc=Math.min(Ea,ub+zb),Bb=Xb):(Bb=0,yc=Math.max(Xb+lb,Pa));for(;Bb<yc;Bb++)for(this.U6&&za.TableBorderSelectionCache.lKc()?Ka=ub:(Ka=0,bc=ub+zb,Bb<Xb?Ka=Ea:Bb>=Xb&&Bb<Math.min(Xb+lb,Pa)?Ka=ub:Bb>=Xb+lb&&Bb<Pa?Ka=Ea:bc=Math.max(ub+zb,Ea));Ka<bc;Ka++)Pb.push(Array(2)),
Pb[Pb.length-1][0]=Bb,Pb[Pb.length-1][1]=Ka;return Pb}BCc(Pa,Ea){if(!Ea.source.Ud())return Pa.ui(Object(H.a)(this,this.hjb,"pasteTeardown")),!0;Pa.ui(Object(H.a)(this,this.Gth,"corePasteIteration"));return!0}fxn(Pa,Ea){if(this.uNc)if(!Ea||!Pa)A.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Pa,["table"]:Ea});else if(16===Ea.currentNode.type&&16===Pa.parentNode.type){Ea=Ea.currentNode;Pa=Pa.parentNode;var lb={};Ea.gg!==Pa.gg&&(Ea.gg=Pa.gg,lb.IsGhostCell=Ea.gg);Ea.U2!==
Pa.U2&&(Ea.U2=Pa.U2,lb.IsSkippedCell=Ea.U2);Ea.blb!==Pa.blb&&(Ea.blb=Pa.blb,lb.ShouldRenderCell=Ea.blb);Ea.colSpan!==Pa.colSpan&&(lb.ColSpan=String.format("{0}<={1}.",Ea.colSpan,Pa.colSpan),Ea.colSpan=Pa.colSpan);Ea.rowSpan!==Pa.rowSpan&&(lb.RowSpan=String.format("{0}<={1}.",Ea.rowSpan,Pa.rowSpan),Ea.rowSpan=Pa.rowSpan);L.a(lb)}}Gth(Pa,Ea){const lb=Ea.source,zb=Ea.target,Xb=lb.currentNode;if(!Xb.xfa||!Xb.XJa||this.GXn(lb,zb))return Pa.ui(Object(H.a)(this,this.ACc,"corePasteIncrement")),!0;if(M.a.instance.J(3)&&
Y.OutlineElementReader.Nh(lb)){if(!W.OutlineElementNavigator.Fe(lb).XJa)return W.OutlineElementNavigator.Xd(lb),Pa.ui(Object(H.a)(this,this.ACc,"corePasteIncrement")),!0;W.OutlineElementNavigator.Xd(lb)}A.ULS.shipAssertTag(6305608,307,!Xb.s1b());var ub=zb.currentNode.Di().Ad;ub=I.a(Xb,ub,!0);ub.oOa();ub.fQd=!0;this.fxn(lb,zb);zb.eH(ub,Ea.insertAfter,lb.role);zb.Ei(ub);Ea.insertAfter=ub;M.a.instance.J(4)&&qa.App.vd.Pp&&qa.App.vd.Mq.KG(ub);this.XFh(Xb,ub);Ea=new a.a(Pa,Object(H.a)(this,this.BCc,"corePasteSetup"),
new Hb.a(lb,zb,null,Ea.gKf,Ea.yo));Ea.ll("RecursiveCorePasteOperation");Ea.run();Pa.ui(Object(H.a)(this,this.tIk,"corePasteIterationPostProcessing"));return!0}GXn(Pa,Ea){let lb=!1;Y.OutlineElementReader.Nh(Pa)&&(lb=Y.OutlineElementReader.EP(Pa)&&this.Pnm(Ea));return lb}Pnm(Pa){if(Pa)return Pa=Pa.Le,36===Pa||38===Pa||16===Pa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}Ubn(Pa,Ea,lb){Ea=ia.e(Ea);const zb=ia.e(lb);for(let Xb=Ea.length-1;0<=Xb;Xb--){if(!Ea[Xb].Qec(lb)){const ub=
La.a.createTextRange(lb,Ea[Xb].Ob.cp,Ea[Xb].Ob.cp+1);Fa.characterPropertiesEditor.replaceTextRange(ub,"",void 0,void 0,void 0,void 0,!0)}Ea[Xb].qTc(zb[Xb],Pa,Object(H.a)(this,this.BCc,"corePasteSetup"),this.Udm)}}tIk(Pa,Ea){const lb=Ea.target,zb=lb.currentNode,Xb=Ea.source,ub=Xb.currentNode;let Pb=-1;Ea.yo[Fa.Umf]&&(Pb=Ea.yo[Fa.Umf]);Ra.ParagraphReader.nc(zb)&&(this.Zbn(Pa,Object(H.a)(this,this.BCc,"corePasteSetup"),ub,zb,Ea),this.Ubn(Pa,ub,zb));zb.f_();Ea.yo[S.a.qai]?22===zb.type&&(ha.TableCellReader.SZ(Xb)||
zb.setValue(u.a.listID,Number.MAX_VALUE)):this.AG.ARi(zb);if(Ra.ParagraphReader.nc(zb)&&(Ea=ia.i(zb,5),0<Ea.length)){for(const yc of Ea)!yc.properties.hasProperty(u.a.CHb)&&yc.properties.hasProperty(u.a.Y_d)&&(Ea=yc.properties.getValue(u.a.Y_d),yc.properties.setValue(u.a.CHb,Ea)),P.ImageReader.i6b()?P.ImageReader.xEb(yc.properties)&&this.tj.CWf(yc.properties,Pb):P.ImageReader.Xx(yc.properties)||this.tj.CWf(yc.properties,Pb);zb.Di().contentReplicator.forceOutbound(null,null,null)}this.WFh(lb);this.gpo(ub,
zb);pa.TableReader.eX(zb)&&A.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.U6&&ha.TableCellReader.Mma(lb)&&Za.a.oWi(zb);lb.mc();Pa.ui(Object(H.a)(this,this.ACc,"corePasteIncrement"));return!0}gpo(Pa,Ea){if(M.a.instance.J(3)&&pa.TableReader.eX(Pa)){let lb=0;const zb=pa.TableReader.$f(Pa);for(const Xb of pa.TableReader.Ww(Pa,0,zb-1))Xb.nx&&lb++;Pa=this.Hc.Rc(4);Pa.Eb(Ea);Ea.properties.setValue(x.a.swa,zb-lb);Pa.dispose()}}ACc(Pa,Ea){if(!Ea.source.Ht())return Pa.ui(Object(H.a)(this,this.hjb,
"pasteTeardown")),!0;Pa.ui(Object(H.a)(this,this.Gth,"corePasteIteration"));return!0}hjb(){h.a.mark(5565);return!1}get U6(){null==this.U8&&(e.AFrameworkApplication.Ne("he991617;3eed2178"),this.U8=e.AFrameworkApplication.K?e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.U8}sWd(){return!J.GraphIterator.Za(this.vha).Ud()}kai(){return this.GZe?1===J.GraphIterator.Za(this.vha).Mp():!1}kQh(Pa){try{return this.upl(Pa)}catch(Ea){return A.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Ea.message),0}}upl(Pa){let Ea=0;if(Pa&&(Ea=this.tpl(Pa),!Ea&&Pa.childNodes))for(let lb=0;lb<Pa.childNodes.length&&!(Ea=this.kQh(Pa.childNodes[lb]));lb++);return Ea}tpl(Pa){if(1===Pa.nodeType&&Pa.getAttribute){Pa=(Pa.getAttribute("class")||"").split(" ");for(const Ea of Pa)if(Ea.startsWith(this.yVj))return Ea.startsWith(this.Gvc)?this.Ou&&Ea===this.Gvc+this.Ou?3:2:1}return 0}hbn(Pa,Ea,lb,zb,Xb){Xb.yo||(Xb.yo={});Fa.sa.raiseEvent("OnParagraphCopy",
new ua(Pa,Ea,lb,zb,Xb.yo))}Lbn(Pa,Ea,lb,zb){zb.yo||(zb.yo={});Fa.sa.raiseEvent("OnCopyComplete",new ua(Pa,null,Ea,lb,zb.yo))}Van(Pa){Pa.yo||(Pa.yo={});Fa.sa.raiseEvent("BeforePaste",new nb(Pa.yo))}Uan(Pa){Pa.yo||(Pa.yo={});Fa.sa.raiseEvent("BeforeCopy",new rb(this.Ns,Pa.yo))}Zbn(Pa,Ea,lb,zb,Xb){Fa.sa.raiseEvent("OnParagraphPaste",new ua(Pa,Ea,lb,zb,Xb.yo))}WFh(Pa){ha.TableCellReader.isTableCell(Pa)&&(Pa.Pb(1)||this.IJ.E5(Pa,!0),Pa.mc())}XFh(Pa,Ea){this.s1.wua(Ea)&&(Ea.width=Pa.width)}static nrd(Pa){Fa.sa.addHandler("OnParagraphCopy",
Pa)}static zyc(Pa){Fa.sa.addHandler("OnParagraphPaste",Pa)}static mun(Pa){Fa.sa.removeHandler("OnParagraphPaste",Pa)}static T8j(Pa){Fa.sa.addHandler("OnCopyComplete",Pa)}static b8j(Pa){Fa.sa.addHandler("BeforePaste",Pa)}static Ktn(Pa){Fa.sa.removeHandler("BeforePaste",Pa)}static $7j(Pa){Fa.sa.addHandler("BeforeCopy",Pa)}static c8j(Pa){Fa.sa.addHandler("BeforeTrimOnCopy",Pa)}static U7j(Pa){Fa.sa.addHandler("AfterTrimCompleteOnCopy",Pa)}static get characterPropertiesEditor(){return null!=Fa.Yhg?Fa.Yhg:
Fa.Yhg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get lG(){return Ga.a.instance}static get Ue(){return Ia.PageReader.instance}static j1k(Pa){const Ea={};for(const lb of L.a(Pa)){const zb=Pa[lb];Ea[zb]=zb in Ea?String.format("{0}|{1}",Ea[zb],lb):lb}1<=L.a(Ea).length&&A.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Ea)}static Uln(Pa,Ea,lb,zb,Xb,ub){Ea.colSpan>Xb-lb&&(ub&&ub("A",Ea.colSpan,Xb-lb),Ea.colSpan=Xb-lb);Pa=Fa.J0n(Pa,Ea,zb,lb);Ea.colSpan!==Pa&&(ub&&
ub("B",Ea.colSpan,Pa),Ea.colSpan=Pa)}static Vln(Pa,Ea,lb,zb,Xb,ub){Ea.rowSpan>Xb-lb&&(ub&&ub("A",Ea.rowSpan,Xb-lb),Ea.rowSpan=Xb-lb);Pa=Fa.K0n(Pa,Ea,lb,zb);Ea.rowSpan!==Pa&&(ub&&ub("B",Ea.rowSpan,Pa),Ea.rowSpan=Pa)}static J0n(Pa,Ea,lb,zb){return Fa.g7i(Pa,Ea.colSpan,(Xb,ub)=>{sa.moveToCell(Xb,lb,zb+ub)})}static K0n(Pa,Ea,lb,zb){return Fa.g7i(Pa,Ea.rowSpan,(Xb,ub)=>{sa.moveToCell(Xb,lb+ub,zb)})}static g7i(Pa,Ea,lb){if(14!==Pa.type)throw Error.argument("tableNode is not a Table.");if(!lb)throw Error.argumentNull("MoveToCellAction");
for(let Xb=1;Xb<Ea;Xb++){var zb=J.GraphIterator.Za(Pa);lb(zb,Xb);zb=zb.currentNode;if(!zb||16!==zb.type||!zb.gg)return Xb}return Ea}static frh(Pa,Ea){return Pa+","+Ea}H5m(Pa,Ea){for(;Pa.target.Ud();)Pa.target.Hg();Pa.dgc=new a.a(Ea,Pa.jFi?Pa.jFi:Object(H.a)(this,this.BCc,"corePasteSetup"),new Hb.a(Pa.source,Pa.target,null,Pa.gKf));Pa.dgc.ll("ExecuteCorePasteCellContentInCell");Pa.dgc.fh=!1;Pa.dgc.run()}cMm(Pa){let Ea=!1;if(this.U6&&za.TableBorderSelectionCache.lKc()){const lb=ra.a(Pa.target),zb=oa.a.Rr(Pa.target);
let Xb=this.Fae;isNullOrUndefined(Pa.uWa[Pa.uWa.length-1])||(Xb=Math.min(Xb,Pa.uWa[Pa.uWa.length-1][0]));let ub=this.$4f;isNullOrUndefined(Pa.uWa[Pa.uWa.length-1])||(ub=Math.min(ub,Pa.uWa[Pa.uWa.length-1][1]));ha.TableCellReader.ZMa(Pa.target)||ha.TableCellReader.ZMa(Pa.source)||zb==Xb&&lb==ub?Ea=!0:(ha.TableCellReader.isTableCell(Pa.target)||Pa.target.kd(16),ha.TableCellReader.oaa(Pa.source)?(ha.TableCellReader.ZMa(Pa.target)||(sa.moveToNextRow(Pa.target),sa.moveToColumnByIndex(Pa.target,Pa.eo),
A.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),sa.moveToNextOrPreviousCell(Pa.source,!1,!1)):ha.TableCellReader.oaa(Pa.target)||lb==ub?(sa.moveToNextRow(Pa.source),sa.moveToColumnByIndex(Pa.source,0),A.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),sa.moveToNextRow(Pa.target),sa.moveToColumnByIndex(Pa.target,Pa.eo),A.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(sa.moveToNextOrPreviousCell(Pa.target,
!1,!1),sa.moveToNextOrPreviousCell(Pa.source,!1,!1)))}else ha.TableCellReader.ZMa(Pa.source)?Ea=!0:(ha.TableCellReader.isTableCell(Pa.target)||Pa.target.kd(16),ha.TableCellReader.oaa(Pa.source)?(sa.moveToNextRow(Pa.target),sa.moveToColumnByIndex(Pa.target,Pa.eo),A.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):sa.moveToNextOrPreviousCell(Pa.target,!1,!1),sa.moveToNextOrPreviousCell(Pa.source,!1,!1));Ea&&(this.oY&&this.oY.Wbn(Pa.target,Pa.uWa),pa.TableReader.isTable(Pa.target)||
Pa.target.kd(14),this.tOm(Pa.target.currentNode),A.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return Ea}KRn(){this.Fae=za.TableBorderSelectionCache.F7.bottomMostRowSelected;this.$4f=za.TableBorderSelectionCache.F7.rightMostColumnSelected;this.o9n=za.TableBorderSelectionCache.F7.leftMostColumnSelected;this.Waj=za.TableBorderSelectionCache.F7.topMostRowSelected}}Fa.sa=new m.a;Fa.Umf="PasteConstrainingWidth";Object(C.a)(Fa,"InternalClipboard",null,[])},1829:function(C,O,
c){C=c(0);var l=c(2),e=c(104),a=c(59),h=c(200),m=c(23),v=c(17),u=c(83),n=c(126),x=c(16),A=c(45),H=c(5),E=c(8),L=c(64),M=c(56),F=c(34),J=c(320),I=c(20),K=c(14),N=c(6),G=c(68),P=c(109),S=c(21),W=c(40),X=c(260),Y=c(43),ca=c(262),ha=c(22),ra=c(90),sa=c(172),oa=c(862),ka=c(474),ia=c(3),La=c(96),va=c(66),Ga=c(9),Oa=c(105),Za=c(48),ja=c(504),ba=c(595),qa=c(229),Ma=c(19),Ia=c(24),wa=c(53),za=c(38),pa=c(246),Ba=c(11),Ra=c(1504),fb=c(1520),Va=c(238),ib=c(170),Xa=c(57),qb=c(528);class rb extends Va.a{constructor(Fa,
Pa,Ea,lb,zb,Xb,ub,Pb){super();this.n0g=this.rB=null;this.init(Fa);this.ll("FormattingViewOperation");this.Bfb(l.AFrameworkApplication.ya,Pa,lb,zb,Xb);this._context=Ea;this.r5a=0;this.Ml=!0;this.hFj=ub;this.Km=Pb}get x$(){return this.Km.instance}run(){const Fa=this._context.view;var Pa=null;Fa.ye&&(Pa=Fa.Cb);if(Pa){var Ea=Pa.ib.kb,lb=!fb.a.m6b(this.actionId);!Ea||rb.ag.Stf(Ea,lb)?(rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.dE}),this.Ml=!1):this.x$&&this.x$.I6b(Ea)?(rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.externalSelection}),
this.Ml=!1):rb.Sg.Swa(Ba.ParagraphReader.HT,Pa.Jg)&&(rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.uN}),this.Ml=!1)}else rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.Wfa}),this.Ml=!1;1!==this.behavior&&this.Ml||(this.Ml&&(Ea=Pa.ib.kb,1===Pa.ib.length&&1===Ea.length&&Ma.SelectionEditor.Dk(Ea.Qa)&&ra.b(Ea.Qa)&&(rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.eCc}),this.Ml=!1)),(Ea=this.Ml)&&this.actionId===ia.a.K7&&((Ea=Array.from(Pa.ib.kb).some(P.FormattingReader.$rh))||rb.Kc.Zb(La.a.vf,{["Reason"]:va.a.N5e})),this.dr=Ea?32:8,this.r5a=
3);this.r5a||(ib.a.mark(5730),this.n0g=qb.SelectionReferenceFactory.instance.Wxb(),Ea=Pa.ib.kb.Qa,this.rB=new Za.GraphTransaction(15),this.rB.Eb(Ea.node),this.rB.Al=this.actionId,this.r5a=1);if(1===this.r5a){this.gF||this.g_c(this._context.rk);if(1===this.W1a())return;this.r5a=2}if(2===this.r5a){if(this.actionId===ia.a.K7)if(Pa=Pa.Jg,Pa.zw)for(Ea=0;Ea<Pa.length;Ea++)lb=Pa.getContext(Ea),this.Pfj(lb);else this.Pfj(Pa);this.n0g.$na(this.actionId===ia.a.GX||this.actionId===ia.a.ika);(Pa=Object(L.a)(25,
this.Ed))&&!Pa.m3a||Xa.FocusManager.instance().Kg(Fa.sI);this.rB.dispose();this.rB=null;Ga.App.xa.updateCommandUI();ib.a.mark(5731);this.r5a=3;this.dr=32}3===this.r5a&&(this.hFj.process(this.actionId,this._context,this.behavior,this.response),this.ooa())}Pfj(Fa){(Ma.SelectionEditor.ju(Fa)||Ma.SelectionEditor.qk(Fa))&&Ga.App.HK.Gba(Fa.node)}static get ag(){return pa.a.instance}static get Sg(){return qa.ContextSetEditor.instance}static get Kc(){return n.a.instance}}Object(C.a)(rb,"FormattingViewOperation",
Va.a,[]);var nb=c(1002),Tb=c(762),Zb=c(76),Hb=c(107);c.d(O,"a",function(){return ua});const Sa=new Set([ia.a.ML,ia.a.sM,ia.a.clearFormatting,ia.a.aKa,ia.a.bKa,ia.a.rWa,ia.a.Tza,ia.a.sWa]);class ua{constructor(Fa,Pa,Ea=null,lb){this.kpiName="ChangeCaseCommandUsage";this.l6="wwaengidc";this.UT=new Map;this.SQg=new Set;this.aAb=()=>new oa.a(2);this.xJi=(zb,Xb,ub,Pb,yc)=>{Pb=!0;Xb.contextId!==K.a.view&&(Pb=!1);if(1===ub&&!Pb)return 8;if(zb===ia.a.fWc)zb=yc.formatting,yc=yc.d2f;else{if(!Xb.view||!Xb.view.ye)return 2;
Xb=Xb.view;if(!Xb.Cb||!Xb.Cb.ib.kb)return 8;zb=yc;yc=Xb.Cb.ib}this.TDk(yc,zb);return 32};this.tRe=(zb,Xb,ub,Pb,yc,bc)=>new rb(zb,Xb,ub,Pb,yc,bc,this.RFj,ua.xw());this.bsd=(zb,Xb,ub,Pb,yc)=>{var bc,Ka,Bb;let tb=!0,Kb=Xb;const Ib=!fb.a.m6b(zb);Xb.contextId!==K.a.Hd&&Xb.contextId!==K.a.Wc?tb=!1:(ua.ag.naa(Kb,!1,Ib)&&(ua.Kc.Zb(La.a.Vm,{["Reason"]:va.a.dE}),tb=!1),ua.xw()&&ua.xw().instance&&ua.xw().instance.KT(Kb)&&(tb=!1),tb&&Ma.SelectionEditor.Dk(Xb)&&ra.b(Kb)&&(ua.Kc.Zb(La.a.Vm,{["Reason"]:va.a.eCc}),
tb=!1),Ba.ParagraphReader.HT(Xb)&&(ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.uN}),tb=!1));if(1===ub||!tb)return tb?32:8;if(Xb.contextId===K.a.Wc)return 2;Hb.a.MZe&&(Xb=null===(bc=this.Fo)||void 0===bc?void 0:bc.$Xh(Kb))&&(Kb=Xb);this.XXn(zb)&&(bc=Ma.SelectionEditor.pMb(Kb),Ma.SelectionEditor.zf(bc)||(Kb=bc));bc="boolean"===typeof yc&&yc;Xb=ua.Rd.og;(null===(Ka=this.yca)||void 0===Ka?0:Ka.annotateRange)&&(bc||!Xb)&&(null===(Bb=this.yca)||void 0===Bb?0:Bb.YDb(Kb.node))?this.I1(Kb,zb,yc):ua.Z3a.I1(Kb,Wa=>{this.cec(Wa,
zb,yc,Kb.cpEnd)},bc);Kb.node.Ur&&(Ka=[Object.assign(new F.a,{name:"Source",string:"CharacterFormatting"})],M.a("TOCFormatting",!0,void 0,Ka));this.wbm(zb)&&this.oud(Kb,zb);Pb&&Ra.a.Slb&&(Pb.Mr|=Ra.a.Odb(Kb.node));return 32};this.z2c=(zb,Xb,ub)=>1!==ub&&2===ub?(this.UT.set("Source","Shortcut"),zb=Xb.node.characterData.substr(Xb.cpBegin,Xb.cpEnd-Xb.cpBegin),ua.luf(zb,0,zb.length)?this.oud(Xb,ia.a.aKa):ua.cnm(zb,zb.length)?this.oud(Xb,ia.a.Tza):this.oud(Xb,ia.a.bKa)):32;this.bbb=(zb,Xb,ub)=>{let Pb=
!0;zb=!fb.a.m6b(zb);Xb.contextId!==K.a.Hd&&Xb.contextId!==K.a.Wc?Pb=!1:(ua.ag.naa(Xb,!1,zb)&&(ua.Kc.Zb(La.a.Vm,{["Reason"]:va.a.dE}),Pb=!1),Pb&&Ma.SelectionEditor.Dk(Xb)&&ra.b(Xb)&&(ua.Kc.Zb(La.a.Vm,{["Reason"]:va.a.eCc}),Pb=!1),Pb&&Ba.ParagraphReader.HT(Xb)&&(ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.uN}),Pb=!1));if(1===ub||!Pb)return Pb?32:8;Xb=Xb.node;ua.paragraphEditor.uZb(Xb,!1);Xb.Ur&&(Xb=[Object.assign(new F.a,{name:"Source",string:"ClearFormatting"})],M.a("TOCFormatting",!0,void 0,Xb));return 32};
this.fBc=(zb,Xb,ub,Pb,yc)=>{zb={};zb[nb.a.RFa]=6168;zb[nb.a.QFa]=6169;const bc=Xb.view;var Ka=null;bc.yi&&(Ka=bc);var Bb=!0;let tb=32;Ka&&(Ka=Ka.Cb.ib.kb)&&(ua.ag.Stf(Ka)?(ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.dE}),tb=8,Bb=!1):1===ub&&(tb=32,Bb=!1));Bb&&(Bb=new Za.GraphTransaction(1===ub?3:15),Bb.Eb(bc.root),tb=nb.a.Fna(ia.a.bbb,Xb,ub,Pb,yc,zb,12),Bb.dispose());return tb};this.BRe=(zb,Xb,ub,Pb,yc)=>{var bc,Ka=!0,Bb=32;const tb=!fb.a.m6b(zb);Xb.contextId!==K.a.Wc?Ka=!1:ua.ag.naa(Xb,!1,tb)&&(ua.Kc.Zb(La.a.Vm,
{["Reason"]:va.a.dE}),Ka=!1);if(1===ub||!Ka)return Ka?32:8;ub=Xb.node;I.a.instance.J(8)&&zb===ia.a.clearFormatting&&(ua.No.gBc(ub),ua.paragraphEditor.Goh(ub),Ka=ua.vLb.Sx(ub).wh(ua.vLb.wordStyleIdNormal),ua.a8.pM(Ka,ub,!0));ub=ua.Uj.aif(Xb);Hb.a.MZe&&!ub&&(Ka=null===(bc=this.Fo)||void 0===bc?void 0:bc.$Xh(Xb))&&(Xb=Ka,ub=Ia.SelectionFactory.fo(Xb));if(ub)Bb=wa.a.Rxb(ub),Bb=l.AFrameworkApplication.ya.Vf(Bb,zb,2,!1,Pb,yc);else{Pb=Object(L.a)(25,yc);bc=P.FormattingReader.Qr(Xb);if(!bc)return 16;bc=bc.cache;
switch(zb){case ia.a.font:if(Pb&&Pb.Ed){const {fontName:Kb,f8:Ib,bold:Wa,italic:vc}=ua.Ief(Pb.Ed);ua.Uj.R6d(Kb);ua.Uj.zec(Ib);Object(ja.a)()&&(zb=1==Wa,yc=1==vc,zb||yc)&&(ua.Uj.$F(zb),ua.Uj.setItalic(yc))}break;case ia.a.Ks:E.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");ua.Uj.Ks(yc);break;case ia.a.Yga:ua.Uj.Ks(yc);this.recentColors.X$a(yc)||E.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.S5:ua.Uj.S5();
break;case ia.a.GX:E.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");ua.Uj.ewa(yc);break;case ia.a.J7:ua.Uj.ewa(yc);this.recentColors.X$a(yc)||E.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.ika:ua.Uj.Yud();break;case ia.a.Wv:ua.Uj.Wv(Pb.Ed);break;case ia.a.ML:zb=ua.Uj.HL(x.a.fontSize,bc.fontSize);ua.Uj.Wv(ua.wi.ML(zb));break;case ia.a.sM:zb=ua.Uj.HL(x.a.fontSize,bc.fontSize);ua.Uj.Wv(ua.wi.sM(zb));
break;case ia.a.bold:zb=ua.Uj.HL(x.a.bold,bc.isBold);ua.Uj.$F(!zb);break;case ia.a.setItalic:zb=ua.Uj.HL(x.a.italic,bc.isItalic);ua.Uj.setItalic(!zb);break;case ia.a.underline:zb=ua.Uj.HL(x.a.underline,bc.isUnderline);ua.Uj.K3(!zb);break;case ia.a.cha:ua.Uj.cha(yc);break;case ia.a.superscript:zb=ua.Uj.HL(x.a.superscript,bc.isSuperscript);ua.Uj.xba(!zb);break;case ia.a.subscript:zb=ua.Uj.HL(x.a.subscript,bc.isSubscript);ua.Uj.soa(!zb);break;case ia.a.strikethrough:zb=ua.Uj.HL(x.a.strikethrough,bc.isStrikethrough);
ua.Uj.Q7(!zb);break;case ia.a.Ds:zb=ua.Uj.HL(A.a.Ds,bc.isDoubleStrikethrough);ua.Uj.gec(!zb);break;case ia.a.clearFormatting:ua.Uj.z2a();break;case ia.a.K7:yc.hasProperty(x.a.pE)&&ua.Uj.K7(yc.getValue(x.a.pE));yc.hasProperty(H.a.noProof)&&(zb=yc.getValue(H.a.noProof),ua.Uj.MOn(zb));break;default:this.SQg.has(zb)||(this.SQg.add(zb),(yc=e.ActionManager.sda(zb))&&yc.length||(yc="UnknownAction"),E.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${yc} (${zb})`))}}Ga.App.xa.updateCommandUI();
return Bb};this.zS=(zb,Xb,ub,Pb,yc)=>{Pb=ua.Kc.qo(ia.a.HLn);var bc=!0;Xb.contextId!==K.a.endOfParagraph&&(bc=!1);if(1===ub||!bc)return bc?32:8;ub=Xb.node;bc=N.GraphIterator.Za(Xb.node);bc.rd();var Ka=bc.y6(4);if((bc=!!Ka&&ua.hd.paa(Ka))&&!Ga.App.whb)return 8;var Bb=!Ba.ParagraphReader.textLength(ub);Pb.properties.Z("Action",zb.toString());Pb.properties.Z("ListContext",bc.toString());Pb.properties.Z("IsEmptyParagraph",Bb.toString());E.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
zb,bc,Bb);bc&&!ka.a.ae.WL&&this.ajj(zb,yc,Ka);bc=ub.qa.last;this.$sn(ub,zb);Bb=!!bc.formatting;const tb=ub.getValue(H.a.endOfParagraphFormatting);Ka=ua.characterPropertiesEditor.aLa(ub);Bb=!Bb&&tb&&tb.equals(a.a.nil)?new sa.a(bc,a.a.nil):Ka.Yf(Ka.Ob);this.cec(Ka,zb,yc,bc.cp);I.a.instance.J(3)&&ua.Oj.eKb(ub,bc,Xb.cpBegin,Xb.cpEnd,Bb,Ka,ua.Rd.og);Pb.end();return 32};this.Rja=(zb,Xb,ub,Pb,yc)=>{Pb=!0;const bc=N.GraphIterator.Za(Xb.node);bc.rd();Xb.contextId===K.a.endOfParagraph&&bc.y6(4)||(ua.Kc.Zb(La.a.Vm,
{["Reason"]:va.a.ixf}),Pb=!1);Xb=bc.currentNode;if(!ua.hd.paa(Xb))return 8;if(1===ub||!Pb)return Pb?32:8;ka.a.ae.WL||this.ajj(zb,yc,Xb);return 32};this.Rna=(zb,Xb,ub,Pb,yc)=>{zb=!0;Xb.contextId!==K.a.paragraph&&(zb=!1);if(1===ub&&!zb)return 8;ub=Xb.node;-1!==yc.Zh?yc.Zh!==Ba.ParagraphReader.Lv(ub)&&(yc.Zh=0):yc.Zh=Ba.ParagraphReader.Lv(ub);I.a.instance.J(7)&&(zb=ua.gy.ceb(ub),yc.Ws?(!yc.gYl&&this.jYl(yc.Ws,zb)&&2===yc.Ws.specialIndentType&&(yc.Ws.specialIndentType=0),yc.Ws.ECb===zb.ECb&&h.a.OZ(yc.Ws.HA,
zb.HA)||(yc.Ws.HA=Number.MAX_VALUE),yc.Ws.FCb===zb.FCb&&h.a.OZ(yc.Ws.gma,zb.gma)||(yc.Ws.gma=Number.MAX_VALUE)):yc.Ws=zb,Xb=ua.Sg.Rfh(Xb.rk),void 0!==Xb&&null!==Xb&&(Xb=Xb.node,void 0!==Xb&&null!==Xb&&(Xb=X.WordSectionNavigator.instance.XI(Xb),void 0!==Xb&&null!==Xb&&(Xb=ua.Bg.ev(Xb)-(ua.Bg.DI(Xb)+ua.Bg.eK(Xb)+Ga.App.Wwa),zb.dMc=Xb-zb.HA,zb.cMc=Xb-zb.gma,yc.Ws.cMc=Math.min(yc.Ws.cMc,zb.cMc),yc.Ws.dMc=Math.min(yc.Ws.dMc,zb.dMc)))));I.a.instance.J(7)&&(Xb=ua.XT.zBa(ub),yc.vM?(yc.vM.beforeSpacing=ua.Ibh(Xb.beforeSpacing,
yc.vM.beforeSpacing),yc.vM.afterSpacing=ua.Ibh(Xb.afterSpacing,yc.vM.afterSpacing),yc.vM.lineSpacing.unit===Xb.lineSpacing.unit&&h.a.OZ(yc.vM.lineSpacing.value,Xb.lineSpacing.value)||(yc.vM.lineSpacing.unit=0,yc.vM.lineSpacing.value=0)):yc.vM=Xb);Xb=new N.GraphIterator;Xb.set(ub);Xb.Ab(11);if(ub=Xb.kd(11))yc.isRtl=Y.OutlineElementReader.fm(ub);ub=ua.hd.Gs(Xb);Xb=16;void 0!==ub&&null!==ub&&(Xb=ub.listType);yc.listType=ua.bql(yc.listType,Xb);yc.Cw=16===yc.listType?null:ub;return 32};this.Hen=(zb,Xb,
ub,Pb,yc)=>{yc.isRtl=Y.OutlineElementReader.fm(W.OutlineElementNavigator.Sk(Xb.node));return 32};this.Feh=(zb,Xb,ub)=>{if(zb===ia.a.yKb)zb=!0;else if(zb===ia.a.xKb)zb=!1;else return 2;zb&&this.Roi(Xb);if(1===ub)return 32;ua.Ug.pKb(W.OutlineElementNavigator.Sk(Xb.node),zb);return 32};this.zen=(zb,Xb,ub,Pb,yc)=>{zb=Xb.node;yc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Sk(zb));yc.Zh=S.ImageReader.Lv(zb);return 32};this.Efn=(zb,Xb,ub,Pb,yc)=>{zb=Xb.node;yc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Sk(zb));
yc.Zh=za.TableReader.Lv(zb);-1!==yc.Zh&&yc.Zh||(yc.Zh=yc.isRtl?3:1);return 32};this.KRe=(zb,Xb,ub,Pb,yc)=>{let bc;if(!({Ix:bc}=fb.a.T_f(ub,Xb)).returnValue)return bc;const Ka=Xb.node;switch(zb){case ia.a.xKb:ua.Ug.yec(Ka,!1);break;case ia.a.yKb:this.Roi(Xb);ua.Ug.yec(Ka,!0);break;case ia.a.K7:bc=l.AFrameworkApplication.ya.Vf(Xb.rk,zb,ub,!0,Pb,yc),32===bc&&Ba.ParagraphReader.em(Xb)&&ua.PVc&&ua.PVc.Gba(Ka)}return 32};this.Yxk=(zb,Xb,ub,Pb,yc)=>{const bc={};bc[nb.a.RFa]=6168;bc[nb.a.QFa]=6169;var Ka=
Xb.view;const Bb=new Za.GraphTransaction(1===ub?3:15);Bb.Eb(Ka.root);let tb=nb.a.Fna(zb,Xb,ub,Pb,yc,bc,0),Kb=null;Ka.yi&&(Kb=Ka);Ka=!0;let Ib=null;Kb&&(Ib=Kb.Cb.ib.kb)&&(zb=!fb.a.m6b(zb),ua.ag.Stf(Ib,zb)?(ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.dE}),tb=8,Ka=!1):1===ub&&(tb=32,Ka=!1),ua.Sg.Swa(Ba.ParagraphReader.HT,Kb.Cb.Jg)&&(ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.uN}),tb=8,Ka=!1));Ka&&this.gnm(Ib)&&(tb=nb.a.Fna(ia.a.bbb,Xb,ub,Pb,yc,bc,12));Bb.dispose();return tb};this.Xxk=(zb,Xb,ub)=>{zb=!0;Xb.contextId!==
K.a.paragraph&&Xb.contextId!==K.a.Wc?zb=!1:ua.ag.R_a(Xb)&&(ua.Kc.Zb(La.a.Vm,{["Reason"]:va.a.dE}),zb=!1);if(1===ub||!zb)return zb?32:8;Xb=Xb.node;ub=new Za.GraphTransaction(15);ub.Eb(Xb);ua.No.gBc(Xb);ua.paragraphEditor.uZb(Xb,!0);ua.a8.xXe(Xb);ub.dispose();return 2};this.TTl=(zb,Xb,ub)=>{zb=!0;Xb.contextId!==K.a.view&&(zb=!1);if(1===ub&&!zb)return 8;if(!Xb.view||!Xb.view.ye)return 2;Xb=Xb.view;if(!Xb.Cb||!Xb.Cb.ib.kb)return 8;if(ua.Sg.Swa(Ba.ParagraphReader.HT,Xb.Cb.Jg))return ua.Kc.Zb(La.a.vf,{["Reason"]:va.a.uN}),
8;Xb=Xb.Cb.ib;for(const Pb of Xb)for(const yc of Pb)if(yc&&yc.contextId!==K.a.Hd&&yc.contextId!==K.a.Wc&&yc.contextId!==K.a.paragraph&&yc.contextId!==K.a.endOfParagraph)return 2;return 32};this.d2a=(zb,Xb,ub,Pb,yc)=>{zb=!0;Xb.contextId!==K.a.paragraph&&(zb=!1);if(1===ub&&!zb)return 8;yc.Ws||(Xb=Xb.node,ub=ua.gy.ceb(Xb),yc.Ws=ub,Xb=W.OutlineElementNavigator.Sk(Xb),yc.isRtl=Xb?Y.OutlineElementReader.fm(Xb):!1);return 32};this.Ffn=(zb,Xb,ub,Pb,yc)=>{Xb=Xb.node;zb=W.OutlineElementNavigator.Sk(Xb);yc.Ws||
(Xb=this.QEl(Xb),Xb=ua.gy.ceb(Xb),yc.Ws=Xb,yc.isRtl=Y.OutlineElementReader.isRtl(zb));return 32};this.RFj=Fa;this.yca=Pa;this.Q4=Ea;this.Fo=lb}get recentColors(){return null!=this.Pqg?this.Pqg:this.Pqg=m.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get ADd(){return!!this.Q4&&this.Q4.enabled}Vb(){const Fa=l.AFrameworkApplication.ya,Pa=this.Hen;(ua.Wb?ua.Wb.Wx(41):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Fa.pa(ia.a.font,K.a.endOfParagraph,
this.zS),Fa.pa(ia.a.Wv,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.ML,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.sM,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.Ks,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.Yga,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.S5,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.GX,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.J7,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.ika,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.bold,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.setItalic,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.underline,
K.a.endOfParagraph,this.zS),Fa.pa(ia.a.cha,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.superscript,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.subscript,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.strikethrough,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.Ds,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.K7,K.a.endOfParagraph,this.zS),Fa.pa(ia.a.clearFormatting,K.a.endOfParagraph,this.zS)):Ga.App.whb&&(Fa.pa(ia.a.font,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.Wv,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.Ks,K.a.endOfParagraph,this.Rja),
Fa.pa(ia.a.Yga,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.S5,K.a.endOfParagraph,this.Rja),G.ListReader.sr&&(Fa.pa(ia.a.bold,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.setItalic,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.superscript,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.subscript,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.strikethrough,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.Ds,K.a.endOfParagraph,this.Rja)),Fa.pa(ia.a.ML,K.a.endOfParagraph,this.Rja),Fa.pa(ia.a.sM,K.a.endOfParagraph,this.Rja));const Ea=Ga.App.a4a.Bxd(lb=>
ba.OutlineElementGeneralizer.qla(lb.ib,!0));Fa.gb(ia.a.vWe,K.a.view,this.TTl,100);Fa.gb(ia.a.z2c,K.a.Hd,this.z2c,1028);Fa.pa(ia.a.a2a,K.a.view,this.xJi);Fa.pa(ia.a.fWc,K.a.view,this.xJi);Fa.pa(ia.a.Rna,K.a.view,Ea);Fa.pa(ia.a.Rna,K.a.paragraph,this.Rna);Fa.pa(ia.a.Rna,K.a.image,this.zen);Fa.pa(ia.a.Rna,K.a.unsupportedObject,Pa);Fa.pa(ia.a.Rna,K.a.table,this.Efn);Fa.pa(ia.a.d2a,K.a.view,Ea);Fa.pa(ia.a.d2a,K.a.paragraph,this.d2a);Fa.pa(ia.a.d2a,K.a.table,this.Ffn);Fa.Vc(ia.a.a2a,99);Fa.Vc(ia.a.fWc,
1127);Fa.Vc(ia.a.Rna,97);Fa.Vc(ia.a.d2a,97);this.mL(Fa,ia.a.font);this.mL(Fa,ia.a.Wv);this.mL(Fa,ia.a.ML);this.mL(Fa,ia.a.sM);Fa.U$a(ia.a.TKh,K.a.view,this.tRe);Fa.Vc(ia.a.TKh,1092);this.mL(Fa,ia.a.Ks);this.mL(Fa,ia.a.Yga);this.mL(Fa,ia.a.S5);this.mL(Fa,ia.a.GX);this.mL(Fa,ia.a.J7);this.mL(Fa,ia.a.rWa);this.mL(Fa,ia.a.aKa);this.mL(Fa,ia.a.bKa);this.mL(Fa,ia.a.Tza);this.mL(Fa,ia.a.sWa);this.mL(Fa,ia.a.ika);this.mL(Fa,ia.a.bold);Fa.WJb(ia.a.bold,this.aAb);this.mL(Fa,ia.a.setItalic);Fa.WJb(ia.a.setItalic,
this.aAb);this.mL(Fa,ia.a.underline);Fa.WJb(ia.a.underline,this.aAb);this.mL(Fa,ia.a.cha);this.mL(Fa,ia.a.superscript);Fa.WJb(ia.a.superscript,this.aAb);this.mL(Fa,ia.a.subscript);Fa.WJb(ia.a.subscript,this.aAb);this.mL(Fa,ia.a.strikethrough);Fa.WJb(ia.a.strikethrough,this.aAb);this.mL(Fa,ia.a.Ds);Fa.WJb(ia.a.Ds,this.aAb);Fa.gb(ia.a.i_a,K.a.Hd,this.bsd,96);Fa.U$a(ia.a.K7,K.a.view,this.tRe);Fa.pa(ia.a.K7,K.a.paragraph,this.KRe);Fa.pa(ia.a.K7,K.a.Hd,this.bsd);Fa.pa(ia.a.K7,K.a.Wc,this.BRe);Fa.pa(ia.a.clearFormatting,
K.a.view,this.Yxk);Fa.pa(ia.a.clearFormatting,K.a.paragraph,this.Xxk);Fa.pa(ia.a.clearFormatting,K.a.Hd,this.bsd);Fa.pa(ia.a.clearFormatting,K.a.Wc,this.BRe);Fa.Vc(ia.a.clearFormatting,1036);Fa.pa(ia.a.bbb,K.a.Hd,this.bbb);Fa.pa(ia.a.bbb,K.a.Wc,this.bbb);Fa.pa(ia.a.fBc,K.a.view,this.fBc);Fa.pa(ia.a.xKb,K.a.view,fb.a.Cv);Fa.pa(ia.a.xKb,K.a.paragraph,this.KRe);Fa.pa(ia.a.xKb,K.a.unsupportedObject,this.Feh);Fa.Vc(ia.a.xKb,1028);Fa.pa(ia.a.yKb,K.a.view,fb.a.Cv);Fa.pa(ia.a.yKb,K.a.paragraph,this.KRe);
Fa.pa(ia.a.yKb,K.a.unsupportedObject,this.Feh);Fa.Vc(ia.a.yKb,1028)}mL(Fa,Pa){Fa.U$a(Pa,K.a.view,this.tRe);Fa.pa(Pa,K.a.Hd,this.bsd);Fa.pa(Pa,K.a.Wc,this.BRe);Fa.Vc(Pa,1036)}TDk(Fa,Pa){for(const Pb of Fa)for(const yc of Pb){Fa=null;if(yc.contextId===K.a.Hd){if(ra.b(yc))continue;Fa=[];var Ea=yc.node.qa;if(Ea){var lb=Ea.length-1;const bc=yc.cpBegin,Ka=yc.cpEnd;let Bb=!1;const tb=yc.node.characterData;if(tb&&""!==tb){var zb=tb.substr(bc,Ka-bc);zb&&""!==zb&&v.a.IZe(zb,0,zb.length)&&(Bb=!0)}zb=!1;for(let Kb=
0;Kb<lb;Kb++){var Xb=Ea.J(Kb).cp,ub=Ea.J(Kb+1).cp;if(Ea.J(Kb).formatting&&Math.max(Xb,bc)<Math.min(ub,Ka)){if(tb&&""!==tb&&(Xb=Xb<bc?bc:Xb,ub=tb.substr(Xb,(ub<Ka?ub:Ka)-Xb),!Bb&&v.a.IZe(ub,0,ub.length)))continue;zb=!0;Fa.push(Ea.J(Kb).formatting)}else if(zb)break}Ea.J(lb).formatting&&yc.cpEnd>Ea.J(lb).cp&&Fa.push(Ea.J(lb).formatting)}}else if(yc.contextId===K.a.paragraph&&!Ba.ParagraphReader.HT(yc)){if(Fa=[],Ea=yc.node.qa)for(lb=0;lb<Ea.length;lb++)Ea.J(lb).formatting&&Fa.push(Ea.J(lb).formatting)}else if(yc.contextId===
K.a.endOfParagraph)Fa=[P.FormattingReader.Qr(yc)];else if(yc.contextId===K.a.Wc){this.fen(yc,Pa);return}if(Fa&&0<Fa.length)for(const bc of Fa)if(P.FormattingReader.M8f(Pa,bc.cache,yc))return}}fen(Fa,Pa){if(Fa=P.FormattingReader.Qr(Fa)){Fa=Fa.cache;var Ea=ua.Uj.HL(x.a.bold,Fa.isBold);Pa.bold=Ea?1:0;Ea=ua.Uj.HL(x.a.italic,Fa.isItalic);Pa.italic=Ea?1:0;Ea=ua.Uj.HL(x.a.underline,Fa.isUnderline);Pa.underline=Ea?1:0;Pa.underlineType=ua.Uj.HL(x.a.underlineType,Fa.underlineType);Ea=ua.Uj.HL(x.a.superscript,
Fa.isSuperscript);Pa.superscript=Ea?1:0;Ea=ua.Uj.HL(x.a.subscript,Fa.isSubscript);Pa.subscript=Ea?1:0;Ea=ua.Uj.HL(x.a.strikethrough,Fa.isStrikethrough);Pa.strikethrough=Ea?1:0;Ea=ua.Uj.HL(A.a.Ds,Fa.isDoubleStrikethrough);Pa.Ds=Ea?1:0;Ea=ua.Uj.HL(x.a.font,Fa.$G);Pa.fontName=Oa.a.FYa(Ea);Pa.f8=Fa.we;Pa.fontSize=ua.Uj.HL(x.a.fontSize,Fa.fontSize);Pa.fontColor=ua.Uj.HL(x.a.fontColor,Fa.fontColor);Pa.highlight=ua.Uj.HL(x.a.highlight,Fa.highlight)}}XXn(Fa){return Fa===ia.a.underline||Fa===ia.a.cha||Fa===
ia.a.strikethrough||Fa===ia.a.Ds||Fa===ia.a.GX}static Ief(Fa){return"string"===typeof Fa?{fontName:Fa,f8:-1,bold:2,italic:2}:Fa}I1(Fa,Pa,Ea){var lb;const zb=Fa.cpBegin,Xb=Fa.cpEnd,ub=Fa.node;let Pb=P.FormattingReader.Qr(Fa),yc=zb;const bc=null===(lb=l.AFrameworkApplication.K)||void 0===lb?void 0:lb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);if(Sa.has(Pa))for(const Ka of ub.qa)if(!(Ka.cp<=zb)){if(Ka.cp>=Xb)break;Ka.formatting&&Ka.formatting.cache.fontSize!=Pb.cache.fontSize&&
(lb=this.FSh(Fa.node,Pb,Pa,Ea),this.yca.annotateRange(Fa.node,bc?ub.qa.EXa(yc):yc,bc?ub.qa.EXa(Ka.cp):Ka.cp,lb),yc=Ka.cp,Pb=Ka.formatting)}Pa=this.FSh(Fa.node,Pb,Pa,Ea);this.yca.annotateRange(Fa.node,bc?ub.qa.EXa(yc):yc,bc?ub.qa.EXa(Xb):Xb,Pa)}FSh(Fa,Pa,Ea,lb){const zb={},Xb=Object(L.a)(25,lb),ub=Pa.cache;switch(Ea){case ia.a.bold:2===lb.value&&(lb.value=ub.isBold?0:1);zb[x.a.bold.id]=1===lb.value;break;case ia.a.setItalic:2===lb.value&&(lb.value=ub.isItalic?0:1);zb[x.a.italic.id]=1===lb.value;break;
case ia.a.underline:2===lb.value&&(lb.value=ub.isUnderline?0:1);zb[x.a.underline.id]=1===lb.value;break;case ia.a.cha:zb[x.a.underlineType.id]=lb.number;break;case ia.a.superscript:2===lb.value&&(lb.value=ub.isSuperscript?0:1);zb[x.a.superscript.id]=1===lb.value;break;case ia.a.subscript:2===lb.value&&(lb.value=ub.isSubscript?0:1);zb[x.a.subscript.id]=1===lb.value;break;case ia.a.strikethrough:6!==l.AFrameworkApplication.ya.PG?E.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):
E.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===lb.value&&(lb.value=ub.isStrikethrough?0:1);zb[x.a.strikethrough.id]=1===lb.value;break;case ia.a.Ds:2===lb.value&&(lb.value=ub.isDoubleStrikethrough?0:1);zb[A.a.Ds.id]=1===lb.value;break;case ia.a.font:if(Xb&&Xb.Ed){const {fontName:yc,f8:bc,bold:Ka,italic:Bb}=ua.Ief(Xb.Ed);lb=yc.substr(0,ua.xri);this.ADd&&(zb[H.a.H5.id]=lb,zb[H.a.rF.id]=lb,zb[H.a.c$.id]=lb,zb[H.a.W$.id]=lb,zb[H.a.Qe.id]=bc,zb[H.a.ff.id]=bc,
zb[H.a.Re.id]=bc,zb[H.a.Se.id]=bc);zb[x.a.font.id]=lb;zb[H.a.we.id]=bc;if(Object(ja.a)()){lb=1==Ka;var Pb=1==Bb;if(lb||Pb)zb[x.a.bold.id]=lb,zb[x.a.italic.id]=Pb}}break;case ia.a.Ks:lb=Tb.a.instance.Zza(Fa,lb);zb[x.a.fontColor.id]=lb;break;case ia.a.Yga:Pb=Tb.a.instance.Zza(Fa,lb);zb[x.a.fontColor.id]=Pb;this.recentColors.X$a(lb)||E.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.S5:zb[x.a.fontColor.id]=Zb.a.auto;break;case ia.a.GX:zb[x.a.highlight.id]=
parseInt(lb,16);break;case ia.a.J7:zb[x.a.highlight.id]=parseInt(lb,16);this.recentColors.X$a(lb)||E.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.ika:zb[x.a.highlight.id]=Zb.a.auto;break;case ia.a.Wv:zb[x.a.fontSize.id]=ua.wi.RZb(Xb.Ed);break;case ia.a.ML:zb[x.a.fontSize.id]=this.nxl(ub.fontSize);break;case ia.a.sM:zb[x.a.fontSize.id]=this.Rql(ub.fontSize);break;case ia.a.i_a:if(lb=null===(Pb=ua.Jw)||void 0===Pb?void 0:Pb.i_a)for(const yc of lb.Nj())zb[yc.id]=
lb.wg(yc);break;case ia.a.clearFormatting:if(lb=Pa.hn)for(const yc of lb.Nj())zb[yc.id]=null;zb[H.a.axb.id]=!0;break;case ia.a.aKa:case ia.a.bKa:case ia.a.rWa:case ia.a.Tza:case ia.a.sWa:ub.mMa&&2===ub.capitalization&&(zb[A.a.capitalization.id]=0)}return zb}nxl(Fa){Fa=ua.wi.ML(Fa);return ua.wi.RZb(Fa)}Rql(Fa){Fa=ua.wi.sM(Fa);return ua.wi.RZb(Fa)}cec(Fa,Pa,Ea,lb){var zb=Fa.cache;const Xb=Object(L.a)(25,Ea);switch(Pa){case ia.a.bold:2===Ea.value&&(Ea.value=zb.isBold?0:1);ua.wi.$F(Fa,1===Ea.value);break;
case ia.a.setItalic:2===Ea.value&&(Ea.value=zb.isItalic?0:1);ua.wi.setItalic(Fa,1===Ea.value);break;case ia.a.underline:2===Ea.value&&(Ea.value=zb.isUnderline?0:1);ua.wi.K3(Fa,1===Ea.value);break;case ia.a.cha:ua.wi.cha(Fa,Ea);break;case ia.a.superscript:2===Ea.value&&(Ea.value=zb.isSuperscript?0:1);ua.wi.xba(Fa,1===Ea.value);break;case ia.a.subscript:2===Ea.value&&(Ea.value=zb.isSubscript?0:1);ua.wi.soa(Fa,1===Ea.value);break;case ia.a.strikethrough:6!==l.AFrameworkApplication.ya.PG?E.ULS.sendTraceTag(539305613,
340,50,"User used strikethrough from ribbon"):E.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Ea.value&&(Ea.value=zb.isStrikethrough?0:1);ua.wi.Q7(Fa,1===Ea.value);break;case ia.a.Ds:2===Ea.value&&(Ea.value=zb.isDoubleStrikethrough?0:1);ua.wi.gec(Fa,1===Ea.value);break;case ia.a.font:if(Xb&&Xb.Ed){const {fontName:ub,f8:Pb,bold:yc,italic:bc}=ua.Ief(Xb.Ed);ua.wi.z_(Fa,ub.substr(0,ua.xri));ua.wi.zec(Fa,Pb);Object(ja.a)()&&(Ea=1==yc,lb=1==bc,Ea||lb)&&(ua.wi.$F(Fa,
Ea),ua.wi.setItalic(Fa,lb))}break;case ia.a.Ks:E.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");ua.wi.Ks(Fa,Ea,null);break;case ia.a.Yga:ua.wi.Ks(Fa,Ea,null);this.recentColors.X$a(Ea)||E.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ia.a.S5:ua.wi.S5(Fa);break;case ia.a.GX:E.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");ua.wi.ewa(Fa,Ea);break;case ia.a.J7:ua.wi.ewa(Fa,
Ea);this.recentColors.X$a(Ea)||E.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ia.a.ika:ua.wi.Yud(Fa);break;case ia.a.Wv:ua.wi.Wv(Fa,Xb.Ed);break;case ia.a.ML:ua.wi.U3h(Fa);break;case ia.a.sM:ua.wi.e7i(Fa);break;case ia.a.K7:zb=Ea.ia(H.a.noProof,!1);ua.wi.XYf(Fa,Ea.getValue(x.a.pE),lb,zb);break;case ia.a.i_a:ua.wi.T6d(Fa);break;case ia.a.clearFormatting:ua.wi.hka(Fa);break;case ia.a.aKa:case ia.a.bKa:case ia.a.rWa:case ia.a.Tza:case ia.a.sWa:zb.mMa&&
2===zb.capitalization&&ua.wi.Mxk(Fa)}}$sn(Fa,Pa){ia.a.clearFormatting===Pa&&W.OutlineElementNavigator.Sk(Fa).properties.removeProperty(x.a.uX)}ajj(Fa,Pa,Ea){const lb=Object(L.a)(25,Pa);switch(Fa){case ia.a.Ks:ua.Zma.Ks(Ea,Pa);break;case ia.a.Yga:ua.Zma.Ks(Ea,Pa);break;case ia.a.Wv:ua.Zma.Wv(Ea,lb.Ed);break;case ia.a.S5:ua.Zma.S5(Ea);break;case ia.a.ML:ua.Zma.ML(Ea);break;case ia.a.sM:ua.Zma.sM(Ea);break;case ia.a.font:ua.Zma.wMn(Ea,lb.Ed);break;case ia.a.bold:Fa=this.Qcc(Pa,x.a.bold,Ea);ua.Zma.$F(Ea,
Fa);break;case ia.a.setItalic:Fa=this.Qcc(Pa,x.a.italic,Ea);ua.Zma.setItalic(Ea,Fa);break;case ia.a.subscript:Fa=this.Qcc(Pa,x.a.subscript,Ea);ua.Zma.soa(Ea,Fa);break;case ia.a.superscript:Fa=this.Qcc(Pa,x.a.superscript,Ea);ua.Zma.xba(Ea,Fa);break;case ia.a.strikethrough:Fa=this.Qcc(Pa,x.a.strikethrough,Ea);ua.Zma.Q7(Ea,Fa);break;case ia.a.Ds:Fa=this.Qcc(Pa,A.a.Ds,Ea),ua.Zma.gec(Ea,Fa)}}Qcc(Fa,Pa,Ea){2===Fa.value&&(Fa.value=Ea?Ea.ia(Pa,!1)?0:1:0);return 1===Fa.value}jYl(Fa,Pa){return this.Zeh(Fa,
Pa)||this.Zeh(Pa,Fa)}Zeh(Fa,Pa){return(1===Fa.specialIndentType||!Fa.specialIndentType)&&2===Pa.specialIndentType}QEl(Fa){Fa=N.GraphIterator.Za(Fa);Fa.Ab(11);ha.moveToCell(Fa,0,0);Fa.Ud();Fa.T$();return Fa.currentNode}gnm(Fa){return!Fa||Ma.SelectionEditor.Dm(Fa)||1===Fa.length&&Ma.SelectionEditor.Dk(Fa.Qa)&&!Ma.SelectionEditor.ggb(Fa.Qa)?!1:!0}Roi(Fa){ua.x_g.ub(Fa.contextId)||(E.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Fa.contextId),ua.x_g.Z(Fa.contextId,!0))}wbm(Fa){return Fa===ia.a.rWa||
Fa===ia.a.aKa||Fa===ia.a.bKa||Fa===ia.a.Tza||Fa===ia.a.sWa}oud(Fa,Pa){const Ea=Fa.node,lb=Ea.characterData.substr(Fa.cpBegin,Fa.cpEnd-Fa.cpBegin);this.UT.set("Command",Pa.toString());u.Health.instance.recordKpiUsage(this.kpiName,1,this.l6,this.UT);Pa=ua.n$n(lb,Pa);Ea.cwa(Ea.characterData.substr(0,Fa.cpBegin)+Pa+Ea.characterData.substr(Fa.cpEnd));return 32}static get wi(){return null!=ua.klg?ua.klg:ua.klg=m.a.instance.resolve("Box4.IFormattingEditor")}static get characterPropertiesEditor(){return null!=
ua.Xhg?ua.Xhg:ua.Xhg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get paragraphEditor(){return null!=ua.uqg?ua.uqg:ua.uqg=m.a.instance.resolve("Box4.IParagraphEditor")}static get XT(){return null!=ua.Eog?ua.Eog:ua.Eog=m.a.instance.resolve("Box4.ILineSpacingHelper")}static get vLb(){return null!=ua.Prg?ua.Prg:ua.Prg=m.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get a8(){return null!=ua.Lrg?ua.Lrg:ua.Lrg=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Ug(){return null!=
ua.Npg?ua.Npg:ua.Npg=m.a.instance.resolve("Box4.IOutlineElementEditor")}static get Uj(){return ua.Jw||(ua.Jw=m.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Zma(){return null!=ua.Qog?ua.Qog:ua.Qog=m.a.instance.resolve("Box4.List.IListFormattingEditor")}static get gy(){return null!=ua.Bqg?ua.Bqg:ua.Bqg=m.a.instance.resolve("Box4.IParagraphIndentationReader")}static xw(){return ua.Km||(ua.Km=m.a.instance.$a("Box4.IExternalSelectionManager"))}static get Sg(){return qa.ContextSetEditor.instance}static get ag(){return pa.a.instance}static get Kc(){return n.a.instance}static get Wb(){return null!=
ua.ikg?ua.ikg:ua.ikg=m.a.instance.Pa("Box4.IFeatureHelper")}static get PVc(){return Ga.App.HK}static get Rd(){return null!=ua.ntg?ua.ntg:ua.ntg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Oj(){return null!=ua.Ssg?ua.Ssg:ua.Ssg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Z3a(){return null!=ua.Csg?ua.Csg:ua.Csg=m.a.instance.resolve("Box4.TextFormattingHelper")}static get hd(){return null!=ua.Yog?ua.Yog:ua.Yog=m.a.instance.resolve("Box4.List.IListReader")}static get No(){return null!=
ua.Jog?ua.Jog:ua.Jog=m.a.instance.resolve("Box4.List.IListEditor")}static get Bg(){return ca.a.instance}static bql(Fa,Pa){return 42===Fa?Pa:Fa!==Pa||16===Fa?16:Fa}static Ibh(Fa,Pa){Fa.wOd||(Pa.wOd?Pa=Fa:Pa.unit===Fa.unit&&h.a.OZ(Pa.value,Fa.value)||(Pa.value=-1));return Pa}static n$n(Fa,Pa){switch(Pa){case ia.a.aKa:return Fa.toLowerCase();case ia.a.bKa:return 6!==l.AFrameworkApplication.ya.PG?E.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):E.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),Fa.toUpperCase();case ia.a.rWa:case ia.a.Tza:return ua.Duk(Fa,Pa===ia.a.Tza);case ia.a.sWa:return ua.wbo(Fa);default:return Fa}}static wbo(Fa){let Pa="";for(let Ea=0;Ea<Fa.length;Ea++)Pa=Fa.charAt(Ea)===Fa.charAt(Ea).toUpperCase()?Pa+Fa.charAt(Ea).toLowerCase():Pa+Fa.charAt(Ea).toUpperCase();return Pa}static Duk(Fa,Pa){let Ea,lb,zb=!0,Xb=Fa.length,ub=0,Pb=ua.luf(Fa,ub,Xb);for(;0<Xb;){lb=Ea=!1;var yc=Xb;let Ka;var bc=void 0;for(bc=0;0<yc&&ua.Ywk(Fa.charAt(ub+
bc));bc++,yc--)lb=ua.EQd(Fa.charAt(ub+bc));for(Ka=bc;0<yc&&!(Ea=ua.EQd(Fa.charAt(ub+bc)))&&" "!==Fa.charAt(ub+bc)&&"/"!==Fa.charAt(ub+bc);bc++,yc--);yc=bc-Ka;if(0>=yc)break;ub+=Ka;bc=Fa.substr(ub,yc);bc=bc===bc.toUpperCase();if(Pb||!bc)Fa=zb||lb||Pa?Fa.substr(0,ub)+Fa.charAt(ub).toUpperCase()+Fa.substr(ub+1,yc-1).toLowerCase()+Fa.substr(ub+yc):Fa.substr(0,ub)+Fa.substr(ub,yc).toLowerCase()+Fa.substr(ub+yc);Xb-=yc+Ka;ub+=yc;if(zb=Ea)ub++,Xb--,Pb=ua.luf(Fa,ub,Xb)}return Fa}static luf(Fa,Pa,Ea){for(;0<
Ea&&!ua.EQd(Fa.charAt(Pa));){if(Fa.charAt(Pa)!==Fa.charAt(Pa).toUpperCase())return!1;Pa++;Ea--}return!0}static cnm(Fa,Pa){for(var Ea=0;0<Pa&&!ua.EQd(Fa.charAt(Ea));){if(Fa.charAt(Ea)!==Fa.charAt(Ea).toLowerCase())return!1;Ea++;Pa--}return!0}static EQd(Fa){return"."===Fa||"!"===Fa||"?"===Fa?!0:!1}static Ywk(Fa){return-1==="0123456789".indexOf(Fa)&&Fa.toUpperCase()===Fa.toLowerCase()}}ua.x_g=new J.a;ua.Jw=null;ua.Km=null;ua.xri=31;Object(C.a)(ua,"TextFormattingActor",null,[])},1881:function(C,O,c){c.d(O,
"a",function(){return l});const l=(e,a)=>{var h=e.ewj;if(!h){h=[];for(var m in e)"string"===typeof m&&h.push({key:m,value:e[m]});h.sort((v,u)=>v.value-u.value);e.ewj=h}h=[];for(m=1;0<a;)a&1&&e[m]&&h.push(e[m]),m<<=1,a>>=1;if(h.length&&0===a)return h.reverse().join(", ")}},1883:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";
e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(C.b)("BrowserCode",l)},1885:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(C.a)(l,"AtMentionAttributes",null,[])},1891:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=
3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(C.b)("FindReplaceViewType",l)},1893:function(C,O,c){c.d(O,"a",function(){return l});var l;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||
(l={}))},1907:function(C,O,c){function l(b,k){k=Object.assign(new ca.a,{name:"LinkType",string:k});e(Wa.a.z7l,b,[k])}function e(b,k,r,y=!0){k&&k.UILocation&&Object(Ib.d)(b,y,Ib.e,0,k.UILocation,0,r)}function a(b,k){var r;return b===qq.none?"none":null===(r=tu[b])||void 0===r?void 0:r[k]}function h(b,k,r){return{type:"ShortcutDiscoverySettingsModel",actionId:b,P3i:k,label:r}}c.r(O);var m=c(0),v=c(8),u=c(44),n=c(2),x=c(36),A=c(17),H=c(162),E=c(87);class L{constructor(b){this.h6f=0;this.pCb=this.Cbc=
this.I3a=null;this.PX=n.AFrameworkApplication.ta.lq;this.MW=b;this.MW.Av(E.a.f_i);this.MW.fC(E.a.f_i,Object(u.a)(this,this.pYm,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.pCb)return v.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.pCb;this.I3a=this.PX.jg("ComponentAttach","getCustomAuthConfig");return this.pCb=new Promise((b,k)=>{const r={};let y=!1,R=!1,aa=0;this.h6f=window.setInterval(()=>{4>aa?(aa++,this.MW.sendMessage(E.a.getCustomAuthConfig,r)):(window.clearInterval(this.h6f),
y=!0,v.ULS.sendTraceTag(588087303,344,10,x.c({["error"]:"Request timeout after 4 retries."})),k("Request timeout."))},1E3);this.Cbc=(ta,Ya)=>{window.clearInterval(this.h6f);y||R||(R=!0,ta?(v.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(v.ULS.sendTraceTag(589050654,369,10,x.c({["error"]:Ya.toString()})),k(Ya)))};this.MW.sendMessage(E.a.getCustomAuthConfig,r)})}pYm(b){try{const k=x.a(b.Values[H.a.Zpk]);let r=n.AFrameworkApplication.K.lb("Application")||"";r=A.a.mh(r);
k.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";k.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";k.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";k.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.I3a&&(this.I3a.stop(),this.I3a=null);this.Cbc(k,"")}catch(k){v.ULS.sendTraceTag(589050655,344,10,x.c({["error"]:k.message,["stack"]:k.stack})),
this.Cbc(null,k.message)}}}Object(m.a)(L,"AccountSwitchingManager",null,[138]);var M=c(179);class F{get name(){return"Common.App.AccountSwitching"}zc(b){b.register(L,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Zd(()=>new L(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){M.a.instance.Pc(new F)}}Object(m.a)(F,"AccountSwitchingPackage",null,[1,2]);var J;(function(b){b[b.generalException=0]=
"generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=
13]="clientError";b[b.serverError=14]="serverError"})(J||(J={}));Object(m.b)("ErrorCodes",J);c(1721);class I{constructor(b,k){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=k}}Object(m.a)(I,"OutstandingRequest",null,[]);class K{}K.bOm="AADSTS50058";K.invalidResourceUrl="AADSTS50001";K.VNm="AADSTS65001";K.COm="AADSTS70011";K.userAborted="13002";K.K8m="Popup Window is null";K.J8m="Popup Window closed";K.adalTimeout="Token renewal operation failed due to timeout";
K.Ebo="tokenRevoked";Object(m.a)(K,"WopiHostErrorType",null,[]);var N=c(1473),G=c(59),P=c(1720);class S{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(S,"WopiIdentityInfo",null,[739]);class W{constructor(b,k,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=k;this.expiration=r}}Object(m.a)(W,"WopiIdentityToken",null,[738]);var X=c(15),Y=c(139),ca=c(34),ha=c(180);class ra{constructor(b){this._initialized=
!1;this.Eac={};this.y$d={};this.PX=n.AFrameworkApplication.ta.lq;this.nmf=b}K7e(b){this._initialized||(b.Av(E.a.OGi),b.fC(E.a.OGi,Object(u.a)(this,this.oYm,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,k,r=null){this.bDa(b,k);return new Promise((y,R)=>{if(this.Bpf(k))if(k in this.Eac)R("unresolvedPendingRequest");else{var aa=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,x.c({["error"]:"Request timeout.",["callerId"]:k}));R("timeout")},12E4);this.rbf(b,k,r,(ta,Ya)=>{window.clearTimeout(aa);
ta?y(ta):(v.ULS.sendTraceTag(37856033,369,15,x.c({["error"]:J[Ya]})),R(Ya))})}else v.ULS.sendTraceTag(37856034,344,10,x.c({["error"]:"Caller is not allowed."})),R("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((k,r)=>{this.Bpf(b)?this.PGl((y,R)=>{y?k(y):(v.ULS.sendTraceTag(37856064,369,10,x.c({["error"]:R.toString()})),r(R))}):(v.ULS.sendTraceTag(37856065,344,10,x.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((k,r)=>{const y=this.getAuthContextSync(b);
y?k(y):r("notAllowed")})}getAuthContextSync(b){if(this.Bpf(b)){const k=new P.a;k.upn=n.AFrameworkApplication.K.lb("UserPrincipalName");k.userId=n.AFrameworkApplication.K.lb("LoggableUserId");k.authority=n.AFrameworkApplication.K.lb("HostAuthAuthority");k.tenantId=n.AFrameworkApplication.K.lb("TenantId");k.isAnonymous=n.AFrameworkApplication.K.$("IsAnonymousUser");k.supportsAuthToken=this.b0l(b);b=n.AFrameworkApplication.K.lb("HostAuthType");k.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?
1:0;return k}v.ULS.sendTraceTag(40751647,344,10,x.c({["error"]:"Caller is not allowed."}));return null}b0l(b){const k=N.a.rLc;return X.a.mNa?k&&N.a.gbj?Array.contains(N.a.gbj,b.toLowerCase()):!1:k}rbf(b,k,r,y){var R=[];Array.add(R,Object.assign(new ca.a,{name:"CallerId",string:k}));Array.add(R,Object.assign(new ca.a,{name:H.a.I2f,string:b.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:R}));R=G.a.create().toString();
const aa="getAccessToken_"+R,ta=this.PX.jg("ComponentAttach",aa);this.y$d[aa]=ta;const Ya={};Ya[H.a.J2f]=R;Ya[H.a.K3n]=b.resource;Ya[H.a.L3n]=b.scope;Ya[H.a.R8i]=n.AFrameworkApplication.K.lb("HostAuthType");Ya[H.a.O3n]=n.AFrameworkApplication.K.lb("UserPrincipalName");Ya[H.a.M3n]=b.silentLogin;Ya[H.a.H3n]=b.options;Ya[H.a.I2f]=b.correlationId;Ya[H.a.I3n]=k;r&&(Ya[H.a.addinName]=r.AddinName,Ya[H.a.G3n]=r.AddinTrustId);this.nmf.execute(xb=>{this.K7e(xb);xb.sendMessage(E.a.getAuthToken,Ya)});this.Eac[R]=
new I(b,y)}PGl(b){const k=n.AFrameworkApplication.K.lb("UserName"),r=n.AFrameworkApplication.K.lb("UserPrincipalName"),y=n.AFrameworkApplication.K.lb("LoggableUserIdSpace"),R=new S;R.email=r;R.displayName=k;switch(y){case "OrgIdPuid":R.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":R.authority="MicrosoftAccount";break;default:R.authority=y}b(R,null)}oYm(b){let k=null;try{let y=b.Values[H.a.J2f];const R=b.Values[H.a.F3n],aa=b.Values[H.a.R8i],ta=b.Values[H.a.N3n];let Ya=
null,xb=null;const Mb=this.Eac[y];if("undefined"!==typeof Mb&&Mb){var r=[];Array.add(r,Object.assign(new ca.a,{name:H.a.I2f,string:Mb.requestParameters.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:r}));k=Mb.requestCallback;delete this.Eac[y];"undefined"!==typeof R&&R&&R.length?xb=new W(R,aa,ta):Ya=J[this.yGm(b)];r="getAccessToken_"+y;r in this.y$d&&(this.y$d[r].stop(),delete this.y$d[r]);k(xb,Ya)}else v.ULS.sendTraceTag(37856066,
344,10,x.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:y}))}catch(y){b=b.Values[H.a.J2f],b in this.Eac&&delete this.Eac[b],this.CTd(),v.ULS.sendTraceTag(37856067,344,10,x.c({["error"]:y.message,["stack"]:y.stack})),k&&k(null,"generalException")}}Bpf(b){var k=n.AFrameworkApplication.hSl();b=b.toLowerCase();for(const r of k)if(b===r.toLowerCase())return!0;k=N.a.dRe;for(let r in k)if(b===k[r].toLowerCase())return!0;return!1}yGm(b){b=b.Values[H.a.J3n];this.CTd();v.ULS.sendTraceTag(39068821,
344,15,x.c({["error"]:b}));return b?-1<b.indexOf(K.bOm)?9:-1<b.indexOf(K.K8m)||-1<b.indexOf(K.J8m)?12:-1<b.indexOf(K.invalidResourceUrl)?10:-1<b.indexOf(K.userAborted)?8:-1<b.indexOf(K.COm)||-1<b.indexOf(K.VNm)||b===K.Ebo?11:-1<b.indexOf(K.adalTimeout)?6:0:13}bDa(b,k){b=this.Rln(b.resource);v.ULS.sendTraceTag(39921882,344,50,x.c({["callerId"]:k,["resource"]:b}))}CTd(){v.ULS.sendTraceTag(39068822,344,50,x.c({["userAgent"]:window.navigator.userAgent}))}Rln(b){return(b?b:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(m.a)(ra,"WopiIdentityManager",null,[726]);class sa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}zc(b){this.W=b;b.register(ra,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Zd(()=>new ra(b.$a("Postmessage.IHostPostmessenger")))}init(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.gq(Object(u.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){v.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){M.a.instance.Pc(new sa)}}Object(m.a)(sa,"WopiIdentityPackage",null,[1,2]);var oa=c(545),ka=c(374),ia=c(64),La;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(La||(La={}));Object(m.b)("ApplicationFeatureHelperRequestType",La);class va{constructor(){this.message=null;this.httpStatusCode=
0}}Object(m.a)(va,"HttpRequstToPromiseRejectData",null,[]);var Ga=c(83),Oa=c(51),Za=c(187);class ja{constructor(b,k){this.Oa=b;this.rg=k}y0e(b,k,r,y=null,R=null,aa=null,ta=null,Ya=null){const xb=La[r],Mb=xb+"RequestFailure";Ga.Health.instance.recordKpiUsage(Mb,0,"jpittsdirects",null);return new Promise((cc,jc)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",xb);const Mc=null!=ta?ta:this.Oa.rc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),fd=null!=Ya?Ya:this.Oa.rc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.rg.oXb(b,1,null,this.Rvl(r,y),aa,1,Td=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",xb);try{if(void 0===Td||null===Td||void 0===Td.data||null===Td.data||void 0===Td.data.Ie||null===Td.data.Ie){Ga.Health.instance.recordKpiFailure(Mb,"Invalid RequestSucceededEventArgs",!1,!0,null);let ye=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
xb);jc(this.DJc(ye,Td))}else if(Td.data.Df!==Za.a.yD){Ga.Health.instance.recordKpiFailure(Mb,"HttpStatusCode_"+Td.data.Df.toString(),!1,!0,null);let ye=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Td.data.Df,xb);jc(this.DJc(ye,Td))}else{void 0!==R&&null!==R&&void 0!==Td.data.qj&&null!==Td.data.qj&&R(Td.data.qj);var ne=k(Td.data.Ie);if(ne)v.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",xb),cc(ne);else{Ga.Health.instance.recordKpiFailure(Mb,"Parse Failure",!1,!0,null);let ye=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",xb);jc(this.DJc(ye,Td))}}}catch(ye){Ga.Health.instance.recordKpiFailure(Mb,"Unexpected Failure",!1,!0,null),ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
ye,xb),jc(this.DJc(ne,Td))}},Td=>{if(Td.data){Ga.Health.instance.recordKpiFailure(Mb,"HttpStatusCode_"+Td.data.Df.toString(),!1,!0,null);var ne=A.a.UZh(Td.data.Ie||"No Data");ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Td.data.Df,ne,xb)}else Ga.Health.instance.recordKpiFailure(Mb,"Invalid RequestFailedEventArgs",!1,!0,null),ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
xb);jc(this.DJc(ne,Td))},void 0,void 0,Mc,fd)})}DJc(b,k){const r=new va;r.message=b;r.httpStatusCode=k&&k.data?k.data.Df:-1;return r}Rvl(b,k){const r={};r["x-UserDataSignature"]=this.Oa.lb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Oa.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Oa.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Oa.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Oa.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=Oa.a.fQ(window.location.href,"wd_afhpipl")||"false");if(k)for(let y of k.keys)r[y]=k.J(y);return r}}Object(m.a)(ja,"HttpRequestToPromiseUtility",null,[]);var ba;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=
1]="augloopACLP"})(ba||(ba={}));Object(m.b)("AlternateAuthSupportApp",ba);class qa{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(qa,"WacAlternateAuthToken",null,[]);class Ma{constructor(b,k){this.Cbo=3E5;if(void 0===b||null===b||void 0===k||null===k)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Oa=b;this.N6c=new oa.a(ka.a.Sj());this.Woc=new ja(b,k);void 0!==N.a.Hyf&&null!==N.a.Hyf&&void 0!==N.a.fUd&&null!==N.a.fUd&&0<N.a.fUd&&(b=new qa,b.Token=N.a.Hyf,
b.ExpirationTime=N.a.fUd,this.N6c.Z("loki",b))}Gjl(){let b=null;this.N6c.ub(ba[0])&&(b=this.N6c.J(ba[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.i9k():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-Date.now()<this.Cbo}i9k(){const b=new oa.a(ka.a.Sj());b.Z("X-AlternateAuthApp",ba[0]);return this.Woc.y0e(this.Udb("/afhs/AlternateAuthHelperHandler.ashx"),Object(u.a)(this,this.I4m,"parseAlternateAuthTokenResponse"),2,b).then(k=>{v.ULS.sendTraceTag(545821456,3004,
50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ba[0]);this.N6c.Z(ba[0],k);return k.Token},k=>{k=Object(ia.a)(va,k);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",k.message,k.httpStatusCode);return null})}I4m(b){let k=null;({Iv:k}=x.d(b));v.ULS.sendTraceTag(545821457,3004,k?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return k}Udb(b){return String.format("{0}{1}?{2}",
this.Oa.lb("WebServiceBase"),b,n.AFrameworkApplication.ym)}}Object(m.a)(Ma,"AlternateAuthHelper",null,[684]);var Ia=c(482);class wa{constructor(b,k,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=k;this.tierName=r}}Object(m.a)(wa,"FeatureStateChangeArgs",null,[]);var za=c(113),pa=c(196),Ba=c(78),Ra=c(121),fb;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(fb||(fb={}));Object(m.b)("FeatureState",fb);var Va=c(23),ib=c(13),Xa=c(160);class qb{constructor(b,
k,r=null,y=null,R=null){this.Zcb=this.Rqa=this.vZg=this.v8a=this.Qmd=null;this.Woc=new ja(b,k);this.Oa=b;this.TMj=b.rc("LicensingMaxRetryAttempts",0);this.kve=b.$("IsO365ConsumerHost");this.jve=b.$("IsO365CommercialHost");this.Qdd=b.$("PremiumUpsellIsEnabled");this.Dzg=r;this.m6g=y;this.ga=R;this.u8a=b.$("LicensingIsEnabled");this.bsb=b.$("OcpsIsEnabled")&&this.jve;this.kMe=b.$("ShowPrivacyDialog")&&!!y;this.Hpc=b.$("IsAnonymousUser");this.$8e=new Promise(aa=>{aa(!1)});this.mmb=new Promise(aa=>{aa(!0)});
this.Ycb=new oa.a(ka.a.Sj());this.lpd=!0;this.aQg=this.izl();this.Gsf()&&!this.Hpc?(void 0!==n.AFrameworkApplication.ta&&null!==n.AFrameworkApplication.ta&&(this.Qmd=n.AFrameworkApplication.ta.lq,void 0!==this.Qmd&&null!==this.Qmd&&(this.v8a=this.Qmd.UNa("WebServiceCall","ApplicationFeatureHelperService"))),this.Zcb=this.E7f()):this.Zcb=new Promise(aa=>{aa({})});this.Zcb.catch(aa=>{v.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(aa))});this.lpd&&(this.Qdd=!1,this.isFeatureEnabled("FreemiumUpsell",
!0).then(aa=>{this.Qdd=this.Oa.$("PremiumUpsellIsEnabled")&&aa;return null}))}izl(){const b=this.Oa.Hv("AllLicensedFeatures")?this.Oa.NB("AllLicensedFeatures"):[],k=new Ia.a;for(let r=0;r<b.length;r++)k.add(b[r]);return k}Gsf(){return this.jve||this.kve}E7f(b=0,k=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",k);const r=za.a.jF();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",k.toString()),r.set("isO365ConsumerHost",this.kve.toString()),
r.set("isO365CommercialHost",this.jve.toString()),r.set("isFreemiumUpsellEnabled",this.Qdd.toString()));Ga.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);Ga.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.v8a&&null!==this.v8a&&this.v8a.start();let y=null;k&&(y=new oa.a(ka.a.Sj()),y.Z("x-LicensingForceRefresh","true"));this.vZg=new Date;return(this.u8a?this.Woc.y0e(this.Udb("/afhs/ApplicationFeatureHelperHandler.ashx"),
Object(u.a)(this,this.M4m,"parseApplicationFeatureHelperResponse"),0,y,Object(u.a)(this,this.San,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(R=>{const aa=Object.assign(new Xa.a,{durationMs:this.K9i()});aa.extendedProperties=r;aa.extendedProperties&&R&&(aa.extendedProperties.set("featureCount",Ba.a.count(R).toString()),aa.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in R).toString()),aa.extendedProperties.set("msoPremiumBadgeEnabled",
("MsoPremiumBadge"in R).toString()),this.Rqa&&aa.extendedProperties.set("fromCache",(this.Rqa<this.vZg).toString()));Ga.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",aa);return R},R=>{const aa=Object.assign(new Xa.a,{durationMs:this.K9i()}),ta=Object(ia.a)(va,R);if(!ta)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ga.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,aa),new Promise((Ya,xb)=>{xb(R)});aa.extendedProperties=r;aa.extendedProperties&&aa.extendedProperties.set("status",ta.httpStatusCode.toString());Ga.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,aa);return 408===ta.httpStatusCode&&++b<=this.TMj?this.E7f(b):new Promise((Ya,xb)=>{xb(ta)})})}M4m(b){(b=x.b(b))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",
b)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}Udb(b){var k=String.format("{0}{1}",this.Oa.lb("WebServiceBase"),b);this.Oa.Hv("ApplicationFeatureHelperHttpCachingEnabled")&&this.Oa.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=qb.SGd(this.Oa))&&0<b.length&&(this.lpd&&(b+="ucbf"),k=new pa.QueryStringBuilder(k),k.Ke("afhskey",b),k=k.toString());return k}isFeatureEnabled(b,k){if(!this.bsb&&
!this.kMe&&!this.u8a)return this.mmb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.bsb?this.Dzg.Gea("ControllerConnectedServicesEnabled"):this.mmb;const aa=this.kMe?this.m6g.getSettings().then(ta=>2!==ta.hI,()=>k):this.mmb;return r.then(ta=>ta?aa:this.$8e)}r=null;r=this.bsb?this.Dzg.isFeatureEnabled(b):this.mmb;let y=null;y=this.u8a?this.Nem(b,k):this.mmb;let R=null;R=this.kMe?
this.m6g.isFeatureEnabled(b):this.mmb;return r.then(aa=>aa?R.then(ta=>ta?y:this.$8e):this.$8e).then(aa=>{this.Wni(b,aa,!0);return aa},()=>{this.Wni(b,k,!1);return k})}Wni(b,k,r){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,k,r)}getFeatureTier(b,k){if(!this.u8a)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Zcb.then(r=>this.NId(b,r,k),()=>k)}isFreemiumUpsellEnabled(){return this.Qdd&&
this.kve&&!this.Hpc}launchUpsellExperience(b,k=null){v.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=za.a.jF();r&&(r.set("experienceId",b),k&&r.set("campaignId",k));Ga.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);if(r=Va.a.instance.Pa("Common.IInProductMessagingUIManager")){const y=Object(u.a)(this,this.uUl,"handleDimeTaskComplete");r.Jli(b,y,k)}else v.ULS.sendTraceTag(594367561,
3004,15,"InProductMessaging was not initialized"),Ga.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Xb(ib.a.aEd,2,{["experience"]:b})}Kva(b,k){if(!this.u8a)return null;if(!b||!k)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=Ra.a.create().toString();this.Ycb.ub(b)||this.Ycb.Z(b,new oa.a(ka.a.Sj()));this.Ycb.J(b).add(r,k);v.ULS.sendTraceTag(594564812,
3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}scc(b,k){this.u8a&&(b&&this.Ycb.ub(b)?k&&Ra.a.Sd(k)?this.Ycb.J(b).ub(k)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",k,b)),this.Ycb.J(b).remove(k)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",
k,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",k,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}NId(b,k,r){return this.lpd?b in k?k[b].LicenseTier:r:b in k?this.w5m(k[b],r):r}w5m(b,k){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;
default:return k}}uUl(){v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Zcb.then(b=>{this.UMi(b)}).catch(()=>{this.UMi({})})}UMi(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const k=this.E7f(0,!0);k.then(r=>{this.Zcb=k;Ba.a.count(r)>Ba.a.count(b)?Ga.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ga.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",
!1,!0,null);for(let y of this.Ycb.keys)if(y in r){const R=this.NId(y,r,0);y in b?this.NId(y,b,0)!==R&&this.MEf(y,!0,R):this.MEf(y,!0,R)}else y in b&&this.MEf(y,!1,this.NId(y,b,0))}).catch(r=>{Ga.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(r))})}MEf(b,k,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
b,k,r);k=new wa(b,k,r);r=this.Ycb.J(b);for(let y of r)try{y.value(k)}catch(R){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,y.key,R.message))}}Mem(b,k){if(this.u8a){const r=this.aQg.contains(b);let y=!0,R="",aa=!1;return this.Zcb.then(ta=>{b in ta?(ta=ta[b],R=fb[ta.FeatureState],y=1!==ta.FeatureState):y=!r;this.joi(b,r,R,aa,k,y);return y},()=>{aa=!0;
r&&(y=k);this.joi(b,r,R,aa,k,y);return y})}return this.mmb}joi(b,k,r,y,R,aa){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,k,y,r,R,aa)}Nem(b,k){if(this.lpd)return this.Mem(b,k);if(this.u8a){if(this.aQg.contains(b))return this.Zcb.then(r=>b in r,()=>k);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
b)}return this.mmb}San(b){try{b&&"Date"in b&&(this.Rqa=new Date(b.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Rqa.toString()))}catch(k){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",k)}}K9i(){if(void 0!==this.v8a&&null!==this.v8a){const b=this.v8a.ri;this.v8a.stop();return b}return null}static SGd(b){try{if(X.a.Y$d){const k=b.lb("UserDataSignature").split(".");if(1<k.length){const r=
window.self.atob(k[1]),y=JSON.parse(r).LocalStorageKey;if(void 0!==y&&null!==y&&0<y.length)return y}}}catch(k){v.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",k.toString())}return null}}Object(m.a)(qb,"ApplicationFeatureHelper",null,[685]);var rb=c(77);class nb{constructor(b,k){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+k);this.ExpirationTime=b.getTime()}}Object(m.a)(nb,"CloudPolicySettingsCacheData",
null,[]);var Tb=c(1336),Zb=c(377),Hb=c(237);class Sa{static k7i(){return n.AFrameworkApplication.K.$("SideCarIsEnabled")?Sa.P5d&&Sa.GNc?new Promise(b=>{b(!0)}):new Promise((b,k)=>{Sa.P5d=Hb.a.create(n.AFrameworkApplication.K.lb("SideCarUrl"));Zb.a.cT(Sa.P5d);Sa.P5d.VV((r,y)=>{(Sa.GNc=y.succeeded)?b(y.succeeded):k(y.succeeded)})}):new Promise(b=>{b(!1)})}}Sa.GNc=!1;Sa.P5d=null;Object(m.a)(Sa,"SideCarLoader",null,[]);class ua{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(m.a)(ua,"CloudPolicySettingsData",null,[]);class Fa{constructor(b,k){this.kke=0;this.uvd=null;this.Woc=new ja(b,k);this.Oa=b;k=b.lb("HostAuthType");this.bsb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===k||null===k)&&"aad"===k.toLowerCase();this.PTg=x.b(b.lb("OcpsDefaultSettings")||"{}");this.orc=this.SGd();k=this.Oa.Hv("ServicesControlsMicrosoftControllerServicesList")?this.Oa.NB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.U8c=new Ia.a;for(let r=0;r<
k.length;r++)this.U8c.add(k[r]);this.bsb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.uvd=this.hfo():this.uvd=this.D7f(this.bsb,this.Udb("/afhs/CloudPolicySettings.ashx"),Object(u.a)(this,this.Q4m,"parseCloudPolicySettingsResponse"));this.uvd.then(()=>null).catch(r=>{v.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(r))})}Gea(b,k=!0){if(!this.bsb){const aa=this;return new Promise(ta=>{ta(aa.dJc(b))})}let r=this,y=this;const R=this.uvd.then(aa=>{try{let ta=null;aa.PolicySettings&&"unknown"in
aa.PolicySettings&&(ta=aa.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(xb=>{xb("0"!==ta[b])});const Ya=b.toLowerCase();if(Ya in ta&&void 0!==ta[Ya]&&null!==ta[Ya])return new Promise(xb=>{xb("0"!==ta[Ya])});v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(xb=>{xb(r.dJc(b))})}return new Promise(Ya=>{Ya(r.dJc(b))})}catch(ta){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",
ta.message),r.handleError(ta.toString(),k,r.dJc(b))}},aa=>y.handleError(aa,k,y.dJc(b)));R.then(aa=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,aa);return null});return R}isFeatureEnabled(b,k=!0){if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Pem(b,k);let r=new Promise(R=>{R(!0)}),y="";this.U8c.contains(b)&&(y="ControllerConnectedServicesEnabled",
r=this.Gea(y,k));r.then(R=>{v.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,R,y);return null});return r}Pem(b,k=!0){let r=new Promise(R=>{R(!0)}),y="";"mso_sendASmile"===b?y="Enabled":"Survey"===b||"FloodgateSurvey"===b?y="SurveyEnabled":this.U8c.contains(b)&&(y="ControllerConnectedServicesEnabled");""!==y&&(r=this.Gea(y,k));r.then(R=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,R,y);return null});return r}handleError(b,k,r){return k?new Promise(y=>{y(r)}):new Promise((y,R)=>{R(b)})}D7f(b,k,r){if(!b)return Promise.resolve(new ua);let y=!1,R=null;Ga.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let aa=this.L_e("GetCloudPolicySettings");return(new Promise((ta,Ya)=>{if(void 0!==this.orc&&null!==this.orc&&0<this.orc.length){const xb=this.Meo();if(void 0!==xb&&null!==xb){y=!0;ta(xb);return}}this.Woc.y0e(k,r,1,null,Object(u.a)(this,this.dbn,
"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Oa.rc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Oa.rc("CloudPolicySettingsRequestSentTimeout",3E4)).then(xb=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Rfo(xb);ta(xb);return xb},xb=>{Ya(xb);return null})})).then(ta=>{({jx:aa,returnValue:R}=this.u$d(aa));var Ya=za.a.jF();Ya&&Ya.set("FromCache",y.toString());Ya=Object.assign(new Xa.a,{durationMs:R,extendedProperties:Ya});Ga.Health.instance.recordKpiSuccess("GetCloudPolicySettings",
Ya);return ta})}hfo(){return Sa.k7i().then(()=>{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Udb(b){return String.format("{0}{1}",this.Oa.lb("WebServiceBase"),b)}Q4m(b){let k=null;({Iv:k}=x.d(b));v.ULS.sendTraceTag(50622687,3004,k?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",b);return k}dbn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in
b){const k=parseInt(b["CheckIn-Interval"]);void 0!==k&&null!==k&&0<k&&(this.kke=k)}}catch(k){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",k)}}dJc(b){return b in this.PTg?"0"!==this.PTg[b]:!0}Meo(){try{const b=Tb.a.instance.getItem(this.orc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
b);const k=JSON.parse(b);if(void 0===k||null===k)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===k.ExpirationTime||null===k.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(k.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const r=new ua;r.PolicySettings=k.PolicySettings;r.ControllerConnectedServicesFeatureNames=new rb.a;this.Oa.Hv("ServicesControlsMicrosoftControllerServicesList")&&this.Oa.NB("ServicesControlsMicrosoftControllerServicesList");for(let y of this.U8c)r.ControllerConnectedServicesFeatureNames.add(y);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
b.toString()),null}}Rfo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.kke)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const k=new nb(b,this.kke),r=JSON.stringify(k);v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);Tb.a.instance.setItem(this.orc,
r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(k){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",k.toString())}}SGd(){const b=qb.SGd(this.Oa);return b&&0<b.length?"OCPS"+b:null}L_e(b){const k=Va.a.instance.Pa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==k&&null!==k?k.jg("WebServiceCall",b):null}u$d(b){if(void 0!==b&&null!==b){const k=b.ri;b.stop();return{returnValue:k,jx:null}}return{returnValue:null,
jx:b}}}Object(m.a)(Fa,"CloudPolicySettingsHelper",null,[682]);class Pa{constructor(){this.lDh=this.olj=this.hI=0;this.mDh=this.plj=this.Axb="";this.rIe=this.ZQa=2}clone(){const b=new Pa;b.hI=this.hI;b.olj=this.olj;b.lDh=this.lDh;b.Axb=this.Axb;b.plj=this.plj;b.mDh=this.mDh;b.ZQa=this.ZQa;b.rIe=this.src;return b}get src(){return this.rIe}serialize(b=null){const k={};if(!b||b.contains(Pa.wGb))k[Pa.wGb]=this.hI;if(!b||b.contains(Pa.eTc))k[Pa.eTc]=this.Axb;if(!b||b.contains(Pa.fTc))k[Pa.fTc]=this.ZQa;
return JSON.stringify(k)}static create(b,k=null){const r=new Pa;r.rIe=b;void 0!==k&&null!==k&&(Pa.wGb in k&&(r.hI=k[Pa.wGb]),Pa.eTc in k&&(r.Axb=k[Pa.eTc]),Pa.fTc in k&&(r.ZQa=k[Pa.fTc]));return r}static deserialize(b,k){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return Pa.create(k,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
r.toString()),r;}}}Pa.wGb="CCS";Pa.eTc="CCSTime";Pa.fTc="OfficePrivacyRoamedNoticeShown";Object(m.a)(Pa,"UserPrivacySettings",null,[]);var Ea=c(136);class lb{constructor(b,k){if(void 0===b||null===b||void 0===k||null===k)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Oa=b;this.rg=k;this.gHe=this.Nd=null}Udb(b){var k=String.format("{0}RoamingServiceHandler.ashx?action=",this.Oa.appSettings.RoamingServiceHandlerWebServiceBase||"");k=new Sys.StringBuilder(k);k.append(b);k.append("&");
k.append(n.AFrameworkApplication.ym);return k.toString()}executeRequest(b,k,r,y=null){return this.rg.pXb(b,k,y,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((k,r)=>{try{if(void 0===this.Nd||null===this.Nd||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var y=this.Nd.hI!==b.hI;if(2===this.Nd.src&&y)this.vEn(b),k(!0);else{var R=this.XIn(b);if(void 0===R||null===
R||!R.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Nd.src)k(this.Kfj(R));else if(0===this.Nd.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",R);const aa=this.executeRequest(this.Udb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",R);aa.continueWith(()=>{if(aa.jo||aa.Ki)v.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
k(!1);else{var ta=aa.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&null!==ta.args.data&&ta.args.data.Df===Za.a.yD?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),k(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),k(!1))}})}}}}catch(aa){v.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",aa.toString()),k(!1)}})}XIn(b){if(void 0===this.Nd||null===this.Nd||void 0===b||null===
b)throw Error.invalidOperation("User Privacy settings have not been initialized");const k=new rb.a;0===b.src?(this.Nd.hI!==b.hI&&(k.add(Pa.wGb),k.add(Pa.eTc)),this.Nd.ZQa!==b.ZQa&&k.add(Pa.fTc)):1===b.src&&this.Nd.hI!==b.hI&&k.add(Pa.wGb);return k.count?b.serialize(k):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.gHe){const b=this;this.gHe=new Promise(k=>{try{b.Nd?k(b.Nd.clone()):b.bfo().then(r=>{b.Nd=r;k(b.Nd.clone());
return null},()=>{b.$eo().then(r=>{b.Nd=r;k(b.Nd.clone());return null},()=>{b.afo().then(r=>{b.Nd=r;k(b.Nd.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Nd=new Pa;k(b.Nd.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Nd=new Pa,k(b.Nd.clone())}})}return this.gHe}bfo(){return new Promise((b,k)=>
{try{const y=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Oa.$("PrivacyDialogShouldCheckRoaming")||y){var r=this.executeRequest(this.Udb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.jo||r.Ki)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const R=r.result;if(R&&R.args&&R.args.data)if(R.args.data.Df!==Za.a.yD)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
R.args.data.Df);else{if(R.args.data.Ie){b(lb.parse(R.args.data.Ie,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",R.args.data.Ie);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");k("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(R){v.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",R.toString()),k("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),k("Roaming should not be used")}catch(y){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",y.toString()),k("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}$eo(){return new Promise((b,
k)=>{try{const r=Ea.a.get("WacUPToggleState");let y=null;void 0!==r&&null!==r&&0<r.length&&(y=decodeURIComponent(r));if(void 0!==y&&null!==y&&0<y.length){const R=lb.parse(y,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",R.toString());b(R)}else{const R=Pa.create(1),aa=new rb.a;aa.add(Pa.wGb);const ta=R.serialize(aa);this.Kfj(ta)?(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
ta),b(R)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ta),k("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),k("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}afo(){return new Promise(b=>{try{var k=-1!==window.location.href.indexOf("&wdccsoff=1");let r=Pa.create(2);k?(r.hI=
2,n.AFrameworkApplication.pBh(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.hI=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),k=Pa.create(2),k.hI=1,b(k)}})}vEn(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.hI?n.AFrameworkApplication.pBh():n.AFrameworkApplication.c3k();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}Kfj(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const k=this.Oa.lb("PrivacyCookieDomain")||"";if(!k||!k.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Ea.a.y2i("WacUPToggleState",
b,Ea.a.YNa,k)}catch(k){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",k.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(k=>{const r=this.Oa.Hv("ServicesControlsMicrosoftControllerServicesList")?this.Oa.NB("ServicesControlsMicrosoftControllerServicesList"):[],y=new Ia.a;for(let R=0;R<r.length;R++)y.add(r[R]);return y.contains(b)?2!==k.hI:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,k){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,k),Pa.deserialize(b,k)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(m.a)(lb,"UserPrivacySettingsHelper",null,[683]);class zb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}zc(b){this.W=b;this.W.register(682,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Zd(()=>
new Fa(n.AFrameworkApplication.K,n.AFrameworkApplication.af));this.W.register(683,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Zd(()=>new lb(n.AFrameworkApplication.K,n.AFrameworkApplication.af));this.W.register(684,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Zd(()=>new Ma(n.AFrameworkApplication.K,n.AFrameworkApplication.af));this.W.register(685,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Zd(()=>
new qb(n.AFrameworkApplication.K,n.AFrameworkApplication.af,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),n.AFrameworkApplication.ya))}init(){n.AFrameworkApplication.K.gq(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");n.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(k=>{v.ULS.sendTraceTag(42513092,
3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",k,n.AFrameworkApplication.K.lb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(k=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",k,n.AFrameworkApplication.K.lb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");
this.c$n()})}dispose(){}c$n(){try{n.AFrameworkApplication.K.$("SideCarIsEnabled")&&Sa.k7i().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){M.a.instance.Pc(new zb)}}Object(m.a)(zb,"ApplicationFeatureHelperPackage",null,[1,2]);var Xb=c(185);class ub{XGd(b,k){let r;const y=[];for(;r=k.exec(b);){const R=r.index;y.push(new Xb.a(R,R+r[0].length))}return y}isEndPuncSpecialCase(b){const k=this.XGd(b,
ub.B2n);for(const r of k)if(r.end===b.length)return!0;return!1}SFc(b){for(const k of ub.g7k){const r=this.XGd(b,k);if(0<r.length&&!r[0].begin)return r[0].end-1}return 0}findBeginBoundary(b,k,r){var y=b.substring(r,k);b=this.XGd(y,ub.bFh);for(k=b.length-1;0<=k;k--){const R=y.substring(0,b[k].end);if(!this.isEndPuncSpecialCase(R))return y=y.substring(b[k].begin,y.length),r+b[k].end+this.SFc(y)}return r}findEndBoundary(b,k,r){var y=b.substring(k,r);b=this.XGd(y,ub.bFh);for(r=0;r<b.length;r++){const R=
y.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(R))return y=y.substring(b[r].begin,y.length),k+b[r].end+this.SFc(y)}return-1}}ub.C8e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
ub.D8e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";ub.E8e="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";ub.g7k=
[new RegExp(ub.C8e,"ig"),new RegExp(ub.D8e,"ig"),new RegExp(ub.E8e,"ig")];ub.j2f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";ub.m2f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";ub.l2f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
ub.k2f=ub.m2f+"|"+ub.l2f;ub.n2f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";ub.o2f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";ub.p2f="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
ub.q2f="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";ub.DXf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
ub.k2f+"|"+ub.n2f+"|"+ub.o2f+")";ub.CXf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
ub.p2f+")";ub.vEf=ub.j2f+"|"+ub.q2f;ub.i2f=ub.vEf+"|"+ub.DXf+"|"+ub.CXf;ub.bFh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");ub.B2n=new RegExp(ub.i2f,"g");Object(m.a)(ub,"ProofingSentenceSeparatorScriptSharp",null,[677]);class Pb{G5c(b,k){const r=[];let y;for(;null!=(y=k.exec(b));){const R=y.index;r.push({begin:R,end:R+y[0].length})}return r}isEndPuncSpecialCase(b){return this.G5c(b,Pb.Ntj).some(k=>
k.end==b.length)}SFc(b){for(const k of Pb.Gqj){const r=this.G5c(b,k);if(0<r.length&&0==r[0].begin)return r[0].end-1}return 0}findBeginBoundary(b,k,r){var y=b.substring(r,k);b=this.G5c(y,Pb.zcg);for(k=b.length-1;0<=k;k--){const R=y.substring(0,b[k].end);if(!this.isEndPuncSpecialCase(R))return y=y.substring(b[k].begin,y.length),r+b[k].end+this.SFc(y)}return r}findEndBoundary(b,k,r){var y=b.substring(k,r);b=this.G5c(y,Pb.zcg);for(r=0;r<b.length;r++){const R=y.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(R))return y=
y.substring(b[r].begin,y.length),k+b[r].end+this.SFc(y)}return-1}}Pb.ypj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Pb.Itj="[\u2639\u263a\u263b]";Pb.Heg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Pb.uqj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Pb.Jsj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Pb.mfg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Pb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Pb.Geg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Pb.Nrj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Pb.Mrj="[\uff21-\uff3a\uff41-\uff5a]";Pb.Krj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Pb.Jrj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Pb.Lrj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Pb.sfe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Pb.ycg="[\u3002\uff61]";Pb.$5c="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Pb.Mqj="[\u00bb\u2019\u201d\u203a\"']";Pb.Lfe=Pb.ypj+"|"+Pb.Itj;Pb.Orj="[\u2028\u2029\n\r]";Pb.Irj="("+Pb.$5c+"|"+Pb.Heg+"|"+Pb.mfg+"|"+Pb.Geg+
")";Pb.Hrj="("+Pb.$5c+"|"+Pb.Heg+"|"+Pb.mfg+"|"+Pb.Symbol+"|"+Pb.Geg+"|"+Pb.uqj+"|"+Pb.Jsj+")";Pb.C8e="("+Pb.sfe+"("+Pb.Lfe+"|"+Pb.Mqj+"|"+Pb.$5c+")*"+Pb.Orj+")";Pb.D8e="("+Pb.sfe+"("+Pb.Lfe+")*("+Pb.$5c+")+)";Pb.E8e="("+Pb.ycg+"("+Pb.Lfe+")*)";Pb.Gqj=[new RegExp(Pb.C8e,"ig"),new RegExp(Pb.D8e,"ig"),new RegExp(Pb.E8e,"ig")];Pb.j2f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Pb.m2f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Pb.l2f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Pb.k2f=Pb.m2f+"|"+Pb.l2f;Pb.n2f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Pb.o2f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Pb.p2f="(("+Pb.Nrj+"|"+Pb.Krj+"|"+Pb.Lrj+")[.])+|(("+Pb.Jrj+")[.\ufe52\uff0e])+";Pb.q2f="("+Pb.Mrj+")[.\ufe52\uff0e]";Pb.DXf=Pb.Irj+"("+Pb.k2f+"|"+Pb.n2f+"|"+Pb.o2f+")";Pb.CXf=Pb.Hrj+"("+Pb.p2f+")";Pb.vEf=Pb.j2f+"|"+Pb.q2f;Pb.i2f=Pb.vEf+"|"+Pb.DXf+"|"+Pb.CXf;Pb.zcg=new RegExp(Pb.sfe+"|"+Pb.ycg,"ig");Pb.Ntj=new RegExp(Pb.i2f,"g");Object(m.a)(Pb,"ProofingSentenceSeparator",null,[677]);class yc{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}zc(b){this.W=b;n.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Pb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new ub).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){M.a.instance.Pc(new yc)}}Object(m.a)(yc,"Box4GrammarCheckPackage",null,[1,2]);var bc=c(84),Ka=c(9),Bb=c(75),tb=c(67),Kb=c(7),Ib=c(56),Wa=c(3);class vc{constructor(b,k,r,y){this.lFe=this.Hed=this.wte=this.le=null;this.tOg=this.Hqb=this.Jia=this.uqa=this.Yie=
!1;this.Pca=0;this.y0f=!1;this.gHb=()=>{this.reset()};this.xab=R=>{this.Pca=R.Ib.keyCode;var aa=R.Ib.rawEvent.key;aa&&aa!==vc.SJ||(this.y0f=!0);return this.Jia&&this.Hed?R.Ib.keyCode===tb.a.h0||R.Ib.keyCode===tb.a.hs||R.Ib.keyCode===tb.a.px?(aa=!1,R.Ib.keyCode===tb.a.h0?(v.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),aa=!0):R.Ib.keyCode===tb.a.hs?v.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):R.Ib.keyCode===tb.a.px&&
v.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Hed(R),aa&&this.reset(),!0):R.Ib.keyCode===tb.a.Kha||R.Ib.keyCode===tb.a.n8||R.Ib.keyCode===tb.a.i0||R.Ib.keyCode===tb.a.j0||R.Ib.keyCode===tb.a.e4||R.Ib.keyCode===tb.a.MK?(this.Hed(R),!0):!1:!1};this.Loa=R=>{if(this.y0f||this.Jia){this.y0f=!1;var aa=this.oJc(),ta=this.ZHc(R.Ib.target),Ya=R.Ib.rawEvent.inputType;return(void 0!==Ya&&null!==Ya||this.Pca!==tb.a.eB&&this.Pca!==tb.a.g0)&&"deleteContentBackward"!==
Ya&&"deleteContentForward"!==Ya?this.L4h(aa,ta,R.Ib.target):!1}};this.Hgh=R=>{if(1!==R.Ib.rawEvent.key.length)return!1;const aa=this.oJc(),ta=this.ZHc(R.Ib.target);return this.L4h(aa,ta,R.Ib.target)};this.yNa=R=>{if(!this.Jia)return!1;const aa=this.oJc(),ta=this.ZHc(R.Ib.target);(R.Ib.keyCode===tb.a.eB||R.Ib.keyCode===tb.a.g0||(R.Ib.keyCode===tb.a.oRa||R.Ib.keyCode===tb.a.fjc)&&R.Ib.ctrlKey)&&this.Ikf(aa,ta,R.Ib.target);return!1};this.dTe=(R,aa)=>{this.Pca=aa.Hpf?tb.a.eB:aa.isDelete?tb.a.g0:this.Pca;
this.Jia&&(aa.Hpf?this.KTl(aa.Pki):aa.isDelete&&this.mUl(aa.Pki))};this.Wd=b;this.rj=k;this.Zjc=r;this.Zc=y;this.reset()}Hzc(b,k){this.uqa||(this.uqa=!0,b.Xta?this.yab(k):b.zda(()=>{this.uqa||this.yab(k)}))}dispose(){this.Hqb&&(Ka.App.xa.Cgc.sc(Kb.a.input,this.Zc.editingView.editingElement,this.Loa),this.Hqb=!1);this.Yie&&(this.le.sc(Kb.a.Ezc,this.Zc.editingView.editingElement,this.Hgh),this.Yie=!1);this.tOg&&(this.le.sc(Kb.a.aI,this.Zc.editingView.editingElement,this.xab),this.le.sc(Kb.a.oh,this.Zc.editingView.editingElement,
this.yNa));Ka.App.xa.mba(this.gHb);this.L9i()}ENi(b){this.wte=b}SNi(b){this.lFe=b}FNi(b){this.Hed=b}mjk(){this.Jia=!0;n.AFrameworkApplication.Ne("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}L9i(){this.Jia=!1}eO(){return this.Jia}yab(b){this.le=b;this.Zc.yd?this.Zc.yd.yi&&(Ka.App.Vzc&&X.a.U$d||X.a.Ys?(Ka.App.xa.Cgc.mb(Kb.a.input,this.Zc.editingView.editingElement,this.Loa,null),this.Hqb=!0):this.le&&X.a.Ak&&(this.le.mb(Kb.a.Ezc,this.Zc.editingView.editingElement,this.Hgh),
this.Yie=!0),this.le&&(this.le.mb(Kb.a.aI,this.Zc.editingView.editingElement,this.xab),this.le.mb(Kb.a.oh,this.Zc.editingView.editingElement,this.yNa),this.tOg=!0),this.Zjc.tah(this.dTe),Ka.App.xa.$Y(this.gHb)):v.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session")}L4h(b,k,r){if(1>k)return!1;b=b.replace(new RegExp(vc.newLine,"g"),"");const y=b.charAt(k-1);this.Jia&&y!==vc.SJ?this.Ikf(b,k,r):this.Jia||y!==vc.SJ?this.Jia&&y===vc.SJ&&v.ULS.sendTraceTag(41178052,
324,50,"Tried to type @ while already in at mention mode"):this.wte&&(this.reset(),this.fan(k,b)&&(this.mjk(),this.Ikf(b,k,r),v.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===k?"true":"false")));return this.Jia}reset(){this.uqa=!1;this.L9i();this.lFe&&this.lFe()}ZHc(b){return this.rj.w2b(2,b)}oJc(){return this.Wd.vp().innerText}fan(b,k){return 0>b-2||this.Iuk(k.charAt(b-2))?!0:!1}Iuk(b){return A.a.xaa(b)||"("===b}Ikf(b,k,r){if(!b||""===b||0>k)this.reset();else{const {hXi:y,
ysd:R}=this.erm(b,k);this.wte(y,r,R)}}erm(b,k){let r=this.qkl(b,k);if(0<=r&&k<=b.length)return{hXi:b.substring(r,k),ysd:r};this.reset();return{hXi:"",ysd:r}}qkl(b,k){let r=-1,y=k;for(y;0<=y&&63>=k-y;y--)if(b.charAt(y)===vc.SJ){r=y;break}63<k-y&&-1==r&&Ib.c(Wa.a.lgo,!0,void 0,void 0,void 0,void 0);return r}KTl(b){b=this.ZHc(b.Ib.target);b=this.oJc().charAt(b-1);this.Jia&&b===vc.SJ&&this.reset()}mUl(b){b=this.ZHc(b.Ib.target);b=this.oJc().charAt(b);this.Jia&&b===vc.SJ&&this.reset()}}vc.SJ="@";vc.newLine=
"\n";Object(m.a)(vc,"AtMentionsListener",null,[676]);class Lc{constructor(){this.W=null}get name(){return"Box4.AtMentions"}zc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>new vc(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Bb.InteractiveViewManager.instance)).singleInstance()}init(){n.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&n.AFrameworkApplication.K.gq(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Hzc(Ka.App.xa.jb,
bc.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){M.a.instance.Pc(new Lc)}}Object(m.a)(Lc,"Box4AtMentionsPackage",null,[1,2]);class Gb{get name(){return"Box4.Workers"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new Gb)}}Object(m.a)(Gb,"Box4WorkersPackage",null,[1,2]);var pc=c(320),Fc=c(86);class ob{constructor(){this.dGa=new Fc.a}I3(b,k){this.dGa.Z(b,k)}vbf(b){({value:b}=this.dGa.Bc(b));return b}}Object(m.a)(ob,"AggregationMethodsForActivityName",
null,[]);var Fb=c(248);class gb{constructor(){this.mjd=new pc.a;this.dGa=new pc.a}I3(b,k,r){this.dGa.ub(b)&&this.dGa.J(b)||this.dGa.Z(b,new ob);this.dGa.J(b).I3(k,r)}vbf(b,k){return this.dGa.ub(b)&&this.dGa.J(b)?this.dGa.J(b).vbf(k):null}wJc(b){this.mjd.ub(b)&&this.mjd.J(b)||this.mjd.Z(b,new Fb.a);return this.mjd.J(b)}oyh(b,k){this.wJc(b).add(k)}}Object(m.a)(gb,"ActivityAggregationInfo",null,[744]);var Jb=c(123),Yb=c(963),tc=c(980);class Ec extends Yb.a{constructor(b,k){super(b);this.HLe=(this.xwj=
k)?k.mul():tc.a.ibf()}get pza(){return this.xwj}get activityName(){return this.pza.name}get startTime(){return this.pza.startTime}get endTime(){return this.pza.endTime}end(){}cancel(){}baf(){}tlo(){this.g2b.Z("AM",this.pza.mode.toString());this.g2b.Z("C",this.pza.count.toString());this.g2b.Z("DA",this.pza.yDh.toFixed(2));this.g2b.Z("DV",this.pza.m1k.toFixed(2))}uhf(b){return this.pza.uhf(b)}Uhf(){return this.pza.Uhf()}sXb(){for(let b of this.pza.qza)b.sXb()}}Object(m.a)(Ec,"AggregatedActivity",Yb.a,
[]);class Vc{constructor(b,k){this.Nhe=0;this.bxa=b;this.qRa=k}hbk(b,k){this.Nhe=k;for(k=0;k<b.count;k++){const r=b.J(k);this.ibk(r)}}ibk(b){const k=Object(ia.a)(Ec,b);if(k)if(1===this.Nhe)this.gbk(k);else if(2===this.Nhe){this.jbk(k);for(let r of this.qRa.wJc(this.bxa)){const y=k.pza.qza.J(0);y.properties.ub(r)&&b.properties.Z(r,y.properties.J(r))}}}gbk(b){for(let k of this.qRa.wJc(this.bxa))this.tVi(b,k)}jbk(b){for(let k of b.Uhf())this.tVi(b,k)}tVi(b,k){const r=this.qRa.vbf(this.bxa,k);if(r){const y=
b.uhf(k);b.properties.Z(k,r(y))}}}Object(m.a)(Vc,"PropertyAggregationHelper",null,[]);var Hd=c(1055);class qd{constructor(b,k,r,y,R){this.gOb=b;this.qRa=k;this.eAg=R;this.vhe=y;this.nMj=r}get n8g(){return this.nMj.value}LBc(b){if(Object(Jb.a)(Hd.a,b))b.LBc();else if(Object(Jb.a)(Ec,b)&&this.vhe.glh(b.activityName.toString())){b=Object(ia.a)(Ec,b);b.tlo();b=b.Pqi();var k=[];Array.add(k,b);b=x.c(k);v.ULS.sendTraceTag(6907266,213,50,b)}}yza(b,k){const r=(new Date).getTime();var y=this.eAg.list.J(b);
const R=({lbk:y}=this.Sil(y)).returnValue;this.eAg.list.Z(b,new rb.a);k&&(y=this.yIk(y,r,this.gOb.x3h));0<y.count&&(new Vc(b,this.qRa)).hbk(y,R)}yIk(b,k,r){const y=new rb.a;for(let R=0;R<b.count;R++){const aa=b.J(R);aa.startTime>k-r?aa.sXb():y.add(aa)}return y}Sil(b){const k=this.n8g.jcj(b);b=this.n8g.sao(b);const r=this.mbk(k,b);return{returnValue:r,lbk:1===r?k:b}}mbk(b,k){return b.count*this.gOb.cti<k.count?1:2}get enabled(){return this.gOb.enabled}sXb(){}}Object(m.a)(qd,"ActivityAggregationManager",
null,[745]);class me{constructor(b){this.enabled=!1;this.Bri=500;this.Isi=2;this.cti=5;this.x3h=3E4;this.$Fc(b.appSettings)}$Fc(b){this.enabled=Boolean.parse(b[me.$6e]||"false");this.Bri=parseInt(b[me.bIm]||"500");this.Isi=parseInt(b[me.JKm]||"2");this.cti=parseInt(b[me.gLm]||"5");this.x3h=parseInt(b[me.CSl]||"30000")}}me.$6e="ActivityAggregationEnabled";me.bIm="ActivityAggregationMaxInterval";me.JKm="ActivityAggregationMinChain";me.gLm="ActivityAggregationModeFactor";me.CSl="ActivityAggregationGraceWindow";
Object(m.a)(me,"ActivityAggregationParams",null,[]);class Zc{constructor(b,k){this.qRa=b;this.tvg=k}jcj(b,k=1){if(!b||!b.count)return b;const r=new rb.a;var y=null;for(let R=0;R<b.count;R++){const aa=b.J(R);if(!aa)continue;const ta=aa.activityName;y?y.Ipm(aa)?y.add(aa):(y=y.process(),r.addRange(y),y=this.tvg(ta,k),y.add(aa)):(y=this.tvg(ta,k),y.add(aa))}y&&(b=y.process(),r.addRange(b));return r}sao(b){if(!b||!b.count)return b;const k={};var r=null;for(let R=0;R<b.count;R++){const aa=b.J(R);if(aa){if(!r){r=
new rb.a;var y=this.qRa.wJc(aa.activityName);for(let ta of y)r.add(ta)}y=this.lHl(aa,r);null!==y&&(y in k&&k[y]||(k[y]=new rb.a),k[y].add(aa))}}b=new rb.a;for(const R of Ba.a.WN(k))r=this.jcj(k[R],2),b.addRange(r);return b}lHl(b,k){let r="";for(let y of k)r+=y,r=b.properties.ub(y)&&void 0!==b.properties.J(y)&&null!==b.properties.J(y)?r+b.properties.J(y):r+"null";return r}}Object(m.a)(Zc,"ActivityAggregationSchemes",null,[746]);class Dc{constructor(b,k,r,y,R){this.Gr=this.Gi=0;this.gOb=r;this.wjc=
y;this.qRa=R;this.name=b;this.Ay=k;this.qza=new rb.a}get mode(){return this.Ay}get count(){return this.qza.count}get startTime(){return this.Gi}get endTime(){return this.Gr}get yDh(){if(!this.count)return 0;let b=0;for(let k of this.qza)b+=k.endTime-k.startTime;return b/this.count}get m1k(){if(!this.count)return 0;let b=0;const k=this.yDh;for(let r of this.qza){const y=r.endTime-r.startTime;b+=(y-k)*(y-k)}return b/this.count}add(b){this.count?this.Gr=b.endTime>this.endTime?b.endTime:this.endTime:
(this.Gi=b.startTime,this.Gr=b.endTime);this.qza.add(b)}Ipm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.gOb.Bri}process(){if(this.count>=this.gOb.Isi){const b=new rb.a,k=this.wjc(this);b.add(k);return b}return this.qza}uhf(b){const k=new rb.a;for(let r of this.qza)if(r.properties.ub(b)){const y=r.properties.J(b);k.add(y)}else k.add(null);return k}Uhf(){const b=this.qRa.wJc(this.name),k=new Fb.a;for(let r of this.tjl())b.contains(r)||k.add(r);return k}tjl(){const b=new Fb.a;if(!this.qza)return b;
for(let k of this.qza)for(let r of k.properties.keys)b.add(r);return b}mul(){return this.qza.J(0).uniqueID}}Object(m.a)(Dc,"ActivityCollection",null,[743]);class ud{constructor(){this.pob=new pc.a}get list(){return this.pob}add(b){const k=b.activityName;if(this.pob.ub(k)&&this.pob.J(k)){const r=this.pxl(this.pob.J(k),b);this.pob.J(k).insert(r,b)}else this.pob.Z(k,new rb.a),this.pob.J(k).add(b)}pxl(b,k){for(let r=b.count-1;0<=r;r--)if(k.startTime>b.J(r).startTime)return r+1;return 0}}Object(m.a)(ud,
"CompletedActivitiesHelper",null,[735]);class Ce{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){n.AFrameworkApplication.FK(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}zc(b){this.W=b;const k=y=>new Ec(()=>b.Pa("Common.App.Activities.IActivityAggregationManager"),y),r=(y,R)=>new Dc(y,R,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),k,b.resolve("Common.IActivityAggregationInfo"));b.register(qd,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Zd(()=>
new qd(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ze("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(me,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Zd(()=>new me(n.AFrameworkApplication.K));b.register(gb,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Zd(()=>
new gb);b.register(Zc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Zd(()=>new Zc(b.resolve("Common.IActivityAggregationInfo"),r));b.register(ud,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Zd(()=>new ud)}static main(){M.a.instance.Pc(new Ce)}}Object(m.a)(Ce,"ActivityAggregatorPackage",null,[1,2]);var ee=c(469),Uf=c(1346);class te{constructor(b){this.OXg=0;this.hke=null;this.qTj=
b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get B_f(){return this.qTj.value}Vb(){this.isInitialized?this.icc():this.Jon(Object(u.a)(this,this.icc,"registerActionsInternal"))}icc(){v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(u.a)(this,this.nSm,"onChatContainerReady"))}).catch(b=>{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),
this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(u.a)(this,this.Nuk,"chatCountChanged"))}).catch(b=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(u.a)(this,this.qSm,"onChatKeyPress"))}).catch(b=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}Nuk(b){v.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",b);if(!b)this.B_f.mSm();else if(1===b&&!this.OXg){const k=document.getElementById(this.hke?this.hke:Uf.a.Vwb);k?this.B_f.rSm(k,Object(u.a)(this,this.Wco,"transferFocusToChat")):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.OXg=b}nSm(b){this.hke=b}qSm(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.Vco(b.shiftKey)}Jon(b){ee.a.instance.mb(Kb.a.x7n,window.self,()=>{b();return!0})}Wco(){v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",b)}}Vco(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.B_f.oSm(b)}}Object(m.a)(te,"ChatManager",null,[747]);var Fe=c(70);class Qf{constructor(){this.sa=new Fe.a;this.JZj=!1}Q9j(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}z9j(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",
b)}get Ubo(){return this.JZj}OKi(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(Qf,"HeaderEventSource",null,[]);var id=c(155),Gg=c(289);class ad{constructor(b,k,r,y,R){this.yod=null;this.Ub=b;this.Ro=k;this.Lj=r;this.MZj=y;this.ga=R}uNi(b,k,r,y=null){const R=this.Ub.re(k);R.parent=r;R.XL=!0;y&&R.vda(y);this.Lj.sza(k,b,!1);this.MZj.sza(k,b,!1);k=new Gg.DOMFocusListing(()=>b);k.Rn(2);k.Rn(1);k.Rn(8);k.Rn(5);k.Rn(3);k.Rn(6);this.Ub.aka(()=>b,R,k).$T=!0;k=
bc.KeyInputManager.lc(tb.a.px,0);r=bc.KeyInputManager.lc(tb.a.px,4);R.Er(k);R.Er(r)}onFlexPaneOpen(b){this.uNi(b,Uf.a.N9b,Uf.a.rMa);this.Ub.Kg(Uf.a.N9b);this.Ro.Dra(Uf.a.N9b)}onFlexPaneClose(){this.Ro.Rw(Uf.a.N9b);this.Ub.Kg(Uf.a.rMa)}rSm(b,k){this.yod||(this.yod=k,this.uNi(b,Uf.a.Vwb,id.AFrame.qL,Object(u.a)(this,this.pSm,"onChatFocus")));this.Ub.Kg(Uf.a.Vwb);this.Ro.Dra(Uf.a.Vwb)}pSm(){this.yod&&this.yod()}mSm(){this.Ro.Rw(Uf.a.Vwb);this.Ub.PDd(id.AFrame.Wo)}oSm(b){this.ga.processAction(b?ib.a.U8e:
ib.a.ufe,2)}}Object(m.a)(ad,"ReactSharedHeaderFocusManager",null,[702]);var Kd=c(104),jh=c(1017),Qe=c(37),zc=c(62);class uc{constructor(b){this.ga=b}Vb(){this.ga.pa(ib.a.aEd,zc.a.frame,Object(u.a)(this,this.oui,"navigateToUpsellPage"));this.ga.pa(ib.a.lgl,zc.a.frame,Object(u.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.pa(ib.a.xxn,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.ZRi,zc.a.frame,Kd.ActionManager.Of)}oui(b,k,r,y,R){if(1===r)return 32;b=8;2===r&&(r=this.Gcf(R,
"experience","gopremiumribbon"),R=Oa.a.w6("2116536"),R=Oa.a.Qn(R,"ocid",jh.b(n.AFrameworkApplication.ta.Rb.ko,n.AFrameworkApplication.ta.Rb.$fa,r)),Qe.a.Gm(R,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(ib.a.ZRi,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,k,r,y,R){if(1===r)return 32;var aa=8;2===r&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(aa=Va.a.instance.Pa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(b=this.Gcf(R,"experience","gopremium"),R=this.Gcf(R,"dimeCampaignId",null),aa.launchUpsellExperience(b,R),aa=32):(v.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),aa=this.oui(b,k,r,y,R)));return aa}Gcf(b,k,r){b&&b[k]&&(r=Object(ia.a)(String,b[k]));return r}}Object(m.a)(uc,"UpsellActor",null,[701]);class Ed{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Va.a.instance.resolve("Common.App.Header.IUpsellActor").Vb();Va.a.instance.resolve("Common.App.Header.IChatManager").Vb()}dispose(){}zc(b){this.W=
b;this.W.register(Qf,"Common.App.Header.HeaderEventSource").singleInstance();this.W.register(uc,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Zd(()=>new uc(n.AFrameworkApplication.ya));this.W.register(ad,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Zd(()=>new ad(n.AFrameworkApplication.ta.fp,n.AFrameworkApplication.ta.ov,n.AFrameworkApplication.ta.U_,n.AFrameworkApplication.ta.Vae,
n.AFrameworkApplication.ya));this.W.register(te,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Zd(()=>new te(this.W.Ze("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){M.a.instance.Pc(new Ed)}}Object(m.a)(Ed,"CommonAppHeaderPackage",null,[1,2]);var Of=c(1337);class $b{static GNh(b,k){switch(b){case 3:return $b.yRl(k);case 2:return $b.XDl(k);case 1:return $b.Wsl(k)}return""}static yRl(b){switch(b){case 1:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static XDl(b){switch(b){case 1:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static Wsl(b){switch(b){case 1:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return n.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,
k,r){if(X.a.mi||X.a.QL)window.setTimeout(()=>{$b.JMi(r,$b.bJd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack($b.cdh(r),b,0,!1)}static mzk(b,k,r,y){k&&y&&y();$b.openInClient(b,k,r)}static bJd(){return X.a.mi?1:X.a.QL?2:X.a.sNa?3:X.a.wl?4:0}static jRl(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static kRl(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get lsf(){return"zh-CN"===window.navigator.language}static JMi(b,k){1===k?(v.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),b=$b.GNh(b,k),8<X.a.GZa?Qe.a.Gm(b,void 0,void 0,"RedirectToAppStore"):Qe.a.Tzb(b)):document.hidden||($b.lsf?(b=n.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Qe.a.Tzb(b)):v.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag($b.GNh(b,k),null,null)))}static cdh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get E8d(){return(X.a.sNa||X.a.wl)&&X.a.yp}static get yXn(){return X.a.mi||X.a.QL}static ZNh(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Ofi(b){return(b=
$b.gyl(b))&&""!==b?Boolean.parse(b):!1}static XZf(b){$b.ENn(b)}static gyl(b){try{return localStorage.getItem(b)}catch(k){return v.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+k.message),null}}static ENn(b){try{localStorage.setItem(b,"true")}catch(k){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+k.message)}}}$b.Gnh="ChromeExtensionBarDismiss";Object(m.a)($b,"WildFireUtilities",null,[]);var xc=c(386);
class Yc{constructor(){this.bie=new xc.a;this.$he=new xc.a;this.Zhe=new xc.a;this.nmk(this.bie);this.mmk(this.$he);this.lmk(this.Zhe);this.Bse=new xc.a;this.Ase=new xc.a;this.zse=new xc.a;this.rpk(this.Bse);this.qpk(this.Ase);this.ppk(this.zse);this.Ake=new xc.a;this.zmk(this.Ake);this.ovb(this.Ake);this.ovb(this.Zhe);this.ovb(this.$he);this.ovb(this.bie);this.ovb(this.Ase);this.ovb(this.Bse);this.ovb(this.zse)}uId(b,k){switch(b){case 1:return this.mSl(k);case 2:return this.Pjl(k)}return $b.E8d?this.Ake:
null}nmk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}mmk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}lmk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}rpk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}zmk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}qpk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2",
"designed for the iPad.");b.add("SkipButton","Skip for now")}ppk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}ovb(b){b.add("Corporation","Microsoft Corporation")}mSl(b){switch(b){case 3:return this.Bse;
case 2:return this.Ase;case 1:return this.zse}return null}Pjl(b){switch(b){case 3:return this.bie;case 2:return this.$he;case 1:return this.Zhe}return null}static get instance(){Yc._instance||(Yc._instance=new Yc);return Yc._instance}}Yc._instance=null;Object(m.a)(Yc,"WildFireStringFactory",null,[]);class wd{constructor(b,k,r,y,R=null,aa=null){this.ABe=null;this._id=b;this.hDe=k;this.$Gj=R;this.Tpc=y;this.fvc=aa;this.I5a=null;this.xxc=r;this.pwc=Yc.instance.uId(k,b)}NJk(){this.I5a=new Of.a(this.title,
this.message,null);this.I5a.addButton(this.Fpk,Object(u.a)(this,this.WRm,"onButtonOneClick"),"");this.xxc&&this.I5a.s$g(this.Lpk,Object(u.a)(this,this.aSm,"onButtonTwoClick"));this.I5a.mka=Object(u.a)(this,this.KYk,"dismissBar");this.I5a.image=3;this.I5a.id=16;this.I5a.closeable=!0}get title(){return this.pwc.J("Headline")}get message(){return this.pwc.J("CallToAction")}get Fpk(){return this.xxc?this.pwc.J("InstallButton"):this.pwc.J("UseAppButton")}get Lpk(){return this.xxc?this.pwc.J("OpenAppButton"):
""}WRm(){this.xxc?this.V8l():this.Cqo()}aSm(){this.xxc&&this.T0m()}get rjh(){return this.I5a}get y1a(){this.ABe||(this.ABe=this.$Gj());return this.ABe}V8l(){v.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Tpc&&this.fvc&&this.fvc();$b.JMi(this._id,this.hDe)}T0m(){this.y1a&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Tpc&&this.fvc&&this.fvc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack($b.cdh(this._id),this.y1a,
0,!1))}Cqo(){$b.E8d?this.Bpk():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),$b.XZf("BizBarClicked"),1!==this.hDe&&2!==this.hDe||$b.mzk(this.y1a,this.Tpc,this._id,this.fvc))}Bpk(){this.Tpc?v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Qe.a.Tzb(n.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}LYk(){this.Tpc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,
301,50,"ChromeExtBannerDismissed");$b.XZf($b.Gnh)}KYk(){$b.E8d?this.LYk():($b.XZf($b.ZNh(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static A1e(){const b=n.AFrameworkApplication.ta.Rb;new wd(b.ko,$b.bJd(),8<X.a.GZa,1===b.$fa,()=>b.Pda,b.pWf());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(wd,"WildFireBusinessBar",null,[]);class le{get name(){return"Common.App.WildFire"}fOe(b){const k=n.AFrameworkApplication.ta.Rb;let r=!1;b&&(b.NJk(),b.rjh&&
(r=k.BJa(b.rjh,!0)));return r}TJk(){var b=n.AFrameworkApplication.ta.Rb;b=new wd(b.ko,$b.bJd(),!1,1===b.$fa);this.fOe(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}A1e(b,k,r,y,R,aa){b=new wd(b,r,y,k,R,aa);this.fOe(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}sQk(){const b=n.AFrameworkApplication.ta.Rb;var k=n.AFrameworkApplication.K;const r=b.ko,y=1===b.$fa;if(k.$($b.jRl(r))){var R=$b.bJd(),aa=8<X.a.GZa;if(2!==r||2!==R||!y){k=k.$($b.kRl(r));var ta=b.pWf(),
Ya=()=>b.Pda;k&&!$b.Ofi($b.ZNh(r))&&this.A1e(r,y,R,aa,Ya,ta)}}}init(){var b=n.AFrameworkApplication.K;const k=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&k;$b.E8d&&b&&!$b.Ofi($b.Gnh)?this.TJk():(document.body&&$b.yXn&&this.sQk(),n.AFrameworkApplication.ya.pa(ib.a.uwf,zc.a.frame,Object(u.a)(this,this.uwf,"launchWildFireBusinessBar")))}uwf(b,k,r,y,R){if(1===r)return 32;if(!R)return 8;this.A1e(R.app,R.mode,R.platform,R.useTwoButton,null,null);return 32}dispose(){}zc(){}static main(){M.a.instance.Pc(new le)}}
Object(m.a)(le,"PackageManager",null,[1,2]);class uf{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=
!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(uf,"BrowserInfo",null,[]);class yg{constructor(){this.Version=this.Name=null}}Object(m.a)(yg,"PluginInfo",null,[]);class pb{static Iua(){if(n.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=pb.Cgl();try{const k=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,k)}catch(k){v.ULS.sendTraceTag(6903564,102,15,k.message)}}else v.ULS.sendTraceTag(6903562,102,
50,"Detailed browser info logging is turned off")}static YFl(){const b=window.navigator.plugins;if(!b||!b.length)return null;const k=[];for(let r=0;r<b.length;r++){const y=b[r].name,R=b[r].version;Array.add(k,Object.assign(new yg,{Name:y,Version:R}))}return k}static Cgl(){const b=new uf,k=new Sys.StringBuilder;pb.bH(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,k);pb.bH(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,k);pb.bH(r=>{b.DocElemOffsetHeight=
r},()=>document.documentElement.offsetHeight,k);pb.bH(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,k);pb.bH(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,k);pb.bH(r=>{b.ScreenAvailWidth=r},()=>window.screen.availWidth,k);pb.bH(r=>{b.ScreenWidth=r},()=>window.screen.width,k);pb.bH(r=>{b.ScreenHeight=r},()=>window.screen.height,k);pb.bH(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,k);pb.bH(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,k);pb.bH(r=>
{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,k);pb.bH(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,k);pb.bH(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,k);pb.bH(r=>{b.WinInnerWidth=r},()=>window.self.innerWidth,k);pb.bH(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,k);pb.bH(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,k);pb.bH(r=>{b.WinOrientation=r},()=>window.self.orientation,k);pb.bH(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,k);pb.bH(r=>{b.SupportsTouch=
r},()=>X.a.J1c,k);pb.bH(r=>{b.NavAppName=r},()=>window.navigator.appName,k);pb.bH(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,k);pb.bH(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||window.navigator.language,k);pb.bH(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,k);pb.bH(r=>{b.NavPlatform=r},()=>window.navigator.platform,k);pb.bH(r=>{b.NavPlugins=r},pb.YFl,k);pb.bH(r=>{b.CalculatedDevicePixelRatio=r},()=>pb.devicePixelRatio,k);b.Error=k.toString();return b}static get devicePixelRatio(){const b=
window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static bH(b,k,r){try{const y=k();b(y)}catch(y){r.isEmpty()||r.append(" | "),r.append(y.message||"null")}}}Object(m.a)(pb,"BrowserInfoLogger",null,[]);class Wb{get name(){return"Common.App.BrowserInfoLogger"}zc(){}init(){pb.Iua()}dispose(){}static main(){M.a.instance.Pc(new Wb)}}Object(m.a)(Wb,"BrowserInfoLoggerPackage",null,[1,2]);class Oc{constructor(){this.sa=new Fe.a}HVa(b){this.sa.addHandler("OnEditHappenedEvent",
b)}zcc(b){this.sa.removeHandler("OnEditHappenedEvent",b)}Cgn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Oc,"EditNotificationEventSource",null,[]);var nd=c(80);class ve{constructor(b,k,r,y,R,aa,ta=0){this.Aoe=!1;this.zoe=this.$rb=null;this.i6g=!1;this.Hb=k;this.Rgd=b;this.N7a=r;this.NO=y;this.g6g=R;this.GDj=aa;this.o$c=0;this.xbd=!1;try{0<ta&&(this.o$c=ta,3E5>this.o$c&&(this.o$c=3E5),this.Hb&&!this.zoe&&(this.zoe=new nd.a(3,2,this.o$c,Object(u.a)(this,this.rxn,"reportEditDocumentUserActionTelemetryIfNecessary")),
this.Hb.fc(this.zoe)))}catch(Ya){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ya)}}get tlj(){return this.i6g}uAd(){this.tlj?this.xbd=!0:(this.i6g=!0,Ga.Health.instance.addQosPillar("Save"),Ga.Health.instance.addQosPillar("ContentCreation"),Ib.c(ib.a.editDocument));this.Aoe=!0;this.g6g&&this.g6g.q8g();this.NO&&this.NO.Cgn();n.AFrameworkApplication.kh&&n.AFrameworkApplication.kh.OGm();this.GDj&&!this.$rb&&(this.UZc(null),
this.$rb=new nd.a(3,2,this.Rgd,Object(u.a)(this,this.UZc,"sendPostMessageIfNecessary"),113),this.Hb.fc(this.$rb))}UZc(){this.Aoe&&(this.N7a.CWR(()=>this.N7a.result.sendMessage(E.a.editNotification,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Aoe=!1)}rxn(){try{this.xbd&&(Ib.c(ib.a.editDocument),this.xbd=!1)}catch(b){this.xbd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}
Object(m.a)(ve,"EditNotificationManager",null,[508]);class nf{constructor(b,k,r,y,R){this.Bre=this.$rb=null;this.MSa=this.rhe=!1;this.Hb=k;this.Rgd=b;this.N7a=r;this.Lj=y;this.VAe=R;this.ANi(null)}ANi(){const b=document.getElementById(n.AFrameworkApplication.XXb);!this.MSa&&this.Lj&&b&&(this.Lj.mb(Kb.a.pX,b,Object(u.a)(this,this.YAf,"mouseActivityHandler"),null),this.MSa=!0);this.VAe(()=>{this.dispose()})}YAf(){this.MSa&&(this.Lj.sc(Kb.a.pX,document.getElementById(n.AFrameworkApplication.XXb),Object(u.a)(this,
this.YAf,"mouseActivityHandler")),this.MSa=!1);this.q8g();return!1}q8g(){this.rhe=!0;this.Bre||(this.Bre=new nd.a(3,2,this.Rgd,Object(u.a)(this,this.ANi,"registerHandlerTask"),112),this.Hb.fc(this.Bre));this.$rb||(this.UZc(null),this.$rb=new nd.a(3,2,this.Rgd,Object(u.a)(this,this.UZc,"sendPostMessageIfNecessary"),111),this.Hb.fc(this.$rb))}UZc(){this.rhe&&(this.N7a.CWR(()=>this.N7a.result.sendMessage(E.a.aro,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.rhe=!1)}dispose(){this.MSa&&(this.Lj.sc(Kb.a.pX,document.getElementById(n.AFrameworkApplication.XXb),Object(u.a)(this,this.YAf,"mouseActivityHandler")),this.MSa=!1)}}Object(m.a)(nf,"UserActivityHostNotificationManager",null,[507,10]);var pf=c(167),Mg=c(82),Jg=c(742);class rh{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.gq(Object(u.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){rh.E1k&&0<rh.r6e&&(this.W.register(Oc,
"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(nf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Zd(()=>new nf(6E4,Mg.a.instance,Jg.a.Lq(this.W.$a("Postmessage.IHostPostmessenger")),pf.a.instance,n.AFrameworkApplication.FK)),this.W.register(ve,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Zd(()=>
new ve(rh.r6e,Mg.a.instance,Jg.a.Lq(this.W.$a("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Pa("Common.Interface.IUserActivityHostNotificationManager"),rh.F1k,rh.z1k)),this.W.resolve("Common.Interface.IEditNotificationManager"),v.ULS.shipAssertTag(38086291,209,0<rh.r6e,"EditNotification Interval is less than or equal to 0."))}zc(b){this.W=b}dispose(){}static get r6e(){return n.AFrameworkApplication.K?parseInt(n.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get z1k(){return n.AFrameworkApplication.K?parseInt(n.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get E1k(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get F1k(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){M.a.instance.Pc(new rh)}}Object(m.a)(rh,"CommonHostNotificationPackage",null,
[1,2]);class Tg{constructor(b,k,r){this.Utb=null;this.Hb=b;this.ga=k;this.hGg=r.create()}Mjb(){this.Utb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.Utb=new nd.a(2,1,3E4,Object(u.a)(this,this.Q8d,"showFloatPane"),67),this.Hb.fc(this.Utb))}Q8d(){this.Utb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.hGg.display()}cPa(){this.ga.pa(ib.a.Q8d,
zc.a.frame,Object(u.a)(this,this.IZn,"showFloatPaneHandler"))}IZn(b,k,r,y,R){return b!==ib.a.Q8d?2:1===r?32:2===r&&R?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",R),R?this.Mjb():(this.Utb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Hb.Ye(this.Utb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.hGg.remove(null)),this.Utb=null),32):8}}Object(m.a)(Tg,"FloatPaneActor",null,[509]);
var ak=c(91),ci=c(95),Af=c(29),Ef=c(27);class Ue{constructor(b,k,r,y,R){this.jye=this.Koc=this.Zjd=this.kUa=this.Wca=this.CRa=this.rje=this.e9=this.rtc=this.jrc=this.krc=this.kqe=null;this.Hb=k;this.Oa=b;this.kg=r;this.W=R;this.gxa=y}Guh(){this.e9=document.createElement("div");this.e9.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.e9.style.width=this.Wca.width+"px";(this.jye=this.WCl(this.gxa))?(this.kUa=document.createElement("a"),this.kUa.setAttribute(Ef.a.Bh,Ef.a.Gz),
this.kg.mb(Kb.a.click,this.kUa,Object(u.a)(this,this.LAi,"onRedirectClick")),this.kUa.href=this.jye,this.kUa.target="_blank",this.kUa.appendChild(this.Wca),this.e9.appendChild(this.kUa)):this.e9.appendChild(this.Wca);this.CRa=document.createElement("a");this.CRa.setAttribute(Ef.a.Bh,Ef.a.J1);this.CRa.className="StandardButton WACFloatPaneCloseButton";this.CRa.title=CommonUIStrings.l_Close;this.CRa.tabIndex=-1;this.rje=ci.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.rje.setAttribute(Ef.a.Bh,Ef.a.Gz);this.CRa.appendChild(this.rje);this.kg.mb(Kb.a.click,this.CRa,Object(u.a)(this,this.onClose,"onClose"));this.e9.appendChild(this.CRa);this.rtc.appendChild(this.e9)}$wl(b){const k=this.Oa.$("O365PromotionHasStarted");switch(b){case 2:return ak.a.b$(String.format("adppt{0}.png",k?"sale":""));case 1:return ak.a.b$(String.format("adxls{0}.png",k?"sale":""));case 3:return ak.a.b$(String.format("addoc{0}.png",k?"sale":""))}return null}WCl(b){const k=this.Oa.lb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(k,"Excel");case 2:return String.format(k,"PowerPoint");case 3:return String.format(k,"Word")}return null}hide(b=null){this.Koc=null;this.e9&&!this.Zjd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.e9.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.e9.style.height="0px",this.Zjd=new nd.a(2,1,1E3,Object(u.a)(this,
this.remove,"remove"),67),this.Hb.fc(this.Zjd))}remove(){this.e9&&this.rtc&&(this.kUa&&this.kg.sc(Kb.a.click,this.kUa,Object(u.a)(this,this.LAi,"onRedirectClick")),this.kg.sc(Kb.a.click,this.CRa,Object(u.a)(this,this.onClose,"onClose")),this.rtc.removeChild(this.e9),this.e9=null);this.Zjd=null}display(){if(this.kqe=this.W.Pa("Common.IFloatPaneContainer"))if(this.rtc=this.kqe.container){var b=this.$wl(this.gxa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Wca=
document.createElement("img"),this.Wca.className="WACFloatPaneImage",this.krc=Object(u.a)(this,this.vWm,"onLoadImageFinish"),Af.a.addHandler(this.Wca,Kb.a.load,this.krc),this.jrc=Object(u.a)(this,this.uWm,"onLoadImageError"),Af.a.addHandler(this.Wca,Kb.a.error,this.jrc),this.Wca.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,
207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}vWm(){const b=this.Oa.rc("O365AdPaneShowingDuration",60);this.Guh();this.e9.style.display="block";this.e9.style.height=this.Wca.height+"px";this.Koc=new nd.a(2,1,1E3*b,Object(u.a)(this,this.hide,"hide"),67);this.Hb.fc(this.Koc);this.gPi()}uWm(){v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.gPi();this.Wca=null}gPi(){this.krc&&this.Wca&&Af.a.removeHandler(this.Wca,
Kb.a.load,this.krc);this.krc=null;this.jrc&&this.Wca&&Af.a.removeHandler(this.Wca,Kb.a.error,this.jrc);this.jrc=null}LAi(){v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Koc&&this.Hb.Ye(this.Koc);this.hide();return!0}dispose(){this.hide()}}Object(m.a)(Ue,"FloatPane",null,[531]);class Df{constructor(b,k,r,y,R){this.Hb=k;this.Oa=b;this.kg=r;this.W=R;this.gxa=y}create(){return new Ue(this.Oa,this.Hb,this.kg,this.gxa,this.W)}}
Object(m.a)(Df,"FloatPaneFactory",null,[505]);var Sf=c(206);class Se{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get jei(){return n.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&n.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.jei&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").Mjb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
this.W.resolve("Common.App.FloatPane.IFloatPaneActor").cPa())}zc(b){this.W=b;this.jei&&(this.W.register(Df,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Zd(()=>new Df(n.AFrameworkApplication.K,n.AFrameworkApplication.uc,Sf.a.instance,n.AFrameworkApplication.ta.Rb.ko,this.W)).singleInstance(),this.W.register(Tg,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Zd(()=>new Tg(n.AFrameworkApplication.uc,n.AFrameworkApplication.ya,
this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){M.a.instance.Pc(new Se)}}Object(m.a)(Se,"FloatPanePackage",null,[1,2]);var Ii=c(1583);class hg{}Object(m.a)(hg,"LokiTokenResult",null,[]);class Fg{constructor(b){this.ahd=b}Vff(){const b=this.jAl();return b?Fg.Gsf?new Promise((k,r)=>{this.ahd.continueWith(()=>{this.ahd.jo||this.ahd.Ki?r(Error.create("Error downloading auth library")):this.ahd.result.Qoa("Loki",b).then(y=>{y=n.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?
this.mAl():y.IsSuccess&&y.Token?Object.assign(new hg,{isSuccess:!0,token:y.Token,errorMessage:null}):Object.assign(new hg,{isSuccess:!1,token:null,errorMessage:JSON.stringify(y)});k(y);return y})})}):Promise.resolve(Object.assign(new hg,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new hg,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Ii.a.NNh())}))}mAl(){const b=
n.AFrameworkApplication.K.lb("LokiUserDataSignature")||"";return Object.assign(new hg,{isSuccess:!0,token:b,errorMessage:null})}jAl(){let b=null;const k=Ii.a.yEd();2===k?b=n.AFrameworkApplication.K.lb("LokiAADAppId"):1===k&&(b=n.AFrameworkApplication.K.lb("LokiMSAAppId"));return b}static get Gsf(){return n.AFrameworkApplication.K.$("IsO365CommercialHost")||n.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(Fg,"LokiTokenManager",null,[503]);class qf{get name(){return"Common.App.LivePersonaUtils"}init(){Va.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}zc(b){b.register(Fg,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Zd(()=>new Fg(Jg.a.Lq(b.$a("Common.App.OAuth.IOAuthManager"))))}static main(){M.a.instance.Pc(new qf)}}Object(m.a)(qf,"LivePersonaUtilsPackage",null,[1,2]);class Cg{constructor(b){this.Vhe=b}udi(b){if(!this.Vhe)return!0;b=Oa.a.cff(b);if(!b)return!1;b=b.toLowerCase();for(let k=0;k<this.Vhe.length;k++)if(b.endsWith(this.Vhe[k]))return!0;return!1}}Object(m.a)(Cg,"DomainAllowListManager",null,[]);class Hh{constructor(b,
k){this.v2e=null;this.EKe=b;this.url=k}get f$f(){return Oa.a.Mva(this.url)}get Dr(){return this.EKe}r6f(){const b={},k=this.Dr;b.a=this.f$f;b.b=this.round(k.navigationStart);b.c=this.round(k.unloadEventStart);b.d=this.round(k.unloadEventEnd);b.e=this.round(k.redirectStart);b.f=this.round(k.redirectEnd);b.g=this.round(k.fetchStart);b.h=this.round(k.domainLookupStart);b.i=this.round(k.domainLookupEnd);b.j=this.round(k.connectStart);b.k=this.round(k.connectEnd);b.l=void 0!==k.secureConnectionStart&&
null!==k.secureConnectionStart?this.round(k.secureConnectionStart):0;b.m=this.round(k.requestStart);b.n=this.round(k.responseStart);b.o=this.round(k.responseEnd);b.q=this.round(k.domInteractive);b.r=this.round(k.domContentLoadedEventStart);b.s=this.round(k.domContentLoadedEventEnd);b.t=this.round(k.domComplete);b.u=this.round(k.loadEventStart);b.v=this.round(k.loadEventEnd);b.w=this.v2e;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(Hh,"PerformanceTimingEntry",null,[]);const aj=(b,k)=>
{const r={};let y=null;switch(b){case 0:y="ResourceTiming";b=k.a;null!=b&&(r.Url=b);b=k.b;null!=b&&(r.InitiatorType=b);b=null==k.c?null:k.c.toString();null!=b&&(r.RedirectStart=b);b=null==k.d?null:k.d.toString();null!=b&&(r.RedirectEnd=b);b=null==k.e?null:k.e.toString();null!=b&&(r.FetchStart=b);b=null==k.f?null:k.f.toString();null!=b&&(r.DomainLookupStart=b);b=null==k.g?null:k.g.toString();null!=b&&(r.DomainLookupEnd=b);b=null==k.h?null:k.h.toString();null!=b&&(r.ConnectStart=b);b=null==k.i?null:
k.i.toString();null!=b&&(r.ConnectEnd=b);b=null==k.j?null:k.j.toString();null!=b&&(r.SecureConnectionStart=b);b=null==k.k?null:k.k.toString();null!=b&&(r.RequestStart=b);b=null==k.l?null:k.l.toString();null!=b&&(r.ResponseStart=b);b=null==k.m?null:k.m.toString();null!=b&&(r.ResponseEnd=b);b=k.n;null!=b&&(r.CustomText=b);b=null==k.o?null:k.o.toString();null!=b&&(r.DecodedBodySize=b);b=null==k.p?null:k.p.toString();null!=b&&(r.EncodedBodySize=b);k=null==k.q?null:k.q.toString();null!=k&&(r.TransferSize=
k);break;case 1:y="PerformanceTiming",b=k.a,null!=b&&(r.Url=b),b=null==k.b?null:k.b.toString(),null!=b&&(r.NavigationStart=b),b=null==k.c?null:k.c.toString(),null!=b&&(r.UnloadEventStart=b),b=null==k.d?null:k.d.toString(),null!=b&&(r.UnloadEventEnd=b),b=null==k.e?null:k.e.toString(),null!=b&&(r.RedirectStart=b),b=null==k.f?null:k.f.toString(),null!=b&&(r.RedirectEnd=b),b=null==k.g?null:k.g.toString(),null!=b&&(r.FetchStart=b),b=null==k.h?null:k.h.toString(),null!=b&&(r.DomainLookupStart=b),b=null==
k.i?null:k.i.toString(),null!=b&&(r.DomainLookupEnd=b),b=null==k.j?null:k.j.toString(),null!=b&&(r.ConnectStart=b),b=null==k.k?null:k.k.toString(),null!=b&&(r.ConnectEnd=b),b=null==k.l?null:k.l.toString(),null!=b&&(r.SecureConnectionStart=b),b=null==k.m?null:k.m.toString(),null!=b&&(r.RequestStart=b),b=null==k.n?null:k.n.toString(),null!=b&&(r.ResponseStart=b),b=null==k.o?null:k.o.toString(),null!=b&&(r.ResponseEnd=b),b=null==k.p?null:k.p.toString(),null!=b&&(r.DomLoading=b),b=null==k.q?null:k.q.toString(),
null!=b&&(r.DomInteractive=b),b=null==k.r?null:k.r.toString(),null!=b&&(r.DomContentLoadedEventStart=b),b=null==k.s?null:k.s.toString(),null!=b&&(r.DomContentLoadedEventEnd=b),b=null==k.t?null:k.t.toString(),null!=b&&(r.DomComplete=b),b=null==k.u?null:k.u.toString(),null!=b&&(r.LoadEventStart=b),b=null==k.v?null:k.v.toString(),null!=b&&(r.LoadEventEnd=b),k=k.w,null!=k&&(r.CustomText=k)}r.Table=y;return Sys.Serialization.JavaScriptSerializer.serialize(r)};var df=c(39),ld=c(203),dj=c(157);class Yh{constructor(b,
k=null,r=null){this.Qg=b;this.e$f=this;this.hGj=k||(()=>window.location.href);this.hoe=new Cg(r)}run(){if(Yh.Lab(window.performance))try{const R=this.hGj();if(Yh.UZj.exec(R)&&this.hoe.udi(R)){var b=new Hh(window.performance.timing,R);dj.a.instance.xjn(b.Dr.fetchStart);dj.a.instance.yjn(b.Dr.navigationStart);dj.a.instance.nX(df.a.Vfl,"connectStart","requestStart");dj.a.instance.nX(df.a.cgl,"requestStart","responseStart");dj.a.instance.nX(df.a.fgl,"responseStart","responseEnd");this.e$f.wFb(1,b.r6f());
this.Qg.Xf(df.a.qdb,b.Dr.fetchStart);this.Qg.Xf(df.a.$fl,b.Dr.domainLookupStart);this.Qg.Xf(df.a.Zfl,b.Dr.domainLookupEnd);this.Qg.Xf(df.a.Xfl,b.Dr.connectStart);this.Qg.Xf(df.a.hgl,b.Dr.secureConnectionStart);this.Qg.Xf(df.a.Wfl,b.Dr.connectEnd);this.Qg.Xf(df.a.dgl,b.Dr.requestStart);this.Qg.Xf(df.a.Baf,b.Dr.responseStart);this.Qg.Xf(df.a.agl,b.Dr.responseEnd-b.Dr.responseStart);this.Qg.Xf(df.a.egl,b.Dr.responseStart-b.Dr.requestStart);var k=0,r=0,y=0;({transferSize:k,a7e:r,S2e:y}=this.xfo(R)).returnValue&&
(this.Qg.Xf(df.a.jgl,k),this.Qg.Xf(df.a.Yfl,y),this.Qg.Xf(df.a.bgl,r));this.Qg.Xf(df.a.XGc,b.Dr.navigationStart)}}catch(R){v.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",R)}}xfo(b){let k,r,y;y=r=k=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:k,a7e:r,S2e:y};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:k,
a7e:r,S2e:y};b=b[0];var R=b.transferSize;void 0!==k&&null!==k&&(k=R);R=b.decodedBodySize;void 0!==R&&null!==R&&(y=R);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:k,a7e:r,S2e:y}}wFb(b,k){v.ULS.sendTraceTag(4551815,306,50,aj(b,k))}static get instance(){return Yh._instance||(Yh._instance=new Yh(ld.a.instance,null,n.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?n.AFrameworkApplication.K.NB("ResourceLoggerDomainAllowList"):null))}static Lab(b){return!(void 0===
b||null===b)&&!(void 0===b.timing||null===b.timing)}}Yh._instance=null;Yh.UZj=RegExp("^https?://.*","i");Object(m.a)(Yh,"PerformanceTimingLogger",null,[504]);class Nl{constructor(b,k){this.v2e=null;this.EKe=b;this.behavior=k;this.url=this.Dr.name}get f$f(){return 2===this.behavior?this.url:Oa.a.Mva(this.url)}get Dr(){return this.EKe}r6f(){const b={},k=this.Dr;b.a=this.f$f;b.b=k.initiatorType;b.c=this.round(k.redirectStart);b.d=this.round(k.redirectEnd);b.e=this.round(k.fetchStart);b.f=this.round(k.domainLookupStart);
b.g=this.round(k.domainLookupEnd);b.h=this.round(k.connectStart);b.i=this.round(k.connectEnd);b.j=void 0!==k.secureConnectionStart&&null!==k.secureConnectionStart?this.round(k.secureConnectionStart):0;b.k=this.round(k.requestStart);b.l=this.round(k.responseStart);b.m=this.round(k.responseEnd);b.o=this.round(Nl.L3b(k,"decodedBodySize"));b.p=this.round(Nl.L3b(k,"encodedBodySize"));b.q=this.round(Nl.L3b(k,"transferSize"));b.n=this.v2e;return b}round(b){return Math.round(1E3*b)/1E3}static L3b(b,k){return b[k]}}
Object(m.a)(Nl,"ResourceTimingEntry",null,[530]);class ij{constructor(b,k=null,r=100){this.kwg=b;this.Nmd=k;this.Ejc={};this.Fzj=r}geo(b){var k=b.name.toLowerCase();const r=Oa.a.Tgf(k);this.jAn(r,k)&&(r in this.Ejc?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(k={},k.fetchstart=b.fetchStart,k.responseend=b.responseEnd,k.iscached=this.lom(b),k.encodedsize=Nl.L3b(b,"encodedBodySize"),k.decodedsize=Nl.L3b(b,"decodedBodySize"),this.Ejc[r]=k))}jAn(b,
k){if(this.kwg)return Array.contains(this.kwg,b);if(this.Nmd)for(b=Oa.a.t2(k),k=0;k<this.Nmd.length;k++)if(this.Nmd[k]&&b.endsWith(this.Nmd[k]))return!0;return!1}lom(b){try{const k=Nl.L3b(b,"transferSize");if(void 0!==k&&null!==k)return!k;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.Fzj}catch(k){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
k.message)}return!1}vln(){if(Ba.a.lf(this.Ejc))v.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=n.AFrameworkApplication.m2?n.AFrameworkApplication.m2.split(";"):[],k=Object.assign(new Xa.a,{extendedProperties:za.a.jF()});k.extendedProperties.set("Flights",x.c(b));this.loi(k,this.Ejc,Ga.Health.instance)}}loi(b,k,r){if(k){var y=0,R=0,aa=0,ta=0,Ya=0,xb=0,Mb=0,cc=0,jc=0,Mc=0,fd=0;for(let ne in k){var Td=k[ne];try{const ye=Object(ia.a)(Object,
Td);if(!ye)continue;const ff=ye.iscached?Boolean.parse(ye.iscached.toString()):!1,Gd=ye.fetchstart?this.parseFloat(ye.fetchstart.toString()):0,oe=(ye.responseend?this.parseFloat(ye.responseend.toString()):0)-Gd,ze=ye.encodedsize?this.parseFloat(ye.encodedsize.toString()):0,ug=ye.decodedsize?this.parseFloat(ye.decodedsize.toString()):0;y+=oe;ta+=ze;Mb+=ug;Mc++;ff?(aa+=oe,xb+=ze,jc+=ug,fd++):(R+=oe,Ya+=ze,cc+=ug)}catch(ye){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
ye.message)}}b.extendedProperties.set("StaticResources",x.c(k));b.extendedProperties.set("TotalResourceDownloadLatency",y.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",R.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",aa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ya.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
xb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Mb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",cc.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",jc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Mc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",fd.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(ij,"AppStaticResourceManager",null,[]);class ck extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(ck,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Mk{constructor(b,k,r=null,y=null,R=100){this.rwe=!1;this.ao=null;this.Ilc=0;this.sa=new Fe.a;this.Ojc=null;this.CY=!1;this.x4g=0;this.Hb=b;this.VBg=0;this.e$f=this;this.hoe=new Cg(r);
this.KJ=k;y&&(this.Ojc=new ij(null,y,R))}get uih(){try{return!(void 0===this.KJ||null===this.KJ)&&!(void 0===this.KJ.getEntriesByType||null===this.KJ.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get ySk(){return this.VBg}get isActive(){return this.CY}get i6f(){return this.x4g}cah(b){this.sa.addHandler(Mk.Y7e,b)}lQi(b){this.sa.removeHandler(Mk.Y7e,b)}zc(b,k){const r=this.i6f!==b;this.x4g=
b;this.isActive&&this.Hb&&r&&(this.Ye(),this.fc());this.VBg=k}activate(){!this.isActive&&this.uih&&(this.fc(),this.CY=!0)}deactivate(b){this.isActive&&(this.Ye(),b&&this.flush(),this.CY=!1)}flush(){if(this.isActive&&this.uih)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.Ilc&&v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.Ilc);const k=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);k&&(window.performance.clearResourceTimings(),this.Ilc=0);const r=[];for(let y=this.Ilc;y<b.length;y++)this.hoe.udi(b[y].name)&&(this.Ojc&&this.Ojc.geo(b[y]),r.push(new Nl(b[y],this.ySk)));k||(this.Ilc=b.length);this.sa.raiseEvent(Mk.Y7e,new ck(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.e$f.wFb(0,r[b].r6f());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
r.length)}catch(k){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",k)}}wFb(b,k){v.ULS.sendTraceTag(4310804,306,50,aj(b,k))}rjn(){this.Ojc.vln()}fc(){this.Hb&&0<this.i6f&&(this.ao=new nd.a(3,2,1E3*this.i6f,()=>{this.flush()},5),this.Hb.fc(this.ao),this.rwe=!0)}Ye(){this.rwe&&(this.Hb.Ye(this.ao),this.ao=null,this.rwe=!1)}}Mk.Y7e="EntriesAvailable";Object(m.a)(Mk,"ResourceTimingLogger",null,[465,504]);class Wf{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");
Yh.instance.run()}dispose(){}zc(b){this.W=b;let k=null;if(n.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{k=n.AFrameworkApplication.K.NB("ResourceLoggerDomainAllowList")}catch(R){v.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push(Oa.a.t2(ak.a.X7).toLowerCase());r.push(Oa.a.t2(ak.a.f0c).toLowerCase());const y=n.AFrameworkApplication.K.rc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(465,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Zd(()=>
new Mk(n.AFrameworkApplication.uc,window.performance,k,r,y))}static main(){M.a.instance.Pc(new Wf)}}Object(m.a)(Wf,"ResourceTimingPackage",null,[1,2]);var cg=c(243);class bl{constructor(){this.nhe={}}Y1j(b){this.nhe[b.id.toString()]=b}VOm(b){const k=this.nhe;for(let r in k)k[r].notify(b,!1);this.nhe={}}sen(b,k){k&&this.Y1j(k);return this.XAi(b,k)}N6e(b){this.VOm(b)}pEh(b,k){b.notify(k,!0)}}Object(m.a)(bl,"AEventEmitter",null,[499]);var tl;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]=
"waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(tl||(tl={}));Object(m.b)("EventResultState",tl);class ki{constructor(){this._state=0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:tl[this._state],["NewState"]:tl[b]},"ResultType",this.uZh());this._state=b}}Object(m.a)(ki,"AEventResult",null,[546]);class ul extends ki{constructor(){super();this.VIe=this.Mtc=null;this.state=0;this.Lte=this.zKg=!1}get dba(){return this.Mtc}get J3a(){return this.VIe}get a9l(){return this.zKg}uZh(){return"GetMoreInfo Result"}}
Object(m.a)(ul,"GetMoreInfoResult",ki,[547,546]);var Cf=c(1339),gm=c(1500),zd=c(1018);class dk{constructor(b,k,r,y,R,aa,ta,Ya){this.ga=b;this.rg=k;this.Dh=r;this.gxa=y;this.Hb=R;this.kA=aa;this.xHj=ta;this.jnd=Ya}Gmn(){this.m$b.pa(ib.a.yac,zc.a.frame,Object(u.a)(this,this.yac,"openUrlInNewTab"));this.m$b.pa(ib.a.NJf,zc.a.frame,Object(u.a)(this,this.NJf,"openDocumentUrl"));n.AFrameworkApplication.mea?this.roi():this.m$b.gb(ib.a.aAd,zc.a.frame,Object(u.a)(this,this.aAd,"documentLoaded"),96)}yac(b,k,
r,y,R){R&&R.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:R.SourceControlId,["AppType"]:zd.a[this.hOa]}),Qe.a.Gm(R.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}NJf(b,k,r,y,R){if(R&&R.MenuItemId){const aa=n.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=n.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
aa,ta);if(aa&&ta){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:R.SourceControlId,["AppType"]:zd.a[this.hOa]});b=R.MenuItemId.toString();const Ya={};Ya[H.a.gcc]="1";Ya[H.a.documentUrl]=b;Ya[H.a.reason]=gm.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");n.AFrameworkApplication.gQ().execute(xb=>{xb.sendMessage(E.a.Qyb,Ya)})}else this.yac(b,k,r,y,R)}return 32}aAd(){this.roi();return 32}MNa(b,k,r=""){if(k&&k.gH){const y=Cf.a[k.status];
k=k.gH.getTime();const R=this.vw()-k;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:y,["ElapsedMs"]:R,["StartTime"]:k,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}roi(){var b=n.AFrameworkApplication.K.$("QPGVCI"),k=Oa.a.fQ(document.URL,"wdNewAndOpenCt",b);if(k){k=parseInt(k);var r=Oa.a.fQ(document.URL,"wdPreviousSession",b);b=Oa.a.fQ(document.URL,
"wdPreviousCorrelation",b);var y=n.AFrameworkApplication.K.$("NAOPLP");if(n.AFrameworkApplication.mea){var R=n.AFrameworkApplication.mea.getTime();!k||k>R?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:k,["DocumentLoadedTime"]:R,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,y?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:R-k,["ClickTimestamp"]:k,
["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,y?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:k,["SessionId"]:r,["Correlation"]:b})}}get m$b(){return this.ga.value}get ESc(){return this.rg.value}get Bui(){return this.Dh.value}get hOa(){return this.gxa.value}get aWd(){return this.Hb.value}get vw(){return this.kA}get gOa(){return this.xHj.value}get M3a(){return this.jnd.value}static get instance(){return dk._instance||
(dk._instance=dk.nr())}static nr(){return new dk(new cg.a(()=>n.AFrameworkApplication.ya),new cg.a(()=>n.AFrameworkApplication.af),new cg.a(()=>n.AFrameworkApplication.ta),new cg.a(()=>n.AFrameworkApplication.ta.Rb.ko),new cg.a(()=>n.AFrameworkApplication.uc),()=>(new Date).getTime(),new cg.a(()=>n.AFrameworkApplication.ta.Rb.gOa),new cg.a(()=>n.AFrameworkApplication.M3a))}}dk._instance=null;Object(m.a)(dk,"NewAndOpenCommonHelpers",null,[498]);class Bj{constructor(b,k,r){this.Gld=this.ao=null;this.yFe=
0;this.AVj=b;this.Hb=k;this.uCg=r}Rak(){this.yFe=this.Ycc+1}QUf(b){this.ao&&(this.Hb.Ye(this.ao),this.ao=null);b&&(this.yFe=0)}y4n(b){const k=this.Dao;0<=k?(this.Rak(),this.QUf(!1),this.ao=new nd.a(4,1,k,b,107),this.Hb.fc(this.ao)):(this.QUf(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.uCg}))}get Ycc(){return this.yFe}get Dao(){return this.Ycc>=this.WYi.length?-1:this.WYi[this.Ycc]}get WYi(){if(!this.Gld){const b=(this.AVj.value||"0").split(",");this.Gld=[];for(let k=
0;k<b.length;k++){const r=parseInt(b[k]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.uCg,["Entry"]:b[k]}):Array.add(this.Gld,r)}}return this.Gld}}Object(m.a)(Bj,"RetryHelper",null,[]);class tj extends bl{constructor(b,k){super();this.uya=b;this.Puc=new Bj(k,this.oSc.aWd,"GetMoreInfo");this.Xp=new ul}ZFm(){this.uzf("Document opened")}NMk(b){return()=>{this.uzf(b,!0)}}XAi(b,k=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.Xp.state?(k&&this.pEh(k,this.Xp),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.uzf(b);return this.Xp}uzf(b,k=!1){this.Puc.QUf(!k);1===this.Xp.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Puc.Ycc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Puc.Ycc}),this.Xp.state=1,k=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.oSc.gOa,n.AFrameworkApplication.ym),this.oSc.ESc.oXb(k,1,null,null,[tj.bXg,tj.V2g],5,this.HLk(),this.GLk(b)))}HLk(){return b=>{var k=!1;let r=!1;var y=!1,R;n.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.Ie?({Iv:R}=x.d(b.data.Ie)).returnValue?R?(y=!0,this.Xp.VIe=R.StorageServiceDisplayName,this.Xp.Mtc=tj.nki(R.PersonalFileStorageUrl)?R.PersonalFileStorageUrl:"",""===this.Xp.dba&&"SharePointOnlineConsumer"===n.AFrameworkApplication.K.lb("FileSource")&&(this.Xp.Mtc=Oa.a.Mva(n.AFrameworkApplication.breadcrumbFolderUrl)),
k=""===this.Xp.dba&&""!==this.Xp.J3a):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));y||((R=b.data.qj)?(this.Xp.VIe=
(R[tj.V2g]||"").toString(),k=(R[tj.bXg]||"").toString(),this.Xp.Mtc=tj.nki(k)?k:"",""===this.Xp.dba&&"SharePointOnlineConsumer"===n.AFrameworkApplication.K.lb("FileSource")?(this.Xp.Mtc=Oa.a.Mva(n.AFrameworkApplication.breadcrumbFolderUrl),k=""===this.Xp.dba&&""!==this.Xp.J3a):k=""===k&&""!==this.Xp.J3a):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));y=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Puc.Ycc,r,k,y);this.oSc.MNa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,y);this.lZi(3,k,r)}}GLk(b){return k=>{this.oSc.MNa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",k.data,"Failure");this.lZi(2);this.Puc.y4n(this.NMk(b))}}lZi(b,k=!1,r=!1){this.Xp.state=b;this.Xp.zKg=k;this.Xp.Lte=r;this.N6e(this.Xp)}get oSc(){return this.uya.value}static get instance(){return tj._instance||(tj._instance=tj.nr())}static nr(){return new tj(new cg.a(()=>dk.instance),
new cg.a(()=>n.AFrameworkApplication.sBl))}static nki(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(A.a.mh(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}tj.bXg="PersonalFileStorageUrl";tj.V2g="StorageServiceDisplayName";tj._instance=null;Object(m.a)(tj,"GetMoreInfoActor",bl,[]);class mk{constructor(b,k,r,y,R){this.KIj=6E4;this.y8h="inactive";this.h8g="active";
this.CY=!0;this.Hb=b;this.GGj=k;this.kA=r;this.fod=y;this.sa=new Fe.a;R&&this.o4n();this.EOg=this.PUh()}cOe(b){this.sa.addHandler(this.h8g,b)}d5j(b){this.sa.addHandler(this.y8h,b)}o4n(){const b=new nd.a(5,2,this.KIj,Object(u.a)(this,this.l2l,"inactiveLoop"),108);this.m2l.fc(b)}l2l(){const b=this.PUh(),k=this.vw()-b;k>this.fbe&&this.CY&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:k}),this.CY=!1,this.sa.raiseEvent(this.y8h));b-this.EOg>this.fbe&&(this.CY=!0,
this.sa.raiseEvent(this.h8g));this.EOg=b}get m2l(){return this.Hb.value}get PUh(){return this.GGj}get vw(){return this.kA}get fbe(){return this.fod.value}static get instance(){return mk._instance||(mk._instance=mk.nr())}static nr(){return new mk(new cg.a(()=>Mg.a.instance),()=>n.AFrameworkApplication.hwf.getTime(),()=>(new Date).getTime(),new cg.a(()=>n.AFrameworkApplication.fbe),!0)}}mk._instance=null;Object(m.a)(mk,"InactivityManager",null,[]);var Tm=c(1603);class sm extends ki{constructor(){super();
this.qOj=this.GSg=this.FSg=null;this.state=this.y4g=0;this.Lte=!1}get tBf(){return this.FSg}get Rti(){return this.GSg}get Iao(){return this.y4g}uZh(){return"MruActor Result"}}Object(m.a)(sm,"MruResult",ki,[545,546]);class Xl{constructor(b,k,r){this.task=null;this.ICb=b;this.maxRetries=k;this.taskManager=r;this.retryCount=this.UMc=0;this.KDe=this.mQc=null}fkm(b,k){return b===Za.a.a2b||20===k||18===k||3===k}zlm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===
b||16===b||23===b||26===b||27===b||28===b}get P0d(){return this.KDe}reset(){this.UMc=this.retryCount=0;this.KDe=this.mQc=null;this.task&&(this.taskManager.Ye(this.task),this.task=null)}x6l(b,k,r,y){this.KDe=String.format("{0}_{1}",r,y);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.fkm(r,y))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.zlm(y)&&1<=this.UMc)return this.mQc=r,!1;k=
Math.max(k,this.ICb*Math.pow(2,this.UMc));if(26===y)k=Math.max(k,3E4);else if(27===y||28===y)k=Math.max(k,6E4);9===y||412===r&&(null==this.mQc||412!==this.mQc)?k=500:this.UMc+=1;this.mQc=r;this.retryCount+=1;this.task&&this.taskManager.Ye(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",k);this.task=new nd.a(2,1,k,b,107);this.taskManager.fc(this.task);return!0}}Object(m.a)(Xl,"RetryManager",null,[]);var ni=c(153);class uh{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(uh,"WriteOptions",null,[]);var yh=c(593);class ll extends bl{constructor(b,k,r,y,R,aa,ta){super();this.uya=b;this.gNj=k;this.E9a=new Xl(n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.eM.aWd);this.M$a=new Xl(n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.eM.aWd);this.tTj=r;this.n7g=y;this.W0j={};this.Sia=new sm;this.dGj=R;this.wgd="";this.XK=aa;this.pEg=ta;this.Njd="";this.xTj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get Wee(){return this.W0j}mqn(){this.eM.m$b.pa(ib.a.VQi,zc.a.frame,Object(u.a)(this,this.Xun,"renameMruEntry"))}Xun(){return this.wbg("Rename")}mGm(){this.Sqi("File Opened")}nGm(){this.Sqi("IntervalUpdate")}Sqi(b){v.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.wbg(b)}MLa(b){(b=A.a.MLa(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}CNh(){switch(this.eM.hOa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}sQl(b){var k=this.dGj();if(!k)return null;const r=new uh;r.documentUrl=this.pEg.value?encodeURI(k):k;r.mruItemId=this.wgd;r.app=this.CNh();if(k=this.XK())r.folderName=k.breadcrumbFolderName,
k=k.Hz,r.documentName=A.a.wI(k),r.documentExt=this.MLa(k);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(r)}wbg(b,k=!1){if(4===this.eM.hOa&&!n.AFrameworkApplication.EEc)return 2;var r=za.a.jF();r&&(r.set("Trigger",b),r.set("IsRetry",k?"true":"false"),r.set("MruIdSent",this.wgd?"true":"false"),
r.set("URLEncoded",this.pEg.value?"true":"false"));Ga.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.sQl(r);if(!b)return k=!n.AFrameworkApplication.oNb,r&&(r.set("WebEditingIsEnabled",n.AFrameworkApplication.oNb?"true":"false"),r.set("ProtectedFile",n.AFrameworkApplication.protectFile?"true":"false")),Ga.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",k,!1,Object.assign(new Xa.a,{extendedProperties:r})),2;this.M$a&&!k&&this.M$a.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.eM.gOa,this.Gxf);this.n7g?this.Wee["X-FileId"]=n.AFrameworkApplication.ym:r+=String.format("&{0}",n.AFrameworkApplication.ym);n.AFrameworkApplication.sessionStartInfoSettings&&(this.Wee["X-Office-AudienceGroup"]=Object(ia.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.Wee["X-Timeout"]=15E3;return this.eM.ESc.Mj(r,2,b,this.Wee,!0,5,Object(u.a)(this,this.$xo,"writeMruV2EntryOnServerSuccessCallback"),Object(u.a)(this,this.xQk,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}$xo(b){this.q4h(b.data)}q4h(b){const k=za.a.jF();this.M$a&&(k&&this.M$a.P0d&&(k.set("LastError",this.M$a.P0d),k.set("NumRetries",this.M$a.retryCount.toString())),this.M$a.reset());const r=Tm.c(b.Ie);r&&r.diagnostics_data&&(this.wgd=r.diagnostics_data.mru_id);b=+b.HS-+b.gH;k&&k.set("RequestDuration",b.toString());Ga.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Xa.a,{extendedProperties:k}))}xQk(b){if(b.data.Df===Za.a.kDc)this.q4h(b.data);else{var k=
b.data.Df===Za.a.zga,r=za.a.jF();this.y4h(this.M$a,b,this.fQk(),r);r&&(r.set("StatusCode",b.data.Df.toString()),k||this.sOe(b.data,r));Ga.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Df),k,!1,Object.assign(new Xa.a,{extendedProperties:r}))}}fQk(){return()=>{this.wbg("Retry",!0)}}ABl(){this.A9b("Polling")}zBl(){this.A9b("Retry",!0)}bGm(){this.A9b("Open")}aGm(){this.A9b("Activity")}$Fm(){this.A9b("OpenRecentLinks",!1,!0)}Lqi(){this.A9b("ActivityRecentLinks",!1,
!0)}A9b(b,k=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const y=za.a.jF();y&&(y.set("Trigger",b),y.set("IsRetry",k?"true":"false"),r&&y.set("RecentLinks","true"));Ga.Health.instance.recordKpiUsage("GetMru",0,"smartfio",y);this.E9a&&!k&&this.E9a.reset();r?this.gvh(Object(u.a)(this,this.BBl,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(u.a)(this,this.wBl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.gvh(Object(u.a)(this,this.CBl,"getMruV2FromServerSuccessCallback"),
Object(u.a)(this,this.yBl,"getMruFromServerFailureCallback"))}sOe(b,k){b&&b.qj&&(b=b.qj["X-CorrelationId"])&&k.set("ServerCorrelationId",b)}Szm(b,k){b&&(k&&k.set("RequestDuration",(+b.HS-+b.gH).toString()),Ga.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Xa.a,{extendedProperties:k})))}CBl(b){this.SVh(b)}SVh(b,k=!1){var r="";let y=null,R=null,aa=null;const ta=Tm.c(b.data.Ie);ta&&(y=ta.places?ta.places.items:[],R=ta.documents?ta.documents.items:[],(aa=Tm.a(ta,k))&&(r=x.c(aa)));n.AFrameworkApplication.ta&&
n.AFrameworkApplication.ta.Rb.fNa&&ni.c()&&(k?this.Njd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=za.a.jF();this.E9a&&(r&&this.E9a.P0d&&(r.set("LastError",this.E9a.P0d),r.set("NumRetries",this.E9a.retryCount.toString())),this.E9a.reset());k&&r&&r.set("RecentLinks","true");aa||y||R?(k?this.eM.MNa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.eM.MNa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.jde(3,aa,y,R),this.Szm(b.data,
r)):(k?this.eM.MNa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.eM.MNa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.sOe(b.data,r),Ga.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Xa.a,{extendedProperties:r})),this.jde(3,null,null,null,!0));this.N6e(this.Sia)}BBl(b){this.SVh(b,!0)}y4h(b,k,r,y){let R=0,aa=0;const ta=Tm.c(k.data.Ie);ta&&(null!=ta.response_code&&(R=ta.response_code,
y&&y.set("MruResponseCode",R.toString()),9===R&&(this.wgd="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(aa=ta.error_data.retry_after_ms,y&&y.set("ExpectedRetryAfter",aa.toString())));b&&(k=b.x6l(r,aa,k.data.Df,R),y&&(y.set("CurrentRetryCount",b.retryCount.toString()),y.set("RetryScheduled",k?"true":"false")))}yBl(b){this.RVh(b)}RVh(b,k=!1){const r=b.data.Df===Za.a.zga,y=za.a.jF();y&&(y.set("StatusCode",b.data.Df.toString()),k&&y.set("RecentLinks","true"),r||this.sOe(b.data,y));k?this.eM.MNa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.eM.MNa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.jde(2);this.y4h(this.E9a,b,Object(u.a)(this,this.zBl,"getMruFromServerRetryTask"),y);Ga.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Df),r,!1,Object.assign(new Xa.a,{extendedProperties:y}));this.N6e(this.Sia);n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa&&ni.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),k?this.Njd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}wBl(b){this.RVh(b,!0)}jde(b,k=null,r=null,y=null,R=!1){if(3!==this.Sia.state||3===b)this.Sia.FSg=k,this.Sia.GSg=r,this.Sia.qOj=y,this.Sia.state=b,this.Sia.Lte=R,this.Sia.y4g=this.eM.vw()}XAi(b,k){v.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Sia.state});k&&3===this.Sia.state&&this.pEh(k,this.Sia);return this.Sia}gvh(b,k,r=!1){this.jde(1);let y;const R={};y=r?String.format(this.eM.gOa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.xTj,"OfficeSuite",this.Gxf,"ClassicMru"):String.format(this.eM.gOa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.CNh(),this.Gxf);this.tTj.value||(y+="&entity=docs");n.AFrameworkApplication.sessionStartInfoSettings&&(R["X-Office-AudienceGroup"]=Object(ia.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(R["X-Office-Application"]="147");this.n7g?R["X-FileId"]=n.AFrameworkApplication.ym:y+=String.format("&{0}",n.AFrameworkApplication.ym);
this.eM.ESc.Mj(y,1,null,R,!0,5,b,k,null)}get eM(){return this.uya.value}get Gxf(){return this.gNj.value}static get instance(){return ll._instance||(ll._instance=ll.nr())}static nr(){return new ll(new cg.a(()=>dk.instance),new cg.a(()=>yh.a.qg(n.AFrameworkApplication.lcid).name),new cg.a(()=>n.AFrameworkApplication.ta.Rb.NA),n.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>n.AFrameworkApplication.ta.Rb.Pda,()=>n.AFrameworkApplication.Gt,new cg.a(()=>n.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
ll._instance=null;Object(m.a)(ll,"MruActor",bl,[]);class dn{constructor(){this.pxc=this.yYg=this.W=null;this.Ih=!1}get name(){return"Common.App.NewAndOpen.Core"}zc(b){this.W=b;b.register(498,"Common.INewAndOpenCommonHelpers").singleInstance().Zd(()=>dk.instance);b.register(499,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Zd(()=>tj.instance);b.register(499,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Zd(()=>ll.instance)}init(){n.AFrameworkApplication.K.gq(()=>
{this.TZa()})}TZa(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;dk.instance.Gmn();n.AFrameworkApplication.jDa&&(b=!0);n.AFrameworkApplication.CQf&&(ll.instance.bGm(),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&ll.instance.$Fm(),0<n.AFrameworkApplication.Sti&&this.v9g(),this.DTn(),b=!0);n.AFrameworkApplication.M3a&&
b&&tj.instance.ZFm();n.AFrameworkApplication.cno&&(b=ll.instance,b.mqn(),b.mGm(),Mg.a.instance.fc(this.dno))}DTn(){mk.instance.cOe(Object(u.a)(ll.instance,ll.instance.aGm,"makeGetMruRequestActivityTrigger"));n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&mk.instance.cOe(Object(u.a)(ll.instance,ll.instance.Lqi,"makeGetMruForRecentLinksRequestActivityTrigger"));mk.instance.cOe(Object(u.a)(this,this.v9g,"addGetMruFromServerTask"));mk.instance.d5j(Object(u.a)(this,
this.AUk,"deleteGetMruFromServerTask"))}AUk(){Mg.a.instance.Ye(this.Tti)}v9g(){Mg.a.instance.fc(this.Tti)}get Tti(){return this.yYg||(this.yYg=new nd.a(5,2,n.AFrameworkApplication.Sti,Object(u.a)(ll.instance,ll.instance.ABl,"getMruFromServerTask"),109))}get dno(){return this.pxc||(this.pxc=new nd.a(2,2,6E4*n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(u.a)(ll.instance,ll.instance.nGm,"makeUpdateMruTask"),197))}dispose(){this.Ih||
(this.Ih=!0,this.pxc&&(Mg.a.instance.Ye(this.pxc),this.pxc=null))}}Object(m.a)(dn,"CorePackageManager",null,[1,2,10]);var Gl=c(1497),Ol=c(108);class Bg{static o3k(b){return Bg.fjh("New",b)}static p3k(b){return Bg.fjh("Open",b)}static Kih(b,k){return Bg.hWa("LoadingMenuSection",Bg.Axm,b,Bg.bAc("lblLoading",k))}static cAc(b,k,r=null,y=null){return Bg.hWa("MessageMenuSection",Bg.Qti,k,Bg.bAc("lblMessage",b,r,y))}static Wnk(b){return Bg.Kih(b,CommonUIStrings.l_VoicedLoadingText)}static Xnk(b,k){return Bg.cAc(CommonUIStrings.l_NewCreationLocationMessage,
b.labelText,k.dba,k.J3a)}static Vnk(b,k){return Bg.cAc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,k.J3a,"\n\n"),b.labelText)}static Oih(b){return Bg.cAc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static Tnk(b,k,r){return Bg.hWa("menuNewBlank",Bg.fZl,r?b.labelText:null,Bg.Zzc(b.Y5h,b.Z5h,b.$5h,null,b.HZa,b.JLc,k,"blank"))}static Zok(){return Bg.bAc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static djh(){return Bg.bAc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static $ok(b,
k){return Bg.hWa("menuNewTemplates",b,null,k)}static Rnk(b,k){return Bg.hWa("menuNewMoreTemplates",Bg.cLh,null,Bg.Zzc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,k))}static rmk(b,k,r){let y="";r&&k&&(y=Bg.hWa("BrowseMoreMenuSection",Bg.cLh,null,Bg.Zzc("btnBrowseMore",k,k,null,null,null,b||"1959943459",r)));return y}static bAc(b,k,r=null,y=null){let R=y;k&&0<k.length&&(R=Bg.Mui.N1a(k).trimEnd(),R=0<=R.indexOf("{0}")?String.format(R,
y):String.format("{0} {1}",R,y));r=r&&y?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',A.a.Ff(r),A.a.Ff(y),A.a.Ff(R)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',A.a.Ff(b||""),Bg.Mui.N1a(A.a.Ff(k||"")),r)}static Zzc(b,k,r,y,R,aa,ta,Ya){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
A.a.Ff(b||""),A.a.Ff(k||""),A.a.Ff(r||""),y||"32by32",A.a.Ff(R||""),A.a.Ff(aa||""),ta,A.a.Ff(Ya||""))}static fjh(b,k){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,k)}static hWa(b,k,r,y){r=r?String.format('Title="{0}"',A.a.Ff(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
A.a.Ff(b||""),A.a.Ff(k||""),r,y)}}Bg.Qti="MenuMru";Bg.Axm="MenuLoading";Bg.fZl="MenuHeader";Bg.cLh="MenuFooter";Bg.Mui=Ol.a.zB("\n","&#10;");Object(m.a)(Bg,"NewAndOpenXmlUtilities",null,[]);class Ak{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(m.a)(Ak,"HostInformation",null,[]);class ek{constructor(b,k,r,y,R,aa){this.XJe=this.$v=this.E7c=null;this.nmd=this.PHe=!1;this.RRg=0;this.tHe=this.Eve=!1;this.uya=b;this.Gnc=k;this.JSa=new cg.a(()=>new Gl.a(r.value,Object(u.a)(this,
this.aBb,"getMoreInfoEventReceived")));this.oOj=y;this.R8a=R;this.JWj=aa;this.Pvc=this.A8d;2===this.g7.hOa&&(this.tHe=!0)}get Cda(){switch(this.g7.hOa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Vb(){const b=this.g7.m$b;b.pa(ib.a.newDocument,zc.a.frame,Object(u.a)(this,this.newDocument,"newDocument"));b.gb(ib.a.r0d,zc.a.frame,Object(u.a)(this,this.r0d,"populateNewMenu"),96)}newDocument(b,k,r,y,R){if(1===r)return 32;if(2===r&&R){if(n.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&
R.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),n.AFrameworkApplication.ya.processAction(ib.a.L9m,2);if(R.MenuItemId&&R.SourceControlId)return"NewDocumentHome"===R.SourceControlId&&Ib.a("NewDocumentFromHomeTab"),this.ZCc(R.MenuItemId,R.SourceControlId)}return 8}ZCc(b,k){var r=this.eWd.Mvh;if(null===r)return 8;var y=n.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(n.AFrameworkApplication.wEb&&y){v.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const R={};R[H.a.template]=b;R[H.a.Cda]=this.Cda;R[H.a.lcid]=n.AFrameworkApplication.lcid.toString();R[H.a.reason]=gm.a.P0e;n.AFrameworkApplication.gQ().execute(aa=>{aa.sendMessage(E.a.ZCc,R)})}else y=(new Date).getTime(),k=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,A.a.Jj(this.jDa),A.a.Jj(b),A.a.Jj(this.Cda),A.a.Jj(n.AFrameworkApplication.lcid.toString()),
A.a.Jj(y.toString()),A.a.Jj(k),A.a.Jj(n.AFrameworkApplication.canary),n.AFrameworkApplication.ym),(r=n.AFrameworkApplication.K.lb("ScenarioId"))&&""!==r&&(k+="&wdscenarioid="+A.a.Jj(r)),k+="&"+n.AFrameworkApplication.mId(),n.AFrameworkApplication.O_a&&(k+="&"+n.AFrameworkApplication.UGd()),(r=this.$v?this.$v.dba:null)&&(k+="&DestinationUrl="+A.a.Jj(r)),Qe.a.Gm(k,"_blank",void 0,"CreateNewDocument");2===this.g7.hOa&&v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:zd.a[this.g7.hOa],
["Template"]:b});return 32}PDm(b){let k=Number.MAX_VALUE,r=Number.MIN_VALUE;const y=window.performance;if(y&&"undefined"!==typeof y.getEntriesByName){for(let aa=0;aa<b.length;aa++){var R=y.getEntriesByName(b[aa]);R&&0<R.length&&(R=R[0],k=Math.min(parseInt(String(R.fetchStart)),k),r=Math.max(parseInt(String(R.responseEnd)),r))}r>k&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-k,["MinFetchStart"]:k,["MaxResponseEnd"]:r})}}r0d(b,k,r,y,R){if(1===
r)return this.tHe&&(n.AFrameworkApplication.Gaa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.tHe=!1),32;2!==r||this.Eve||(this.RRg=(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.A8d,["CachedNewMenuXmlExists"]:!!this.E7c,["ShouldCallGetMoreInfo"]:this.g7.M3a}));return this.x8m(R)}x8m(b){b&&(this.E7c?b.PopulationXML=this.E7c:(this.g7.M3a&&!this.$v&&this.xNm.fk("Opened New menu",!0),b.PopulationXML=
this.Shl(this.getTemplateListJson())));return 32}Khi(){return!this.g7.M3a||!!this.$v&&3===this.$v.state&&!!this.$v.J3a&&!!this.$v.dba}alm(){return n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa?!0:this.Khi()}getTemplateListJson(){if(!this.A8d||!this.alm())return null;if(this.Pvc&&!this.nmd){var b="9";const k=n.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in k&&(b=k.NumberOfTemplatesInBackstage);let r=this.Cda;"TemplateCollectionId"in k&&(r=k.TemplateCollectionId);
b=String.format(this.g7.gOa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",A.a.Jj(n.AFrameworkApplication.lcid.toString()),A.a.Jj(r),b);Boolean.parse(k.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(k.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in k&&(b+="&templateTier="+k.TemplateTier);b+="&"+n.AFrameworkApplication.mId();n.AFrameworkApplication.O_a&&(b+="&"+n.AFrameworkApplication.UGd());this.g7.ESc.Mj(b,1,null,null,!1,2,y=>{this.g7.MNa("CreateNewActor.GetTemplateListJson",
y.data);this.b$n(y.data.Ie)},y=>{this.g7.MNa("CreateNewActor.GetTemplateListJson",y.data);this.a$n()},null,void 0,void 0,void 0,void 0,"5");this.Pvc=!1}return this.XJe}b$n(b){this.XJe=b;this.Pvc=!1;this.pXc();if(n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa&&ni.c()){b=n.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const k=n.AFrameworkApplication.wEb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.XJe,!0,b&&k))}}a$n(){this.nmd=
this.Pvc=!0;this.pXc();n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa&&ni.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Ga.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}gjf(b){var k=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){k=r;break}const y=b.length?b[k]:null;b=y?y.Url||"":"";var R;let aa=r=k=!1;if(y&&(R=y.AspectRatio))R=parseFloat(R),1>R?k=!0:1.5<R?r=!0:1===R&&(aa=!0);else switch(v.ULS.sendTraceTag(5849603,
202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.g7.hOa){case 3:k=!0;break;case 2:r=!0;break;case 5:aa=!0}return{returnValue:b,T1l:k?"95by123":r?"123by69":aa?"100by100":"123by95"}}Shl(b){b=({l8d:k}=this.Unk(b,this.eWd,this.eWd.fAc||"1056925771")).returnValue;if(k){this.E7c=b;var k=(new Date).getTime()-this.RRg;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:k})}return b}aBb(b,k){v.ULS.sendTraceTag(590964757,202,
50,"GetMoreInfoEventReceived");this.$v||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.PHe=!0,this.pXc()):(this.$v=b,k||this.pXc(),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa&&ni.c()&&ni.d("setFileMenuHostInformation")&&(b=Object.assign(new Ak,{hostUrl:this.$v.dba,hostName:this.$v.J3a,folderUrl:n.AFrameworkApplication.breadcrumbFolderUrl,folderName:n.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,
202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}Unk(b,k,r){let y;y=!1;const R=this.Khi();let aa="";this.g7.M3a&&(this.PHe?(aa=Bg.Oih(k),this.PHe=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.$v?R?aa=Bg.Xnk(k,this.$v):this.$v.a9l?(y=!0,this.Pvc=!1,aa=Bg.Vnk(k,this.$v),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(y=!0,aa=Bg.Oih(k),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.$v.dba,["StorageServiceDisplayNameIsSet"]:!!this.$v.J3a})):(aa=Bg.Wnk(k.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));R&&(aa+=Bg.Tnk(k,r,!aa)+({l8d:y}=this.Yok(b,r)).returnValue);return{returnValue:Bg.o3k(aa),l8d:y}}Yok(b,k){let r;r=!1;if(!this.A8d)return r=!0,v.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",l8d:r};let y="",R="",aa="MenuTemplate";if(this.nmd)y=Bg.djh(),this.nmd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);y=this.Xok(ta,k);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");n.AFrameworkApplication.Nui&&"OneDrive"===this.jDa&&(R=Bg.Rnk(this.yNm,n.AFrameworkApplication.Nui))}catch(ta){v.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),y=Bg.djh()}r=!0}else aa="MenuLoading",y=Bg.Zok(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Bg.$ok(aa,y)+R,l8d:r}}Xok(b,k){let r="";const y=[];for(let aa=0;aa<b.length;aa++){var R=b[aa];let ta="";if(R){const Ya=R.Title,xb=R.AssetId;R=R.Thumbnails;xb&&Ya&&R&&({T1l:R,returnValue:ta}=this.gjf(R),r+=Bg.Zzc("jbtnNewTemplate"+aa,Ya,null,R,null,ta,k,xb))}y[aa]=
ta}b=new nd.a(4,1,5E3,()=>{this.PDm(y)},106);this.g7.aWd.fc(b);return r}pXc(){this.Eve=!0;this.g7.Bui.EFa(this.eWd.MGc);this.Eve=!1}get g7(){return this.uya.value}get eWd(){return this.Gnc.value}get xNm(){return this.JSa.value}get yNm(){return this.oOj.value}get jDa(){return this.R8a.value}get A8d(){return this.JWj.value}}Object(m.a)(ek,"CreateNewActor",null,[]);class tg{constructor(){this._initialized=!1;this.ZIe={}}nE(b){this.UFh();return this.get(b)}contains(b){this.UFh();return b.toString()in
this.ZIe}UFh(){this._initialized||(this.O6j(),this._initialized=!0)}Y$a(b,k){this.ZIe[b.toString()]=k}get(b){return this.ZIe[b.toString()]}}Object(m.a)(tg,"AIntlHelper",null,[]);class Be extends tg{constructor(){super()}O6j(){this.Y$a(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Y$a(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Y$a(2,CommonUIStrings.l_Open);this.Y$a(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Y$a(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Y$a(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Be._instance||
(Be._instance=new Be)}static v1m(b){return Be.instance.nE(b)}}Be._instance=null;Object(m.a)(Be,"MruActorIntlHelper",tg,[]);var ai;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(ai||(ai={}));Object(m.b)("DisplayState",ai);class Zd{constructor(b,k,r,y,R,aa,ta,Ya){this.Dje=null;this.KMe=!0;this.D7c="";this.DZj=0;this.DSb=null;this.nxe=3;this.Oa=Ya;this.uya=b;this.cra=k;this.QEj=r;this.izj=y;this.hzj=R;this.JSa=new cg.a(()=>new Gl.a(aa.value,
null));this.JGj=new cg.a(()=>new Gl.a(ta.value,Object(u.a)(this,this.tMm,"mruEventResultReceived")));this.Oa.$("WacInTabOpenMRUIsEnabledForUiHost");this.Oa.$("UiHostSupportsDocRebootFeatures")}tMm(b,k){this.DSb=b;k||this.YMi()}qpn(){this.eM.m$b.gb(ib.a.EMf,zc.a.frame,Object(u.a)(this,this.EMf,"populateMruMenu"),96)}EMf(b,k,r,y,R){return 1!==r&&R?this.w8m(R):32}w8m(b){this.W3k();this.V3k();b.PopulationXML=Bg.p3k(this.D7c+this.Dje);return 32}W3k(){var b=3;let k=!1;if(this.D7c&&this.DZj===this.DSb.Iao)v.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.nxe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.eM.vw();this.DSb=this.sMm.fk("File Open opened",!0);this.D7c&&2!==this.nxe&&3!==this.DSb.state?k=!0:(b=this.AKl(this.DSb),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.fNa&&ni.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,
!0)),this.D7c=({pNm:b}=this.Thl(this.DSb)).returnValue);r=this.eM.vw()-r;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:ai[b]},1!==b&&(r.IsStale=k),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.nxe=b}AKl(b){let k;try{k=x.c(b.tBf)}catch(r){k=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
r)}return k}V3k(){this.KMe?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Dje=({Sto:this.KMe}=this.WFm()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.KMe,["NotDisplayingLink"]:!this.Dje})}Thl(b){let k;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),
b=2,k=Bg.Kih(this.gZa(2),this.gZa(5))):3===b.state&&b.tBf?(k=this.Snk(b.tBf),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),k=Bg.cAc(this.gZa(1),this.gZa(2)),b=1);return{returnValue:k,pNm:b}}Snk(b){let k;const r=this.cSc.fAc||"2155708348";if(b.length){k=Bg.bAc("lblRecentDocuments",this.gZa(3));let y=0;for(let R=0;R<b.length;R++){const aa=b[R];"FileName"in aa&&"DocumentUrl"in aa&&"Path"in aa&&(k+=Bg.Zzc("MruButton"+R,aa.FileName.toString(),aa.Path.toString(),
null,this.cSc.HZa,this.cSc.JLc,r,aa.DocumentUrl.toString()),aa.IsPinned&&y++)}k=Bg.hWa("RecentDocumentsMenuSection",Bg.Qti,this.gZa(2),k);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:y})}else k=Bg.cAc(this.gZa(0),this.gZa(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return k}WFm(){let b;b=!0;let k=this.Hlk;var r=this.Glk;if(k&&r||!this.eM.M3a)b=!1;else{const y=this.ZGd.fk("File Open",
!1);3===y.state&&(k=y.dba,r=y.J3a,b=!1)}r=r?String.format(this.gZa(4),r):null;return{returnValue:Bg.rmk(this.cSc.fAc,r,k),Sto:b}}YMi(){this.eM.Bui.EFa(this.cSc.MGc)}get eM(){return this.uya.value}get gZa(){return this.cra.value}get cSc(){return this.QEj.value}get Hlk(){return this.izj.value}get Glk(){return this.hzj.value}get ZGd(){return this.JSa.value}get sMm(){return this.JGj.value}}Object(m.a)(Zd,"MruRenderer",null,[]);var Hf=c(1501);class Mi{constructor(b,k,r,y,R,aa,ta){this.$v=null;this.Y_g=
!1;this.Xpa=this.u0=0;this.DOj=b;this.cTb=k;this.Cgd=r;this.Gnc=y;this.R8a=R;this.uya=aa;this.JSa=new cg.a(()=>new Gl.a(ta.value,Object(u.a)(this,this.aBb,"getMoreInfoEventReceived")))}ZCc(){!this.$v&&this.XDf.M3a?this.ZGd.fk("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}aBb(b){if(!this.$v&&3===b.state)this.$v=b;else if(2===b.state){this.Y_g?v.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.ZGd.fk("NewDocumentFromStream",!0),this.Y_g=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.u0=
(new Date).getTime();var b=this.G9k.Mvh;if(null===b)this.cTb(null);else{var k=this.Cgd.menuItemId,r=this.Cgd.MEa,y=this.Cgd.W5n,R=this.Cgd.O9k;this.Xpa="streamBase64"===y?R.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.Cda,this.Xpa);var aa=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,A.a.Jj(this.jDa),A.a.Jj(k),A.a.Jj(this.Cda),A.a.Jj(n.AFrameworkApplication.lcid.toString()),
A.a.Jj(aa.toString()),A.a.Jj(r),A.a.Jj(n.AFrameworkApplication.canary),n.AFrameworkApplication.ym,A.a.Jj(y));b+="&"+n.AFrameworkApplication.mId();n.AFrameworkApplication.O_a&&(b+="&"+n.AFrameworkApplication.UGd());(k=this.$v?this.$v.dba:null)&&(b+="&DestinationUrl="+A.a.Jj(k));this.XDf.ESc.Mj(b,2,R,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(u.a)(this,this.sNm,"newDocumentFromStreamSuccessHandler"),Object(u.a)(this,this.rNm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,
void 0,void 0,"31")}}sNm(b){if(b&&b.data&&b.data.Ie)if(({Iv:k}=x.d(b.data.Ie)).returnValue)if(b=k,b.StatusCode!==Za.a.yD&&b.StatusCode!==Za.a.kDc)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.Cda,this.Xpa,b.StatusCode),this.cTb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var k=(new Date).getTime()-this.u0;v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.Cda,this.Xpa,k);this.DOj(b.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.Cda,this.Xpa),this.cTb(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.Cda,this.Xpa,{["ResponseData"]:Hf.a.b3c(b.data.Ie)}),this.cTb(null);else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.Cda,
this.Xpa),this.cTb(null)}rNm(b){b&&b.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.Cda,this.Xpa,b.data.status);this.cTb(null)}get Cda(){switch(this.XDf.hOa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get G9k(){return this.Gnc.value}get jDa(){return this.R8a.value}get XDf(){return this.uya.value}get ZGd(){return this.JSa.value}}Object(m.a)(Mi,"NewDocumentFromStreamOperation",
null,[]);class de{constructor(b,k,r,y){this.Gnc=b;this.R8a=k;this.uya=r;this.IGj=y}create(b,k,r){return new Mi(b,k,r,this.Gnc,this.R8a,this.uya,this.IGj)}}Object(m.a)(de,"NewDocumentFromStreamOperationFactory",null,[528]);var Fj=c(124);class kf{get name(){return"Common.App.NewAndOpen.UX"}zc(b){b.register(de,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Zd(()=>new de(new cg.a(()=>n.AFrameworkApplication.ta.Rb.uef()),
new cg.a(()=>n.AFrameworkApplication.jDa),new cg.a(()=>b.Pa("Common.INewAndOpenCommonHelpers")),new cg.a(()=>b.Pa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){n.AFrameworkApplication.K.gq(()=>{this.TZa()})}TZa(){const b=Jg.a.Lq(Va.a.instance.$a("Common.INewAndOpenCommonHelpers")),k=Jg.a.Lq(Va.a.instance.$a("Common.IEventEmitter<Common.IGetMoreInfoResult>"));n.AFrameworkApplication.jDa&&Fj.Task.WAA.call(null,b,k).continueWith(()=>{const r=new ek(new cg.a(()=>b.result),new cg.a(()=>
n.AFrameworkApplication.ta.Rb.uef()),new cg.a(()=>k.result),new cg.a(()=>n.AFrameworkApplication.ta.Rb.vef().fAc||"1959943459"),new cg.a(()=>n.AFrameworkApplication.jDa),new cg.a(()=>n.AFrameworkApplication.Eim));r.Vb();r.pXc()});if(n.AFrameworkApplication.CQf){const r=Jg.a.Lq(Va.a.instance.$a("Common.IEventEmitter<Common.IMruResult>"));Fj.Task.WAA.call(null,b,k,r).continueWith(()=>{const y=new Zd(new cg.a(()=>b.result),new cg.a(()=>Be.v1m),new cg.a(()=>n.AFrameworkApplication.ta.Rb.vef()),new cg.a(()=>
n.AFrameworkApplication.u1m),new cg.a(()=>n.AFrameworkApplication.t1m),new cg.a(()=>k.result),new cg.a(()=>r.result),n.AFrameworkApplication.K);y.qpn();y.YMi()})}}dispose(){}}Object(m.a)(kf,"UXPackageManager",null,[1,2,10]);var cf=c(142);class kc extends cf.StandardDialog{constructor(){super();this.Gd=0;this.We(1,CommonUIStrings.l_DialogClose)}XS(b){this.my(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}o5e(b){this.my(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null,!0)}}Object(m.a)(kc,"ErrorDialog",cf.StandardDialog,[515]);var zh=c(433);class Bf{xNh(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new zh.a;b.Eg("api.onedrive.com");return b.task}}Object(m.a)(Bf,"OneDriveConsumerEndpointHelper",null,[463]);var si=c(42);class ag{constructor(b,k,r,y){this.gsb=this.nDa=null;this.fHe=this.hHe=!1;this.qTb=null;this.Oa=b;this.X6c=k;this.qrb=r;this.vG=y}get Lch(){return this.X6c}get K(){return this.Oa}x3b(){this.qTb||(this.qTb=this.wac?
Hb.a.create(this.wac,null,null,null,!1):null);return this.qTb}setup(b){this.gsb=b;this.hHe||this.fHe?this.hHe&&this.gsb&&this.gsb(!0):(b=this.x3b())?(this.fHe=!0,b.x0a.continueWith(k=>{this.fXm(k)}),Zb.a.cT(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.gsb(!1))}IHf(b){v.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}fXm(b){this.fHe=!1;if(b.Ki)this.IHf(b),
this.gsb(!1);else try{this.hHe=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Nnf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.gsb(!0)}catch(k){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",k.toString()),this.gsb(!1)}}r1c(b){this.nDa=b;this.qrb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(u.a)(this,
this.MFf,"onApiReady")))}MFf(b){b?this.YRd():this.Bp()}Bp(){this.vG().XS(si.a.I0m)}onSuccess(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.nDa&&this.nDa(!0,b)}dispose(){this.qTb&&this.qTb.dispose()}}Object(m.a)(ag,"AOneDriveFilePickerApiManager",null,[534,10]);class Xg extends ag{constructor(b,k,r,y,R,aa){super(k,r,y,aa);this.Mm=null;this.Zqa=b;this.RWj=R}get wac(){return this.K.lb("OneDriveApiUrl")}start(b,k){this.Mm=b;this.r1c(k)}Nnf(){WL.init(1===
this.Lch||2===this.Lch?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}r1c(b){this.nDa=b;!this.qrb&&this.Zqa.fNc?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(u.a)(this,this.MFf,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.RWj())}YRd(){try{v.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.Mm).then(Object(u.a)(this,this.onSuccess,"onSuccess"),Object(u.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Bp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,b.error.message)}else v.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.nDa&&this.nDa(!1,b);this.Bp()}}Object(m.a)(Xg,"OneDriveFilePickerApiManagerV5",ag,[]);class Mf extends ag{constructor(b,k,r,y,R){super(b,k,r,y);this.Ubd=this.eVg=null;this.aEj=R;this.options={};this.options.clientId=this.K.lb("OneDriveApiV7ClientId");this.options.cancel=Object(u.a)(this,this.qbe,"toggleHostDivVisibility")}get wac(){return this.K.lb("OneDriveApiV72Url")}start(b,k){this.Ubd=k;const r=this.aEj.xNh();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.eVg=r.result;this.r1c((y,R)=>{this.qbe();b(y,R)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.exception.message);this.qbe()},5)}Nnf(){this.options.success=b=>{const k={};k.data=b;this.onSuccess(k)};this.options.error=b=>{const k={};k.error=b;this.onFailure(k)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.eVg;this.options.advanced.iframeParentDiv=
this.Ubd}YRd(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.qbe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Bp()}}onFailure(b){this.nDa&&this.nDa(!1,b);this.Bp()}qbe(){this.Ubd.style.visibility="hidden"===this.Ubd.style.visibility?"":"hidden"}}Object(m.a)(Mf,"OneDriveFilePickerApiManagerV7",ag,[]);class li extends ag{constructor(b,k,r,y){super(b,k,r,y);this.zxj=
b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.lb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get wac(){return this.K.lb("OneDriveApiV72Url")}start(b,k,r,y){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=y;this.options.cancel=k;this.zxj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.r1c(b)}r1c(b){this.nDa=b;this.qrb?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(u.a)(this,this.MFf,"onApiReady")))}Nnf(){this.options.success=b=>{const k={};k.data=b;this.onSuccess(k)};this.options.error=b=>{const k={};k.error=b;this.onFailure(k)}}YRd(){try{v.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Bp()}}IHf(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Zb.a.atn(this.wac);this.qTb=null}Bp(){this.vG().o5e(si.a.ODn)}onFailure(b){this.nDa&&this.nDa(!1,b)}}Object(m.a)(li,"OneDriveFilePickerApiManagerV72",
ag,[]);class Kh{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(Kh,"IExtraData",null,[]);class Gj extends li{constructor(b,k,r,y){super(b,k,r,y);this.options.advanced.filter=b.lb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=n.AFrameworkApplication.Xch;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.lb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Kh(n.AFrameworkApplication.userSessionId))}get wac(){return this.K.lb("OneDriveApiV72Url")}YRd(){try{v.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",n.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Bp()}}}Object(m.a)(Gj,"OneDriveFilePickerApiOpenManagerV72",li,[]);class Hi{constructor(b){this.Vo=null;this.rg=b;this.wFe=3}xNh(){this.Vo=new zh.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.nXf();return this.Vo.task}nXf(b=null){const k=String.format("GetMoreInfoHandler.ashx?{0}",n.AFrameworkApplication.eyb);this.rg.oXb(k,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(u.a)(this,this.tBl,"getMoreInfoSucceeded"),Object(u.a)(this,this.rBl,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}rBl(b){if(b.data.Df===Za.a.zga&&"X-NewKey"in b.data.qj){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const k={};k["X-Key"]=b.data.qj["X-NewKey"];this.nXf(k)}else 0<this.wFe?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.wFe),this.wFe--,this.nXf()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Vo.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}tBl(b){"PersonalFileStorageUrl"in b.data.qj&&""!==b.data.qj.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Vo.Eg(b.data.qj.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Vo.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(Hi,"OneDriveForBusinessEndpointHelper",null,[463]);var ch=c(745);class hm{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}zc(b){this.W=b;this.W.register(Xg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Zd(()=>new Xg(ch.a.instance,n.AFrameworkApplication.K,
n.AFrameworkApplication.bla,n.AFrameworkApplication.Wma,n.AFrameworkApplication.y1f,()=>new kc));n.AFrameworkApplication.V7b?this.W.register(463,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Zd(()=>new Bf):this.W.register(463,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Zd(()=>new Hi(n.AFrameworkApplication.af));this.W.register(Mf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Zd(()=>new Mf(n.AFrameworkApplication.K,
n.AFrameworkApplication.bla,n.AFrameworkApplication.Wma,()=>new kc,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(li,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Zd(()=>new li(n.AFrameworkApplication.K,n.AFrameworkApplication.bla,n.AFrameworkApplication.Wma,()=>new kc));this.W.register(Gj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Zd(()=>new Gj(n.AFrameworkApplication.K,
n.AFrameworkApplication.bla,n.AFrameworkApplication.Wma,()=>new kc))}static main(){M.a.instance.Pc(new hm)}}Object(m.a)(hm,"PackageManager",null,[1,2]);class Wk{constructor(b,k,r,y,R,aa){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=k;this.PolicyCookie=r;this.PolicyCookieTTL=y;this.WasServiceDown=R;this.AffinitizedUrl=aa}}Object(m.a)(Wk,"SafeLinksData",null,
[]);class Pl{constructor(b,k){this.Gae=b;this.jx=k}}Object(m.a)(Pl,"SafeLinksGetUrlReputationRequestData",null,[]);class oh{constructor(b,k,r,y){this.Oa=b;this.rg=k;this.aHj=r;oh.me=y}ohc(b,k,r){try{var y=null;oh.me&&(y=oh.me.jg("WebServiceCall","SafeLinksGetUrlReputation"));const R=new Pl(k,y);y={};y.AffinitizedUrl=b;y.TargetUrl=k;y.PolicyCookie=r;const aa=x.c(y);this.rg.Mj(this.aHj,2,aa,null,!1,2,Object(u.a)(this,this.cVm,"onGetUrlReputationSuccessCallback"),Object(u.a)(this,this.bVm,"onGetUrlReputationFailureCallback"),
R,void 0,void 0,3E3,3E3,"36");return!0}catch(R){v.ULS.sendTraceTag(588788033,378,10,R.message)}return!1}cVm(b){let k="OnGetUrlReputationSuccessCallback: ",r=10;const y=b.data.state;try{const R=x.b(b.data.Ie).reputationResults[0],aa=R.navigateUrl.length,ta=y.Gae.length,Ya=R.navigateUrl===y.Gae;R.navigateUrl&&0<R.navigateUrl.length&&(y.Gae=R.navigateUrl);k+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Df,R.verdict,
ta.toString(),aa.toString(),Ya.toString());r=50}catch(R){k+=String.format("Exception {0}",R.message)}this.l4h(y,k,r)}bVm(b){let k="OnGetUrlReputationFailureCallback: ";const r=b.data.state;try{k+=String.format("HttpStatus {0}",b.data.Df)}catch(y){k+=String.format("Exception {0}",y.message)}this.l4h(r,k,10)}l4h(b,k,r){b.jx&&(b.jx.stop(),b.jx=null);v.ULS.sendTraceTag(588788034,378,r,k);Qe.a.Gm(b.Gae,void 0,"noopener,noreferrer","SafeLinksNav")}}oh.me=null;Object(m.a)(oh,"SafeLinksNavigationHelper",
null,[]);var Pi;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Pi||(Pi={}));Object(m.b)("SafeLinksNavigationState",Pi);class Qd{constructor(b,k,r,y=!1,R=null,aa=null){this.aqb=this.$pb=0;this.VNc=this.mbd=!1;this.l9a=null;this.lSb=!0;this.Hld=null;v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Oa=b;this.rg=k;this.Nnb=r;Qd.me=aa;this.E0j=y?this.Oa.lb("SafeLinksHandlerWebServiceBase"):this.Oa.lb("WebServiceBase");this.X_j=this.Oa.lb("SafeLinksHashedUserId");this.Pxo=this.Oa.lb("SafeLinksWorkloadIdHeaderValue");this.Sfd=this.Oa.rc("SafeLinksMaxGetPolicyBootRetries",2);this.Tfd=this.Oa.rc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Hdd=this.Nlm();this.Gdd=this.Mlm();v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Hdd,this.Gdd);
if(this.Hdd&&this.Gdd){k=(b=this.v2b())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.ftf();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",k,r);var ta=!b||"unknown"===k||b.WasServiceDown||r,Ya=za.a.jF();Ya&&(Ya.set("shouldGetSafeLinksDataFromServer",ta.toString()),Ya.set("isSafeLinksEnabledCacheValue",k.toString()));this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&R?(this.lSb=!1,R.execute(xb=>{xb.isFeatureEnabled("MsoUrlreputation",
!0).then(Mb=>{this.lSb=Mb;Ya.set("isUserLicensedForSafeLinks",this.lSb.toString());Ga.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ya);this.lSb&&ta&&this.gId(!0);return null})})):(Ga.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ya),ta&&this.gId(!0))}}get appName(){return this.Nnb}get oee(){return this.E0j}get userId(){return this.X_j}get $Fl(){const b=this.oee?this.oee+"/":"",k=new pa.QueryStringBuilder("SafeLinksHandler.ashx");k.Ke("app",this.appName);
this.Oa.$("SafeLinksUseDebugHeader")&&k.Ke("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&k.Ke("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&k.Ke("s2saat","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&k.Ke("s2se03","1");return String.format("{0}{1}&{2}",b,k.toString(),n.AFrameworkApplication.ym)}get WPl(){const b=this.oee?this.oee+
"/":"",k=new pa.QueryStringBuilder("SafeLinksHandler.ashx");k.Ke("app",this.appName);this.Oa.$("SafeLinksUseDebugHeader")&&k.Ke("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&k.Ke("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&k.Ke("s2saat","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&k.Ke("s2se03","1");k.Ke("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",b,k.toString(),n.AFrameworkApplication.ym)}get XMm(){Qd.gGe||(Qd.gGe=new oh(this.Oa,this.rg,this.WPl,Qd.me));return Qd.gGe}ohc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var k=this.pgm(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",k,this.Hdd,this.Gdd,this.lSb);if(!(k&&
this.Hdd&&this.Gdd&&this.lSb))return!1;k=0;const r=({state:k}=this.YXn()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Pi[k]);const y=za.a.jF();y&&y.set("SafeLinksNavigationState",Pi[k]);Ga.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",y);if(!r)return 2!==k&&3!==k||Ga.Health.instance.recordKpiFailure("SafeLinksNavigations",Pi[k],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.xYn())return this.ftf()?!1:this.XMm.ohc(this.Ril(),b,this.bYh());if(!this.ftf())return this.yfj(b),!0;this.l9a=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.VNc=!1;this.gId();return!0}pgm(b){b=b.toLowerCase();const k=this.Oa.NB("SafeLinksUnsupportedProtocols");if(k)for(let r=0;r<k.length;r++)if(b.startsWith(k[r]))return!1;return!0}gId(b=!1){var k=za.a.jF();k&&k.set("isOnBootRequest",b.toString());Ga.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",k);Ga.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",k);k=this.L_e("SafeLinksGetPolicy");this.rg.Mj(this.$Fl,1,null,null,!0,2,Object(u.a)(this,this.tJl,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(u.a)(this,this.sJl,"getSafeLinksDataFromServer_OnFailureCallback"),k,void 0,void 0,void 0,void 0,"23");this.VNc=b;this.mbd=!0;b?this.$pb++:this.aqb++}tJl(b){let k=Za.a.AOm,r="";try{this.mbd=this.VNc=!1;var y=b.data.state;const Mc=({jx:y}=this.u$d(y)).returnValue,
fd=Object.assign(new Xa.a,{durationMs:Mc});Ga.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",fd);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Df,b.data.Ie.length,Mc);if(b.data.Df!==Za.a.yD)r="Unexpected httpStatus: "+b.data.Df.toString();else{y=null;try{y=x.b(b.data.Ie)}catch(Td){r="Exception:"+Td.toString()+" deserializing response";return}if(y){var R=y.IsSafeLinksEnabled;if(void 0===
R||null===R||0>=R.length)r="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",R);var aa=Qd.nLf(R);if(void 0===y.WebAffinitizedUrl||null===y.WebAffinitizedUrl||0>=y.WebAffinitizedUrl.length)r="Invalid WebAffinitizedUrl";else if(void 0===y.PolicyCookie||null===y.PolicyCookie||0>=y.PolicyCookie.length)r="Invalid PolicyCookie";else if(void 0===y.PolicyCookieTTL||null===y.PolicyCookieTTL)r="Invalid PolicyCookieTTL";else{var ta=y.WebAffinitizedUrl,
Ya=y.PolicyCookie,xb=y.AffinitizedUrl,Mb=new Date;Mb.setMinutes(Mb.getMinutes()+(5<y.PolicyCookieTTL?y.PolicyCookieTTL-5:0));var cc=Mb.getTime(),jc=new Wk(R,ta,Ya,cc,!1,xb);this.CZi(jc);k=b.data.Df;this.l9a&&(aa?(this.yfj(this.l9a),this.aqb=this.$pb=0):(v.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Ga.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Qe.a.Tzb(this.l9a)),this.l9a=null)}}}else r="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Mc){r=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Mc.toString()}finally{k!==Za.a.yD&&this.k4h(k,r)}}sJl(b){this.mbd=!1;let k=500,r="";try{let y=b.data.state;const R=({jx:y}=this.u$d(y)).returnValue,aa=Object.assign(new Xa.a,{durationMs:R});k=b.data.Df;Ga.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+k.toString(),!1,!0,aa);r="Request Failed, Status="+Cf.a[b.data.status]+" Duration: "+R}catch(y){r="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
y.toString()}finally{this.k4h(k,r)}}k4h(b,k=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,k),this.$pb<this.Sfd&&this.aqb<this.Tfd)this.gId(this.VNc);else{this.VNc=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.$pb,this.aqb,b,k);k=null;const r=za.a.jF();r&&(r.set("HttpStatus",b.toString()),k=Object.assign(new Xa.a,{extendedProperties:r}));
Ga.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,k);const y=new Wk("false","","",0,!0,"");this.CZi(y);this.l9a&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Ga.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Qe.a.Tzb(this.l9a),this.l9a=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",
r.toString())}}yfj(b){const k=this.bYh(),r=this.cRl(),y={};y.Url=b;y.SafeLinksCookie=k;y.CorrelationId=Ra.a.create().toString();y.WorkloadId=this.Pxo;y.UserAgentInfo=X.a.dF+"|"+this.appName;v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",y.CorrelationId);Qe.a.PMf(Qe.a.fpa(4),r,y)}Nlm(){const b=this.Oa.lb("IsSafeLinksEnabledForUser");return b?Qd.nLf(b):!1}Mlm(){const b=this.Oa.NB("SafeLinksDisabledBrowsers");if(X.a.I2){if(this.Oa.Hv("SafeLinksForTeamsIsEnabled")&&
this.Oa.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,X.a.dF))return!1;return"officecomhwa"===(this.Oa.lb(n.AFrameworkApplication.Cha)||"").toLowerCase()?!1:!0}xYn(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&X.a.ssf?!0:X.a.I2}YXn(){let b;b=0;const k=this.v2b(),r=k?k.IsSafeLinksEnabled:"";if(""!==r)return k.WasServiceDown?
(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Qd.nLf(r),state:b};if(this.mbd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.$pb>=this.Sfd||this.aqb>=this.Tfd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",
this.$pb,this.Sfd,this.aqb,this.Tfd),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Sfd+this.Tfd-(this.$pb+this.aqb));return{returnValue:!0,state:b}}bYh(){const b=this.v2b();return b?b.PolicyCookie:""}cRl(){const b=this.v2b();return b?b.WebAffinitizedUrl:""}Ril(){const b=this.v2b();return b?b.AffinitizedUrl:""}Ysl(){const b=
new Date;try{const k=this.v2b();b.setTime(k?k.PolicyCookieTTL:0)}catch(k){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",k)}return b}ftf(){const b=this.Ysl();return!!b&&b.getTime()<Date.now()}v2b(){if(!this.Hld){const b=Tb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Hld=JSON.parse(b)}return this.Hld}CZi(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||
0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Hld=b;b.WasServiceDown||this.cyo(b)}cyo(b){b=JSON.stringify(b);Tb.a.instance.setItem(this.userId,b)}L_e(b){return void 0!==Qd.me&&null!==Qd.me?Qd.me.jg("WebServiceCall",b):null}u$d(b){if(void 0!==b&&null!==b){const k=b.ri;b.stop();return{returnValue:k,jx:null}}return{returnValue:null,jx:b}}static nLf(b){return"false"!==b.toLowerCase()?!0:!1}}Qd.me=null;Qd.gGe=null;Object(m.a)(Qd,"SafeLinksManager",null,
[502]);const Ql=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},lg=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Mj{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}zc(b){this.W=b}init(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.gq(Object(u.a)(this,this.fx,"onFullAppSettingsReady"))}dispose(){}fx(){n.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&
(this.W.register(Qd,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Zd(()=>new Qd(n.AFrameworkApplication.K,n.AFrameworkApplication.af,String.format("{0}-{1}",Ql(n.AFrameworkApplication.ta.Rb.ko),lg(n.AFrameworkApplication.ta.Rb.$fa)),!1,this.W.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),n.AFrameworkApplication.ta.lq)),this.W.Pa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){M.a.instance.Pc(new Mj)}}Object(m.a)(Mj,
"SafeLinksPackage",null,[1,2]);var bi=c(184);class vl{constructor(b){this.sa=new Fe.a;this.Dh=b}Z$a(b){this.sa.addHandler(vl.$va,b)}fYc(b){this.sa.removeHandler(vl.$va,b)}JVa(b){this.sa.addHandler(vl.JQa,b)}ZIb(b){this.sa.removeHandler(vl.JQa,b)}SPe(b){this.sa.addHandler(vl.Ogc,b)}T0f(){this.sa.raiseEvent(vl.$va)}slf(){return bi.a.instance.iNa(n.AFrameworkApplication.Gy)}}vl.$va="SE";vl.$Zc="SEP";vl.JQa="SER";vl.Ogc="TRP";Object(m.a)(vl,"NullSessionExpirationManager",null,[455,456]);class kd{constructor(){this.Ivc=
this.Z9a=!1;const b=n.AFrameworkApplication.Gy;0>=b||(this.Gy=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Gy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:n.AFrameworkApplication.bW}),bi.a.instance.ibh(Object(u.a)(this,this.lac,"onSessionExpiredDetected")),bi.a.instance.hbh(Object(u.a)(this,this.KYd,"onSessionExpiringDetected")))}lac(){bi.a.instance.RQi(Object(u.a)(this,this.lac,"onSessionExpiredDetected"));v.ULS.sendTraceTag(19247381,
217,50,"SessionExpiredDetected");this.Qkf()}KYd(){bi.a.instance.Lun(Object(u.a)(this,this.KYd,"onSessionExpiringDetected"));this.Ivc||this.Z9a||(v.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Ivc=!0,this.A1f())}Qkf(){this.Z9a||(n.AFrameworkApplication.WQ(si.a.Vdc),this.Z9a=!0,this.k9d())}}Object(m.a)(kd,"ASessionExpirationManager",null,[]);var yf=c(154),Yd=c(264);class Rj{constructor(b,k,r,y){this.X5f="";this.p6c=b;this.M0g=r;this.I0g=y;this.OLg=k;b=
(new Date(this.p6c)).format(n.AFrameworkApplication.O3i);this.X5f=this.OLg?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Wdc(b){1===b?this.M0g&&this.M0g(this.OLg):0===b&&n.AFrameworkApplication.ya.Xb(ib.a.close,2,Yd.g)}dispose(){this.I0g&&this.I0g()}}Rj.id="SessionExpirationDialog";Object(m.a)(Rj,"SessionExpirationDialogSharedProperties",null,[]);class fk{}fk.vg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";
Object(m.a)(fk,"SessionExpirationDialogHtml",null,[]);class vg extends yf.a{constructor(b,k,r,y){super(k);const R={};this.JUa=new Rj(b,k,r,y);this.lg=Rj.id;n.AFrameworkApplication.clh?(this.Gd=1,this.We(0,CommonUIStrings.l_DialogClose)):(this.Gd=0,this.It=!1);k||1===n.AFrameworkApplication.ta.mode?this.We(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.We(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.vg=fk.vg;R.WACSessionExpirationText=this.JUa.X5f;this.Vh(CommonUIStrings.l_DefaultDialogTitle,
Object(u.a)(this,this.Wdc,"sessionExpirationDialogHandler"),R);this.J3(this.pj("WACSessionExpirationText"))}Wdc(b){this.JUa.Wdc(b)}Llf(){this.hide()}dispose(){super.dispose();this.JUa&&this.JUa.dispose()}}Object(m.a)(vg,"LegacySessionExpirationDialog",yf.a,[648]);class Ie extends cf.StandardDialog{constructor(b,k,r,y){super(k);this.JUa=new Rj(b,k,r,y);this.lg=Rj.id;n.AFrameworkApplication.clh?(this.Gd=1,this.We(0,CommonUIStrings.l_DialogClose)):(this.Gd=0,this.It=!1);k||1===n.AFrameworkApplication.ta.mode?
this.We(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.We(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Tv(CommonUIStrings.l_DefaultDialogTitle,this.JUa.X5f,0,Object(u.a)(this,this.Wdc,"sessionExpirationDialogHandler"))}Wdc(b){this.JUa.Wdc(b)}Llf(){this.hide()}dispose(){super.dispose();this.JUa&&this.JUa.dispose()}}Object(m.a)(Ie,"SessionExpirationDialog",cf.StandardDialog,[648]);const Gm=(b,k,r,y)=>n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?
new Ie(b,k,r,y):new vg(b,k,r,y);var ej=c(156);class Ph extends kd{constructor(b){super();this.kmd=this.oVb=!0;this.QY=null;this.sa=new Fe.a;this.Dh=b}Z$a(b){this.sa.addHandler(Ph.$va,b)}fYc(b){this.sa.removeHandler(Ph.$va,b)}JVa(b){this.sa.addHandler(Ph.JQa,b)}ZIb(b){this.sa.removeHandler(Ph.JQa,b)}SPe(b){this.sa.addHandler(Ph.Ogc,b)}slf(){return bi.a.instance.iNa(n.AFrameworkApplication.Gy)}T0f(b){this.oVb=b}A1f(){if(!this.QY&&!ej.a.wL){if(this.kmd){const b=Object(u.a)(this,this.x0b,"disposeCallback");
this.QY=Gm(this.Gy,!1,Object(u.a)(this,this.Xdc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Ph.$Zc)}}k9d(){this.QY&&(this.QY.Hma&&this.QY.Llf(),this.QY=null);if(this.oVb){const b=Object(u.a)(this,this.x0b,"disposeCallback");this.QY=Gm(this.Gy,!0,Object(u.a)(this,this.Xdc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Ph.$va)}x0b(){this.QY=null}Xdc(b){(b||this.Dh.Gzc())&&this.Dh.refreshDocument(null)}}Ph.$va="SE";Ph.$Zc="SEP";Ph.JQa="SER";Ph.Ogc="TRP";Object(m.a)(Ph,"SessionExpirationManager",
kd,[455,456]);class dg{}dg.i1j="Aborting";dg.rqd="ActivityDuration";dg.error="Error";dg.f8e="Errors";dg.failed="Failed";dg.Kzb="FirstActivity";dg.initialized="Initialized";dg.kickedOut="KickedOut";dg.Crm="LastActivity";dg.eUi="RetryOverride";dg.H4d="RequestGroups";dg.y2a="Requests";dg.S4d="Responses";dg.r6d="SessionDuration";dg.status="Status";dg.success="Success";dg.B6n="Successful";dg.tokens="Tokens";dg.pMf="PollingDuration";Object(m.a)(dg,"SessionExpirationStrings",null,[]);class Ll{constructor(b){this.gB=
{};this.Tha={};this.UTa={};this.hoi=15;this.JNg=!1;this.CVj=new Date;this.Red=new Date;this.Hb=b;this.YD=new nd.a(2,2,6E4*this.hoi,Object(u.a)(this,this.ioj,"writeMeasures"),135,"SL",!1);this.Hb.fc(this.YD);this.w5l()}ioj(){v.ULS.sendTraceTag(41964821,217,50,v.ULS.eQc({["Aggregate"]:this.Tha,["Current"]:this.gB}))}w5l(){this.Tha[dg.H4d]=0;this.Tha[dg.y2a]=0;this.Tha[dg.S4d]=0;this.Tha[dg.status]=dg.initialized;this.Tha[dg.Kzb]=new Date;this.Tha[dg.r6d]=0;this.Tha[dg.rqd]=0;this.Tha[dg.r6d]=0;this.gB[dg.r6d]=
0;this.Tha[dg.rqd]=0;this.gB[dg.rqd]=0}get T7m(){this.UTa[dg.pMf]=+new Date-+this.UTa[dg.Kzb];return this.UTa}snf(b,k){var r=b[k];r=r?r:0;r++;b[k]=r;this.YYf(b)}YYf(b){const k=new Date;b[dg.rqd]=+k-+this.Red;this.Red=k;b[dg.r6d]=+this.Red-+this.CVj;b[dg.Crm]=this.Red}M7(b,k){this.gB[b]=k;this.YYf(this.gB)}pYf(b,k){this.gB[b]=k;this.YYf(this.gB)}x5b(b){this.snf(this.gB,b);this.snf(this.Tha,b);this.snf(this.UTa,b)}flush(){this.JNg||(this.Tha[dg.status]=this.gB[dg.status],this.ioj(this.YD),this.Hb.A3(this.YD,
6E4*this.hoi))}Ryn(){const b=this.gB[dg.status];b&&(this.Tha[dg.status]=b);this.gB={}}hzn(){this.UTa={};this.UTa[dg.pMf]=0;this.UTa[dg.Kzb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.JNg=!0;this.Hb.Ye(this.YD)}}Object(m.a)(Ll,"SessionLogger",null,[451]);class vf{constructor(b,k){this.lod=b;this.Rxa=k}get tokens(){return this.lod}get errors(){return this.Rxa}}Object(m.a)(vf,"TokenRefreshArgs",null,[560]);var Ae=c(389);class cb extends Sys.EventArgs{constructor(b,
k,r,y,R,aa,ta){super();this.UTa=b;this.uGi=k;this.H4d=y;this.failed=R;this.y2a=aa;this.S4d=ta}}Object(m.a)(cb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);class Eb{constructor(b,k=null,r=null){this.Ivc=this.Z9a=!1;this.kmd=this.oVb=!0;this.sa=new Fe.a;this.Kvc=this.Ued=this.Pjd=!1;this.Lsb=null;this.lXg=10;this.hed=!1;this.MKe=b;this.twe=n.AFrameworkApplication.Kpm;this.Hb=Mg.a.instance;v.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:n.AFrameworkApplication.Gy,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:n.AFrameworkApplication.bW});this.xd=k||new Ll(Mg.a.instance);this.sja=r;bi.a.instance.ibh(Object(u.a)(this,this.d1j,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));bi.a.instance.hbh(Object(u.a)(this,this.y7g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Ae.SessionStatusManager.instance.G9j(Object(u.a)(this,this.y7g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Ae.SessionStatusManager.instance.g$j(Object(u.a)(this,
this.y9m,"preemptiveTokenRefresh"));this.bPg=new Date;n.AFrameworkApplication.Jpm&&(bi.a.instance.cWe=Object(u.a)(this,this.Sln,"refreshAccessTokenWhenSessionExpired"));n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.lXg=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1))}Z$a(b){this.sa.addHandler(Eb.$va,b)}fYc(b){this.sa.removeHandler(Eb.$va,b)}JVa(b){this.sa.addHandler(Eb.JQa,b)}ZIb(b){this.sa.removeHandler(Eb.JQa,b)}SPe(b){this.sa.addHandler(Eb.Ogc,b)}slf(){return bi.a.instance.iNa(n.AFrameworkApplication.Gy)}Sln(){this.MKd(!1);return!bi.a.instance.iNa(n.AFrameworkApplication.Gy)}d1j(b,k){bi.a.instance.IQd?this.lac(b,k):this.twe?(this.Ued=!1,this.MKd(!1)):(this.Z9a||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.lac(b,k))}y7g(b,k){bi.a.instance.Vtf?this.KYd(b,k):this.MKd(!0)}MKd(b){if(!this.Pjd&&!this.Ued)if(this.sja&&this.sja.Bo)this.Kvc=!0,this.xd.M7(dg.status,dg.kickedOut),this.xd.flush(),this.xd.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.Kvc),this.Kvc)this.k9d();else{this.xd.flush();this.xd.Ryn();this.xd.x5b(dg.H4d);this.Pjd=!0;this.hed||(this.xd.hzn(),this.hed=!0,this.qJk());const k=this.MKe.hmn(b);k.continueWith(()=>{if(this.MKe.Ccn(k))this.xd.x5b(dg.B6n),
this.xd.M7(dg.status,dg.success),this.kmd=!1,this.twe&&(this.oVb=!1),this.Ued=!1,this.bPg=new Date,this.C5n(),this.sa.raiseEvent(Eb.JQa,new vf(k.result.tokens,null));else{const r=k.result.errors;this.xd.x5b(dg.failed);this.xd.M7(dg.status,dg.failed);b||(this.Kvc=this.MKe.MOc(r));this.Kvc&&(this.xd.M7(dg.i1j,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Ued=!0;this.sa.raiseEvent(Eb.JQa,new vf(null,r))}this.xd.flush();this.Pjd=!1})}}lac(){this.twe||bi.a.instance.RQi(Object(u.a)(this,
this.lac,"onSessionExpiredDetected"));v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Qkf(bi.a.instance.IQd)}KYd(){this.Ivc||this.Z9a||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Ivc=!0,this.A1f(bi.a.instance.Vtf))}Qkf(b){if(!this.Z9a){var k=b?si.a.eJn:si.a.Vdc;const r=Object.assign(new Xa.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",k));n.AFrameworkApplication.WQ(k,void 0,["SessionExpired"],
r);b||(b=new Date,k=new Date(n.AFrameworkApplication.bW),v.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",k,b,+b-+k),864E5>+b-+k&&Ga.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+k&&Ga.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Z9a=!0;this.k9d()}}C5n(){this.hed&&(this.Hb.Ye(this.Lsb),this.hed=!1)}qJk(){this.Lsb=
new nd.a(2,2,1E3*this.lXg,Object(u.a)(this,this.Bbo,"tokenRefreshPolling"),135);this.Hb.fc(this.Lsb)}Bbo(){const b=this.xd.T7m;v.ULS.sendTraceTag(555255521,217,50,"{0}",x.c(b));this.sa.raiseEvent(Eb.Ogc,new cb(b,b[dg.pMf],b[dg.Kzb],b[dg.H4d],b[dg.failed],b[dg.y2a],b[dg.S4d]))}y9m(){3E5<+new Date-+this.bPg?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.MKd(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}
Eb.$va="SE";Eb.$Zc="SEP";Eb.JQa="SER";Eb.Ogc="TRP";Object(m.a)(Eb,"ASessionExpirationManagerWithRefresh",null,[]);class ec extends Eb{constructor(b,k,r=null,y=null){super(k,r,y);this.QY=null;this.Dh=b}T0f(b){this.oVb=b}A1f(b){if(!this.QY&&!ej.a.wL){if(b){var k=Object(u.a)(this,this.x0b,"disposeCallback");this.QY=Gm(n.AFrameworkApplication.kkb,!1,Object(u.a)(this,this.Xdc,"sessionExpirationHandler"),k)}else if(this.kmd){if(this.Pjd)return;k=Object(u.a)(this,this.x0b,"disposeCallback");this.QY=Gm(n.AFrameworkApplication.Gy,
!1,Object(u.a)(this,this.Xdc,"sessionExpirationHandler"),k)}v.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Eb.$Zc,b);this.sa.raiseEvent(Eb.$Zc)}}k9d(){this.QY&&(this.QY.Hma&&this.QY.Llf(),this.QY=null);if(this.oVb){this.xd.stop();if(this.sja&&this.sja.Bo)return;const b=Object(u.a)(this,this.x0b,"disposeCallback");this.QY=Gm(n.AFrameworkApplication.Gy,!0,Object(u.a)(this,this.Xdc,"sessionExpirationHandler"),b)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",
Eb.$va);this.sa.raiseEvent(Eb.$va)}x0b(){this.QY=null}Xdc(b){(b||this.Dh.Gzc())&&this.Dh.refreshDocument(null)}}Object(m.a)(ec,"SessionExpirationManagerWithRefresh",Eb,[455,456]);class Cc{constructor(b,k,r=null,y=null){this.V5g=!1;this._instance=null;this._frame=b;this.vm=k;this.xd=r||new Ll(Mg.a.instance);this.sja=y}create(){this.V5g=n.AFrameworkApplication.d0a;if(!this.V5g)return new Ph(this._frame);n.AFrameworkApplication.Vl("WOPITokenRefreshIsEnabled");v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");
if(!this._instance)switch(n.AFrameworkApplication.Cuo){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new vl(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new ec(this._frame,this.vm,this.xd,this.sja);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Ph(this._frame)}v.ULS.sendTraceTag(39408089,217,
50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(m.a)(Cc,"SessionExpirationManagerFactory",null,[454]);class Pc{}Object(m.a)(Pc,"Error",null,[]);class jd{}Object(m.a)(jd,"NamedResult",null,[]);class pe extends jd{}Object(m.a)(pe,"ErrorInfo",jd,[]);var ue=c(1040),Od=c(32);class zf{constructor(b,k,r,y=null,R=!1,aa=null,ta=!1,Ya=!1){this.tUa=0;this.lJa=this.ao=null;this.lod=new rb.a;this.Rxa=new rb.a;this.Vo=null;this.swe=
!1;this.Twc=this.Uwc=null;this.Hb=b;this.pXg=k;this.pXg.execute(xb=>{xb.fC(E.a.omf,Object(u.a)(this,this.qVm,"onHostResponseReceived"))});this.j1=r;this.E4g=new ue.a("WebServiceCall","TokenRefresh");this.xd=y||new Ll(b);this.vVj=R;this.pf=aa?aa:Ae.SessionStatusManager.instance;this.mEg=ta;this.F$c=Ya}qVm(b){if(b.MessageId!==E.a.omf)Od.b(39408099,306,15,"Unexpected message.");else{var k=new rb.a,r=new rb.a;this.xd.x5b(dg.S4d);var y=b.Values[H.a.bZi];if(!y||0>=y.length)Od.b(40122317,306,15,"Found no tokens in the dictionary"),
y=b.Values;Od.b(40122318,306,100,"The Tokens array contains {0} tokens",y.length);this.xd.M7("Correlation",b.CorrelationId);var R="";for(let Ya=0;Ya<y.length;Ya++){this.xd.pYf(dg.tokens,y.length);var aa=y[Ya],ta=aa;if(!ta||!ta.Name)continue;this.xd.x5b(ta.Name);const xb=aa;if(xb&&xb.Value)Od.b(39408128,306,100,"Received token with name: {0}",xb.Name),k.add(xb),this.lod.add(xb),this.F$c||this.xd.M7(dg.status,dg.success),this.mEg&&this.pf&&this.pf.yzn();else if(aa=this.EJl(aa),Od.b(39408129,306,15,
"Received error for token {0}. Creating error object from {1}, TaskId {2}",ta.Name,JSON.stringify(aa),this.lJa),r.add(aa),this.F$c||(this.Rxa.add(aa),R=JSON.stringify(aa),this.xd.M7(dg.error,JSON.stringify(aa)),this.xd.M7(dg.status,dg.failed)),this.mEg)for(const Mb of aa.Errors)ta=this.Psl(Mb),this.pf&&this.pf.r7j(ta)}this.F$c?(0<r.count?this.Twc?this.Twc(new vf(k,r)):Od.b(512267295,306,15,"Received errors but the promise has completed"):this.Uwc?this.Uwc(new vf(k,r)):Od.b(512267294,306,15,"Received valid tokens but the promise has completed"),
Od.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",k.count,r.count,b.CorrelationId,this.lJa)):(0<r.count&&""!==R?(y=Object.assign(new Xa.a,{extendedProperties:new Map}),y.extendedProperties.set("Errors",R),Ga.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,y)):Ga.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Od.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
k.count,r.count,b.CorrelationId,this.lJa),0<r.count&&!this.MOc(r)?(b=this.j1.vZh(r),b!==this.j1.Zcc&&(this.xd.pYf(dg.eUi,b),this.Hb.A3(this.ao,b))):(this.xd.flush(),this.ao&&(Od.b(39408131,306,100,"Deleting task {0} from task manager",this.ao.name),this.Hb.Ye(this.ao)),this.Vo&&!this.Vo.task.isCompleted?this.Vo.Eg(new vf(k,r)):Od.b(512267293,306,15,"Received results but the task has completed")))}}EJl(b){if(!b)return null;const k=Object.assign(new pe,{Name:b.Name,Errors:[]});for(const r of b.Errors)b=
new Pc,b.Id=r.Id,b.Details=A.a.UZh(r.Details,500),k.Errors.push(b);return k}requestTokensOnce(){this.MSi()}MSi(){n.AFrameworkApplication.Ne("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.tUa>=this.j1.XUd?(Od.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.lJa),this.bLk(this.Vo)):(Ga.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.jYi())}jYi(){const b={};b[H.a.bZi]=this.j1.tokens;const k=Ra.a.create().toString();Od.b(39408133,
306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.j1.tokens),this.tUa+1,k,this.lJa);this.pXg.execute(r=>{r.sendMessage(E.a.iRe,b,k)});this.tUa++;this.xd.x5b(dg.y2a)}bLk(b){const k=new rb.a;for(let r=0;r<this.j1.tokens.length;r++){const y=Object.assign(new pe,{Name:this.j1.tokens[r],Errors:[Object.assign(new Pc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});k.add(y);this.Rxa.add(y)}this.Hb.Ye(this.ao);
this.xd.M7(dg.f8e,JSON.stringify(this.Rxa));this.xd.M7(dg.status,dg.failed);b&&!b.task.isCompleted&&b.Eg(new vf(new rb.a,this.Rxa))}hmn(b){n.AFrameworkApplication.Ne("258ec738;j5j99381");this.E4g.start();this.swe=b;this.lJa=Ra.a.create().toString();Od.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.lJa,this.swe);this.tUa=0;this.Rxa.clear();this.lod.clear();this.Vo=new zh.a;this.F$c?this.NSi(this.j1.XUd).then(k=>{this.Vo&&!this.Vo.task.isCompleted&&this.Vo.Eg(k);
this.Twc=this.Uwc=null;this.xd.M7(dg.f8e,JSON.stringify(this.Rxa));this.xd.M7(dg.status,dg.success);this.xd.flush()}).catch(k=>{this.Vo&&!this.Vo.task.isCompleted&&this.Vo.Eg(Object(ia.a)(560,k));this.Twc=this.Uwc=null;this.xd.M7(dg.f8e,JSON.stringify(this.Rxa));this.xd.M7(dg.status,dg.failed);this.xd.flush()}):(this.ao=new nd.a(this.j1.priority,2,this.j1.Zcc,Object(u.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,E.a.iRe,!0),this.vVj&&this.MSi(),this.Hb.fc(this.ao));return this.Vo.task}NSi(b){const k=
this,r=new Promise((Ya,xb)=>{k.Uwc=Ya;k.Twc=xb;Ga.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);k.jYi()}),y=this,R=new Promise((Ya,xb)=>{window.setTimeout(()=>{xb(y.Yuh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},y.j1.Zcc)});let aa=b;const ta=this;return new Promise((Ya,xb)=>{aa--;Promise.race([r,R]).then(Mb=>{Ga.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ya(Mb)}).catch(Mb=>{var cc=ta.j1.Zcc;if(Object(Jb.a)(560,Mb)&&
(Mb=Object(ia.a)(560,Mb),0<Mb.errors.count)){ta.hzm(Mb.errors);ta.g9g(Mb.errors);if(ta.MOc(Mb.errors)){xb(Mb);return}const jc=ta.j1.vZh(Mb.errors);jc!==ta.j1.Zcc?(ta.xd.pYf(dg.eUi,jc),cc=jc):ta.jom(Mb.errors)&&(cc=0)}aa?window.setTimeout(()=>{ta.NSi(aa).then(Ya).catch(xb)},cc):(cc=ta.Yuh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ta.g9g(cc.errors),xb(cc),Od.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ta.lJa))})})}g9g(b){for(let k of b)this.Rxa.add(k)}jom(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}Yuh(b,k){const r=new rb.a;for(let y=0;y<this.j1.tokens.length;y++){const R=this.cLk(this.j1.tokens[y],b,k);r.add(R)}return new vf(new rb.a,r)}cLk(b,k,r){return Object.assign(new pe,{Name:b,Errors:[Object.assign(new Pc,{Id:k,Details:r})]})}hzm(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var k=Object.assign(new Xa.a,{extendedProperties:new Map});
k.extendedProperties.set("Errors",b);Ga.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,k);this.xd.M7(dg.error,b);this.xd.M7(dg.status,dg.failed)}}Ccn(b){this.E4g.stop();const k=this.KXl(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!k,this.lJa,this.swe,this.tUa,this.Rxa.count,0<b.result.errors.count?
b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return k?!1:this.Bcn(b.result.tokens)}MOc(b){return this.j1.MOc(b)}Bcn(b){for(let k=0;k<b.count;k++){const r=b.J(k);if(r.Name===H.a.accessToken){const y=(new Date).getTime();r.Expiry>n.AFrameworkApplication.Gy?(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",
{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:y,["BootTime"]:n.AFrameworkApplication.bW},"PreviousAccessTokenTtl",n.AFrameworkApplication.Gy),n.AFrameworkApplication.accessToken=r.Value,n.AFrameworkApplication.Gy=Math.floor(r.Expiry),n.AFrameworkApplication.Mag=y,n.AFrameworkApplication.zJa=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:y,["BootTime"]:n.AFrameworkApplication.bW},
"PreviousAccessTokenTtl",n.AFrameworkApplication.Gy)}}return!0}KXl(b){let k=!1;for(let r=0;r<b.count;r++){k=!0;const y=b.J(r);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",y.Name,JSON.stringify(y.Errors),this.lJa)}return k}Psl(b){let k=si.a.Vdc;b=parseInt(b.Id);if(isNaN(b))k=si.a.nnj;else{switch(b){case 401:k=si.a.Nag;break;case 403:k=si.a.lnj;break;case 500:k=si.a.mnj;break;case 503:k=si.a.pnj}k===si.a.Vdc&&(k=500<b?si.a.onj:si.a.knj)}return k}}Object(m.a)(zf,
"TokenRefreshManager",null,[453]);class Tf{constructor(){this.Zcc=n.AFrameworkApplication.Fuo;this.XUd=n.AFrameworkApplication.Duo;this.tokens=n.AFrameworkApplication.jSl();this.priority=n.AFrameworkApplication.Guo;this.NZg=this.mQn();this.ZMe=n.AFrameworkApplication.iSl()}MOc(b){b=JSON.stringify(b);if(this.ZMe&&0<this.ZMe.length)for(const k of this.ZMe)if(0<k.length&&0<=b.indexOf(k))return!0;return!1}vZh(b){try{if(b)for(let k of b)if(k.Errors)for(const r of k.Errors)if(r.Id in this.NZg)return Number.parseInvariant(this.NZg[r.Id].toString())}catch(k){v.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",k.toString())}return this.Zcc}mQn(){const b={};try{if(!n.AFrameworkApplication.iJd()||0>=n.AFrameworkApplication.iJd().length||""===n.AFrameworkApplication.iJd()[0])return b;for(const k of n.AFrameworkApplication.iJd())0<k.length&&(b[k]=n.AFrameworkApplication.Euo)}catch(k){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",k.toString())}return b}}Object(m.a)(Tf,"TokenRefreshPolicy",
null,[452]);class dc{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){n.AFrameworkApplication.K.gq(()=>{this.TZa()})}TZa(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}zc(b){this.W=b;b.register(451,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Zd(()=>new Ll(Mg.a.instance));b.register(452,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Zd(()=>
new Tf);b.register(453,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Zd(()=>new zf(Mg.a.instance,n.AFrameworkApplication.gQ(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),n.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Pa("Common.ISessionStatus"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SyncMessageWithTimeout",
!1)));b.register(454,"Common.ISessionExpirationManagerFactory").singleInstance().Zd(()=>new Cc(n.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Pa("Common.ISessionStatus")));b.register(455,"Common.ISessionExpirationManagerWithDialog").singleInstance().Zd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(456,"Common.ISessionExpirationManager").singleInstance().Zd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){M.a.instance.Pc(new dc)}}
Object(m.a)(dc,"SessionExpirationPackage",null,[1,2]);var Oi=c(747),Ci=c(443),oi=c(358),Wg=c(213);class Bk extends Wg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(Bk,"PersonaButtonProps",Wg.a,[]);class Ca{A_b(b,k){if(b&&!(1>b.length)&&k){var r=Object.assign(new oi.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.qLk(b,r.ControlList);k.push(r)}}qLk(b,k){const r=Object.assign(new Oi.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new Ci.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(k,r);k=Object.assign(new oi.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,k);this.bOk(b,k.ControlList)}bOk(b,k){for(let r=0;r<b.length;r++){const y=Object.assign(new Bk,{ExternalId:String.format("CoauthorPersona_{0}",r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});
Array.add(k,y)}}}Object(m.a)(Ca,"PresenceContextMenuSectionBuilder",null,[556]);var vb=c(81);class hc{constructor(b,k,r,y){this.spa=this.ns=this.ao=this.hg=this.mGa=null;this.qmd=b;this.OWj=y;this.qmd.fNc&&(this.ao=new nd.a(3,2,5E3,Object(u.a)(this,this.Nhk,"authenticationCheckTask"),2),n.AFrameworkApplication.uc.fc(this.ao),this.Vb(k,r));this.qmd.X7j(()=>{this.DGb()});this.qmd.Y$g(()=>{this.EGb()})}get wP(){return this.ns||(this.ns=Va.a.instance.Pa("CommonUI.IBusinessBar"))}get sjh(){return this.spa||
(this.spa=Va.a.instance.Pa("CommonUI.IBusinessBarEntryFactory"))}Vb(b,k){const r=n.AFrameworkApplication.ya;r.gb(ib.a.hgh,zc.a.frame,b,96);r.gb(ib.a.igh,zc.a.frame,k,96);r.pa(ib.a.Clh,zc.a.frame,Kd.ActionManager.uZ);r.pa(ib.a.Dlh,zc.a.frame,Kd.ActionManager.uZ);r.pa(ib.a.twf,zc.a.frame,Kd.ActionManager.uZ)}DGb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);n.AFrameworkApplication.ya.processAction(ib.a.hgh,2)}EGb(){this.N9n();n.AFrameworkApplication.ya.processAction(ib.a.igh,2)}Nhk(){this.qmd.authenticationCheck()}N9n(){this.hg&&
(this.hg.hide(),this.hg.dispose(),this.hg=null);this.mGa&&this.wP&&(n.AFrameworkApplication.Tk||this.wP.removeEntry(this.mGa),this.mGa.dispose(),this.mGa=null)}showDialog(b){vb.a.YA(this.hg);this.hg=new cf.StandardDialog;this.OWj||(this.hg.It=!1,this.hg.Gd=0);this.hg.We(1,CommonUIStrings.l_SignIn);this.hg.yU(CommonUIStrings.l_DefaultDialogTitle,b,Object(u.a)(this,this.p$,"dialogHandler"))}p$(b){1===b?(ch.a.V_d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),n.AFrameworkApplication.ya.processAction(ib.a.twf,
2)):(this.OYn(),n.AFrameworkApplication.ya.processAction(ib.a.Dlh,2))}OYn(){this.wP&&this.sjh&&(this.mGa=this.sjh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.mGa.closeable=!0,this.mGa.addButton(CommonUIStrings.l_SignIn,hc.ywb,""),this.mGa.mka=Object(u.a)(this,this.xpk,"businessBarEntryCloseHandler"),this.wP.qA(this.mGa,!1))}xpk(){this.uYk();n.AFrameworkApplication.ya.processAction(ib.a.Clh,2)}uYk(){this.ao&&(n.AFrameworkApplication.uc.Ye(this.ao),
this.ao=null)}dispose(){this.ao=this.hg=this.mGa=null}static ywb(){ch.a.V_d();n.AFrameworkApplication.ya.processAction(ib.a.twf,2)}}Object(m.a)(hc,"SignOutResponseUI",null,[10]);class Nc{get name(){return"Common.App.UI"}zc(b){b.register(Ca,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){vb.a.YA(Nc.Zqa);Nc.Zqa=null}static main(){M.a.instance.Pc(new Nc)}static P3l(b,k,r){Nc.BYn()&&(Nc.Zqa=new hc(ch.a.instance,
b,k,r))}static BYn(){return n.AFrameworkApplication.YVd&&!n.AFrameworkApplication.aua}}Nc.Zqa=null;Object(m.a)(Nc,"CommonAppUIPackage",null,[1,2]);class sd{get name(){return"Common.App.DialogWithLinkToResource"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new sd)}}Object(m.a)(sd,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var Id=c(57);class We{constructor(b){this.Hx=b;this.wx=Array.indexOf(this.Hx,this.Cea)}dispose(){this.Hx=null}get a2(){return this.Hx[this.wx]}qy(b){this.f_c(b,
!1);return!0}c2b(b){this.f_c(b,!0)}f_c(b,k){b&&(this.a2!==b||k)&&(b.tabIndex=0,Id.FocusManager.IK(b));Array.contains(this.Hx,b)&&(this.wx=Array.indexOf(this.Hx,b))}get JHi(){let b=this.wx;do if(b)if(0<b&&b<this.Hx.length)b--;else break;else b=this.Hx.length-1;while(!Gg.DOMFocusListing.JXa(this.Hx[b])&&b!==this.wx);return this.Hx[b]}get Vui(){let b=this.wx;do if(b===this.Hx.length-1)b=0;else if(0<=b&&b<this.Hx.length-1)b++;else break;while(!Gg.DOMFocusListing.JXa(this.Hx[b])&&b!==this.wx);return this.Hx[b]}get Cea(){let b=
0;for(;!Gg.DOMFocusListing.JXa(this.Hx[b])&&b<this.Hx.length;)b++;return Gg.DOMFocusListing.JXa(this.Hx[b])?this.Hx[b]:null}get M8b(){let b=this.Hx.length-1;for(;!Gg.DOMFocusListing.JXa(this.Hx[b])&&0<b;)b--;return Gg.DOMFocusListing.JXa(this.Hx[b])?this.Hx[b]:null}}Object(m.a)(We,"DialogFocusListing",null,[161]);var Fd=c(49);class Ff extends cf.StandardDialog{constructor(b,k,r,y=null){super();this.Xca=this.hw=this.m7a=null;this.Hx=[];this.Aid=k;this.Lj=b;this.QHj=r;this.Eld=y;this.Ql=new ue.a("LoadResource",
"LoadPrintablePdf")}MAa(){this.Gd=5;this.width=40;const b=document.createElement("span");b.id=this.pj("DirectPrintHeaderContent");const k=document.createElement("span");k.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(k,"DirectPrintHeader");this.Xca=document.createElement("iframe");this.Xca.name="pdfObjectFrame";this.Xca.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.Xca.onload=Object(u.a)(this,this.nan,"printablePdfLoaded");if(this.Eld&&0<this.Eld.count){var r=
Oa.a.bhf(this.Aid,this.Eld);const y=Oa.a.QSf(this.Aid,this.Eld);this.hw=document.createElement("form");this.hw.id="printPreviewPostForm";this.hw.method="POST";this.hw.target=this.Xca.name;this.hw.action=y;for(let R of r)r=document.createElement("input"),r.type="hidden",r.name=R.key,r.value=R.value,this.hw.appendChild(r)}else this.Xca.setAttribute("src",this.Aid);Sys.UI.DomElement.addCssClass(this.Xca,ej.a.MTg);this.QHj?(Sys.UI.DomElement.addCssClass(this.Xca,"DirectPrintPdfObjectHidden"),k.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,Ef.a.Jq(this.Xca,Ef.a.Fz,Ef.a.Jo)):(Sys.UI.DomElement.addCssClass(this.Xca,"DirectPrintPdfObject"),this.Hx.push(this.Xca));b.appendChild(k);b.appendChild(document.createElement("br"));b.appendChild(this.Xca);this.hw&&b.appendChild(this.hw);b.appendChild(document.createElement("br"));b.appendChild(this.OEk(this.hw?"#":this.Aid));this.Ql.start();this.Mhb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.J3(this.pj("DirectPrintHeaderContent"));this.hw&&
this.hw.submit();this.rLk();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}OEk(b){const k=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;k.appendChild(r);n.AFrameworkApplication.K&&(2===n.AFrameworkApplication.ta.Rb.ko&&n.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===n.AFrameworkApplication.ta.Rb.ko&&n.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?
(b=document.createElement("span"),2===n.AFrameworkApplication.ta.Rb.ko?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===n.AFrameworkApplication.ta.Rb.ko&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.m7a=b,k.appendChild(document.createElement("br")),k.appendChild(b)):(r=document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target=
"_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.m7a=r,k.appendChild(document.createElement("br")),k.appendChild(r),this.hw&&Af.a.addHandler(r,"click",Object(u.a)(this,this.i_m,"onSubmit")),this.Lj.mb(Kb.a.click,this.m7a,Object(u.a)(this,this.pDh,"downloadPDFLinkClicked"),null));this.Hx.push(this.m7a);return k}i_m(b){this.hw&&(this.hw.target="_blank",this.hw.submit());b.preventDefault()}rLk(){if(0<this.Hx.length){const b=new We(this.Hx),k=Id.FocusManager.instance().Fs();k&&(this.m7a.focus(),
k.Wj=b,k.$T=!0)}}pDh(){v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}lRc(){v.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}nan(){v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Ql&&this.Ql.stop()}dispose(){this.m7a&&(this.Lj.sc(Kb.a.click,this.m7a,Object(u.a)(this,this.pDh,"downloadPDFLinkClicked")),this.m7a=null);Fd.a.Nu(this.Xca);this.Xca=null;super.dispose()}}Object(m.a)(Ff,"DirectPrintDialog",
cf.StandardDialog,[541]);class Ac{constructor(b){this.Lj=b}Drl(b,k,r=null){return new Ff(this.Lj,b,k,r)}}Object(m.a)(Ac,"DirectPrintDialogFactory",null,[527]);class Qi{constructor(b,k){this._url=b;this.JQj=k}dCh(){this.JQj?Qe.a.downloadFile(this._url):Qe.a.Gm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(Qi,"OpenUrlInTabDialogDownloadBehavior",null,[550,10]);class Tc extends cf.StandardDialog{constructor(b,k=!0,r=!1,y=null,R=null,aa=!1){super();
this.aRb=this.$Qb=this.hw=this.c1=null;var ta=this.l6f?this.l6f:CommonUIStrings.l_DefaultDialogTitle;Tc.W4b=aa;this.moe=y||new Qi(b,!0);const Ya=[],xb=[];Tc.LK&&(this.xrd&&this.xrd.forEach(jc=>{Array.add(Ya,jc)}),this.ybh&&this.ybh.forEach(jc=>{Array.add(xb,jc)}));k?r?(this.Gd=4,this.We(1,this.buttonText),this.We(2,CommonUIStrings.l_DialogClose)):(this.Gd=6,this.We(0,CommonUIStrings.l_DialogClose)):this.Gd=5;aa=document.createElement("span");this.lDc&&(aa.className=this.lDc);y=document.createElement("a");
y.innerText=this.d9b;y.href=b;y.target="_blank";y.id=this.WQc;y.className=id.AFrame.JQe;var Mb=!X.a.I2&&!!R&&0<R.count;if(Mb){const jc=Oa.a.bhf(b,R);R=Oa.a.QSf(b,R);y.href="#";y.target="_self";this.hw=document.createElement("form");this.hw.id="printPreviewPostForm1";this.hw.method="post";this.hw.target="_blank";this.hw.action=R;for(var cc of jc)R=document.createElement("input"),R.type="hidden",R.name=cc.key,R.value=cc.value,this.hw.appendChild(R)}else this.hw=null;this.hw||Tc.W4b?Tc.W4b||Array.add(xb,
{["type"]:"AppLinkProps",["id"]:this.WQc,["text"]:this.d9b,["onExecute"]:()=>{this.oLi()}}):Array.add(xb,{["type"]:"AppLinkProps",["id"]:this.WQc,["text"]:this.d9b,["handler"]:{["href"]:Mb?"#":b,["target"]:Mb?"_self":"_blank"}});this.T0a&&Array.add(Ya,this.T0a);r?(b=document.createElement("span"),b.innerText=this.T0a.replace("{0}",""),aa.appendChild(b)):this.ysi?(b=document.createElement("span"),b.id=this.pj("message"),cc=document.createElement("span"),R=document.createElement("span"),Mb=this.T0a.split("{0}"),
cc.innerText=Mb[0],R.innerText=Mb[1],b.appendChild(cc),b.appendChild(y),b.appendChild(R),aa.appendChild(b)):(b=document.createElement("span"),b.innerText=this.T0a,aa.appendChild(b),aa.appendChild(document.createElement("br")),aa.appendChild(document.createElement("br")),aa.appendChild(y),Tc.W4b||Array.add(Ya,"{0}"));this.hw&&aa.appendChild(this.hw);Tc.LK&&(this.nhb&&(this.FQc?this.j9g(this.nhb,this.FQc):(Array.add(Ya,"{0}"),Array.add(xb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.nhb,
["onExecute"]:()=>{}}))),this.hyc(Ya,xb));this.Mhb(ta,null,this.ymf,null,Object(u.a)(this,this.p$,"dialogHandler"),Tc.LK?null:aa);this.J3(this.pj("message"));!Tc.LK&&this.FQc&&this.nhb&&(ta=document.createElement("div"),ta.className="WACDialogLearnMoreLinkContainer",this.c1=document.createElement("a"),this.c1.innerText=this.nhb,this.c1.href=this.FQc,this.c1.target="_blank",this.c1.id=this.pj("LearnMoreLinkId"),this.c1.className=id.AFrame.JQe,ta.appendChild(this.c1),k?this.fd.insertBefore(ta,this.fd.lastChild):
this.fd.appendChild(ta),this.J3(String.format("{0} {1}",this.pj("message"),this.pj("LearnMoreLinkId"))));this.Qmc=y;r?this.xU(this.qG):this.xU(this.Qmc);this.Rxf();n.AFrameworkApplication.ta.U_.mb(Kb.a.click,this.Qmc,Object(u.a)(this,this.oDh,"downloadLinkClicked"),null);this.c1&&n.AFrameworkApplication.ta.U_.mb(Kb.a.click,this.c1,Object(u.a)(this,this.bmi,"learnMoreLinkClicked"),null);this.DR=!1}get ymf(){return null}get l6f(){return null}get T0a(){return null}get FQc(){return null}get nhb(){return null}get ysi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get lDc(){return null}get xrd(){return null}get ybh(){return null}Wja(){this.hw&&
(this.$Qb||(this.$Qb=Object(u.a)(this,this.GQm,"onActionButtonClicked"),this.oq.mb(Kb.a.click,this.qG,this.$Qb)),this.aRb||(this.aRb=Object(u.a)(this,this.HQm,"onActionButtonKeyUp"),this.le.mb(Kb.a.oh,this.qG,this.aRb)));super.Wja()}GQm(b){this.OGh(b);return!0}HQm(b){return this.gQc(b,Object(u.a)(this,this.OGh,"executeDismissActionButtonFromArgs"))}OGh(b){this.hw&&this.hw.submit();this.pzb(b.Af)}lRc(){}oDh(){this.Sxf();this.hw?this.hw.submit():this.moe.dCh();return!0}bmi(){return!1}dispose(){this.moe.dispose();
this.Qmc&&(n.AFrameworkApplication.ta.U_.sc(Kb.a.click,this.Qmc,Object(u.a)(this,this.oDh,"downloadLinkClicked")),this.Qmc=null);this.c1&&(n.AFrameworkApplication.ta.U_.sc(Kb.a.click,this.c1,Object(u.a)(this,this.bmi,"learnMoreLinkClicked")),this.c1=null);this.oq&&this.$Qb&&(this.oq.sc(Kb.a.click,this.qG,this.$Qb),this.$Qb=null);this.le&&this.aRb&&(this.le.sc(Kb.a.oh,this.qG,this.aRb),this.aRb=null);super.dispose()}oLi(){this.hw&&(document.body.appendChild(this.hw),this.hw.submit(),document.body.removeChild(this.hw))}p$(b){1===
b&&(this.lRc(),this.hw?Tc.LK&&this.oLi():this.moe.dCh());this.dispose()}static get LK(){return n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.ta.Rb.Ghi}static get W4b(){return Tc.PIg}static set W4b(b){Tc.PIg=b}}Tc.PIg=!1;Object(m.a)(Tc,"ADialogWithLinkToResource",cf.StandardDialog,[]);class uj extends Tc{constructor(b,k,r=null,y=!0,R=!1){super(b,!0,!(uj.Jmb&&y),new Qi(b,k),r,R);uj.Jmb=uj.Jmb&&y;if(uj.Jmb){k=document.createElement("iframe");y=null;R=this.pXk;k.name="pdfObjectFrame";k.id=
"pdfObjectIFrame";if(r&&0<r.count){const aa=Oa.a.bhf(b,r);b=Oa.a.QSf(b,r);y=document.createElement("form");y.id="printPreviewPostForm";y.method="POST";y.target=k.name;y.action=b;for(let ta of aa)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,y.appendChild(b)}else k.src=b;R.appendChild(k);y&&(R.appendChild(y),y.submit());Sys.UI.DomElement.addCssClass(k,"DirectPrintPdfObjectHidden");Ef.a.Jq(k,Ef.a.Fz,Ef.a.Jo)}}get ymf(){return"Print_32x32x32"}get l6f(){return uj.Jmb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get T0a(){return uj.Jmb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get xrd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Tc.W4b){let k=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==n.AFrameworkApplication.ta.Rb.Xxh&&(k=n.AFrameworkApplication.ta.Rb.Xxh);Array.add(b,k)}return uj.Jmb?b:null}get d9b(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get WQc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get lDc(){return n.AFrameworkApplication.rXa?
"UIFontDialogTextLarge":null}Rxf(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Sxf(){n.AFrameworkApplication.Hm.PZa(9540);v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}lRc(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get Jmb(){return!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(X.a.I2||X.a.Ak||X.a.gj||X.a.Afa)&&!n.AFrameworkApplication.MPc&&
n.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Jmb(b){}}Object(m.a)(uj,"PrintDialogWithLinkToPdf",Tc,[]);class oj{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.Bkm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.jhm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.xLb=(b.DirectPrintSupportedMimeTypes||"").split(oj.J4e);this.zlb=(b.DirectPrintSupportedPlugins||"").split(oj.J4e);this.c2l=(b.DirectPrintImmersivePreviewPlugins||
"").split(oj.J4e);this.Bdi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.Cbm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.bxk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.JAf=14;this.Lsi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const k=b.split(".");2===k.length?(this.JAf=parseInt(k[0]),this.Lsi=parseInt(k[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}oj.J4e=",";Object(m.a)(oj,"DirectPrintBrsSettings",null,[]);class ti{constructor(b,k){this.X3f=b;this.zlb=k}}Object(m.a)(ti,"DirectPrintProbeResults",null,[]);var Th=c(199);class di{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.ipd=null;this.$Cj=b;this.ksc=k;this.$ze=r;this.pKj=y;this.wLj=R;this.auc=new cg.a(Object(u.a)(this,this.TGl,"getProbeResults"));this.tmc=aa;this.ZPg=xb;this.BV=ta;this.lqc=Ya;this.RLj=
Mb}get OP(){return this.$Cj}start(){}Lan(){this.OP.Bkm&&this.wCm()}zfn(){const b=Array(this.OP.xLb.length);if(void 0!==this.ksc&&null!==this.ksc)for(let k=0;k<this.OP.xLb.length;k++)b[k]=this.OP.xLb[k]in this.ksc&&this.pKj(this.ksc[this.OP.xLb[k]]);return b}Afn(){const b=Array(this.OP.zlb.length),k=!(void 0===this.$ze||null===this.$ze);for(let r=0;r<this.OP.zlb.length;r++){const y=this.OP.zlb[r];b[r]=k&&y in this.$ze?!0:this.wLj(y)}return b}zMl(){const b=this.zfn(),k=Array(b.length);for(let r=0;r<
b.length;r++)k[r]=b[r]?this.f8k(this.ksc[this.OP.xLb[r]]):null;return k}f8k(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}wCm(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.auc.value.X3f,this.auc.value.zlb)}TGl(){var b=this.zMl();const k=this.Afn(),r={},y={};for(let R=0;R<this.OP.xLb.length;R++)r[this.OP.xLb[R]]=b[R];for(b=0;b<this.OP.zlb.length;b++)y[this.OP.zlb[b]]=k[b];return new ti(r,y)}qYn(){return this.RLj||!this.OP.isEnabled||
n.AFrameworkApplication.MPc?!1:this.N6n()}wYn(){if(null!=this.ipd)return this.ipd;const b=di.Adi(this.OP);return this.ipd=this.OP.Bdi&&b||this.Bbm()}Bbm(){return X.a.yp&&this.OP.Cbm&&X.a.axk>=this.OP.bxk?!0:!1}N6n(){if(!this.lqc(this.OP))return!1;var b=Ba.a.aJd(this.auc.value.X3f);for(const k of b)if(void 0!==k&&null!==k)return!0;b=Ba.a.aJd(this.auc.value.zlb);for(const k of b)if(k)return!0;return!1}VXl(){const b=Ba.a.aJd(this.auc.value.X3f);for(const k of b)if(Th.a.contains(this.OP.c2l,k))return!0;
return!1}K_n(b,k=null){n.AFrameworkApplication.ta&&n.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.ZPg(b,k):this.qYn()?this.vZk(b,this.VXl()&&!0,k):this.ZPg(b,k)}vZk(b,k,r=null){const y=this.BV.jg("UserAction","OpenDirectPrintDialog");this.tmc.Drl(b,k,r).MAa();y.stop()}static hnm(b){try{return new ActiveXObject(b),!0}catch(k){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static tem(b){return void 0===b||null===b?!1:
!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const k=new oj(n.AFrameworkApplication.K.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Mb){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let y=null;try{y=window.navigator.plugins}catch(Mb){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const R=di.tem,aa=di.hnm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=n.AFrameworkApplication.ta.lq,
Ya=di.jnm,xb=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&!n.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new di(k,r,y,R,aa,b,ta,Ya,(Mb,cc)=>new uj(Mb,!1,cc,!0,xb),n.AFrameworkApplication.aua)}static jnm(b){return X.a.yp||X.a.Ak&&b.jhm||b.Bdi&&di.Adi(b)?!0:!1}static Adi(b){var k=X.a.M0b;if(k){var r=k.split(".");if(2===r.length)return k=parseInt(r[0]),r=parseInt(r[1]),k>b.JAf||k===b.JAf&&r>=b.Lsi}return!1}}Object(m.a)(di,"DirectPrintManager",null,[500]);class Nj{constructor(){this.dpb=
this.W=null}get name(){return"Common.App.DirectPrint"}zc(b){this.W=b;b.register(Ac,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Zd(()=>new Ac(n.AFrameworkApplication.ta.U_));b.register(500,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Zd(()=>di.create(this.W))}init(){this.dpb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.dpb.start()}dispose(){}}Object(m.a)(Nj,"PackageManager",null,[1,2]);class im{constructor(b,k=3E4){this.B6f=9E5;this.D6f=
1E4;this.Vpi=this.z9b=null;this.Wyf=0;this.Vbb=Date.now;this.PId=b;this.ybe=k;this.tEd()}C1h(b=!0){const k=this.Vbb();if(k<this.Wyf+this.B6f)return k>this.Wyf+this.D6f&&this.tEd(),this.Vpi;b&&this.tEd();return null}getToken(b=!0){return(b=this.C1h(b))?Promise.resolve(b):this.tEd()}tEd(){return this.z9b=this.z9b||new Promise(b=>{this.PId().then(k=>{this.z9b=null;""!==k&&k&&(this.Vpi=k,this.Wyf=this.Vbb(),b(k));b(null)}).catch(()=>{this.z9b=null;b(null)});window.setTimeout(()=>{this.z9b=null;b(null)},
this.ybe)})}}Object(m.a)(im,"OAuthCacheManager",null,[]);class Hg{static kta(b){return""!==b&&b?Hg.Yck[b.toLowerCase()]:""}static vOl(b,k){const r=Date.now();var y=Hg.dFk();const R=n.AFrameworkApplication.K.lb("UserPrincipalName"),aa=Hg.kta(b);v.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===R||!R)return v.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===aa||!aa)return v.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
b),Promise.resolve("");const ta=Ra.a.create().toString();y=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",aa,encodeURIComponent(k),encodeURIComponent(R),encodeURIComponent(y),ta);const Ya=document.createElement("iframe");Ya.style.display="none";Ya.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Ya.src=y;document.body.appendChild(Ya);
return new Promise(xb=>{Hg.ALm(Ya.contentWindow).then(Mb=>{document.body.removeChild(Ya);const cc=new Fc.a,jc=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Mc;for(;Mc=jc.exec(Mb);)3!==Mc.length&&(v.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Mc.length),xb("")),cc.Z(Mc[1],Mc[2]);cc.ub("access_token")?(v.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",k,b,Date.now()-r),xb(cc.J("access_token"))):
(v.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",k,b,(Date.now()-r).toString()),xb(""))}).catch(Mb=>{try{document.body.removeChild(Ya)}catch(cc){}v.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",k,b,JSON.stringify(Mb),(Date.now()-r).toString());xb("")})})}static dFk(){const b=window.location.protocol,k=window.location.host;var r=n.AFrameworkApplication.K.lb("OAuthManagerHostPathOverride");
if(void 0===r||null===r){r=window.location.pathname;const y=r.lastIndexOf("/");r=0<=y?r.substring(0,y+1):""}return b+"//"+k+r+"WacOAuth.html"}static ALm(b){return new Promise((k,r)=>{let y=0,R=0;R=window.setInterval(()=>{if(200<y++)window.clearInterval(R),r("Exceeded 10000ms timeout after 200 polls");else{var aa=null,ta=null;try{if(!b||b.closed){window.clearInterval(R);r("Window or Frame is closed before completion");return}aa=b.location.href;ta=b.location.hash}catch(Ya){}aa&&"about:blank"!==aa&&
ta&&""!==ta&&(window.clearInterval(R),k(ta))}},50)})}}Hg.Yck={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(m.a)(Hg,"OAuthHelper",null,[]);class ah{constructor(b,k){this.token=b;this.source=k}}Object(m.a)(ah,"TokenResult",null,[]);var Ji=c(99),Jh=c(247);class Dl{constructor(){this.d7=null;this.uEg={};this.tokenCache=new oa.a(ka.a.Sj())}getToken(b,k,r=!1){if(this.tokenCache.ub(k))return this.tokenCache.J(k).getToken();const y=new im(()=>
r?this.D1h(b,k):this.PId(b,k));this.tokenCache.Z(k,y);return y.getToken()}tOl(b,k,r=!1){if(this.tokenCache.ub(k))return this.tokenCache.J(k).C1h();const y=new im(()=>r?this.D1h(b,k):this.PId(b,k));this.tokenCache.Z(k,y);return null}PId(b,k){const r=Date.now();return Hg.vOl(b,k).then(y=>new ah(y,"SSOStack")).then(y=>new Promise(R=>{y.token&&""!==y.token?(v.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,y.source,Date.now()-r),this.skb("GetTokenInternal",!0,Date.now()-
r,b,"","",k),R(y.token)):(v.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-r),this.skb("GetTokenInternal",!1,Date.now()-r,b,"GetTokenSilent Failed","SSO Token provider failed!",k),R(""))}))}D1h(b,k){if(!this.d7)try{this.d7=Va.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.d7?new Promise(r=>{const y=Date.now();this.d7.Qoa(b,k).then(R=>{const aa=R.Token;
!R.IsSuccess||this.nom(aa)?(this.skb("GetTokenInternalImplicitJS",!1,Date.now()-y,b,R.ErrorCode,R.ErrorMessage,k),r(null)):(this.skb("GetTokenInternalImplicitJS",!0,Date.now()-y,b,R.ErrorCode,R.ErrorMessage,k),r(aa))}).catch(R=>{R=R?x.c(R):"";this.skb("GetTokenInternalImplicitJS",!1,Date.now()-y,b,"Caught Exception",R,k);r(null)})}):new Promise(r=>{this.skb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}skb(b,k,r,y,R="",aa="",ta=""){var Ya="Search"===y;const xb=
[];b=Ji.a.Kea(Ya?"Event":"EventName",b,2);y=Ji.a.Kea("AppName",y,2);Array.add(xb,b);Array.add(xb,y);Ya&&(y=Ji.a.Kea("LatencyType","FetchToken",2),Array.add(xb,y));R&&""!==R&&(R=Ji.a.Kea("ErrorCode",R,2),Array.add(xb,R));aa&&""!==aa&&(aa=Ji.a.Kea("ErrorMessage",aa,2),Array.add(xb,aa));ta&&""!==ta&&(aa=!(ta in this.uEg),this.uEg[ta]=aa,aa=Ji.a.Kea("WarmUpCall",aa.toString(),1),Array.add(xb,aa),ta=Ji.a.Kea("Service",this.EKl(ta),2),Array.add(xb,ta));Ya=Ya?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
k=Object.assign(new Jh.a,{name:Ya,samplingPolicy:2,dataFields:xb,succeeded:k,durationMs:r});Y.a.sendActivityEvent(k)}EKl(b){return b===n.AFrameworkApplication.Iyf?"Loki":b===n.AFrameworkApplication.P3f?"Substrate":n.AFrameworkApplication.K&&b===n.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}nom(b){return!b||!b.length}}Object(m.a)(Dl,"SearchOAuthManager",null,[459]);class Bh{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}zc(b){this.W=
b;this.W.register(459,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Zd(()=>new Dl)}init(){}dispose(){}static main(){M.a.instance.Pc(new Bh)}}Object(m.a)(Bh,"SearchOAuthPackage",null,[1,2]);var Ge=c(216),Wd=c(6),Pd=c(21),rf=c(19),ie=c(11);class rd{constructor(b,k,r){this.RAe=this.ltb=this.OAe=this.ktb=this.Dxe=null;this.zUl=y=>{try{this.yUl(y)}catch(R){y=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",R.message,R.stack),v.ULS.sendTraceTag(5285580,
334,10,y)}};this.Ep=b;this.KDj=k;this.hb=r;this.init()}init(){this.KDj.mb(this.zUl);this.ktb=new xc.a;this.OAe=new xc.a;this.ltb=new xc.a;this.RAe=new Ge.a}w3(b){this.ktb.add(b.key,b)}ncc(b){this.ltb.add(b.key,b)}yUl(b){let k;({i2e:k}=rd.dfo(this.hb.ib.kb)).returnValue&&(b=rd.fpl(b,this.Dxe,k),this.fbn(b,k),this.Dxe=k)}fbn(b,k){b=this.Vil(b,k);let r;({notification:r}=rd.Veo(b)).returnValue&&this.Ep.sendNotification(r,!1)}Vil(b,k){const r=new xc.a;r.Z(1,new Ge.a);r.Z(0,new Ge.a);b.forEach(y=>{3===
y?(rd.h0f(k.node)||this.yyn(k),this.NEl(r,k)):y||this.Epl(r,k);return!0});return r}yyn(b){this.ktb.forEach((k,r)=>{r.reset(b);return!0})}Epl(b,k){let r=new xc.a;rd.h0f(k.node)||(r=this.Cpl(k.cpBegin));this.Dpl(b,this.OAe,r,rd.WXi(this.Dxe,k));this.OAe=r}Cpl(b){const k=new xc.a;this.ktb.forEach((r,y)=>{r=null;({VE:r}=y.qFa(b)).returnValue&&k.Z(y.key,r);return!0});return k}Dpl(b,k,r,y){const R=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;k.forEach((aa,ta)=>{const Ya=this.ktb.J(aa).qw||ta.title;
let xb;({value:xb}=r.Bc(aa)).returnValue?y&&xb.contentObject!==ta.contentObject&&(Ya&&b.J(1).add(Ya),aa=this.ktb.J(aa).qw,aa=String.format(R,xb.title,aa),xb.description&&(aa+=", "+xb.description),b.J(0).add(aa)):Ya&&b.J(1).add(Ya);return!0});r.forEach((aa,ta)=>{k.ub(aa)||(aa=this.ktb.J(aa).qw,aa=String.format(R,ta.title,aa),ta.description&&(aa+=", "+ta.description),b.J(0).add(aa));return!0})}NEl(b,k){k=this.SLl(k.node);k=this.FAk(k);this.TLl(b,this.RAe,k);this.RAe=k}SLl(b){const k=new Wd.GraphIterator;
k.set(b);if(!k.Ab(1))return null;const r=new Ge.a;for(;1!==k.Le;)this.ltb.forEach((y,R)=>{let aa;({uka:aa}=R.lhc(k)).returnValue&&r.add(aa);return!0}),k.mc();r.reverse();return r}FAk(b){b=b.toArray();let k=0;for(;k<b.length-1;){var r=b[k];if(r.YF===b[k+1].YF&&(this.ltb.J(r.YF),({IAk:r}={returnValue:!1,IAk:null}).returnValue)){b.splice(k,2,r);continue}k++}return new Ge.a(b)}TLl(b,k,r){var y;for(y=0;y<Math.min(r.length,k.length)&&r.J(y).contentId.equals(k.J(y).contentId);y++){var R=this.ltb.J(r.J(y).YF).xAb(r.J(y),
k.J(y));R&&(r.J(y).description&&(R+=", "+r.J(y).description),b.J(0).add(R))}for(R=y;R<r.length;R++){let aa=this.ltb.J(r.J(R).YF).xAb(r.J(R),null);aa&&(r.J(R).description&&(aa+=", "+r.J(R).description),b.J(0).add(aa))}for(r=y;r<k.length;r++)(y=this.ltb.J(k.J(r).YF).qw)&&b.J(1).add(y)}static fpl(b,k,r){const y=new Ge.a;(b=b||rd.TGn(k,r))?(y.add(3),y.add(0)):rd.WXi(k,r)&&y.add(0);return y}static TGn(b,k){return!b||!b.node.id.equals(k.node.id)}static WXi(b,k){return!b||!b.equals(k)}static dfo(b){let k=
null;if(!b||!(rf.SelectionEditor.Dm(b)||(b=rf.SelectionEditor.Qj(b,!0,!1),rf.SelectionEditor.Dm(b)||b.Qa&&rd.h0f(b.Qa.node))))return{returnValue:!1,i2e:k};k=b.Qa;return{returnValue:!!k,i2e:k}}static Veo(b){const k=new Ge.a;b.J(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);k.add(r);return!0});b.J(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);k.add(r);return!0});b=k.toArray().join(" ");return{returnValue:0<
k.length,notification:b}}static h0f(b){return Pd.ImageReader.Ov(b)||ie.ParagraphReader.tka(b)}}Object(m.a)(rd,"AccessibilityContextManager",null,[450]);class Nk{constructor(b,k){this.qNg=!1;this.lvc=null;this.Ald=this.apd=!1;this.QDg=null;this.Brd=(r,y)=>{(y.eR||y.ioa)&&this.ePm(y.eR,y.ioa)};this.Hb=b;this.LM=k}get FYl(){return!!this.lvc}mb(b){this.qNg||(this.LM.qah(this.Brd),this.qNg=!0);this.QDg=b}ePm(b,k){this.FYl&&this.Hb.Ye(this.lvc);this.apd=this.apd||b;this.Ald=this.Ald||k;this.lvc=new nd.a(5,
1,Nk.l6k,()=>{this.QDg(this.apd,this.Ald);this.reset()},126);this.Hb.fc(this.lvc)}reset(){this.lvc=null;this.Ald=this.apd=!1}}Nk.l6k=100;Object(m.a)(Nk,"EditingViewOnAfterValidateEventsConsolidator",null,[449]);var bh=c(53);class yi{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Ka.App.qfh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}zc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new Nk(n.AFrameworkApplication.uc,
b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>new rd(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),bh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){M.a.instance.Pc(new yi)}}Object(m.a)(yi,"Box4AccessibilityPackage",null,[1,2]);
var Db=c(126),Ic=c(1022),Jd=c(1574),Ne=c(876),Ee=c(170),$f=c(1481),sf=c(48),Ke=c(24),sh=c(141),Re=c(33);class dh extends $f.a{get Wta(){return null!=this.Rng?this.Rng:this.Rng=Va.a.instance.Pa("Box4.IInternalLinkManager")}get RGi(){return null!=this.Jqg?this.Jqg:this.Jqg=Va.a.instance.Pa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get VB(){return!0}get commandId(){return Wa.a.Whk}Tka(b){Ee.a.mark(7012);const k=new sf.GraphTransaction(15);k.Eb(b);var r=this.QF,y=this.c_,R=ie.ParagraphReader.text(b),
aa=R.substring(r,y);const ta=({ISc:Ya}=A.a.x3f(aa)).returnValue;aa!==ta&&(r+=Ya,y=r+ta.length);aa=Re.a.createTextRange(b,r,y);var Ya=R.substring(r,y);dh.dhm(R,r,y)&&(this.Yd.replaceTextRange(Re.a.createTextRange(b,r-1,y+1),Ya,!0,!1),--r,--y,aa=Re.a.createTextRange(b,r,y),r=Ke.SelectionFactory.xe(b,y),bh.a.instance.setSelection(r));r=sh.HyperlinkReader.bMa(Ya);dh.hyperlinkEditor.VG(aa,r,!1);R=Ya="";y=!1;this.Wta&&({hSf:Ya,QLh:R}=this.Wta.v7f(r)).returnValue&&(r=Ya,y=!0,Ya=sh.HyperlinkReader.aD(aa,
!1),dh.hyperlinkEditor.VQ(Ya[0].paragraph,Ya[0].hyperlink),""!==R&&(this.Yd.replaceTextRange(aa,R,!0,!1),aa=Re.a.createTextRange(b,this.QF,this.QF+R.length),b=Ke.SelectionFactory.xe(b,this.QF+this.QF+R.length),bh.a.instance.setSelection(b)),dh.hyperlinkEditor.VG(aa,r,!1));k.dispose();!y&&this.RGi&&this.RGi.$8m(aa,r);Ee.a.mark(7013)}set VB(b){super.VB=b}static get hyperlinkEditor(){return null!=dh.Olg?dh.Olg:dh.Olg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static dhm(b,k,r){r=r!==b.length&&('"'===
b.charAt(r)||"\u201d"===b.charAt(r));return!!k&&('"'===b.charAt(k-1)||"\u201c"===b.charAt(k-1))&&r}}Object(m.a)(dh,"HyperlinkAction",$f.a,[]);class Ck{constructor(b){this.Yd=b}ULk(b,k,r){return new dh(null,b,k,r,this.Yd)}}Object(m.a)(Ck,"HyperlinkActionFactory",null,[448]);var mh=c(246);class vh{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}zc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new Jd.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),
mh.a.instance,n.AFrameworkApplication.ya,n.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new Ic.a(b.resolve("Box4.IRoamingServiceRequestManager"),n.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Ne.a(b.resolve("Box4.IAutoCorrectRules"),
bh.a.instance,Db.a.instance,n.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Ck(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").Kum();const b=
n.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").vkl()}dispose(){}static main(){M.a.instance.Pc(new vh)}}Object(m.a)(vh,"Box4AutoCorrectPackage",null,[1,2]);class zg{get name(){return"Box4.Clipboard"}init(){}dispose(){}zc(){}static main(){M.a.instance.Pc(new zg)}}Object(m.a)(zg,"Box4ClipboardPackage",null,[1,2]);class zi{get name(){return"Box4.ImageEditors"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new zi)}}
Object(m.a)(zi,"Box4ImageEditorsPackage",null,[1,2]);class Qh{F4i(){return{E4i:!0,fnj:!1}}}Object(m.a)(Qh,"CursorMovementValidator",null,[462]);class Rl{mIi(b,k,r,y,R,aa){return b?n.AFrameworkApplication.ya.Vf(b,k,r,!0,R,aa):8}}Object(m.a)(Rl,"ListContextManager",null,[447]);class kh{get name(){return"Box4.ListEditors"}zc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new Qh).as("Box4.List.ICursorMovementValidator").singleInstance();b.ha("Box4.ListEditors.ListContextManager",()=>new Rl).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){M.a.instance.Pc(new kh)}}
Object(m.a)(kh,"Box4ListEditorsPackage",null,[1,2]);class nk{get name(){return"Box4.NotebookLevelEditors"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new nk)}}Object(m.a)(nk,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Lh=c(1491),Rh=c(130),wf=c(769),lc=c(14);const Bm=(b,k,r,y,R)=>{if(k.contextId===lc.a.view)switch(b){case Wa.a.search:return Ka.App.xa.jb.Pua.veo(),Ka.App.yM.I0i(),32;case Wa.a.findOnPage:return 1!==r&&(Ka.App.xa.jb.Pua.veo(),Ka.App.yM.jZf()),32;case Wa.a.gTi:return Ka.App.xa.jb.Fc&&
Ka.App.xa.jb.Fc.yi?(1!==r&&(wf.a.LJb?Ka.App.yM.bzn():Ka.App.yM.jZf()),b=32):b=8,b;case Wa.a.Mwb:case Wa.a.vlh:return 1===r?b=wf.a.LJb?32:8:(Ka.App.yM.bzn(),b=32),b;case Wa.a.Q0d:return 1!==r&&Ka.App.yM.nJd(),32;case Wa.a.LHi:return(b=Qe.a.wLa(document.body.ownerDocument))&&b.id===Rh.AppFrame.cXi&&Ka.App.yM.nJd(),32;case Wa.a.jWd:return 1!==r&&Ka.App.yM.mJd(),32;case Wa.a.Xui:return(b=Qe.a.wLa(document.body.ownerDocument))&&b.id===Rh.AppFrame.cXi&&Ka.App.yM.mJd(),32;case Wa.a.D_i:return Ka.App.yM.nNo(),
32;case Wa.a.SYc:return Ka.App.yM.SYc(),32;case Wa.a.pmf:return 1!==r&&"string"===typeof R&&Ka.App.yM.pmf(R),32;case Wa.a.LWi:return 1!==r&&Ka.App.yM.jZf(),32;case Wa.a.MWi:return 1!==r&&Ka.App.yM.I0i(),32;case Wa.a.m8g:return Ka.App.yM.nIo(),32;case Wa.a.eXi:return Ka.App.yM.I0i(),"string"===typeof R&&(Ka.App.yM.een(R),wf.a.LJb=!0),32;case Wa.a.OCd:return Ka.App.yM.jZf(),"string"===typeof R&&(Ka.App.yM.een(R),wf.a.LJb=!0),32}return 2};class Rd{get name(){return"Box4.Search"}zc(b){b.ha("Box4.Search.FindManagerHelper",
()=>Lh.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){Zb.a.rXc(Bm)}dispose(){}}Object(m.a)(Rd,"PackageManager",null,[1,2]);class qe{get name(){return"Box4.TableEditors"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new qe)}}Object(m.a)(qe,"Box4TableEditorsPackage",null,[1,2]);class ok{get name(){return"Box4.TextLevelEditors"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new ok)}}Object(m.a)(ok,"Box4TextLevelEditorsPackage",null,[1,2]);var jj=
c(101),Di=c(373),td=c(106),rn=c(626),dd=c(1502);class Ok{constructor(b,k,r){this.uv=this.aHa=this.dJa=null;this.AD=this.Ime=this.tGa=0;this.Nia=this.Tdd=this.FSa=this.ESa=!1;this.Bcd=this.NJg=this.QJg=0;this.eya=b;this.ga=k;this.Om=r}bO(b){return!Ka.App.xa.jb.isEditingAllowed||Ae.SessionStatusManager.instance.Tj?!1:""!==this.yIc(b.Af)}wK(b){if(!this.bO(b))return!1;this.qNn(b);this.AD=this.eya.N2b();this.fQn(b);this.gQn();({S6b:this.Tdd,q8b:this.Nia}=this.k1i(this.Ime));this.hQn();this.dJa=b.pH;this.uv=
new Sys.UI.Point(0,0);[this.QJg,this.NJg]=this.eya.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}dU(b){this.aHa=b.pH;this.pqk();this.Bcd=dd.b(this.uv.x,this.uv.y,this.QJg,this.NJg,this.Tdd,this.Nia,this.Bcd,n.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.eya.C9f(this.Bcd,this.Tdd,this.Nia);return!0}mD(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}sX(){this.eya.PUf();v.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}qNn(b){this.eya=jj.a.Db(b.Af,rn.a)}gQn(){this.Ime=(Math.floor((this.AD+22)/45)%8+this.tGa)%8}k1i(b){let k,r;if(this.AD&&90!==this.AD&&180!==this.AD&&270!==this.AD&&360!==this.AD||this.ghm(b))return{S6b:!0,q8b:!0};k=r=!1;switch(b){case 1:case 5:k=!0;break;case 3:case 7:r=!0}return{S6b:r,q8b:k}}hQn(){this.FSa=this.ESa=!1;switch(this.Ime){case 0:this.FSa=this.ESa=!0;break;case 1:case 2:this.FSa=!0;break;case 7:case 6:this.ESa=!0}}ghm(b){return!(b%2)}yIc(b){var k=
b.classList.toString();-1===k.indexOf("WACImageResizeHandle")&&b.parentNode&&(k=b.parentNode.classList.toString());b=k.split(" ");for(k=0;k<b.length;k++){const r=b[k].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}fQn(b){switch(this.yIc(b.Af)){case "WACImageResizeHandleNW":this.tGa=0;break;case "WACImageResizeHandleN":this.tGa=1;break;case "WACImageResizeHandleNE":this.tGa=2;break;case "WACImageResizeHandleE":this.tGa=3;break;case "WACImageResizeHandleSE":this.tGa=
4;break;case "WACImageResizeHandleS":this.tGa=5;break;case "WACImageResizeHandleSW":this.tGa=6;break;case "WACImageResizeHandleW":this.tGa=7}}pqk(){var b=1;this.Om.instance&&(b=this.Om.instance.vj);const k=(this.aHa.x-this.dJa.x)/b;b=(this.aHa.y-this.dJa.y)/b;this.uv.x=this.ESa?-k:k;this.uv.y=this.FSa?-b:b}setSize(){const b=new Di.DictionaryPropertySet;b.setValue(td.a.WLc,100*this.Bcd);b.setValue(td.a.l8h,!0);if(90===this.AD||270===this.AD){let k,r;({S6b:k,q8b:r}=this.k1i(this.tGa));b.setValue(td.a.Vmf,
k);b.setValue(td.a.Wmf,r)}else b.setValue(td.a.Vmf,this.Tdd),b.setValue(td.a.Wmf,this.Nia);this.ga.Xb(Wa.a.r5b,2,b)}}Object(m.a)(Ok,"ImageResizeDragAdapter",null,[199]);var Rg=c(127),Cm=c(864);class vj{constructor(b,k,r,y){this.dte=this.aHa=this.dJa=this.Okd=null;this.Jhd=this.Jpd=0;this.Gb=null;this.ga=b;this.hb=k;this.Om=r;this.nQg=this.Nya=0;this.Zc=y}bO(b){return Ka.App.xa.jb.isEditingAllowed&&!Ae.SessionStatusManager.instance.Tj&&b&&this.Hlm(b.Af)?(this.Okd=this.hb.Jg)?!0:!1:!1}kDd(){}Khf(){return null}wK(b){if(!this.bO(b))return!1;
this.eya=jj.a.Db(b.Af,rn.a);if(!this.eya)return!1;this.rld=this.eya.G7;if(!this.rld)return!1;this.Okd=this.hb.Jg;this.Gb=Pd.ImageReader.Sm(this.Okd);if(!this.Gb)return!1;this.dJa=this.DLa(b);this.dte=Sys.UI.DomElement.getBounds(this.rld);this.Jpd=0<Pd.ImageReader.nGd(this.Gb)?Pd.ImageReader.nGd(this.Gb):0;this.Jhd=Pd.ImageReader.mff(this.Gb);return!0}dU(b){this.aHa=this.DLa(b);this.xqk();if(this.eya)return this.eya.rde(this.Nya,this.nQg),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}mD(){this.Jpd=this.Nya=dd.c(this.Nya);this.IX()}sX(){this.eya.rde(this.Jhd,0)}Hlm(b){return b.classList.contains(Cm.c)||b.classList.contains(Cm.b)||b.classList.contains(Cm.a)||!!b.parentElement&&b.parentElement.classList.contains(Cm.a)}DLa(b){return this.Zc.yd.sYa(b)}xqk(){var b=1;this.Om&&this.Om.instance&&(b=this.Om.instance.vj);var k=new Sys.UI.Point(this.dte.x+this.rld.clientWidth/2*b,this.dte.y+this.rld.clientHeight/2*b);b=dd.a(this.dJa,k);k=dd.a(this.aHa,k);this.Nya=Math.round(Rg.a.hgn(k-
b));0<this.Jpd&&(this.Nya+=this.Jpd-this.Jhd);this.nQg=this.Nya;this.Nya+=this.Jhd}IX(){const b=new Di.DictionaryPropertySet;b.setValue(td.a.TLc,0);b.setValue(td.a.jK,this.Nya);this.ga.Xb(Wa.a.imageRotate,2,b)}}Object(m.a)(vj,"ImageRotateDragAdapterSimplified",null,[440,199]);class Hm{constructor(){this.W=null}get name(){return"Box4.Images"}zc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new Ok(null,n.AFrameworkApplication.ya,Va.a.instance.$a("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new vj(n.AFrameworkApplication.ya,bh.a.instance,Va.a.instance.$a("Common.IZoomManager"),Bb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){M.a.instance.Pc(new Hm)}}Object(m.a)(Hm,"Box4ImagesPackage",null,[1,2]);var vq=c(285),Gh=c(115),wc=c(5),Og=c(684),Ri=c(489),
vi=c(683),gh=c(20),pk=c(269),ml=c(271),co=c(1687),Im=c(1737),Kn=c(1185);class jm extends Im.a{constructor(b,k,r){super(b,k,r);this.Qid=this.D$a=null}get PX(){return n.AFrameworkApplication.ta.lq}HFd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}Wde(b){return jm.Rwa(b,this.g2h())}g2h(){return jm.nMe}Rwa(b,k=null){b=this.Wde(b);return 0!==b?(k&&k.Gqd(),2===b&&(k=this.HFd(b),this.Bp(this.CRh(b),
k)),!1):!0}pLa(b,k){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.yJf=k;Ee.a.mark(5576);this.Qid=this.PX.jg("LoadResource","PictureUploadTime");this.ZMd()?this.A4d(b):this.aUc()}Bp(b,k){const r=new cf.StandardDialog;r.Gd=0;r.my(b,CommonUIStrings.l_ImageUploadFailedTitle,k,null)}aUc(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.aUc();this.Qid&&(this.Qid.stop(),this.Qid=null)}cLb(){this.D$a=(new Kn.a).create();this.D$a.message=CommonUIStrings.l_ImageUploadWait;
this.D$a.Gd=5;this.D$a.It=!1;this.D$a.rM(null,null,null)}qvd(){this.D$a&&(this.D$a.close(),this.D$a=null)}static UYl(b,k){b=A.a.mh(b);for(let r=0;r<k.length;++r)if(b.endsWith(k[r]))return!0;return!1}static Rwa(b,k=null){k||(k=jm.nMe);return b?jm.UYl(b,k)?0:2:1}}jm.nMe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(jm,"PictureUploader",Im.a,[]);var Xk;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(Xk||(Xk={}));Object(m.b)("PictureValidationResult",Xk);var Vf=c(60),Te=c(16),Hk=c(45);class El{constructor(){this.fT=null}}Object(m.a)(El,"ImageData",null,[]);var pj=c(54),Sj=c(1688),Fn=c(1548),gk=c(1579);class eo extends yf.a{constructor(b,k=!0){super(!1,!1,eo.LK);this.kUb=null;this.CFg=!1;this.Hx=[];this.es=null;this.F$a=b;this.JVj=k;this.K8=this.y3g=!1;this.lVa=null;this.Mpe=!1;this.vg=this.nXk;this.lg="InsertFileDialog";this.We(1,this.$pd);eo.LK?(this.kUb=
{["id"]:this.lg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(u.a)(this,this.j0m,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(u.a)(this,this.PUm,"onFrameReady")},this.Vh(this.titleText,Object(u.a)(this,this.OMd,"insertDialogHandler"),this.kUb),this.DR=!0):(this.showDialog(this.titleText,Object(u.a)(this,this.OMd,"insertDialogHandler")),k&&this.oSn(),(b=this.BEd(1))&&this.Hx.push(b),
(b=this.BEd(0))&&this.Hx.push(b),this.gjj(),this.DR=!1)}get Rkj(){return this.F$a}validate(){this.es.fT||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.es.fT.value?!0:(eo.my(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}PUm(b){this.JVj&&(this.es=this.l2i(b,this.F$a))}j0m(){this.es&&this.es.fT&&(this.CFg||(this.es.Lon(Object(u.a)(this,this.WGf,"onFileChosen")),this.CFg=!0),this.es.rIh())}WGf(b){this.kUb.uploadStatusLabel=b;this.k8(this.titleText,Object(u.a)(this,
this.OMd,"insertDialogHandler"),this.kUb)}OMd(b){1===b&&this.isEnabled()?eo.LK&&this.es.fT&&!this.es.fT.value?(this.kUb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.k8(this.titleText,Object(u.a)(this,this.OMd,"insertDialogHandler"),this.kUb)):(this.uLd(),this.F$a.pLa(this.es,Object(u.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}oSn(){this.Mpe=!1;this.es=this.l2i(document.getElementById("uploadFrameContainer"),this.F$a);n.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.lVa=Object(u.a)(this,this.zJf,"onUploadFrameLoad"),Af.a.addHandler(this.es.iFrame,"load",this.lVa));this.es.fT||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.uIi()}zJf(){this.uIi()}uIi(){if(this.es&&!this.Mpe){var b=this.es.fT;b&&(Af.a.addHandler(b,Kb.a.ni,Object(u.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.Hx=b.concat.apply(b,this.Hx),this.gjj(),this.Mpe=!0)}}dispose(){if(this.es&&!eo.LK){const b=this.es.fT;b&&Af.a.removeHandler(b,Kb.a.ni,Object(u.a)(this,
this.onKeyDown,"onKeyDown"));this.lVa&&Af.a.removeHandler(this.es.iFrame,"load",this.lVa)}this.es=null;super.dispose()}gjj(){if(0<this.Hx.length){const b=new We(this.Hx),k=Id.FocusManager.instance().Fs();k&&(this.Hx[0].focus(),k.Wj=b,k.$T=!0)}}onKeyDown(b){4!==Id.FocusManager.instance().yIi(b)&&b.preventDefault()}static get LK(){return n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.ta.Rb.Ihi}static my(b){const k=document.getElementById("errorText");k.innerText=b;k.style.display="inline-block"}}
Object(m.a)(eo,"InsertFileDialog",yf.a,[]);class Dg{static get vg(){return yf.a.Rx(Dg.tl,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Dg.tl="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(m.a)(Dg,"InsertImageDialogHtml",null,[]);class Ml extends eo{constructor(b,
k=!0){super(b,k)}get $pd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get nXk(){return Dg.vg}validate(){this.es.fT||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(ia.a)(jm,this.Rkj);const k=b.Wde(this.es.fT.value);return 0!==k?(b=b.HFd(k),eo.my(b),!1):!0}}Object(m.a)(Ml,"InsertImageDialog",eo,[]);class Mm extends Ml{constructor(b){super(b)}l2i(b,k){const r=n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.ta.Rb.Ihi;
return new gk.a(b,Object(u.a)(k,k.sac,"onUploadFrameInitialized"),Object(u.a)(k,k.Kwa,"uploadResponseReceived"),n.AFrameworkApplication.K,!r)}isEnabled(){return Mm.PL.Nda(this.Rkj.context)}static get PL(){return null!=Mm.amg?Mm.amg:Mm.amg=Va.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(Mm,"Box4InsertImageDialog",Ml,[]);class Ln{TGk(b){return new Promise((k,r)=>{this.UGk(b).then(y=>{k(y)},y=>{r(y)})})}Nsh(b){return new Promise((k,r)=>{const y=new FileReader;y.addEventListener("load",
()=>{k(y.result)},!1);y.addEventListener("error",()=>{r("FileReader exception ("+y.error.name+")")});y.readAsDataURL(b)})}UGk(b){return new Promise((k,r)=>{this.Nsh(b).then(y=>{this.i_e(y,"image/jpeg").then(R=>{k(R)},R=>{r(R)})},y=>{r(y)})})}i_e(b,k){return new Promise((r,y)=>{let R=new Image;R.addEventListener("load",()=>{const aa=document.createElement("canvas"),ta=aa.getContext("2d");aa.width=R.width;aa.height=R.height;ta.drawImage(R,0,0);r(aa.toDataURL(k))});R.addEventListener("error",()=>{y("Image failed to load")});
R.src=b})}}Object(m.a)(Ln,"ImageFormatConverter",null,[]);const Pk=["ImageInsertFailed"];class Tj extends jm{constructor(b,k,r,y,R,aa,ta=!0){super(b,k,r);this.bya=this.$l=this.pG=this.Te=null;this.B1b="wwaengidc";this.kpiName="ImageFileExtension";this.Bqc="LocalDeviceUpload";this.UT=new Map;this.yIh=0;this.E$a=null;this.Kpe="";this.Xpa=0;this.Ep=null;this.ppc="";this.rRg=50;this.aHg=this.vnc=this.awc=this.zsc=!1;this.DNj=19922944;this.HTg=0;this.Ope=[];this.BFg=[];this.ITg=0;this.jf=y;this.xm=R;this.ga=
aa;this.oQg=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.GRg=r.rc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();Ka.App.Agc.addHandler(this)}get tfi(){return this.K.$("JfifImageInsertIsEnabled")}get X2(){return this.Bqc}get fileExtension(){return this.Kpe}get fileSize(){return this.Xpa}get Qkj(){return this.E$a}get lw(){return this.Ep||(this.Ep=Va.a.instance.resolve("Common.Utils.IAriaNotifier"))}get xof(){return this.X2===this.Bqc}showDialog(){Fn.a(this.K)?(this.q0b=
!1,this.es=new gk.a(document.body,Object(u.a)(this,this.sac,"onUploadFrameInitialized"),Object(u.a)(this,this.Kwa,"uploadResponseReceived"),this.K,!1,void 0,!0)):Fn.b()||this.kGb&&X.a.jH?(this.q0b=!1,this.es=new gk.a(document.body,Object(u.a)(this,this.sac,"onUploadFrameInitialized"),Object(u.a)(this,this.Kwa,"uploadResponseReceived"),this.K,!1)):(this.q0b=!0,this.es=(new Mm(this)).es)}CRh(b){switch(b){case Xk.noPictureSpecified:return pj.a.noPictureSpecified;case Xk.invalidExtension:return pj.a.o8l;
case Xk.pictureTooLarge:return pj.a.jni}return si.a.unknown}A4d(b){this.xof||(this.Te.Di()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Sj.a.instance.c$f(this.Te.Di()),this.Te.Di().contentReplicator.forceOutbound(Object(u.a)(this,this.tIf,"onPlaceholderNodeSaved"),Object(u.a)(this,this.X1a,"processFailure"),b)):this.X1a(b,157))}okm(){return Fn.c(this.Te)}tIf(b){v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(b){var k={},r=this.pG?
this.pG.properties.Qc.toString():this.Te.Qc.toString();k[Ri.a.nodeId]=this.pG?this.pG.id.toString():this.Te.id.toString();k[Ri.a.classId]=r;this.jf.hasProperty(wc.a.imageType)&&(k[Og.a.imageType]=this.jf.getValue(wc.a.imageType));this.jf.hasProperty(wc.a.BT)&&(k[Og.a.BT]=this.jf.getValue(wc.a.BT));this.jf.hasProperty(Gh.a.pea)&&(k[Og.a.pea]=this.jf.getValue(Gh.a.pea));gh.a.instance.J(4)&&this.jf.hasProperty(wc.a.Ahb)&&(k[Og.a.Ahb]=this.jf.getValue(wc.a.Ahb));Fn.d(b,this.Te,this.$l,k)&&(this.C1c(b),
Tj.C$b++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}C1c(b){b.C1c();this.E$a=b.E$a}Kwa(b){this.yIh=+new Date-+this.Qkj;this.MTd();v.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");Fn.e(this,b,this.Te)}$po(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.aUc();Tj.C$b--;this.ga.processAction(ib.a.E4a,2);this.Te?Sj.a.instance.Nhc(this.Te.Di(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");
this.lw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}X1a(b,k){if(this.pBn(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,k.toLocaleString());else{b=Object.assign(new Xa.a,{extendedProperties:new Map});b.extendedProperties.set("result",k.toLocaleString());Ga.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Pk,!1,!0,!1,!1,b);b=this.e8e(k);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",
this.retryCount,k.toLocaleString());var r=this.Te.xI(),y=new sf.GraphTransaction(15,Wa.a.qQ);y.Eb(this.Te);Tj.PL.TPa(this.jf,b);Tj.PL.BPi(this.Te,this.pG);Pd.ImageReader.$_i(this.jf);y.dispose();this.s6i(b);this.xm.wZb(r,!1);this.aUc();Tj.C$b--;Sj.a.instance.Nhc(this.Te.Di(),k)}}s6i(b){const k=new cf.StandardDialog;k.Gd=0;k.my(pj.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}e8e(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}lrj(){if(this.ppc&&
0<this.ppc.length){const b=new Di.DictionaryPropertySet;b.setValue(td.a.PQ,this.ppc);b.setValue(td.a.N6,!0);this.ga.Xb(Wa.a.Q1,2,b)}this.yZn()}yZn(){let b="";this.aHg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.zsc&&this.vnc&&this.awc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.zsc&&this.vnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.zsc&&this.awc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:
this.awc&&this.vnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.awc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.vnc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.zsc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.s6i(b),this.Urj())}i7j(b){this.ppc+=String.format('<img src="{0}"></img>',b);this.ITg++}sAm(){this.awc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Xa.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Image too large");Ga.Health.instance.recordQosError("PictureFromLocalInvalid",Pk,!0,!0,!1,!1,b)}rAm(){this.vnc=!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Xa.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");Ga.Health.instance.recordQosError("PictureFromLocalInvalid",Pk,!0,!0,!1,!1,b)}Zni(b){this.aHg=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",
b)}$3n(b){const k=new Ln;if(this.Wde(b.name)===Xk.validPicture)return k.Nsh(b);if(jm.Rwa(b.name,gk.a.oMe)===Xk.validPicture)return k.TGk(b)}bHk(b){return new Promise(k=>{const r=this.$3n(b);void 0===r&&(this.Zni("Failed starting conversion work"),k());r.then(y=>{y.length>this.DNj?this.sAm():this.i7j(y);k()},y=>{this.Zni(y);k()})})}Xom(b){return this.Wde(b.name)===Xk.validPicture||jm.Rwa(b.name,gk.a.oMe)===Xk.validPicture}D7l(){const b=[];if(this.es.fT.files){this.HTg=this.es.fT.files.length;this.es.fT.files.length>
this.rRg&&(this.zsc=!0);this.cLb();for(let k=0;k<this.es.fT.files.length&&this.rRg;k++){const r=this.es.fT.files[k];this.Ope.push(r.name);this.BFg.push(r.size);r&&(this.Xom(r)?b.push(this.bHk(r)):this.rAm())}}Promise.all(b).then(()=>{this.qvd();this.lrj()});return!0}q8l(){this.$l=Ra.a.create();this.jf||(this.jf=new Di.DictionaryPropertySet);this.oQg&&this.bya&&this.jf.setValue(Gh.a.qni,this.bya);var b=480;let k=320;var r=this.context.view;this.K.$("WordEditorAutoResizeImageIsEnabled")&&(r=r.Wg.editingElement.clientWidth,
0<r&&r<b&&(k=Math.floor(1*r/b*k),b=r,this.jf.setValue(Gh.a.pea,r)));this.jf.setValue(Te.a.Ffa,Vf.a.rn(b,0));this.jf.setValue(Te.a.Uma,Vf.a.rn(k,1));this.jf.setValue(Hk.a.HZ,1);this.jf.setValue(td.a.N6,!0);gh.a.instance.J(4)&&this.jf.setValue(wc.a.Ahb,Box4Intl.Box4Strings.l_Picture);b=Tj.PL.fCh(this.context,this.jf,this.$l);if(!b)return!1;this.Te=b.node;this.jf=(this.pG=b.blob)?this.pG.properties:this.Te.properties;gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(this.Te);return!0}ZMd(){return this.xof?
this.D7l():this.q8l()}Urj(){this.UT.set("FileExtensions",this.mol());this.UT.set("FileSizeInBytes",this.BFg.toString());this.UT.set("Source",this.X2);this.UT.set("NumberOfImagesAttemptedToInsert",this.HTg.toString());this.UT.set("NumberOfImagesPasted",this.ITg.toString());Ga.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.B1b,this.UT)}mol(){let b="";for(let k=0;k<this.Ope.length;++k)b=b+this.TRh(this.Ope[k])+",";return b}pLa(b,k){this.oQg&&(this.bya=new El,this.bya.fT=b.fT);super.pLa(b,
k)}sac(b){this.es=b;if(!this.q0b){if(this.Gde){if(Fn.a(this.K)||this.kGb&&X.a.jH){b.Rzd(Object(u.a)(this,this.zUm,"onFileChosen$2"));return}const k=b.Rzd(null),r=this.URh(b);r&&(this.Kpe=r.name,this.Xpa=r.size);if(!this.Rwa(k,b)||!this.Q$f(r,b)){b=Object.assign(new Xa.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Rwa(k,this.es)?"Image too large":"FileType invalid");Ga.Health.instance.recordQosError("PictureFromLocalInvalid",Pk,!0,!0,!1,!1,b);this.MTd();return}}this.pLa(b,null)}}zUm(b){if(!this.xof){var k=
this.URh(this.es);k&&(this.Kpe=k.name,this.Xpa=k.size);if(!this.Rwa(b,this.es)||!this.Q$f(k,this.es)){k=Object.assign(new Xa.a,{extendedProperties:new Map});k.extendedProperties.set("type",this.Rwa(b,this.es)?"Image too large":"FileType invalid");Ga.Health.instance.recordQosError("PictureFromLocalInvalid",Pk,!0,!0,!1,!1,k);this.MTd();return}}this.pLa(this.es,null)}hLd(){return!!Tj.C$b}MTd(){this.UT.set("FileExtension",this.TRh(this.fileExtension));this.UT.set("Source",this.X2);this.UT.set("FileSizeInBytes",
this.fileSize.toString());this.UT.set("RequestTimeInMs",this.yIh.toString());Ga.Health.instance.recordKpiUsage(this.kpiName,0,this.B1b,this.UT)}TRh(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}g2h(){return this.tfi?gk.a.p6g:jm.nMe}URh(b){return(b=b.fT)?b.files[0]:null}Q$f(b,k){return b&&b.size>this.GRg?(k&&k.Gqd(),b=this.HFd(Xk.pictureTooLarge),this.Bp(this.CRh(Xk.pictureTooLarge),b),!1):!0}HFd(b){switch(b){case Xk.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case Xk.invalidExtension:return this.tfi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Xk.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.GRg/1E6));default:return""}}static get PL(){return null!=Tj.$lg?Tj.$lg:Tj.$lg=Va.a.instance.resolve("Box4.Images.IImageEditor")}}Tj.C$b=0;Object(m.a)(Tj,"Box4PictureUploader",jm,[554,555]);var Ro=c(690),Qk=c(165);class Mn{constructor(){this.$q=this.Gp=
this.Psb=this.n4g=this.ywg=this.lAj=null;this.pFe=0;this.Mpa=this.AAe=this.etb=null;this.vAg=0;this.yie=this.l9=this.Wwe=null;this.$Kg=!1;this.Ihe=this.Ehe=this.Jhe=null}get assetId(){return this.ywg}get thumbnailUrl(){return this.n4g}get ean(){return this.Psb}get displayName(){return this.Mpa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this.Gp,this.$q)}get hak(){if(this.Ehe&&this.Ihe&&this.Jhe){const b=document.createElement("a");b.setAttribute("href",this.Jhe);
b.setAttribute("target","_blank");b.innerText=this.Ihe;return b}return null}get xbh(){return this.Ehe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.vAg)}get Phn(){const b=document.createElement("span");var k=0;if(this.etb&&0<this.etb.length){var r=this.etb.indexOf("."),y=0>r?this.etb:this.etb.substring(0,r);for(y=Number.parseInvariant(y);k<y&&5>k;k++)b.appendChild(ci.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Qk.a.Sh("box42.png"),"","",
!0,""));0<r&&(r=Number.parseInvariant(this.etb.substr(r+1)),3>r?b.appendChild(ci.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Qk.a.Sh("box42.png"),"","",!0,"")):8>r?b.appendChild(ci.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Qk.a.Sh("box42.png"),"","",!0,"")):b.appendChild(ci.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Qk.a.Sh("box42.png"),"","",!0,"")),k++)}for(;5>k;k++)b.appendChild(ci.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8",
"box42",Qk.a.Sh("box42.png"),"","",!0,""));this.AAe&&(k=document.createElement("span"),k.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.AAe),b.appendChild(k));return b}get Kzn(){return 0<this.pFe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.pFe):""}get Khk(){if(this.$Kg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;return b}if(this.yie&&this.l9)return Mn.yMk(this.yie,this.l9);b=document.createElement("span");
b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.Wwe){const k=this.Wwe.split(",");b=Array(k.length);for(let r=0;r<k.length;r++)b[r]=k[r].trim()}else b=[];return b}static ugl(b){const k=new Mn;for(let r=0;r<b.childNodes.length;r++){const y=b.childNodes[r];if(1===y.nodeType)try{const R=y.firstChild.nodeValue;switch(y.nodeName){case "src":k.lAj=R;break;case "assetid":k.ywg=R;break;case "thumb":"64x64"===y.attributes.getNamedItem("size").nodeValue?k.n4g=
Mn.Aej(R):"192x192"===y.attributes.getNamedItem("size").nodeValue&&(k.Psb=Mn.Aej(R));break;case "imagedim":if(R){const ta=R.indexOf("x");0<ta&&ta<R.length&&(k.Gp=R.substr(0,ta),k.$q=R.substr(ta+1))}break;case "resolution":k.pFe=Number.parseInvariant(R);break;case "rating":k.etb=R;break;case "numofratings":k.AAe=R;break;case "displayname":k.Mpa=R;break;case "contentlength":k.vAg=Number.parseInvariant(R)/1024;break;case "subject":k.Wwe=R;break;case "provider":k.l9=R;break;case "attributionlink":k.yie=
R;break;case "iscsc":k.$Kg=1===Number.parseInvariant(R);break;case "additional":const aa=y.firstChild;if(y.hasChildNodes()&&aa&&"id"===aa.nodeName&&1===Number.parseInvariant(aa.text))for(let ta=0;ta<y.childNodes.length;ta++){const Ya=y.childNodes[ta];switch(Ya.nodeName){case "caption":k.Ehe=Ya.text;break;case "value":k.Jhe=Ya.text;break;case "string":k.Ihe=Ya.text}}}}catch(R){}}return k}static yMk(b,k){const r=document.createElement("a");r.setAttribute("href",b);r.setAttribute("target","_blank");
r.innerText=k;return r}static Aej(b){let k;return b&&0<(k=b.indexOf("://"))?b.substr(k+1):b}}Object(m.a)(Mn,"ClipArtSearchResult",null,[]);class po{static get vg(){return yf.a.Rx(po.tl,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}po.tl="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(po,"InsertClipartDialogHtml",null,[]);class ln extends yf.a{constructor(b){super();this.$xa=this.rqb=0;this.EXg=null;this.DDe=!1;this.WTb=this.aUa=this.YM=null;this.oBi=k=>{const r=this.IV.value;r&&0<r.trim().length&&(this.search(this.IV.value),this.Wga(1,!1));k.preventDefault();k.stopPropagation()};this.vZm=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.oBi(k),k.preventDefault(),k.stopPropagation())};this.pBi=k=>{100<=this.IV.value.length&&(k.preventDefault(),k.stopPropagation())};
this.aYm=k=>{k=Number.parseInvariant(k.target.parentNode.id.substr(4));this.GHi(k);this.FYf(k)};this.onScroll=()=>{if(this.er&&this.er.children&&!(2>this.er.children.length)){var k=this.er.children[0].children[0],r=this.er.clientHeight-(k.clientHeight-k.children[0].clientHeight+2)+this.er.scrollTop,y=k.clientHeight+2,R=parseInt(String(this.er.scrollTop/y));k=parseInt(String(r/y));var aa=parseInt(String(this.er.clientWidth/y));k<r/y&&k<parseInt(String(this.YM.length/aa))&&k++;for(r=R;r<k;r++)for(y=
0;y<aa;y++){var ta=r*aa+y;R=this.YM[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(R=this.axh(R),ta.appendChild(R))}}};this.A_m=k=>{k.target.setAttribute("src",Qk.a.Sh("phthumb.64x64x32.png"))};this.bYm=k=>{k.target.setAttribute("src",Qk.a.Sh("phpreview.96x96x32.png"))};this.Yyi=k=>{Qe.a.Gm(k.target.attributes.getNamedItem("href").value,k.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");k.stopPropagation();k.preventDefault()};this.wVm=k=>{(k?k.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.Yyi(k)};this.qzi=k=>{const r=k.target.innerText;this.IV&&(this.IV.value=r);this.search(r);k.stopPropagation();k.preventDefault();this.Wga(1,!1)};this.fWm=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.qzi(k)};this.rBi=k=>{this.YM&&(this.NFn(this.YM[this.rqb]),k.stopPropagation(),k.preventDefault(),this.IV.value="",this.Wga(1,!1))};this.wZm=k=>{(k?k.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.rBi(k)};this.onKeyDown=k=>{if(k.keyCode>=
Sys.UI.Key.left&&k.keyCode<=Sys.UI.Key.down){let r=0;switch(k.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.$xa=this.$xa+r<this.er.children.length-1?0>this.$xa+r?0:this.$xa+r:this.er.children.length-1;this.FYf(this.$xa);k.preventDefault();k.stopPropagation()}else k.keyCode===Sys.UI.Key.enter?(k=Number.parseInvariant(k.target.id.substr(4)),0<=k&&k<this.er.children.length&&this.GXi(k)):k.keyCode===Sys.UI.Key.tab&&
(this.$xa=k.shiftKey?Math.max(0,this.$xa-1):Math.min(this.$xa+1,this.er.children.length-1))};this.onError=()=>{this.er&&(this.er.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.OIi=k=>{if(this.er)if(k.data.Kga){var r=k.data.Kga.lastChild.childNodes;this.YM||(this.YM=[]);for(k=0;k<r.length&&100>this.YM.length;k++){var y=r[k];1===y.nodeType&&"image"===y.nodeName&&(y=Mn.ugl(y),this.YM.push(y))}this.SBh();this.YM.length||(this.er.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(k.data.Ie){k=
A.a.m$i(k.data.Ie);try{r=parseInt(k)}catch(R){r=14}this.er.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.SBh=()=>{if(this.YM){Fd.a.iZ(this.er);this.aUa&&(this.aUa.dispose(),this.aUa=null);this.er.focus();this.er.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.YM.length;r++){var k=document.createElement("a");k.setAttribute("href","#");k.id="itab"+r;const y=document.createElement("span");y.id="clip"+r;y.classList.add("ClipartImageContainer");
k.appendChild(y);this.er.appendChild(k);r<parseInt(String(this.er.clientHeight/y.clientHeight))*parseInt(String(this.er.clientWidth/y.clientWidth))&&(k=this.axh(this.YM[r]),y.appendChild(k))}this.DDe&&(this.GXi(this.rqb),this.FYf(this.rqb))}};this.Z6l=k=>{1===k&&this.YM&&ln.PL.Nda(this.vzg.context)&&(k=this.YM[this.rqb])&&this.vzg.REa(k)};this.vzg=b;this.vg=po.vg;this.lg="InsertClipartDialog";this.We(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.Z6l);this.er=document.getElementById("clipartsearchresults");this.mld=this.onKeyDown;Af.a.addHandler(this.er,"keydown",this.mld);this.lld=this.onScroll;Af.a.addHandler(this.er,"scroll",this.lld);this.IV=document.getElementById("textInput");this.Qnd=this.vZm;Af.a.addHandler(this.IV,"keydown",this.Qnd);this.Rnd=this.pBi;Af.a.addHandler(this.IV,"keypress",this.Rnd);this.Snd=this.pBi;Af.a.addHandler(this.IV,"paste",this.Snd);this.nkc=document.getElementById("btnSearch");this.nkc.setAttribute("src",
Qk.a.Sh("search.16x16x32.png"));this.jld=this.oBi;Af.a.addHandler(this.nkc,"click",this.jld);this.eQb=document.getElementById("clipartpreviewimage");this.Tne=document.getElementById("clipartattributedisplayname");this.X6a=document.getElementById("clipartseesimilar");this.Sne=document.getElementById("clipartdimensions");this.Gmc=document.getElementById("clipartadditionalvalue");this.Wne=document.getElementById("clipartratingvalue");this.jSa=document.getElementById("clipartattributionvalue");this.kSa=
document.getElementById("clipartkeywords");this.Qne=document.getElementById("clipartadditionalname");this.Xne=document.getElementById("clipartratingname");this.Rne=document.getElementById("clipartattributionname");this.FDe=this.aYm;this.rKe=this.A_m;this.dcd=this.Yyi;this.ecd=this.wVm;this.Uwe=this.qzi;this.Vwe=this.fWm;this.old=this.rBi;this.pld=this.wZm;this.IV.focus();this.Wga(1,!1)}dispose(){this.er&&this.Ynh();this.er&&this.mld&&(Af.a.removeHandler(this.er,"keydown",this.mld),this.mld=null);
this.er&&this.lld&&(Af.a.removeHandler(this.er,"scroll",this.lld),this.lld=null);this.er=null;this.IV&&this.Qnd&&(Af.a.removeHandler(this.IV,"keydown",this.Qnd),this.Qnd=null);this.IV&&this.Rnd&&(Af.a.removeHandler(this.IV,"keypress",this.Rnd),this.Rnd=null);this.IV&&this.Snd&&(Af.a.removeHandler(this.IV,"paste",this.Snd),this.Snd=null);this.IV=null;this.nkc&&this.jld&&(Af.a.removeHandler(this.nkc,"click",this.jld),this.nkc=this.jld=null);this.Rne=this.Xne=this.Qne=this.kSa=this.jSa=this.Wne=this.Gmc=
this.Sne=this.X6a=this.Tne=this.eQb=this.pld=this.old=this.Vwe=this.Uwe=this.ecd=this.dcd=this.WTb=this.rKe=this.FDe=null;this.aUa&&(this.aUa.dispose(),this.aUa=null);super.dispose()}vO(){super.vO();document.getElementById(this.pj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.TJb(b,!1,this.OIi)}TJb(b,k,r){this.$xa=this.rqb=0;this.Ynh();if(this.YM&&b===this.EXg&&this.DDe===k)window.setTimeout(this.SBh,500);else{this.YM&&(Array.clear(this.YM),this.YM=null);this.EXg=b;this.DDe=
k;var y=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');y.append("<query>");y.append(A.a.Ff(b));y.append("</query>");y.append("<mediatype>Illustration</mediatype>");y.append("<mediatype>Photo</mediatype>");y.append("<filetype>jpg</filetype>");y.append("<filetype>jpeg</filetype>");y.append("<filetype>gif</filetype>");y.append("<filetype>bmp</filetype>");y.append("<filetype>tif</filetype>");y.append("<filetype>tiff</filetype>");y.append("<filetype>png</filetype>");y.append("</search>");
b=n.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let R=b.length;4>R;R++)b="0"+b;n.AFrameworkApplication.af.Mj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Ka.App.webServiceBase,b,Og.a.T0n,k.toString()),2,y.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}NFn(b){this.TJb(b.assetId,!0,this.OIi);this.YM||(this.YM=[],this.YM.push(b))}axh(b){const k=document.createElement("img");k.classList.add("ClipartThumbImage");k.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;k.setAttribute("title",b);k.setAttribute("alt",b);Af.a.addHandler(k,"click",this.FDe);Af.a.addHandler(k,"error",this.rKe);return k}gVk(b){1===b.childNodes.length&&(b=b.childNodes[0],Af.a.removeHandler(b,"click",this.FDe),Af.a.removeHandler(b,"error",this.rKe))}GHi(b){const k=this.YM[b];var r=k.ean;this.Wnh();this.WTb=this.bYm;var y=document.createElement("img");y.setAttribute("src",r);if(k.displayName)r=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,k.displayName);else{r=new Sys.StringBuilder;for(let R=0;R<k.keywords.length&&5>R;R++)R&&r.append(", "),r.append(k.keywords[R]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}y.setAttribute("title",r);y.setAttribute("alt",r);Af.a.addHandler(y,"error",this.WTb);this.eQb.appendChild(y);y=document.getElementById("clip"+this.rqb);y.classList.remove("ClipartSelectedImage");y=document.getElementById("clip"+
b);y.classList.add("ClipartSelectedImage");this.rqb=b;k.displayName&&(this.Tne.innerText=k.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Af.a.addHandler(b,"click",this.old);Af.a.addHandler(b,"keydown",this.pld);this.X6a.appendChild(b);this.Sne.innerText=String.format("{0} | {1} | {2}",k.dimensions,k.Kzn,k.fileSize);(b=k.hak)&&k.xbh?(this.Gmc.parentNode.style.display="block",this.Qne.innerText=k.xbh,this.Gmc.appendChild(b)):
this.Gmc.parentNode.style.display="none";this.Wne.appendChild(k.Phn);Fd.a.iZ(this.jSa);if(b=k.Khk)this.jSa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Af.a.addHandler(b,"click",this.dcd),Af.a.addHandler(b,"keydown",this.ecd));this.kSa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<k.keywords.length;b++)y=k.keywords[b],r=document.createElement("a"),r.innerText=y,r.setAttribute("href",'""'),Af.a.addHandler(r,"click",this.Uwe),Af.a.addHandler(r,"keydown",this.Vwe),this.kSa.appendChild(r),
b<k.keywords.length-1&&(y=document.createElement("span"),y.innerText=", ",this.kSa.appendChild(y));this.Xne.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.Rne.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Wga(1,!0)}Wnh(){this.eQb&&1===this.eQb.childNodes.length&&(this.WTb&&(Af.a.removeHandler(this.eQb.childNodes[0],"error",this.WTb),this.WTb=null),Fd.a.iZ(this.eQb));this.jSa&&0<this.jSa.childNodes.length&&"a"===this.jSa.childNodes[0].nodeName.toLowerCase()&&(this.dcd&&Af.a.removeHandler(this.jSa.childNodes[0],
"click",this.dcd),this.ecd&&Af.a.removeHandler(this.jSa.childNodes[0],"keydown",this.ecd));this.X6a&&0<this.X6a.children.length&&"a"===this.X6a.children[0].nodeName.toLowerCase()&&(this.old&&Af.a.removeHandler(this.X6a.children[0],"click",this.old),this.pld&&Af.a.removeHandler(this.X6a.children[0],"keydown",this.pld),Fd.a.iZ(this.X6a));if(this.kSa){for(let b=0;b<this.kSa.childNodes.length;b++){const k=this.kSa.childNodes[b];"a"===k.nodeName.toLowerCase()&&(Af.a.removeHandler(k,"click",this.Uwe),Af.a.removeHandler(k,
"keydown",this.Vwe))}Fd.a.iZ(this.kSa)}this.Tne.innerText="";this.Sne.innerText="";Fd.a.iZ(this.Gmc);Fd.a.iZ(this.Wne);Fd.a.iZ(this.jSa);this.kSa.innerText="";this.Qne.innerText="";this.Xne.innerText="";this.Rne.innerText=""}GXi(b){if(!(this.er.children.length<=b||0>b)){var k=this.er.children[b],r=this.er.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.er.scrollTop+this.er.clientHeight<k.offsetTop+k.clientHeight?this.er.scrollTop=k.offsetTop-3*k.clientHeight-r:this.er.scrollTop>k.offsetTop&&
(this.er.scrollTop=k.offsetTop-r/2);this.GHi(b)}}validate(){return!0}Ynh(){if(Id.FocusManager.nJ()){var b=Id.FocusManager.instance().getRegion(this.$J);b&&b.Wj.qy(this.IV)}else this.IV.focus();for(b=0;b<this.er.childNodes.length;b++){const k=this.er.childNodes[b];1===k.childNodes.length&&this.gVk(k.childNodes[0])}Fd.a.iZ(this.er);this.Wnh();this.Wga(1,!1);this.aUa=new Ro.a(Box4Intl.Box4Strings.l_ClipartSearching);this.aUa.Jii=!1;this.er.appendChild(this.aUa.element);this.er.classList.add("ClipartSearchInProgress")}FYf(b){this.$xa=
b;b=this.er.children[this.$xa];Id.FocusManager.nJ()?Id.FocusManager.instance().getRegion(this.$J).Wj.qy(b):b.focus()}static get PL(){return ln.tj=ln.tj||Va.a.instance.resolve("Box4.Images.IImageEditor")}}ln.tj=null;Object(m.a)(ln,"InsertClipartDialog",yf.a,[]);class Nn extends Tj{constructor(b,k,r,y,R,aa){super(b,k,r,y,R,aa,!1);this.QXm=ta=>{if(this.okm()){var Ya=this.Te.Di(),xb=Ya.contentReplicator.ku.toString(),Mb=new Sys.Net.WebRequest;Mb.set_url("ClipArtUpload.ashx");Mb=new Sys.StringBuilder(Mb.getResolvedUrl());
this.TV(Mb,Og.a.assetId,ta.assetId,!0);this.TV(Mb,Ri.a.lcid,n.AFrameworkApplication.lcid.toString());this.TV(Mb,Ri.a.nodeId,this.pG?this.pG.id.toString():this.Te.id.toString());this.TV(Mb,Ri.a.cellId,Ya.Xl.toString());this.TV(Mb,Ri.a.fileId,Ya.Es);this.TV(Mb,Ri.a.Tra,xb);this.TV(Mb,Ri.a.e2,this.$l.toString());ta=ml.a.Eq;gh.a.instance.J(4)&&(ta=this.Te.ia(Gh.a.sK,ml.a.Eq));this.TV(Mb,Ri.a.sK,ta.toString());this.TV(Mb,Ri.a.Wmb,"1");Ya.pI&&this.TV(Mb,Ri.a.pI,Ya.pI);this.TV(Mb,Ri.a.classId,this.pG?this.pG.properties.Qc.toString():
this.Te.Qc.toString());this.jf.hasProperty(wc.a.imageType)&&this.TV(Mb,Og.a.imageType,this.jf.getValue(wc.a.imageType).toString());pk.a.instance.q7j(Mb);n.AFrameworkApplication.af.Mj(Mb.toString(),2,"",{},!1,2,this.aqo,this.uploadFailed,null);Tj.C$b++}};this.aqo=ta=>{if(({group:Ya}=vi.a.g8(ta.data.Ie)).returnValue){var Ya=Ya.Responses[0];Ya.Wjb=ta.data.gH;Ya.Zt=ta.data.qj?ta.data.qj[vq.a.Z5]:"";this.Kwa(Ya)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new co.a;ta.StatusCode=14;this.Kwa(ta)};
new ln(this)}REa(b){this.ZMd()&&this.Te.Di().contentReplicator.forceOutbound(this.QXm,null,b)}TV(b,k,r,y){b.append(y?"?":"&");b.append(A.a.Jj(k));b.append("=");b.append(A.a.Jj(r))}e8e(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.e8e(b)}}Kwa(b){super.Kwa(b);Tj.C$b--}}Object(m.a)(Nn,"ClipartUploader",Tj,[]);class gi{constructor(b,k,r){this.$6l=(y,R,aa,ta,Ya)=>{if(!this.tj||!this.tj.value)return v.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;y=this.tj.value.Nda(R);return 2===aa&&y?(new Nn(R,Mg.a.instance,n.AFrameworkApplication.K,Ya,this.xm,this.ga),32):1===aa?y&&Ka.App.Ooh?32:8:2};this.tj=b;this.xm=k;this.ga=r}Vb(){this.ga.gb(Wa.a.b$h,lc.a.view,this.$6l,260)}}Object(m.a)(gi,"ClipArtActor",null,[]);class wq{constructor(){this.W=null}get name(){return"Box4.ClipArt"}zc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new gi(b.Ze("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),n.AFrameworkApplication.ya)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Vb();
const b=Ka.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(wq,"ClipartPackage",null,[1,2]);class wm{constructor(b){this.xUa=this.hUa=this.CUa=this.BUa=null;this.pIg=this.VOg=this.Ah=this.T8=!1;this.cFe=this.APg=null;this.lPg=0;this.Oa=this.vPg=null;this.NO=b;this.oR=3;this.Npc=!0}initialize(b,k,r){this.BUa=this.Shf(b,k);this.CUa=CommonUIStrings.l_SavingStatus;this.hUa=CommonUIStrings.l_ReadOnlyStatus;this.xUa=CommonUIStrings.l_ReviewModeStatus;this.NO&&this.NO.execute(y=>{y.HVa(Object(u.a)(this,
this.a4c,"updateToSavingStatus"))});this.Ah=!0;this.Oa=r;return!0}Gmb(b,k){this.T8=b;this.oR=k;this.VQa(this.Npc)}VQa(b){!this.Npc&&b&&(this.vPg=new Date);this.Npc=b;b=null;3===this.oR&&(b=this.Npc?this.BUa:this.CUa);this.lZk(b)}Shf(b,k){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):k&&k.length?String.format(CommonUIStrings.l_SavedToStatus,k):CommonUIStrings.l_SavedStatus}a4c(){this.VQa(!1)}dBl(){switch(this.oR){case 1:return this.hUa;case 2:return this.xUa;
default:return null}}Mdm(b){return this.VOg===this.T8&&this.lPg===this.oR&&this.APg===b}c5e(b){appChrome.getHeaderApi().then(k=>{k.updateDocumentTitleStatus(this.T8,b,this.dBl(),this.vPg,this.Npc);this.pIg=!0;return null});this.cFe=null}lZk(b){this.Ah&&ni.c()&&!this.Mdm(b)&&(!this.pIg&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.c5e(b):Qe.a.yUf()?(this.cFe&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.cFe=window.requestIdleCallback(()=>{this.c5e(b)})):window.requestAnimationFrame(()=>{this.c5e(b)}),this.VOg=this.T8,this.APg=b,this.lPg=this.oR)}}Object(m.a)(wm,"ReactSaveStatusUIHandler",null,[521]);class Co{constructor(b,k){this.MW=null;this.BUa=CommonUIStrings.l_SavedStatus;this.CUa=CommonUIStrings.l_SavingStatus;this.hUa=CommonUIStrings.l_ReadOnlyStatus;this.xUa=CommonUIStrings.l_ReviewModeStatus;this.M7a=k;this.NO=b;this.oR=3;this.R9a=!0}UA(){this.NO&&this.NO.execute(b=>{b.HVa(Object(u.a)(this,
this.a4c,"updateToSavingStatus"))});this.M7a.execute(b=>{this.MW=b})}Gmb(b,k){this.oR=k;3===k?this.VQa(this.R9a):2===k?this.R7f(this.xUa):this.R7f(this.hUa)}a4c(){this.VQa(!1)}VQa(b){this.R9a=b;this.R7f(this.R9a?this.BUa:this.CUa)}R7f(b){this.MW&&this.MW.sendMessage(E.a.sgo,this.aFk(b))}aFk(b){const k={};k.StatusText=b;return k}}Object(m.a)(Co,"SaveStatusPostMessageHandler",null,[521]);var en=c(222),Sl=c(116);class sn{constructor(b,k,r,y){this.xUa=this.hUa=this.CUa=this.BUa=null;this.Hrb=0;this.PY=
this.mGe=this.Mnb=this.lie=this.FKe=null;this.tg=b;this.H7a=k;this.NO=r;this.Nl=y;this.XLg=!0;this.T8=!1;this.oR=3;this.R9a=!0}initialize(b,k){if(!this.tg)return!1;this.BUa=this.Shf(b,k);this.CUa=CommonUIStrings.l_SavingStatus;this.hUa=CommonUIStrings.l_ReadOnlyStatus;this.xUa=CommonUIStrings.l_ReviewModeStatus;this.UA();return!0}Shf(b,k){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):k&&k.length?String.format(CommonUIStrings.l_SavedToStatus,k):CommonUIStrings.l_SavedStatus}UA(){this.H7a&&
this.H7a.execute(b=>{b.Q9j(Object(u.a)(this,this.Kwh,"createStatusAndModeElements"));b.z9j(Object(u.a)(this,this.YZn,"showHideSaveStatusElement"));b.Ubo&&this.Kwh(null,null)});this.NO&&this.NO.execute(b=>{b.HVa(Object(u.a)(this,this.a4c,"updateToSavingStatus"))})}Dha(){this.PY&&this.tg&&this.tg.Hwa(this.PY)}YZn(b,k){this.Gmb("true"===k,this.oR)}Gmb(b,k){this.T8=b;this.oR=k;this.lie&&(this.lie.style.display=this.T8||3===this.oR||!this.FKe?"none":"");this.Mnb&&(this.Mnb.style.display=this.T8||3===this.oR?
"none":"",this.Mnb.innerText=1===this.oR?this.hUa:this.xUa,this.Mnb.title=1===this.oR?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.mGe&&(this.mGe.style.display=this.T8||1===this.oR||!this.FKe&&!this.Mnb?"none":"");this.PY&&(this.PY.style.display=this.T8||1===this.oR?"none":"",this.VQa(this.R9a),this.PY.title=CommonUIStrings.l_SaveStatusTooltip)}Kwh(b,k){b=document.getElementById(en.CuiHelper.gZl);k&&k.wuo||!b||""===this.BUa||""===this.CUa||""===this.hUa||
""===this.xUa||(this.FKe=document.getElementById(en.CuiHelper.BUe),this.lie=en.CuiHelper.xxd(b,"BreadcrumbAppModeDash","-"),this.Mnb=en.CuiHelper.xxd(b,"BreadcrumbAppModeStatus",1===this.oR?this.hUa:this.xUa),this.pij(this.Mnb),this.mGe=en.CuiHelper.xxd(b,"BreadcrumbSaveStatusDash","-"),this.PY=en.CuiHelper.xxd(b,"BreadcrumbSaveStatus",this.BUa),this.pij(this.PY),this.Gmb(this.T8,this.oR))}a4c(){this.VQa(!1)}VQa(b){this.R9a=b;this.ooo(this.R9a?this.BUa:this.CUa)}ooo(b){!this.PY||3!==this.oR&&2!==
this.oR||(this.XLg&&!this.R9a?(this.Hrb=this.PY.offsetWidth<this.Hrb?this.Hrb:this.PY.offsetWidth,this.bjo(this.CUa),this.XLg=!1):this.PY.innerText=b)}pij(b){b.style.direction=this.Nl?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Nl?"right":"left";b.style.display=this.T8?"none":"";b.setAttribute("Unselectable","on")}bjo(b){this.PY&&(this.PY.style.width="",this.PY.innerText=b,this.Hrb=this.PY.offsetWidth<this.Hrb?this.Hrb:this.PY.offsetWidth,b=Sl.a.MB(this.PY),this.PY.style.width=this.Hrb-
Fd.a.gM(b.paddingLeft)-Fd.a.gM(b.paddingRight)+1+"px")}}Object(m.a)(sn,"SaveStatusUIHandler",null,[521]);var Ym=c(74);class rk{constructor(){this.nGe=this.tEe=this.VIa=this.W=null}get name(){return"Common.App.SaveStatus"}zc(b){this.W=b;n.AFrameworkApplication.K.$("PostMessageEmbedded")&&n.AFrameworkApplication.jQ?this.W.register(Co,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Zd(()=>new Co(this.W.$a("Common.App.HostNotification.EditNotificationEventSource"),
this.W.$a("Postmessage.IHostPostmessenger"))):n.AFrameworkApplication.ta.Rb.puf||(n.AFrameworkApplication.ta.Rb.KI?this.W.register(wm,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Zd(()=>new wm(this.W.$a("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(sn,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Zd(()=>new sn(Ym.EventHandlerManager.instance,
this.W.$a("Common.App.Header.HeaderEventSource"),this.W.$a("Common.App.HostNotification.EditNotificationEventSource"),n.AFrameworkApplication.isRtl)))}init(){n.AFrameworkApplication.K.gq(Object(u.a)(this,this.fx,"onFullAppSettingsReady"))}fx(){const b=n.AFrameworkApplication.K,k=!!n.AFrameworkApplication.ta.Rb&&4===n.AFrameworkApplication.ta.Rb.ko;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||k&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||
b.$("VisioSaveStatusInHeaderEnabled"))n.AFrameworkApplication.K.$("PostMessageEmbedded")&&n.AFrameworkApplication.jQ?(this.nGe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.nGe.UA():n.AFrameworkApplication.ta.Rb.puf||(n.AFrameworkApplication.ta.Rb.KI?(this.tEe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.tEe.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus"),n.AFrameworkApplication.K):(this.VIa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.VIa.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus")))}dispose(){this.VIa&&this.VIa.Dha()}}Object(m.a)(rk,"PackageManager",null,[1,2]);var Yl=c(1582);class Um{get name(){return"Common.App.EventsCachePackage"}zc(){}init(){Yl.a.instance.init()}dispose(){}static main(){M.a.instance.Pc(new Um)}}Object(m.a)(Um,"EventsCachePackage",null,[1,2]);var kj=c(122),fj=c(143),km=c(97),cl=c(635),Ig=c(332),lm=c(476),Nm=c(304),xf=c(28),xj=c(256),mg=c(25);class Vi{constructor(b){this.fLg=!1;
this.v6c=this.Zl=null;this.mhe=!1;this.JD=b}get control(){return this.JD}get Od(){return this.control.Od}get root(){return this.control.root}get lH(){return this.control.lH}get wVa(){return this.control.wVa}get mk(){return this.control.mk}get eE(){return this.control.eE}$H(){}initialize(){}uw(b,k,r){this.control.d_k(b,k,r)}xl(){xf.c(this.control.Fh.Command)||this.Nt(this.control.Fh.Command,null,null)}Nt(b,k,r){let y=0;this.root&&(y=this.root.Jna(b,k,r));this.control.enabled=0<(y&1);return y}H4a(){let b=
this.control.visible;this.root.uQa&&(b=this.Od[xj.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.l$b=!0));return b}n9f(){const b=mg.a.bpa(this.Od[xj.a.labelText],this.control.Fh.LabelText);this.f7d(b)}f7d(b){this.control.labelText!==b&&(this.eE.forEach(k=>{k.f7d(b)}),this.control.labelText=b,this.root.Z0a=!0)}OMb(){const b=mg.a.bpa(this.Od[xj.a.alt],this.control.Fh.Alt);this.Aec(b)}Aec(b){this.control.tooltip!==b&&(this.eE.forEach(k=>{k.Aec(b)}),this.control.tooltip=b)}Hha(){const b=
mg.a.bpa(this.Od[cl.a.Image16by16Class],this.control.Fh.Image16by16Class),k=mg.a.bpa(this.Od[cl.a.Image32by32Class],this.control.Fh.Image32by32Class);var r=mg.a.bpa(this.Od[cl.a.Image48by48Class],this.control.Fh.Image48by48Class);r=xf.b(r)?k:r;this.fzc(this.eE.small,b);this.fzc(this.eE.medium,b);this.fzc(this.eE.large,k);this.fzc(this.eE.K1n,b);this.fzc(this.eE.K8b,r)}fzc(b,k){!b||xf.c(b.PP)||xf.c(k)||b.PP.className===k||(b.PP.className=k)}Kko(b){if(!xf.b(b)&&this.root.a4f){for(const k of this.control.WYe){const r=
k.ZS===b;r&&(this.control.QNe=k);this.control.visible&&(k.eA=r)}this.control.visible&&(this.root.Z0a=!0)}}Aak(){if(this.eE.K8b&&this.eE.K8b.JN&&this.eE.K8b.zcb){const b=this.eE.K8b.JN,k=mg.a.bpa(this.Od[Ig.a.Description],this.control.Fh.Description);xf.b(k)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.mk;Object(Jb.a)(lm.a,b)?this.lH.zmb(b):this.root.zxb=this.control;return!1}onBlur(){const b=this.mk;this.control.lEb()&&
mg.a.Mu(b.Lc,"cui-ctl-menu-hovered-without-focus");this.root.zxb=null;return!1}tX(b){if(this.control.lEb()){var k=this.lH.Coa;const r=k===this.root.VFb-1;k=r?null:this.root.ZB[k+1];this.TXe(!1);r||this.control===k||mg.a.Mu(k.ZEb,Nm.MenuLauncher.aSc);this.control.enabled&&this.control.eu?r?this.control.FX():(mg.a.Qf(this.mk.Lc,"cui-ctl-menu-hovered-without-focus"),k.qea=this.control.eu):r?this.lH.setFocus(b.ig):(k.qea=this.lH.Lc,this.lH.Zna())}return!1}kO(){this.control.lEb()&&mg.a.Mu(this.mk.Lc,"cui-ctl-menu-hovered-without-focus");
return!1}onKeyDown(b){let k=!1;if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(k=!0);if(Object(Jb.a)(lm.a,this.mk)){const y=this.lH;if(!xf.c(y)){const R=y.Coa,aa=0===this.root.P_,ta=!xf.c(this.control.D4m);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return k;Qe.a.uXe();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(y.ZJ(1),k=!0):r===Sys.UI.Key.left&&aa||r===Sys.UI.Key.right&&
!aa?(ta?y.ZJ(2):0<R&&this.root.EWa(R,!0,!1),k=!0):r===Sys.UI.Key.right&&aa||r===Sys.UI.Key.left&&!aa?(ta&&y.ZJ(4),k=!0):r===Sys.UI.Key.up?(y.ZJ(5),k=!0):r===Sys.UI.Key.down?(y.ZJ(6),k=!0):r===Sys.UI.Key.esc&&(this.root.EWa(R,!0,!1),k=!0):(y.ZJ(0),k=!0)}}}return k}gx(b){let k=!1;if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;bc.KeyInputManager.r5h(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(k=this.Akf(b),k||(this.uw(b.Af,1,b.Ib),k=!0))}return k}$B(b){this.KYe();if(this.wVa){let k=
!0;2===b.ig&&(k=b.Iaa===Sys.UI.MouseButton.leftButton);k&&this.mk&&this.lqd(this.mk.Lc)}(b.Ib.type.toLowerCase()!==Kb.a.DO||this.wVa)&&b.Ib.preventDefault();return!1}get Zpf(){return this.fLg}a3k(){this.fLg=!0}KYe(){this.Zpf&&this.control.root.mbb()}gva(b){Object(Jb.a)(lm.a,this.mk)&&!this.wVa&&2===b.ig&&b.Iaa===Sys.UI.MouseButton.leftButton?(this.uw(b.Af,b.ig,b.Ib),b=!0):b=this.control.Csa(b);return b}onClick(b){let k=!1;Object(Jb.a)(lm.a,this.mk)&&!this.wVa&&3===b.ig&&(this.uw(b.Af,b.ig,b.Ib),k=
!0);return X.a.mi?!1:k}Lib(b){return this.PWd(b)}zDa(b){this.Csa(b);return!1}PWd(b){return xf.c(this.Zl)?!1:(this.OXf(Qe.a.gQd(this.k8g,b.clientPoint)),!0)}X$b(b){let k=!1;this.Csa(b)&&(k=!0);3!==b.ig&&(b=!0,!this.root&&Vi.TEf&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.Qda(),k=!0);return k}$$b(b){return this.Csa(b)}Y$b(b){return this.PWd(b)}Z$b(b){return this.Csa(b)}V$b(b){return 3===b.ig?(this.root.Qda(),!0):!1}W$b(){return!1}get k8g(){!xf.c(this.Zl)&&xf.c(this.v6c)&&
(this.v6c=Qe.a.getElementBounds(this.Zl));return this.v6c}OXf(b){this.mhe!==b&&(this.mhe=b,this.RNe(this.mhe))}RNe(b){xf.c(this.Zl)||mg.a.X3(this.Zl,km.Control.oqd,b)}lqd(b){this.control.enabled&&(this.Zl=b,this.root.eyc=this.control,this.OXf(!0),this.root.Ida(this.control,!1))}Csa(b){if(!xf.c(this.Zl)){this.OXf(!1);let k=!!this.root;if(Vi.TEf){const r=Kd.ActionManager.sda(parseInt(this.control.Fh.Command))||"";v.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",k,r)}k&&this.root.v$(this.control,
!1);xf.c(b)||Qe.a.gQd(this.k8g,b.clientPoint)&&this.uw(this.Zl,b.ig,b.Ib);k=!!this.root;Vi.TEf&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",k);k&&(this.root.eyc=null);this.v6c=this.Zl=null;return!0}return!1}ZJ(b){return Object(Jb.a)(lm.a,this.mk)&&2!==b&&4!==b&&!Qe.a.X5b(this.control.eu)?this.FX():!1}FX(){try{if(this.control.visible){const b=this.control.eu;if(!xf.c(b))return b.focus(),!0}}catch(b){}return!1}TXe(b){const k=this.lH;xf.c(k)||this.root.EWa(k.Coa+1,b)}mna(){}Akf(){return!1}Zea(b){let k=
null;b&&b.rawEvent&&(k={},k[Vi.triggerTime]=b.rawEvent.timeStamp);return k}static get TEf(){null==Vi.vAe&&(Vi.vAe=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Vi.vAe}}Vi.triggerTime="TriggerTime";Vi.vAe=null;Object(m.a)(Vi,"ControlBehavior",null,[533]);var wl=c(140);class Wi extends Vi{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Fh}$H(b){const k=b.Bm;b=b.ZS;xf.c(k)||(ee.a.instance.mb(Kb.a.focus,
k,Object(u.a)(this,this.onFocus,"onFocus")),ee.a.instance.mb(Kb.a.blur,k,Object(u.a)(this,this.onBlur,"onBlur")),fj.a.instance.mb(Kb.a.pointerOver,k,Object(u.a)(this,this.tX,"onPointerOver")),fj.a.instance.mb(Kb.a.pointerOut,k,Object(u.a)(this,this.kO,"onPointerOut")),bc.KeyInputManager.instance.uE(Kb.a.ni,k,Object(u.a)(this,this.onKeyDown,"onKeyDown"),b),bc.KeyInputManager.instance.uE(Kb.a.Kt,k,Object(u.a)(this,this.RF,"onKeyPress"),b),bc.KeyInputManager.instance.uE(Kb.a.oh,k,Object(u.a)(this,this.gx,
"onKeyUp"),b),fj.a.instance.mb(Kb.a.pointerDown,k,Object(u.a)(this,this.$B,"onPointerDown")),fj.a.instance.mb(Kb.a.hM,k,Object(u.a)(this,this.gva,"onPointerUp")),Sf.a.instance.mb(Kb.a.click,k,Object(u.a)(this,this.onClick,"onClick")),wl.a.instance.mb(Kb.a.BO,k,Object(u.a)(this,this.Lib,"onTouchMove")),wl.a.instance.mb(Kb.a.kJ,k,Object(u.a)(this,this.zDa,"onTouchEnd")))}uw(b,k,r){this.control.enabled&&(b=null,this.mk&&this.mk.tOc()&&this.lH&&(b=this.root.ZB[this.lH.Coa])&&!this.Zpf&&(b.LPa(this.button),
b=null),this.executeCommand(this.control.Fh.Command,k,!0,r),b&&b.LPa(this.button))}executeCommand(b,k,r,y){if(!xf.c(b)){const R=this.Od;R.CommandValueId=this.button.pAb();R.MenuItemId=this.button.Fh.MenuItemId;R.SourceControlId=this.control.id;this.root.executeCommand(b,R,this.mk,k,r,null,this.Zea(y))}}xl(){xf.c(this.control.Fh.Command)||0<(this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.H4a()&&this.UQa()}UQa(){this.n9f();this.OMb();this.Hha()}onFocus(b){super.onFocus(b);
this.U2f();return!1}onBlur(b){super.onBlur(b);this.g7e();return!1}onKeyDown(b){let k=super.onKeyDown(b);xf.c(b.Ib)||this.O_f(b.Dp,b.Ib.keyCode)&&(k=!1);return k}RF(b){let k=!1;xf.c(b.Ib)||xf.c(b.Ib.rawEvent)||(this.O_f(b.Dp,b.Ib.rawEvent.keyCode)?(this.uw(b.Af,b.ig,b.Ib),k=!0):b.Ib.preventDefault());return k}O_f(b,k){if(X.a.Ak&&k===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}gx(b){let k=!1;xf.c(b.Ib)||this.O_f(b.Dp,b.Ib.keyCode)||
(k=super.gx(b));return k}U2f(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}g7e(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(Wi,"ButtonBehavior",Vi,[]);var gl=c(955);class pm{}pm.Color="Color";pm.IndexColorSelected="ColorSelected";Object(m.a)(pm,"ColorPickerCommandProperties",null,[]);class Zm extends Vi{constructor(b){super(b);this.wvc=this.Vu=-1}get colorPicker(){return this.control}get mKa(){return this.colorPicker.bBk.mKa}get properties(){return this.colorPicker.Fh}uw(b,
k,r){if(this.control.enabled){const y=this.Od;y.Color=Zm.aHd(b)[gl.ColorPicker.Hvd];b=null;mg.a.vr(this.properties.Stateful)&&this.mk&&this.mk.tOc()&&this.lH&&(b=this.root.ZB[this.lH.Coa]);this.root.executeCommand(this.properties.Command,y,this.mk,k,!0,null,this.Zea(r));b&&b.LPa(this.colorPicker)}}xl(){var b=this.Od;b.SourceControlId=this.properties.Id;if(0<(this.Nt(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,pm.IndexColorSelected in this.Od&&(b=this.Od[pm.IndexColorSelected]),
b!==this.wvc)){const k=this.mKa;0<=b&&b<k.length&&this.Ghj(k[b],!0);0<=this.wvc&&this.wvc<k.length&&this.Ghj(k[this.wvc],!1);this.wvc=b}}Ghj(b,k){k?mg.a.Qf(b,"cui-colorpicker-selected"):mg.a.Mu(b,"cui-colorpicker-selected")}$H(b){for(let k=0;k<b.vNe.length;++k){const r=b.vNe[k];ee.a.instance.mb(Kb.a.focus,r,Object(u.a)(this,this.jGf,"onCellFocus"));ee.a.instance.mb(Kb.a.blur,r,Object(u.a)(this,this.iSm,"onCellBlur"));bc.KeyInputManager.instance.mb(Kb.a.ni,r,Object(u.a)(this,this.onKeyDown,"onKeyDown"));
bc.KeyInputManager.instance.mb(Kb.a.oh,r,Object(u.a)(this,this.gx,"onKeyUp"));Sf.a.instance.mb(Kb.a.click,r,Object(u.a)(this,this.jSm,"onCellClick"));fj.a.instance.mb(Kb.a.hM,r,Object(u.a)(this,this.lGf,"onCellPointerUp"));fj.a.instance.mb(Kb.a.pointerOver,r,Object(u.a)(this,this.kGf,"onCellPointerOver"));fj.a.instance.mb(Kb.a.pointerDown,r,Object(u.a)(this,this.kSm,"onCellPointerDown"))}}jGf(b){b=Zm.aHd(b.Af);this.lH.zmb(this.mk);this.Uce(b,!0);return!0}iSm(b){this.Uce(Zm.aHd(b.Af),!1);return!0}Uce(b,
k){k?(this.Vu=parseInt(b.getAttribute("arrayPosition")),mg.a.Qf(b,"cui-colorpicker-hoveredOver"),this.U2f(b)):(this.Vu=-1,this.g7e(b),mg.a.Mu(b,"cui-colorpicker-hoveredOver"))}jSm(b){3===b.ig&&this.uw(b.Af,b.ig,b.Ib);return!0}lGf(b){3!==b.ig&&this.uw(b.Af,b.ig,b.Ib);return!0}kGf(b){this.TXe(!1);b=parseInt(Zm.aHd(b.Af).getAttribute("arrayPosition"));this.l_c(b);return!0}kSm(){return!1}U2f(b){if(this.control.enabled){const k=this.properties.CommandPreview;if(!xf.b(k)){const r=this.Od;r.Color=b[gl.ColorPicker.Hvd];
this.root.executeCommand(k,r,this.mk,0,!1)}}}g7e(b){if(this.control.enabled){const k=this.properties.CommandRevert;if(!xf.b(k)){const r=this.Od;r.Color=b[gl.ColorPicker.Hvd];this.root.executeCommand(k,r,this.mk,0,!1)}}}ZJ(b){b=km.Control.H$e(this.Vu,this.colorPicker.width,this.mKa.length,b);if(b!==this.Vu&&this.l_c(b))return!0;this.Uce(this.mKa[this.Vu],!1);return!1}FX(){return this.l_c(0)}l_c(b){return this.mKa&&this.mKa.length>b&&(b=this.mKa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}mna(){-1!==
this.Vu&&this.Uce(this.mKa[this.Vu],!1)}static aHd(b){return Zm.IBl(b)}static IBl(b){var k=["td"];const r=k.length;if(!b)return null;for(var y=0;y<r;y++)if(b.tagName.toLowerCase()===k[y].toLowerCase())return b;for(b=b.parentNode;b;){for(y=0;y<r;y++)if(b.tagName.toLowerCase()===k[y].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)(Zm,"ColorPickerBehavior",Vi,[]);var mm=c(278),Vm=c(280),Zg=c(1604),sp=c(689),Xi=c(392),Gn=c(1105);class Hl{constructor(b,k){this.gZj=b;this.SKg=k}P6d(b,k,r,
y){if(xf.c(b)||xf.c(k))return null;const R=new Gn.a;const aa=y.x;var ta=y.y;const Ya=y.width;var xb=y.height;let Mb;Hl.r0b(k,"flyoutWidth");y=Hl.r0b(k,"flyoutRealHeight");const cc=Hl.r0b(k,"viewportWidth");var jc=Hl.r0b(k,"viewportHeight"),Mc=Hl.r0b(k,"viewableLeft");const fd=Hl.r0b(k,"viewableTop"),Td=this.gZj;let ne=!1,ye=!1;const ff=1===r,Gd=4===r,oe=this.SKg;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Mb=this.Wri(b);R.xmj=jc;R.hag=cc;if(ff)Td?k=
aa+Ya:(k=aa-Mb,R.lhb=!0),xb=ta;else{var ze="";Ya>Mb&&(Mb=Ya,ze=(Mb-2*Xi.Menu.bVd).toString());Td?k=aa:(k=aa+Ya-Mb,R.lhb=!0);xb=ta+xb;""!==ze&&(b.style.minWidth=ze+"px")}oe&&(xb+=fd,k+=Mc);b.style.top=xb+"px";b.style.left=k+"px";let ug=!1;ze=!1;Mb<=cc?k+Mb>Mc+cc?(ff&&Td&&aa-Mb>Mc||Gd&&aa-Mb>Mc?(k=aa-Mb,oe&&(k+=Mc),ze=R.lhb=!0):(k=Mc+cc-Mb,ne=!0),ug=!0):k<Mc&&(ff&&!Td&&aa+Ya+Mb<Mc+cc?(k=aa+Ya,oe&&(k+=Mc),R.lhb=!1,ze=!0):(k=Mc,ye=!0,R.lhb=!0),ug=!0):Td?(k=Mc,ug=!0,R.lhb=!0):(k=Mc+cc-Mb,ug=!0,R.lhb=!1);
ug&&(b.style.left=k+"px");R.U1b=xb;xb+y<=fd+jc&&3!==r||(R.wwf=!0,{uNm:r,Ndl:ta,lfm:jc,Vlm:Mc}=this.k$e(r,xb,y,ta,fd,jc),xb!==r&&(b.style.top=r+"px",R.U1b=r),-1<ta&&(b.style.maxHeight=ta+"px"),jc&&(b.style.bottom="0px",b.style.height="auto"),Mc&&this.YFm(b,Td,ff,ze,ye,ne,cc,aa,Ya));R.NGc=k;R.G$e=Mb;R.D$e=y;return R}k$e(b,k,r,y,R,aa){let ta,Ya,xb;ta=-1;xb=Ya=!1;const Mb=k,cc=R+aa-k;k=y-r;const jc=this.SKg;let Mc=!1;0>k&&(k=R);jc||(y-=R);r<=y&&1!==b||(4===b||1===b?r<aa?(k=aa-r,Ya=!0):(k=R,Mc=xb=Ya=!0):
(y<cc&&3!==b?(k=Mb,Ya=!0):ta=y,xb=!0));jc&&(Ya=!1,Mc?ta=aa:k+=R);return{uNm:k,Ndl:ta,lfm:Ya,Vlm:xb}}YFm(b,k,r,y,R,aa,ta,Ya,xb){b.style.overflowY="scroll";b.style.width="auto";if(k){if(aa||y)b.style.left="",b.style.right=(aa?0:ta-Ya)+"px"}else R||y||(b.style.left="",b.style.right=(r?ta-Ya:ta-Ya-xb)+"px")}Crl(b){const k={};if(xf.c(b))return k;k.viewportWidth=Fd.a.GBb();k.viewportHeight=Fd.a.w2();xf.c(k.viewportWidth)&&(k.viewportWidth=document.documentElement.clientWidth,k.viewportHeight=document.documentElement.clientHeight);
xf.c(k.viewportWidth)&&(k.viewportWidth=document.body.clientWidth,k.viewportHeight=document.body.clientHeight);k.viewableTop=window.pageYOffset;k.viewableLeft=window.pageXOffset;xf.c(k.viewableTop)&&(k.viewableTop=document.documentElement.scrollTop,k.viewableLeft=document.documentElement.scrollLeft);xf.c(k.viewableTop)&&(k.viewableTop=document.body.scrollTop,k.viewableLeft=document.body.scrollLeft);k.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Xi.Menu.bVd:b.scrollHeight;const r=
b.style.overflowY;b.style.overflowY="visible";k.flyoutWidth=this.Wri(b);b.style.overflowY=r;return k}Wri(b){return b.offsetWidth}static r0b(b,k){return xf.c(b)?0:b[k]}}Object(m.a)(Hl,"MenuPositioner",null,[]);var ma=c(530),bb=c(618),Ab=c(1107),ac=c(1106),sc=c(1103),Sc=c(1104),Cd=c(1109),ke=c(411),Dd=c(953);class $d extends Vi{constructor(b){super(b);this.rze=0;this.QOg=null;this.RCe=-1;this.r$c=null;this.oMf=this.YHg=!1;this.ZNj=new Hl(0===this.root.P_,mg.a.vr(this.root.properties.DivSyndicated))}get hsi(){return this.ZNj}get ou(){return this.control}get properties(){return this.control.Fh}get menu(){return this.ou.menu}set menu(b){this.ou.menu=
b}get tK(){return this.ou.tK}set tK(b){this.ou.tK=b}get xgh(){xf.c(this.r$c)&&(this.r$c=$d.PLk());return this.r$c}get X4i(){let b=!this.root.gnf;Object(Jb.a)(278,this.root)&&1===this.root.VFb&&(b=!0);return b}uw(b,k){Object(Jb.a)(278,this.root)&&this.root.z7e();this.ou.UZ(k)}UZ(b){if(this.ou.enabled&&!this.tK){var k=Db.a.instance.qo(ib.a.UZ);k.properties.add("Id",this.ou.Fh.Id);k.properties.add("InputMethod",mm.a[b]);k.end();Ee.a.mark(10326);Qe.a.$Ud(this.ou.Fh.Id,"MenuOpen");this.ou.eu&&(this.ou.qea=
Qe.a.wLa(this.ou.eu.ownerDocument));this.rze=b;this.zGi(b);this.k6d();this.ou.x4a(this.ou.eu,!0)}}k6d(){xf.c(this.properties.PopulateAsyncTriggerCommand)||this.YHg||(this.WOm(),this.YHg=!0)}WOm(){const b={};b[Zg.a.Callback]=Object(u.a)(this,this.WMi,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.mk,0,!1)}WMi(){this.ou.bPa()}bPa(){this.tK&&this.zGi(this.rze,!0)}zGi(b,k=!1){var r=!0;if(mg.a.vr(this.properties.PopulateDynamically)){r=!1;const y=this.dVc(b);
y!==this.QOg&&(r=this.DMf(y,k));r=r||!this.tK}r&&(k=n.AFrameworkApplication.ta.lq,r=null,k&&(r=k.jg("LoadResource","Menu Initialization")),this.VZa(b),r&&r.stop(),this.bYd())}VZa(b){if(!xf.c(this.menu)){if(this.ou.H1a){var k=this.ou.mk;if(k&&k.keytip){var r=k.keytip.key.toLocaleLowerCase();this.menu.sPn(String.format("{0} {1}",this.ou.H1a,k.keytip.F6e),this.ou.FOa&&""!==this.ou.FOa?String.format("{0}-{1}",this.ou.FOa,r):r)}}this.menu.ala();mg.a.Qf(this.menu.Lc,this.ou.kQe);mg.a.X3(this.menu.Lc,"cui-touch",
3===b||this.root.Dbe);if(this.menu.hasItems()){this.menu.$H();k=this.mk;k.tFh();k.HLc=!0;k.Rf(this.menu);k.HLc=!1;this.menu.xGi();r=Object(Jb.a)(Dd.a,this.root);var y=null,R=!1;r&&(y=this.root,R=y.n3a,y.n3a=!1);var aa=this.menu.Lc;aa.style.visibility="hidden";aa.style.position="absolute";aa.style.top="0px";aa.style.left="0px";X.a.Ak&&!X.a.sgb&&(aa.style.maxHeight="100px",aa.style.overflowY="scroll");document.body.appendChild(aa);this.Dak();this.Q8m(aa);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.m2j();mg.a.Qf(this.ou.ZEb,Nm.MenuLauncher.aSc);var ta=this.root.VFb;this.PVn&&this.root.Ida(this.control,!0);aa.style.zIndex=String(n.AFrameworkApplication.ta.Ara);this.root.O4j(this.ou);this.menu.Coa=ta;aa.style.visibility="visible";ta=this.ZOh();if(Object(Jb.a)(Sc.a,this.menu)){aa.style.position="fixed";const Ya=this.root.ZB[0];Ya&&Ya.menu&&Ya.menu.Lc?100!==Qe.a.eJc(this.root.ZB[0].menu.Lc)&&Vm.a.l1f(aa,ta,Object(u.a)(this,this.uQe,"afterShowMenu")):Vm.a.l1f(aa,ta,Object(u.a)(this,this.uQe,
"afterShowMenu"))}else Vm.a.l1f(aa,ta,Object(u.a)(this,this.uQe,"afterShowMenu"));this.tK=!0;this.menu.vwf=!0;!X.a.mi&&this.ou.zHn&&this.menu.setFocus(b);r&&(y.n3a=R);r=this.properties.CommandMenuOpen;xf.b(r)||this.root.executeCommand(r,null,k,b,!1)}}Ee.a.mark(10327)}bYd(){}m2j(){this.RCe=mg.a.Nwb(this.RCe);this.RCe=window.setTimeout(Object(u.a)(this,this.n2j,"addAndPositionBackFrameInternal"),50)}n2j(){this.menu&&this.menu.Lc&&(document.body.appendChild(this.xgh),this.M8m())}M8m(){const b=this.xgh;
var k=this.menu.Lc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=k.style.left;b.style.right=k.style.right;b.style.top=k.style.top;b.style.bottom=k.style.bottom;let r=k.offsetWidth;k=k.offsetHeight;X.a.sgb&&(r-=4,k-=4);b.style.width=r.toString()+"px";b.style.height=k.toString()+"px";b.style.visibility="visible"}get PVn(){return this.root.VFb?!1:!0}uQe(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Lc===b.element&&Object(Jb.a)(sc.a,this.menu)&&
Vm.a.cck(this.ZOh()))}ZOh(){const b=this.menu.children,k=[];if(Object(Jb.a)(sc.a,this.menu))for(let r=0;r<b.count;r++){const y=b.J(r);Array.add(k,y.separator);for(let R=0;R<y.children.count;R++){const aa=y.children.J(R);Array.add(k,aa.Lc)}}return k}Dak(){var b=this.menu.children;for(let r=0;r<b.count;r++){const y=b.J(r).children;for(let R=0;R<y.count;R++){var k=y.J(R);if(Object(Jb.a)(lm.a,k)){const aa=k;if("Menu32"===aa.ZS||"Menu48"===aa.ZS)k=k.control,k.behavior&&(Object(Jb.a)(bb.a,k)||Object(Jb.a)(ac.a,
k))&&k.behavior.Aak()}}}0<b.count&&(b=b.J(0),xf.c(b.separator)||(b.separator.style.display="none"),xf.c(b.ibe)||mg.a.Qf(b.ibe,"cui-menusection-titleAtTop"))}Q8m(b){if(!xf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var k=sp.a.create();try{const r=this.hsi.Crl(b),y=this.OIc();let R=this.root.P6d(b,r,this.ou.cVd,y);R||(R=this.hsi.P6d(b,r,this.ou.cVd,y));this.root.isi=R}finally{k&&k.dispose()}}}OIc(){const b=Qe.a.getElementBounds(this.ou.ZEb);
var k=this.lH;xf.c(k)||xf.c(k.Lc)||(k=Qe.a.getElementBounds(k.Lc),b.x=k.x+Xi.Menu.bVd,b.width=k.width-2*Xi.Menu.bVd);Object(Jb.a)(ke.a,this.ou.bSd)&&(b.height=0);return b}fsa(){if(this.ou.tK){v.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.ou.Fh.Id});this.menu.mna();this.sPi();this.tK=!1;this.menu.vwf=!1;this.root.v$(this.control,!0);this.X4i?n.AFrameworkApplication.ta.UYc(this.ou.qea,this.rze):this.vAn();this.ou.qea=null;var b=this.ou.ZEb;mg.a.Mu(b,Nm.MenuLauncher.aSc);this.ou.x4a(this.ou.eu,
!1);mg.a.Mu(b,"cui-ctl-menu-hovered-without-focus");this.menu.Zna();xf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.mk,0,!1);this.rPi()}}vAn(){const b=this.ou.qea;if(b)try{b.focus()}catch(k){}}rPi(){Fd.a.Nu(this.menu.Lc);Fd.a.Nu(this.r$c);mg.a.Hwa(this.menu.Lc)}dVc(b){if(this.oMf&&mg.a.vr(this.properties.PopulateOnlyOnce)||xf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const k=this.ou.Hcf();return 0<(this.root.Jna(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,k,b)&1)?k.PopulationXML:null}DMf(b,k=!1){if(this.oMf&&mg.a.vr(this.properties.PopulateOnlyOnce))return!0;let r=null;this.QOg=b;xf.c(b)||(r=this.SMk(b));xf.c(r)||(this.oMf=!0);if(k){this.root.myk(this.ou);if(xf.c(r)||!r.hasItems())return this.fsa(),!1;this.sPi();this.rPi()}this.uOn(r);return!0}ryi(){}SMk(b){b=ma.Builder.lth(b);if(!xf.c(b)){const k=new Cd.a;k.Uoh=!0;k.parentId=this.control.id;let r;r=Object(Jb.a)(Ab.a,this.control);return this.root.rN.gWa(b,k,r)}return null}uOn(b){xf.c(b)||
(xf.c(this.menu)||this.menu.dispose(),this.menu=b,this.ryi())}sPi(){const b=this.menu.parent;b?(b.HLc=!0,b.removeChild(this.menu.id),b.HLc=!1):v.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let k=!1;xf.c(b.Ib)||xf.c(b.Ib.rawEvent)||Object(Jb.a)(lm.a,this.mk)||!b.Ib.rawEvent.altKey||b.Ib.keyCode!==Sys.UI.Key.down||(this.uw(b.Af,1,b.Ib),k=!0);k||(k=super.onKeyDown(b));return k}$B(b){this.KYe();2===b.ig&&b.Iaa!==Sys.UI.MouseButton.leftButton||
this.uw(b.Af,b.ig,b.Ib);b.Ib.preventDefault();return!1}Akf(b){if(!this.lH||!this.lH.inKeytipMode||!this.ou.Bzi)return!1;this.ou.Bzi(this.mk,b);return!0}static PLk(){const b=mg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)($d,"MenuLauncherBehavior",Vi,[548,533]);var mf=c(903);class jg extends $d{constructor(b){super(b)}get Is(){return this.QEc.properties}get QEc(){return this.control}get SKa(){return this.QEc.SKa}$H(){fj.a.instance.mb(Kb.a.pointerDown,
this.SKa.Bm,Object(u.a)(this,this.$B,"onPointerDown"));bc.KeyInputManager.instance.mb(Kb.a.ni,this.SKa.Bm,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.oh,this.SKa.Bm,Object(u.a)(this,this.gx,"onKeyUp"))}xl(){const b=this.Od[mf.a.SelectedItemId];if(0<(this.Nt(this.Is.Command,this.Is.QueryCommand,this.Od)&2)){const k=this.Od[mf.a.SelectedItemId];xf.c(k)||b===k||this.QEc.FZc(k)||(this.Od[mf.a.SelectedItemId]=null)}}}Object(m.a)(jg,"DropDownBehavior",$d,[]);var ge=
c(542),ng=c(699);class Sg extends jg{constructor(b){super(b);this.tSa=null;this.aAe=this.Gqb=this.rya=!1;this.Etc=null;this.Ctc=-1}get T1(){return this.control}get yP(){return this.T1.yP}get NG(){return this.T1.NG}get bPd(){return this.Od[ge.a.IsFreeForm]}set bPd(b){this.Od[ge.a.IsFreeForm]=b}$H(b){fj.a.instance.mb(Kb.a.pointerDown,b.Bm,Object(u.a)(this,this.$B,"onPointerDown"));const k=b.Tq;ee.a.instance.mb(Kb.a.focus,k,Object(u.a)(this,this.yib,"onInputFocus"));ee.a.instance.mb(Kb.a.blur,k,Object(u.a)(this,
this.fva,"onInputBlur"));bc.KeyInputManager.instance.mb(Kb.a.ni,k,Object(u.a)(this,this.MVm,"onInputKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.Kt,k,Object(u.a)(this,this.NVm,"onInputKeyPress"));pf.a.instance.mb(Kb.a.Kaa,k,Object(u.a)(this,this.vHf,"onInputMouseUp"));fj.a.instance.mb(Kb.a.pointerDown,k,Object(u.a)(this,this.PVm,"onInputPointerDown"));fj.a.instance.mb(Kb.a.pointerDown,b.aEh,Object(u.a)(this,this.UHf,"onMenuButtonPointerDown"))}xl(){0<(this.Nt(this.NG.Command,this.NG.QueryCommand,
this.Od)&2)&&(this.Gqb||this.Fkj(),this.mlo())}ryi(){this.T1.menuItems=null;var b;var k=b=null;if(!xf.c(this.menu)){this.y6d();for(let y of this.menu.children)for(let R of y.children)if(Object(Jb.a)(lm.a,R)){var r=R;r=r.control;Object(Jb.a)(537,r)&&(b=r,b=b.Fh.MenuItemId);Object(Jb.a)(524,r)&&(k=r,k=k.fZa());xf.c(b)||xf.c(k)||(this.T1.menuItems[k]=b,b=k=null)}}}PVm(b){Object(Jb.a)(278,this.root)&&2===b.ig&&(this.tSa=Qe.a.wLa(this.control.eu.ownerDocument),this.control.eu.focus());return!1}$B(b){this.KYe();
let k=!1;3===b.ig&&(k=super.$B(b),this.y6d());k&&b.Ib.preventDefault();return!1}UHf(b){let k=!1;if(2!==b.ig||b.Iaa===Sys.UI.MouseButton.leftButton)this.uw(b.Af,b.ig,b.Ib),this.y6d(),k=!0;k&&b.Ib.preventDefault();return!1}MVm(b){let k=!1;if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;mg.a.vr(this.NG.AutoComplete);if(r===Sys.UI.Key.enter)this.GS(),this.bVf(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0;else if(r===Sys.UI.Key.tab){if(this.GS(),this.bVf(),
Object(Jb.a)(ng.Ribbon,this.root)&&(k=this.root.Oee(this.mk.Lc,!b)),Object(Jb.a)(278,this.root))return!0}else r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.control.enabled?(this.$Ve(),this.Etc=null):k=!0:r===Sys.UI.Key.esc?(this.gVf(),this.bVf(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0):r===Sys.UI.Key.down&&(this.UZ(1),this.y6d(),k=!0)}return k}NVm(b){if(!this.control.enabled)return!0;!xf.c(b.Ib)&&b.Ib.charCode&&this.yTk();return!1}vHf(){return this.rya?!1:this.rya=!0}t6k(){this.Ctc=
-1;const b=this.yP.Tq,k=b.value,r=this.Xtl(k);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(k.length,b.value.length);else if(b.createTextRange){const y=b.createTextRange();y.moveStart("character",k.length);y.moveEnd("character",b.value.length);y.select()}this.Etc=r.value}else this.Etc=null}Xtl(b){const k=this.T1.menuItems;for(let r in k){const y={key:r,value:k[r]};if(y.key.toLowerCase().startsWith(b.toLowerCase()))return y}return null}yTk(){mg.a.vr(this.NG.AutoComplete)&&-1===this.Ctc&&
(this.aAe&&(this.dVc(0),this.aAe=!1),this.Ctc=window.setTimeout(Object(u.a)(this,this.t6k,"executeAutoComplete"),this.T1.Rhk))}$Ve(){mg.a.vr(this.NG.AutoComplete)&&(this.Ctc=mg.a.Nwb(this.Ctc))}yib(b){if(this.tK)return this.menu.setFocus(0),!0;Object(Jb.a)(278,this.root)&&(Id.FocusManager.instance().iC("ribbon"),this.root.XKc=!1);this.onFocus(b);this.Gqb=!0;mg.a.Qf(this.yP.Bm,"cui-cb-focus");mg.a.vr(this.NG.PopulateDynamically)&&(this.aAe=!0);Qe.a.BZc(this.yP.Tq);xf.c(this.menu)||this.menu.im();return this.rya=
!1}fva(){this.Gqb=!1;this.GS();mg.a.Mu(this.yP.Bm,"cui-cb-focus");return!1}bVf(){Object(Jb.a)(278,this.root)&&(void 0!==this.tSa&&null!==this.tSa&&n.AFrameworkApplication.ta.UYc(this.tSa,2),this.tSa=null)}GS(){if(this.control.enabled){this.$Ve();var b=this.yP.Tq;if(void 0===this.Od[ge.a.Value]||null===this.Od[ge.a.Value]||b.value!==this.Od[ge.a.Value].toString())if(this.T1.FZc(this.Etc))this.bPd=!1,this.Od[ge.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.T1.KZc.pAb(),["MenuItemId"]:this.T1.KZc.Fh.MenuItemId},
this.root.executeCommand(this.NG.Command,b,this.mk,0,!1);else{if(!mg.a.vr(this.NG.AutoComplete)){var k=this.T1.menuItems[b.value];if(!xf.b(k)&&this.T1.FZc(k)){this.bPd=!1;this.Od[ge.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.T1.KZc.pAb(),["MenuItemId"]:k};this.root.executeCommand(this.NG.Command,b,this.mk,0,!1);return}}k=!xf.b(b.value)&&""!==A.a.Nva(b.value);this.T1.ich&&k?(this.bPd=!0,this.Od[ge.a.Value]=b.value,this.root.executeCommand(this.NG.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.mk,0,!1)):this.gVf()}}else this.gVf()}gVf(){this.$Ve();this.Etc=null;this.Fkj()}Fkj(){const b=this.Od[ge.a.Value]||"";b!==this.yP.Tq.value&&(this.yP.Tq.value=b);this.T1.FZc(this.T1.menuItems[b])}mlo(){const b=this.Od[ge.a.FontStyle]||"normal";b!==this.yP.Tq.style.fontStyle&&(this.yP.Tq.style.fontStyle=b)}y6d(){this.control.eu&&this.menu&&this.control.eu.setAttribute(Ef.a.sfh,this.menu.id)}}Object(m.a)(Sg,"ComboBoxBehavior",jg,[]);class qj extends $d{constructor(b){super(b)}get Mwd(){return this.control}OIc(){let b=
0;this.menu&&this.menu.Lc&&2===this.menu.horizontalAlignment&&(b=this.menu.Lc.clientWidth);return new Sys.UI.Bounds(this.Mwd.x-b,this.Mwd.y,this.Mwd.ywf,this.Mwd.xwf)}}Object(m.a)(qj,"ContextMenuLauncherBehavior",$d,[]);class wi extends $d{constructor(b){super(b)}get wzd(){return this.control}OIc(){return new Sys.UI.Bounds(this.wzd.x,this.wzd.y,this.wzd.ywf,this.wzd.xwf)}}Object(m.a)(wi,"DialogMenuLauncherBehavior",$d,[]);var Ki=c(616);class Zi extends $d{constructor(b){super(b);this.dAe=!1;this.DWj=
!mg.a.rfa(this.Is.ShouldRefreshWhenDropped)}get eBa(){return this.control}get Is(){return this.control.Fh}$H(b){b=b.Bm;xf.c(b)||(ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus")),ee.a.instance.mb(Kb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur")),fj.a.instance.mb(Kb.a.pointerOver,b,Object(u.a)(this,this.tX,"onPointerOver")),bc.KeyInputManager.instance.mb(Kb.a.ni,b,Object(u.a)(this,this.onKeyDown,"onKeyDown")),bc.KeyInputManager.instance.mb(Kb.a.oh,b,Object(u.a)(this,this.gx,
"onKeyUp")),fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.$B,"onPointerDown")))}xl(){xf.c(this.control.Fh.Command)||(this.eBa.tK&&!this.DWj?this.dAe=!0:(0<(this.Nt(this.Is.Command,this.Is.QueryCommand,this.Od)&2)&&this.H4a()&&this.UQa(),mg.a.vr(this.Is.RefreshableMenu)&&this.tK&&this.menu.N7m()))}UQa(){this.jlo();this.Hha();this.Wlo();this.eBa.Qmf=this.Od[Ki.a.ImageIsVisible]}jlo(){const b=mg.a.bpa(this.Od[Ki.a.LabelText],this.Is.LabelText),k=this.Od[Ki.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Is.LabelTextUserGeneratedPlaceholderReplacements!==k)this.eE.medium&&this.klo(this.eE.medium.JN,b,k),this.root.Z0a=!0,this.control.labelText=b,this.Is.LabelTextUserGeneratedPlaceholderReplacements=k}klo(b,k,r){const y=b.lastChild;mg.a.a_i(b,k+" ",r);k=xf.c(y);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",k?"":y.nodeType.toString());k||b.appendChild(y)}Wlo(){const b=this.Od[Ki.a.ImageBackColor];this.eE.forEach(k=>
{Zi.eek(k.PP,b)})}UZ(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(n.AFrameworkApplication.Gaa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),n.AFrameworkApplication.ya.processAction(ib.a.Bzd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||n.AFrameworkApplication.ya.processAction(ib.a.Bzd,2);Object(Jb.a)(lm.a,this.mk)&&(this.tK||this.TXe(!0),this.control.enabled&&
this.FX());super.UZ(b)}fsa(){super.fsa();this.dAe&&(this.dAe=!1,this.xl())}tX(b){return this.control.lEb()?(this.eBa.tK?(this.root.xlh(),mg.a.Qf(this.eBa.ZEb,Nm.MenuLauncher.aSc),this.eBa.qea=this.control.eu):(super.tX(b),this.uw(b.Af,b.ig,b.Ib)),!1):super.tX(b)}onKeyDown(b){let k=!1;if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){if(Object(Jb.a)(lm.a,this.mk)){const r=b.Ib.rawEvent,y=b.Ib.keyCode,R=0===this.root.P_;r.shiftKey||r.ctrlKey||!(y===Sys.UI.Key.right&&R||y===Sys.UI.Key.left&&!R)||(k=this.Akf(b),
k||(this.uw(b.Af,1,b.Ib),k=!0))}k||(k=super.onKeyDown(b))}return k}static eek(b,k){xf.c(b)||xf.c(k)||b.style.backgroundColor===k||(b.style.backgroundColor=k)}}Object(m.a)(Zi,"FlyoutAnchorBehavior",$d,[]);var eh=c(932);class Zl extends Vi{constructor(b){super(b)}get k2b(){return this.control}get properties(){return this.k2b.properties}get Uda(){return this.k2b.Uda}$H(b){b=b.dzb;ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,b,Object(u.a)(this,this.onBlur,
"onBlur"));fj.a.instance.mb(Kb.a.pointerOver,b,Object(u.a)(this,this.tX,"onPointerOver"));fj.a.instance.mb(Kb.a.pointerOut,b,Object(u.a)(this,this.kO,"onPointerOut"));bc.KeyInputManager.instance.mb(Kb.a.ni,b,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.oh,b,Object(u.a)(this,this.gx,"onKeyUp"));fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.$B,"onPointerDown"));fj.a.instance.mb(Kb.a.hM,b,Object(u.a)(this,this.gva,"onPointerUp"));wl.a.instance.mb(Kb.a.BO,
b,Object(u.a)(this,this.Lib,"onTouchMove"));wl.a.instance.mb(Kb.a.kJ,b,Object(u.a)(this,this.zDa,"onTouchEnd"))}xl(){const b=this.Od[eh.a.On],k=this.Od[eh.a.IsRtl];this.nkj();if(0<(this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)){var r=!xf.c(this.Od[eh.a.InnerHTML])||!xf.c(this.properties.InnerHTML),y=!xf.c(this.properties.Image);r||y||(this.control.enabled=!1);y=this.Uda.dzb;if(!xf.c(y)){if(r){r=mg.a.bpa(this.Od[eh.a.InnerHTML],this.properties.InnerHTML);if(null===y.innerHTML||
null===r||A.a.mh(y.innerHTML)!==A.a.mh(r))y.innerHTML=r;""===r&&(this.control.enabled=!1)}r=y.title;const R=mg.a.bpa(this.Od[eh.a.Alt],this.properties.Alt);R===r||this.control.a0f||(y.title=R)}y=this.Od[eh.a.IsRtl];b===this.Od[eh.a.On]&&k===y||this.control.dHb()}}nkj(){const b=this.Od;b[eh.a.CommandValueId]=this.control.pAb();b.MenuItemId=this.control.Fh.MenuItemId;b.SourceControlId=this.properties.Id}uw(b,k,r){if((b=this.mk)&&this.control.enabled){const y=this.root;if(n.AFrameworkApplication.K&&
n.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.tOc()&&this.lH){const R=y.ZB[this.lH.Coa];R?R.LPa(this.k2b):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.nkj();this.Od[eh.a.On]||(this.Od[eh.a.On]=!0,this.control.dHb());"Menu"===b.ZS&&mg.a.Mu(this.Uda.Bm,"cui-gallerybutton-focused");y.executeCommand(this.properties.Command,this.Od,b,k,!0,null,this.Zea(r))}}onFocus(b){super.onFocus(b);mg.a.Qf(this.Uda.Bm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);mg.a.Mu(this.Uda.Bm,"cui-gallerybutton-focused");return!1}}Object(m.a)(Zl,"GalleryButtonBehavior",Vi,[]);var nl=c(1110),mb=c(1349),nc=c(649);class Wc extends Vi{constructor(b){super(b);this.DTa=-1}get L5b(){return this.control}get properties(){return this.L5b.Fh}get BBc(){return this.L5b.BBc}get lmf(){var b=null;if(this.mk&&(b=this.mk.parent,!Object(Jb.a)(nc.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get MCb(){return this.L5b.aNd.MCb}get nUc(){return this.L5b.aNd.nUc}uw(b,
k,r){if(this.control.enabled){b=this.rff(this.x2b(b));const y=this.MEd(b);this.BBc[mb.a.Rows]=this.dId(b)+1;this.BBc[mb.a.Columns]=y+1;this.root.executeCommand(this.properties.Command,this.BBc,this.mk,k,!0,null,this.Zea(r))}}$H(b){var k=b.Bm;const r=b.kmh;b=b.cells;fj.a.instance.mb(Kb.a.pointerOut,k,Object(u.a)(this,this.oTm,"onControlPointerOut"));wl.a.instance.mb(Kb.a.BO,k,Object(u.a)(this,this.qTm,"onControlTouchMove"));wl.a.instance.mb(Kb.a.kJ,k,Object(u.a)(this,this.pTm,"onControlTouchEnd"));
for(k=0;k<b.length;++k)this.ohk(r[k],b[k])}ohk(b,k){ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.jGf,"onCellFocus"));fj.a.instance.mb(Kb.a.pointerOver,k,Object(u.a)(this,this.kGf,"onCellPointerOver"));fj.a.instance.mb(Kb.a.hM,k,Object(u.a)(this,this.lGf,"onCellPointerUp"));bc.KeyInputManager.instance.mb(Kb.a.ni,k,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.oh,k,Object(u.a)(this,this.gx,"onKeyUp"));wl.a.instance.mb(Kb.a.DO,k,Object(u.a)(this,this.lSm,"onCellTouchStart"))}rff(b){return parseInt(b.id.substr(this.L5b.id.length+
1))}n4h(b){this.m4h(this.rff(b))}dId(b){return Math.floor(b/nl.a.XSc)}MEd(b){return b%nl.a.XSc}m4h(b){if(b!==this.DTa){var k=this.MEd(b),r=this.dId(b),y=-1;let R=-1;-1!==this.DTa&&(y=this.dId(this.DTa),R=this.MEd(this.DTa));for(;y!==r||R!==k;)y<r?this.q1i(++y,R,!0):y>r?(this.q1i(y,R,!1),y--):R<k?this.PZi(++R,y,!0):R>k&&(this.PZi(R,y,!1),R--);this.lmf?this.lmf.d2i(this.IOh(r+1,k+1)):(r=(k=this.control.WYe)&&0<k.length?k[0]:null,y=this.mk,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!k,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!y,["DispCompPar"]:!!y&&!!y.parent}));this.DTa=b}}q1i(b,k,r){for(let y=0;y<=k;y++)this.GZi(b,y,r)}PZi(b,k,r){for(let y=0;y<=k;y++)this.GZi(y,b,r)}GZi(b,k,r){k=b*nl.a.XSc+k;b=this.MCb[k];k=this.nUc[k];r?(b.className="cui-it-activeCell",k.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",k.className="cui-it-inactiveCellOuter")}lGf(b){this.uw(b.Af,b.ig,b.Ib);return!0}x2b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return xf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}e2i(b){const k=this.rff(b);b.childNodes[0].childNodes[0].title=this.IOh(this.dId(k)+1,this.MEd(k)+1)}IOh(b,k){let r=this.properties.Alt;xf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,k.toString(),b.toString())}Jcc(){if(this.mk){for(var b=0;b<nl.a.y$b;b++)this.MCb[b].className="cui-it-inactiveCell",this.nUc[b].className="cui-it-inactiveCellOuter";this.DTa=-1;b=this.properties.MenuSectionInitialTitle;
xf.c(b)&&(b="");this.lmf.d2i(b)}}kGf(b){this.control.enabled&&(b=this.x2b(b.Af),this.l_c(b),this.u5e(b));return!1}u5e(b){this.e2i(b);this.n4h(b)}jGf(b){if(!this.control.enabled)return!1;b=this.x2b(b.Af);this.e2i(b);this.n4h(b);return!1}oTm(b){Qe.a.etf(this.L5b.aNd.Bm,b.clientPoint)||this.Jcc();return!1}lSm(b){if(!this.control.enabled)return!1;b=this.x2b(b.Af);this.u5e(b);return!0}qTm(b){if(!this.control.enabled)return!1;b=Qe.a.BFd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.x2b(b))?this.u5e(b):this.Jcc();return!0}pTm(b){if(!this.control.enabled)return!1;var k=Qe.a.BFd(b.clientPoint);if(!k||"table"===k.tagName.toLowerCase())return this.Jcc(),!0;(k=this.x2b(k))?this.uw(k,3,b.Ib):this.Jcc();return!0}ZJ(b){b=km.Control.H$e(this.DTa,nl.a.XSc,nl.a.y$b,b);if(b!==this.DTa)return this.MCb[b].firstChild.focus(),this.m4h(b),!0;this.Jcc();this.DTa=-1;return!1}FX(){const b=this.MCb[0];if(xf.c(b))return!1;b.firstChild.focus();return!0}l_c(b){if(xf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}mna(){this.Jcc()}}Object(m.a)(Wc,"InsertTableBehavior",Vi,[]);class vd extends $d{constructor(b){super(b)}xl(){this.control.enabled=!!this.menu}uw(b,k,r){n.AFrameworkApplication.ya.Xb(ib.a.ENa,2,k,this.Zea(r))}}Object(m.a)(vd,"JewelMenuLauncherBehavior",$d,[]);var Md=c(1030);class tf extends Vi{constructor(b){super(b)}get properties(){return this.control.Fh}xl(){0<(this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.H4a()&&this.UQa()}UQa(){this.mpo();this.Hha();
this.OMb()}mpo(){const b=this.control.labelText;let k=this.Od[Md.a.Value];xf.c(k)&&(k=this.properties.LabelText,xf.c(k)&&(k=""));k!==b&&this.f7d(k)}$H(b){b=b.Bm;xf.c(b)||(fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.$B,"onPointerDown")),fj.a.instance.mb(Kb.a.pointerOver,b,Object(u.a)(this,this.tX,"onPointerOver")),fj.a.instance.mb(Kb.a.pointerOut,b,Object(u.a)(this,this.kO,"onPointerOut")))}}Object(m.a)(tf,"LabelBehavior",Vi,[]);var If=c(857),fg=c(218),ea=c(318);class Ua extends $d{constructor(b){super(b);
this.ete=this.Rke=!1;this.zRb=this.aOb=null;if(this.ZRb=n.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.aOb=this.Ot.Pga.LightImage16by16Class,this.zRb=this.Ot.Pga.DarkImage16by16Class}get Ot(){return this.control}tWd(b,k,r,y){k&&(this.Ot.qea=r,n.AFrameworkApplication.ta.Bkb());if(Object(Jb.a)(fg.a,b)&&y){r=new If.a;r.CommandLocation=this.root.D7;r.InvocationMethod=0;const R={};(b=b.control)&&b.Fh&&(R.CommandId=b.Fh.Command,R.ControlId=b.Fh.Id,R.CloseAllMenus=k,b.lH&&b.lH.parent&&b.lH.parent.id&&
(R.ParentControlId=b.lH.parent.id.split("-")[0]),this.root.vE&&this.root.vE.gLa(y,R,r))}}fsa(){this.Ot.qea||(this.Ot.qea=this.Ot.Vx);!this.Ot.ELm&&this.ZRb&&(mg.a.Mu(this.Ot.Vx,"cui-sb-focus"),mg.a.Mu(this.Ot.Z_,"cui-sb-focus"),mg.a.Mu(this.Ot.Wva,this.aOb),mg.a.Qf(this.Ot.Wva,this.zRb));this.Rke=!0;super.fsa();this.Rke=!1;this.kQf()}get X4i(){return!this.Ot.NOa}bYd(){this.Ot.bYd()}R2d(){this.ete||this.Rke||(this.ete=!0,this.Ot.raiseEvent(ea.a.h_a,null))}kQf(){this.tK||this.Ot.lof||(this.ete=!1,this.Ot.raiseEvent(ea.a.cDb,
null))}sHf(b){mg.a.Mu(this.Ot.Vx,"cui-sb-focus");mg.a.Mu(this.Ot.Z_,"cui-sb-focus");this.ZRb&&!this.Ot.tK&&(mg.a.Mu(this.Ot.Wva,this.aOb),mg.a.Qf(this.Ot.Wva,this.zRb));this.Ot.raiseEvent(ea.a.blur,b);this.kQf();this.Ot.qea=this.Ot.Vx;return!1}tHf(b){mg.a.Qf(this.Ot.Vx,"cui-sb-focus");mg.a.Qf(this.Ot.Z_,"cui-sb-focus");this.ZRb&&(mg.a.Mu(this.Ot.Wva,this.zRb),mg.a.Qf(this.Ot.Wva,this.aOb));this.Ot.raiseEvent(ea.a.focus,b);this.R2d();return!1}VIf(){this.ZRb&&(mg.a.Qf(this.Ot.Z_,"cui-sb-hover"),mg.a.Qf(this.Ot.Vx,
"cui-sb-hover"),mg.a.Mu(this.Ot.Wva,this.zRb),mg.a.Qf(this.Ot.Wva,this.aOb));return!1}UIf(){this.ZRb&&(mg.a.Mu(this.Ot.Z_,"cui-sb-hover"),mg.a.Mu(this.Ot.Vx,"cui-sb-hover"),this.Ot.tK||this.Ot.lof||(mg.a.Mu(this.Ot.Wva,this.aOb),mg.a.Qf(this.Ot.Wva,this.zRb)));return!1}}Object(m.a)(Ua,"SearchBoxBehavior",$d,[536,533]);class sb{}sb.Value="value";sb.MinValue="MinValue";sb.MaxValue="MaxValue";sb.Text="Text";Object(m.a)(sb,"SliderCommandProperties",null,[]);class Lb extends Vi{constructor(b){super(b)}get Z1f(){return this.control}get O3(){return this.Z1f.O3}get properties(){return this.control.Fh}initialize(){}uw(){}$H(b){b=
b.Tq;ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));ee.a.instance.mb(Kb.a.change,b,Object(u.a)(this,this.Naa,"onChange"));ee.a.instance.mb(Kb.a.input,b,Object(u.a)(this,this.Naa,"onChange"))}onFocus(b){this.O3.Bm&&Sys.UI.DomElement.addCssClass(this.O3.Bm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.O3.Bm&&Sys.UI.DomElement.removeCssClass(this.O3.Bm,"cui-sldr-onfocus");return super.onBlur(b)}Naa(){this.eDk(this.O3.Tq.value);
return!0}eDk(b){this.Od[sb.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Od,this.mk,0,!1)}xl(){const b=this.Od[sb.Value],k=this.Od[sb.MaxValue],r=this.Od[sb.Text];var y=this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od);this.O3&&this.O3.Tq&&(this.O3.Tq.disabled=!this.control.enabled);if(0<(y&2)){y=this.Od[sb.Value];const R=this.Od[sb.MaxValue],aa=this.Od[sb.Text];(R!==k||y!==b||r!==aa)&&this.O3&&this.O3.Tq&&(this.O3.Tq.setAttribute(Ef.a.tsd,String.format("{0}",
R)),this.O3.Tq.setAttribute("max",String.format("{0}",R)),this.O3.Tq.value=y,this.O3.JN.innerText=this.Od[sb.Text])}}}Object(m.a)(Lb,"SliderBehavior",Vi,[]);var rc=c(1342);class Rc extends Vi{constructor(b){super(b);this.Zgd=0;this.B$a=null;this.ved=!1;this.r6g=null;this.pIe=!1;this.ekd=this.Cid=-1;this.rya=!1}get spinner(){return this.control}get bG(){return this.spinner.bG}get properties(){return this.control.Fh}initialize(){const b=this.spinner.K$f;this.r6g=this.jho(b);this.Zgd=b[0].min;this.B$a=
b[0];this.ved=!1}uw(){}$H(b){const k=b.Tq,r=b.X0b;b=b.$Ec;ee.a.instance.mb(Kb.a.focus,k,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,k,Object(u.a)(this,this.onBlur,"onBlur"));bc.KeyInputManager.instance.mb(Kb.a.ni,k,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.Kt,k,Object(u.a)(this,this.RF,"onKeyPress"));bc.KeyInputManager.instance.mb(Kb.a.oh,k,Object(u.a)(this,this.gx,"onKeyUp"));ee.a.instance.mb(Kb.a.change,k,Object(u.a)(this,this.Naa,
"onChange"));pf.a.instance.mb(Kb.a.Kaa,k,Object(u.a)(this,this.vHf,"onInputMouseUp"));fj.a.instance.mb(Kb.a.pointerDown,r,Object(u.a)(this,this.kxi,"onArrowPointerDown"));fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.kxi,"onArrowPointerDown"));fj.a.instance.mb(Kb.a.hM,r,Object(u.a)(this,this.lxi,"onArrowPointerUp"));fj.a.instance.mb(Kb.a.hM,b,Object(u.a)(this,this.lxi,"onArrowPointerUp"));wl.a.instance.mb(Kb.a.BO,r,Object(u.a)(this,this.nxi,"onArrowTouchMove"));wl.a.instance.mb(Kb.a.BO,
b,Object(u.a)(this,this.nxi,"onArrowTouchMove"));wl.a.instance.mb(Kb.a.kJ,r,Object(u.a)(this,this.mxi,"onArrowTouchEnd"));wl.a.instance.mb(Kb.a.kJ,b,Object(u.a)(this,this.mxi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);mg.a.Qf(this.bG.Bm,"cui-spn-focus");this.control.enabled&&Qe.a.BZc(this.bG.Tq);return this.rya=!1}onBlur(b){super.onBlur(b);mg.a.Mu(this.bG.Bm,"cui-spn-focus");return!1}onKeyDown(b){let k=!1;if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode,y=b.Ib.rawEvent.shiftKey;if(r===
Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.qqf(this.control)||this.t9i(r===Sys.UI.Key.up,b.ig),k=!0;else if(r===Sys.UI.Key.enter)this.GS(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0;else if(r===Sys.UI.Key.tab)this.GS(),Object(Jb.a)(ng.Ribbon,this.root)&&(k=this.root.Oee(this.mk.Lc,!y));else if(r===Sys.UI.Key.esc)this.Lcc(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)k=!this.control.enabled}return k}RF(){return!this.control.enabled}gx(){this.iSk();
return!1}Naa(){this.GS();return!1}vHf(){return this.rya?!1:this.rya=!0}kxi(b){var k=!1;let r=!0;2===b.ig&&(r=b.Iaa===Sys.UI.MouseButton.leftButton);r&&(k=b.Af,this.t9i(k===this.bG.X0b||k===this.bG.lEh||k===this.bG.kEh,b.ig),k=!0);return k}lxi(b){return this.Csa(b)}nxi(b){return this.PWd(b)}mxi(b){return this.Csa(b)}q2l(b){if(this.control.enabled){var k=!1;if(!this.ved){var r=this.mxl(b);r=b?r+this.B$a.step:r-this.B$a.step;r=Math.min(r,this.B$a.max);r=Math.max(r,this.B$a.min);r!==this.Zgd&&(this.JYe(r,
this.B$a),this.root.executeCommand(this.properties.Command,this.Od,this.mk,0,!1),k=!0)}k||(k=this.properties.SpinCommand,r=this.Od,r.Increment=b,xf.c(k)||this.root.executeCommand(k,r,this.mk,0,!1))}}mxl(b){const k=Math.pow(10,n.AFrameworkApplication.numberFormat.AWd),r=Math.round(this.B$a.step*k);let y=Math.round(this.Zgd*k)/r;y=b?Math.floor(y):Math.ceil(y);return y*r/k}t9i(b,k){if(this.control.enabled){this.GS();const r=b?this.bG.X0b:this.bG.$Ec;switch(k){case 2:case 3:this.pIe=b;this.lqd(r);break;
case 1:this.pIe=b,this.X1j(r)}}}X9i(){this.ylh();this.stk()}pzh(){-1===this.Cid&&(this.Cid=window.setTimeout(Object(u.a)(this,this.swn,"repeatSpin"),500))}ylh(){this.Cid=mg.a.Nwb(this.Cid)}swn(){this.ylh();-1===this.ekd&&(this.V9d(),this.ekd=window.setInterval(Object(u.a)(this,this.V9d,"spin"),50))}stk(){this.ekd=mg.a.otk(this.ekd)}V9d(){this.q2l(this.pIe)}X1j(b){this.root.Ida(this.control,!1);mg.a.Qf(b,km.Control.oqd);this.V9d();this.pzh()}iSk(){this.root.v$(this.control,!1);this.X9i();mg.a.Mu(this.bG.X0b,
km.Control.oqd);mg.a.Mu(this.bG.$Ec,km.Control.oqd)}jec(b){this.bG.Tq.value!==b&&(this.bG.Tq.value=b)}Lcc(){this.jec(this.Od[rc.a.Text])}d_i(b){this.jec(b);this.Od[rc.a.Text]=b;this.ved=!0}YKn(b,k,r){this.jec(r);this.Od[rc.a.Text]=r;this.Od[rc.a.Number]=b;this.Od[rc.a.UnitType]=k.type;this.Zgd=b;this.B$a=k;this.bG.Tq.setAttribute(Ef.a.wSe,r);this.bG.Tq.setAttribute(Ef.a.zfh,String.format("{0}",k.min));this.bG.Tq.setAttribute(Ef.a.tsd,String.format("{0}",k.max));this.ved=!1}Nqh(b){var k;if(({zOm:k}=
this.Pmm(b)).returnValue)this.d_i(k);else{({number:b,t4a:k}=A.a.WEi(b,this.r6g,n.AFrameworkApplication.numberFormat));let r=this.Ece(k);0===k&&xf.c(r)&&(r=this.Ece(this.Od[rc.a.UnitType]));this.JYe(b,r)}}JYe(b,k){b=this.CEf(b,k);if(isNaN(b)||xf.c(k))this.Lcc();else{const r=n.AFrameworkApplication.numberFormat;let y;y=A.a.hBa(b,k.type,r);y=y.replace(6===k.type?r.BWd:r.LLf,"");this.YKn(b,k,y)}}Pmm(b){let k,r=!1;k="";b=b.trim();const y=this.spinner.Mlj;if(!xf.c(y))for(let R=0;R<y.length;R++)if(y[R].toLowerCase()===
b.toLowerCase()){k=y[R];r=!0;break}return{returnValue:r,zOm:k}}CEf(b,k){return isNaN(b)||xf.c(k)?Number.NaN:k.CEf(b)}Ece(b){let k=null;const r=this.spinner.K$f;for(let y=0;y<r.length;y++)if(r[y].type===b){k=r[y];break}return k}jho(b){const k=b.length,r=Array(k);for(let y=0;y<k;y++)r[y]=b[y].type;return r}GS(){if(this.control.enabled){const b=this.Od[rc.a.Text],k=this.bG.Tq.value;k!==b&&(this.Nqh(k),this.Od[rc.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Od,this.mk,0,!1))}else this.Lcc()}xl(){var b=
this.Od[rc.a.Text],k=this.Od[rc.a.Number];const r=this.Od[rc.a.UnitType],y=this.Od[rc.a.MaxValue];if(0<(this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)){const R=this.Od[rc.a.Text],aa=this.Od[rc.a.Number],ta=this.Od[rc.a.UnitType],Ya=this.Od[rc.a.MaxValue];Ya!==y&&(this.Ece(ta).max=Ya,this.bG.Tq.setAttribute(Ef.a.tsd,String.format("{0}",Ya)));R!==b?""===R?this.d_i(R):this.Nqh(R):isNaN(aa)||aa===k&&ta===r||this.JYe(aa,this.Ece(ta));b=this.bG.Bm.title;k=mg.a.bpa(this.Od[rc.a.Alt],
this.properties.Alt);k!==b&&(this.bG.Tq.title=k,this.bG.X0b.title=k,this.bG.$Ec.title=k)}}RNe(b){super.RNe(b);b?(this.V9d(),this.pzh()):this.X9i()}}Object(m.a)(Rc,"SpinnerBehavior",Vi,[535,533]);var pd=c(323),Sd=c(870);class ce extends $d{constructor(b){super(b);this.XSb=!0;this.bob=!1}get P3(){return this.control}get Is(){return this.P3.properties}$H(b){const k=b.Bm,r=b.ycb;b=b.bFc;ee.a.instance.mb(Kb.a.focus,k,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,k,Object(u.a)(this,
this.onBlur,"onBlur"));bc.KeyInputManager.instance.mb(Kb.a.ni,k,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.oh,k,Object(u.a)(this,this.gx,"onKeyUp"));X.a.Ys&&16>this.jsl()&&(fj.a.instance.mb(Kb.a.pointerDown,k,Object(u.a)(this,this.LBi,"onSplitbuttonPointerDownPointerUp")),fj.a.instance.mb(Kb.a.hM,k,Object(u.a)(this,this.LBi,"onSplitbuttonPointerDownPointerUp")));fj.a.instance.mb(Kb.a.pointerOver,r,Object(u.a)(this,this.YRm,"onButtonPointerOver"));fj.a.instance.mb(Kb.a.pointerOut,
r,Object(u.a)(this,this.XRm,"onButtonPointerOut"));fj.a.instance.mb(Kb.a.pointerDown,r,Object(u.a)(this,this.Bxi,"onButtonPointerDown"));fj.a.instance.mb(Kb.a.hM,r,Object(u.a)(this,this.Cxi,"onButtonPointerUp"));wl.a.instance.mb(Kb.a.BO,r,Object(u.a)(this,this.$Rm,"onButtonTouchMove"));wl.a.instance.mb(Kb.a.kJ,r,Object(u.a)(this,this.ZRm,"onButtonTouchEnd"));fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.UHf,"onMenuButtonPointerDown"));fj.a.instance.mb(Kb.a.pointerOver,b,Object(u.a)(this,
this.EWm,"onMenuButtonPointerOver"));fj.a.instance.mb(Kb.a.pointerOut,b,Object(u.a)(this,this.DWm,"onMenuButtonPointerOut"))}uw(b,k,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.bob&&(this.P3.on=!this.P3.on,b=this.Od,b.CommandValueId=this.control.pAb(),this.root.executeCommand(this.Is.Command,b,this.mk,k,!0,null,this.Zea(r))):this.XSb&&super.uw(b,k,r)}gx(b){const k=b.Ib.keyCode;return k===Sys.UI.Key.enter||k===Sys.UI.Key.space?(b=this.Od,b.CommandValueId=this.control.pAb(),this.root.executeCommand(this.Is.Command,
b,this.mk,1,!0),!0):super.gx(b)}xl(){const b=this.root.Jna(this.Is.Command,this.Is.QueryCommand,this.Od),k=0<(b&1);let r=!0;r=xf.c(this.Is.CommandMenuOpen)?k:0<(this.root.Jna(this.Is.CommandMenuOpen,null,null)&1);if(r!==this.XSb||k!==this.bob||(r||k)!==this.control.enabled)this.control.enabled=r||k,k!==this.bob&&this.gUm(k),r!==this.XSb&&this.hUm(r),this.XSb=r,this.bob=k;if(0<(b&2)){this.Hha();const y=mg.a.bpa(this.Od[Sd.a.LabelText],this.Is.LabelText);this.Od[Sd.a.ApplyLabelTextToControlOnly]?this.P3.$1b(R=>
{R.Bm.title=y;R.ycb.removeAttribute("title");R.bFc.removeAttribute("title")}):this.P3.$1b(R=>{R.ycb.title=y});this.Od[Sd.a.EnsureControlRoleIsButton]&&this.P3.$1b(R=>{Ef.a.Jq(R.Bm,Ef.a.Bh,Ef.a.J1)});xf.c(this.Od[Sd.a.Visible])||this.H4a()&&this.UQa()}this.P3.setState(this.P3.on&&k)}UQa(){this.n9f();this.OMb();this.Hha()}hUm(b){this.P3.$1b(k=>{mg.a.Akb(k.bFc,b)});this.KXc();this.XSb=b}gUm(b){this.P3.$1b(k=>{mg.a.Akb(k.ycb,b)});this.KXc();this.bob=b}KXc(){const b=this.P3.Tdb();xf.c(b)||(mg.a.Mu(b.childNodes[0],
"cui-ctl-split-hovered-primary"),mg.a.Mu(b.childNodes[0],"cui-ctl-split-hovered-secondary"),mg.a.Mu(b.childNodes[1],"cui-ctl-split-hovered-primary"),mg.a.Mu(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}LBi(b){if(0!==pd.a(b.Ib))return!1;let k=!1;b.eventName===Kb.a.pointerDown?k=this.Bxi(b):b.eventName===Kb.a.hM&&(k=this.Cxi(b));return k}Bxi(b){let k=!1;const r=b.ig;switch(r){case 3:this.tYn()?this.uw(this.mk.Lc,r,b.Ib):this.lqd(this.P3.UBh);k=!0;break;case 2:b.Iaa===Sys.UI.MouseButton.leftButton&&
(this.lqd(this.P3.UBh),k=!0)}k&&b.Ib.preventDefault();return!1}tYn(){const b=this.mk.ZS;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}Cxi(b){return this.Csa(b)}$Rm(b){return this.PWd(b)}ZRm(b){return this.Csa(b)}onFocus(b){super.onFocus(b);this.Ylf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.KXc();return!1}YRm(){this.control.enabled&&this.bob&&this.Ylf(!0,this.P3.on);return!1}XRm(){this.control.enabled&&this.bob&&this.KXc();return!1}UHf(b){let k=!1;if(2!==b.ig||b.Iaa===Sys.UI.MouseButton.leftButton)this.uw(b.Af,
b.ig,b.Ib),k=!0;k&&b.Ib.preventDefault();return!1}EWm(){this.control.enabled&&this.XSb&&this.Ylf(this.P3.on,!0);return!1}DWm(){this.KXc();return!1}Ylf(b,k){const r=this.control.Tdb();xf.c(r)||(mg.a.Qf(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),mg.a.Qf(r.childNodes[1],k?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}jsl(){var b=X.a.M0b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(ce,"SplitButtonBehavior",$d,[]);
var gf=c(1348);class se extends Vi{constructor(b){super(b);this.Gqb=this.rya=!1;this.nEj=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Sba(){return this.textBox.Sba}get g5f(){return this.textBox.Fh}$H(b){b=b.Tq;ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));bc.KeyInputManager.instance.mb(Kb.a.ni,b,Object(u.a)(this,this.onKeyDown,
"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.Kt,b,Object(u.a)(this,this.RF,"onKeyPress"));bc.KeyInputManager.instance.mb(Kb.a.oh,b,Object(u.a)(this,this.gx,"onKeyUp"));ee.a.instance.mb(Kb.a.change,b,Object(u.a)(this,this.Naa,"onChange"));pf.a.instance.mb(Kb.a.Kaa,b,Object(u.a)(this,this.tOa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.Gqb=!0;mg.a.Qf(this.Sba.Bm,"cui-tb-focus");this.control.enabled&&Qe.a.BZc(this.Sba.Tq);return this.rya=!1}onBlur(b){this.Gqb=!1;super.onBlur(b);mg.a.Mu(this.Sba.Bm,
"cui-tb-focus");return!1}onKeyDown(b){let k=super.onKeyDown(b);if(!xf.c(b.Ib)&&!xf.c(b.Ib.rawEvent)){const r=b.Ib.keyCode,y=b.Ib.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.GS(),Object(Jb.a)(ng.Ribbon,this.root)&&(k=this.root.Oee(this.mk.Lc,!y))):r===Sys.UI.Key.enter?this.nEj&&(this.GS(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0):r===Sys.UI.Key.esc?(this.Lcc(),Object(Jb.a)(ng.Ribbon,this.root)&&this.root.sZ(),k=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?k=!this.control.enabled:b.pka&&
(Af.a.ulh(b.Ib),k=!1)}return k}RF(){return!this.control.enabled}gx(){return!1}Naa(){this.GS();return!1}tOa(){return this.Sba.isEditable?this.rya?!1:this.rya=!0:(Qe.a.BZc(this.Sba.Tq),!0)}jec(b){this.Sba.Tq.value!==b&&(this.Sba.Tq.value=b)}Lcc(){this.jec(this.Od[gf.a.Text])}GS(){if(this.control.enabled&&this.Sba.isEditable){const b=this.Sba.Tq.value;b!==this.Od[gf.a.Text]&&(this.Od[gf.a.Text]=b,this.root.executeCommand(this.g5f.Command,this.Od,this.mk,0,!1))}else this.Lcc()}xl(){const b=this.Od[gf.a.Text];
if(0<(this.Nt(this.g5f.Command,this.g5f.QueryCommand,this.Od)&2)&&!this.Gqb){const k=this.Od[gf.a.Text];k!==b&&this.jec(k)}}}Object(m.a)(se,"TextBoxBehavior",Vi,[532,533]);var Gf=c(422);class xh extends Vi{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Fh}uw(b,k,r){this.control.enabled&&(mg.a.rfa(this.properties.TogglesWhenExecuted)||this.toggle(),this.Od.CommandValueId=this.toggleButton.pAb(),this.Od.MenuItemId=this.toggleButton.Fh.MenuItemId,
this.Od.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Od,this.mk,k,!mg.a.rfa(this.properties.CloseMenuWhenExecuted),y=>{mg.a.vr(this.properties.UpdateHtmlPostToggle)&&(32===y?this.Scj():this.Qcj())},this.Zea(r)))}Qcj(){this.Od[Ig.a.On]=!this.Od[Ig.a.On]}Scj(){this.toggleButton.setState(this.Od[Ig.a.On]);(this.toggleButton.Mwa&&this.toggleButton.Kde||mg.a.vr(this.properties.UpdateHtmlPostToggle))&&this.UQa()}toggle(){this.Qcj();mg.a.vr(this.properties.UpdateHtmlPostToggle)||
this.Scj()}onKeyDown(b){const k=super.onKeyDown(b);if(!k&&!xf.c(b.Ib)&&this.lH){const r=b.Ib.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Ib.preventDefault()}return k}xl(){xf.c(this.properties.MenuItemId)||(this.Od.MenuItemId=this.properties.MenuItemId);0<(this.Nt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.H4a()&&this.UQa()}UQa(){this.toggleButton.setState(this.Od[Ig.a.On]);this.Kko(mg.a.bpa(this.Od[Ig.a.DisplayMode],""));this.n9f();this.Hha();this.rmo();Ig.a.Alt in
this.Od&&this.OMb()}rmo(){const b=this.eE.K8b;if(b&&b.zcb){var k=mg.a.bpa(this.Od[Ig.a.Description],this.properties.Description);k!==b.zcb.innerText&&(b.zcb.innerText=k,b.JN&&!Object(Jb.a)(Gf.Jewel,this.root)&&(k=!xf.b(k),mg.a.X3(b.JN,"UIFontBold",k),mg.a.X3(b.JN,"cui-ctl-mediumlabel-nodescription",!k)))}}$H(b){b=b.Bm;ee.a.instance.mb(Kb.a.focus,b,Object(u.a)(this,this.onFocus,"onFocus"));ee.a.instance.mb(Kb.a.blur,b,Object(u.a)(this,this.onBlur,"onBlur"));fj.a.instance.mb(Kb.a.pointerOver,b,Object(u.a)(this,
this.tX,"onPointerOver"));fj.a.instance.mb(Kb.a.pointerOut,b,Object(u.a)(this,this.kO,"onPointerOut"));bc.KeyInputManager.instance.mb(Kb.a.ni,b,Object(u.a)(this,this.onKeyDown,"onKeyDown"));bc.KeyInputManager.instance.mb(Kb.a.oh,b,Object(u.a)(this,this.gx,"onKeyUp"));fj.a.instance.mb(Kb.a.pointerDown,b,Object(u.a)(this,this.$B,"onPointerDown"));fj.a.instance.mb(Kb.a.hM,b,Object(u.a)(this,this.gva,"onPointerUp"));Sf.a.instance.mb(Kb.a.click,b,Object(u.a)(this,this.onClick,"onClick"));wl.a.instance.mb(Kb.a.BO,
b,Object(u.a)(this,this.Lib,"onTouchMove"));wl.a.instance.mb(Kb.a.kJ,b,Object(u.a)(this,this.zDa,"onTouchEnd"))}}Object(m.a)(xh,"ToggleButtonBehavior",Vi,[]);class Zh{constructor(b){this.TAj=b;this.Dpe={["Button"]:k=>new Wi(k),["FileMenuButton"]:k=>new Wi(k),["ColorPicker"]:k=>new Zm(k),["ComboBox"]:k=>new Sg(k),["ContextMenuControl"]:k=>new qj(k),["ContextMenuLauncher"]:k=>new qj(k),["DialogMenuLauncher"]:k=>new wi(k),["DropDown"]:k=>new jg(k),["FlyoutAnchor"]:k=>new Zi(k),["GalleryButton"]:k=>new Zl(k),
["StatefulColorFlyoutAnchor"]:k=>new Zi(k),["JewelMenuLauncher"]:k=>new vd(k),["Label"]:k=>new tf(k),["Placeholder"]:k=>new Vi(k),["SearchBox"]:k=>new Ua(k),["Separator"]:k=>new Vi(k),["SplitButton"]:k=>new ce(k),["StatefulColorSplitButton"]:k=>new ce(k),["StatefulImageSplitButton"]:k=>new ce(k),["TextBox"]:k=>new se(k),["ToggleButton"]:k=>new xh(k)}}HEh(){this.Dpe[km.Control.F$h]=b=>new Wc(b)}Y6e(){this.Dpe[km.Control.r8i]=b=>new Rc(b)}Kkl(b){const k=this.Dpe[b.controlType];(b=k?k(b):null)&&this.TAj&&
b.a3k();return b}static get instance(){return Zh._instance||(Zh._instance=new Zh(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Zh._instance=null;Object(m.a)(Zh,"ControlBehaviorFactory",null,[496]);var Rk=c(954),$g=c(168);class ol extends Nm.MenuLauncher{constructor(b,k,r,y){super(b,k,r,y);this.OPg=null;this.yJa=this.Qxc=0;this.vE=null;this.Zqc=this.Yqc=0;this.jh("Menu");this.enabled=!0}get x(){return this.Qxc}get y(){return this.yJa}get xwf(){return this.Yqc}get ywf(){return this.Zqc}get controlType(){return"DialogMenuLauncher"}$2a(){}x4a(){}Hcf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Is.DialogMoveCommand;b.DialogCloseCommand=this.Is.DialogCloseCommand;return b}ism(b,k){this.Qxc=b.x;this.yJa=b.y;this.Yqc=b.height;this.Zqc=b.width;this.UZ(k)}IP(b){this.OPg=mg.a.createElement("span");return new $g.a(b,this.OPg)}get Is(){return this.Fh}lsa(b,k,r){return new ol(b,this.id,k,r)}}Object(m.a)(ol,"DialogMenuLauncher",Nm.MenuLauncher,[]);var $l=c(807);class sk extends Rk.a{constructor(b,k){super(b,k);this.z5a=null}get UNe(){return this.z5a}get LAh(){return this.properties}get D7(){return 20}im(){super.im();
xf.c(this.Lc)&&this.JB();this.Lc=mg.a.jPa(this.Lc);this.ZV(this.Lc);this.dirty=!1}LN(b){if(!Object(Jb.a)($l.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}e0e(b,k,r,y){r=new Xi.Menu(this,k,r,y,null);b||(b={});b.CommandMenuOpen=this.LAh.CommandMenuOpen;b.CommandMenuClose=this.LAh.CommandMenuClose;b=new ol(this,k,b,r);this.$xb[k]=b;k=new $l.a(this,"dock"+k);k.Rf(b.JP("Menu"));this.Rf(k);this.refresh()}S0f(b,k,r,y){const R=this.$xb[b];if(xf.c(R))throw Error.create('The dialog menu "'+
b+'" does not exist');R.ism(new Sys.UI.Bounds(k,r,0,0),y);this.z5a=R.menu}UXe(b){b=this.$xb[b];xf.c(b)||(b.fsa(),this.z5a=null)}cYd(){this.z5a=null}dispose(){const b=this.$xb;for(let k in b)b[k].dispose();super.dispose()}}Object(m.a)(sk,"DialogMenuRoot",Rk.a,[]);class dp{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(dp,"RootProperties",null,[]);class bq extends dp{constructor(){super()}}Object(m.a)(bq,"StandaloneRootProperties",dp,[]);class Fi extends bq{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(Fi,"DialogMenuRootProperties",bq,[]);class Yk{constructor(){const b=new Fi;b.ImageSideArrow=n.AFrameworkApplication.pr;b.ImageSideArrowClass=ci.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=n.AFrameworkApplication.isRtl?"rtl":"ltr";this.zd=new sk("DialogMenuRootId",b);this.zd.vE=this;this.zd.refresh();n.AFrameworkApplication.ya.gb(ib.a.vMf,zc.a.frame,Object(u.a)(this,this.vMf,"populateDialogMenu"),96)}get V_(){return this.zd}gLa(b,k,r,y,R=null){b=parseInt(b);y=n.AFrameworkApplication.ya;
r&&(y.PG=r.CommandLocation,y.F6=r.InvocationMethod);k=y.Xb(b,2,k,R);this.zd.refresh();return 32===k}LCa(b){return b?32===n.AFrameworkApplication.ya.processAction(parseInt(b),1):!0}Nt(){this.V_.root.xl()}e0e(b,k,r){const y={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};y.DialogMoveCommand=k;y.DialogCloseCommand=r;this.V_.e0e(y,b,"","")}S0f(b,k,r,y){this.V_.S0f(b,k,r,y)}UXe(b){this.V_.UXe(b)}vMf(b,k,r,y,R){if(1===r)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',R.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',R.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");R.PopulationXML=b.toString();return 32}dispose(){this.zd&&
(this.zd.dispose(),this.zd=null)}}Object(m.a)(Yk,"DialogMenuRootUser",null,[232,10,442]);class Jm{constructor(b,k,r){this.Kob=this.Jmd=this.gsc=this.Rl=null;this.ite=this.Xld=!1;this.doc=b;this.le=k;this.Ir=r;this.YRb=n.AFrameworkApplication.isRtl}get hnf(){return this.ite}B5k(b){b?(this.Rl=b,this.ite=!0,this.Xld=!1,this.le.capture(Object(u.a)(this,this.Sqm,"keyEventHandler"),null),this.Ir.mb(Kb.a.pointerDown,this.doc,Object(u.a)(this,this.gbc,"pointerDownHandler")),this.gsc||this.aNk(),this.Rl.appendChild(this.gsc),
this.J4l()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}B8e(){this.ite=!1;this.Jmd=this.Kob=null;this.Csn();this.jSf();this.Rl=null}jSf(){this.le.releaseCapture();this.Ir.sc(Kb.a.pointerDown,this.doc,Object(u.a)(this,this.gbc,"pointerDownHandler"))}J4l(){if(this.Rl.style.left.endsWith("px")&&this.Rl.style.right.endsWith("px"))this.Kob=new Sys.UI.Point(Sl.a.wX(this.YRb?this.Rl.style.right:this.Rl.style.left),Sl.a.wX(this.Rl.style.top));else{const b=this.YRb?this.doc.offsetWidth-
(this.Rl.offsetLeft+this.Rl.offsetWidth+Sl.a.wX(this.Rl.style.marginRight)):this.Rl.offsetLeft-Sl.a.wX(this.Rl.style.marginLeft),k=this.Rl.offsetTop-Sl.a.wX(this.Rl.style.marginTop);this.N1i(b,k);this.Kob=new Sys.UI.Point(b,k)}this.Jmd=this.Kob}aNk(){this.gsc=ci.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}Csn(){this.gsc.parentNode===this.Rl&&this.Rl.removeChild(this.gsc)}Sqm(b){if(!this.hnf)return!1;b.Ib.preventDefault();if(b.eventName===Kb.a.ni){const k=b.Ib.ctrlKey?
1:10;let r;switch(b.Ib.keyCode){case tb.a.n8:this.c$b(0,-1*k);break;case tb.a.Kha:this.c$b(0,1*k);break;case tb.a.ZMb:r=this.YRb?1:-1;this.c$b(r*k,0);break;case tb.a.$Mb:r=this.YRb?-1:1;this.c$b(r*k,0);break;case tb.a.M4a:this.sti(this.Jmd.x,this.Jmd.y);this.Xld=!0;break;case tb.a.hs:this.Xld=!0}}b.eventName===Kb.a.oh&&this.Xld&&this.B8e();return!0}gbc(b){if(!this.hnf)return!1;b.Ib.preventDefault();this.B8e();return!0}c$b(b,k){this.sti(this.Kob.x+b,this.Kob.y+k)}sti(b,k){b=this.Eak(b,k);this.N1i(b.x,
b.y);this.Kob=b}N1i(b,k){this.YRb?this.Rl.style.right=b+"px":this.Rl.style.left=b+"px";this.Rl.style.top=k+"px"}Eak(b,k){const r=this.YRb?Sl.a.wX(this.Rl.style.marginRight):Sl.a.wX(this.Rl.style.marginLeft),y=Sl.a.wX(this.Rl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.doc.offsetWidth-this.Rl.offsetWidth-r),Math.min(Math.max(-y,k),this.doc.offsetHeight-this.Rl.offsetHeight-y))}}Object(m.a)(Jm,"KeyMoveAdapter",null,[443]);var pl=c(1099),cq=c(567);class Sr{get name(){return"CUI.Behavior"}zc(b){n.AFrameworkApplication.K&&
n.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(442,"Common.UI.IDialogMenuRootUser").singleInstance().Zd(()=>new Yk),b.register(443,"Common.IKeyMoveAdapter").singleInstance().Zd(()=>new Jm(n.AFrameworkApplication.ta.yla(),bc.KeyInputManager.instance,fj.a.instance)));b.register(cq.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Zd(()=>cq.a.instance)}init(){pl.a.c_e=Zh.instance;const b=cq.a.instance.YUi;for(let k=0;k<b.length;++k){const r=Object(ia.a)(444,
b[k]);r&&r.$Ka()}kj.a.get_instance().EK(6)}dispose(){}static main(){M.a.instance.Pc(new Sr,5)}}Object(m.a)(Sr,"CuiBehaviorPackage",null,[1,2]);class dl{constructor(b){const k=new bq;k.ImageUpArrow=k.ImageDownArrow=k.ImageSideArrow=k.ImageCheckMark=k.ImageUncheckMark=k.ImageDownArrow8by8=k.ImageUpArrow8by8=b;k.ImageUpArrowClass=ci.getImageClass("RibbonUpArrow_5x3x32");k.ImageDownArrowClass=ci.getImageClass("SplitButtonArrow_5x3x32");k.ImageUpArrow8by8Class=ci.getImageClass("RibbonUpArrow_8x8x32");
k.ImageDownArrow8by8Class=ci.getImageClass("SplitButtonArrow_8x8x32");k.ImageSideArrowClass=ci.getImageClass("SubmenuFlyoutArrow_13x13x32");k.ImageCheckMarkClass=ci.getImageClass("CheckboxChecked_16x16x32");k.ImageUncheckMarkClass=ci.getImageClass("CheckboxUnchecked_16x16x32");k.TextDirection=n.AFrameworkApplication.isRtl?"rtl":"ltr";this.iw=Rk.a.pPk(k);this.iw.refresh()}get M3(){return this.iw}dispose(){this.iw.dispose()}}Object(m.a)(dl,"StandaloneRootController",null,[937,10]);var Om=c(1127),Rf=
c(236);class xq{constructor(b){this.Duc=b}create(b,k){const r=new Sys.StringBuilder;this.eDc(r,b,k);this.B0e(r,b);return r.toString()}Qxb(b,k){const r=[];this.n1e(r,b,k);this.C0e(r,b);return r}eDc(b,k,r){switch(k.errorType){case 0:b.append(this.Duc.build());break;case 1:case 2:b.append(this.PUe(k,r))}}n1e(b,k,r){switch(k.errorType){case 0:b.push(this.Duc.Wih());break;case 1:case 2:b.push(this.Mmk(k,r))}}B0e(b,k){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Rf.a("btnIgrnoreSpellingError",
(2===k.errorType?Wa.a.yFa:Wa.a.Lta).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}C0e(b,k){const r=Object.assign(new oi.a,{ControlList:[]});k=2===k.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new Wg.a,{ExternalId:k}));b.push(r)}PUe(b,k){b=this.Ahl(b.suggestions,k);return 0<b.length?Rf.h("msUnknownWord",Rf.d(null,b),"Menu16"):Rf.h("msUnknownWord",Rf.d(null,[Rf.a("btnNoSuggestions",Wa.a.yFa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)]),"Menu16")}Ahl(b,k){const r=[];if(b){const y=Math.min(k.length,b.length);for(let R=0;R<y;++R)b[R]&&r.push(Rf.a("btnCorrectWord"+R,k[R].toString(),b[R]))}return r}Mmk(b,k){const r=Object.assign(new oi.a,{Id:"Suggestions",ControlList:[]});this.zhl(b.suggestions,k,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new Wg.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}zhl(b,k,r){if(b){const y=Math.min(k.length,b.length);for(let R=0;R<y;++R){if(!b[R])continue;const aa=Object.assign(new Wg.a,
{ExternalId:"btnCorrectWord"+R,Command:k[R].toString(),LabelText:b[R]});r.push(aa)}}}}Object(m.a)(xq,"DefaultProofingContextMenuCreator",null,[]);var pi=c(704);class el{constructor(b,k){this.WBg=b;this.UDg=k;this.vja=[Wa.a.Olb,Wa.a.Plb,Wa.a.Qlb,Wa.a.QLb,Wa.a.RLb]}create(b,k){return k?Object(Jb.a)(pi.a,k)?this.UDg.create(b,k,this.vja):this.WBg.create(k,this.vja):""}A_b(b,k){return k?Object(Jb.a)(pi.a,k)?this.UDg.Qxb(b,k,this.vja):this.WBg.Qxb(k,this.vja):null}}Object(m.a)(el,"ProofingContextMenuSectionFactory",
null,[467]);class ep{build(){const b=[Rf.a("btnDeleteRepeatedWord",Wa.a.FAa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Rf.h("msRepeatedWord",Rf.d(null,b),"Menu16")}Wih(){const b=Object.assign(new oi.a,{ControlList:[]}),k=Object.assign(new Wg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(k);return b}}Object(m.a)(ep,"ProofingRepeatedWordSectionBuilder",null,[466]);var Mh=c(614);class yr{static get vg(){return yf.a.Rx(yr.tl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,
Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}yr.tl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(yr,"AutoCorrectOptionsDialogHTML",null,[]);class On{static get vg(){return yf.a.Rx(On.tl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}On.tl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(On,"AutoCorrectOptionsDialogHTML2",null,[]);class Wn extends yf.a{constructor(b,k){super();this.PJn=(r,y)=>{gh.a.instance.J(9)&&(1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):y.ReplaceTextAsYouType!==this.QU.nPa||y.CapitalizeFirstLetterOfSentences!==this.QU.Xtd||y.ReplaceOrdianalsWithSuperscript!==this.QU.v4d||y.ReplaceHyphensWithDash!==this.QU.pYc||y.ReplaceFractionsWithFractionCharacter!==this.QU.u4d||this.ada&&y.ReplaceQuoteWithSmartQuote!==
this.QU.cUf?(r={},r.ReplaceTextAsYouType=y.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=y.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=y.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=y.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=y.ReplaceFractionsWithFractionCharacter,this.ada&&(r.ReplaceQuoteWithSmartQuote=y.ReplaceQuoteWithSmartQuote),this.QU.TDn(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:y.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:y.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:y.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:y.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:y.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.ada,["ReplaceQuoteWithSmartQuote"]:this.ada&&y.ReplaceQuoteWithSmartQuote}),Ka.App.xa.updateCommandUI(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes."))};this.QU=b;this.ada=k;this.lg="AutoCorrectOptionsDialog"}j1f(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.vg=this.ada?On.vg:yr.vg;const b={};b.ReplaceTextAsYouType=this.QU.nPa;b.CapitalizeFirstLetterOfSentences=this.QU.Xtd;b.ReplaceOrdianalsWithSuperscript=this.QU.v4d;b.ReplaceHyphensWithDash=this.QU.pYc;b.ReplaceFractionsWithFractionCharacter=this.QU.u4d;this.ada&&(b.ReplaceQuoteWithSmartQuote=
this.QU.cUf);this.Vh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.PJn,b)}}Object(m.a)(Wn,"AutoCorrectOptionsDialog",yf.a,[464]);class rg{static get vg(){return yf.a.Rx(rg.tl,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}rg.tl="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(rg,"AltTextDialogWithDescriptionHtml",null,[]);class Pn extends yf.a{constructor(b=!1){super(!1,!1,b);this.vg=rg.vg;this.lg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}J_e(b){this.Vh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(u.a)(this,this.Rbk,"altTextDialogHandler"),this.Ndf(b));b=document.getElementById(Pn.PQe);b.focus();b.select()}Ndf(b){const k={};k[Pn.PQe]=this.Gbf(b);k[Pn.OQe]=this.krl(b)||"";return k}f2(b){return b.Af.id===Pn.OQe?!1:super.f2(b)}}Pn.PQe="titleText";
Pn.OQe="descriptionText";Object(m.a)(Pn,"BaseAltTextDialogWithDescription",yf.a,[]);var Si=c(38);class fp extends Pn{constructor(b,k,r,y,R){super();this.p$a=this.D8c=null;this.Pw=k;this.Zj=r;this.Hc=y;this.Jd=R;this.J_e(b)}krl(b){this.D8c=b.node;this.p$a=Si.TableReader.G0h(b);return Si.TableReader.Iif(this.p$a)}Gbf(b){this.D8c=b.node;this.p$a=Si.TableReader.G0h(b);return Si.TableReader.Jif(this.p$a)}Rbk(b,k){if(1===b){b=Si.TableReader.Jif(this.p$a);const r=Si.TableReader.Iif(this.p$a),y=k[Pn.PQe];
k=k[Pn.OQe];this.hide();const R=this.Hc.Rc(15);try{R.Eb(this.D8c),this.Pw.NZf(this.p$a,y),this.Pw.S1i(this.p$a,k)}finally{R&&R.dispose()}y===b&&k===r||this.Jd.ys(16)}gh.a.instance.J(4)&&this.Zj.Pp&&this.Zj.Mq.KG(this.D8c)}}Object(m.a)(fp,"TableAltTextDialog",Pn,[]);class So{constructor(b,k,r){this.Pw=b;this.Hc=k;this.Jd=r}create(b){return new fp(b,this.Pw,Ka.App.vd,this.Hc,this.Jd)}}Object(m.a)(So,"TableAltTextDialogFactory",null,[]);const Uq=()=>{Ka.App.kch=!0;return 32},tp=(b,k,r,y,R)=>{if(1===
r)return 32;if(!({point:b,$w:k}=Dm(R)).returnValue)return 16;Ka.App.xa.Wec(b,k);return 32},yq=(b,k,r,y,R)=>{if(1===r)return 32;if(!({point:b,$w:k}=Dm(R)).returnValue)return 16;Ka.App.xa.Cba(b,k);return 32},Dm=b=>{let k=null,r=0;if(!b)return{returnValue:!1,point:k,$w:r};b=b.split(",");if(3>b.length)return{returnValue:!1,point:k,$w:r};k=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));r=parseInt(b[2]);return{returnValue:!0,point:k,$w:r}};var hk=c(1738);class qo extends Sys.EventArgs{constructor(b,k,
r,y,R,aa=0,ta=0,Ya=null){super();this.controlId=b;this.commandId=y;this.time=R;this.commandSurface=aa;this.$w=ta;this.contentType=Ya}}Object(m.a)(qo,"CommandClickEventArgs",Sys.EventArgs,[]);class xm{constructor(b,k){this.iqa=b.wdf();this.Flc=b;this.u5a=k}gLa(b,k,r,y=null,R=null){r&&(this.u5a.PG=r.CommandLocation,this.u5a.F6=r.InvocationMethod,this.u5a.ibb=r.CommandTabName);b=parseInt(b);let aa=this.Flc.GRh(b,k,r);aa.BDf&&(aa=this.Flc.GRh(aa.kL,k,r));if(void 0!==aa.IXa&&null!==aa.IXa)return aa.IXa;
if(aa.dCb)R=32;else{var ta=null;this.iqa&&this.iqa.QMf&&(ta=this.iqa.QMf(aa,R));aa.yfa||aa.WOc?aa.$Aa?R=16:(R=this.u5a.Xb(aa.kL,aa.C7b?2:1,aa.Ed,R),2===R&&(R=32)):aa.$Aa?R=this.u5a.Ona(null,aa.kL,aa.Ed,Ya=>{y&&y(Ya.response)},R):(R=this.u5a.Xb(aa.kL,2,aa.Ed,R),y&&y(R));this.iqa&&this.iqa.LMf&&this.iqa.LMf(aa,R,ta);if(k&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=k.LegacyId;if(void 0===r||null===r)r="";ta=k.ParentMenuId;void 0!==ta&&null!==ta||!k.MenuId||(ta=k.MenuId);let Ya=k.SqmControlId;
void 0!==Ya&&null!==Ya||!k.SourceControlId||(Ya=k.SourceControlId);(void 0!==Ya&&null!==Ya||void 0!==ta&&null!==ta)&&hk.a.ugn(new qo(Ya,r,ta,Kd.ActionManager.sda(b),Date.now()))}}aa.yfa&&32===R&&this.iqa&&this.iqa.Cza&&this.iqa.Cza(aa,k);aa.WOc&&32===R&&this.iqa&&this.iqa.SVa&&this.iqa.SVa(aa,k);return 32===R||1===R}LCa(b,k=null){if(n.AFrameworkApplication.Tk||Mg.a.instance.hv)return!1;null!=k&&null!=k.UILocation&&(this.u5a.PG=k.UILocation);const r=parseInt(b);if(!b||r===Kd.ActionManager.P6e)return!0;
b=this.Flc.xRh(r,k);b.BDf&&(b=this.Flc.xRh(b.kL,k));if(void 0!==b.IXa&&null!==b.IXa)return b.IXa;r===ib.a.iXb&&k&&(b.Ed=k);return 32===this.u5a.Xb(b.kL,1,b.Ed)}clearCache(){this.Flc.clearCache()}}Object(m.a)(xm,"GeneralCuiUser",null,[231,232]);var tn=c(190),mi=c(63),rj=c(47),Hn=c(1357);class zr{constructor(b,k,r,y){this.kDg="DocumentProofingFailed";this.hKe=b;this.V3g=k;this.m7c=r;this.PH=y}get iR(){return null!=this.Xtg?this.Xtg:this.Xtg=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}QJl(){let b=
this.PH.ZGl(this.hKe);return{returnValue:this.PH.OYa(this.hKe),adn:b}}qmo(b,k){const r=mi.a.Vw();if(r){var y=new tn.ScriptSharpLegacyMap;y.add(Te.a.pE,b);y.add(wc.a.noProof,k);b=new sf.GraphTransaction(15);b.Eb(r);this.iR.a$b(rj.StyleReader.wordStyleIdNormal,y,r)?Hn.a.hej():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Hn.a.recordQosError(this.kDg,[Hn.a.duc],"Style could not be modified"));b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Hn.a.recordQosError(this.kDg,
[Hn.a.duc],"PageContentNode not found")}tLn(b,k){this.qmo(b,k)}JQn(b,k){if(this.V3g){var r=new Di.DictionaryPropertySet;this.m7c.execute(y=>{y.uFc(b)});r.setValue(Te.a.pE,b);r.setValue(wc.a.noProof,k);k=new sf.GraphTransaction(15);k.set(Ka.App.ik.ml);this.V3g.K7(r);k.dispose()}}zf(){return rf.SelectionEditor.zf(this.hKe)}}Object(m.a)(zr,"LanguageEditor",null,[445]);var $m=c(619),xk=c(231),un=c(92);class Eo{constructor(b=!1,k=0){this.languages=Eo.H_h(yh.a.aql());this.nfd=new xk.a;this.XOa=[];this.mUb=
new $m.a;this.ILi=b;this.FYg=0>=k?7:k;this.EYg=this.AEe=0;this.iIg=!1;b&&(this.S5l(),n.AFrameworkApplication.FK(()=>{this.SCm()}))}S5l(){for(var b of this.languages)this.nfd.Z(b.LCID,b);b=[];try{const y=Ea.a.get("RecentlyUsedLcids");if(y&&""!==y){const R=decodeURIComponent(y).split(",").slice(0,this.FYg);for(const aa of R){let ta;({value:ta}=this.nfd.Bc(parseInt(aa),ta)).returnValue&&b.push(ta)}}}catch(y){v.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
y.message),Array.clear(b)}if(b.length)for(var k of b){var r=k.LCID;this.mUb.contains(r)||(this.XOa.push(k),this.mUb.add(r))}else k=n.AFrameworkApplication.lcid,({value:r}=this.nfd.Bc(k,r)).returnValue&&(this.XOa.push(r),this.mUb.add(k));this.bWi()}bWi(){const b=un.toArray(un.select(un.asEnumerable(this.XOa),k=>k.LCID)).join(",");Ea.a.$Pa("RecentlyUsedLcids",b,180)}Ayl(b){let k,r=-1,y=null;var R=Eo.H_h(this.XOa);this.ILi&&0<R.length&&(y=un.toArray(un.Si(un.asEnumerable(R),(Ya,xb)=>{b===Ya.LCID&&-1===
r&&(r=xb);return{["key"]:xb,["text"]:Ya.displayName,["value"]:Ya.LCID.toString()}})));let aa=0;y&&(aa=y.length);R=aa;const ta=un.toArray(un.Si(un.asEnumerable(this.languages),(Ya,xb)=>{b===Ya.LCID&&-1===r&&(r=aa+xb);return{["key"]:aa+xb,["text"]:Ya.displayName,["value"]:Ya.LCID.toString()}}));k=r;return 0<aa?{returnValue:y.concat.apply(y,ta),selectedIndex:k,J8i:R}:{returnValue:ta,selectedIndex:k,J8i:R}}GNn(b,k){if(this.ILi&&({value:r}=this.nfd.Bc(b,r)).returnValue){k=b!==k;if(this.mUb.contains(b))b=
Array.indexOf(this.XOa,r),0<=b&&(Array.removeAt(this.XOa,b),this.XOa.push(r)),k&&this.AEe++;else{this.mUb.add(b);this.XOa.push(r);if(this.XOa.length>this.FYg){var r=this.XOa.shift();this.mUb.remove(r.LCID)}k&&this.EYg++}this.bWi()}}SCm(){const b=this.AEe+this.EYg;!this.iIg&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.AEe/b),this.iIg=!0)}static H_h(b){b=Array.clone(b);b.sort((k,r)=>k.displayName.localeCompare(r.displayName));return b}}Object(m.a)(Eo,"LanguageListHelper",
null,[446]);var yj=c(197);class Jq extends yj.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(Jq,"NumberButtonProps",yj.a,[]);var tm=c(229);class yk{static get NX(){return null!=yk.Arg?yk.Arg:yk.Arg=Va.a.instance.Pa("Box4.ISpacingCommands")}static get Sg(){return tm.ContextSetEditor.instance}static get XT(){return null!=yk.Cog?yk.Cog:yk.Cog=Va.a.instance.Pa("Box4.ILineSpacingHelper")}static get L4i(){return!!yk.NX}static Vb(){const b=n.AFrameworkApplication.ya;
b.pa(Wa.a.mbc,lc.a.view,yk.mbc);b.Vc(Wa.a.mbc,1124);b.pa(Wa.a.mbc,lc.a.paragraph,yk.wmo)}static mbc(b,k,r,y,R){if(1===r||!yk.L4i)return yk.L4i?32:8;if(!yk.agi){var aa=[];aa.push(Object.assign(new Jq,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));aa.push(Object.assign(new Jq,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));aa.push(Object.assign(new Jq,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));aa.push(Object.assign(new Jq,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));aa.push(Object.assign(new Jq,
{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));aa.push(Object.assign(new Jq,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));R.MenuItems=Rf.f(aa);yk.agi=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");k=k.view.Cb;aa=null;k&&k.ib.kb&&(aa=k.ib.kb);k=yk.Sg.jMh(aa.Qa);n.AFrameworkApplication.ya.Vf(k,b,r,!0,y,R);return 32}static wmo(b,k){let r=b=!0;k=yk.XT.zBa(k.node);var y=k.beforeSpacing;let R=!1;1===y.unit&&(R=!0);if(R||0<y.value)b=!1;k=k.afterSpacing;y=!1;1===k.unit&&(y=!0);
if(y||0<k.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(yk.I6j,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(yk.ntn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(yk.H6j,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(yk.mtn,r));return 32}}yk.I6j="AddSpaceBeforeParagraph";yk.H6j="AddSpaceAfterParagraph";yk.ntn="RemoveSpaceBeforeParagraph";yk.mtn="RemoveSpaceAfterParagraph";yk.agi=!1;Object(m.a)(yk,
"LineSpacingRibbonMenu",null,[]);var Sk=c(164),Ar=c(1366),Vq=c(1343);const Wq=(b,k,r)=>{if(1===r)return 32;b=Ka.App.xa.notificationBar.usa("Automation test",!1);b.image=3;Ka.App.xa.notificationBar.qA(b);return 32},mn=(b,k,r,y,R)=>{let aa;if(!({glj:aa}=In(R)).returnValue)return 16;Sk.UISurfaces.hK().then(ta=>{let Ya=null;var xb=Object.assign(new Ar.a,{label:"OK",onExecute:()=>{Ya&&ta.removeNotification(Ya)}});xb=Object.assign(new Vq.a,{target:"#"+Rh.AppFrame.OVf,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:xb,useTeachingStyles:aa});xb=ta.callout(xb);Ya=ta.addNotification(xb);return null},ta=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},In=b=>{let k=!1;if(!b)return{returnValue:!1,glj:k};k=Boolean.parse(b);return{returnValue:!0,glj:k}};var Kq=c(1419);let Wm,an,Zk,Uj;class vn{constructor(){this.o5=new rb.a;this.pNg=!1}X$a(b){const k=this.o5.indexOf(b);let r=!0;if(-1!==k){r=!1;if(!k)return r;this.o5.removeAt(k)}this.o5.insert(0,
b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.o5.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.o5.J(10)),this.o5.removeAt(10));this.Vno();return r}K9f(b){let k="#";for(let y=0;y<this.o5.count;y++){var r="#"+this.o5.J(y).substring(4,6)+this.o5.J(y).substring(2,4)+this.o5.J(y).substring(0,2);r=Object.assign(new Kq.a,{Color:this.o5.J(y),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){k=
r.Color;break}}for(const y of vn.BYg)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(y,k))}Vno(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.o5.count;r++){var k="#"+this.o5.J(r).substring(4,6)+this.o5.J(r).substring(2,4)+this.o5.J(r).substring(0,2);k=Object.assign(new Kq.a,{Color:this.o5.J(r),Alt:k,DisplayColor:k});b.push(appChrome.api.colorPickerCell(k.Color,k.DisplayColor,k.Alt))}for(const r of vn.BYg)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,
b));this.pNg||this.Umo();this.pNg=!0}Umo(){for(const b of Object.keys(vn.SRg)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const k=vn.SRg[b],r=[];for(const y of k)r.push(appChrome.api.menuSection([y],y in vn.tze?vn.tze[y].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,vn.tze[b].toString()))}}}vn.SRg={["FontColor"]:(Uj=new rb.a,Uj.add("AutomaticFontColor"),Uj.add("ThemeFontColorPickerMCU"),Uj.add("ThemeFontColorPicker"),Uj.add("StandardFontColorPicker"),
Uj.add("RecentFontColorPicker"),Uj.add("MoreFontColors"),Uj),["CellShading"]:(Zk=new rb.a,Zk.add("ThemeShadingColorPickerMCU"),Zk.add("ThemeShadingColorPicker"),Zk.add("StandardShadingColorPicker"),Zk.add("RecentCellShadingColorPicker"),Zk.add("ClearShadingColor"),Zk.add("MoreCellShadingColors"),Zk),["PictureBorders"]:(an=new rb.a,an.add("ThemePictureBorderColorPickerMCU"),an.add("ThemePictureBorderColorPicker"),an.add("StandardPictureBorderColorPicker"),an.add("RecentPictureBorderColorPicker"),an.add("MorePictureBorderColors"),
an.add("NoPictureBorder"),an.add("PictureBorderWeightOptions"),an.add("PictureBorderStyleOptions"),an)};vn.tze={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};vn.BYg=(Wm=new rb.a,Wm.add("RecentFontColorPicker"),Wm.add("RecentCellShadingColorPicker"),Wm.add("RecentPictureBorderColorPicker"),Wm);Object(m.a)(vn,"RecentColorsSectionHandler",null,[]);var Xq=c(1365),Dp=c(1020);class zq{constructor(b){this.CRj=b}j7(){}i7(b){this.CRj.SOm(b)}}Object(m.a)(zq,"DataBuddyActionListener",
null,[32]);class Pp{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(Pp,"DataBuddyTaskPaneProps",null,[]);class up{constructor(b){this.isVisible=!1;this.aY=new rb.a;this.ghe=null;this.pP=b;this.oA=new Xq.a;this.Ub=Id.FocusManager.instance()}initialize(){this.ghe=new zq(this);this.pP.FKa();this.oA.AK(this.M5j());this.oA.AK(this.X2j())}toggle(){this.isVisible?this.hide():this.show()}SOm(b){if(2===b.behavior){const k=Kd.ActionManager.sda(b.actionId)||
b.actionId.toString();k.startsWith("Query")||(this.aY.add(k+": "+up.lil(b.response)),this.om())}}hide(){Sk.UISurfaces.fu().then(b=>{b.hideTaskPane(up.ny,2);return null})}show(){Sk.UISurfaces.fu().then(b=>{b.showTaskPane(up.ny,this.AB());return null});this.isVisible&&Sk.UISurfaces.fu().then(b=>{b.setSelectedTaskPane(up.ny);return null})}M5j(){return b=>{b.actions=this.aY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}X2j(){return b=>{b.onClearClick=()=>{this.aY.clear();
this.om()}}}Vb(){n.AFrameworkApplication.ya.x3(this.ghe)}u4a(){n.AFrameworkApplication.ya.zhc(this.ghe)}AB(){const b=new Pp;this.oA.mKb(b);return Object.assign(new Dp.a,{title:"Data Buddy",hideHeader:!1,width:up.width,location:2,contentProps:b,onOpen:()=>{this.I7();this.Vb();this.isVisible=!0;n.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.vba();this.u4a();this.isVisible=!1;this.om();n.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}om(){Sk.UISurfaces.fu().then(b=>{b.updateTaskPane(up.ny,
this.AB());return null})}I7(){this.Ub.Kg(up.ny)}vba(){this.Z_a()&&this.Ub.Kg(this.Ub.NS)}Z_a(){return!!this.Ub.pg&&this.Ub.pg.name===up.ny}static lil(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}up.ny="DataBuddyTaskPane";up.width=300;Object(m.a)(up,"Box4DataBuddyTaskPane",null,[441]);class Qp{constructor(b){this.Dh=
b}BFa(b){this.Dh&&this.Dh.nG(b)}E3c(){this.Dh&&this.Dh.V3c(void 0)}}Object(m.a)(Qp,"RibbonButtonUpdater",null,[439]);var Qn=c(390);class go{constructor(){this.uIe=this.W=null}get name(){return"Box4.UI"}zc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new xm(b.resolve("Box4.UI.CuiActionBridge"),n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new So(b.resolve("Box4.ITableEditor"),new Qn.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
b.ha("Box4.UI.ILanguageEditor",()=>new zr(bh.a.instance.Jg,b.Pa("Box4.ITextFormattingCommands"),b.$a("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new dl(n.AFrameworkApplication.pr)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new Wn(b.resolve("Box4.IAutoCorrectOptionsInfo"),n.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>
new Eo(n.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(ep,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new xq(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new el(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new Qp(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new vn).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new up(Om.a.instance)).singleInstance()}init(){var b=Ka.App.xa;const k=b.Rb;Nc.P3l(Object(u.a)(k,k.DGb,"onAuthenticationLost"),Object(u.a)(k,
k.EGb,"onAuthenticationRestored"),b.ftk);Mh.a.Vb();b=n.AFrameworkApplication.ya;b.pa(Wa.a.T$m,lc.a.application,Uq);b.gb(Wa.a.cZn,lc.a.application,tp,96);b.gb(Wa.a.JZn,lc.a.application,yq,96);b=n.AFrameworkApplication.ya;b.gb(Wa.a.o0n,lc.a.application,Wq,96);b.gb(Wa.a.VYn,lc.a.application,mn,96);yk.Vb();this.X5l();this.uIe=this.W.resolve("Common.IStandaloneRootController")}X5l(){this.W.$a("Box4.IGeneralCuiUser").execute(b=>{this.W.$a("Common.IStandaloneRootController").execute(k=>{k.M3.vE=b})})}dispose(){this.uIe.dispose();
this.uIe=null}static main(){M.a.instance.Pc(new go,6)}}Object(m.a)(go,"Box4UIPackage",null,[1,2]);var Br=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},dq=c(1753);class fn{get name(){return"Box4.Insights"}init(){}dispose(){}zc(b){b.ha("Box4.Insights.Box4InsightsSelection",
()=>new dq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(m.a)(fn,"Box4InsightsPackage",null,[1,2]);const gp=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Jn=c(440),il=c(347),hp=c(1723);class Ep{Whb(){return!1}reset(){}update(){}}Object(m.a)(Ep,"NullTaskYieldStrategy",null,[371]);var ik=c(1370);class ym{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(ym,"CatchUpConfiguration",null,[]);class Aq{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(Aq,"SharedControllerFactoryParameters",null,[]);var jl=c(159),Jc=c(18);class zm{constructor(b,k,r,y){this.J_m=(R,aa)=>{(this.idd=!this.idd)&&aa.rk&&aa.rk.contextId===lc.a.Wc&&this.inh(aa.rk.node,aa.rk.gl);return 32};this.ux=b;this.Ep=k;this.ga=r;this.Ub=y;this.Sed=this.Ted=null;this.idd=!1;this.ga.pa(Jc.a.zcj,lc.a.view,this.J_m);this.Ub.re(id.AFrame.Qp).bindAction(bc.KeyInputManager.lc(tb.a.fjc,
6),Jc.a.zcj)}j_(b,k){this.idd&&this.Ep&&k&&k.kl&&k.kl.kb&&k.kl.kb.Qa&&k.kl.kb.Qa.node&&k.kl.kb.Qa.contextId===lc.a.Wc&&this.inh(k.kl.kb.Qa.node,k.kl.kb.Qa.gl)}inh(b,k){b&&(this.pvi(b)?(this.Ted&&this.Ted.id.equals(b.id)||(this.Ep.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Ted=b),this.VFm(b,k)):this.Sed=this.Ted=null)}pvi(b){return 0<this.ux.bBb(b).count}VFm(b,k){if(b){var r=-1,y=null,R=null;for(let aa=0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);
if(!(null==R||ta.changeStart&&ta.changeStart.equals(y))&&k>=r&&k<=ta.cp&&!y.equals(this.Sed))if(this.ux.MDb(y)){(b=this.ux.iHc(y,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Ep.sendNotification(b,!1),this.Sed=y);break}else this.Sed=null;ta.changeStart&&!ta.changeStart.equals(y)&&(r=ta.cp,y=ta.changeStart);R=ta.changeStart}}}}Object(m.a)(zm,
"ActivityAnnouncementManager",null,[]);var ho=c(1344),U=c(471),la=c(758),kb=c(522);class Vb{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(Vb,"Activity",null,[]);var mc=c(428);class Uc extends Vb{constructor(){super();this.$u=this.objectId=null}static iG(b){const k=new kb.a(new mc.a);if(b.$u)for(let r of b.$u)k.add(r);return k}}Object(m.a)(Uc,"RevisionSetActivity",Vb,[]);class Nd{constructor(b,
k,r){this.Cle=null;this.dismiss=()=>{this.Ivi.then(y=>{y.removeNotification(this.Cle);return this.Cle=null})};this.dW=b;this.wc=k;this.Ivi=r}yfo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.wc.Xb(ib.a.b1a,2,null);break;default:this.XOm()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}XOm(){this.Ivi.then(b=>{var k=Object.assign(new Vq.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,
content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new ho.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});k=b.callout(k);const r=Object.assign(new U.a,{expirationOptions:Object.assign(new la.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Cle=b.addNotification(k,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const k={};k.NavigationId=atob(b.navigationId);if(8===this.wc.Xb(ib.a.iAd,2,k))return!1;break;case 1:return this.E_k(b)}return!0}E_k(b){b=Uc.iG(b);return b?0<this.dW.eGd(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(Nd,"ActivityContentManager",null,[567]);var xd=c(1431),Oe=c(1888),Jf=c(987),fh=c(698);class ih{constructor(){this.$u=this.KW=null}compare(b){if(!b)return!1;
if(this.KW&&b.KW){if(this.KW.count!==b.KW.count)return!1;for(let k of this.KW)if(!b.KW.contains(k))return!1}else if(!b.KW&&this.KW||!this.KW&&b.KW)return!1;if(b.$u&&this.$u){if(b.$u.count!==this.$u.count)return!1;for(let k of this.$u)if(!b.$u.contains(k))return!1}else if(!this.$u&&b.$u||!b.$u&&this.$u)return!1;return!0}}Object(m.a)(ih,"ActivityHighlightableObject",null,[]);class Qg extends xd.a{constructor(b,k){super();this.IDe=this.ZTb=null;this.z6c=b;this.ux=k;this.hqa=[new Oe.a(Jf.a.Xlh,Jf.a.Wlh),
new Oe.a(Jf.a.Ulh,Jf.a.Tlh),new Oe.a(Jf.a.bud,Jf.a.cud),new Oe.a(Jf.a.dud,Jf.a.hWe)]}get nCb(){return 1}get ffb(){return this.hqa}get ama(){return!0}oeb(b,k){if(b=Object(ia.a)(ih,b))if(b.KW)for(let r of b.KW)k.add(r);else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}uOa(b,k){if(this.Qy.JKa){var r=this.z6c.Q2a,y=this.z6c.ifb,R=!!r&&r.compare(y),aa=this.Qy.JKa,ta=aa.action,Ya=this.TVn(aa,b),xb=!1;2!==ta&&ta&&(xb=(xb=this.Qy.RRd)?1===xb.type:!!r||!!y);k=k.e2a("*");
for(let Mb=0,cc=k.length;Mb<cc;Mb++){const jc=k[Mb],Mc=this.wsl(jc,Jf.a.CAc);if(Mc&&Mc.Bt)if(this.dsn(jc),1===aa.type)switch(ta){case 0:Ya&&r.$u.contains(Mc.Bt)&&this.esd(jc,2,Mc,!1);break;case 2:Ya&&y.$u.contains(Mc.Bt)&&this.esd(jc,R?2:1,Mc,!1);break;default:this.$4b(b,jc,Mc,!1)}else xb?this.$4b(b,jc,Mc,!1):this.$4b(b,jc,Mc,!0)}this.ZTb&&(this.ZTb.classList.add(Jf.a.dud),this.IDe=this.ZTb=null)}}wsl(b,k){return jj.a.Db(b,k)}TVn(b,k){if(b&&b.JF){const r=b.JF,y=b.action;if(1===b.type&&(2===y||!y)&&
r.KW)return r.KW.contains(k);if(r.$u)for(let R of r.$u){b=this.ux.wIc(R);for(let aa of b)if(aa===k)return!0}}return!1}$4b(b,k,r,y){const R=this.z6c.Q2a,aa=this.z6c.ifb;R&&R.$u.contains(r.Bt)&&(!R.KW||R.KW.contains(b))?this.esd(k,2,r,y):aa&&aa.$u.contains(r.Bt)&&(!aa.KW||aa.KW.contains(b))&&this.esd(k,1,r,y)}esd(b,k,r,y){b&&fh.a(b)&&(b.classList.add(this.lwl(2===k,y)),this.VMn(b,r,y))}VMn(b,k,r){this.ZTb?-1!==k.cpEnd&&this.IDe.cpEnd!==k.cpBegin&&(this.ZTb.classList.add(r?Jf.a.hWe:Jf.a.dud),b.classList.add(r?
Jf.a.cud:Jf.a.bud)):b.classList.add(r?Jf.a.cud:Jf.a.bud);b.classList.add(Jf.a.Vlh);this.ZTb=b;this.IDe=k}dsn(b){this.Qy.p2a(b);this.Zqn(b)}Zqn(b){b.classList.remove(Jf.a.bud,Jf.a.cud,Jf.a.Vlh,Jf.a.dud,Jf.a.hWe)}lwl(b,k){return k?b?Jf.a.Tlh:Jf.a.Wlh:b?Jf.a.Ulh:Jf.a.Xlh}}Object(m.a)(Qg,"ActivityHighlightActor",xd.a,[]);var hi=c(1889),lj=c(186);class Oj{constructor(b,k,r,y,R,aa,ta,Ya){this.V4=b;this.fN=k;this.ux=r;this.vRj=R;this.hb=aa;this.Ep=Ya;this.Ub=ta;this.fN.kQd=!1}tBi(b,k,r){b?this.o_l(b,k,r):
this.fN.Q2a&&(b=Object.assign(new hi.a,{action:1,type:1,JF:null,mO:this.fN.Q2a}),this.fN.Q2a=null,this.V4.rH(b))}o_l(b,k,r){if(k){b=new kb.a(new mc.a);for(R of k){var y=this.ux.HHc(R);for(let aa=0;aa<y.length;aa++){const ta=y[aa];this.ux.MDb(ta)&&b.add(ta)}}var R=this.ux.eGd(b);R=this.buh(R,b);y=this.fN.Q2a;this.fN.Q2a=R;R=Object.assign(new hi.a,{action:0,type:1,JF:this.fN.Q2a,mO:y});this.V4.rH(R);r&&!this.vFn(k.J(0),b)||this.eHn(k.J(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}vFn(b,k){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;k=this.Fpl(b,k);return this.vRj.Adc(b.id,k)?this.setSelection(b,k)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}eHn(b,k){b=this.mwl(b,k);k=new Sys.StringBuilder;for(let r=
0;r<b.count;r++)k.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.J(r)));this.Ep.sendNotification(k.toString(),!0)}setSelection(b,k){if(!b||!ie.ParagraphReader.nc(b))return v.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>k)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.fN.kQd=!0;b=Re.a.Uc(b,k);b=new lj.Selection([b],!0);this.hb.setSelection(b);Id.FocusManager.nJ()&&
this.Ub.Kg(id.AFrame.Wo);return!0}Fpl(b,k){if(k&&0<k.count)for(let r=0;r<b.qa.length;r++){const y=b.qa.J(r);if(y.changeStart&&k.contains(y.changeStart))return y.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}mwl(b,k){const r=new rb.a;if(k&&0<k.count&&b){let y=-1;for(let R=0;R<b.qa.length;R++){const aa=b.qa.J(R);if(-1!==y&&aa.isChangeEnd)if(aa.changeStart&&k.contains(aa.changeStart))continue;else r.add(b.characterData.substring(y,
aa.cp)),y=-1;aa.changeStart&&k.contains(aa.changeStart)&&(y=aa.cp)}}return r}FAi(b,k){if(b)switch(b.type){case 1:if(k){b=new kb.a(new mc.a);for(var r of k){k=this.ux.HHc(r);for(let y=0;y<k.length;y++){const R=k[y];this.ux.MDb(R)&&b.add(R)}}}else b=Uc.iG(b);k=this.ux.eGd(b);this.fN.ifb=this.buh(k,b);r=Object.assign(new hi.a,{action:2,type:1,JF:this.fN.ifb,mO:null});this.V4.rH(r)}else this.fN.ifb&&(r=Object.assign(new hi.a,{action:3,type:1,JF:null,mO:this.fN.ifb}),this.fN.ifb=null,this.V4.rH(r))}buh(b,
k){var r=null;if(b){r=new Ia.a;for(let y of b)12===y.type&&r.add(y)}b=new ih;b.KW=r;b.$u=k?k:this.OBl(r);return b}OBl(b){const k=new kb.a(new mc.a);if(!b)return k;for(let r of b)for(let y of this.ux.bBb(r))k.add(y);return k}}Object(m.a)(Oj,"ActivityHighlightManager",null,[]);var Uh=c(524),tk=c(467),Il=c(1429),Ai=c(128),ql=c(65);class ph{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(ph,"CreateIndicatorTooltipParameters",null,[]);class Gi{constructor(){this.clearSticky=
!1}}Object(m.a)(Gi,"DismissIndicatorTooltipParameters",null,[]);class Rp{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(Rp,"UpdateIndicatorTooltipParameters",null,[]);class ro extends Sys.EventArgs{constructor(b,k,r){super();this.Kzb=b;this.S8h=k;this.RWn=r}}Object(m.a)(ro,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Rn{constructor(){this.T8h=new Map;this.U8h=new Set}Kco(b,k){this.U8h.add(b);this.T8h.set(b,k)}Qgm(b){return Qe.a.Jdi(b.htmlElement)}UQl(){let b=new Set;for(let k of this.U8h){const r=
this.T8h.get(k);r&&this.Pgm(r)&&b.add(k)}return b}Pgm(b){return b.parentElement&&Qe.a.Jdi(b.parentElement)}}Object(m.a)(Rn,"IndicatorVisibilityTracker",null,[]);class Fo extends Il.a{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){super();this.sa=new Fe.a;this.Dqb=this.P8=null;this.pWl=(jc,Mc,fd,Td,ne)=>{if(!ne)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Mc=Uc.iG(ne.Activity);jc=null;if(ne.NodeId&&(ne=Ai.b(ne.NodeId),!G.a.Jp(ne,G.a.nil)&&(ne=this.ux.USh(ne),
this.J7f(ne,!1))))return 32;for(let ye of Mc)if(this.ux.MDb(ye)){ne=this.ux.Y2b(ye);if(this.J7f(ne,!0))return 32;ne&&!jc&&(jc=ne)}if(this.J7f(jc,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.nWl=(jc,Mc,fd,Td,ne)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");ne&&Mc&&Mc.Xk&&(jc=Mc.node)&&((jc=this.xjc.qGd(jc))?this.kqd(jc,!1,!1):v.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.q0n=jc=>{(jc=this.xjc.qGd(jc.customData))&&this.kqd(jc,!1,!1)};this.onMouseEnter=jc=>this.Ozi(jc.Fv,!0);this.nna=jc=>{jc=jc.Fv;if(jc===this.P8)return!0;this.ROi(jc);return!0};this.j1a=jc=>{this.Dqb=null;return this.Ozi(jc.Fv,!1)};this.h_=()=>{this.O1f();this.Zud(!0);return!1};this.Xr=()=>{this.pEi()};this.d_d=()=>{this.P8&&this.Pij(this.P8);this.Dqb&&this.ROi(this.Dqb);this.IVm()};this.pEi=()=>{this.P8?
this.Pij(this.P8):this.lXe()};this.ux=b;this.she=k;this.bKg=r;this.WIj=y;this.fl=R;this.P4=null;this.Hb=ta;this.xjc=Ya;this.mte=new Rn;this.Kw=xb;this.ME=Mb;this.OH=cc;this.mf&&(this.mf.Lja(this.d_d),this.mf.Qah(this.pEi));aa&&aa.execute(jc=>{jc.z7(this.Xr)})}get mf(){return this.fl&&this.fl.yi?this.fl:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}XWa(b,k,r){if(this.P8){var y=ql.a(this.P8);if(b===y)return this.P8}const R=b.Ng.ownerDocument;y=Uh.a.createElement(R,tk.a.div);
y.className=Jf.a.Ptk;y.style.left=k+"px";y.style.top=r+"px";k=Uh.a.createElement(R,tk.a.div);k.className=this.Kw?Jf.a.cmh:Jf.a.Ylh;y.style.cursor="pointer";k.style.cursor="pointer";this.OH&&(k.style.backgroundColor=this.ME.mml(),k.style.outlineWidth="1px",k.style.outlineStyle="solid",k.style.outlineColor=this.ME.nml());y.appendChild(k);pf.a.instance.mb(Kb.a.CQ,y,this.onMouseEnter);pf.a.instance.mb(Kb.a.uK,y,this.nna);Sf.a.instance.mb(Kb.a.click,y,this.j1a);pf.a.instance.mb(Kb.a.contextMenu,y,this.h_);
v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.vAm(b);k=this.FCl(b);this.mte.Kco(k,y);this.mte.Qgm(b)&&this.czi(k);return y}HKb(b){return this.RUn(b)}Nxb(b){const k=this.Wqk(b),r=[];r.push(this.XWa(b.o7,k,b.J4c[0].y-b.B2[0].y));return r}Wqk(b){let k=Jf.a.Y2l+(0>b.GQc?-b.GQc:0);const r=Vf.a.Ri(b.leftMargin,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");k=k>r?r:k;k=k<Jf.a.Zlh?Jf.a.Zlh:k;return n.AFrameworkApplication.isRtl?
b.B2[0].width/this.zoom+k:-k}Z3i(b){if(b&&393230===b.Qc||393251===b.Qc){const k=this.ux.bBb(b);if(k)for(let r of k)if(b===this.ux.Y2b(r))return!0}return!1}RUn(b){for(let k of ie.ParagraphReader.ww(b.zb,!0,!1))if(this.Z3i(k))return!0;return!1}Vb(b){b.pa(Jc.a.J5i,lc.a.Wc,this.nWl);b.pa(Jc.a.e1f,lc.a.Wc,this.pWl)}J7f(b,k){if(!b)return!1;const r=this.xjc.qGd(b);if(r)return this.kqd(r,!1,!0),!0;if(!k){let y;this.PWc((y=new rb.a,y.add(b),y),!1,!0,!0);k=new nd.a(3,1,0,this.q0n,181);k.customData=b;this.Hb.fc(k);
return!0}return!1}aMk(b,k=!1){k&&this.Zud(!0);if(b&&b.parentNode){var r=this.Sif(b);r=this.wil(r);this.P4||(this.P4=document.createElement("Div"),document.getElementById(n.AFrameworkApplication.XXb).appendChild(this.P4));this.she.createActivityIndicatorTooltip(Object.assign(new ph,{target:b,container:this.P4,activityIds:r,isSticky:k,dirHint:9}));k&&(this.P8=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}K3k(b){b&&
b.classList.add(Jf.a.eud)}Ozi(b,k){return this.kqd(b,k,!1)}kqd(b,k,r){if(k&&b===this.P8)return!0;const y=this.Sif(b);k||this.O1f();this.aMk(b,!k);this.K3k(b.getElementsByClassName(this.Kw?Jf.a.cmh:Jf.a.Ylh)[0]);this.PWc(y,k,!0,r);this.doi(y,k?1:2);this.WIj.aUd();k&&(this.Dqb=b);return!0}Zud(b=!1){this.she.dismissActivityIndicatorTooltips(Object.assign(new Gi,{clearSticky:b}));this.Dqb=null;b&&(this.P8=null)}f7i(b){b&&b.classList.remove(Jf.a.eud)}O1f(){this.P8&&this.f7i(this.P8.getElementsByClassName(Jf.a.eud)[0])}ROi(b){const k=
this.Sif(b);this.PWc(k,!0,!1,!1);this.f7i(b.getElementsByClassName(Jf.a.eud)[0]);this.Zud(!1);this.Dqb=null}Sif(b){let k=null;(b=(b=ql.a(b))?b.zb:null)&&11===b.type&&(k=ie.ParagraphReader.ww(b,!0,!1));return k}lXe(){const b=!!this.Dqb;if(this.P8||b)this.O1f(),this.Zud(!0),this.PWc(null,!1,!1,!1),this.PWc(null,!0,!1,!1)}L7j(b){this.sa.addHandler(Fo.s8g,b)}M7j(b){this.sa.addHandler(Fo.t8g,b)}PWc(b,k,r,y){let R=null;if(r&&b){for(let aa of b)if(r=this.ux.HHc(aa))for(let ta=0;ta<r.length;ta++){const Ya=
r[ta];if(this.ux.MDb(Ya)){R=this.ux.iHc(Ya,aa.id);break}}if(!R){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}k?this.sa.raiseEvent(Fo.s8g,new ro(R,b,!1)):this.sa.raiseEvent(Fo.t8g,new ro(R,b,y))}wil(b){const k=[];if(b)for(let y of b){var r=this.ux.bBb(y);for(let R of r)(r=this.ux.iHc(R,y.id))&&k.push(r.activityId)}!k.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return k}Pij(b){b&&b.parentNode?(this.she.updateActivityIndicatorTooltip(Object.assign(new Rp,{target:b,isSticky:!0})),this.P8=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}IVm(){let b=this.mte.UQl();for(let k of b)this.czi(k)}czi(b){this.bKg.coi(b,3)}FCl(b){return(b=ie.ParagraphReader.ww(b.zb,!0,!1))&&b.count?b.J(0).id:null}vAm(b){b=ie.ParagraphReader.ww(b.zb,!0,!1);this.doi(b,0)}doi(b,
k){b&&b.count&&this.uAm(b.J(0).id,k)}uAm(b,k){this.bKg.coi(b,k)}}Fo.s8g="ActivityIndicatorPreviewed";Fo.t8g="ActivityIndicatorSelected";Object(m.a)(Fo,"ActivityIndicatorActor",Il.a,[]);var xg=c(40);class ip{constructor(b,k,r){this.ux=b;this.hod=k;this.fl=r}get mf(){return this.fl&&this.fl.yi?this.fl:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}qGd(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const k=this.TTh(b);if(!k){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.ux.bBb(b);for(let r of b)if(b=this.ux.Y2b(r),b=this.TTh(b))return b}return k}TTh(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var k=this.hod.QId(b);if(!k||11!==k.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;k=k.Be(this.mf.Sb);if(!k||!k.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=Fd.a.mAb(k.htmlElement,ip.r8g);if(r)return r;k=k.K9e();if(!k)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;k=Fd.a.enl(k,ip.r8g);if(!k)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<k.length;r++){const y=ql.a(k[r]),R=xg.OutlineElementNavigator.Sk(b);if(y&&y.zb&&R&&y.zb.id.equals(R.id))return k[r]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}yxl(b){b=this.ux.USh(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
G.a.nil;b=this.qGd(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),G.a.nil;b=ql.a(b);return b?b.zb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),G.a.nil)}}ip.r8g="CatchUpActivityIndicatorContainer";Object(m.a)(ip,"ActivityIndicatorHelper",null,[]);var Cr=c(1608);class eq{constructor(b,k,r,y,R,aa,ta){this.SZa=
b;this.pageContentNode=k;this.YNe=r;this.wc=y;this.dW=R;this.ef=aa;this.lNc=ta;this.PGm=(Ya,xb,Mb)=>{if(1===Mb)return this.u5h?32:8;2===Mb&&(this.u5h&&(this.YNe.lXe(),this.Dxk()),v.ULS.sendTraceTag(38138719,377,50,x.c({["MarkAsRead invoked"]:!0})));Ka.App.xa.updateCommandUI();return 8};this.SZa.Kjb(this.YNe)}initialize(){this.wc.pa(Jc.a.$qi,zc.a.frame,this.PGm)}get u5h(){return!!this.dW.FQ&&0<this.dW.FQ.count||!!this.dW.n$b&&0<this.dW.n$b.count}GJf(b){const k=b&&b.wywaActivities?b.wywaActivities.length:
0;if(!this.lNc||0<k||!b){const r=new Map;r.set("activityCount",k.toString());this.ef.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?this.lNc&&0==b.wywaActivities.length||this.JQm(b.wywaActivities):(v.ULS.shipAssertTag(36538305,377,!1),this.lNc||Object(Cr.a)(),this.ef.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}JQm(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.lTn(b),b=this.dW.j7j(b),this.mTn(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}lTn(b){if(b){var k=new rb.a;for(let r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.MEi:r.contentId,k.add(b),this.dW.n$b.add(b)}0<k.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",k.count),this.wc.Xb(ib.a.Dui,2,k.toArray()))}}mTn(b){const k=new kb.a(new mc.a),r=new sf.GraphTransaction(3);try{r.Eb(this.pageContentNode);for(let y of b){const R=this.dW.Y2b(y);R&&this.YNe.Z3i(R)&&
(k.add(R.id),this.SZa.S5b(R,!0))}}finally{r&&r.dispose()}0<b.count&&Ka.App.xa.updateCommandUI();b={};b.highlightedNodeCount=k.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",x.c(b))}Dxk(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.dW.n$b.count&&(this.wc.Xb(ib.a.HBh,2,this.dW.n$b.toArray()),this.dW.n$b.clear());const b=this.Azk(this.dW.FQ);this.Sqn(b)}Sqn(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const k=new sf.GraphTransaction(3);try{k.Eb(this.pageContentNode);for(let r of b){this.dW.FQ.remove(r);for(let y of this.dW.wIc(r))this.SZa.S5b(y,!0)}this.dW.Pnh()}finally{k&&k.dispose()}}Azk(b){const k=new kb.a(new mc.a);for(let r of b)k.add(r);return k}}Object(m.a)(eq,"ActivityIndicatorManager",null,[]);class Sn{constructor(){this.ifb=this.Q2a=null;this.isFirstDocumentOpen=this.kQd=!1}}Object(m.a)(Sn,"ActivityStateManager",null,[566]);class Tr{constructor(b,k){this.Q7c={};this.LOb=b;this.xz=k;this.n$b=
new rb.a}get FQ(){return this.LOb.FQ}bBb(b){const k=new kb.a(new mc.a);if(!b)return k;b=this.LOb.EEd(b);for(let r=0;r<b.length;r++){const y=b[r];this.MDb(y)&&k.add(y)}return k}wIc(b){return this.LOb.wIc(b)}eGd(b){const k=new rb.a;if(b)for(let r of b)k.addRange(this.wIc(r));return k}j7j(b){const k=new kb.a(new mc.a);if(b)for(let r of b)if(1===r.type&&(b=r))for(let y of b.$u){k.add(y);this.FQ.add(y);const R=y.toString();this.Q7c[R]||(this.Q7c[R]=new rb.a);this.Q7c[R].add(b)}this.Pnh();return k}MDb(b){return this.FQ&&
b?this.FQ.contains(b):!1}iHc(b,k){if(b&&(b=this.Q7c[b.toString()])&&0<b.count){for(let r of b)if(r.objectId.equals(k))return r;return b.J(0)}return null}Y2b(b){return this.LOb.Y2b(b)}Pnh(){this.LOb.oxk()}HHc(b){return this.LOb.HHc(b)}USh(b){if(!this.xz)return null;const k=this.xz.Mc;return k?k.Db(b):null}}Object(m.a)(Tr,"ChangeIdCache",null,[]);var so=c(173),Bi=c(112);class Xn extends so.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Bi.a,
{T_:Xn.getTypeName(),B_:Xn.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(Xn,"ChangeSummariesResponse",so.a,[]);var Ur=c(470);class to extends Ur.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Bi.a,{T_:to.getTypeName(),B_:to.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(to,"ChangeSummariesRequest",Ur.a,[]);var uo=c(409),xl=c(437),qm=c(230),Sp=c(436);class fq{constructor(){this.pcc=this.NYc=null}}Object(m.a)(fq,"ActionPair",null,[]);class To{constructor(b,k,r,y){this.D3k=R=>{R=R.customData;const aa=this.qOi(R);aa&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.hgf(R)),aa.pcc("Request timeout"))};this.OJ=b;this.m4=k;this.Jf=r;this.Hb=y;this.ote=null;this.TDe=
new Fc.a;this.wZg=new Fc.a}v6n(b){const k=Object.assign(new uo.a,{parentPath:["Signal",to.getTypeName()],items:[Object.assign(new xl.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((y,R)=>{this.TDe.Z(b.requestId,Object.assign(new fq,{NYc:y,pcc:R}))});this.wZg.Z(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",To.LSi);this.m4.getAugLoopRuntimeManager().submitOperation(Object.assign(new Sp.a,
{operation:k}));this.dQn(b.requestId);return r})}initialize(){this.ote||(this.ote=this.OJ.Qm().then(()=>{this.Jf.mb(this,Xn.getTypeName())}));return this.ote}GF(b,k){if(b&&qm.a.getTypeNameFor(b.content)===Xn.getTypeName())if(b=b.content){var r=this.qOi(b.correspondingRequest);r?k!==uo.a.getTypeName()?r.pcc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.hgf(b.correspondingRequest)),
r.NYc(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.hgf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}dQn(b){const k=new nd.a(3,1,To.LSi,
this.D3k,176);k.Xpd=0;k.customData=b;this.Hb.fc(k)}qOi(b){if(!b)return null;let k;if(!({value:k}=this.TDe.Bc(b,k)).returnValue)return null;this.TDe.remove(b);return k}hgf(b){if(!b)return-1;let k;return({value:k}=this.wZg.Bc(b,k)).returnValue?(new Date).getTime()-k.getTime():-1}static get LSi(){return n.AFrameworkApplication.K.rc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(To,"ChangeSummariesAugloopProvider",null,[54]);class yl{constructor(){this.activityGroups=null}}Object(m.a)(yl,"FeaturedActivityGroupPayload",
null,[]);class Yq{constructor(b,k,r,y,R){this.fUj=b;this.lyj=k;this.Zzj=r;this.wDj=y;this.znb=R}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.wDj.Wsb.then(()=>this.ptl(b)):Yq.Q6e}UTl(b,k,r){if(!k)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;gp("TranslateFeaturedActivityGroups");r=this.Zzj.odo(b,k,r.wywaActivities);v.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",
0<b.activityChanges.length,0<k.inferences.length,0<r.length);this.znb.set(k.correspondingRequest,r);return Object.assign(new yl,{activityGroups:r})}ptl(b){gp("BuildFeaturedActivityGroupRequest");const k=this.fUj.ymk();if(!k||!k.documentContent||!k.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),Yq.Q6e;if(!k.documentContent.length||!k.activityChanges.length)return Yq.Q6e;v.ULS.sendTraceTag(578954499,
377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+k.requestId);gp("SubmitFeaturedActivityGroupRequest");return this.lyj.v6n(k).then(r=>this.UTl(k,r,b))}}Yq.Q6e=Promise.resolve(Object.assign(new yl,{activityGroups:[]}));Object(m.a)(Yq,"ChangeSummariesDataProvider",null,[564]);class Lq{constructor(b,k){this.ux=b;this.TYj=k}ymk(){const b=new rb.a,k=new rb.a,r=new kb.a(new mc.a);var y=this.ux.FQ;if(!y||!y.count)return Lq.T6e;y=this.ux.eGd(y);if(!y||!y.count)return v.ULS.sendTraceTag(592056450,
377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Lq.T6e;for(let R of y)r.contains(R.id)||(r.add(R.id),this.Rbn(R,b,k));return k.count&&b.count?Object.assign(new to,{activityChanges:k.toArray(),documentContent:b.toArray(),requestId:Ai.a(G.a.create())}):Lq.T6e}Rbn(b,k,r){if(ie.ParagraphReader.nc(b)){var y=ie.ParagraphReader.plainText(b);if(y&&y.length){k.add(y);y=this.ux.bBb(b);y=this.gTl(y);for(let R of y){y=new rb.a;const aa=this.getTextRanges(b,
R);for(let ta of aa)y.add({changeEnd:ta.endIndex,changeSpanId:ta.ZIn,changeStart:ta.startIndex,contentIndex:k.count-1,locationId:Ai.a(b.id)});(y=this.$Ik(R,y.toArray()))&&r.add(y)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}gTl(b){const k=new Fc.a;for(let r of b)(b=this.QXh(r))?(k.ub(b)||k.Z(b,new kb.a(new mc.a)),
k.J(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return k.values}$Ik(b,k){const r=[];let y=null;for(let R of b)if(b=this.ux.iHc(R,G.a.nil)){if(!y){const aa=this.QXh(R);if(!aa||!aa.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}y=aa}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");
return r.length?y?k.length?{activityId:r[0].activityId,changes:k,personId:y,timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),
null)}QXh(b){b=this.ux.iHc(b,G.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let k=b[0].id;k&&k.length||(k=b[0].email);return k}getTextRanges(b,k){const r=new rb.a;
if(!k||!k.count||!b)return r;let y=-1,R=new kb.a(new mc.a);for(let aa=0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);if(-1!==y&&ta.isChangeEnd){if(ta.changeStart&&k.contains(ta.changeStart)){R.add(ta.changeStart);continue}r.add({startIndex:y,endIndex:ta.cp,ZIn:this.TYj.OYi(R)});y=-1;R=new kb.a(new mc.a)}ta.changeStart&&k.contains(ta.changeStart)&&(y=ta.cp,R.add(ta.changeStart))}return r}}Lq.T6e=Object.assign(new to,{activityChanges:[],documentContent:[],requestId:Ai.a(G.a.nil)});Object(m.a)(Lq,"ChangeSummariesRequestBuilder",
null,[]);class Mq{constructor(){this.changes=this.content=null}}Object(m.a)(Mq,"ContentChange",null,[]);class wt{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(wt,"FeaturedActivityGroup",null,[]);class Fp{constructor(){this.end=this.start=0}}Object(m.a)(Fp,"TextRange",null,[]);class gq{constructor(b){this.xjc=b}odo(b,k,r){if(!k)return v.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),
gq.HAd;if(!k.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),gq.HAd;if(!k.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),gq.HAd;if(!k.inferences.length||!k.activityClassifications.length)return v.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),
gq.HAd;const y=[],R=new oa.a(new mc.a);for(let aa of k.inferences){const ta=this.ndo(aa,b,k,r);if(!ta)continue;const Ya=this.xjc.yxl(Ai.b(ta.locationId));Ya.equals(G.a.nil)?y.push(ta):R.ub(Ya)?R.J(Ya).ranking>ta.ranking&&R.Z(Ya,ta):R.add(Ya,ta)}b=[...Array.from(R.values),...y];b.sort((aa,ta)=>aa.ranking-ta.ranking);return b.slice(0,gq.YHm)}ndo(b,k,r,y){if(!b||Th.a.lf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),
null;const R=new rb.a,aa=new Fc.a;let ta=null;for(let xb of b.activitiesInGroup){if(!xb){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>xb.activityIndex||xb.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Mb=r.activityClassifications[xb.activityIndex];if(!Mb||
Th.a.lf(Mb.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ya=this.x$k(y,Mb.activityId);if(Ya){R.add(Ya);for(let cc of xb.changes){if(!cc){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ya=cc.value;if(0>Ya||Ya>=Mb.contents.length){v.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");
continue}Ya=Mb.contents[Ya];if(!Ya){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const jc=k.documentContent[Ya.contentIndex],Mc=Object.assign(new Fp,{start:Ya.changeStart,end:Ya.changeEnd});if(aa.ub(jc))aa.J(jc).add(Mc);else{let fd;aa.Z(jc,(fd=new rb.a,fd.add(Mc),fd))}ta||(ta=Ya.locationId)}}else v.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!R.count)return v.ULS.sendTraceTag(588379914,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;k=this.kPl(aa);return k.count?Object.assign(new wt,{ranking:b.ranking.value,reasons:[1],activities:R.toArray(),contentChanges:k.toArray(),locationId:ta}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}x$k(b,k){for(let r of b)if(r&&r.activityId&&r.activityId===k)return r;return null}kPl(b){const k=
new rb.a;for(let y of b){b=y.key;const R=y.value;R.Sc((aa,ta)=>aa.start-ta.start);var r=R.J(0).start;if(r>gq.Cri){r-=gq.Cri;b=b.substring(r,b.length);for(let aa of R)aa.start-=r,aa.end-=r}k.add(Object.assign(new Mq,{content:b,changes:R.toArray()}))}return k}}gq.HAd=[];gq.Cri=10;gq.YHm=4;Object(m.a)(gq,"ChangeSummariesResponseTranslator",null,[]);class Yn{constructor(){this.znb=new Fc.a;this.bFe=new Fc.a}set(b,k){if(k.length&&b){this.znb.Z(b,k);for(let r of k)if(r.activities)for(let y of r.activities)y&&
y.activityId?this.bFe.Z(y.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.znb.ub(b)?this.znb.J(b):null}aFm(b){return b&&this.bFe.ub(b)?this.bFe.J(b):null}}Object(m.a)(Yn,"FeaturedActivityGroupCache",null,[]);class Km{constructor(b){this.ATd=(k,r,y,R,aa)=>{if(!aa)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;k=aa.Activity;if(!k)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.znb.aFm(k.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;y=Uc.iG(k);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,k.activityId,
this.OYi(y));return 32};this.znb=b;this.Nyg=new Map}Vb(b){b.pa(Jc.a.ATd,zc.a.frame,this.ATd)}OYi(b){let k=0;const r=Array(b.count);for(let y of b)b=this.tDl(y),r[k]=Ai.a(b),k++;return r.join(",")}tDl(b){let k=this.Nyg.get(b);if(k&&k!=G.a.nil)return k;k=G.a.create();this.Nyg.set(b,k);return k}}Object(m.a)(Km,"FeaturedActivityGroupTelemetryActor",null,[]);var Pm=c(94);class Vr extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(Vr,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Wr{constructor(b,
k,r){this.gS=null;this.udo=y=>{this.sVa.reset();y=this.bPl(y.customData);let R=null;for(;y.moveNext();){const aa=y.currentNode;if(aa&&(ie.ParagraphReader.nc(aa)&&this.sa.raiseEvent("OPV",new Vr(aa)),this.sVa.update(),this.sVa.Whb())){R=aa;break}}R?this.M$g(R):this.gS(!0)};this.Hb=b;this.sVa=k;this.xz=r;this.sa=new Fe.a;this.Wsb=new Promise(y=>{this.gS=y})}s9j(b){this.sa.addHandler("OPV",b)}qjk(){this.M$g(null)}M$g(b){const k=new nd.a(3,1,0,this.udo,182);k.customData=b;this.Hb.fc(k)}bPl(b){if(!b)return Pm.a.Zp(this.xz);
b=Wd.GraphIterator.Za(b);b.Ab(7);return Pm.a.Lr(b,this.xz)}}Object(m.a)(Wr,"DocumentTraverser",null,[]);class Go{constructor(b){this.wc=b}shouldShowEmptyExperienceButton(){return n.AFrameworkApplication.mRd()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.wc.Xb(ib.a.t9d,2,null)}}Object(m.a)(Go,"EmptyCatchUpBehaviorManager",null,[563]);class wn{constructor(b,k){this.Ydl=()=>{const r=document.getElementById("flyoutItem0");r&&
(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.Ro=b;this.Ub=k}initialize(){const b=this.Ub.re(id.AFrame.gZb);b.XL=!0;b.parent=id.AFrame.Qp;b.wda(this.Ydl);this.Ro.wS(id.AFrame.gZb)}enableF6Focus(){this.Ro.LG(id.AFrame.gZb)}disableF6Focus(){this.Ro.Rw(id.AFrame.gZb)}}Object(m.a)(wn,"FlyoutFocus",null,[562]);var Hs=c(348);class jp{constructor(b,k,r){this.Sxg=this.$Hg=this.Xpc=this.Mdd=!1;this.oqe=this.A7c=null;this.gYm=(y,R,aa,ta,Ya)=>{Ya[Ig.a.Visible]=
!0;Ya[Ig.a.On]=this.Xpc&&this.Mdd;return 32};this.K_m=(y,R,aa)=>{if(1===aa)return this.Mdd?(this.$Hg||(this.$Hg=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.A7c)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.Sxg=!0;this.A7c();return 32};this.ga=b;this.iGg=k;this.Ub=r}get F$e(){return this.oqe?this.oqe:(v.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),
new Date)}set F$e(b){this.oqe=b}initialize(){this.Vb()}registerButtonClickedEvent(b){this.A7c&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.A7c=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Mdd&&v.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const k=(new Date).getTime()-this.F$e.getTime();v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",
k);this.Mdd=!0;(null===(b=n.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||Hs.a.c1a("ribbon","catchUp");Ib.c(ib.a.Rtk,!0,void 0,void 0,void 0,k)}onFlyoutVisibilityChanged(b){this.Xpc!==b.flyoutIsVisible&&(this.Xpc=b.flyoutIsVisible,Ka.App.xa&&Ka.App.xa.updateCommandUI(!0),this.Xpc&&this.Sxg&&this.Ub.Kg(id.AFrame.gZb),this.Xpc||this.iGg&&this.iGg.tym())}logFlightTriggers(b){b.hasFlyoutData&&n.AFrameworkApplication.Ne("WoCha187;WoCha187cf")}Vb(){this.ga.pa(ib.a.Dcj,
zc.a.frame,this.K_m);this.ga.gb(ib.a.ZJi,zc.a.frame,this.gYm,96)}}Object(m.a)(jp,"FlyoutRibbonButton",null,[561]);var Na=c(150);class ab{constructor(b,k){this.FQ=null;this.JNd=this.dhi=!1;this.dW=b;this.ef=k;this.Qfb=new Na.a;this.mNd=new Map;this.Qfb.Z(1,new kb.a(new mc.a));this.Qfb.Z(0,new kb.a(new mc.a));this.Qfb.Z(2,new kb.a(new mc.a));this.Qfb.Z(3,new kb.a(new mc.a));this.mNd.set(3,"CatchUpIndicatorVisible");this.mNd.set(1,"CatchUpIndicatorPreviewed");this.mNd.set(2,"CatchUpIndicatorSelected");
this.p4d=0}coi(b,k){if(this.Qfb.J(k).add(b)){this.wAm(k);switch(k){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.enh()}}FXm(b){this.N4k();b=this.dW.bBb(b);for(let k of b)if(this.FQ.remove(k)){this.p4d++;
break}}N4k(){if(!this.FQ){this.FQ=new kb.a(new mc.a);for(let b of this.dW.FQ)this.FQ.add(b)}}Abk(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.p4d);this.enh()}enh(){this.p4d&&(this.Fvk(),this.qvk())}Fvk(){!this.dhi&&.5<=this.Qfb.J(0).count/this.p4d&&(this.dhi=!0,Ib.c(ib.a.Ttk),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}qvk(){if(!this.JNd){var b="";1<=this.Qfb.J(1).count&&(this.JNd=!0,b="previews");1<=this.Qfb.J(2).count&&
(this.JNd=!0,b="selections");this.JNd&&(Ib.c(ib.a.Ltk),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}wAm(b){(b=this.mNd.get(b))&&this.ef.logKpiUsage(b,0)}}Object(m.a)(ab,"IndicatorTelemetryActor",null,[]);var wb=c(509);c(1036);class ic{constructor(b,k){this.e0c=b;this.DAc=k}WQl(){return this.DAc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,k){return wb.b(this.e0c.requestActivities(b,k))}getRelevantActivities(b,k){return this.DAc.promise.then(r=>
r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):wb.b(this.e0c.requestRelevantActivities(b,k)))}updateActivityState(b){return wb.b(this.e0c.updateActivityState(b))}getActivityFeed(){return this.DAc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):wb.b(this.e0c.requestActivityFeed()))}updateWaterline(){return wb.b(this.e0c.lyn())}}Object(m.a)(ic,"ActivityRepository",null,[]);var Hc=c(1038);class Xc{constructor(b){this.sl=b}get mf(){return this.sl&&
this.sl.yi?this.sl:null}Adc(b,k){return this.mf?this.mf.PVe(b,!0)?this.mf.Adc(b,k,!0,!0):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(m.a)(Xc,"PageViewWrapper",null,[]);class yd{constructor(b,k,r,y,R){this.activityContentManager=b;this.wc=k;this.r0k=r;this.ef=y;this.Z2l=R}Byf(b){let k=new Map;k.set("activityType",b.type.toString());this.ef.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:k})}Uxf(b){this.ef.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}QMm(b){try{const k=b.activity;this.Byf(b.activity);1==k.type&&this.Z2l.aUd();if(!this.activityContentManager.doesContentExist(k))return this.activityContentManager.yfo(k),this.Uxf("Content does not exist"),Promise.resolve(2);const r={};let y=0;switch(k.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:r.ActivityId=k.activityId;r.NavigationId=atob(k.navigationId);y=this.wc.Xb(ib.a.sYe,2,r);break;case 1:r.Activity=
k,r.NodeId=b.locationId,y=this.wc.Xb(Jc.a.e1f,2,r),r.NodeId&&this.wc.Xb(Jc.a.ATd,2,r)}8==y&&this.Uxf("Action failed")}catch(k){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",k),this.Uxf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.r0k.Wsb.then(()=>this.QMm(b))}}Object(m.a)(yd,"WordActivityNavigationManager",null,[497]);var Xd;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Xd||(Xd={}));Object(m.b)("ProfilePhotoDimension",Xd);var Le=c(783),Xf=c(1430),qh=c(527);class sj{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(sj,"ActivityRequestPayload",null,
[]);class Lg{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(Lg,"Person",null,[]);class Nh extends Vb{constructor(){super();this.relationship=0}}Object(m.a)(Nh,"TaskActivity",Vb,[]);class jk extends Vb{constructor(){super();this.contentId=null}}Object(m.a)(jk,"CommentActivity",Vb,[]);class Dk extends jk{constructor(){super()}}Object(m.a)(Dk,"CommentReplyActivity",jk,[]);class $e extends jk{constructor(){super();this.MEi=null}}Object(m.a)($e,
"MentionActivity",jk,[]);class He{constructor(b,k,r,y){this.Anb=b;this.m9a=k;this.RDe=r;this.fN=y;this.fN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Anb.WQl().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.O0e("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.fN.isFirstDocumentOpen=!0);const k=this.e7f(b.People);return Object.assign(new sj,{activities:this.Lbe(b.Activities,k),actors:k,
hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,k){return this.Anb.getActivities(b,k).then(r=>{if(!r||r.StatusCode)throw this.O0e("GetActivities",r);const y=this.e7f(r.People);return Object.assign(new sj,{activities:this.Lbe(r.Activities,y),actors:y,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.Anb.getRelevantActivities(b,
this.fN.isFirstDocumentOpen).then(k=>{if(!k||k.StatusCode)throw this.O0e("GetRelevantActivities",k);const r=this.e7f(k.People),y=this.Lbe(k.NewActivities,r,2);k=this.Lbe(k.OutstandingActivities,r,3);for(let R of k)y.push(R);return Object.assign(new sj,{activities:y,actors:r})})}updateActivityState(b){return this.Anb.updateActivityState(b)}requestActivityFeed(){return this.Anb.getActivityFeed().then(b=>({activityFeedItems:b}))}Lbe(b,k,r=1){const y=[];if(!b)return y;for(let ta of b){var R=null;b=[];
b.push(k[ta.CreatorIndex]);switch(ta.ActivityType){case 1:R=ta;var aa=new Uc;aa.$u=new rb.a;for(let Ya of R.ChangeIds)aa.$u.add(Ai.b(Ya));aa.objectId=Ai.b(R.ObjectId);R=aa;break;case 2:R=ta;aa=new jk;aa.contentId=R.ContentId;aa.navigationId=R.NavigationId;R=aa;break;case 4:R=ta;aa=new $e;b.push(k[R.MentioneeIndex]);aa.MEi=R.ParentContentId;aa.navigationId=R.NavigationId;R=aa;break;case 3:case 10:R=ta;aa=new Dk;b.push(k[R.RepliedIndex]);aa.contentId=R.ContentId;aa.navigationId=R.NavigationId;R=aa;
break;case 6:case 7:case 8:case 9:R=ta,aa=new Nh,b.push(k[R.MentioneeIndex]),aa.navigationId=R.NavigationId,aa.relationship=R.Relationship,R=aa}R&&(R.actors=b,R.displayTimestamp=new Date(ta.DisplayTimestamp),R.activityId=Ai.b(ta.ActivityId).toString(),R.type=ta.ActivityType,1!==r&&(R.relevancy=r),y.push(R))}return y}aBn(b,k,r){return this.RDe&&!xf.b(b)&&this.RDe.iRd?this.RDe.H_b(k,r,n.AFrameworkApplication.ym,Xd.default):b}e7f(b){if(!b)return null;const k=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;
const y=new Lg;y.id=b[r].Id;y.provider=b[r].Provider;y.displayName=b[r].DisplayName;y.email=b[r].Email;y.imageUrl=this.aBn(b[r].PictureUrl,b[r].Email,b[r].Provider);this.m9a&&(y.color=this.m9a.cKc(new Le.a(y.email,void 0,y.displayName),Xf.a.catchUpFlyout));k[r]=y}return k}O0e(b,k){let r="null";k&&(r=qh.a[k.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}}Object(m.a)(He,"WordActivityRequestManager",null,[495]);class hf{constructor(b,k,r){this.Bgd=0;this.luc=
!1;this.WOg=null;this.updateWaterline=()=>{if(Ka.App.lostSession)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.luc||3>=this.Bgd){this.luc?this.luc=!1:this.Bgd++;const y=Math.max(this.Oa.rc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.WOg),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",y);Fj.Task.delay(y).continueWith(()=>{this.Anb.updateWaterline().then(()=>{this.K5d();return null}).catch(()=>
{this.K5d();this.luc=!0;this.Bgd=0})})}else this.K5d()};this.Oa=b;this.Anb=r;k.QPe(()=>{this.luc=!0;this.WOg=new Date;this.Bgd=0})}start(){this.K5d()}K5d(){window.setTimeout(this.updateWaterline,6E4)}}Object(m.a)(hf,"WordEditorActivityScheduler",null,[]);class Eg{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}hKn(b){this.resolve(b)}}Object(m.a)(Eg,"CatchUpNetworkRequestWorkerCache",null,[]);class Zf{constructor(b,k,r){this.rRk=b;this.K=k;this.ef=r}GJf(b){b&&b.authors&&
this.qAm(b.authors)}qAm(b){for(let k of b)k&&k.displayName===this.rRk&&(this.ef.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",k.id===this.K.lb("PresenceUserId"),k.email===this.K.lb("UserPrincipalName")))}}Object(m.a)(Zf,"WywaAuthorComparator",null,[]);class rl{constructor(b){this.E_=
b}aUd(){this.E_&&this.E_.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)(rl,"IndicatorSurveyActor",null,[]);var ei=c(1011),Vj=c(1004);class Ek{constructor(){this.Utk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get Ntk(){return n.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get Spf(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get xdi(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Sci(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get LNd(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get lNc(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCatchUpActivitiesReadyTelemetryFixEnabled",
!1)}get Lom(){return n.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}zc(b){gp("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new Eg).singleInstance()}init(){gp("Init");this.Ntk&&(M.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,n.AFrameworkApplication.rootQuerySignature,Ka.App.webServiceBase+"OneNote.ashx",2,this.LNd)}),gp("HotStore"),Ka.App.wha.HCb.execute(()=>
{gp("ChromeReady");kj.a.get_instance().Gl(7,()=>{gp("ScriptDownload");(n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.hSm()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",
b)})})}))}hSm(){gp("CreateObjectsAndInitializeState");this.tzm();this.nJk();return this.U4l()}tzm(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.Spf&&v.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.xdi&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");
this.Sci&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.Lom);this.LNd&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}U4l(){this.z5l();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").F$e=new Date;gp("InitializeCatchUpApp");return this.fZb.initialize(Object.assign(new ym,{featuredActivityGroupsEnabled:this.Spf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.xdi,
customDynamicEntryPointEnabled:this.Sci,activityFeedDataEnabled:this.LNd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}nJk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Tr(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),jl.App.En.jb.Fc.ld)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new ei.a(Ga.Health.instance,new Vj.a,this.Utk)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Sn).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Nd(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),n.AFrameworkApplication.ya,Sk.UISurfaces.hK(),n.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new ic(new Hc.a(Jg.a.ycj(this.container.$a("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>n.AFrameworkApplication.rootQuerySignature,Ka.App.webServiceBase+"OneNote.ashx",2,Jg.a.ycj(this.container.$a("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new He(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),n.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Oj(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),jl.App.En.jb.Fc,new Xc(jl.App.En.jb.Fc),bh.a.instance,Id.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new hp.a(50,Qe.a.kf):new Ep;return new Wr(n.AFrameworkApplication.uc,b,
jl.App.En.jb.Fc.ld)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new rl(this.container.$a("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new yd(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),n.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),n.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new jp(n.AFrameworkApplication.ya,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),Id.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new wn(Jn.a.instance,
Id.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Yn).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new ip(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),jl.App.En.jb.Fc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",
()=>new Km(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new Yq(new Lq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new To(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
n.AFrameworkApplication.uc),new gq(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),n.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Go(n.AFrameworkApplication.ya)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();
this.fZb=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new Aq,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:n.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),
dataCulture:n.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.LNd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:n.AFrameworkApplication.uiCulture,ulsLogger:new il.a}));this.fZb.setWebpackPublicPath(n.AFrameworkApplication.Q3);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",
()=>new Qg(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new hf(n.AFrameworkApplication.K,ik.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new ab(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Fo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.fZb.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),jl.App.En.jb.Fc,this.container.$a("Common.IZoomManager"),
n.AFrameworkApplication.uc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Ka.App.instance&&Ka.App.instance.Cma,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ka.App.instance&&Ka.App.instance.XB)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new eq(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,jl.App.En.jb.Fc.ld,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),
n.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.lNc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new zm(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),n.AFrameworkApplication.ya,Id.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",
()=>new Zf(n.AFrameworkApplication.userName,n.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}z5l(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),k=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.Jjb(k);const r=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const y=
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");k=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const R=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),aa=bh.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");aa.tB(()=>{R.kQd?R.kQd=!1:(R.Q2a&&r.tBi(null,null,!1),R.ifb&&r.FAi(null,null),y.lXe())});aa.tB(Object(u.a)(k,k.j_,"onSelectionChanged"));this.fZb.getWywaEvent().addListener(Object(u.a)(b,
b.GJf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.fZb.getWywaEvent().addListener(Object(u.a)(b,b.GJf,"onWywaActivityReady"));const Ya=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");ta.s9j((xb,Mb)=>{Mb&&Ya.FXm(Mb.node)});ta.Wsb.then(()=>{Ya.Abk()});this.fZb.getWywaEvent().addListener(()=>{ta.qjk()});y.L7j((xb,Mb)=>{Mb&&r.FAi(Mb.Kzb,Mb.S8h)});y.M7j((xb,Mb)=>{Mb&&r.tBi(Mb.Kzb,Mb.S8h,Mb.RWn)});y.Vb(n.AFrameworkApplication.ya);
this.Spf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Vb(n.AFrameworkApplication.ya);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.V_n()}V_n(){ni.c()&&(v.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),
appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(Ek,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Ik=c(151),Ho=c(439),jr=c(1458),xt=c(486),Fk=c(1549),kp=c(1465),rv=c(1550),yt=c(1605),vp=c(647),kr=c(1606),ls=c(843),io=c(144),zl=c(1468);class wp{constructor(){this.ft=this.annotation=null}}Object(m.a)(wp,"AnnotationChangedData",null,[]);class hq{constructor(b,k,r,y,R,aa,ta,Ya=!1,xb){this.annotationType=b;this.Oja=
k;this.kq=r;this.H$d=y;this.y4c=R;this.qro=aa;this.jb=ta;this.X3i=Ya;this.K=xb;this.jx=null;this.ghi=!1;this.ie=new Fe.a;this.$Sc=0}WE(b){this.ie.addHandler("AnnotationChangedEvent",b)}nH(b){this.ie.removeHandler("AnnotationChangedEvent",b)}register(){return this.y4c().then(()=>{0===this.$Sc&&(this.X3i&&(this.jx=this.kq.jg("WebServiceCall",this.annotationType)),this.Oja.mb(this,this.annotationType));this.$Sc++})}unregister(){return this.y4c().then(()=>(new Promise(b=>setTimeout(b,this.K.rc(io.a.tWk,
3E3)))).then(()=>{0<this.$Sc&&(this.$Sc--,0===this.$Sc&&this.Oja.sc(this,this.annotationType))}))}p2b(){return this.y4c().then(()=>this.Oja.getAnnotationsByType(this.annotationType))}wNh(b){b=Ho.a.gK(b);return(b=this.Oja.vNh(b))&&0<b.count?b.toArray().filter(k=>qm.a.matchesTypesFor(k.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.qro(this.jb.Xc.Ad,b.parentPath):null:(v.ULS.shipAssertTag(575930380,3016,!1),null)}Psa(b){b.timestamp||(b.timestamp=Date.now());
b=Object.assign(new ls.a,{parentPath:["Signal",qm.a.getTypeNameFor(b)],items:[Object.assign(new xl.a,{body:b})]});this.H$d.submitOperation(b)}M2k(b,k,r,y){b=Object.assign(new uo.a,{parentPath:["Signal",k,r,y],items:[Object.assign(new xl.a,{body:b})]});this.H$d.submitOperation(b)}GF(b,k){b?k?(this.X3i&&!this.ghi&&(this.jx.stop(),this.ghi=!0),this.ie.cfa&&(b=new zl.a(Object.assign(new wp,{annotation:b,ft:k})),this.ie.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,3016,!1):v.ULS.shipAssertTag(575930381,
3016,!1)}}Object(m.a)(hq,"AnnotationManager",null,[569,54]);class Xr{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.mI=b;this.o5d=k;this.Zzb=r;this.mYa=y;this.g6=R;this.Obj=aa;this.X_=ta;this.YLb=Ya;this.F0b=xb;this.hIb=Mb;this.d9n=cc}}Object(m.a)(Xr,"AnnotationManagerHolder",null,[570]);class Is{constructor(b,k){this.Lyc=b;this.y4c=k}submitOperation(b){return this.y4c().then(()=>{this.Lyc.getAugLoopRuntimeManager().submitOperation(Object.assign(new Sp.a,{operation:b}))})}}Object(m.a)(Is,"SubmitOperationHelper",
null,[]);var at=c(858),Yr=c(1607),Tn=c(1034),Vh=c(68),xn=c(135),Qm=c(90),Zq=c(1064);class $q{constructor(b,k,r){this.g6=b;this.am=k;this.dEi=r;this.NAa={};this.vCh=!1;this.qib=(y,R)=>{R.data.ft!==uo.a.getTypeName()&&R.data.ft!==Zq.n.getTypeName()||!R.data.annotation||R.data.annotation.annotationType!==Yr.a.getTypeName()||(y=R.data.annotation.content)&&y.documentTypeConfidences.length&&(this.uCh=y.documentTypeConfidences[0].documentTypeLabel,v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",
this.uCh))};this.g6.WE(this.qib);this.g6.register();this.NAa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}IIc(){this.vCh||(this.g6.Psa(new Tn.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.vCh=!0);this.x_k();this.NAa.docType=this.uCh;this.NAa.characterCount=this.characterCount;this.NAa.paragraphCount=this.o_;this.NAa.imageCount=
this.nQ;this.NAa.tableCount=this.Ioa;this.NAa.listElementsCount=this.xmi;this.NAa.blobsCount=this.Tgh;this.NAa.pageCount=this.dEi.$Jc();this.NAa.currentPage=this.dEi.mXh();return this.NAa}x_k(){this.o_=this.Tgh=this.xmi=this.Ioa=this.nQ=this.characterCount=0;var b=this.am.pBa(jl.App.En.jb.Fc.ld,7,7).currentNode,k=Wd.GraphIterator.Za(b);for(b=Pm.a.Lr(k,b);b.moveNext();)if(k=b.currentNode)if(Pd.ImageReader.Ov(k))this.nQ++;else if(Si.TableReader.eX(k))this.Ioa++;else if(Vh.ListReader.M2(k))this.xmi++;
else if(ie.ParagraphReader.nc(k)){var r=Qm.e(k);for(let y=0;y<r.length;y++)5===r[y].li?this.nQ++:this.Tgh++;r=xn.AParagraphNode.nU(k.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!ie.ParagraphReader.kaa(k)&&!ie.ParagraphReader.oK(k)&&this.o_++}}}Object(m.a)($q,"LoggingDocumentInfo",null,[489]);class Q{constructor(){this.sa=new Fe.a}N9j(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}wun(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}O8j(b){this.sa.addHandler("BlueDotClickedEvent",
b)}dun(b){this.sa.removeHandler("BlueDotClickedEvent",b)}a9j(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}c9j(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}$8j(b){this.sa.addHandler("OnFormattingAccept",b)}b9j(b){this.sa.addHandler("OnFormattingReject",b)}C9j(b){this.sa.addHandler("OnReviewInvalidated",b)}Zah(b){this.sa.addHandler("OnTraigeAction",b)}PPe(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}oun(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}M8j(b){this.sa.addHandler("OnBeforeReviewNavigation",
b)}y9j(b){this.sa.addHandler("OnRegisterEnhancement",b)}P9j(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}xun(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}TWc(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new zl.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}Ygn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new zl.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}ahn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new zl.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}BKi(b){b?
this.sa.raiseEvent("OnFormattingReviewCompleted",new zl.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}$gn(b){b?this.sa.raiseEvent("OnFormattingAccept",new zl.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}bhn(b){b?this.sa.raiseEvent("OnFormattingReject",new zl.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}chn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new zl.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}mQf(b){b?this.sa.raiseEvent("OnTraigeAction",new zl.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}CKi(b){b?
this.sa.raiseEvent("OnReviewVisibilityChanged",new zl.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}Xgn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new zl.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}acc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new zl.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}YKi(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new zl.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(Q,"ReviewEvents",null,[488]);class xa{constructor(b){this.xt=b;if(!b)throw Ik.a.argument("Workspace is null");
}get name(){return"WordEditor.Designer.Common"}init(){}zc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Is(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Ho.a.Qm)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",()=>new at.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),n.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Q).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",
()=>new Xr(this.oAa(kp.DocumentRoleDetectionAnnotation.getTypeName()),this.oAa(kp.RoleDetectionAnnotation.getTypeName()),this.oAa(jr.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.oAa(jr.FormattingSuggestionsAnnotation.getTypeName()),this.oAa(xt.DocumentTypeClassifierAnnotation.getTypeName()),this.oAa(yt.ThemeExtractorAnnotation.getTypeName()),this.oAa(vp.ThemeGeneratorAnnotation.getTypeName()),this.oAa(rv.TextToImageAnnotation.getTypeName()),this.oAa(Fk.DocumentPullQuoteAnnotation.getTypeName()),
this.oAa(Fk.PullQuoteAnnotation.getTypeName()),this.oAa(kr.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new $q(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").g6,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}oAa(b,k=!1){return new hq(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Ho.a.Qm,Ho.a.geb,this.xt,k,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)(xa,"PackageManager",null,[1,2]);var jb=c(1475),Nb=c(1454),Bc=c(1609);class gd extends Sys.EventArgs{constructor(b,k){super();this.node=b;this.iEf=k}}Object(m.a)(gd,"RoleChangeArgs",Sys.EventArgs,[]);class be{constructor(b){this.Ih=!1;this.iP=b;this.iP.gdd++}dispose(){this.Ih||(this.Ih=!0,this.iP.gdd--)}}Object(m.a)(be,"InvalidationSuspension",
null,[10]);class Bd{constructor(){this.N1c=null;this.role=this.qVd=0;this.Yvb=this.tQd=this.vma=this.l8b=!1;this.FUd=this.GRc=this.sLa=null;this.removed=this.placeholder=!1;this.asd=this.jDc=null;this.$rd=0}get z_a(){return!this.role||!this.sLa||!this.sLa.length}I9l(){this.Yvb=this.tQd=!0}$om(){return!!this.role||!!this.sLa||!!this.N1c}}Object(m.a)(Bd,"RoleState",null,[516]);class Xe{constructor(b,k,r,y,R,aa){this.Ah=!1;this.wNd=null;this.zzf=new xc.a;this.TIg=0;this.nCn=(ta,Ya)=>{Ya.data.ft===uo.a.getTypeName()&&
(Ya=Ya.data.annotation,(ta=Ya.content)?(Ya=this.CUb.getParent(Ya))&&this.y_c(Ya,Nb.e(ta.roleType),!1,void 0,null!=ta.listID?ta.listID:0,ta.listItemlevel,ta.listItemPrefix):v.ULS.shipAssertTag(575813856,3016,!1))};this.d0k=(ta,Ya)=>{if(Ya.data.ft===uo.a.getTypeName())if(ta=Ya.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,ta.confidence.toString()),this.zzf=new xc.a,Ya=0;ta.listInfos&&Ya<ta.listInfos.length;Ya++){const xb=ta.listInfos[Ya];this.zzf.Z(xb.listID,xb)}else v.ULS.shipAssertTag(556323522,
3016,!1)};this.Yfi=(ta,Ya)=>{ta=ta.oJ;if(!ta||ta.ia(wc.a.DB,!1))return!1;ta=ta.getValue(wc.a.la);if(!ta)return!1;ta=Nb.f(ta);return 1!=ta&&ta!=Ya.role};this.Kfl=(ta,Ya)=>{ta=Ya.data.annotation;const xb=this.Yad.getParent(ta);if(xb)if(Ya.data.ft===uo.a.getTypeName()){const Mb=Ya.data.annotation.content;Mb?this.wba(xb,cc=>{this.wNd&&cc.jDc&&this.wNd>cc.jDc&&!cc.Yvb||cc.role!==cc.qVd||this.Yfi(xb,cc)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.wNd,cc.Yvb,cc.role===cc.qVd),cc.N1c=Mb.suggestions):(cc.sLa=Mb.suggestions,cc.Yvb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else Ya.data.ft===jb.a.getTypeName()&&this.wba(xb,Mb=>{Mb.sLa=null;Mb.N1c=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ta.id} parentPath: ${ta.parentPath}`)};this.LUm=(ta,Ya)=>{(ta=Ya.data.paragraphNode)?this.wba(ta,xb=>{Ya.data.ylj?(xb.asd=xb.sLa,xb.$rd=xb.role):(xb.asd=null,xb.$rd=0);xb.vma=!0}):v.ULS.shipAssertTag(575930368,
3016,!1)};this.NUm=(ta,Ya)=>{(ta=Ya.data.paragraphNode)?this.wba(ta,xb=>{xb.vma=!1;xb.asd=null;xb.$rd=0;5!==Ya.data.state&&(xb.sLa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.JUm=(ta,Ya)=>{(ta=Ya.data.paragraphNode)?this.wba(ta,xb=>{xb.vma=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.MUm=(ta,Ya)=>{(ta=Ya.data.paragraphNode)?this.y_c(ta,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.qJf=(ta,Ya)=>{(ta=Ya.data.paragraphNode)?this.y_c(ta,Ya.data.iEf,!0,!0):v.ULS.shipAssertTag(575484484,
3016,!1)};this.JSl=(ta,Ya)=>{if(Ya.node){var xb=Ya.node;ta=this.BA(xb);27==ta.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ta.vma&&27!==ta.role&&28!==ta.role&&this.T2i(this.idc-1);ta.z_a||27===ta.role||28===ta.role||this.M2i(this.inconsistenciesCount-1);this.wba(xb,Mb=>{Mb.removed=!0});this.G0.ddi()||setTimeout(()=>this.removeNode(xb),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ta=>{this.uPi(ta.id)};this.uPi=ta=>{let Ya;({value:Ya}=this.pq.Bc(ta));(null===
Ya||void 0===Ya?0:Ya.removed)&&this.pq.remove(ta)};this.Gsn=()=>{const ta=this.pq.keys.toArray().filter(Ya=>this.pq.J(Ya).removed);ta.sort((Ya,xb)=>this.pq.J(Ya).jDc.getTime()-this.pq.J(xb).jDc.getTime());ta.slice(0,10).forEach(Ya=>{this.uPi(Ya)})};this.ISl=(ta,Ya)=>{Ya.node?(ta=Ya.node,this.JOc(ta)?this.wba(ta,xb=>{xb.removed=!1}):this.wba(ta,xb=>{xb.Yvb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.KSl=(ta,Ya)=>{Ya.node?this.X_f(Ya.property,Ya.node)&&(ta=Ya.node,this.gdd||ta.I0d?this.wba(ta,
xb=>{xb.Yvb=!1}):this.wba(ta,xb=>{xb.I9l();xb.N1c&&(xb.sLa=xb.N1c,xb.role=xb.qVd)}).vma&&this.wUa.chn(new Bc.a(Ya.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.wYm=(ta,Ya)=>{switch(Ya.data.role){case 27:const xb=Ya.data;this.wba(Ya.data.paragraphNode,cc=>{cc.role=27;cc.l8b=!0;cc.placeholder=xb.placeholder});break;case 28:const Mb=Ya.data;this.wba(Ya.data.paragraphNode,cc=>{cc.role=28;cc.l8b=!0;cc.placeholder=Mb.placeholder;cc.KLc=Mb.KLc});break;case 2:this.wba(Ya.data.paragraphNode,cc=>{cc.role=
2})}};this.Yad=b;this.CUb=k;this.aoe=r;this.G0=aa;this.Lm=y;this.wUa=R;this.pq=new xc.a;this.sa=new Fe.a;this.gdd=this.Hkd=this.Lcd=0}get d$l(){return this.gdd}e9j(b){this.sa.addHandler(Xe.bzi,b)}D9j(b){this.sa.addHandler(Xe.dBi,b)}Uah(b){this.sa.addHandler(Xe.MIf,b)}pun(b){this.sa.removeHandler(Xe.MIf,b)}get inconsistenciesCount(){return this.Lcd}M2i(b){this.Lcd!==b&&(this.Lcd=b,this.sa.raiseEvent(Xe.bzi,new zl.a(this.Lcd)))}get idc(){return this.Hkd}T2i(b){this.Hkd!==b&&(this.Hkd=b,this.sa.raiseEvent(Xe.dBi,
new zl.a(this.Hkd)))}get Xlf(){return this.TIg}JOc(b){return this.pq.ub(b.id)}vAl(b){var k,r;return null===(r=null===(k=this.zzf)||void 0===k?void 0:k.Bc(b))||void 0===r?void 0:r.value}CXh(b,k){var r,y,R;const aa=new Map;for(const ta of k)if((k=ta)&&k.isConnected){const Ya=null!==(R=null===(y=null===(r=this.pq.Bc(k.id))||void 0===r?void 0:r.value)||void 0===y?void 0:y.role)&&void 0!==R?R:1;b.has(Ya)&&(aa.has(Ya)?aa.get(Ya).add(k):aa.set(Ya,new rb.a([k])))}return aa}BA(b){if(!b)return v.ULS.shipAssertTag(575813855,
3016,!1),null;let k;return({value:k}=this.pq.Bc(b.id)).returnValue?k:Object.assign(new Bd,{role:1,l8b:!1})}Xxn(){this.wNd=new Date;return new be(this)}register(){this.Yad.register();this.CUb.register();this.aoe.register()}unregister(){this.Yad.unregister();this.CUb.unregister();this.aoe.unregister()}initialize(){if(!this.Ah){const b=this.Lm.Ve(12);b.Zu(this.JSl);b.Wt(this.ISl);b.qp(this.KSl);this.Yad.WE(this.Kfl);this.CUb.WE(this.nCn);this.aoe.WE(this.d0k);this.wUa.b9j(this.MUm);this.wUa.$8j(this.JUm);
this.wUa.a9j(this.LUm);this.wUa.c9j(this.NUm);this.wUa.Zah(this.qJf);this.wUa.y9j(this.wYm);this.Ah=!0}}qe(){}y_c(b,k,r,y=!1,R=0,aa=0,ta){let Ya=0,xb=!1;this.wba(b,Mb=>{const cc=Mb.tQd||!Mb.role||1==Mb.role;r||(Mb.qVd=k);if(y||cc)xb=Mb.role!==k,Ya=Mb.role,Mb.role=k,Mb.l8b=r,Mb.tQd=!1,Mb.GRc=R,Mb.FUd=aa,Mb.listItemPrefix=ta,Mb.jDc=new Date});if(xb){const Mb=k-4;Mb>this.Xlf&&8>Mb&&(this.TIg=Mb);1===k&&this.wba(b,cc=>{cc.sLa=null});this.sa.raiseEvent(Xe.MIf,new zl.a(new gd(b,k,Ya)))}}wba(b,k){let r;
if(({value:r}=this.pq.Bc(b.id)).returnValue){b=r.z_a;const y=r.vma;k(r);if(27!==r.role&&28!==r.role){if(r.removed)return r;b!==r.z_a&&this.M2i(this.inconsistenciesCount+(b?1:-1));y!==r.vma&&this.T2i(this.idc+(y?-1:1))}}else k(r=new Bd),r.$om()&&(this.G0.ddi()&&this.pq.count>io.a.pCn&&(v.ULS.sendTraceTag(525165656,3016,50,this.pq.count.toString()),this.Gsn()),this.pq.add(b.id,r));return r}X_f(b,k){({value:k}=this.pq.Bc(k.id));return 28===(null===k||void 0===k?void 0:k.role)?!(null===k||void 0===k?
0:k.placeholder)&&b===Te.a.mo:!(null===k||void 0===k?0:k.placeholder)&&(b===Te.a.mo||b===Te.a.wn||Array.contains(xn.AParagraphNode.$ea(),b))}}Xe.bzi="OnInconsistenciesChanged";Xe.dBi="OnRoleReviewCount";Xe.MIf="OnRoleChanged";Object(m.a)(Xe,"RoleLifecycleManager",null,[492,113,493]);class eg{constructor(b,k,r,y,R){this.wUa=b;this.CUb=k;this.Jf=r;this.Lm=y;this.iP=R;this.Ah=!1;this.qJf=(aa,ta)=>{(aa=ta.data.paragraphNode)?this.dij(aa,()=>!0,Ya=>Ya.userSetRole=Nb.d(ta.data.iEf)):v.ULS.shipAssertTag(557057378,
3016,!1)};this.CXm=(aa,ta)=>{0<this.iP.d$l||this.X_f(ta.property)&&this.dij(ta.node,Ya=>!(Ya&&Ya.isInvalidated),Ya=>Ya.isInvalidated=!0)}}initialize(){this.Ah||(this.wUa.Zah(this.qJf),this.Lm.Ve(12).qp(this.CXm),this.Ah=!0)}qe(){}dij(b,k,r){if(b=(b=this.CUb.wNh(b))&&1===b.length&&b[0]){var y=b.content;y=y&&y.M_&&y.M_.customMetadata;k(y)&&(k=new kp.RoleDetectionCustomMetadata,k.isInvalidated=y&&y.isInvalidated,k.userSetRole=y&&y.userSetRole,r(k),this.Jf.ejo(b,k))}}X_f(b){return b===Te.a.mo||b===Te.a.wn||
Array.contains(xn.AParagraphNode.$ea(),b)}}Object(m.a)(eg,"RoleDetectionMetadataUpdater",null,[494]);class og{constructor(b,k){this.H$d=b;this.Ryb=k;this.ATc=(r,y)=>{r=y.data;if(r.ft==Zq.a.getTypeName()||r.ft==Zq.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.Ryb.WE(this.ATc)}qe(){this.Ryb.nH(this.ATc)}wRm(){if(void 0===this.runId)Promise.resolve();else{var b=new kp.RoleDetectionSettings({acceptedRunId:this.runId});b=new Zq.a({parentPath:["session",
"doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.H$d.submitOperation(b)}}}Object(m.a)(og,"RoleDetectionSettingsUpdater",null,[]);class Ni{constructor(b,k,r){this.Y8l=b;this.Oja=k;this.Ae=r;this.N$h=this.initialized=!1;this.hxi=()=>{this.w4i()&&(this.z9h(),this.Oja.Wtn(this.hxi))}}initialize(){this.initialized||(this.Znf(),this.initialized=!0)}qe(){}Znf(){this.w4i()?this.z9h():this.Oja.A8j(this.hxi)}w4i(){return!this.N$h&&(this.Ae.cdi()||this.Oja.Z5b(kp.DocumentRoleDetectionAnnotation.getTypeName())||
this.Oja.Z5b(kp.RoleDetectionAnnotation.getTypeName()))}z9h(){for(const b of this.Y8l)b.initialize();this.N$h=!0}}Object(m.a)(Ni,"RLMInitializer",null,[]);class kk{constructor(b,k,r){this.o4=b;this.xt=k;this.$6c=r;this.W=null;this.iha=()=>{this.SMc();this.xt.Tjb(this.iha)};if(!b)throw Ik.a.argument("AppLifecycleManager is null");if(!k)throw Ik.a.argument("Workspace is null");if(!r)throw Ik.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>
this.Wm())}zc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new og(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").mI)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new eg(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").o5d,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Xe(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").mYa,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").o5d,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").mI,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new Ni([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}Wm(){this.$6c.KI?this.o4.Gl(16,()=>this.lMc()):this.lMc()}lMc(){this.xt.Xta?this.SMc():this.xt.zda(this.iha)}SMc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(m.a)(kk,"PackageManager",null,[1,2]);class mj{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
k){const r=new mj;r.ContractVersion=b;r.FileName=k;r.Paragraphs=[];return r}}Object(m.a)(mj,"DocumentSwayPreviewContent",null,[]);class am{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static QGk(b,k,r,y){const R=new am;R.RawText=b;R.ParagraphFormatting=k;R.TextRuns=r;R.IsRTL=y;R.ParagraphIndex=0;return R}}Object(m.a)(am,"ParagraphContent",null,[]);var zj=c(105),yn=c(1182);class Jk{constructor(){this.Name=null;this.Size=0}static construct(b,
k){const r=new Jk;r.Name=b;r.Size=k;return r}}Object(m.a)(Jk,"FontData",null,[]);class iq{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,k,r,y,R,aa){const ta=new iq;ta.IsBold=b;ta.IsUnderline=k;ta.IsUppercase=r;ta.Font=y;ta.Alignment=R;ta.LeftIndent=aa;return ta}}Object(m.a)(iq,"TextFormatting",null,[]);class ar{constructor(){this.RunFormatting=this.RawText=null}static construct(b,k){const r=new ar;r.RawText=b;r.RunFormatting=
k;return r}}Object(m.a)(ar,"TextRunContent",null,[]);var Kk=c(109),Ag=c(43);class nn{constructor(b,k){this.oPb=null;this.DMj=b;this.SM=k||""}get q3m(){return this.DMj.value}Z7k(){const b=Date.now(),k=mj.construct(2,this.SM);k.Paragraphs=this.ojl();const r={};r.ExtractionDurationInMs=(Date.now()-b).toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",r);return k}ojl(){const b=new rb.a;var k=0;let r=0,y=!1;var R=new Wd.GraphIterator;R.set(this.q3m);R=Pm.a.Zp(R.currentNode);const aa=new xc.a(0);for(;R.moveNext()&&
2100>r&&25>k;){var ta=R.currentNode;if(ie.ParagraphReader.nc(ta)&&!ie.ParagraphReader.kaa(ta)){!y&&ie.ParagraphReader.oK(ta)&&(y=!0);let Ya=xn.AParagraphNode.nU(ta.characterData);Ya=Ya.trim();if(0<Ya.length){const xb=this.FEl(ta);xb.ParagraphIndex=k;k++;r+=Ya.length;b.add(xb);this.pmo(aa,ie.ParagraphReader.language(ta))}}}this.oPb=this.$pl(aa);k={};k.documentHasList=y;v.ULS.sendTraceTag(25776736,382,50,"{0}",k);return b.toArray()}$pl(b){let k=-1,r=1033;for(let y of b.keys.toArray())y&&b.J(y)>k&&(k=
b.J(y),r=y);return yh.a.qg(r)}pmo(b,k){b.ub(k)?b.Z(k,b.J(k)+1):b.Z(k,1)}FEl(b){const k=xn.AParagraphNode.nU(b.characterData),r=this.JEl(b),y=this.VNl(b);b=this.Ojm(b);return am.QGk(k,r,y,b)}JEl(b){const k=ie.ParagraphReader.Jn(b,Te.a.bold,!1),r=ie.ParagraphReader.Jn(b,Te.a.underline,!1);var y=ie.ParagraphReader.Jn(b,Te.a.fontSize,zj.a.VJ);const R=ie.ParagraphReader.Jn(b,Te.a.font,zj.a.WG);var aa=ie.ParagraphReader.Lv(b);aa=this.wbf(aa);const ta=!!ie.ParagraphReader.Jn(b,Hk.a.capitalization,0);b=(new yn.a).qT(b).value/
20;y=Jk.construct(R,y);return iq.construct(k,r,ta,y,aa,b)}VNl(b){const k=new rb.a;for(let R=0;R<b.qa.length-1;R++){var r=b.qa.J(R),y=b.qa.J(R+1);r.formatting&&(y=xn.AParagraphNode.nU(b.characterData.substr(r.cp,y.cp-r.cp)),r=this.WNl(r.formatting),r=ar.construct(y,r),k.add(r))}return k.toArray()}WNl(b){const k=Kk.FormattingReader.PJc(b,Te.a.bold,!1),r=Kk.FormattingReader.PJc(b,Te.a.underline,!1);var y=Kk.FormattingReader.PJc(b,Te.a.fontSize,zj.a.VJ);const R=Kk.FormattingReader.PJc(b,Te.a.font,zj.a.WG);
y=Jk.construct(R,y);b=!!Kk.FormattingReader.PJc(b,Hk.a.capitalization,0);return iq.construct(k,r,b,y,5,0)}wbf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}Ojm(b){const k=new Wd.GraphIterator;k.set(b);k.Ab(11);return(b=k.kd(11))?Ag.OutlineElementReader.fm(b):!1}}Object(m.a)(nn,"DocumentContentExtractor",null,[438]);class Dr{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}zc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",
()=>new nn(new cg.a(()=>jl.App.En.jb.Fc.ld),n.AFrameworkApplication.Gt.Hz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){M.a.instance.Pc(new Dr)}}Object(m.a)(Dr,"DocumentContentExtractorPackage",null,[1,2]);class ms{}ms.vg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(m.a)(ms,"EmbedDialogHtml",null,[]);class Js{constructor(b,
k,r,y){this.Aac=b;this.JZa=k;this.GZd=r;this.value=y}}Object(m.a)(Js,"OptionInfo",null,[]);class ns{constructor(b,k,r){this.RWf=b;this.p5b=k;this.JZa=r}}Object(m.a)(ns,"SectionInfo",null,[]);var Ks=c(233);class ef extends yf.a{constructor(b,k=!1){super(!1,!1,k);this.A$c=476;this.wQb=288;this.une=798;this.BSj=476;this.ASj=288;this.TUc={};this.okb=[];this.dV=this.WTa=this.msb=this.cpb=this.Hhd=this.XTb=null;this.dnc=n.AFrameworkApplication.qLc;this.Psb=b;this.FBe=Object(u.a)(this,this.I1m,"optionClickHandler");
this.$sc=Object(u.a)(this,this.J1m,"optionKeyHandler");this.uie=Object(u.a)(this,this.Wgk,"arrowClickHandler");this.qOb=Object(u.a)(this,this.Xgk,"arrowKeyHandler");this.Pnd=Object(u.a)(this,this.l$n,"textAreaOnFocusHandler");this.eLj=k;this.vg=ms.vg;this.Gd=0;this.lg="EmbedDialog"}get $q(){return this.wQb}set $q(b){this.wQb=b}L6i(b){const k={["id"]:this.lg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Oa.a.Ip(this.Psb,"wdPreview","1"),["initialEmbedUrl"]:this.dnc,["getEmbedCode"]:ef.vRh,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))k[r]=b[r];this.Gd=1;this.We(1,CommonUIStrings.l_CopyAction);this.We(0,CommonUIStrings.l_Close);this.Vh(CommonUIStrings.l_Embed,null,k)}Zec(){if(this.eLj)this.L6i({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.XTb=document.getElementById("embedpreviewpane");
this.Hhd=document.getElementById("embedoptionpane");this.XTb.style.width=String.format("{0}px",this.BSj);this.WTa=document.createElement("iframe");this.WTa.className=ef.zSj;this.WTa.frameBorder="0";this.WTa.style.height=String.format("{0}px",this.ASj);this.WTa.tabIndex=-1;this.XTb.appendChild(this.ayd(CommonUIStrings.l_Preview,this.WTa,ef.HXg,ef.GXg,ef.HXg,!0));this.dV=document.createElement("textarea");this.dV.className=ef.RDj;Sys.UI.DomElement.addCssClass(this.dV,Ks.a.KQe);this.dV.id=ef.cEg;X.a.mi||
(this.dV.readOnly=!0);this.dV.rows=4;this.dV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.dV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.dV.setAttribute(Ef.a.Fda,String.format("{0} {1}",ef.bEg,ef.aEg));this.XTb.appendChild(this.ayd(CommonUIStrings.l_EmbedCode,this.dV,ef.bEg));Af.a.addHandler(this.dV,"focus",this.Pnd);var b=document.createElement("span");b.className=ef.GFj;b.innerText=CommonUIStrings.l_CopyText;b.id=ef.aEg;this.XTb.appendChild(b);this.cpb=document.createElement("div");
this.cpb.className=ef.ZCj;this.Hhd.appendChild(this.ayd(CommonUIStrings.l_Dimensions,this.cpb));this.msb=document.createElement("div");this.Hhd.appendChild(this.aKk(ef.pVg,this.msb));this.Gd=0;this.We(1,CommonUIStrings.l_Close);this.V8f();this.Ojj();X.a.mi||this.dV.focus()}}dispose(){if(this.TUc){var b=this.TUc;for(let k in b){const r=b[k];this.oq.sc(Kb.a.click,r.Aac,this.FBe);this.le.sc(Kb.a.ni,r.Aac,this.$sc);this.le.sc(Kb.a.oh,r.Aac,this.$sc)}this.$sc=this.FBe=this.TUc=null}if(this.okb){for(b=
0;b<this.okb.length;++b)this.oq.sc(Kb.a.click,this.okb[b].p5b,this.uie),this.le.sc(Kb.a.ni,this.okb[b].p5b,this.qOb),this.le.sc(Kb.a.Kt,this.okb[b].p5b,this.qOb),this.le.sc(Kb.a.oh,this.okb[b].p5b,this.qOb);this.le=this.uie=this.okb=null}this.Pnd&&this.dV&&(Af.a.removeHandler(this.dV,"focus",this.Pnd),this.Pnd=null);this.dV=this.WTa=this.msb=this.cpb=this.Hhd=this.XTb=null;super.dispose()}Cga(){super.Cga();this.fd.style.width=String.format("{0}px",this.une);this.pWa()}Sko(b,k){const r=Oa.a.Ip(this.dnc,
b,k);return this.dnc!==r?(this.dnc=r,this.Psb=Oa.a.Ip(this.Psb,b,k),!0):!1}V8f(){this.dV&&(this.dV.innerText=ef.vRh(this.dnc,this.A$c,this.wQb))}Ojj(){this.WTa&&this.WTa.contentWindow.location.replace(Oa.a.Ip(this.Psb,"wdPreview","1"))}ade(b,k){this.Sko(b,k)&&(this.V8f(),this.Ojj())}ayd(b,k,r=null,y=null,R=null,aa=!1){const ta=document.createElement("div");ta.className=ef.hVj;y&&(ta.id=y);R&&ta.setAttribute(Ef.a.Fda,R);aa&&(ta.tabIndex=0);y=document.createElement("span");y.className=ef.iVj;y.innerText=
b;r&&(y.id=r);ta.appendChild(y);ta.appendChild(k);return ta}aKk(b,k){const r=this.ayd(CommonUIStrings.l_Interaction,k),y=this.Gk.createElement("div");y.className=ef.Rxj;y.id=ef.wwg+b;y.setAttribute(Ef.a.Bh,Ef.a.J1);y.tabIndex=0;r.insertBefore(y,k);b=ci.createClusteredImage(16,16,ef.Sxj,ef.Txj,!0,"");y.appendChild(b);b=b.childNodes[0];b.className=ci.getImageClass(ef.tDg);b.title=CommonUIStrings.l_Expand;y.title=CommonUIStrings.l_Expand;k.style.visibility="hidden";k=new ns(k,y,b);Array.add(this.okb,
k);this.oq.uE(Kb.a.click,y,this.uie,k);this.le.uE(Kb.a.ni,y,this.qOb,k);this.le.uE(Kb.a.Kt,y,this.qOb,k);this.le.uE(Kb.a.oh,y,this.qOb,k);return r}Wgk(b){this.smh(b);return!0}Xgk(b){return this.gQc(b,Object(u.a)(this,this.smh,"changeArrowState"))}smh(b){b=b.Dp;"visible"===b.RWf.style.visibility?(b.RWf.style.visibility="hidden",b.JZa.className=ci.getImageClass(ef.tDg),b.JZa.title=CommonUIStrings.l_Expand,b.p5b.title=CommonUIStrings.l_Expand):(b.RWf.style.visibility="visible",b.JZa.className=ci.getImageClass(ef.t_j),
b.JZa.title=CommonUIStrings.l_Collapse,b.p5b.title=CommonUIStrings.l_Collapse)}xuh(b,k){const r=document.createElement("div");r.className=ef.mVg;r.id=b+ef.nVg;var y=this.Gk.createElement("div");y.tabIndex=0;y.className=ef.Syg;y.id=b+ef.Nkc;y.setAttribute(Ef.a.Bh,Ef.a.mSe);y.setAttribute(Ef.a.Fza,Ef.a.Jo);y.setAttribute(Ef.a.Fda,b+ef.SPb);r.appendChild(y);r.setAttribute(Ef.a.Bh,Ef.a.Gz);var R=ci.createClusteredImage(16,16,ef.Yyg,ef.Xyg,!0,"");y.appendChild(R);R=R.childNodes[0];R.id=b+ef.oVg;R.className=
ci.getImageClass(ef.pke);y=new Js(r,R,y,1);this.TUc[b]=y;this.oq.uE(Kb.a.click,r,this.FBe,b);y=document.createElement("span");y.className=ef.SPb;y.innerText=k;y.id=b+ef.SPb;r.appendChild(y);this.le.uE(Kb.a.ni,r,this.$sc,b);this.le.uE(Kb.a.oh,r,this.$sc,b);return r}I1m(b){this.cDi(b);return!0}J1m(b){return this.gQc(b,Object(u.a)(this,this.cDi,"optionHandler"))}cDi(b){const k=this.TUc[b.Dp.toString()];k.value?(k.value=0,k.JZa.className=ci.getImageClass(ef.CLe),k.GZd.setAttribute(Ef.a.Fza,Ef.a.rL)):
(k.value=1,k.JZa.className=ci.getImageClass(ef.pke),k.GZd.setAttribute(Ef.a.Fza,Ef.a.Jo));this.ade(b.Dp.toString(),k.value.toString())}l$n(){this.dV.select()}static vRh(b,k,r){if(!ef.mAe){const y=String.format('<a target="_blank" href="{0}">{1}</a>',A.a.xLc("https://office.com"),CommonUIStrings.l_Office),R=String.format('<a target="_blank" href="{0}">{1}</a>',A.a.xLc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);ef.mAe=String.format(CommonUIStrings.l_NoFrames,y,R)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
A.a.xLc(b),k,r,ef.mAe)}}ef.mAe=null;ef.pke="CheckboxChecked_16x16x32";ef.CLe="CheckboxUnchecked_16x16x32";ef.t_j="OutlookSearchChevronUp_16x16x32";ef.tDg="OutlookSearchChevronDown_16x16x32";ef.Yyg="CommentChecked";ef.Sxj="UpArrowServer";ef.SPb="EmbedDescription";ef.hVj="EmbedSectionHeader";ef.iVj="EmbedSectionName UIFontBold";ef.GFj="EmbedCodeFooter";ef.Xyg="EmbedOptionImage";ef.zSj="EmbedPreviewFrame";ef.RDj="EmbedCodeTextArea";ef.mVg="EmbedOption";ef.ZCj="EmbedDimensionSection";ef.Txj="EmbedArrowIcon";
ef.Rxj="WACGlyph EmbedArrowHolder";ef.Syg="EmbedCheckBoxHolder";ef.nVg="Option";ef.oVg="OptionImage";ef.cEg="EmbedCode";ef.bEg="EmbedCodeHeader";ef.HXg="Preview";ef.GXg="PreviewHeader";ef.pVg="Options";ef.wwg="Arrow";ef.Nkc="Check";ef.aEg="EmbedCodeFooter";Object(m.a)(ef,"EmbedDialog",yf.a,[]);class nm extends Js{constructor(b,k,r,y,R){super(b,k,r,y);this.WZa=R}}Object(m.a)(nm,"OptionInputInfo",Js,[]);class on extends ef{constructor(b,k){super(b,on.LK);this.v9=null;this.ymc=[];this.Imd=Object(u.a)(this,
this.z4n,"startOnOptionClickHandler");this.zVb=Object(u.a)(this,this.A4n,"startOnOptionKeyHandler");this.Yhd=Object(u.a)(this,this.uXm,"onPageNumberChanged");this.Gne=Object(u.a)(this,this.PTm,"onDimensionChanged");this.uG=k}Zec(){if(on.LK){var b=on.xin,k=[];k.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.uG.QHi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.uG.LMi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",
["checkboxInitialValue"]:!1,["checkboxLabel"]:this.uG.o9i,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.uG.p9i}});this.L6i({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.A$c,["defaultHeight"]:this.wQb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.uG.dnj,["heightLabel"]:this.uG.j6h},["interactionOptions"]:k})}else super.Zec(),this.b9g(this.uG.dnj,"EmbedWidthInput",this.A$c),this.b9g(this.uG.j6h,"EmbedHeightInput",this.wQb),this.msb.appendChild(this.xuh("wdPrint",
this.uG.QHi)),this.msb.appendChild(this.xuh("wdEmbedCode",this.uG.LMi)),this.S2j(this.uG.o9i),this.pWa(),Id.FocusManager.nJ()&&(b=Id.FocusManager.instance(),k=[document.getElementById(ef.cEg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(ef.wwg+ef.pVg),document.getElementById("wdPrint"+ef.Nkc),document.getElementById("wdEmbedCode"+ef.Nkc),document.getElementById("wdStartOn"+ef.Nkc),document.getElementById("wdStartOnText"),document.getElementById(ej.a.t6c),
document.getElementById(ef.GXg)],k=new We(k),b.Fs().Wj=k,X.a.mi?this.xU(document.getElementById(ej.a.t6c)):this.dV.select())}dispose(){if(!on.LK){if(this.ymc){for(let b=0;b<this.ymc.length;++b)Af.a.removeHandler(this.ymc[b],"change",this.Gne);this.ymc=this.Gne=null}this.Yhd&&(Af.a.removeHandler(this.v9.WZa,"change",this.Yhd),this.Yhd=null);this.Imd&&(this.oq.sc(Kb.a.click,this.v9.Aac,this.Imd),this.Imd=null);this.zVb&&(this.le.sc(Kb.a.ni,this.v9.Aac,this.zVb),this.le.sc(Kb.a.oh,this.v9.Aac,this.zVb),
this.zVb=null);this.v9=null}super.dispose()}b9g(b,k,r){const y=document.createElement("label");y.className="EmbedInputPrefix";y.innerText=b;this.cpb.appendChild(y);b=document.createElement("input");b.className=k;b.id=k;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");y.setAttribute("for",k);this.cpb.appendChild(b);this.ymc.push(b);Af.a.addHandler(b,"change",this.Gne);this.cpb.appendChild(document.createElement("br"))}PTm(b){"EmbedWidthInput"===b.target.id?this.A$c=this.eBd(b.target,
375):this.wQb=this.eBd(b.target,250);this.V8f()}eBd(b,k){let r=parseInt(b.value);if(isNaN(r)||r<k)r=k;b.value=r.toString();return r}uXm(b){b=this.eBd(b.target,1);1===this.v9.value&&this.ade("wdStartOn",b.toString())}S2j(b){const k=document.createElement("div");k.className=ef.mVg+" EmbedInlineOption";k.id="wdStartOn"+ef.nVg;const r=this.Gk.createElement("div");r.tabIndex=0;r.className=ef.Syg;r.id="wdStartOn"+ef.Nkc;r.setAttribute(Ef.a.Bh,Ef.a.mSe);r.setAttribute(Ef.a.Fza,Ef.a.rL);r.setAttribute(Ef.a.Fda,
"wdStartOn"+ef.SPb);k.appendChild(r);k.setAttribute(Ef.a.Bh,Ef.a.Gz);var y=ci.createClusteredImage(16,16,ef.Yyg,ef.Xyg,!0,"");r.appendChild(y);y=y.childNodes[0];y.id="wdStartOn"+ef.oVg;y.className=ci.getImageClass(ef.CLe);const R=document.createElement("span");R.className=ef.SPb;R.innerText=b;R.id="wdStartOn"+ef.SPb;k.appendChild(R);this.msb.appendChild(k);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.uG.p9i;b.setAttribute("data-lpignore",
"true");this.msb.appendChild(b);Af.a.addHandler(b,"change",this.Yhd);this.v9=new nm(k,y,r,0,b);this.ade("wdStartOn","1");this.oq.mb(Kb.a.click,k,this.Imd);this.le.mb(Kb.a.ni,k,this.zVb);this.le.mb(Kb.a.oh,k,this.zVb)}z4n(b){this.m9i(b);return!0}A4n(b){return this.gQc(b,Object(u.a)(this,this.m9i,"startOnOptionHandler"))}m9i(){let b=1;this.v9.value?(this.v9.value=0,this.v9.JZa.className=ci.getImageClass(ef.CLe),this.v9.GZd.setAttribute(Ef.a.Fza,Ef.a.rL)):(this.v9.value=1,this.v9.JZa.className=ci.getImageClass(ef.pke),
b=this.eBd(this.v9.WZa,1),this.v9.GZd.setAttribute(Ef.a.Fza,Ef.a.Jo));this.ade("wdStartOn",b.toString())}static get LK(){return n.AFrameworkApplication.ta.Rb.NA}static xin(b,k,r,y=null){if("wdPrint"===k||"wdEmbedCode"===k)return Oa.a.Ip(b,k,r?"1":"0");if("wdStartOn"===k){let R="1";r&&y&&(y=parseInt(y),!isNaN(y)&&1<=y&&(R=y.toString()));return Oa.a.Ip(b,k,r?R:"1")}return b}}Object(m.a)(on,"WordEmbedDialog",ef,[]);class Aa{constructor(b,k,r,y,R){this.Dca=null;this.ga=b;this.M7a=k;this.HO=r;this.uG=
y;this.ppa=R}Vb(){this.ga.pa(this.HO,zc.a.frame,Object(u.a)(this,this.tZn,"showEmbedCode"));this.M7a.execute(Object(u.a)(this,this.oHf,"onHostPostmessengerCreated"))}oHf(b){v.ULS.shipAssertTag(4994850,332,!!b);this.Dca=b;n.AFrameworkApplication.aua||(this.Dca.Av(E.a.blh),this.Dca.fC(E.a.blh,Object(u.a)(this,this.Zec,"showEmbedDialog")))}Zec(b){b=b.Values.HostEmbeddedViewUrl.toString();n.AFrameworkApplication.qLc=b;this.ppa.M6e=b;(new on(b,this.uG)).Zec()}tZn(b,k,r){if(2===r)if(n.AFrameworkApplication.qLc)(new on(this.ppa.M6e,
this.uG)).Zec();else return n.AFrameworkApplication.Hm.PZa(Aa.jqj),n.AFrameworkApplication.j$f&&this.Dca.sendMessage(E.a.C9k,null)?32:n.AFrameworkApplication.ta.f3(!0,n.AFrameworkApplication.l9e);return 32}}Aa.jqj=10381;Object(m.a)(Aa,"EmbedActor",null,[]);class Ta{}Object(m.a)(Ta,"WordEmbedDialogStrings",null,[]);var Da=c(267);class ya extends Aa{constructor(b,k){super(b,k,Jc.a.X0f,Object.assign(new Ta,{dnj:WordEditorIntl.WordEditorStrings.l_Width,j6h:WordEditorIntl.WordEditorStrings.l_Height,QHi:WordEditorIntl.WordEditorStrings.l_PrintOption,
LMi:WordEditorIntl.WordEditorStrings.l_ReembedOption,o9i:WordEditorIntl.WordEditorStrings.l_StartOnOption,p9i:WordEditorIntl.WordEditorStrings.l_StartPage}),Da.WoncaApp.instance)}}Object(m.a)(ya,"EmbedActor",Aa,[]);class $a{constructor(){this.W=null}get name(){return"WordEditor.Embed"}zc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new ya(n.AFrameworkApplication.ya,b.$a("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Vb()}dispose(){}}
Object(m.a)($a,"EmbedPackage",null,[1,2]);class Cb{constructor(b,k,r){this.uv=this.aHa=this.dJa=null;this.OGa=0;this.bSb=this.URb=this.LRb=this.kSb=this.FSa=this.ESa=!1;this.tj=b;this.Om=r}bO(b){return Ka.App.xa.jb.isEditingAllowed?""!==this.yIc(b.Af):!1}wK(b){if(!this.bO(b))return!1;this.SKn(b);this.TKn();this.UKn();this.dJa=b.pH;this.uv=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}dU(b){this.aHa=b.pH;this.Eqk();this.tj.Nij(this.uv.x,this.uv.y,this.kSb,
this.LRb,this.URb,this.bSb,!1);return!0}mD(){this.tj.Nij(this.uv.x,this.uv.y,this.kSb,this.LRb,this.URb,this.bSb,!0);v.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}sX(){this.tj.utk();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}TKn(){this.bSb=this.URb=this.LRb=this.kSb=!1;switch(this.OGa){case 1:this.kSb=!0;break;case 5:this.LRb=!0;break;case 3:this.bSb=!0;break;case 7:this.URb=!0;break;case 0:this.URb=this.kSb=!0;break;case 2:this.bSb=this.kSb=!0;break;case 6:this.URb=
this.LRb=!0;break;case 4:this.bSb=this.LRb=!0}}UKn(){this.FSa=this.ESa=!1;switch(this.OGa){case 0:this.FSa=this.ESa=!0;break;case 1:case 2:this.FSa=!0;break;case 7:case 6:this.ESa=!0}}yIc(b){var k=b.className;-1===k.indexOf("WACImageCropHandle")&&b.parentNode&&(k=b.parentNode.className);b=k.split(" ");for(k=0;k<b.length;k++){const r=b[k].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}SKn(b){switch(this.yIc(b.Af)){case "WACImageCropHandleNW":this.OGa=
0;break;case "WACImageCropHandleN":this.OGa=1;break;case "WACImageCropHandleNE":this.OGa=2;break;case "WACImageCropHandleE":this.OGa=3;break;case "WACImageCropHandleSE":this.OGa=4;break;case "WACImageCropHandleS":this.OGa=5;break;case "WACImageCropHandleSW":this.OGa=6;break;case "WACImageCropHandleW":this.OGa=7}}Eqk(){var b=1;this.Om.instance&&(b=this.Om.instance.vj);const k=(this.aHa.x-this.dJa.x)/b;b=(this.aHa.y-this.dJa.y)/b;this.uv.x=this.ESa?-k:k;this.uv.y=this.FSa?-b:b}}Object(m.a)(Cb,"ImageCropDragAdapter",
null,[199]);class Ub{constructor(b,k){this.ga=b;this.Om=k}Qwl(b){return new Cb(b,this.ga,this.Om)}}Object(m.a)(Ub,"ImageCropDragAdapterFactory",null,[435]);var fc=c(240),Gc=c(200),Kc=c(466),ed=c(695),$c=c(96),bd=c(66),Ad=c(441),Je=c(950),re=c(535),xe=c(886),De=c(134),jf=c(382),Me=c(261),Kf=c(853),af=c(211),Nf=c(93),bf=c(22),ui=c(297),gg=c(394),Wh=c(132);class Xh{constructor(b,k,r,y,R,aa,ta,Ya,xb=null){this.Wb=xb;this.JMc=null;this.IJ=b;this.Kh=k;this.Hc=r;this.yu=y;this.Yd=R;this.hb=aa;this.Km=ta;
this.Dy=Ya}get eW(){return null!=this.Ihg?this.Ihg:this.Ihg=Va.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get oc(){return null!=this.tug?this.tug:this.tug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Ue(){return De.PageReader.instance}iNn(b,k,r){const y=this.Hc.Rc(15);y.Eb(k.node);this.TPa(b,r);y.dispose()}hNn(b,k,r){const y=this.Hc.Rc(15);y.Eb(k.node);this.fKb(b,r);y.dispose()}TPa(b,k){b.setValue(Te.a.imageAltText,k)}fKb(b,k){b.setValue(wc.a.PW,k)}pNn(b,k){b.setValue(Te.a.jfb,
k)}Z_i(b,k){b.setValue(wc.a.QW,k)}lNn(b,k,r,y,R){let aa=0;var ta=0;({width:aa,height:ta}=Pd.ImageReader.KAb(b));ta-=(k+r)/1E5*ta;this.hwa(b,aa-(y+R)/1E5*aa);this.gwa(b,ta);this.r0i(b);b.setValue(wc.a.zCb,k);b.setValue(wc.a.wCb,r);b.setValue(wc.a.xCb,y);b.setValue(wc.a.yCb,R)}dRn(b,k,r,y){const R=this.Hc.Rc(15);R.Eb(k.node);this.K6d(b,r,y);R.dispose()}K6d(b,k,r){this.hwa(b,k);this.gwa(b,r);this.r0i(b);b.removeProperty(td.a.d0d);b.removeProperty(td.a.c0d)}hwa(b,k){b.setValue(Te.a.Ffa,k);b.setValue(td.a.ZBa,
-1)}gwa(b,k){b.setValue(Te.a.Uma,k);b.setValue(td.a.YBa,-1)}tD(b,k){b.setValue(wc.a.lLc,k);b.setValue(Te.a.Zh,k);b.setValue(Te.a.Dq,k)}SRn(b,k){b.setValue(wc.a.ZLb,k)}SJn(b,k){b.setValue(wc.a.vTe,k)}WRn(b){if(!Pd.ImageReader.laa(b)&&b.Xk){var k=b.node;if(Pd.ImageReader.G6(k)){const R=this.Hc.Rc(15);R.Eb(b.node);b=Wd.GraphIterator.Za(k);b.Ab(12);b=b.parentNode;var r=b.properties.wg(wc.a.Iq),y=k.properties.getValue(wc.a.runId);k.ia(wc.a.Nc,ml.a.jR);const aa=b.qa;k.Vg.apply(k,[wc.a.lLc,Te.a.Zh,Te.a.Dq,
wc.a.vTe,wc.a.ZLb,wc.a.NVa]);r=this.ndf(y,r,aa);y=Re.a.Uc(b,r);this.yu.g_e(k,y);(k=this.Dy.DN(b,r,r+1))&&this.hb.setSelection(k);this.eW.loa(b,r,r+1);R.dispose()}}}TXf(b,k){if(b.properties.hasProperty(wc.a.D5)){const r=b.properties.wg(wc.a.D5);r.push(k);b.properties.setValue(wc.a.D5,Array.clone(r))}else b.properties.setValue(wc.a.D5,[k])}T7d(b,k,r=0,y=!1){if(b.Xk){var R=this.Hc.Rc(15),aa=b.node;R.Eb(aa);if(Pd.ImageReader.laa(b)){const Mb=this.Wb&&this.Wb.isFeatureEnabled(46)?new xe.a:new re.a;Mb.Bs(Pd.ImageReader.Sm(b));
var ta=aa.qa,Ya=this.lal(b.cpBegin,ta);this.kgk(b.cpEnd,ta,Ya)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ta=ta.J(Ya).blob;Ya=ta.Ge;var xb=aa.properties.wg(wc.a.Iq);xb=this.Uhn(xb);Ya=xb[Ya];xb=aa.ia(wc.a.Nc,ml.a.jR);if(ta=Object(ia.a)(Je.ImageBlobObject,ta))ta.FKb=!1;this.Yd.replaceTextRange(b,"");ta&&(ta.FKb=!0);Mb.properties.setValue(wc.a.runId,Ya);Mb.properties.setValue(wc.a.Nc,xb);b=Wd.GraphIterator.Za(aa);b.Ab(12);b.Rf(Mb,6);this.TXf(b.currentNode,
Mb.anchor.node.id);aa=Mb}r&&this.tD(aa.properties,r);this.SJn(aa.properties,y);this.SRn(aa.properties,k);this.eW.bec(aa);(k=this.Dy.Sq(aa))&&this.hb.setSelection(k);R.dispose()}}CWf(b,k){if(!(0>=k)){var r=Vf.a.rn(k,0),y=Pd.ImageReader.mE(b),R=Pd.ImageReader.AF(b);y>r&&(R*=r/y,this.hwa(b,r),this.gwa(b,R),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",k))}}kgk(b,k,r){const y=k.length;if(r>=y||!k.J(r).Hf)return!1;const R=new $m.a;for(;r<y;r++){const aa=
k.J(r);if(aa.cp>b||!aa.Hf)break;for(let ta=0;ta<aa.Hf.length;ta++){if(R.contains(aa.Hf.J(ta).Rj))return!0;R.add(aa.Hf.J(ta).Rj)}}return!1}Uhn(b){for(var k=0;k<b.length&&!b[k];)k++;if(k===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var y=b[k];r=k-1;for(var R=y-1;0<=r;)b[r]=R,r--,R--;R=0;for(r=k+1;r<b.length;)(k=b[r])?k<y?(y=k+R,b[r]=y):y=k:(R+=2,y++,b[r]=y),r++}return b}W9e(b,k){let r=0;for(;r<k.length&&!(b<k[r]);)r++;return r}ndf(b,k,r){let y=0;const R=this.W9e(b,k);let aa=0;if(R===k.length)aa=
r.length-1;else for(;aa<r.length;){k=r.J(aa);if(k.formatting&&k.formatting.Ge===R)break;aa++}aa<r.length?y=r.J(aa).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:aa,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return y}lal(b,k){let r=0;for(;r<k.length&&k.J(r).cp!==b;)r++;r===k.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:r,["CharacterPropertiesArrayLength"]:k.length});
return r}r0i(b){b.setValue(Te.a.wfa,!0)}F0d(b,k,r,y=!1){k&&r?(k=Math.max(k,ed.a.Nsi),r=Math.max(r,ed.a.Nsi)):r=k=ed.a.Qyh;b.setValue(Te.a.Ffa,Vf.a.rn(k,0));b.setValue(Te.a.Uma,Vf.a.rn(r,1));b.setValue(Te.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Hk.a.HZ,1);b.setValue(wc.a.vfa,y)}YMd(){return null}fCh(b,k,r){let y=null;k=({oGb:y}=this.gCh(b,k,r)).returnValue;y&&b.view.Cb.setSelection(y);return k}gCh(b,k,r){var y=null;if(!this.Nda(b))return{returnValue:null,oGb:y};var R=b.view;
const aa=this.Hc.Rc(15,Wa.a.TCb);aa.Eb(R.ld);k||(k=new Di.DictionaryPropertySet);k.setValue(td.a.K0k,!0);let ta=R.Cb.Jg;var Ya=new Kf.a;if(!rf.SelectionEditor.zf(ta)){if(2===n.AFrameworkApplication.ya.processAction(Wa.a.Oka,2))return aa.dispose(),{returnValue:null,oGb:y};ta=R.Cb.Jg}else if(ta.Xk&&ie.ParagraphReader.nc(ta.node)){gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(ta.node);R=Kk.FormattingReader.Qr(ta);if(!R)return aa.dispose(),{returnValue:null,oGb:y};R.cache.MA&&(R=R.Yf(null),Xh.wi.BX(R));
Ya.formatting=R.Bj;Ya.languageId=Kk.FormattingReader.language(R);gh.a.instance.J(10)&&(Ya.Uwa=this.oc.Ao(ta.node))}if(!ta.Xk)return aa.dispose(),{returnValue:null,oGb:y};if(!this.Jof(b.rk,k))return aa.dispose(),this.JMc=null,{returnValue:null,oGb:y};b=this.JMc;this.JMc=null;1===b.location?(y=b.node,k=gg.a.instance.vjf(y),xg.OutlineElementNavigator.Wr(k,!1,!1)||(af.OutlineNavigator.a5d(k),this.IJ.E5(k,!0,Ya)),xg.OutlineElementNavigator.Fe(k),Si.TableReader.isTable(k)&&(Object(Jb.a)(Wh.a,k)||Object(Jb.a)(jf.a,
k)?(Ya=new Wd.GraphIterator,Ya.set(k.currentNode),bf.moveToCellContent(Ya,0,0),k.set(Ya.currentNode)):bf.moveToCellContent(k,0,0),Ag.OutlineElementReader.Nh(k)?xg.OutlineElementNavigator.Fe(k):k=gg.a.instance.vjf(y)),y=ie.ParagraphReader.Cu(k.currentNode)?this.Dy.xe(k.currentNode,0):this.Dy.Sq(k.currentNode)):b.location||(Ya=b.blob.Ob.cp+1,y=this.Dy.DN(b.node,Ya-1,Ya));aa.dDa(r,1);aa.Al=Wa.a.TCb;aa.dispose();return{returnValue:b,oGb:y}}Jof(){return!1}Nda(b){b.contextId===lc.a.view&&b.view.ye&&b.view.Cb&&
(b=b.view.Cb.Jg);if(!b)return Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.noSelection}),!1;if(Xh.ag.mZ(b))return Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dE}),!1;if(Xh.ag.fua(b))return Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.q$h}),!1;if(this.Km&&this.Km.instance&&this.Km.instance.KT(b))return Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.externalSelection}),!1;if(this.Ue.G2)return Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.compatMode}),!1;if(b.Xk)return Nf.OutlineReader.XPd(b)?(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.FZe}),!1):Pd.ImageReader.UOd(b)?
(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.xZe}),!1):ui.c(b)?(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.yZe}),!1):Me.a.grf(b)?(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.wZe}),!1):ie.ParagraphReader.HT(b)||Pd.ImageReader.oam(b)?(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),!1):!0;if(Ad.a.xsf(b)){let k=!0;for(let r=0;r<b.length;++r){const y=b.getContext(r);if(!y.Xk)return!1;k&&!ie.ParagraphReader.HT(y)&&(k=!1)}return k?(Xh.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),!1):!0}return!1}BPi(b,k){const r=this.Hc.Rc(7);r.Eb(b);if(12===b.type){k=
k.Ob.cp;var y=ie.ParagraphReader.textLength(b);y=Re.a.vL(k,k+1,k+1===y?!0:!1,b);this.Yd.replaceTextRange(y,"");b=Re.a.Uc(b,k);this.hb.setSelection(Ke.SelectionFactory.fo(b))}else this.Kh.kPa(b);r.dispose()}static get wi(){return null!=Xh.mlg?Xh.mlg:Xh.mlg=Va.a.instance.resolve("Box4.IFormattingEditor")}static get ag(){return mh.a.instance}static get Kc(){return Db.a.instance}}Object(m.a)(Xh,"ImageEditor",null,[434]);class Ch{constructor(b,k,r,y=0){this.node=b;this.blob=k;this.location=r;this.BT=y}}
Object(m.a)(Ch,"InsertPictureResult",null,[]);var zk=c(809),Fl=c(298),gj=c(1167);class wj extends Xh{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd){super(b,k,r,y,R,aa,ta,Ya,fd);this.YBj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.A6a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.vJ=this.FHa=this.Kxa=null;this.gia=Array(8);this.ycd=this.dya=null;this.GHa=!1;this.xcd=this.Zse=null;this.d9c=this.i$c=!1;this.XR=this.WR=this.VR=this.YR=this.aV=this.$U=this.ZU=this.bV=this.pV=this.qV=0;this.j_=()=>{this.GHa&&this.e7e()};this.bva=Td=>{this.GHa&&Td.Ib.keyCode!==tb.a.hs&&this.e7e(!0);return!1};this.LJg=Mc;aa.tB(this.j_);this.le=jc;this.K0=fc.a.instance;this.ga=n.AFrameworkApplication.ya;this.Jd=Mb;this.$m=xb;this.Ic=fd}Z6d(b,k,r,y,R){b.hasProperty(td.a.JNa)&&b.removeProperty(td.a.JNa);
const aa=Array(4);aa[0]=k;aa[1]=r;aa[2]=y;aa[3]=R;b.setValue(wc.a.t3,aa)}Nrn(b){b.setValue(wc.a.$Ba,0);b.setValue(wc.a.CHb,"");this.Z6d(b,0,0,0,0)}RYf(b,k,r,y,R){b.setValue(wc.a.zCb,k);b.setValue(wc.a.wCb,r);b.setValue(wc.a.xCb,y);b.setValue(wc.a.yCb,R)}a7d(b,k,r,y){b.setValue(wc.a.jK,k);b.setValue(wc.a.RKc,r);b.setValue(wc.a.$Kc,y);b.setValue(td.a.jK,-1)}WMd(b,k){b=b.node;const r=Wd.GraphIterator.Za(b);if(ie.ParagraphReader.nc(b)&&ie.ParagraphReader.isEmpty(r)){var y=b.properties.wg(wc.a.Nc);k.setValue(wc.a.Nc,
y);k.setValue(wc.a.runId,1);y=new gj.a;k&&y.Bs(k);r.Rf(y,6);this.TXf(b,y.anchor.node.id);this.eW.bec(y);return new Ch(y,null,3)}return null}YMd(b,k){var r=zk.a.instance.M5c;k&&r.Bs(k);r.setValue(wc.a.imageType,1);let y=0;gh.a.instance.J(5)&&(y=Gc.a.ZF(),r.setValue(wc.a.BT,y));const R=b.node.Mc.Lu(r,r.id);r=this.Yd.ifa(b,aa=>new Je.ImageBlobObject(aa,R));Fl.GraphTransactionManager.instance.XGf(b.node);if(this.Jd.og){const aa=new sf.GraphTransaction(15);aa.Eb(b.node);this.$m.toa(b.node,b.cpBegin,b.cpBegin+
1,1,null);aa.dispose()}this.eW.ZJa&&!k.ia(wc.a.vfa,!1)&&this.eW.loa(b.node,b.cpBegin,b.cpBegin+1);return new Ch(b.node,r,0,y)}Jof(b,k){if(!this.Nda(b))return!1;const r=this.Hc.Rc(7);r.Eb(b.node);n.AFrameworkApplication.K.$("ContentAppIsEnabled")&&k.ia(wc.a.lbi,!1)?this.JMc=this.WMd(b,k):this.JMc=this.YMd(b,k);r.dispose();return!0}ucc(b,k,r,y){if(!r.nc(b))return!1;r=this.Hc.Rc(7,Wa.a.XSl);r.Eb(b);var R=b.properties.ia(Te.a.km,[]);R.push(0);for(let aa of R)if((R=y.Zbf(b,aa))&&5===R.li&&R.id.equals(k))return this.Yd.replaceTextRange(Re.a.createTextRange(b,
aa,aa+1),""),r.dispose(),!0;r.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}brn(b,k,r,y){if(!Pd.ImageReader.G6(b))return!1;k.set(b);k.Ab(12);const R=k.gp(12);if(!R)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.HOc(R))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;y(b);r=this.Hc.Rc(7);r.Eb(b);k.Hg();r.dispose();return!0}Lwn(b,k,r,y){return Pd.ImageReader.k_a(b)?this.xwn(b,r):Pd.ImageReader.laa(b)?this.Own(b,k,r,y):null}Own(b,k,r,y){const R=zk.a.instance.M5c;r&&R.Bs(r);r=0;gh.a.instance.J(5)&&(r=Gc.a.ZF(),R.setValue(wc.a.BT,r));r=b.node.Mc;b=b.node;y=y.yHc(b,5);for(let aa of y)if(aa.id.equals(k)){this.Yd.replaceTextRange(Re.a.createTextRange(b,aa.Ob.cp,aa.Ob.cp+1),"");const ta=r.Lu(R,R.id);k=Re.a.Uc(b,aa.Ob.cp);this.Yd.ifa(k,Ya=>new Je.ImageBlobObject(Ya,
ta));return R}return null}xwn(b,k){if(!Pd.ImageReader.k_a(b))return null;gh.a.instance.J(5)&&k.setValue(wc.a.BT,Gc.a.ZF());b=b.node;var r=b.anchor.node.id;b=Wd.GraphIterator.Za(b);b.Ab(12);const y=b.parentNode;let R;y.properties.hasProperty(wc.a.D5)?(R=y.properties.wg(wc.a.D5),r=G.a.indexOf(R,r),-1!==r&&Array.removeAt(R,r)):R=[];y.properties.setValue(wc.a.D5,Array.clone(R));b.Hg();r=this.Ic&&this.Ic.isFeatureEnabled(46)?new xe.a:new re.a;r.Bs(k);b.Rf(r,6);this.TXf(y,r.anchor.node.id);return r}A2c(b,
k){this.GHa?this.e7e():this.b4n(b,k)}rNn(b,k){b.setValue(td.a.jK,k)}Vwl(b){let k=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:k,Mi:r};if(!Bb.InteractiveViewManager.instance.yd)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:k,Mi:r};const y=b.node;if(!y)return v.ULS.sendTraceTag(22381056,322,
15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:k,Mi:r};r=y.Mc;const R=y.Be(Bb.InteractiveViewManager.instance.yd.Sb);if(!R)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:k,Mi:r};k=R.Ng;if(b.Xk&&Pd.ImageReader.laa(b)){b=Pd.ImageReader.tBa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),
{returnValue:null,view:k,Mi:r};b=b.XYa(k);if(!b)return v.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:k,Mi:r};b=b.element}else if(Pd.ImageReader.Ov(y))b=R.htmlElement;else return v.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:k,Mi:r};return{returnValue:b,view:k,Mi:r}}qTn(b){for(let y=0;y<
this.gia.length;y++){this.gia[y]=b.xk(tk.a.span);this.gia[y].className="WACImageCropHandles "+this.YBj[y];if(2>=y){var k=b.xk(tk.a.span);k.className=this.A6a[0];var r=b.xk(tk.a.span);r.className=this.A6a[1];this.gia[y].appendChild(k);this.gia[y].appendChild(r)}else 4<y&&(k=b.xk(tk.a.span),k.className=this.A6a[2],r=b.xk(tk.a.span),r.className=this.A6a[3],this.gia[y].appendChild(k),this.gia[y].appendChild(r));if(!y||3===y||5===y)k=b.xk(tk.a.span),k.className=this.A6a[4],r=b.xk(tk.a.span),r.className=
this.A6a[5],this.gia[y].appendChild(k),this.gia[y].appendChild(r);else if(2===y||4===y||7===y)k=b.xk(tk.a.span),k.className=this.A6a[6],r=b.xk(tk.a.span),r.className=this.A6a[7],this.gia[y].appendChild(k),this.gia[y].appendChild(r)}}b4n(b,k){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.GHa)v.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,y=null;if((this.dya=({view:r,Mi:y}=this.Vwl(k)).returnValue)&&r){this.dya.classList.add("ImageCropMode");
this.Kxa=r.xk(tk.a.div);this.Kxa.className="WACImageCropMode";this.FHa=r.xk(tk.a.KZa);this.FHa.className="WACImageCropBase";this.vJ=r.xk(tk.a.span);this.vJ.className="WACImageCropSrcRect";this.qTn(r);this.Kxa.appendChild(this.vJ);for(r=0;r<this.gia.length;r++)this.vJ.appendChild(this.gia[r]);this.Kxa.appendChild(this.FHa);this.FHa.style.visibility="";this.FHa.style.display="";this.dya.appendChild(this.Kxa);this.P8m(b);y=Pd.ImageReader.BBa(b,y);r=Pd.ImageReader.a4(b,td.a.una,null);this.FHa.src=r?r:
Pd.ImageReader.MAb(y);this.LJg&&this.LJg.execute(R=>{this.ycd||(this.ycd=R.Qwl(this))});this.i$c||(this.K0.nO(this.dya,this.ycd),this.i$c=!0);this.le&&this.le.mb(Kb.a.aI,Bb.InteractiveViewManager.instance.editingView.editingElement,this.bva);this.GHa=!0;this.Zse=b;this.xcd=k;this.d9c=!1;b=new sf.GraphTransaction(4);b.Eb(this.xcd.node);this.Zse.setValue(td.a.dua,this.GHa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}P8m(b){const k=
Vf.a.uf(Pd.ImageReader.mE(b),0),r=Vf.a.uf(Pd.ImageReader.AF(b),1),y=Math.max(Pd.ImageReader.Fla(b),0),R=Math.max(Pd.ImageReader.Cla(b),0),aa=Math.max(Pd.ImageReader.Dla(b),0),ta=Math.max(Pd.ImageReader.Ela(b),0);this.qV=1E5*k/(1E5-(aa+ta));this.pV=1E5*r/(1E5-(y+R));this.bV=Math.floor(y*this.pV/1E5);this.ZU=Math.floor(R*this.pV/1E5);this.$U=Math.floor(aa*this.qV/1E5);this.aV=Math.floor(ta*this.qV/1E5);this.vJ.style.top=this.bV+"px";this.vJ.style.bottom=this.ZU+"px";this.vJ.style.left=this.$U+"px";
this.vJ.style.right=this.aV+"px";this.FHa.style.width=this.qV+"px";this.FHa.style.height=this.pV+"px";Pd.ImageReader.Xx(b)&&(this.Kxa.style.width=this.qV+"px",this.Kxa.style.height=this.pV+"px");this.YR=this.bV;this.VR=this.ZU;this.WR=this.$U;this.XR=this.aV}e7e(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.GHa?(b||this.$Ck(),this.FHa?Fd.a.rA(this.FHa):v.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.dya?
(this.Kxa?this.Kxa.parentNode===this.dya?this.dya.removeChild(this.Kxa):v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.dya.classList.remove("ImageCropMode"),this.GHa=!1,b=new sf.GraphTransaction(4),b.Eb(this.xcd.node),this.Zse.setValue(td.a.dua,this.GHa),b.dispose(),this.i$c&&(this.K0.EO(this.dya,this.ycd),
this.i$c=!1),this.le&&this.le.sc(Kb.a.aI,Bb.InteractiveViewManager.instance.editingView.editingElement,this.bva),this.dya=this.Kxa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}Nij(b,k,r,y,R,aa,ta){if(r){r=Math.max(this.bV-k,0);let Ya=Math.floor(this.pV)-this.ZU-r;5<=Ya?(this.YR=r,this.VR=this.ZU):5>Ya&&
0<=Ya||0>Ya&&!this.ZU?(this.YR=r-(5-Ya),this.VR=this.ZU):0>Ya&&5>=Math.abs(Ya)?(this.YR=Math.floor(this.pV)-this.ZU,this.VR=Math.max(this.ZU-(r-(this.pV-this.ZU))-(5-Math.abs(Ya)),0)):(this.YR=Math.floor(this.pV)-this.ZU,this.VR=Math.max(this.ZU-(r-(this.pV-this.ZU)),0));this.vJ.style.top=this.YR+"px";this.vJ.style.bottom=this.VR+"px";ta&&(this.bV=this.YR,this.ZU=this.VR)}y&&(k=Math.max(this.ZU-k,0),y=Math.floor(this.pV)-this.bV-k,5<=y?(this.VR=k,this.YR=this.bV):5>y&&0<=y||0>y&&!this.bV?(this.VR=
k-(5-y),this.YR=this.bV):0>y&&5>=Math.abs(y)?(this.VR=Math.floor(this.pV)-this.bV,this.YR=Math.max(this.bV-(k-(this.pV-this.bV))-(5-Math.abs(y)),0)):(this.VR=Math.floor(this.pV)-this.bV,this.YR=Math.max(this.bV-(k-(this.pV-this.bV)),0)),this.vJ.style.top=this.YR+"px",this.vJ.style.bottom=this.VR+"px",ta&&(this.bV=this.YR,this.ZU=this.VR));R&&(R=Math.max(this.$U-b,0),k=Math.floor(this.qV)-this.aV-R,5<=k?(this.WR=R,this.XR=this.aV):5>k&&0<=k||0>k&&!this.aV?(this.WR=R-(5-k),this.XR=this.aV):0>k&&5>=
Math.abs(k)?(this.WR=Math.floor(this.qV)-this.aV,this.XR=Math.max(this.aV-(R-(this.qV-this.aV))-(5-Math.abs(k)),0)):(this.WR=Math.floor(this.qV)-this.aV,this.XR=Math.max(this.aV-(R-(this.qV-this.aV)),0)),this.vJ.style.left=this.WR+"px",this.vJ.style.right=this.XR+"px",ta&&(this.$U=this.WR,this.aV=this.XR));aa&&(b=Math.max(this.aV-b,0),aa=Math.floor(this.qV)-this.$U-b,5<=aa?(this.XR=b,this.WR=this.$U):5>aa&&0<=aa||0>aa&&!this.$U?(this.XR=b-(5-aa),this.WR=this.$U):0>aa&&5>=Math.abs(aa)?(this.XR=Math.floor(this.qV)-
this.$U,this.WR=Math.max(this.$U-(b-(this.qV-this.$U))-(5-Math.abs(aa)),0)):(this.XR=Math.floor(this.qV)-this.$U,this.WR=Math.max(this.$U-(b-(this.qV-this.$U)),0)),this.vJ.style.left=this.WR+"px",this.vJ.style.right=this.XR+"px",ta&&(this.$U=this.WR,this.aV=this.XR));ta&&(this.d9c=!0,Ka.App.xa.updateCommandUI())}utk(){this.YR=this.bV;this.VR=this.ZU;this.WR=this.$U;this.XR=this.aV;this.vJ.style.top=this.YR+"px";this.vJ.style.bottom=this.VR+"px";this.vJ.style.left=this.WR+"px";this.vJ.style.right=
this.XR+"px"}$Ck(){if(this.d9c){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.bV/this.pV),k=Math.floor(1E5*this.ZU/this.pV),r=Math.floor(1E5*this.$U/this.qV),y=Math.floor(1E5*this.aV/this.qV),R=new Di.DictionaryPropertySet;R.setValue(td.a.rfb,b);R.setValue(td.a.ofb,k);R.setValue(td.a.pfb,r);R.setValue(td.a.qfb,y);this.ga.Vf(this.xcd,Jc.a.f8h,2,!1,null,R)}else v.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}dua(){return this.GHa}eql(){return{top:this.YR,
bottom:this.VR,left:this.WR,right:this.XR}}Ylo(b,k){if(0>b)v.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(k){case 0:this.bV=this.YR=Math.min(Math.floor(this.pV)-this.VR-5,b);this.vJ.style.top=this.YR+"px";break;case 1:this.ZU=this.VR=Math.min(Math.floor(this.pV)-this.YR-5,b);this.vJ.style.bottom=this.VR+"px";break;case 2:this.$U=this.WR=Math.min(Math.floor(this.qV)-this.XR-5,b);this.vJ.style.left=this.WR+"px";break;case 3:this.aV=this.XR=Math.min(Math.floor(this.qV)-
this.WR-5,b),this.vJ.style.right=this.XR+"px"}this.d9c=!0}}}Object(m.a)(wj,"ImageEditor",Xh,[433,434]);class Rm{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}zc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Ub(n.AFrameworkApplication.ya,Va.a.instance.$a("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new wj(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.$a("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),bc.KeyInputManager.instance,b.$a("WordEditor.IImageCropDragAdapterFactory"),b.Pa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){M.a.instance.Pc(new Rm)}}
Object(m.a)(Rm,"WordEditorImageEditorsPackage",null,[1,2]);class lp{}Object(m.a)(lp,"FolderContentEditor",null,[1343]);class jo{}Object(m.a)(jo,"PageEditor",null,[1240]);var lk=c(183);class um extends jo{constructor(){super()}get qh(){return lk.PageNavigator.instance}}Object(m.a)(um,"PageEditor",jo,[]);class pn{get name(){return"WordEditor.NotebookLevelEditors"}zc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new lp).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new um).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){M.a.instance.Pc(new pn)}}Object(m.a)(pn,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class jq{get ZHb(){return n.AFrameworkApplication.rjb}$ra(){v.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Qe.a.Gm(this.ZHb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(jq,"PrivacyLinkHandler",null,[775]);class vo{constructor(b,k){this.aBe=null;this.xVj=b;this.wVj=
k}showDialog(b){this.aBe=b;this.wVj.create().Vh(Object(u.a)(this,this.tUl,"handleDialog"))}tUl(b){1===b&&this.xVj.EYi();this.aBe();this.aBe.prototype}}Object(m.a)(vo,"SendUsYourFileController",null,[760]);class Gp extends cf.StandardDialog{constructor(b,k,r){super();this.bUb=null;this.kg=b;this.$tc=k;this.uG=r}Vh(b){this.Gd=1;this.We(1,this.uG.send);this.We(0,this.uG.aOm);v.ULS.shipAssertTag(37034013,342,!this.bUb,"privacy anchor should be null before initializing it.");const k=this.jXk();this.Mhb(this.uG.edk,
null,"CancelRequest_32x32x32",null,b,k);this.J3(this.pj(Gp.LYi))}jXk(){const b=document.createElement("span");b.innerText=this.uG.Man;const k=document.createElement("span");k.innerText=this.uG.Z9n;k.style.fontWeight=this.uG.kro;const r=document.createElement("span");r.innerText=this.uG.FIn;const y=this.bFk(),R=document.createElement("span");R.id=this.pj(Gp.LYi);R.appendChild(b);R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));R.appendChild(k);R.appendChild(document.createElement("br"));
R.appendChild(r);R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));R.appendChild(y);return R}bFk(){const b=document.createElement("span"),k=document.createElement("a");k.innerText=this.uG.uan;k.href=this.$tc.ZHb||"";b.appendChild(k);this.bUb=k;this.kg.mb(Kb.a.click,this.bUb,Object(u.a)(this.$tc,this.$tc.$ra,"clickHandler"));return b}dispose(){this.bUb&&(this.kg.sc(Kb.a.click,this.bUb,Object(u.a)(this.$tc,this.$tc.$ra,
"clickHandler")),this.bUb=null);super.dispose()}}Gp.LYi="sendUsYourFileId";Object(m.a)(Gp,"SendUsYourFileDialog",cf.StandardDialog,[774]);class Zn{create(){return Va.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(m.a)(Zn,"Factory",null,[773]);var mp=c(588);class $n extends mp.a{constructor(){super();this.FileId=null}Tl(){return 38}static construct(b){const k=new $n;k.FileId=b;return k}}Object(m.a)($n,"CreateSendUsYourFileRequest",mp.a,[]);var Er=c(1057);class Tp{constructor(b,
k,r){this.hca=b;this.MR=k;this.nNj=r}EYi(b=!1){if(this.MR){const k=$n.construct(this.MR()),r=new Er.a;r.Zr=k;r.status=1;r.mH="BootErrorReport";b=b?this.hca(null):this.hca(y=>{this.QYc(r,y)});b.QJ(r);b.qW();this.nNj()}}QYc(b){5===b.statusCode&&this.EYi(!0)}}Object(m.a)(Tp,"SendUsYourFileManager",null,[759]);class Zr{constructor(b,k){this.W=null;this.uG=b;this.MR=k}zc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.uG).singleInstance();this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",
()=>new Gp(Sf.a.instance,new jq,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Tp(k=>this.sla(0,k),this.MR,()=>{v.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const k=new Zn;return new vo(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),k)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}
Object(m.a)(Zr,"SendUsYourFilePackageManager",null,[]);var bt=c(564),lr=c(999),os;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(os||(os={}));Object(m.b)("AppMode",os);class ps{get edk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get aOm(){return CommonUIStrings.l_NoThanks}get Man(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get Z9n(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get kro(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get FIn(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get uan(){return CommonUIStrings.l_PrivacyStatement}}
Object(m.a)(ps,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Em extends Zr{constructor(){super(new ps,()=>n.AFrameworkApplication.rootQuerySignature)}sla(b,k){return new lr.a(b,k,"SendUsYourFile.ashx",os.word,Ka.App.webServiceBase,void 0,void 0,bt.a.amIAlone,bt.a.DTi,bt.a.GSi)}get name(){return"WordEditor.SendUsYourFile"}static main(){M.a.instance.Pc(new Em)}}Object(m.a)(Em,"PackageManager",Zr,["__INTERFACE__@1js/msoserviceplatform:IPackage",
"__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var Io=c(657),$r=c(662),kq=c(444);class Nq extends kq.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(m.a)(Nq,"IconGalleryButtonProps",kq.a,[]);var qn=c(131),Ei=c(30),Bq=c(166),Uo=c(76),Ti=c(762),Pf=c(158),Wj=c(971);class $k{constructor(b,k,r,y,R,aa){this.dMh=b;this.gallerySectionId=k;this.G7k=r;this.wbk=y;this.commandId=R;this.queryCommandId=aa}}
Object(m.a)($k,"BorderStyleMenuPropsArguments",null,[]);class Ye{constructor(b,k,r,y,R,aa,ta){this.CYb=b;this.n$i=k;this.width=r;this.hwi=y;this.height=R;this.rmi=aa;this.altText=ta}}Object(m.a)(Ye,"TableBorderStyleProperties",null,[]);class wg{constructor(){this.Ahh=[new Ye(wg.Z7i,"","2",1,8,0,"Solid Line"),new Ye(wg.hyh,"5,3","1",1,8,0,"Dashed Line"),new Ye(wg.dDh,"1,1","1",1,8,0,"Dotted Line"),new Ye(wg.fDh,"","1",2,8,3,"Double Line")];this.Bhh=[new Ye(wg.Ihh,"","1",1,8,0,"0.25pt"),new Ye(wg.Fhh,
"","1",1,8,0,"0.5pt"),new Ye(wg.Lhh,"","2",1,8,0,"0.75pt"),new Ye(wg.Ghh,"","2",1,8,0,"1pt"),new Ye(wg.Ehh,"","3",1,8,0,"1.5pt"),new Ye(wg.Mhh,"","4",1,8,0,"2.25pt"),new Ye(wg.Khh,"","4",1,8,0,"3pt"),new Ye(wg.Dhh,"","5",1,8,0,"4.5pt"),new Ye(wg.Jhh,"","6",1,8,0,"6pt")]}initialize(){this.eon()}ehl(){const b=new $k("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Ahh,Wa.a.Mkb,Wa.a.VPf);return this.yMh(b)}fhl(){const b=new $k("Line Weight gallery","DefaultLineWeightOptions",
"LineWeightOptionsGallery",this.Bhh,Wa.a.Nkb,Wa.a.WPf);return this.yMh(b)}hOh(b){switch(b){case wg.Z7i:return Pf.a.DYb;case wg.hyh:return Pf.a.Hab;case wg.dDh:return Pf.a.Uzc;case wg.fDh:return Pf.a.P1;default:return Pf.a.Ura}}iOh(b){switch(b){case wg.Ihh:return Pf.a.Hhh;case wg.Fhh:return Pf.a.aUe;case wg.Lhh:return Pf.a.AYb;case wg.Ghh:return Pf.a.Gab;case wg.Ehh:return Pf.a.Zja;case wg.Mhh:return Pf.a.Mza;case wg.Khh:return Pf.a.Kda;case wg.Dhh:return Pf.a.aWa;case wg.Jhh:return Pf.a.Lza;default:return Pf.a.bF}}yMh(b){const k=
new Ci.a,r=new oi.a,y=Object.assign(new $r.a,{Id:b.dMh,ExternalId:b.gallerySectionId,ExternalGalleryId:b.G7k,Type:4,Width:1,GalleryItems:[]});for(let aa of b.wbk){var R={};const ta={};ta.width=wg.Gtm;ta.height=wg.Ftm;R.root=ta;R=Object.assign(new Nq,{Id:aa.CYb,ExternalId:String.format("{0}_GalleryButton",aa.CYb),Icon:aa.CYb,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:aa.CYb,FullIconStyle:R,ShouldSetTitle:"true",Alt:aa.altText});y.GalleryItems.push(R)}r.ControlList=
[];k.MenuSectionList=[];r.ControlList.push(y);k.MenuSectionList.push(r);k.UpdateDynamically=!0;return k}eon(){const b={};for(let k of this.Ahh)b[k.CYb]=appChrome.buildBorderStyleIcon(k.n$i,k.width,k.hwi,k.height,k.rmi);for(let k of this.Bhh)b[k.CYb]=appChrome.buildBorderStyleIcon(k.n$i,k.width,k.hwi,k.height,k.rmi);appChrome.api.registerIconProvider(()=>b)}aKn(b,k,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==lc.a.S3)return v.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.D_(qn.a.oT(b),b.node,5,r,k);break;case 0:this.D_(qn.a.oT(b),b.node,3,r,k);break;case 1:this.D_(qn.a.oT(b),b.node,4,r,k);break;case 3:this.D_(qn.a.oT(b),b.node,0,r,k);break;case 7:this.D_(qn.a.oT(b),b.node,1,r,k);break;case 8:this.D_(qn.a.oT(b),b.node,2,r,k);break;case 6:this.D_(qn.a.oT(b),b.node,1,r,k);this.D_(qn.a.oT(b),b.node,2,r,k);break;case 5:this.D_(qn.a.oT(b),b.node,3,
r,k);this.D_(qn.a.oT(b),b.node,5,r,k);this.D_(qn.a.oT(b),b.node,4,r,k);this.D_(qn.a.oT(b),b.node,0,r,k);break;case 4:this.D_(qn.a.oT(b),b.node,3,r,k),this.D_(qn.a.oT(b),b.node,5,r,k),this.D_(qn.a.oT(b),b.node,4,r,k),this.D_(qn.a.oT(b),b.node,0,r,k),this.D_(qn.a.oT(b),b.node,1,r,k),this.D_(qn.a.oT(b),b.node,2,r,k)}return!0}dYf(b,k,r,y){if(!k)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(k.contextId!==lc.a.K_)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
k.contextId),!1;var R=k.node;const aa=new Wd.GraphIterator;aa.set(R);aa.Ab(14);R=Ei.TableCellReader.CLa(aa);switch(k.border){case 2:this.PPa(b,k.node,5,y,r,R);this.s7d(k.node,5,r);this.x6d(b,k.pYa(),3,r,y,R);break;case 0:this.PPa(b,k.node,3,y,r,R);this.s7d(k.node,3,r);this.x6d(b,k.pYa(),1,r,y,R);break;case 1:this.PPa(b,k.node,4,y,r,R);this.s7d(k.node,4,r);this.x6d(b,k.pYa(),0,r,y,R);break;case 3:this.PPa(b,k.node,0,y,r,R),this.s7d(k.node,0,r),this.x6d(b,k.pYa(),2,r,y,R)}return!0}Bfn(b,k){if(rf.SelectionEditor.APc(b)&&
k)switch(b=Object(ia.a)(Bq.TableNodeBorderContext,b),b.border){case 2:this.YN(b.node,wg.wo.KL(5),k);break;case 0:this.YN(b.node,wg.wo.KL(3),k);break;case 3:this.YN(b.node,wg.wo.KL(0),k);break;case 1:this.YN(b.node,wg.wo.KL(4),k);break;case 7:this.YN(b.node,wg.wo.KL(1),k);break;case 8:this.YN(b.node,wg.wo.KL(2),k);break;case 5:k=this.YN(b.node,wg.wo.KL(5),k);k=this.YN(b.node,wg.wo.KL(3),k);k=this.YN(b.node,wg.wo.KL(0),k);this.YN(b.node,wg.wo.KL(4),k);break;case 6:k=this.YN(b.node,wg.wo.KL(1),k);this.YN(b.node,
wg.wo.KL(2),k);break;case 4:k=this.YN(b.node,wg.wo.KL(5),k),k=this.YN(b.node,wg.wo.KL(3),k),k=this.YN(b.node,wg.wo.KL(0),k),k=this.YN(b.node,wg.wo.KL(4),k),k=this.YN(b.node,wg.wo.KL(1),k),this.YN(b.node,wg.wo.KL(2),k)}}cen(b,k){if(rf.SelectionEditor.BPc(b)&&k)switch(b=Object(ia.a)(Bq.TableNodeBorderContext,b),b.border){case 2:this.YN(b.node,wg.wo.RN(5),k);break;case 0:this.YN(b.node,wg.wo.RN(3),k);break;case 3:this.YN(b.node,wg.wo.RN(0),k);break;case 1:this.YN(b.node,wg.wo.RN(4),k)}}hcf(b,k,r){r=
null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(k.size)&&(r=new Wj.a,r.weight=b.properties.ia(k.size,Pf.a.bF),r.style=b.properties.ia(k.style,Pf.a.Ura),r.color=b.properties.ia(k.color,0));return r}cYf(b,k,r){b?r?(b.properties.setValue(k.size,r.weight),b.properties.setValue(k.style,r.style),b.properties.setValue(k.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}VIb(b,k){b?(b.properties.removeProperty(k.size),b.properties.removeProperty(k.style),b.properties.removeProperty(k.color)):v.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}D_(b,k,r,y,R){R=this.apo(b,k,r,y,R);this.Zdc(k,wg.wo.KL(r),R);switch(r){case 5:this.iPa(k,2,y,R);break;case 4:this.iPa(k,1,y,R);break;case 0:this.iPa(k,3,y,R);break;case 3:this.iPa(k,0,y,R);break;case 1:this.iPa(k,7,y,R);break;case 2:this.iPa(k,8,y,R)}}apo(b,k,r,y,R){if(3!==y){var aa=
wg.sh.zFd(b,k,r,3);void 0!==aa&&null!==aa&&aa!==Pf.a.dZ&&(aa=Uo.a.gdc(aa),R.color=wg.Dgc.Zza(k,aa))}1!==y&&(aa=wg.sh.zFd(b,k,r,1),void 0!==aa&&null!==aa&&aa!==Pf.a.aF&&(R.weight=parseFloat(aa)*Pf.a.BYb));2!==y&&(b=wg.sh.zFd(b,k,r,2),void 0!==b&&null!==b&&b!==Pf.a.aF&&(R.style=b));return R}PPa(b,k,r,y,R,aa){y&&(R=this.Ijo(b,k,aa,r,y,R));this.Zdc(k,wg.wo.RN(r),R)}Ijo(b,k,r,y,R,aa){if(3!==R){var ta="",Ya=wg.sh.CAb(b,k,y,!1,!0,r,3);Ya&&(ta=Ya.swb);void 0!==ta&&null!==ta&&ta!==Pf.a.dZ&&(ta=Uo.a.gdc(ta),
aa.color=wg.Dgc.Zza(k,ta))}if(1!==R){ta="";if(Ya=wg.sh.CAb(b,k,y,!1,!0,r,1))ta=Ya.swb;void 0!==ta&&null!==ta&&ta!==Pf.a.aF&&(aa.weight=parseFloat(ta)*Pf.a.BYb)}if(2!==R){R="";if(b=wg.sh.CAb(b,k,y,!1,!0,r,2))R=b.swb;void 0!==R&&null!==R&&R!==Pf.a.aF&&(aa.style=R)}return aa}xLm(b){let k=0,r=0;({XKm:k,CIm:r}=this.ZAl(b.style,k,r));b.weight<k&&(b.weight=k);b.weight>r&&(b.weight=r);return b}ZAl(b,k,r){switch(b){case Pf.a.DYb:case Pf.a.Hab:case Pf.a.Uzc:k=2;r=48;break;case Pf.a.P1:k=2;r=24;break;default:k=
2,r=48}return{XKm:k,CIm:r}}x6d(b,k,r,y,R,aa){if(k)if(y)for(let ta=0;ta<k.length;ta++)switch(r){case 2:this.PPa(b,k[ta],5,R,y,aa);break;case 0:this.PPa(b,k[ta],3,R,y,aa);break;case 1:this.PPa(b,k[ta],4,R,y,aa);break;case 3:this.PPa(b,k[ta],0,R,y,aa)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}s7d(b,k,r){const y=new Wd.GraphIterator;y.set(b);y.Ab(14);const R=Ei.TableCellReader.Ola(b);
b=Ei.TableCellReader.SN(b);bf.forEachCell(y,R,b,(aa,ta,Ya)=>{aa=aa.currentNode;Ei.TableCellReader.rr(aa)&&0==Ya&&0<ta&&this.Zdc(aa,wg.wo.RN(k),r)})}Zdc(b,k,r){b?(r=this.xLm(r),b.properties.setValue(k.color,r.color),b.properties.setValue(k.size,r.weight),b.properties.setValue(k.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}iPa(b,k,r,y){if(b){var R=Si.TableReader.$f(b),aa=Si.TableReader.Yg(b),ta=new Wd.GraphIterator,Ya=[];for(let xb=0;xb<R;xb++)for(let Mb=0;Mb<
aa;Mb++)if(ta.set(b),bf.moveToCell(ta,xb,Mb),ta&&ta.currentNode&&!Ei.TableCellReader.gg(ta))switch(k){case 2:Ei.TableCellReader.sfa(ta)&&Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,2));break;case 0:Ei.TableCellReader.tfa(ta)&&Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,0));break;case 3:Ei.TableCellReader.asf(b,ta.currentNode)&&Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,3));break;case 1:Ei.TableCellReader.bsf(b,ta.currentNode)&&Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,
1));break;case 7:Ei.TableCellReader.bsf(b,ta.currentNode)||Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,1));break;case 8:Ei.TableCellReader.asf(b,ta.currentNode)||Ya.push(Bq.TableNodeBorderContext.b6(ta.currentNode,3))}for(b=0;b<Ya.length;b++)switch(k=Ya[b],k.border){case 2:this.GXc(k.node,wg.wo.RN(5),r,y);this.I3d(k.pYa(),wg.wo.RN(0),r,y);break;case 0:this.GXc(k.node,wg.wo.RN(3),r,y);this.I3d(k.pYa(),wg.wo.RN(4),r,y);break;case 1:this.GXc(k.node,wg.wo.RN(4),r,y);this.I3d(k.pYa(),wg.wo.RN(3),
r,y);break;case 3:this.GXc(k.node,wg.wo.RN(0),r,y),this.I3d(k.pYa(),wg.wo.RN(5),r,y)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}I3d(b,k,r,y){if(b)for(let R=0;R<b.length;R++)this.GXc(b[R],k,r,y);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}GXc(b,k,r,y){if(b){var R=b.ia(k.color,wg.V2e),aa=b.ia(k.size,wg.X2e),ta=b.ia(k.style,wg.W2e),Ya=new Wj.a;Ya.weight=y.weight;Ya.style=y.style;Ya.color=y.color;2!==r||R===wg.V2e&&aa===wg.X2e?3!==
r||ta===wg.W2e&&aa===wg.X2e?1!==r||R===wg.V2e&&ta===wg.W2e?(b.properties.removeProperty(k.color),b.properties.removeProperty(k.size),b.properties.removeProperty(k.style)):(Ya.color=R,Ya.style=ta,this.Zdc(b,k,Ya)):(Ya.style=ta,Ya.weight=aa,this.Zdc(b,k,Ya)):(Ya.color=R,Ya.weight=aa,this.Zdc(b,k,Ya))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}YN(b,k,r){var y=b.properties.ia(k.style,Pf.a.aF);y!==Pf.a.aF&&(r.lineStyle!==Pf.a.aF?r.lineStyle!==y&&(r.lineStyle=Pf.a.nlk):r.lineStyle=
y);y=b.properties.ia(k.size,Pf.a.bF);y!==Pf.a.bF&&(r.TQc!==Pf.a.bF?r.TQc!==y&&(r.TQc=Pf.a.flk):r.TQc=y);b=b.properties.ia(k.color,0);b=Uo.a.PC(b);b!==Pf.a.dZ&&(r.borderColor!==Pf.a.dZ?r.borderColor!==b&&(r.borderColor=Pf.a.Ykk):r.borderColor=b);return r}static get wo(){return null!=wg.Ahg?wg.Ahg:wg.Ahg=Pf.a.instance}static get sh(){return null!=wg.Oug?wg.Oug:wg.Oug=Va.a.instance.Pa("WordEditor.IWACTableStyleReader")}static get Dgc(){return null!=wg.Ksg?wg.Ksg:wg.Ksg=Ti.a.instance}}wg.Gtm="110px";
wg.Ftm="20px";wg.Z7i="SolidLineStyle";wg.hyh="DashedLineStyle";wg.dDh="DottedLineStyle";wg.fDh="DoubleLineStyle";wg.Ihh="BorderPointSizeOneQuarter";wg.Fhh="BorderPointSizeOneHalf";wg.Lhh="BorderPointSizeThreeQuarters";wg.Ghh="BorderPointSizeOne";wg.Ehh="BorderPointSizeOneAndHalf";wg.Mhh="BorderPointSizeTwoAndQuarter";wg.Khh="BorderPointSizeThree";wg.Dhh="BorderPointSizeFourAndHalf";wg.Jhh="BorderPointSizeSix";wg.W2e="single";wg.X2e=4;wg.V2e=0;Object(m.a)(wg,"TableBorderManager",null,[613]);var bn=
c(837),bm=c(58),br=c(201);class Rt{constructor(b,k){this.NYg=this.kTg=null;this.$Ja=b;this.KVg=k}get sDi(){return this.KVg}get ina(){return this.kTg}get tRf(){return this.NYg}h1i(b,k){this.NYg=b;this.kTg=k}fPn(b){this.KVg=b}}Object(m.a)(Rt,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var bg=c(102),Xj=c(207),Tk=c(385),ko=c(152),Al=c(262),Vo=c(594),Jl=c(88),Pj=c(445),lq=c(931);class al extends bn.a{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc=null,jc=null){super(b,k,r,jc,cc);this.m6a=lq.a.instance;
this.sa=new Fe.a;this.lWe=[wc.a.NLb,wc.a.U3a,wc.a.Klb,wc.a.LLb,wc.a.S3a,wc.a.Ilb,wc.a.KLb,wc.a.R3a,wc.a.Hlb,wc.a.MLb,wc.a.T3a,wc.a.Jlb];this.Xzj=[wc.a.va,wc.a.ua,Te.a.Zh,Te.a.Dq];this.Ci=y;this.gub=R;this.Yc=aa;this.hb=ta;this.O4=Ya;this.qm=xb;this.ioc=Mb;this.R4g=cc;this.NZj=jc}get Mi(){return this.Ci.value}get Pr(){return this.O4?this.O4.instance:null}OPe(b){this.sa.addHandler("OnParagraphDelete",b)}get xh(){return!!this.ioc.instance&&this.ioc.instance.xh}FMc(b,k,r,y,R){k.setValue(wc.a.Nc,Gc.a.ZF());
k.setValue(wc.a.ccm,R);Vo.b(y,k,[wc.a.N_]);super.FMc(b,k,r,y,R)}JMd(b,k,r,y,R){const aa=this.FKc(k,r,y,R);this.bxd(aa,k,!1);return super.JMd(b,k,r,y,R)}xqd(b,k,r,y,R){const aa=this.FKc(k,r,y,R);this.bxd(aa,k,!0);super.xqd(b,k,r,y,R);return aa}t_e(b,k,r,y){k=this.FKc(b,k,r,y);this.bxd(k,b,!0);return k}insertRows(b,k,r,y){const R=bm.a.Rr(b),aa=new Wd.GraphIterator;aa.ed(b);const ta=aa.currentNode;aa.Pb(1);let Ya;Ya=k?b.dD(1):b.currentNode;const xb=b.mc();if(!xb)throw Error.create("table row insertion cannot be performed on a null tableNode");
const Mb=Si.TableReader.$f(xb),cc=xb.JS.sh;let jc=!1;try{xb.eoa=1;const Mc=this.m6a.Jdb(xb,cc.Sz(xb));this.YPa(b.currentNode);this.Yoa(b);this.Z4j(r,b,Ya,aa,ta,k,y);const fd=this.m6a.Jdb(xb,cc.Sz(xb));this.i3a(xb,Si.TableReader.$f(xb)+r);jc=!0;this.tNd(xb,Mc,fd)}finally{xb.eoa=0,jc||this.i3a(xb,Si.TableReader.$f(xb)+r)}R+1!==Mb||k?!R&&k&&al.bpf(xb,r):al.bpf(xb,R);k=R+r+(k?0:1);k<Mb+r&&this.Mai(xb,k);return b.currentNode}Z4j(b,k,r,y,R,aa,ta){let Ya=null,xb=null;for(var Mb=0;Mb<b;++Mb){var cc=br.a.instance.createInstance(393251);
xb||(xb=cc);Ya=cc;this.FMc(k,cc,r,R,aa)}b=Si.TableReader.Yg(k.currentNode);r=!0;do{r?(k.Ei(Ya),r=!1):k.yf(1);R=Array(b);for(Mb=0;Mb<b;++Mb){cc=this.GKa();const jc=this.t_e(cc,y.currentNode,aa,!0);let Mc=null;jc.gg||(Mc=ta(jc));R[Mb]=new Rt(cc,Mc);R[Mb].h1i(jc,null);y.yf(1)}for(Mb=0;Mb<b;++Mb)cc=R[Mb].$Ja,k.A1(cc,1,bn.a.uHa?bn.a.uHa():null),Ei.TableCellReader.rr(cc)||(this.Qvb(k,cc,R[Mb].sDi),this.tth(R[Mb].tRf,cc,!0));y.y6(1)}while(k.currentNode!==xb)}insertColumns(b,k,r,y,R){let aa=b.currentNode,
ta=!1,Ya=Si.TableReader.Yg(b.currentNode);const xb=Ya;try{this.YPa(b.currentNode);this.Yoa(b);const Mb=aa.JS.sh;aa.eoa=1;const cc=this.m6a.Jdb(aa,Mb.Sz(aa));Ya=Si.TableReader.Yg(b.currentNode);-1===k&&(k=Ya);this.X4j(b,y,r,k,R);aa=b.currentNode;Ya+=y;this.NQf(b,Ya,y,k);ta=!0;const jc=this.m6a.Jdb(aa,Mb.Sz(aa));this.tNd(aa,cc,jc)}finally{aa.eoa=0,ta||this.NQf(b,Ya,y,k)}k!==xb||r?!k&&r&&al.apf(aa,y):al.apf(aa,k-1)}X4j(b,k,r,y,R){var aa=b.currentNode;y=r?y:y-1;b.Pb(1);var ta=new rb.a;do{var Ya=b.cD(y,
1);b.mc();var xb=Array(k);for(let cc=0;cc<k;++cc){var Mb=this.GKa();const jc=this.GCl(b,Ya,r),Mc=this.t_e(Mb,Ya,r,!1);Mb=new Rt(Mb,null);Mb.h1i(Mc,jc);xb[cc]=Mb}ta.add(xb)}while(b.xi(1));r=ta.toArray();for(y=0;y<r.length;y++)for(ta=0;ta<k;ta++)Ya=r[y][ta],xb=Ya.tRf,xb.gg||Ya.fPn(R(xb));b.set(aa);b.Pb(1);R=0;do{for(aa=0;aa<k;++aa)y=r[R][aa],ta=y.$Ja,b.PCb(ta,y.ina,1,bn.a.uHa?bn.a.uHa():null),Ei.TableCellReader.rr(ta)||(this.Qvb(b,ta,y.sDi),this.tth(y.tRf,ta,!1));R++}while(b.xi(1))}tNd(b,k,r){if(k){var y=
2===b.eoa,R=[],aa=new Wd.GraphIterator;aa.set(b);for(var ta=aa.Pb(1);ta;){for(ta=aa.Pb(1);ta;){const Ya=ta.id.toString();Ya in k&&k[Ya]===r[Ya]&&(!y||!Ei.TableCellReader.tfa(aa)&&!Ei.TableCellReader.sfa(aa))||R.push(ta);ta=aa.xi(1)}ta=aa.xi(1)}if(0<R.length){k=new sf.GraphTransaction(3);try{k.set(b.Ui);for(let Ya of R)Ya.qNd()}finally{k&&k.dispose()}}}}deleteRows(b,k){const r=bm.a.Rr(b),y=r+k;let R=b.mc();const aa=R.JS.sh;let ta=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
R.id.toString(),R.type,r,k);const Ya=Si.TableReader.$f(R);try{R.eoa=2;const xb=this.m6a.Jdb(R,aa.Sz(R));this.YPa(b.currentNode);this.Yoa(b);for(let cc=y-1;cc>=r;--cc){b.cD(cc,1);let jc=b.Pb(1);for(;jc;)this.tTc(jc,!0),jc=b.xi(1);this.sZa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Le);b.Hg()}R=b.currentNode;const Mb=this.m6a.Jdb(R,aa.Sz(R));this.i3a(R,Si.TableReader.$f(R)-k);this.nXd(b);ta=!0;this.tNd(R,xb,Mb)}finally{R.eoa=0,ta||
(this.i3a(b.currentNode,Si.TableReader.$f(b.currentNode)-k),this.nXd(b))}Ya===y&&0<=r-1&&al.bpf(R,r-1);r<Ya-k&&this.Mai(R,r)}deleteColumns(b,k,r){b=Object(ia.a)(Wd.GraphIterator,b);let y=Object(ia.a)(Pj.a,b.currentNode),R=Si.TableReader.Yg(b.currentNode);const aa=y.JS.sh;let ta=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",y.id.toString(),y.type,k,r);const Ya=R;try{y.eoa=2;const xb=this.m6a.Jdb(y,
aa.Sz(y));this.YPa(b.currentNode);this.Yoa(b);-1===k&&(k=R-r);b.Pb(1);do for(let cc=k+r-1;cc>=k;--cc)b.cD(cc,1),this.tTc(b.currentNode,!1),this.sZa(b),b.Hg();while(b.xi(1));R-=r;this.MQf(b,R,k,r);ta=!0;y=Object(ia.a)(Pj.a,b.currentNode);const Mb=this.m6a.Jdb(y,aa.Sz(y));this.tNd(y,xb,Mb);this.mXd(b)}finally{y&&(y.eoa=0),ta||(this.MQf(b,R,k,r),this.mXd(b))}Ya===k+r&&0<=k-1&&al.apf(y,k-1)}mergeCells(b,k,r){if(b&&(1!==k||1!==r)){var y=new Wd.GraphIterator;y.ed(b);y.Ab(14);this.N0e(y,k,r);this.qjo(y,
k,r);y.mc();y.mc();this.Czi(y)}}E8i(b,k,r){if(b&&(1!==k||1!==r)){var y=new Wd.GraphIterator;y.ed(b);y.Ab(14);this.nPk(y,k,r);y.mc();y.mc();this.KBi(y)}}tTc(b,k){v.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.kUl(b,k,Object(u.a)(this,this.DOf,"promoteToNonGhostCellImpl"))}DOf(b,k){const r=b.currentNode;r.gg=!1;this.bxd(k.currentNode,b.currentNode,!0);r.removeProperty(wc.a.skippedCell);r.removeProperty(wc.a.renderCell);1===r.colSpan&&
1===r.rowSpan&&r.eBc();bn.a.IJ.E5(b,!0,bn.a.YWh(k.currentNode));bf.returnToCell(b);this.eIk(k,b)}Ekf(b,k,r){super.Ekf(b,k,r);1===k.controlCell.colSpan&&1===k.controlCell.rowSpan?k.controlCell.eBc():!r&&k.q5d&&(b.nMa?1<b.colSpan&&(k=new Wd.GraphIterator,k.set(b),k.Ab(15),bf.moveToNextColumn(k),k.currentNode.colSpan=b.colSpan-1):(r=new Wd.GraphIterator,r.set(k.controlCell),r.Ab(15),k=Jl.a(r),r=new Wd.GraphIterator,r.set(b),r.Ab(15),bf.moveToColumnByIndex(r,k),--r.currentNode.colSpan))}FKc(b,k,r,y){const R=
super.FKc(b,k,r,y);if(b.gg&&!y){var aa=k.Oua;aa.q5d&&(y=bn.a.y2b(aa.controlCell,y),!aa.zvd&&r||aa.zvd===y-1&&!r?b.colSpan=1:(r=new Wd.GraphIterator,r.set(aa.controlCell),r.Ab(15),aa=Jl.a(r),r=new Wd.GraphIterator,r.set(k),r.Ab(15),bf.moveToColumnByIndex(r,aa),r.currentNode.colSpan+=1))}R.ia(wc.a.skippedCell,!1)&&(b.gg=!0,b.U2=!0,b.blb=!0);return R}nXd(b){this.KMb(b,wc.a.complexTable)}mXd(b){this.KMb(b,wc.a.complexTable)}Czi(b){this.KMb(b,wc.a.complexTable)}KBi(b){this.KMb(b,wc.a.complexTable)}eIk(b,
k){if(b&&k){let r;b=Wd.GraphIterator.Za(b.currentNode);af.OutlineNavigator.f7(b)&&(b.Pb(2),b=b.currentNode,12==b.type&&(r=b.wg(Te.a.Zh)));r&&(b=new Wd.GraphIterator,b.ed(k),af.OutlineNavigator.f7(b)&&b.Pb(2)&&(k=b.currentNode,12==k.type&&k.lh(Te.a.Zh,r)))}}bxd(b,k,r){b&&(Vo.b(b,k,this.lWe),Vo.b(b,k,[Te.a.cI]),r&&Vo.b(b,k,[wc.a.wM,wc.a.zO,wc.a.ZEa,wc.a.XEa,wc.a.Hoa,wc.a.skippedCell,wc.a.renderCell]))}tth(b,k,r){b&&(b=Wd.GraphIterator.Za(b),b.rd(),b.Ud(),k=Wd.GraphIterator.Za(k),k.rd(),k.Ud(),Ag.OutlineElementReader.Nh(b)&&
xg.OutlineElementNavigator.Fe(b)&&Ag.OutlineElementReader.Nh(k)&&xg.OutlineElementNavigator.Fe(k)&&Vo.b(b.currentNode,k.currentNode,this.Xzj),r&&(xg.OutlineElementNavigator.Xd(b),xg.OutlineElementNavigator.Xd(k),Vh.ListReader.ei(b)&&(r=al.mum.Gs(b),r.$z=bg.a.Yi,{eCa:r}=al.No.Mra(r.propertySet,k,r))))}sZa(b){this.xh&&this.qm.Eqn(b.currentNode);for(b=Xj.a.$p(b);b.moveNext();)if(ie.ParagraphReader.nc(b.currentNode)){const k=Qm.e(b.currentNode);for(let r of k)r.dga();this.sa.raiseEvent("OnParagraphDelete",
b.currentNode)}else Vh.ListReader.ei(b.iterator)&&this.Pr&&this.Pr.gEa(b.iterator)}tD(b,k){let r=null;if(this.R4g.og){const y=Object(ia.a)(Pj.a,b);y&&(r=y.SQ())}Si.TableReader.fm(b)&&(1===k?k=3:3===k&&(k=1));super.tD(b,k);this.R4g.og&&this.NZj.yba(b,r);Object(Jb.a)(Pj.a,b)&&bn.a.Kh.V1i(Object(ia.a)(Pj.a,b),(new Tk.a(1,0)).mt)}lZf(b,k){const r=Array(k),y=this.O0h(b)/k;for(let R=0;R<k;R++)r[R]=Math.max(Vf.a.rn(ko.a.Lba,0),y);b.setValue(Te.a.iz,r)}M0i(b){b.setValue(wc.a.tableLayout,0)}Gbh(b,k,r,y,R){const aa=
Array(r);for(var ta=0,Ya=0;ta<y;++ta)aa[ta]=k[ta],Ya+=aa[ta];for(;ta<r;++ta)aa[ta]=0>ta-R?k[0]:k[ta-R],Ya+=aa[ta];ta=this.O0h(b.currentNode);if(Ya>ta)for(Ya=ta/Ya,ta=0;ta<r;++ta)aa[ta]=Math.max(Vf.a.rn(ko.a.Lba,0),aa[ta]*Ya);return aa}O0h(b){var k=Wd.GraphIterator.Za(b);b=Vf.a.rn(Vf.a.Ri(Si.TableReader.z0h(k),0),0);if(k.Ab(16))return bf.returnToCell(k),k=ko.a.Ugc(k.currentNode),Vf.a.rn(Vf.a.Ri(k,0),0)-b;k=Al.a.H2c(k);return Vf.a.rn(Vf.a.Ri(k,0),0)-b}SN(b,k,r){const y=new Wd.GraphIterator;y.set(b);
bf.moveToCell(y,k,r);return y.currentNode.ia(wc.a.colSpan,1)}dec(b){var k=Ka.App.xa.jb.zv;if(k.ye&&(k=b.Be(k.Sb))){var r=!1,y=Si.TableReader.Yg(b),R=b.ia(Te.a.iz,Array(y));for(var aa of R)if(!aa){r=!0;break}if(r){R=Th.a.clone(R);aa=b.ia(wc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",y,R,aa);r=1;var ta=0;for(let xb=0;xb<y;)if(aa&&(r=this.SN(b,0,xb)),1<r){for(var Ya=0;Ya<r;Ya++)R[xb]||(R[xb]=this.DVh(0)),
xb++;ta+=r-1}else(Ya=k.dql(xb-ta))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",xb,ta),R[xb]||(R[xb]=this.DVh(Ya)),xb++;b.setValue(Te.a.iz,R)}}}DVh(b){return Vf.a.rn(Math.max(b,ko.a.Lba),0)}YPa(b){b=Wd.GraphIterator.Za(b);this.dec(b.currentNode);b.Ab(14)&&(bf.returnToContainingTable(b),this.dec(b.currentNode))}S1i(b,k){k&&b.setValue(wc.a.c8,k)}NZf(b,k){k&&b.setValue(wc.a.bgc,k)}goh(b,k){const r=Si.TableReader.Yg(b);bn.a.Pxk(b,k,r)}fLn(b,k,r){let y;if(!({tableNode:y}=
this.c8b(b)).returnValue)return!1;if(k&&r&&k.length===r.length){if(!this.$Zk(y,k))return!1;for(let R=0;R<k.length;++R){const aa=this.gub.i_c(b,k[R],r[R]);if(aa)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",aa),!1}this.zVd(y);return!0}return!1}Edk(b,k){let r;if(!({tableNode:r}=this.c8b(b)).returnValue||Si.TableReader.LA(r))return!1;var y=Object(ia.a)(Wd.GraphIterator,this.Yc.Zf(r));bf.moveToLastRow(y);var R=Si.TableReader.$f(r);
if(k&&0<k.length){this.insertRows(y,!1,k.length,()=>null);y=Si.TableReader.$f(r);var aa=this.Yc.Zf(r);R=this.u0h(aa,R,y-1);for(y=0;y<R.length;++y){aa=R[y];const ta=k[y];for(let Ya=0;Ya<aa.length;++Ya){let xb;if(xb=ta&&ta[Ya]?this.gub.i_c(b,aa[Ya],ta[Ya].toString()):this.gub.i_c(b,aa[Ya],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",xb),!1}}}this.zVd(r);return!0}mdk(b,k){let r;if(!({tableNode:r}=this.c8b(b)).returnValue||
Si.TableReader.LA(r))return!1;var y=this.Yc.Zf(r),R=Si.TableReader.Yg(r);if(k&&0<k.length){this.insertColumns(Object(ia.a)(Wd.GraphIterator,y),R,!1,k[1].length,()=>null);var aa=Si.TableReader.Yg(r);y=this.TMl(y,R,aa-1);for(R=0;R<y.length;++R){aa=k[R];const ta=y[R];for(let Ya=0;Ya<ta.length;++Ya){let xb;if(xb=aa&&aa[Ya]?this.gub.i_c(b,ta[Ya],aa[Ya].toString()):this.gub.i_c(b,ta[Ya],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
xb),!1}}}this.zVd(r);return!0}RTk(b){let k;if(!({tableNode:k}=this.c8b(b)).returnValue)return!1;let r=this.IYa(k);const y=Si.TableReader.$f(k);var R=this.Yc.Zf(k);R=this.u0h(R,r,y-1);for(let aa=0;aa<R.length;++aa){const ta=R[aa];for(let Ya=0;Ya<ta.length;++Ya){const xb=this.gub.fOi(b,ta[Ya]);if(xb)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",xb),!1}}r=r?r:1;b=this.Yc.Zf(k);b.EF(r)&&15===b.Le&&this.deleteRows(Object(ia.a)(Wd.GraphIterator,
b),y-r);this.zVd(k);return!0}IYa(b){let k=0;const r=this.Yc.Zf(b);let y=r.Ud();for(;y&&y.ia(wc.a.Qgb,!1);)k++,y=r.Ht();return!k&&rj.StyleReader.Nba.rT(b)&32?1:k}qjo(b,k,r){var y,R;const aa=b.currentNode,ta=new Wd.GraphIterator;ta.ed(b);let Ya=null,xb=null,Mb=null;const cc=Pf.a.instance.RN(3),jc=Pf.a.instance.RN(4),Mc=Pf.a.instance.RN(5),fd=Pf.a.instance.RN(0);bf.forEachCell(ta,k,r,(Td,ne,ye)=>{Td=Td.currentNode;ne||ye||(Ya=al.hz.hcf(Td,cc,Ya));ne||ye!==r-1||(xb=al.hz.hcf(Td,jc,xb));0<ne&&!ye&&(Ya?
al.hz.cYf(Td,cc,Ya):al.hz.VIb(Td,cc),xb?al.hz.cYf(Td,jc,xb):al.hz.VIb(Td,jc),al.hz.VIb(Td,Mc),ne!==k-1&&al.hz.VIb(Td,fd));ye||ne!==k-1||(Mb=al.hz.hcf(Td,fd,Mb))});b=null===(R=null===(y=null===Ka.App||void 0===Ka.App?void 0:Ka.App.xa)||void 0===y?void 0:y.jb)||void 0===R?void 0:R.zv;xb?(y=Bq.TableNodeBorderContext.b6(aa,1),al.hz.dYf(qn.a.Yo(b),y,xb,0)):al.hz.VIb(aa,jc);y=Bq.TableNodeBorderContext.b6(aa,0);if(Ya)al.hz.dYf(qn.a.Yo(b),y,Ya,0);else for(y=Object(ia.a)(Bq.TableNodeBorderContext,y).pYa(),
R=0;R<y.length;R++)al.hz.VIb(y[R],jc);Mb?al.hz.cYf(aa,fd,Mb):al.hz.VIb(aa,fd)}$Zk(b,k){for(let y=0;y<k.length;++y){var r=this.Yc.Zf(k[y]);if(r.Ab(14)&&(r=r.kd(14),b.id===r.id))continue;return!1}return!0}c8b(b){let k=null;if(b&&b.su.toString()!==b.Oz.toString())return{returnValue:!1,tableNode:k};k=this.Mi.Db(b.su);return 14===k.type&&this.gub.c8b(b)?{returnValue:!0,tableNode:k}:{returnValue:!1,tableNode:k}}u0h(b,k,r){const y=[];bf.forEachCellInTable(Object(ia.a)(Wd.GraphIterator,b),(R,aa,ta)=>{if(aa>=
k&&aa<=r)ta||y.push([]),Ei.TableCellReader.gg(R)||Array.add(y[aa-k],R.currentNode);else if(aa>r)return!1;return!0});return y}TMl(b,k,r){const y=[];bf.forEachCellInTable(Object(ia.a)(Wd.GraphIterator,b),(R,aa,ta)=>{ta>=k&&ta<=r&&(ta===k&&y.push([]),Ei.TableCellReader.gg(R)||Array.add(y[aa],R.currentNode));return!0});return y}zVd(b){if(b&&14===b.type){b=Object(ia.a)(Wd.GraphIterator,this.Yc.Zf(b));const k=new rb.a;ie.ParagraphReader.peb(b,!0,!1,k);b=Ke.SelectionFactory.xe(k.J(k.count-1),0);this.hb.setSelection(b)}}static get characterPropertiesEditor(){return null!=
al.Mhg?al.Mhg:al.Mhg=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hz(){al.gra||(al.gra=Va.a.instance.Pa("WordEditor.ITableBorderManager"));return al.gra}static get mum(){return null!=al.Rog?al.Rog:al.Rog=Va.a.instance.resolve("Box4.List.IListReader")}static get No(){return null!=al.Mog?al.Mog:al.Mog=Va.a.instance.resolve("Box4.List.IListEditor")}Mai(b,k){const r=new Wd.GraphIterator;r.set(b);bf.moveToFirstRow(r);bf.moveToRowByIndex(r,k);do r.currentNode.uk(4,!0);while(bf.moveToNextRow(r))}static bpf(b,
k){if(b){var r=Si.TableReader.$f(b),y=Si.TableReader.Yg(b);if(!(!Ka.App.xa.jb.zv.ye||0>k||k>=r))for(r=new Wd.GraphIterator,r.set(b),b=0;b<y;b++){b?bf.moveToNextColumn(r):bf.moveToCell(r,k,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let R=r.currentNode;Ei.TableCellReader.rr(R)&&(R=Ei.TableCellReader.Aea(R));R&&R.uk(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static apf(b,k){if(b){var r=Si.TableReader.$f(b),y=Si.TableReader.Yg(b),
R=new Wd.GraphIterator;if(!(!Ka.App.xa.jb.zv.ye||0>k||k>=y))for(y=0;y<r;y++){R.set(b);bf.moveToCell(R,y,k);if(!R||!R.currentNode)continue;let aa=R.currentNode;Ei.TableCellReader.rr(aa)&&(aa=Ei.TableCellReader.Aea(aa));aa&&aa.uk(4,!0)}}else v.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}al.gra=null;Object(m.a)(al,"TableEditor",bn.a,[436,437]);class Ls{get name(){return"WordEditor.TableEditors"}zc(b){n.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.TableEditors.TableEditor",()=>new al(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Io.a,bh.a.instance,b.$a("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.$a("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
b.ha("WordEditor.TableEditors.TableBorderManager",()=>new wg).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Pc(new Ls)}}Object(m.a)(Ls,"WordEditorTableEditorsPackage",null,[1,2]);class wo{get name(){return"WordEditor.TextLevelEditors"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new wo)}}Object(m.a)(wo,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Cq=c(1820);c(442);var as=c(761),ao=c(224),np=c(260);class mr{constructor(b){this.aRj=
b}LNk(){const b=br.a.instance.createInstance(393228);b.setValue(Te.a.yK,ao.a.first);b.setValue(Te.a.dhh,0);b.setValue(Te.a.Ffa,Nf.OutlineReader.Yyh);(new as.OutlineIndentInfo(!0)).jWi(b);return b}E5(b,k,r=null){const y=b.currentNode;if(!b.oE(1))return this.Gfb(b,null,k,r);Ag.OutlineElementReader.qK(b)&&xg.OutlineElementNavigator.rBf(b,!0);return Ag.OutlineElementReader.Nh(b)?mr.Ug.TB(b,!1,k,r):(b.XYc(y),null)}Isk(b){return Nf.OutlineReader.Tsf(b.currentNode)||Ag.OutlineElementReader.Nh(b)||Ag.OutlineElementReader.qK(b)||
Ei.TableCellReader.isTableCell(b)}Gfb(b,k=null,r=!1,y=null){if(!this.Isk(b))return null;const R=mr.Ug.Uxb();this.zQn(R,b);b.PCb(R,k,1,null);b.Ei(R);r&&(mr.Ug.zN(b,y),xg.OutlineElementNavigator.Xd(b));return R}zQn(b,k){if(k=this.eJl(k))switch(k.type){case 11:mr.Ug.j6e(k,b,!0);break;case 8:k=mr.Ue.isRtl(k),mr.Ug.qKb(b,k)}}eJl(b){return this.aRj.fJl(b)}pKb(b,k){b.setValue(Te.a.Dq,k?11:9)}lLn(b,k){const r=np.WordSectionNavigator.instance.XI(b);return r?Nf.OutlineReader.EL(b)!==k?(r.setValue(wc.a.g3e,
k),!0):!1:null}static get Ue(){return De.PageReader.instance}static get Ug(){return mr.Kh||(mr.Kh=Va.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Ug(b){mr.Kh=b}}mr.Kh=null;mr.ng=null;Object(m.a)(mr,"OutlineEditor",null,[486]);const ct=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new mr(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Cq.a(b.Ze("Box4.IOutlineEditor"),b.Ze("Box4.List.IListEditor"),
b.Ze("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Tl{get name(){return"Box4.OutlineLevelEditors"}zc(b){ct(b)}init(){}dispose(){}static main(){M.a.instance.Pc(new Tl)}}Object(m.a)(Tl,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class Ow{constructor(b){this.wyd=null;this.Awi=b.lb("OfficeOnlineChromeExtensionId");this.Gwi=b.lb("ChromeClipboardAccessExtensionId");this.lbm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.k1g=!this.djm();this.wyd=this.Xkb?this.Gwi:this.Awi}Myn(){this.wyd===this.Awi&&this.Mfi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.wyd=this.Gwi;this.k1g=!0}get Xkb(){return this.k1g}djm(){if(this.lbm&&this.Mfi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Mfi(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(k){v.ULS.sendTraceTag(19452045,307,50,k.toString())}return b}}Object(m.a)(Ow,"ChromeExtensionHelper",null,[1038]);var nr=c(1400),Lu=c(514),Ms=c(1358);
class qs{create(b){return new Ms.a(b)}}Object(m.a)(qs,"Factory",null,[755]);var Jo=c(120);class zt{constructor(b,k,r){this.E_j=b;this.Ce=k;this.aVa=r}Vb(){this.aVa.gb(Wa.a.u0d,lc.a.application,this.u0d.bind(this),96);this.aVa.pa(Wa.a.Jhc,lc.a.view,this.Soo.bind(this));this.aVa.gb(Wa.a.cKi,lc.a.view,this.Uoo.bind(this),96)}u0d(b,k,r,y,R){if(1===r)return 32;b=Object.assign(new Ci.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});k=[];r=Object.assign(new oi.a,{ControlList:[]});
r.ControlList.push(Object.assign(new Wg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));k.push(r);Array.addRange(b.MenuSectionList,k);R.MenuItems=b;return 32}Uoo(b,k,r,y,R){if(1===r)return 32;b=mi.a.w$i();null==b&&8;b=this.Ce.DF(b);R[cl.a.LabelText]=String.format(A.a.Ff(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}Soo(b,k,r){b=mi.a.nEb(k);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");Ga.Health.instance.recordKpiUsage(Jo.a.$mb,
0,Jo.a.LB,r);this.E_j.Xoo(k)?Od.b(539842578,3018,50,"User Successfully Updated styles from UI"):(k=new Map,k.set("Source","StyleContextMenuActor"),k.set("Action","UpdateStyle"),k=Object.assign(new Xa.a,{extendedProperties:k}),Ga.Health.instance.recordKpiFailure(Jo.a.$mb,"UpdateStyleFailed",!1,!0,k),Od.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(m.a)(zt,"StyleContextMenuActor",null,[]);var gn=c(1001),Ns=c(1467),lo=c(475),ou=c(1676);
class St extends ou.a{constructor(b,k,r,y,R,aa,ta=null,Ya=null){super(b,aa,ta,Ya);this._formatting=null;this.oHa=!1;this.Lpb=n.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Urb=0;this.Dwc=new rb.a;Od.a(8128527,307,Ag.OutlineElementReader.Nh(b));this.hL=k;this.hL.tYb(this);this.xp=r;this.No=y;this.hd=R;this.vUe=Ya;this.OCe=Vh.ListReader.ei(this.Ac)}get paragraphEditor(){return null!=this.nqg?this.nqg:this.nqg=Va.a.instance.resolve("Box4.IParagraphEditor")}get qyd(){return null}get f_b(){return this.OCe&&
!this.hL.yAa}get oyb(){return 0<this.Urb}Uaa(b,k){if(!this.t0.C7f(this.Ac,k,!0)){Od.a(8701077,307,ie.ParagraphReader.yh(this.Ac));var r=this.Ac.currentNode,y=Re.a.rw(r);this.Lpb&&this._formatting.YP&&(r=r.qa.last,this.oHa&&(r.formatting=this._formatting.YP.Yf(r),this.oHa=!1),b=this.t0.Mkf(b,k),this.t0.CEa(this.Ac.currentNode,this._formatting.cba,k));this.characterPropertiesEditor.replaceTextRange(y,b)}}sDa(){Od.a(8701078,307,ie.ParagraphReader.yh(this.Ac));const b=Re.a.rw(this.Ac.currentNode);this.characterPropertiesEditor.ifa(b,
k=>new lo.a(k))}Iib(){this.t0.Rkf(this.Ac)}oDa(){this.Lpb&&(this.oHa=!0)}nOa(){Od.a(8701079,307,ie.ParagraphReader.yh(this.Ac))}mOa(){Od.a(8701080,307,ie.ParagraphReader.yh(this.Ac))}VF(b){this.hL.yAa||(this.Lpb?(this.nRe(b),this._formatting.Wbe(this.Ac.currentNode),b&&"P"===b.p7.JLd&&this.vUe.$ga(this.Ac.currentNode,this._formatting.KDa),this.t0.CEa(this.Ac.currentNode,this._formatting.cba,b)):this.sjk(b))}UF(){this.hL.yAa||this.mFc()}sOa(){}p1a(){}vDa(){Od.a(8701081,307,Ag.OutlineElementReader.Nh(this.Ac)||
Nf.OutlineReader.Aw(this.Ac)||ie.ParagraphReader.yh(this.Ac)&&this.hL.yAa);let b=!1;this.oyb||(b=this.f_b||!0);b||(this.jU+=1);this.Urb++}tDa(){this.Urb--;let b=!1;this.oyb||(b=this.f_b||!0,this.No.LSf(this.Dwc));b||--this.jU}rOa(b){Od.a(8701082,307,Ag.OutlineElementReader.Nh(this.Ac)||Nf.OutlineReader.Aw(this.Ac)||ie.ParagraphReader.yh(this.Ac)&&this.hL.yAa);Od.a(8701083,307,!!b.listStyleType)}uDa(){Od.a(8701084,307,Ag.OutlineElementReader.Nh(this.Ac)||ie.ParagraphReader.yh(this.Ac)&&this.hL.yAa);
this.hL.yAa||Od.a(8701085,307,this.Ac.fq(2))}Taa(b){this.hL.Taa(b)}Qaa(){this.hL.Qaa()}Ibe(b){this.Dwc.add(b)}Saa(b){this.hL.Saa(b)}Raa(){this.hL.Raa()}Paa(b){this.hL.Paa(b)}Oaa(){this.hL.Oaa()}sjk(b){this.g$b(!1);(new Wd.GraphIterator).ed(this.Ac);b=ou.a.Ug.zN(this.Ac,this.WIc(b));Od.a(8128534,307,b===this.Ac.currentNode);Od.a(8128535,307,ie.ParagraphReader.nc(b))}mFc(){Od.a(8128536,307,ie.ParagraphReader.yh(this.Ac));xg.OutlineElementNavigator.Xd(this.Ac)}reset(){this.Lpb&&(super.reset(),this._formatting=
this.Hdf(!0))}nRe(b){this.g$b(!1);(new Wd.GraphIterator).ed(this.Ac);b=ou.a.Ug.zN(this.Ac,this.WIc(b));Od.a(36577367,307,b===this.Ac.currentNode);Od.a(36577368,307,ie.ParagraphReader.nc(b));-1!==this._formatting.Zs&&this.paragraphEditor.tD(b,this._formatting.Zs);this._formatting.lineSpacing&&this.vUe.jC(b,this._formatting.lineSpacing);this._formatting.gJ&&this.vUe.G7d(b,this._formatting.gJ);this.oHa=!0;this._formatting.paragraph=b}static Ywd(b,k){let r=0;switch(k){case 3:r=Rg.a.GA(b);break;case 7:r=
Vf.a.az(b,0);break;case 1:r=Rg.a.tWe(b);break;case 5:r=Rg.a.GA(Rg.a.iMf(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,k)}return r}}Object(m.a)(St,"TextOnlyBox4PasteSteward",ou.a,[]);class Dh{constructor(b,k,r,y){this.Qhd=b;this.AG=k;this.Cf=r;this.t0=y}create(b,k,r,y,R=null,aa=null,ta=null){return 1===b?new St(k,y,this.Qhd,this.AG,this.Cf,R,aa,this.t0):new Ns.Box4PasteSteward(k,r,y,this.Qhd,this.AG,
this.Cf,R,aa,this.t0,ta)}}Object(m.a)(Dh,"Box4PasteStewardFactory",null,[754]);var Tt=c(194),cr=c(391),xp=c(1517);class Un{constructor(b,k,r){this.vy=null;this.Vrb=0;this.U8=null;this.Ac=b;this.Fk=r}tYb(b){this.vy=b}get yAa(){return 0<this.Vrb}Taa(b){Od.a(7869459,307,!!this.vy);Od.a(7869460,307,Ag.OutlineElementReader.Nh(this.Ac)||Nf.OutlineReader.Aw(this.Ac));Od.b(38563978,307,50,"Table pasting started");this.vy.g$b(!0);const k=new Wd.GraphIterator;k.ed(this.Ac);var r=xp.a.q0l[b.styleId];r||(r=xp.a.ezh);
r=this.Fk.Jln(this.Ac,b.rowCount,b.hbb,r,b.tableLook,this.vy.WIc(b),b.Qbi);b.z4f&&(Od.b(573691298,3022,100,"Applying table border properties"),xp.a.Odh(b.z4f,this.Ac,!1,!0));b.tMd&&(Od.b(573691299,3022,100,"Applying indentation properties"),xp.a.yek(this.Ac,b.tMd.spaceBefore,b.tMd.spaceAfter));b.Avd&&(Od.b(573691328,3022,100,"Applying column widths"),xp.a.fek(b.Avd,this.Ac,Object(ia.a)(cr.TableNode,r),b.S_a));this.vy.gsd(k,!1);this.Vrb++;Vh.ListReader.ei(k)&&this.vy.Ibe(k.currentNode);Od.a(7869461,
307,Si.TableReader.isTable(this.Ac))}Qaa(){Od.a(7869462,307,!!this.vy);Od.a(7869463,307,bm.a.isTableRow(this.Ac));Od.b(38563979,307,50,"Table pasting finished");this.U6&&this.Ac.it(14)&&xp.a.oWi(this.Ac.Gn);xg.OutlineElementNavigator.Xd(this.Ac);this.Vrb--}Saa(b){Od.a(7869464,307,!!this.vy);Od.b(573691329,3022,100,"Table row pasting started");Si.TableReader.isTable(this.Ac)?bf.moveToFirstRow(this.Ac):bm.a.isTableRow(this.Ac)&&bf.moveToNextRow(this.Ac);b.height&&(Od.b(573691330,3022,100,"Applying table row height"),
xp.a.kfk(this.Ac,b.height));Od.a(7869465,307,bm.a.isTableRow(this.Ac))}Raa(){Od.a(7869466,307,!!this.vy);Od.a(7869467,307,Ei.TableCellReader.isTableCell(this.Ac));bf.returnToContainingRow(this.Ac)}Paa(b){Od.a(7869468,307,!!this.vy);Od.a(7869469,307,!this.vy.jU);bm.a.isTableRow(this.Ac)?bf.moveToFirstColumn(this.Ac):Ei.TableCellReader.isTableCell(this.Ac)?bf.moveToNextColumn(this.Ac):Od.a(7869471,307,!1);if(this.Ac.currentNode){Od.b(573691331,3022,100,"Table cell pasting started");var k=Object(ia.a)(Tt.TableCellNode,
this.Ac.currentNode);Od.a(50689760,307,!k&&16!==this.Ac.currentNode.type||!!k&&16===this.Ac.currentNode.type);if(k){var r=new Wd.GraphIterator;r.ed(this.Ac);if(b.U7b)Od.b(573691332,3022,100,"Processing skipped cell"),xp.a.qcn(r,b);else{if(1<b.colSpan||1<b.rowSpan){const y=bf.returnToContainingTable(r);if(!y)return;y.setValue(wc.a.complexTable,!0);r.ed(this.Ac);Od.b(573691333,3022,100,"Processing merged cell");xp.a.Fbn(r,b);k.rowSpan=b.rowSpan;k.colSpan=b.colSpan}xp.a.ofk(this.Ac,b.shadingColor);xp.a.$fk(this.Ac,
b.verticalAlignment);xp.a.Udk(this.Ac,b.nae);xp.a.Odh(b.rha,this.Ac,!b.colSpan&&!b.rowSpan,!1);(new Wd.GraphIterator).ed(this.Ac);bf.forEachCell(r,b.rowSpan,b.colSpan,(y,R,aa)=>{Od.b(573691334,3022,100,"Setting ghost cell borders");xp.a.K_i(y,b.rha,R,aa,b.rowSpan,b.colSpan)});xp.a.bgk(this.Ac,b.width,b.S_a);Od.a(7869472,307,Nf.OutlineReader.Aw(this.Ac))}}}}Oaa(){Od.a(7869473,307,!!this.vy);Od.a(7869474,307,Ag.OutlineElementReader.Nh(this.Ac)||Ei.TableCellReader.isTableCell(this.Ac));bf.returnToCell(this.Ac);
Od.a(7869475,307,0>=this.vy.jU);this.vy.sXe()}get U6(){null==this.U8&&(n.AFrameworkApplication.Ne("he991617;3eed2178"),this.U8=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.U8}}Object(m.a)(Un,"Box4TableSteward",null,[769,374]);class Ut{constructor(b,k,r){this.vy=null;this.Vrb=0;this.Ac=b;this.Fk=r}tYb(b){this.vy=b}get yAa(){return 0<this.Vrb}Taa(){this.yAa&&(Od.a(8787101,307,ie.ParagraphReader.yh(this.Ac)),
xg.OutlineElementNavigator.Xd(this.Ac));Od.a(8701086,307,!!this.vy);Od.a(8701087,307,Ag.OutlineElementReader.Nh(this.Ac)||Nf.OutlineReader.Aw(this.Ac));this.Vrb++}Qaa(){Od.a(8701088,307,!!this.vy);xg.OutlineElementNavigator.Xd(this.Ac);this.Vrb--;if(this.yAa){this.vy.g$b(!0);const b=Ut.Ug.zN(this.Ac);Od.a(8787102,307,b===this.Ac.currentNode);Od.a(8787103,307,ie.ParagraphReader.yh(this.Ac))}}Saa(b){Od.a(8701089,307,!!this.vy);this.vy.g$b(!0);const k=new Wd.GraphIterator;k.ed(this.Ac);this.vy.gsd(k,
!1);Vh.ListReader.ei(k)&&this.vy.Ibe(k.currentNode);b=Ut.Ug.zN(this.Ac,this.vy.WIc(b));Od.a(8701090,307,b===this.Ac.currentNode);Od.a(8701091,307,ie.ParagraphReader.yh(this.Ac))}Raa(){Od.a(8701120,307,!!this.vy);Od.a(8701121,307,ie.ParagraphReader.yh(this.Ac));xg.OutlineElementNavigator.Xd(this.Ac)}Paa(){Od.a(8701122,307,!!this.vy);Od.a(8701123,307,ie.ParagraphReader.yh(this.Ac));Od.a(8701124,307,!this.vy.jU);var b=this.Ac.currentNode;ie.ParagraphReader.textLength(b)&&(b=Re.a.rw(b),this.vy.characterPropertiesEditor.replaceTextRange(b,
", "))}Oaa(){Od.a(8701125,307,!!this.vy);Od.a(8701126,307,ie.ParagraphReader.yh(this.Ac));Od.a(8701127,307,0>=this.vy.jU);this.vy.sXe()}static get Ug(){return null!=Ut.Dpg?Ut.Dpg:Ut.Dpg=Va.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(Ut,"TextOnlyBox4TableSteward",null,[769,374]);class dt{constructor(b,k,r=!1,y=!1){this.AG=b;this.Pw=k;this.KRj=r;this.SRj=y}create(b,k){return 1===b?new Ut(k,this.AG,this.Pw):new Un(k,this.AG,this.Pw,this.KRj,this.SRj)}}Object(m.a)(dt,"Box4TableStewardFactory",
null,[752]);class sv{create(){return new Wh.a}}Object(m.a)(sv,"Factory",null,[753]);class mq{constructor(b){this.ga=b}NLm(b){if(4===b)b=Wa.a.WCa;else if(2===b)b=Wa.a.Nga;else if(1===b)b=Wa.a.FMb;else if(3===b)b=Wa.a.FXa;else return;this.ga.processAction(b,2)}Ocb(){this.ga.processAction(Wa.a.Ocb,2)}}Object(m.a)(mq,"SelectionCommands",null,[751]);var or=c(263),et=c(1067),pu=c(147),$v=c(645);class bs{constructor(){this.ZPc=!1;this.sto=n.AFrameworkApplication.K.lb("WordEditorVisiFontFileUri");this.uto=
n.AFrameworkApplication.K.lb("WordEditorVisiRtlFontFileUri");this.tto=n.AFrameworkApplication.K.lb("WordEditorVisiPilcrowFontFileUri");this.pto=n.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnFontFileUri");this.rto=n.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnRtlFontFileUri")}zbo(){this.ZPc=!this.ZPc}ybo(b){this.zbo();let k=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],y=b.getElementsByClassName("VisiFontPilcrowStyle")[0],R=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],
aa=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];k||(k=document.createElement("Style"),k.className="VisiFontStyle",Fd.a.ly(k,""),b.appendChild(k));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",Fd.a.ly(r,""),b.appendChild(r));y||(y=document.createElement("Style"),y.className="VisiFontPilcrowStyle",Fd.a.ly(y,""),b.appendChild(y));R||(R=document.createElement("Style"),R.className="VisiFontCarriageReturnStyle",Fd.a.ly(R,""),b.appendChild(R));aa||(aa=document.createElement("Style"),
aa.className="VisiFontCarriageReturnRtlStyle",Fd.a.ly(aa,""),b.appendChild(aa));if(this.ZPc)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.hzc(k)&&this.hzc(r)&&this.hzc(y)&&this.hzc(R)&&this.hzc(aa);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.$Xc(k)&&this.$Xc(r)&&this.$Xc(y)&&this.$Xc(R)&&this.$Xc(aa)}hzc(b){return""===Fd.a.Rz(b)?("VisiFontStyle"===b.className?Fd.a.ly(b,this.oIc("WordVisi_MSFontService",this.sto)):"VisiFontRtlStyle"===
b.className?Fd.a.ly(b,this.oIc("WordVisiRtl_MSFontService",this.uto)):"VisiFontPilcrowStyle"===b.className?Fd.a.ly(b,this.oIc("WordVisiPilcrow_MSFontService",this.tto)):"VisiFontCarriageReturnStyle"===b.className?Fd.a.ly(b,this.oIc("WordVisiCarriageReturn_MSFontService",this.pto)):"VisiFontCarriageReturnRtlStyle"===b.className&&Fd.a.ly(b,this.oIc("WordVisiCarriageReturnRtl_MSFontService",this.rto)),!0):!1}$Xc(b){return""!==Fd.a.Rz(b)?(Fd.a.ly(b,""),!0):!1}oIc(b,k){return"@font-face { font-family: "+
b+"; src: url('"+k+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(bs,"VisiMarkersOperation",null,[696]);var qu=c(483),Ko=c(395);class Eh extends qu.a{constructor(b,k){super(b,k);this.qte=-1;this.Jpb=0;this.lqe=null;this.SJg=!1;this.ure=[];this.bed=!1;this.SSg=!0;this.fBe=this.Pbd=null;this.preventDismissOnScroll=this.K0d=this.tbc=!1;this.X5=null;this.wod=!1;this.XKc=!0;this.xu=!1;this.$Lg=n.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Eh.TYg||
(n.AFrameworkApplication.ya.pa(ib.a.showFloatie,zc.a.frame,Kd.ActionManager.Of),Eh.TYg=!0)}get lKh(){return this.rN}set lKh(b){this.rN=b}get ndj(){return this.wod}get YLc(){return this.SJg}set YLc(b){this.SJg=b;this.Jpb=0}get eA(){return!0}get cssClass(){return n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.R6?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.xu}RPa(){for(let b of this.children)if(b.RPa())return!0;return!1}get D7(){return 9}Rf(b){this.ure[this.ure.length]=
b;super.Rf(b)}im(){super.im();xf.c(this.Lc)&&this.JB();this.Lc=mg.a.jPa(this.Lc);this.ZV(this.Lc);this.dirty=!1}X$b(b){3===b.ig||this.K0d||this.tw(b);return!1}$$b(){return!1}Y$b(b){3!==b.ig&&this.XKc&&!this.tbc&&this.kno(b);return!1}Z$b(){return!1}V$b(b){3===b.ig&&this.tw(b);return!1}W$b(b){void 0!==this.X5&&null!==this.X5||this.preventDismissOnScroll||this.tw(b);return!1}$B(){this.z7e();return!1}cYd(){this.YLc=!0}kno(b){if(b=Gc.a.y0b(b.clientPoint,this.lqe)){if(this.YLc){if(!this.Jpb||b<this.Jpb)this.Jpb=
b;b-=this.Jpb}b-=this.qte;0>b&&(b=0);const k=255-4*b;0>=k&&63.75<=b?this.tw():X.a.setOpacity(this.Lc,Math.max(k/255,0))}else this.YLc=!1,this.Jpb=0,X.a.setOpacity(this.Lc,1)}Flo(b){let k=null;void 0!==this.Pbd&&null!==this.Pbd&&(k=this.Pbd(b));b=null;for(const r of this.ure){let y=!this.ndj&&r.Lji;if(!y&&void 0!==k&&null!==k)for(let R=0;R<k.length;R++)if(r.id===k[R]){y=!0;break}r.Lc.style.display=y?"none":"";r.w0b=!y;y||(b=r)}b&&(b.w0b=!1)}rSh(){const b=this.Lc.style.top,k=this.Lc.style.left;this.Lc.style.top=
"0px";this.Lc.style.left="0px";const r=this.FAb();this.Lc.style.top=b;this.Lc.style.left=k;return r}FAb(){const b=this.Lc.style.visibility,k=this.Lc.style.display;this.Lc.style.visibility="hidden";this.Lc.style.display="";const r=Qe.a.getElementBounds(this.Lc);this.Lc.style.display=k;this.Lc.style.visibility=b;return r}RMi(b){3===b||this.Dbe?(Sys.UI.DomElement.addCssClass(this.Lc,Ko.a.i4a),this.wod=!0):(Sys.UI.DomElement.removeCssClass(this.Lc,Ko.a.i4a),this.wod=!1);this.Flo(b)}t3a(b,k,r,y=!1){this.isVisible||
(this.X5||!this.SSg&&this.preventDismissOnScroll||(this.SSg=!1,Qe.a.$Ud("ShowLegacyFloatie",""),n.AFrameworkApplication.ya.processAction(ib.a.showFloatie,2)),this.RMi(r),this.XKc=!0,this.Jpb=0,this.YLc=!1,!this.$Lg||void 0!==this.X5&&null!==this.X5?(this.bed=!1,this.Ida(this,!1)):(this.bed=!0,this.rjk(this)),k=y?b:this.N8m(b,k),this.Lc.style.top=k.y.toString()+"px",this.Lc.style.left=k.x.toString()+"px",this.Nt(),this.lqe=this.FAb(),this.qte=Gc.a.y0b(b,this.lqe),X.a.setOpacity(this.Lc,1),this.Lc.style.zIndex=
String(n.AFrameworkApplication.ta.Ara),this.Lc.style.display="",this.xu=!0)}N8m(b,k){const r=this.ndj?30:17,y=this.rSh(),R=Fd.a.GBb(),aa=Fd.a.w2();b=new Sys.UI.Point(b.x,b.y);1===k?b.y-=y.height:3===k?(b.y-=y.height,b.x-=y.width):2===k&&(b.x-=y.width);b.x+y.width>R&&(b.x=Math.floor(R-y.width));0>b.x&&(b.x=0);b.y=3===k||1===k?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+y.height>aa&&(b.y=aa-y.height);return b}O8m(b,k){const r=b.isi;if(r){this.RMi(k);var y=this.rSh();this.X5=b;b=r.hag-r.NGc>y.width;var R=r.NGc+r.G$e>
y.width,aa=r.U1b>y.height+17,ta=r.xmj-(r.U1b+r.D$e)>y.height+17;y=new Sys.UI.Point(r.NGc,r.U1b);R||b||(R=!0,y.x=r.hag);b=r.lhb?r.wwf?ta?R?2:0:R?3:1:aa?R?3:1:R?2:0:r.wwf?ta?b?0:2:b?1:3:aa?b?1:3:b?0:2;if(3===b||2===b)y.x=r.NGc+r.G$e;if(2===b||0===b)y.y=r.U1b+r.D$e;this.t3a(y,b,k);this.XKc=!1;k=this.X5.UNe.Lc;void 0!==k&&null!==k&&(k.style.zIndex=String(n.AFrameworkApplication.ta.Ara))}}g2(){let b=super.g2();this.tw()&&(b=!0);return b}tw(b=null){if(!this.isVisible)return!1;void 0!==this.eyc&&null!==
this.eyc&&this.eyc.Csa(null);void 0!==this.X5&&null!==this.X5&&this.X5.Qda();this.Qda();this.$Lg&&this.bed?this.x3k(this):this.v$(this,!1);this.bed=!1;this.qte=-1;this.X5=null;this.Lc.style.display="none";this.xu=!1;this.fBe&&this.fBe(b);return!0}z7e(){void 0!==this.X5&&null!==this.X5&&(this.X5.xVa=null,this.X5.Qda(),this.X5=null,this.pVd.style.zIndex=String(n.AFrameworkApplication.ta.oza),this.Lc.style.zIndex=String(n.AFrameworkApplication.ta.Ara))}Znn(b){this.Pbd=b}Mon(b){this.fBe=b}set eA(b){super.eA=
b}}Eh.TYg=!1;Object(m.a)(Eh,"Floatie",qu.a,[520,278,279]);class Qo{constructor(b,k){this.Uu=this.lHa=null;this.Epi=b;this.pVi=k}get nKh(){return this.lHa}RSn(b){this.lHa=b}FAb(){return this.Uu.FAb()}QZ(){return this.Uu?this.Uu.isVisible:!1}Ogh(b){this.RSn(b)}showFloatie(b,k){this.t3a(k.location,k.$w,k.isRtl)}t3a(b,k,r){r=r?this.pVi:this.Epi;this.dBd();this.Uu&&this.Uu.t3a(b,r,k)}tw(){this.Uu&&this.Uu.tw()}dBd(){this.lHa&&!this.Uu&&(this.Uu=Object(ia.a)(Eh,this.lHa()))}SBd(){}}Object(m.a)(Qo,"AFloatieManager",
null,[719]);class Am extends Qo{constructor(){super(1,3);this.xbj=!1;this.rAh=""}t3a(b,k,r){r=r?this.pVi:this.Epi;this.dBd();this.Uu&&(this.Uu.isVisible&&this.Uu.tw(),this.xbj||this.Uu.xl(),this.Uu.t3a(b,r,k,!0))}dBd(){this.nKh&&!this.Uu&&(this.Uu=this.lHa())}SBd(){if(this.Uu&&this.Uu.isVisible){const b=Object(ia.a)(km.Control,this.Uu.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.uw(b.Tdb(),1,null)}}IZf(b){this.rAh=b}lvn(b){b=b.Edf("Menu16",null);ni.a("renderIcon")&&b&&appChrome.api.renderIcon(Am.PCj,
b.firstElementChild)}Ihc(b,k,r){if(this.Uu){const y=this.Uu.controls[this.rAh];y&&(Am.yLg||(this.lvn(y),Am.yLg=!0),y.Od[xj.a.labelText]=b,y.Od[xj.a.alt]=k,r&&y.behavior.xl())}}}Am.yLg=!1;Am.PCj="Designer_20";Object(m.a)(Am,"PasteFloatieManager",Qo,[]);var Np=c(1008);class Tq{constructor(){this.Kd=null}get qw(){return null}getTitle(){return null}TQh(){return null}reset(b){this.Kd=b.node}qFa(b){b=Qm.d(this.Kd,b);let k=null;if(!b||b.li!==this.li)return{returnValue:!1,VE:k};k=Object.assign(new Np.a,{YF:this.key,
contentObject:b,title:this.getTitle(b),description:this.TQh(b)});return{returnValue:!0,VE:k}}}Object(m.a)(Tq,"BlobDetailsProvider",null,[298,299]);class bk extends Tq{constructor(){super()}get key(){return"EQUATION"}get li(){return 11}get qw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(bk,"EquationDetailsProvider",Tq,[]);class nv{constructor(){this.zJg=null}get key(){return"LINK"}get qw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.zJg=sh.HyperlinkReader.CIc(b.node)}qFa(b){let k=
null;for(const r of this.zJg)if(r.cpBegin<=b&&b<r.cpEnd)return k=Object.assign(new Np.a,{YF:this.key,contentObject:r.hyperlink}),{returnValue:!0,VE:k};return{returnValue:!1,VE:k}}}Object(m.a)(nv,"HyperlinkDetailsProvider",null,[298,299]);var Xv=c(1338),Ex=c(865);class Fx{constructor(){this.gOg=!1}get key(){return"IFRAMENODE"}get qw(){return this.gOg?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}lhc(b){let k=null;b=b?ie.ParagraphReader.ULa(b.currentNode):null;
if(!b)return{returnValue:!1,uka:k};k=Object.assign(new Xv.a,{YF:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,uka:k}}xAb(b,k){b=b?Object(ia.a)(Ex.a,b.contentObject):null;k=k?Object(ia.a)(Ex.a,k.contentObject):null;let r="";k&&b.id===k.id||(this.gOg=b.c0a,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.qw,this.qw));return r}}Object(m.a)(Fx,"IFrameDetailsProvider",null,[718,299]);class Jw extends Tq{constructor(){super()}get key(){return"IMAGE"}get li(){return 5}get qw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Pd.ImageReader.pT(b.properties)}TQh(b){return Pd.ImageReader.sBa(b.properties)}}
Object(m.a)(Jw,"ImageDetailsProvider",Tq,[]);class Ng{get key(){return"IMAGENODE"}get qw(){return Box4Intl.Box4Strings.l_ImageContentTitle}lhc(b){let k=null;if(!b||!Pd.ImageReader.Ov(b.currentNode))return{returnValue:!1,uka:k};k=Object.assign(new Xv.a,{YF:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,uka:k}}xAb(b,k){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let y="";k&&b.id===k.contentObject.id||(y=String.format(r,Pd.ImageReader.pT(b.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return y}}Object(m.a)(Ng,"ImageNodeDetailsProvider",null,[718,299]);let Vg,Dn;class En{constructor(b,k){this.CEg=null;this.Zm=k;this.ZDe=b;this.key=En.keys.J(b);this.qw=En.mGk.J(b)}reset(b){this.CEg=this.Zm.q2(b.node)}qFa(b){var k=En.Qbl(this.CEg||[],r=>this.Kcm(b,r));k=this.sKk(k);return{returnValue:!!k,VE:k}}Kcm(b,k){return k.begin<=b&&b<k.end&&(!k.errorDetails||this.ZDe===k.errorDetails.proofingType)}sKk(b){return b?Object.assign(new Np.a,{YF:this.key,
contentObject:b.errorDetails,description:this.Qdb()}):null}Qdb(){return n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static Qbl(b,k){for(const r of b)if(k(r))return r;return null}}En.keys=(Dn=new Na.a,Dn.add(1,"SPELLINGERROR"),Dn.add(2,"GRAMMATICALERROR"),Dn.add(3,"ADVANCEDERROR"),Dn);En.mGk=(Vg=new Na.a,Vg.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Vg.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
Vg.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Vg);Object(m.a)(En,"ProofingDetailsProvider",null,[298,299]);class lh{constructor(){this.tableNode=null;this.yvd=this.p5d=this.columns=this.rows=0}}Object(m.a)(lh,"TableInfo",null,[]);class Pt{get key(){return"TABLE"}get qw(){return Box4Intl.Box4Strings.l_TableContentTitle}lhc(b){var k=null;if(!Ei.TableCellReader.isTableCell(b))return{returnValue:!1,uka:k};k=new Wd.GraphIterator;k.ed(b);b=new lh;b.p5d=bm.a.Rr(k)+1;b.yvd=Jl.a(k)+1;
bf.returnToContainingTable(k);b.tableNode=k.currentNode;b.columns=Si.TableReader.Yg(b.tableNode);b.rows=Si.TableReader.$f(b.tableNode);k=Object.assign(new Xv.a,{YF:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,uka:k}}xAb(b,k){b=b.contentObject;const r=new Ge.a;k||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));k&&k.contentObject.yvd===b.yvd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.yvd));k&&k.contentObject.p5d===
b.p5d||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.p5d));return r.toArray().join(" ")}}Object(m.a)(Pt,"TableDetailsProvider",null,[718,299]);class Yv{constructor(b,k){this.qHa=b;this.Zm=k}JRf(){this.qHa.execute(b=>{b.w3(new nv);b.w3(new En(1,this.Zm));b.w3(new En(2,this.Zm));b.w3(new En(3,this.Zm));b.w3(new bk);b.w3(new Jw);b.ncc(new Pt);b.ncc(new Ng);b.ncc(new Fx)})}}Object(m.a)(Yv,"AccessibilityActor",null,[]);class nu{constructor(b,k,r){this.U0m=(y,R,aa)=>{if(1===
aa)return 32;this.ryj().j1f();return 32};this.aVa=b;this.ryj=r}Vb(){this.aVa.gb(Wa.a.FCi,lc.a.view,this.U0m,1028)}}Object(m.a)(nu,"AutoCorrectActor",null,[]);var bj=c(1821);class Lm{constructor(){this.WUd=!0}eva(){}s1a(){}tYb(){}oIf(){}$6d(){}get cbc(){return!1}get fib(){return 0}get Iri(){return!1}get e2(){return Ra.a.nil}}Object(m.a)(Lm,"TextOnlyBox4ImageSteward",null,[717]);class wr{constructor(b,k,r,y,R,aa,ta=!1,Ya=!1,xb=!1,Mb=!1){this.tj=b;this.Hb=k;this.xm=r;this.qpc=y;this.KY=R;this.i9a=ta;
this.KCe=Ya;this.Rse=xb;this.Eye=Mb;this.Ic=aa}create(b,k,r,y){return 1===b?new Lm:new bj.a(k,this.tj,this.Hb,this.xm,this.Ic,this.qpc,this.KY,this.i9a,this.KCe,this.Rse,this.Eye,r,y)}}Object(m.a)(wr,"Box4ImageStewardFactory",null,[695]);var vm=c(41);class aq{constructor(b){this.eQd=b}Bjm(b){if(!b||!b.FA||1>b.FA.count)return!1;const k=[vm.a.vxh,vm.a.uxh];return!!this.LEd(b.FA,1,r=>this.uwd(r,k))}ydi(b){return!b||!b.FA||1>b.FA.count?!1:!!this.LEd(b.FA,1,k=>this.uwd(k,[vm.a.qI]))}Igm(b){return!b||!b.FA||
1>b.FA.count?!1:!!this.LEd(b.FA,2,k=>this.uwd(k,[vm.a.lSd]))}yh(b){return!b||!b.FA||1>b.FA.count?!1:!!this.LEd(b.FA,1,k=>this.uwd(k,[vm.a.r3]))}aPd(b){if(!b||!b.FA)return!1;b=b.FA;for(let k=0;k<b.count;++k)if(!b.J(k)||0<b.J(k).Jhk)return!1;return!0}X5k(b,k){return this.ydi(k)||this.Igm(k)?"":b}LEd(b,k,r){if(b&&0<b.count)for(let y=b.count-1;0<=y;--y){if(r(b.J(y)))return b.J(y);if(b.count-y>=k)break}return null}uwd(b,k){b=b&&b.z7h?b.z7h.split(" "):null;if(!b)return!1;for(const r of k)if(0<=Array.indexOf(b,
r))return!0;return!1}}Object(m.a)(aq,"Box4PasteStewardUtils",null,[694]);var Rr=c(721);class ov{constructor(){this.Nmi={};this.vyd=-1}}Object(m.a)(ov,"LevelLists",null,[]);class Gx{constructor(b,k,r){this.i8=this.level=0;this.NHh=null;this.Vac=!1;this.level=b;this.uic=k;this.jDi=r}}Object(m.a)(Gx,"ListItemMetadata",null,[]);class Vt{constructor(){this.i8=0;this.tagName="UL";this.AGc=null;this.ignore=!1;this.ZSc=0}}Object(m.a)(Vt,"ListMetadata",null,[]);class Mu{constructor(b){this.nodes=b;this.b2=
0;this.lists={};this.$ma=[];this.P8b=null;this.sAa=[];this.sAa[0]=new ov}}Object(m.a)(Mu,"WordConverterArguments",null,[]);var Fh=c(1489);class Yg{constructor(b=null){this.Hgd=1;this.OV=b||Fh.a.Pjf("")}get Jc(){return this.OV}process(b,k){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new Rr.a(k,Object(u.a)(this,this.aOf,"processNodesDiscovery"),new Mu(b)),b.ll("Word Converter Operation"),b.fh=!k||k.fh,b.run())}aOf(b,k){const r=k.nodes[k.b2];var y=Yg.Jff(r);if(y){let R=k.sAa[y.level-
1];R||(R=new ov,k.sAa[y.level-1]=R);k.P8b&&Yg.AJc(r)!==k.P8b&&Yg.Hyn(k);let aa=R.Nmi[y.uic];if(!aa)aa=new Vt,aa.i8=this.Hgd++,aa.AGc=Yg.oef(r,5),aa.ignore=!aa.AGc||!aa.AGc.length,aa.tagName=Yg.LFd(aa.AGc),R.Nmi[y.uic]=aa,k.lists[aa.i8.toString()]=aa;else if(!aa.ignore&&1===aa.ZSc){const ta=Yg.oef(r,5);aa.tagName=aa.AGc===ta?"UL":"OL"}y.i8=aa.i8;aa.ignore||"OL"===aa.tagName&&0<aa.ZSc&&R.vyd!==y.i8?(aa.ignore=!0,k.sAa[0].vyd=-1,k.sAa=k.sAa.slice(0,1)):(k.sAa.length>y.level&&(k.sAa=k.sAa.slice(0,y.level)),
R.vyd=y.i8,k.$ma[k.$ma.length]=y,aa.ZSc++);k.P8b=r}else if((y=k.P8b)&&Yg.AJc(r)===y&&r.tagName===y.tagName&&r.className===y.className){y.appendChild(y.ownerDocument.createElement("BR"));for(y.appendChild(y.ownerDocument.createElement("BR"));r.firstChild;)y.appendChild(r.firstChild);r.parentNode.removeChild(r)}k.b2++;if(k.nodes.length<=k.b2){if(!k.$ma.length)return!1;k.b2=0;b.ui(Object(u.a)(this,this.$Nf,"processNodeConvert"))}return!0}$Nf(b,k){var r=k.$ma[k.b2];b=r.jDi;const y=k.lists[r.i8.toString()];
if(!y.ignore&&(r=Yg.vDl(b,r,y))){Yg.dBc(b,5);const R=b.ownerDocument.createElement("LI");for(;b.firstChild;)R.appendChild(b.firstChild);r.appendChild(R);b.parentNode.removeChild(b);"UL"===y.tagName?this.Jc.b++:this.Jc.c++}k.b2++;return k.b2<k.$ma.length}static vDl(b,k,r){let y=Yg.DMi(b,k.level,r);const R=jj.a.Db(y,"UniqueListId");if(R&&R!==k.i8||!R&&y.firstChild)b=b.ownerDocument.createElement(r.tagName),y.parentNode.insertBefore(b,y.nextSibling),y=b;jj.a.yl(y,"UniqueListId",k.i8);return Yg.m_e(y,
r)}static m_e(b,k){if(k.tagName!==b.tagName){k=b.ownerDocument.createElement(k.tagName);for(jj.a.yl(k,"UniqueListId",jj.a.Db(b,"UniqueListId"));b.firstChild;)k.appendChild(b.firstChild);b.parentNode.insertBefore(k,b);b.parentNode.removeChild(b);b=k}return b}static DMi(b,k,r){let y=null,R;1===k?R=Yg.AJc(b):(y=Yg.DMi(b,k-1,null),R=y.lastChild);if(R&&1===R.nodeType){const aa=R.tagName.toUpperCase();if("UL"===aa||"OL"===aa)return R}r=b.ownerDocument.createElement(r?r.tagName:"UL");1===k?b.parentNode.insertBefore(r,
b):y.appendChild(r);return r}static dBc(b,k){for(let r=0;r<b.childNodes.length;r++){const y=b.childNodes[r];1===y.nodeType&&1<k&&Yg.dBc(y,k-1);if(Yg.Qqf(y)||Yg.cOc(y))b.removeChild(y),r--}}static Jff(b){if(1===b.nodeType){const k=Yg.b4b(b,"mso-list");if(k&&0<k.length)try{const r=k.split(" ");if(3===r.length){const y=Number.parseInvariant(r[1].substr(5));return new Gx(y,k,b)}}catch(r){}}return null}static LFd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static oef(b,k){let r=null;
for(let y=0;!r&&y<b.childNodes.length;y++){const R=b.childNodes[y];Yg.cOc(R)?(r="string"===typeof R.innerText?R.innerText.trim():R.textContent.trim(),r.length||(r="o")):1===R.nodeType&&1<k&&(r=Yg.oef(R,k-1))}return r}static cOc(b){return 1===b.nodeType&&(b=Yg.b4b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Qqf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static b4b(b,k){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(k)){b=b.split(";");
for(let r=0;r<b.length;r++){const y=b[r].split(":");if(2===y.length&&y[0].trim()===k)return y[1].trim()}}return null}static AJc(b){do b=b.previousSibling;while(b&&Yg.JNc(b));return b}static JNc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Yg.hye,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Yg.JNc(b.firstChild):!0}static Hyn(b){for(let k=0;k<b.sAa.length;k++){const r=b.sAa[k];r&&(r.vyd=-1)}}}Yg.hye=RegExp("[\n|\r]","gi");Object(m.a)(Yg,
"WordConverter",null,[375]);class Op{constructor(){this.i8=0;this.h9b=Array(9)}}Object(m.a)(Op,"FullListMetadata",null,[]);var Lj=c(1015);class Bp{constructor(){this.level=0;this.tagName="UL";this.Phb=null;this.ignore=!1;this.ZSc=0;this.listStyle="BulletListStyle1";this.$ma=new Lj.a;this.font=this.levelText=""}}Object(m.a)(Bp,"ListLevelMetadata",null,[]);var Hu=c(1369),Iq=c(586);class hl{constructor(b=null){this.OV=b||Fh.a.Pjf("");this.Hgd=Number.parseInvariant((new Date).format("HHmmss"))}get Jc(){return this.OV}process(b,
k){if(b&&b.querySelectorAll){const aa=b.querySelectorAll("p");if(aa&&0<aa.length){for(var r=0,y=!1,R=aa[0].parentNode;5>r&&R&&R!==b;){r++;const ta=R.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(R,"WACEditing")&&Sys.UI.DomElement.containsCssClass(R,"EditingSurfaceBody")){y=!0;break}R=R.parentNode}if(y&&R!==b){r=b.firstChild;for(y=!1;0<R.children.length&&R.children[0]!==r;)b.insertBefore(R.children[0],r),y=!0;if(y)for(;r;)R=r.nextSibling,
b.removeChild(r),r=R}b=new Rr.a(k,Object(u.a)(this,this.aOf,"processNodesDiscovery"),new Mu(aa));b.ll("Word Converter Operation");b.fh=!k||k.fh;b.run()}}}aOf(b,k){const r=k.nodes[k.b2];var y=hl.Jff(r);if(y){let aa=y.uic.replace(RegExp("level[0-9]"),"").trim();aa=aa&&aa.length?aa:y.uic;let ta=k.lists[aa];ta||(ta=new Op,ta.i8=this.Hgd++);let Ya=ta.h9b[y.level-1];Ya||(Ya=new Bp,Ya.level=y.level);var R=r.parentNode;if(R&&"li"===R.tagName.toLowerCase()){if(R=R.parentNode)!(R=R.tagName.toUpperCase())||
"OL"!==R&&"UL"!==R||(Ya.tagName=R)}else Ya.Phb=hl.NRh(r,5),Ya.Phb&&Ya.Phb.length||(Ya.Phb=hl.Cif(r,5)),Ya.ignore=!Ya.Phb||!Ya.Phb.length,Ya.tagName=hl.LFd(Ya.Phb),"UL"===Ya.tagName&&(Ya.font=this.ySh(r,5));y.i8=ta.i8;Ya.ZSc++;Ya.ignore||"li"===r.parentNode.tagName.toLowerCase()||(R=(R=hl.Cif(r,5))?R:Ya.Phb)&&R.length&&(y.NHh=R,(R=hl.kOn(r,R,Ya.listStyle,y.level-1))&&R.length&&(Ya.listStyle=R));k.$ma[k.$ma.length]=y;Ya.$ma.contains(y)||Ya.$ma.add(y);if(void 0===ta.h9b[y.level-1]||null===ta.h9b[y.level-
1]||ta.h9b[y.level-1]!==Ya)ta.h9b[y.level-1]=Ya;k.lists[aa]&&k.lists[aa]===ta||(k.lists[aa]=ta);k.P8b=r}else if((y=k.P8b)&&hl.AJc(r)===y&&r.tagName===y.tagName&&r.className===y.className){y.appendChild(y.ownerDocument.createElement("BR"));for(y.appendChild(y.ownerDocument.createElement("BR"));r.firstChild;)y.appendChild(r.firstChild);r.parentNode.removeChild(r)}k.b2++;if(k.nodes.length<=k.b2){if(!k.$ma.length)return!1;k.b2=0;b.ui(Object(u.a)(this,this.$Nf,"processNodeConvert"))}return!0}$Nf(b,k){b=
k.$ma[k.b2];var r=b.jDi,y=b.uic.replace(RegExp("level[0-9]"),"").trim();y=y&&y.length?y:b.uic;y=k.lists[y];var R=y.h9b[b.level-1],aa=r.parentNode.tagName.toLowerCase();if(!R.ignore&&r.parentNode&&"li"!==aa){if(aa=hl.BMk(r,R)){hl.dBc(r,5);const ta=r.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",b.level));ta.setAttribute(Iq.a.YQc,String.format("{0}",y.i8));"UL"===R.tagName&&(ta.setAttribute(Iq.a.uSd,String.format("{0}",b.NHh)),ta.setAttribute(Iq.a.dxf,String.format("{0}",
R.font)));for(;r.firstChild;)ta.appendChild(r.firstChild);aa.appendChild(ta);r.parentNode.removeChild(r);"UL"===R.tagName?this.Jc.b++:this.Jc.c++}}else"li"===aa&&(R=R.tagName,r=r.parentNode,b.Vac&&(b=r.parentNode)&&b.tagName.toUpperCase()===R&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(Iq.a.YQc,String.format("{0}",y.i8)),"UL"===R?this.Jc.b++:this.Jc.c++);k.b2++;return k.b2<k.$ma.length}ySh(b,k){let r=null;for(let y=0;!r&&y<b.childNodes.length;y++){const R=b.childNodes[y];r=hl.Cul(R);
!r&&1===R.nodeType&&1<k&&(r=this.ySh(R,k-1))}return r}static BMk(b,k){b=hl.zMk(b,k.tagName);return hl.m_e(b,k)}static m_e(b,k){if(k.tagName!==b.tagName){for(k=b.ownerDocument.createElement(k.tagName);b.firstChild;)k.appendChild(b.firstChild);b.parentNode.insertBefore(k,b);b.parentNode.removeChild(b);b=k}return b}static zMk(b,k){k=b.ownerDocument.createElement(k?k:"UL");var r=b.getAttribute("start");r&&0<r.length&&(k.setAttribute("start",r),b.removeAttribute("start"));(r=b.className)&&0<r.length&&
(r="OL"===k.tagName?Hu.a.XId(r,"NumberListStyle"):Hu.a.XId(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(k,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(k,b);return k}static dBc(b,k){for(let r=0;r<b.childNodes.length;r++){const y=b.childNodes[r];1===y.nodeType&&1<k&&hl.dBc(y,k-1);if(hl.Qqf(y)||hl.cOc(y))b.removeChild(y),r--}}static Jff(b){if(1===b.nodeType){var k=hl.b4b(b,"mso-list");if(k&&0<k.length)try{var r=k.split(" ");if(3===r.length){const y=Number.parseInvariant(r[1].substr(5)),
R=new Gx(y,k,b);R.Vac=!0;return R}}catch(y){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(k=r.getAttribute("data-"+Ef.a.rsd),r=r.getAttribute(Iq.a.YQc),k&&r&&0<k.length&&0<r.length))return b=new Gx(Number.parseInvariant(k),r+" level"+k,b),b.Vac=!1,b}return null}static kOn(b,k,r,y){if("p"===b.tagName.toLowerCase()&&k&&k.length){if("UL"===hl.LFd(k))return r=hl.Lll(k),Sys.UI.DomElement.addCssClass(b,r),r;var R=k.match(RegExp("^[0-9]+"));return R&&R.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,
r),b.setAttribute("start",R[0]),r):(R=k.match(RegExp("^[a-zA-Z]+")))&&R.length&&(R=R[0],y=(k=R.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&k.length?hl.PIl(r,y):1,1!==y&&((r=hl.Rwd(b,R,RegExp("^[ivxlcdm]+"),A.a.Tsh,"NumberListStyle3"))||(r=hl.Rwd(b,R,RegExp("^[IVXLCDM]+"),A.a.Tsh,"NumberListStyle5")))||y&&((r=hl.Rwd(b,R,RegExp("^[a-z]+"),A.a.Ssh,"NumberListStyle2"))||(r=hl.Rwd(b,R,RegExp("^[A-Z]+"),A.a.Ssh,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static Lll(b){switch(b){case "o":return"BulletListStyle2";
case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static PIl(b,k){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(k%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static Rwd(b,k,r,y,R){return(k=k.match(r))&&k.length?(y=y(k[0]),y=1>y?1:y,Sys.UI.DomElement.addCssClass(b,R),b.setAttribute("start",y+""),R):null}static LFd(b){return hl.mbm(b)?
"UL":"OL"}static mbm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Cif(b,k){let r=null;var y;let R,aa;for(let ta=-1;!r&&ta<b.childNodes.length;ta++){const Ya=-1===ta?b:b.childNodes[ta];if(Ya)if((y=Ya.innerHTML)&&0<y.length){if(R=y.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=R&&(aa=y.indexOf("\x3c!--[endif]--\x3e"),0<=aa)){y=y.substring(R,aa+14);Ya.innerHTML=Ya.innerHTML.replace(y,"");if(y.length){b=b.ownerDocument.createElement("span");
b.innerHTML=y;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=ta&&1===Ya.nodeType&&1<k&&(r=hl.Cif(Ya,k-1))}return r}static Cul(b){let k=null;1===b.nodeType&&((k=hl.xSh(b,"font-family"))||(k=hl.xSh(b,"mso-ascii-font-family")));return k}static xSh(b,k){return(b=hl.b4b(b,k))&&0<b.length?b.trim():null}static NRh(b,k){let r=null;for(let y=0;!r&&y<b.childNodes.length;y++){const R=b.childNodes[y];hl.cOc(R)?(r="string"===typeof R.innerText?R.innerText.trim():R.textContent.trim(),r.length||(r="o"),
R.parentNode.removeChild(R)):1===R.nodeType&&1<k&&(r=hl.NRh(R,k-1))}return r}static cOc(b){return 1===b.nodeType&&(b=hl.b4b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Qqf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static b4b(b,k){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(k)){b=b.split(";");for(let r=0;r<b.length;r++){const y=b[r].split(":");if(2===y.length&&y[0].trim()===k)return y[1].trim()}}return null}static AJc(b){do b=
b.previousSibling;while(b&&hl.JNc(b));return b}static JNc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(hl.hye,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:hl.JNc(b.firstChild):!0}}hl.hye=RegExp("[\n|\r]","gi");Object(m.a)(hl,"WacAndRichClientWordConverter",null,[375]);class aw{constructor(b){this.wZ=b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.wZ?new hl(b):new Yg(b)}}Object(m.a)(aw,
"Box4WordConverterFactory",null,[680]);var tv=c(1679);class nq{constructor(b,k,r,y,R){this.wEg=0;this.Rto=aa=>{let ta=!0;const Ya=this.ida.Q4k;null!=Ya?(aa.kga=Ya,ta=!1):Date.now()-this.wEg>this.zke&&(v.ULS.sendTraceTag(18354843,307,50,null),this.nd.Zb($c.a.hla,{["Reason"]:bd.a.$Ci}),ta=aa.kga=!1);return ta};this.nd=b;this.te=k;this.zke=R;this.ida=r;this.aJa=y}Dwk(b,k,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",k,r,this.te.dF);b.fh&&this.te.yp&&window.chrome&&
v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",k);this.ida.BFc(!!(k&16));this.aJa.create(b,this.Rto,null).ll("ClipboardPreProcess");this.wEg=Date.now()}vzn(){this.ida.reset()}}Object(m.a)(nq,"ClipboardOperationClipboardAccessHelper",null,[679]);class Kw{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne){this.bTa=null;this.ga=b;this.nd=k;this.qz=r;this.Kh=y;this.hb=R;this.ida=aa;this.fb=ta;this.He=Ya;this.Bn=xb;
this.Yc=Mb;this.b9a=cc;this.OEe=jc;this.Dy=Mc;this.Yj=Td;this.yRb=fd?fd.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.ged=fd?fd.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Ic=ne}get Ug(){return this.Kh}get Kc(){return this.nd}get zNc(){if(null==this.bTa)if(this.Ic)if(this.Ic.io.isCompleted)this.bTa=this.Ic.isFeatureEnabled(30)&&this.Ic.isFeatureEnabled(2);else return!1;else this.bTa=!1;return this.bTa}Lto(b){b.l0();return!0}wth(b,k){b=k.Dz;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&
256){let y=!1,R;X.a.NCa&&n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.zNc&&k.ve&&k.ve.Wg&&(y=this.Yj.F9g(k.ve.Wg.editingElement));R=this.Yj.Ukf(k.ve.Wg.editingElement,!1);var r=k.ve.Wg.editingElement;this.Yj.opf(r,!1,1);this.yRb&&X.a.NCa?(r=k.ve.Wg.editingElement,this.Yj.$Tf(r,"data-src","data-srcurl"),b=this.ida.copy(),this.Yj.$Tf(r,"data-srcurl","data-src")):this.ged&&k.ve&&k.ve.Wg?(r=this.Yj.xWe(k.ve.Wg.editingElement,k.ve.Jv,!0),
b=this.ida.copy(),r&&this.Yj.xWe(k.ve.Wg.editingElement,k.ve.Jv,!1)):(this.Yj.gQi(k.ve.Wg.editingElement),b=this.ida.copy());this.zNc&&y&&this.Yj.ptn(k.ve.Wg.editingElement);R&&this.Yj.Ukf(k.ve.Wg.editingElement,!0);r=k.ve.Wg.editingElement;this.Yj.opf(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Kc.Zb($c.a.wzb,{["Reason"]:bd.a.v4f}),k.KQ&&k.KQ.fail("SystemClipboard did not copy",!1),k.failed=!0,!1}return!0}w_e(b,k){const r=k.ve;v.ULS.shipAssertTag(18130961,
307,!!(k.Dz&16));k.o1n?this.qz.moh():this.qz.gxd(r,b);return!0}Kzh(b,k){var r=k.context,y=k.Ed;const R=k.C7;var aa=!1;b=this.hb.ib.kb.Tc;if(this.fb.em(b)||this.He.qk(b)){const ta=this.Yc.Zf(b.node),Ya=ta.rd();v.ULS.shipAssertTag(18130962,307,Ya);this.Bn.Xd(ta);this.b9a.tgb(ta)&&(aa=!0)}y=k.Dz&64?new Di.DictionaryPropertySet:y||new Di.DictionaryPropertySet;y.setValue(td.a.zEc,!1);r=this.ga.Vf(r,Wa.a.XG,2,!0,R,y);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Kc.Zb($c.a.hla,{["Reason"]:bd.a.Jzh}),
k.KQ&&k.KQ.fail("DeleteKey failed",!1),k.failed=!0);32===r&&aa&&(k=this.hb.ib.kb,this.He.Dm(k)&&k.Qa.node===b.node&&!this.fb.textLength(k.Qa.node)&&(k=this.Yc.Zf(k.Qa.node),b=this.He.Pt(k),v.ULS.shipAssertTag(18130964,307,b),this.Bn.Xd(k),this.b9a.QOd(k)||(b=this.OEe.create(),b.ed(k),this.Bn.e3(b,!1,!1),aa=this.Bn.Fe(b),this.fb.nc(aa)&&(this.Bn.Xd(b),this.Ug.merge(b,k,!1,!1),this.hb.setSelection(this.Dy.xe(aa,this.fb.textLength(aa)))))));return!0}}Object(m.a)(Kw,"ClipboardOperationCutCopy",null,[708]);
class Lw{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne){this.ga=b;this.nd=k;this.qz=r;this.ida=aa;this.hb=R;this.Kh=y;this.fb=ta;this.He=Ya;this.Bn=xb;this.Yc=Mb;this.b9a=cc;this.OEe=jc;this.Dy=Mc;this.Oa=fd;this.Yj=Td;this.Ic=ne}create(){return new Kw(this.ga,this.nd,this.qz,this.Kh,this.hb,this.ida,this.fb,this.He,this.Bn,this.Yc,this.b9a,this.OEe,this.Dy,this.Oa,this.Yj,this.Ic)}}Object(m.a)(Lw,"Factory",null,[678]);var Hx=c(1611);class Iu{constructor(b,k){this.G8c=null;this.YHk=(r,y)=>
{if(!Object(Jb.a)(89,y.Ed))return!1;const R=Object(ia.a)(89,y.Ed);if(!R.hasProperty(td.a.Xjf))return!1;const aa=R.getValue(td.a.Xjf),ta=y.ve,Ya=ta.Cb;this.qz.ilj();Ya.EJb(()=>{Ya.setSelection(aa,void 0,!0);this.qz.gxd(ta,r)},!0);return!0};this.qz=b;this.v4=k;this.HH=0}process(b,k){this.HH||(this.G8c=[this.YHk,Object(u.a)(this.v4,this.v4.L5m,"pasteGlossaryPlaceholder")]);let r=!0;this.HH<this.G8c.length&&(r=this.G8c[this.HH++](b,k));return r?this.HH<this.G8c.length:!1}}Object(m.a)(Iu,"ClipboardOperationContentControlShowPlaceholderProcessor",
null,[707]);var Qt=c(642);class Mw{constructor(b){this.Pob=null;this.w0=b;this.HH=-1}process(b,k){-1===this.HH&&(this.LRk(b,k),this.HH=0);let r=!1;this.HH<this.Pob.length&&(r=this.Pob[this.HH++](b,k));return r?this.HH<this.Pob.length:!1}LRk(b,k){X.a.N2||k.Dz&512?(this.Pob=[Object(u.a)(this.w0,this.w0.w_e,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.fh&&k.Dz&256?(this.Pob=[Object(u.a)(this.w0,this.w0.Lto,"waitBeforeCopy"),
Object(u.a)(this.w0,this.w0.wth,"copyExternal"),Object(u.a)(this.w0,this.w0.w_e,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.Pob=[Object(u.a)(this.w0,this.w0.wth,"copyExternal"),Object(u.a)(this.w0,this.w0.w_e,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));k.Dz&32&&(b=Object(u.a)(this.w0,this.w0.Kzh,
"deleteForCut"),this.Pob.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Qt.a.Iym(k)}}Object(m.a)(Mw,"ClipboardOperationCutCopyProcessor",null,[706]);class Dy{constructor(b,k,r,y){this.ugd=null;this.aIk=(R,aa)=>{aa=aa.ve;this.qz.Eqo();this.qz.gxd(aa,R);return!0};this.rSc=(R,aa)=>{aa=new lj.Selection([aa.Ed],!0);this.hb.setSelection(aa,R);return!0};this.qz=b;this.hb=k;this.w0=r;this.v4=y;this.HH=0}process(b,k){this.HH||(this.ugd=
[this.aIk,Object(u.a)(this.w0,this.w0.Kzh,"deleteForCut"),this.rSc,Object(u.a)(this.v4,this.v4.iFi,"pasteInternal"),Object(u.a)(this.v4,this.v4.A1i,"setSelectionAfterPaste")]);let r=!0;this.HH<this.ugd.length&&(r=this.ugd[this.HH++](b,k));return r?this.HH<this.ugd.length:!1}}Object(m.a)(Dy,"ClipboardOperationMoveProcessor",null,[705]);var Ix=c(1610);class Nw{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff){this.qz=b;this.ga=k;this.Qkc=r;this.nd=y;this.He=R;this.te=aa;this.Hc=ta;this.$7c=
Ya;this.qAj=xb;this.XOb=Mb;this.Nke=cc;this.Fkc=jc;this.aJa=Mc;this.HC=fd;this.Jd=Td;this.xm=ne;this.MY=ye;this.kda=ff}create(b,k,r,y,R,aa,ta,Ya,xb=!0){const Mb=this.$7c.create(y,Object(ia.a)(89,Ya));var cc=this.qAj.create();const jc=new Iu(this.qz,Mb),Mc=new Dy(this.qz,bh.a.instance,cc,Mb);cc=new Mw(cc);y=new Ix.a(n.AFrameworkApplication.K,nr.a.instance,y,Db.a.instance,Mb,this.XOb);return new Hx.a(b,k,r,R,aa,ta,Ya,this.Qkc,this.ga,this.nd,this.He,this.te,this.Hc,jc,Mc,cc,y,this.XOb,this.Nke,this.Fkc,
this.aJa,this.HC,this.Jd,this.xm,this.MY,this.kda,n.AFrameworkApplication.F0f(),xb)}}Object(m.a)(Nw,"Factory",null,[675]);var Jx=c(270);class Vd{constructor(b,k){this.OBb=b.Uef(k);this.D_e=b.Ipl(k);this.Ywb=b.Acf(k);this.Bab=b.$bf(k)}static vF(b){return Vd.nr(b)}static nr(b){return new Vd($v.a.instance,b)}}Object(m.a)(Vd,"CpUsageHelper",null,[]);class pv{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc){this.U8=null;this.nd=b;this.qz=k;this.Atc=r;this.sra=y;this.hb=R;this.ga=aa;this.vse=ta;this.DLe=xb;
this.LCe=Ya;this.doe=Mb;this.Lke=cc;this.Jd=jc;this.JWg=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")}get zi(){return this.DLe.value}get Zoa(){return this.sra}get Kc(){return this.nd}get GOa(){return this.LCe.GOa}paste(b,k){const r=this.Jd.ZVa();try{const y=k.ve,R=k.Dz;this.U6&&(this.hb&&this.hb.ib&&this.hb.ib.kb&&Jx.TableBorderSelectionCache.USn(this.hb.ib.kb.Bw||this.hb.ib.kb.tEb),xp.a.UQn(this.hb));v.ULS.shipAssertTag(18131010,307,!!(R&
1));Object(Jb.a)(89,k.Ed)&&k.Ed.setValue(Gh.a.pea,y.Wg.editingElement.clientWidth);this.Lke.Ufo(b,k);let aa;if(!({Iwd:aa}=this.vse.value.$ej()).returnValue)return this.pRc(k,"HTML import strategy failed",!1),Ga.Health.instance.recordQosError("HtmlImportStrategyFailed",[Qt.a.M_d],!1,!0,!0,!1,null),!1;this.zi.KF();let ta=!0,Ya=null;const xb=this.doe.create(aa),Mb=k.flj;if((!y||!y.Cb)&&this.JWg)return this.pRc(k,"Fail to set selection.",!1),Ga.Health.instance.recordQosError("SetSelectionFailed",[Qt.a.M_d],
!1,!0,!0,!1,null),!1;y.Cb.EJb(()=>{Mb&&2===this.ga.processAction(Wa.a.Oka,2)?ta=!1:(Ya=Mb?this.hb&&this.hb.ib&&this.hb.ib.kb?this.hb.ib.kb.Qa:null:k.Ed)?(v.ULS.shipAssertTag(18158338,307,rf.SelectionEditor.zf(Ya)),this.noi(Ya,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Mb)},this.LCe.fhi);if(!ta)return this.pRc(k,"fail to deleteForReplace.",!0),!1;if(!Ya&&this.JWg)return this.pRc(k,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ya.node||
!Ya.node.isConnected)return this.pRc(k,"node is null or not connected in ip context.",!0),!1;y.editingView.disable(!0,25);xb.restore();this.Atc.G5m(aa,Ya,b);return!0}finally{r&&r.dispose()}}pRc(b,k,r){b.failed=!0;b.KQ&&b.KQ.fail(k,r)}L5m(b,k){const r=Object(ia.a)(89,k.Ed).getValue(td.a.h3h);v.ULS.shipAssertTag(20492440,307,rf.SelectionEditor.zf(r));if(!this.wnh(r,k))return!1;this.zi.KF();k=(new Qn.a).Rc(15);k.Eb(this.qz.vha);this.Atc.rai(r,b);this.qz.moh();k.dispose();return!0}iFi(b,k){const r=this.hb.ib.kb.Qa;
if(!this.wnh(r,k))return!1;this.zi.KF();this.ga.processAction(Wa.a.Oka,2);this.noi(r,"intPaste");this.Atc.rai(r,b);return!0}wnh(b,k){if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.Sd)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!k&&k.Duf),k.KQ&&(k.KQ.fail("Invalid ipContext before InternalPasteAtIp",!0),k.failed=!0),!1;if(!rf.SelectionEditor.zf(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!k&&k.Duf,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),k.KQ&&(k.KQ.fail("ipContext is not insertion point in InternalPasteAtIp",!0),k.failed=!0),!1}return!0}noi(b,k){k=Vd.vF(k);this.Zoa.Njn(k,b.node,b.cpBegin);this.Zoa.Kym(k.D_e);this.Zoa.ayf(k.OBb);this.Zoa.Pxf(k.Ywb);this.Zoa.Nxf(k.Bab)}A1i(b,k){if(!k.flj)return!1;k.Dz&64&&this.qz.hlj();if(!k.ZXa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Kc.Zb($c.a.a0,{["Reason"]:bd.a.Sfb}),k.KQ&&k.KQ.fail("No selection after paste",
!1),k.failed=!0,!1;this.LCe.Ypo(k);this.zi.KF();return!1}get U6(){null==this.U8&&(n.AFrameworkApplication.Ne("he991617;3eed2178"),this.U8=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.U8}}Object(m.a)(pv,"ClipboardOperationPaste",null,[703]);class $i{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.nd=b;this.qz=k;this.Atc=r;this.sra=y;this.hb=R;this.ga=aa;this.DLe=Ya;this.QRj=ta;this.doe=xb;this.Lke=
Mb;this.Jd=cc}create(b,k){k=this.QRj.create(this.hb,k);return new pv(this.nd,this.qz,this.Atc,this.sra,this.hb,this.ga,b,k,this.DLe,this.doe,this.Lke,this.Jd)}}Object(m.a)($i,"Factory",null,[674]);var Ap=c(1552);class bw{constructor(b,k){this.j6n=b;this.G4m=k}}Object(m.a)(bw,"ParagraphFormatStore",null,[]);class wh{constructor(b,k,r,y){this.hb=b;this.fb=k;this.Ce=r;this.kwe=y}Ufo(b,k){if(k.t7b&&this.kwe){k=b.kga;var r=this.hb.ib.kb.Qa.node,y=null;this.fb.nc(r)&&(y=this.Ce.Ao(r),r=this.fb.WYa(r),y=
new bw(y,r));k=new Ap.a(k.context,k.Dz,k.KQ,k.C7,k.Ed,y);b.kga=k}}}Object(m.a)(wh,"ClipboardOperationPasteOvertypeStrategy",null,[673]);class pr{constructor(b){this.vye=null;this.hb=b;b.EJb(k=>{this.vye=k},!1)}get fhi(){return!1}Ypo(b){b=this.rQe(b);this.setSelection(this.hb,b)}rQe(b){let k=b.ZXa;(b.YQa||b.Xva)&&b.k$d&&(k=Ke.SelectionFactory.KB(b.k$d,k.Qa));return k}setSelection(b,k){b.setSelection(k)}}Object(m.a)(pr,"AClipboardOperationPasteStrategy",null,[731]);class Lo extends pr{constructor(b){super(b)}get GOa(){return this.vye}}
Object(m.a)(Lo,"ClipboardOperationPasteToLiveSelectionStrategy",pr,[]);class xo extends pr{constructor(b,k){super(b);this.FMe=null;this.cOj=k;b.EJb(r=>{this.FMe=r},!0)}get fhi(){return!0}get GOa(){return this.FMe}rQe(b){let k=super.rQe(b);b.Ed.setValue(td.a.mFi,k);return k=this.cOj.LVh(this.vye.kb,this.FMe.kb,k)}}Object(m.a)(xo,"ClipboardOperationPasteToVirtualSelectionStrategy",pr,[]);class uv{constructor(b){this.EMe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,k){return k&&k.ia(td.a.YQa,
!1)&&this.EMe?new xo(b,this.mto):new Lo(b)}get mto(){return null!=this.Wtg?this.Wtg:this.Wtg=Va.a.instance.Pa("Box4.Actors.IVirtualSelectionMerger")}}Object(m.a)(uv,"ClipboardOperationPasteStrategyFactory",null,[672]);class At{constructor(b,k,r,y,R){this.nd=b;this.hb=k;this.Zj=r;this.Mk=y;this.QLj=R}a$m(b){this.QLj&&(b&1||b&32)&&this.Zj.Pp&&this.hb.RWb()}Ibm(b,k){return b&1&&this.Mk.mZ(k,!0)?(this.nd.Zb($c.a.vf,{["Reason"]:bd.a.dE}),!1):!0}}Object(m.a)(At,"ClipboardOperationWordStrategy",null,[]);
class Nu{constructor(){}AHk(b,k){if(k)if(k=k.sheet)if(k=k.cssRules){var r=Array.clone(k);r.reverse();var y=k=0,R=0,aa=0;for(const Ya of r){r=Ya.style;var ta=Ya.selectorText;r=r?r.cssText:null;ta=ta?ta.split(","):null;if(r&&ta&&Ya.type===Ya.STYLE_RULE){aa+=ta.length;for(const xb of ta){0<=xb.indexOf("#")&&k++;0<=xb.indexOf(".")&&y++;0>xb.indexOf("#")&&0>xb.indexOf(".")&&R++;ta=null;try{ta=b.querySelectorAll(xb)}catch(Mb){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",
xb,Mb.message)}if(ta)for(let Mb=0;Mb<ta.length;Mb++)ta[Mb].setAttribute("style",r+(ta[Mb].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",aa,k,y,R)}else this.Xoi();else this.Xoi()}Xoi(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",X.a.dF)}}Object(m.a)(Nu,"ExternalPasteCssConverter",null,
[671]);var Xm=c(632),rA=c(1080);class Ey{constructor(b){this.b2=0;this.Noh=null;this.node=b}}Object(m.a)(Ey,"ChartConverterArguments",null,[]);class Fy{constructor(b=null){this._imgNodesConverted=0;this.OV=b||Fh.a.TOh("")}get Jc(){return this.OV}process(b,k){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Rr.a(k,this.T7k.bind(this),new Ey(b[0])),b.ll("Chart Converter Operation"),b.fh=!k||k.fh,b.run())))}T7k(b,k){var r=k.node;if(1<k.b2)return!1;if(1===
r.nodeType&&"DIV"===r.tagName){const y=r.getAttribute(Xm.a.Hyd);if(y){const R=r.getAttribute(Xm.a.I2e),aa=r.getAttribute(Xm.a.J2e),ta=r.getAttribute(Xm.a.G2e),Ya=r.getAttribute(Xm.a.H2e),xb=r.getAttribute(Xm.a.yDc);r=r.getAttribute(Xm.a.K2e);R&&Ya&&aa&&"chart"===aa&&xb&&"XLO"===xb&&(k.Noh=new rA.a(y,R,aa,ta,Ya,xb,r))}}b.ui(this.qLm.bind(this));return!0}qLm(b,k){var r=k.node;if(b=k.Noh)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Xm.a.Hyd,
b.ccpId),r.setAttribute(Xm.a.I2e,b.pKey),r.setAttribute(Xm.a.J2e,b.type),r.setAttribute(Xm.a.H2e,b.dc),r.setAttribute(Xm.a.yDc,b.client),b.version&&r.setAttribute(Xm.a.K2e,b.version),b.count&&r.setAttribute(Xm.a.G2e,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.OV._imgNodesConverted=this._imgNodesConverted;k.b2++;return!1}}Object(m.a)(Fy,"ChartConverter",null,[]);var Ou=c(1162);class Gy{constructor(b,k=null,r=null){this.nf=b;this.OV=k||Fh.a.j_h("");
this.HYj=r||Fh.a.k_h("")}get Jc(){return this.OV}get T4f(){return this.HYj}Taa(b){this.T4f.b++;this.nf.Taa(b)}Qaa(){this.nf.Qaa()}Saa(b){this.T4f.c++;this.nf.Saa(b)}Raa(){this.nf.Raa()}Paa(b){this.T4f.d++;this.nf.Paa(b)}Oaa(){this.nf.Oaa()}reset(){this.nf.reset()}get HDc(){return this.nf.HDc}Uaa(b,k){this.Jc.b++;this.nf.Uaa(b,k)}sDa(b){this.Jc.c++;this.nf.sDa(b)}Iib(b){this.Jc.b++;this.nf.Iib(b)}eva(b){this.Jc.d++;this.nf.eva(b)}oDa(b){this.Jc.f++;this.nf.oDa(b)}nOa(b,k){this.Jc.g++;this.nf.nOa(b,
k)}mOa(){this.nf.mOa()}VF(b){this.Jc.h++;this.nf.VF(b)}UF(){this.nf.UF()}Fib(){this.nf.Fib()}Eib(){this.nf.Eib()}sOa(b,k){this.Jc.i++;this.nf.sOa(b,k)}p1a(){this.nf.p1a()}vDa(b){this.Jc.j++;this.nf.vDa(b)}tDa(){this.nf.tDa()}rOa(b){this.Jc.k++;this.nf.rOa(b)}uDa(){this.nf.uDa()}s1a(b){this.Jc.l++;this.nf.s1a(b)}}Object(m.a)(Gy,"SemanticEventUsageCollector",null,[373,374]);class hn{constructor(b,k=null,r=null,y=null){this.XAj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.nf=b;this.OV=k||Fh.a.vTh(X.a.uwb,"");this.wu=r;this.wWj=y?y.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.xWj=y?y.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.bAg=new kb.a(ka.a.Sj());for(const R of this.XAj)this.bAg.add(R)}get Jc(){return this.OV}get Ko(){return this.wu}Gh(b){return b?b+1:1}reset(){this.nf.reset()}WWd(){this.nf.WWd()}ykf(b){if(b&&this.Ko&&(b.getAttribute&&(b.getAttribute(Xm.a.$Rk)&&(this.Ko.KLh=!0),b.getAttribute(Xm.a.Hyd)&&(this.Ko.Mfl=!0),b.getAttribute(Xm.a.yDc)&&
(this.Ko.LXe=b.getAttribute(Xm.a.yDc)),b.getAttribute(Xm.a.dSk)&&(this.Ko.LLh=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Xm.a.zSl)&&(this.Ko.Ofl=!0),b.className&&b.className.split))for(const k of b.className.split(" ")){k.startsWith(Xm.a.L0m)&&(this.Ko.Qfl=!0);k.startsWith(Xm.a.k9m)&&(this.Ko.NLh=!0);k.startsWith(Xm.a.wvo)&&(this.Ko.OLh=!0);if(k.startsWith(X.a.EUe)&&k.length===X.a.EUe.length+1){const r=parseInt(A.a.substring(k,k.length-1,k.length));isNaN(r)||(this.Ko.xCc=r)}if(k===Xm.a.AMm||k===
Xm.a.BMm)this.Ko.YDd=!0}return this.nf.ykf(b)}onClose(){this.nf.onClose()}Uaa(b,k){this.Ko&&(this.Ko.Rfl=!0);this.Jc.d=this.Gh(this.Jc.d);this.nf.Uaa(b,k)}OWd(b){this.Jc.e=this.Gh(this.Jc.e);this.ji(b);return this.nf.OWd(b)}tFf(b){this.Jc.f=this.Gh(this.Jc.f);this.ji(b);return this.nf.tFf(b)}uFf(b){this.Jc.g=this.Gh(this.Jc.g);this.ji(b);return this.nf.uFf(b)}xFf(b){this.Jc.h=this.Gh(this.Jc.h);this.ji(b);return this.nf.xFf(b)}NFf(b){this.Jc.i=this.Gh(this.Jc.i);this.ji(b);return this.nf.NFf(b)}PFf(b){this.Jc.j=
this.Gh(this.Jc.j);this.ji(b);this.nf.PFf(b)}VWd(b){this.Jc.k=this.Gh(this.Jc.k);this.ji(b);return this.nf.VWd(b)}QFf(b){this.Jc.l=this.Gh(this.Jc.l);this.ji(b);this.nf.QFf(b)}RFf(b){this.Jc.m=this.Gh(this.Jc.m);this.ji(b);this.nf.RFf(b)}SFf(b){this.Jc.n=this.Gh(this.Jc.n);this.ji(b);return this.nf.SFf(b)}YWd(b){this.Jc.o=this.Gh(this.Jc.o);this.ji(b);return this.nf.YWd(b)}ZWd(b){this.Jc.p=this.Gh(this.Jc.p);this.ji(b);return this.nf.ZWd(b)}fGf(b){this.Jc.q=this.Gh(this.Jc.q);this.ji(b);return this.nf.fGf(b)}$Wd(b){this.Jc.r=
this.Gh(this.Jc.r);this.ji(b);this.nf.$Wd(b)}hGf(b){this.Jc.s=this.Gh(this.Jc.s);this.ji(b);return this.nf.hGf(b)}aXd(b){this.Jc.t=this.Gh(this.Jc.t);this.ji(b);return this.nf.aXd(b)}bXd(b){this.Jc.u=this.Gh(this.Jc.u);this.ji(b);return this.nf.bXd(b)}eXd(b){this.Jc.v=this.Gh(this.Jc.v);this.ji(b);return this.nf.eXd(b)}fXd(b){this.Jc.w=this.Gh(this.Jc.w);this.ji(b);return this.nf.fXd(b)}tGf(b){this.Jc.x=this.Gh(this.Jc.x);this.ji(b);this.nf.tGf(b)}uGf(b){this.Jc.y=this.Gh(this.Jc.y);this.ji(b);return this.nf.uGf(b)}kXd(b){this.Jc.z=
this.Gh(this.Jc.z);this.ji(b);return this.nf.kXd(b)}lXd(b){this.Jc.ba=this.Gh(this.Jc.ba);this.ji(b);return this.nf.lXd(b)}pXd(b){this.Jc.bb=this.Gh(this.Jc.bb);this.ji(b);return this.nf.pXd(b)}qXd(b){this.Jc.bc=this.Gh(this.Jc.bc);this.ji(b);return this.nf.qXd(b)}sXd(b){this.Jc.bd=this.Gh(this.Jc.bd);this.ji(b);return this.nf.sXd(b)}tXd(b){this.Jc.be=this.Gh(this.Jc.be);this.ji(b);return this.nf.tXd(b)}wXd(b){this.Jc.bf=this.Gh(this.Jc.bf);this.ji(b);return this.nf.wXd(b)}yXd(b){this.Jc.bg=this.Gh(this.Jc.bg);
this.ji(b);return this.nf.yXd(b)}VGf(b){this.Jc.bh=this.Gh(this.Jc.bh);this.ji(b);return this.nf.VGf(b)}EXd(b){this.Jc.bi=this.Gh(this.Jc.bi);this.ji(b);return this.nf.EXd(b)}bHf(b){this.Jc.bj=this.Gh(this.Jc.bj);this.ji(b);return this.nf.bHf(b)}dHf(b){this.Jc.bk=this.Gh(this.Jc.bk);this.ji(b);this.nf.dHf(b)}eHf(b){this.Jc.bl=this.Gh(this.Jc.bl);this.ji(b);return this.nf.eHf(b)}HXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);return this.nf.HXd(b)}IXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);
return this.nf.IXd(b)}JXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);return this.nf.JXd(b)}KXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);return this.nf.KXd(b)}LXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);return this.nf.LXd(b)}MXd(b){this.Jc.bm=this.Gh(this.Jc.bm);this.ji(b);return this.nf.MXd(b)}jHf(b){this.Jc.bn=this.Gh(this.Jc.bn);return this.nf.jHf(b)}NXd(b){this.Jc.bo=this.Gh(this.Jc.bo);this.ji(b);this.nf.NXd(b)}pHf(b){this.Jc.bp=this.Gh(this.Jc.bp);return this.nf.pHf(b)}OXd(b){this.Jc.bq=
this.Gh(this.Jc.bq);this.ji(b);return this.nf.OXd(b)}qHf(b){this.Jc.br=this.Gh(this.Jc.br);this.ji(b);return this.nf.qHf(b)}RXd(b){this.Ko&&(this.Ko.Pfl=!0);this.ji(b);this.Jc.bs=this.Gh(this.Jc.bs);this.nf.RXd(b)}wHf(b){this.Jc.bt=this.Gh(this.Jc.bt);this.ji(b);this.nf.wHf(b)}SXd(b){this.Jc.bu=this.Gh(this.Jc.bu);this.ji(b);return this.nf.SXd(b)}CHf(b){this.Jc.bv=this.Gh(this.Jc.bv);this.ji(b);return this.nf.CHf(b)}VXd(b){this.Jc.bw=this.Gh(this.Jc.bw);this.ji(b);return this.nf.VXd(b)}XXd(b){this.Jc.bx=
this.Gh(this.Jc.bx);this.ji(b);return this.nf.XXd(b)}ZXd(b){this.Jc.by=this.Gh(this.Jc.by);this.ji(b);return this.nf.ZXd(b)}$Xd(b){this.Ko&&(this.Ko.YDd=!0);this.Jc.bz=this.Gh(this.Jc.bz);this.ji(b);return this.nf.$Xd(b)}PHf(b){this.Jc.ca=this.Gh(this.Jc.ca);this.ji(b);this.nf.PHf(b)}SHf(b){this.Jc.cb=this.Gh(this.Jc.cb);this.ji(b);return this.nf.SHf(b)}aYd(b){this.Ko&&(this.Ko.Nfl=!0);this.Jc.cc=this.Gh(this.Jc.cc);this.ji(b);return this.nf.aYd(b)}onMenuOpen(b){this.Jc.cd=this.Gh(this.Jc.cd);this.ji(b);
return this.nf.onMenuOpen(b)}WHf(b){this.Jc.ce=this.Gh(this.Jc.ce);this.nf.WHf(b)}dIf(b){this.Jc.cf=this.Gh(this.Jc.cf);this.ji(b);return this.nf.dIf(b)}eIf(b){this.Jc.cg=this.Gh(this.Jc.cg);this.ji(b);return this.nf.eIf(b)}fIf(b){this.Jc.ch=this.Gh(this.Jc.ch);this.ji(b);return this.nf.fIf(b)}mYd(b){this.Ko&&(this.Ko.YDd=!0);this.Jc.ci=this.Gh(this.Jc.ci);this.ji(b);return this.nf.mYd(b)}hIf(b){this.Jc.cj=this.Gh(this.Jc.cj);this.ji(b);return this.nf.hIf(b)}nYd(b){this.Jc.ck=this.Gh(this.Jc.ck);
this.ji(b);return this.nf.nYd(b)}qYd(b){this.Jc.cl=this.Gh(this.Jc.cl);this.ji(b);return this.nf.qYd(b)}nIf(b){this.Jc.cm=this.Gh(this.Jc.cm);this.ji(b);this.nf.nIf(b)}wYd(b){this.Jc.cn=this.Gh(this.Jc.cn);this.ji(b);return this.nf.wYd(b)}xIf(b){this.Jc.co=this.Gh(this.Jc.co);this.ji(b);return this.nf.xIf(b)}DYd(b){this.Jc.cp=this.Gh(this.Jc.cp);this.ji(b);return this.nf.DYd(b)}EYd(b){this.Jc.cq=this.Gh(this.Jc.cq);this.ji(b);return this.nf.EYd(b)}SIf(b){this.Jc.cr=this.Gh(this.Jc.cr);return this.nf.SIf(b)}YIf(b){this.Jc.cs=
this.Gh(this.Jc.cs);this.ji(b);return this.nf.YIf(b)}NYd(b){this.Jc.ct=this.Gh(this.Jc.ct);this.ji(b);return this.nf.NYd(b)}OYd(b){this.Jc.cu=this.Gh(this.Jc.cu);this.ji(b);return this.nf.OYd(b)}QYd(b){this.Jc.cv=this.Gh(this.Jc.cv);this.ji(b);return this.nf.QYd(b)}RYd(b){this.Jc.cw=this.Gh(this.Jc.cw);this.ji(b);return this.nf.RYd(b)}bJf(b){this.Jc.cx=this.Gh(this.Jc.cx);return this.nf.bJf(b)}SYd(b){this.Jc.cy=this.Gh(this.Jc.cy);this.ji(b);return this.nf.SYd(b)}UYd(b){this.Jc.cz=this.Gh(this.Jc.cz);
this.ji(b);return this.nf.UYd(b)}WYd(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.da=this.Gh(this.Jc.da);this.ji(b);return this.nf.WYd(b)}fJf(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.db=this.Gh(this.Jc.db);this.ji(b);return this.nf.fJf(b)}ZTc(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.dc=this.Gh(this.Jc.dc);this.ji(b);return this.nf.ZTc(b)}hJf(b){this.Jc.dd=this.Gh(this.Jc.dd);this.ji(b);return this.nf.hJf(b)}iJf(b){this.Jc.de=this.Gh(this.Jc.de);this.ji(b);return this.nf.iJf(b)}ZYd(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.df=
this.Gh(this.Jc.df);this.ji(b);return this.nf.ZYd(b)}jJf(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.dg=this.Gh(this.Jc.dg);this.ji(b);return this.nf.jJf(b)}mJf(b){this.Jc.dh=this.Gh(this.Jc.dh);this.ji(b);return this.nf.mJf(b)}cZd(b){this.Ko&&(this.Ko.f2b=!0);this.Jc.di=this.Gh(this.Jc.di);this.ji(b);return this.nf.cZd(b)}dZd(b){this.Jc.dj=this.Gh(this.Jc.dj);this.ji(b);return this.nf.dZd(b)}eZd(b){this.Jc.dk=this.Gh(this.Jc.dk);this.ji(b);return this.nf.eZd(b)}fZd(b){this.Ko&&(this.Ko.YDd=!0);this.Jc.dl=
this.Gh(this.Jc.dl);this.ji(b);return this.nf.fZd(b)}iZd(b){this.Jc.dm=this.Gh(this.Jc.dm);this.ji(b);return this.nf.iZd(b)}ji(b){const k=b.qf;if(k&&this.Ko){var r=k.tagName.toLowerCase();if(this.wWj&&this.rci(r)||this.xWj&&!this.rci(r))if("font"===r&&this.v5m(b),k.style&&(b=k.style))for(const y of b)y&&0<y.length&&this.Ko.oMd(k.tagName,y)}}v5m(b){if((b=b.qf)&&"font"===b.tagName.toLowerCase()&&this.Ko){var k=b.getAttribute("face");k&&0<k.length&&this.Ko.oMd(b.tagName,"font-attr-face");(k=b.getAttribute("color"))&&
0<k.length&&this.Ko.oMd(b.tagName,"font-attr-color");(k=b.getAttribute("size"))&&0<k.length&&this.Ko.oMd(b.tagName,"font-attr-size")}}rci(b){return this.bAg.contains(b)}}Object(m.a)(hn,"HtmlEventUsageCollector",null,[378]);class rs{constructor(b,k,r=!1){this.qf=b;this.FA=k;this.Rdk=r}}Object(m.a)(rs,"TagEventParam",null,[]);class Pw{constructor(b,k=null){this.d$c=this._prunedElements=this.qLe=this._voidElements=null;this.ud=b;this.OV=k||Fh.a.wTh("");this.nSn()}get Jc(){return this.OV}vPm(b,k,r){this.qLe[k]?
this.Uvi():(this.Jc.e++,(k=this.d$c[k])&&k(new rs(b,r,!1)),this.Jc.b++)}Uvi(){this.Jc.d++}qPm(){this.Jc.c++}fPm(b,k,r){if(this.qLe[k])this.Uvi();else{if(k=this.d$c[k])return this.Jc.b++,k(new rs(b,r,!1));this.Jc.f++}return 2}nSn(){this._voidElements=Ba.a.V3("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.qLe=Ba.a.V3("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,
"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Ba.a.V3("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,k=this.ud,r=this.ud,y=this.ud,R=this.ud,aa=this.ud,ta=this.ud,Ya=this.ud,xb=this.ud,Mb=this.ud,cc=this.ud,jc=this.ud,Mc=this.ud,fd=this.ud,Td=this.ud,ne=this.ud,ye=this.ud,ff=this.ud,
Gd=this.ud,oe=this.ud;this.d$c=Ba.a.V3("A",Object(u.a)(this.ud,this.ud.OWd,"onAOpen"),"ABBR",Object(u.a)(this.ud,this.ud.tFf,"onAbbrOpen"),"ACRONYM",Object(u.a)(this.ud,this.ud.uFf,"onAcronymOpen"),"ADDRESS",Object(u.a)(this.ud,this.ud.xFf,"onAddressOpen"),"APPLET",Object(u.a)(this.ud,this.ud.NFf,"onAppletOpen"),"AREA",Object(u.a)(this.ud,this.ud.PFf,"onAreaTag"),"B",Object(u.a)(this.ud,this.ud.VWd,"onBOpen"),"BASE",Object(u.a)(this.ud,this.ud.QFf,"onBaseTag"),"BASEFONT",Object(u.a)(this.ud,this.ud.RFf,
"onBasefontTag"),"BDO",Object(u.a)(this.ud,this.ud.SFf,"onBdoOpen"),"BIG",Object(u.a)(this.ud,this.ud.YWd,"onBigOpen"),"BLOCKQUOTE",Object(u.a)(this.ud,this.ud.ZWd,"onBlockquoteOpen"),"BODY",Object(u.a)(this.ud,this.ud.fGf,"onBodyOpen"),"BR",Object(u.a)(this.ud,this.ud.$Wd,"onBrTag"),"BUTTON",Object(u.a)(this.ud,this.ud.hGf,"onButtonOpen"),"CAPTION",Object(u.a)(this.ud,this.ud.aXd,"onCaptionOpen"),"CENTER",Object(u.a)(this.ud,this.ud.bXd,"onCenterOpen"),"CITE",Object(u.a)(this.ud,this.ud.eXd,"onCiteOpen"),
"CODE",Object(u.a)(this.ud,this.ud.fXd,"onCodeOpen"),"COL",Object(u.a)(this.ud,this.ud.tGf,"onColTag"),"COLGROUP",Object(u.a)(this.ud,this.ud.uGf,"onColgroupOpen"),"DD",Object(u.a)(this.ud,this.ud.kXd,"onDdOpen"),"DEL",Object(u.a)(this.ud,this.ud.lXd,"onDelOpen"),"DFN",Object(u.a)(this.ud,this.ud.pXd,"onDfnOpen"),"DIR",Object(u.a)(this.ud,this.ud.qXd,"onDirOpen"),"DIV",Object(u.a)(this.ud,this.ud.sXd,"onDivOpen"),"DL",Object(u.a)(this.ud,this.ud.tXd,"onDlOpen"),"DT",Object(u.a)(this.ud,this.ud.wXd,
"onDtOpen"),"EM",Object(u.a)(this.ud,this.ud.yXd,"onEmOpen"),"FIELDSET",Object(u.a)(this.ud,this.ud.VGf,"onFieldsetOpen"),"FONT",Object(u.a)(this.ud,this.ud.EXd,"onFontOpen"),"FORM",Object(u.a)(this.ud,this.ud.bHf,"onFormOpen"),"FRAME",Object(u.a)(this.ud,this.ud.dHf,"onFrameTag"),"FRAMESET",Object(u.a)(this.ud,this.ud.eHf,"onFramesetOpen"),"H1",Object(u.a)(this.ud,this.ud.HXd,"onH1Open"),"H2",Object(u.a)(this.ud,this.ud.IXd,"onH2Open"),"H3",Object(u.a)(this.ud,this.ud.JXd,"onH3Open"),"H4",Object(u.a)(this.ud,
this.ud.KXd,"onH4Open"),"H5",Object(u.a)(this.ud,this.ud.LXd,"onH5Open"),"H6",Object(u.a)(this.ud,this.ud.MXd,"onH6Open"),"HEAD",Object(u.a)(this.ud,this.ud.jHf,"onHeadOpen"),"HR",Object(u.a)(this.ud,this.ud.NXd,"onHrTag"),"HTML",Object(u.a)(this.ud,this.ud.pHf,"onHtmlOpen"),"I",Object(u.a)(this.ud,this.ud.OXd,"onIOpen"),"IFRAME",Object(u.a)(this.ud,this.ud.qHf,"onIframeOpen"),"IMG",Object(u.a)(this.ud,this.ud.RXd,"onImgTag"),"INPUT",Object(u.a)(this.ud,this.ud.wHf,"onInputTag"),"INS",Object(u.a)(this.ud,
this.ud.SXd,"onInsOpen"),"ISINDEX",Object(u.a)(this.ud,this.ud.CHf,"onIsindexOpen"),"KBD",Object(u.a)(this.ud,this.ud.VXd,"onKbdOpen"),"LABEL",Object(u.a)(this.ud,this.ud.XXd,"onLabelOpen"),"LEGEND",Object(u.a)(this.ud,this.ud.ZXd,"onLegendOpen"),"LI",Object(u.a)(this.ud,this.ud.$Xd,"onLiOpen"),"LINK",Object(u.a)(this.ud,this.ud.PHf,"onLinkTag"),"MAP",Object(u.a)(this.ud,this.ud.SHf,"onMapOpen"),"MATH",Object(u.a)(this.ud,this.ud.aYd,"onMathOpen"),"MENU",Object(u.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),
"META",Object(u.a)(this.ud,this.ud.WHf,"onMetaTag"),"NOFRAMES",Object(u.a)(this.ud,this.ud.dIf,"onNoframesOpen"),"NOSCRIPT",Object(u.a)(this.ud,this.ud.eIf,"onNoscriptOpen"),"OBJECT",Object(u.a)(this.ud,this.ud.fIf,"onObjectOpen"),"OL",Object(u.a)(this.ud,this.ud.mYd,"onOlOpen"),"OPTGROUP",Object(u.a)(this.ud,this.ud.hIf,"onOptgroupOpen"),"OPTION",Object(u.a)(this.ud,this.ud.nYd,"onOptionOpen"),"P",Object(u.a)(this.ud,this.ud.qYd,"onPOpen"),"PARAM",Object(u.a)(this.ud,this.ud.nIf,"onParamTag"),"PRE",
Object(u.a)(this.ud,this.ud.wYd,"onPreOpen"),"Q",Object(u.a)(this.ud,this.ud.xIf,"onQOpen"),"S",Object(u.a)(this.ud,this.ud.DYd,"onSOpen"),"SAMP",Object(u.a)(this.ud,this.ud.EYd,"onSampOpen"),"SCRIPT",Object(u.a)(this.ud,this.ud.SIf,"onScriptOpen"),"SELECT",Object(u.a)(this.ud,this.ud.YIf,"onSelectOpen"),"SMALL",Object(u.a)(b,b.NYd,"onSmallOpen"),"SPAN",Object(u.a)(k,k.OYd,"onSpanOpen"),"STRIKE",Object(u.a)(r,r.QYd,"onStrikeOpen"),"STRONG",Object(u.a)(y,y.RYd,"onStrongOpen"),"STYLE",Object(u.a)(R,
R.bJf,"onStyleOpen"),"SUB",Object(u.a)(aa,aa.SYd,"onSubOpen"),"SUP",Object(u.a)(ta,ta.UYd,"onSupOpen"),"TABLE",Object(u.a)(Ya,Ya.WYd,"onTableOpen"),"TBODY",Object(u.a)(xb,xb.fJf,"onTbodyOpen"),"TD",Object(u.a)(Mb,Mb.ZTc,"onTdOpen"),"TEXTAREA",Object(u.a)(cc,cc.hJf,"onTextareaOpen"),"TFOOT",Object(u.a)(jc,jc.iJf,"onTfootOpen"),"TH",Object(u.a)(Mc,Mc.ZYd,"onThOpen"),"THEAD",Object(u.a)(fd,fd.jJf,"onTheadOpen"),"TITLE",Object(u.a)(Td,Td.mJf,"onTitleOpen"),"TR",Object(u.a)(ne,ne.cZd,"onTrOpen"),"TT",
Object(u.a)(ye,ye.dZd,"onTtOpen"),"U",Object(u.a)(ff,ff.eZd,"onUOpen"),"UL",Object(u.a)(Gd,Gd.fZd,"onUlOpen"),"VAR",Object(u.a)(oe,oe.iZd,"onVarOpen"))}}Object(m.a)(Pw,"AHtmlProcessor",null,[]);class vv{constructor(b,k){this.childNodes=b.childNodes;this.FA=k;this.T1e=0;this.BOd=!1}}Object(m.a)(vv,"HtmlProcessorArguments",null,[]);var Kx=c(1014);class Bt extends Pw{constructor(b,k=null){super(b,k);this.rve=null}get Zjm(){null==this.rve&&(this.rve=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.rve}process(b,k=null){b&&(this.ud.reset(),this.iIi(new vv(b,new Lj.a),k))}iIi(b,k){b.childNodes.length&&(b=new Rr.a(k,Object(u.a)(this,this.cbn,"processChild"),b),b.ll("HTML Processing Operation"),k||(b.fh=!0),b.run())}cbn(b,k){const r=k.childNodes[k.T1e];if(3===r.nodeType)return this.ud.WWd(),this.ud.Uaa(r.nodeValue,new rs(r,k.FA.iQh())),Bt.thc(k);if(1!==r.nodeType)return Bt.thc(k);if(!k.BOd){const R=A.a.cA(r.tagName);if(!Bt.rXl(r))if(this._prunedElements[R])this.qPm();else{Bt.LGm(r);
this.ud.WWd();var y=r.id;const aa=r.tagName,ta=k.FA.iQh(),Ya=r.getAttribute?r.getAttribute("class"):null;y=new Kx.a(y,aa,Ya?Ya:"",r.attributes?r.attributes.length:0);y.Sd&&ta.add(y);if(this._voidElements[R])return this.vPm(r,R,ta),Bt.thc(k);y=!1;switch(this.fPm(r,R,ta)){case 1:y=!0;break;case 3:return Bt.thc(k)}switch(this.ud.ykf(r)){case 1:y=!0}k.BOd=y;this.iIi(new vv(r,ta),b);if(!b.fh)return!0}}if(k.BOd){if(this.Zjm&&!this.d$c[A.a.cA(r.tagName)])return Bt.thc(k);this.ud.onClose()}return Bt.thc(k)}static LGm(b){3!==
b.nodeType&&jj.a.yl(b,"alreadyPasted",!0)}static rXl(b){return 3!==b.nodeType&&jj.a.Db(b,"alreadyPasted")}static thc(b){b.T1e++;b.BOd=!1;return b.T1e<b.childNodes.length}}Object(m.a)(Bt,"HtmlProcessor",Pw,[]);var Lx=c(1883);class Mx{constructor(){this.Dz=0;this.xCc=6;this.Mfl=this.KLh=!1;this.LXe=null;this.OLh=this.NLh=this.Qfl=this.Ofl=this.LLh=!1;this.progId=null;this.Pfl=this.f2b=this.YDd=this.Nfl=this.Rfl=!1;this.Y5m=this.Uac=0;this.UJf=this.platform=null;this.pqb={}}get c2f(){if(null!==this.LXe)switch(this.LXe){case "XLO":return"Excel Online"}if(this.OLh)return"Word Online";
if(this.NLh||this.LLh)return"PowerPoint Online";if(this.KLh)return"Excel Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}eAm(){v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.rnk()))}fAm(){const b=this.pqb;for(const r in b){var k=r;const y=b[r];y&&(y.SourceApp=this.c2f,y.Browser=Lx.a[this.Uac],y.TagName=k,y.OperationId=this.UJf,v.ULS.sendTraceTag(51406242,
307,50,JSON.stringify(y)))}}oMd(b,k){b&&b.length&&k&&k.length&&(b=b.toLowerCase(),k=k.toLowerCase(),b in this.pqb||(this.pqb[b]={}),this.pqb[b][k]=this.YLl(b,k)+1)}YLl(b,k){if(!(b&&b.length&&k&&k.length&&this.pqb&&b in this.pqb))return 0;b=b.toLowerCase();k=k.toLowerCase();return(b=this.pqb[b])&&k in b?b[k]:0}rnk(){const b={};b.ActionIdFlags=this.Dz;b.SourceApp=this.c2f;b.CopySourceBrowser=this.xCc;b.PasteBrowser=this.Uac;b.IsSameBrowserPaste=this.Olm(this.xCc,this.Uac);b.IsCrossBrowserPaste=this.Ocm(this.xCc,
this.Uac);b.IsUncategorizedBrowserPaste=this.Aom(this.xCc,this.Uac);b.Platform=this.platform;b.OperationId=this.UJf;return b}Olm(b,k){return 5===b||6===b?!1:b===k}Ocm(b,k){return 6===b?!1:b!==k}Aom(b,k){return 5===b&&5===k}}Object(m.a)(Mx,"HtmlContentMetadata",null,[]);var Qw=c(1881),Nx=c(1023),Os=c(311),op=c(191),Rw=c(1612),cs=c(107);class Sm{constructor(b,k,r,y,R,aa){this.gwe=!1;this.Ycj=this.yue=null;this.wCa=b;this.L$e=this.KOa=null;this.Pi=k;this.transaction=r;this.oY=y;this.xt=R;this.S4=aa}get Hj(){return null!=
this.Srg?this.Srg:this.Srg=Va.a.instance.Pa("Box4.Styles.StyleSettings")}get K(){return n.AFrameworkApplication.K}get MCe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get vSj(){return!!this.K&&this.K.$("PreserveEopFormattingPasteIsEnabled")}get uF(){return null!=this.Vkg?this.Vkg:this.Vkg=Va.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Hj&&this.Hj.isProgressiveStyleEnabled}get iR(){return null!=this.aug?this.aug:this.aug=
Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get oc(){return null!=this.Eug?this.Eug:this.Eug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.vqg?this.vqg:this.vqg=Va.a.instance.resolve("Box4.IParagraphEditor")}get hd(){return null!=this.epg?this.epg:this.epg=Va.a.instance.resolve("Box4.List.IListReader")}get No(){return null!=this.Pog?this.Pog:this.Pog=Va.a.instance.resolve("Box4.List.IListEditor")}get ilb(){return null!=this.urg?this.urg:this.urg=
Va.a.instance.Pa("Box4.List.ISingleLevelListEditor")}get Oj(){return null!=this.btg?this.btg:this.btg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ph(){return null!=this.Htg?this.Htg:this.Htg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Rd(){return null!=this.mtg?this.mtg:this.mtg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get eW(){return null!=this.Jhg?this.Jhg:this.Jhg=Va.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get wLf(){return null!=
this.Iqg?this.Iqg:this.Iqg=Va.a.instance.Pa("Box4.IPastedParagraphSpaceHandler")}get wFi(){return!1}get n4i(){return this.K.$("WordEditorAutoResizeImageIsEnabled")}WGh(){}get H6b(){return!1}lFi(b){var k=void 0===this.Pi.Dz||null===this.Pi.Dz?"not available":Object(Qw.a)(Rw.a,this.Pi.Dz);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Pi.Dz,k);v.ULS.shipAssertTag(6305487,307,rf.SelectionEditor.zf(this.wCa));if(this.sWd)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Pi.ZXa=
Ke.SelectionFactory.fo(this.wCa),b.ui(Object(u.a)(this,this.hjb,"pasteTeardown")),!0;if(!this.wCa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;k=new Wd.GraphIterator;k.set(this.wCa.node);rf.SelectionEditor.Pt(k);xg.OutlineElementNavigator.Xd(k);this.Ycj=k.origin;if(this.wFi)return k.it(10),this.WGh(k,b),b.ui(Object(u.a)(this,this.SQn,"setSelectionAfterPastingOutlines")),!0;this.oY&&this.oY.PRm(this.wCa);if(!this.v3n(this.wCa))return this.Pi.KQ&&
(this.Pi.KQ.fail("SplitLine Failed",!0),this.Pi.failed=!0),this.Pi.ZXa=Ke.SelectionFactory.fo(this.wCa),b.ui(Object(u.a)(this,this.hjb,"pasteTeardown")),!0;const r=new Wh.a;r.ed(k);xg.OutlineElementNavigator.Wr(r,!1,!1);this.KOa=new Nx.a(k);this.L$e=new Nx.a(r);b.ui(Object(u.a)(this,this.J5m,"pasteExecution"));return!0}J5m(b){Ee.a.mark(5568);this.VGh(b);let k=Object(u.a)(this,this.eJm,"mergeAfterPaste");if(this.bgi){const r=this.l5i();r&&(k=Object(u.a)(this,this.hjb,"pasteTeardown"));v.ULS.sendTraceTag(40387030,
307,50,"ExecutePaste: shouldSkipMerge: {0}.",r)}b.ui(k);return!0}l5i(){return!1}get bgi(){return this.K.$("PptCcpFix2IsEnabled")}get JVn(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}eJm(b){Ee.a.mark(5569);var k=new Wd.GraphIterator;this.KOa.restore(k);Sm.U6||(this.KOa=null);var r=new Wd.GraphIterator;this.L$e.restore(r);this.L$e=null;v.ULS.shipAssertTag(6305489,307,Ag.OutlineElementReader.Nh(k));v.ULS.shipAssertTag(6305490,307,Ag.OutlineElementReader.Nh(r));xg.OutlineElementNavigator.Fe(k);
var y=ie.ParagraphReader.yh(k)?ie.ParagraphReader.textLength(k.currentNode):0;xg.OutlineElementNavigator.Xd(k);xg.OutlineElementNavigator.Fe(r);v.ULS.shipAssertTag(6305491,307,ie.ParagraphReader.yh(r));var R=ie.ParagraphReader.textLength(r.currentNode);xg.OutlineElementNavigator.Xd(r);let aa=this.q0c;var ta=new Wh.a;ta.ed(k);xg.OutlineElementNavigator.Wr(ta,!1,!1);var Ya=ta.currentNode===r.currentNode,xb=!!this.Pi&&!!(this.Pi.Dz&8192);let Mb=!1;!xb&&this.Pi.Ed&&Object(Jb.a)(Di.DictionaryPropertySet,
this.Pi.Ed)&&(xb=(xb=this.Pi.Ed.wg(td.a.$ac))&&""!==xb?!0:!1);if(Ya){y=Wd.GraphIterator.Za(k.currentNode);ie.ParagraphReader.Cu(xg.OutlineElementNavigator.Fe(y))||(k=r);k.currentNode.id!==r.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Vh.ListReader.ei(k),Vh.ListReader.ei(r)),xb=Sm.Ug.merge(k,r,!0,xb),v.ULS.shipAssertTag(6305492,307,xb));r=k;var cc=!0}else{Ya=!!(this.Pi.Dz&4);cc=this.Rd.og&&Ya&&this.Pi.u_a;
var jc=!!(this.Pi.Dz&262144);this.wLf&&this.Pi&&!Ya&&!jc&&(this.wLf.D4h(k,!1),this.wLf.D4h(r,!0));xg.OutlineElementNavigator.Fe(ta);Ya=ie.ParagraphReader.yh(ta)?ie.ParagraphReader.textLength(ta.currentNode):0;xg.OutlineElementNavigator.Xd(ta);this.Vfk(ta,k,r);jc=new Wh.a;jc.ed(ta);xg.OutlineElementNavigator.Wr(jc,!1,!1);Sm.U6&&jc.currentNode.id===r.currentNode.id&&(this.gwe=!0);if(this.eW.ZJa||this.JVn)if(jc.Gn.id!==r.Gn.id){for(;ta.currentNode.id!==r.currentNode.id;)xg.OutlineElementNavigator.Fe(ta,
!1),this.eW.AEa(Re.a.create(ta.currentNode)),ta.mc(),xg.OutlineElementNavigator.Wr(ta,!1,!1);ta.ed(k);xg.OutlineElementNavigator.Wr(ta,!1,!1)}else Mb=!0;this.oY&&({q0c:aa,fta:ta}=this.oY.Xbn(k,r,aa,ta));if(this.Pi.y4d&&(v.ULS.shipAssertTag(6305493,307,this.Pi.t7b),jc=new Wd.GraphIterator,jc.ed(ta),jc=xg.OutlineElementNavigator.Fe(jc))){var Mc=this.Pi.y4d.Yf(jc.qa.J(0));jc.qa.J(0).formatting=Mc}jc=0;xb&&this.MCe&&(jc=1);Mc=this.fWn(k,ta,jc);this.Pi.k$d=null;if(this.Pi.Xva||this.Pi.YQa)this.Pi.k$d=
this.ELl(Mc?k.currentNode:ta.currentNode,Mc);var fd=!1;Mc&&(fd=Vh.ListReader.ei(k),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",fd,Vh.ListReader.ei(r)),this.yue=fd=Sm.Ug.merge(k,ta,!0,xb,r,void 0,Mb,cc,this.MCe),this.gWn(k,jc)&&this.CJm(k,r,jc,xb));jc=Sm.X5m.J5l(k,ta,r,y,fd,this.H6b);var Td=!1;if(aa){const ne=new Wh.a;ne.ed(r);xg.OutlineElementNavigator.e3(ne,!1,!1);Td=Vh.ListReader.ei(ne);const ye=Vh.ListReader.ei(r);cc=Sm.Ug.merge(ne,
r,!0,xb,void 0,!0,void 0,cc,this.MCe,this.vSj);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Td,ye,cc?"True":"False, will cause IP to reset to zero.");r=(Td=cc)?ne:r}else cc=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.eW.ZJa&&Mb&&(Mc&&!this.ifm(jc,fd)?(ta=new Wd.GraphIterator,ta.ed(k),k=xg.OutlineElementNavigator.Fe(ta),this.eW.loa(k,y,y+Ya)):aa&&!this.Fhm(jc,
Td)?(k=new Wd.GraphIterator,k.ed(ta),k=xg.OutlineElementNavigator.Fe(k),this.eW.loa(k,0,Ya)):(k=new Wd.GraphIterator,k.ed(ta),k=xg.OutlineElementNavigator.Fe(k),this.eW.AEa(Re.a.create(k))));this.b9m(jc);this.isProgressiveStyleEnabled&&!xb&&this.uF.$bn(jc)}v.ULS.shipAssertTag(6305494,307,r.Sd);xb=xg.OutlineElementNavigator.Fe(r);R=cc?ie.ParagraphReader.textLength(xb)-R:0;k=!1;Object(Jb.a)(89,this.Pi.Ed)&&(k=this.Pi.Ed.ia(td.a.N6,!1));this.Pi.ZXa=k?Ke.SelectionFactory.DN(xb,R-1,R):Ke.SelectionFactory.xe(xb,
R);gh.a.instance.J(10)&&this.Pi&&this.Pi.t7b&&ie.ParagraphReader.nc(xb)&&this.Pi.IZd&&((R=this.Pi.IZd.j6n)&&this.iR.pM(R,xb,!0),(R=this.Pi.IZd.G4m)&&this.paragraphEditor.reh(xb,R));b.ui(Object(u.a)(this,this.hjb,"pasteTeardown"));return!0}ifm(b,k){return!k&&!!b&&Ag.OutlineElementReader.Nh(b.fta)&&Ag.OutlineElementReader.tbb(b.fta)}Fhm(b,k){return!k&&!!b&&Ag.OutlineElementReader.Nh(b.fhb)&&Ag.OutlineElementReader.tbb(b.fhb)}b9m(b){Sm.YGi&&b&&Sm.YGi.Vbn(b)}fWn(b,k,r){Vh.ListReader.ei(b)?(Sm.ae.iEb&&
this.ilb&&this.ilb.ynf(b),k=Vh.ListReader.ei(k)?this.D4i:!0):Ag.OutlineElementReader.isEmpty(b,!0)&&!r?(Sm.Ug.yXa(b),k=!1):k=Vh.ListReader.sr||!Vh.ListReader.ei(k);this.oY&&(k=this.oY.vwk(b,k));return k}gWn(b,k){return Vh.ListReader.ei(b)||1===k?!0:!1}CJm(b,k,r,y){const R=Vh.ListReader.ei(b);if(R){if(y=new Wh.a,y.ed(b),xg.OutlineElementNavigator.Wr(y,!1,!1),y.Gn.id!==k.Gn.id){r=this.hd.Gs(b);this.hd.kD(b);var aa=b.currentNode.ia(wc.a.listID,0);b.mc();var ta=this.hd.F7i,Ya=!0;for(r.$z=bg.a.Yi;y.currentNode.id!==
k.currentNode.id;){if(!ta||!Ag.OutlineElementReader.FXn(y))if(!Vh.ListReader.ei(y))({eCa:r}=this.No.Mra(r.propertySet,y,r)),Ya=!1;else if(R){Ya=this.hd.Mff(y);var xb=this.hd.Tw(b.currentNode,aa,Ya);xb=xb?Os.a.Z1(xb,null):r;Ya=Os.a.KP(xb.listType,r.listStyle,null,0,Ya,"","");Ya.iib=b.currentNode;this.No.zPn(Ya);this.No.n7d(y,!0);Ya=!1}xg.OutlineElementNavigator.Wr(y,!1,!1)}ta&&Ya&&this.No.ngh()}}else if(1===r)for(r=new Wh.a,r.ed(b),xg.OutlineElementNavigator.Fe(r),b=ie.ParagraphReader.yh(r)?r.currentNode:
null,aa=this.oc.wId(r),xg.OutlineElementNavigator.Xd(r),xg.OutlineElementNavigator.Wr(r,!1,!1);r.currentNode.id!==k.currentNode.id;)xg.OutlineElementNavigator.Fe(r),ta=ie.ParagraphReader.yh(r)?r.currentNode:null,xg.OutlineElementNavigator.Xd(r),ta&&b&&y&&(aa&&this.iR.pM(aa,ta,!0),this.S4.tsi(b,ta,R),this.S4.Q0a(b,ta,1,!0)),xg.OutlineElementNavigator.Wr(r,!1,!1)}Vfk(b,k,r){var y=!1;if(this.Rd.og)if(cs.a.tA)y=!0;else{var R=!1;this.oY&&(R=k.currentNode,R=this.oY.bkm(R)||this.oY.$sf(R));R?this.Rd.L1a=
4:y=!0}if(y){for(;b.currentNode!==r.currentNode;){xg.OutlineElementNavigator.Fe(b,!1);y=this.Ph.f1c(Re.a.create(b.currentNode));let aa;({type:aa}=y.YId()).returnValue&&this.Rd.ys(aa);for(R=0;R<y.length;R++){let ta;const Ya=({cRd:ta}=y.getContext(R)).returnValue;ta&&(Sm.hyperlinkEditor.cib(Ya,1),this.Oj.Pkb(Ya,1,null,!0))}b.mc();xg.OutlineElementNavigator.Wr(b,!1,!1)}b.ed(k);xg.OutlineElementNavigator.Wr(b,!1,!1)}}ELl(b,k){b=Wd.GraphIterator.Za(b);xg.OutlineElementNavigator.Fe(b);return ie.ParagraphReader.nc(b.currentNode)?
(k=k?ie.ParagraphReader.textLength(b.currentNode):0,Ke.SelectionFactory.xe(b.currentNode,k)):Si.TableReader.eX(b.currentNode)?Ke.SelectionFactory.Sq(b.currentNode):null}SQn(b){const k=Wd.GraphIterator.Za(this.Ycj);k.oE(1);this.Pi.ZXa=Ke.SelectionFactory.xo(k.currentNode,!1);b.ui(Object(u.a)(this,this.hjb,"pasteTeardown"));return!0}hjb(){var b=void 0===this.Pi.Dz||null===this.Pi.Dz?"not available":Object(Qw.a)(Rw.a,this.Pi.Dz);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Pi.Dz,
b);v.ULS.shipAssertTag(6305497,307,!!this.Pi.ZXa);this.H6b?Object(Ib.a)("ExternalPasteAction",!0):Object(Ib.a)("InternalPasteAction",!0);Sm.U6&&this.KOa&&(b=new Wd.GraphIterator,this.KOa.restore(b),this.KOa=null,this.GWl(b));this.transaction.dispose();b=this.xt.zv;if(!b.ye||!b.editingView.Dj)return!1;b.editingView.K9n();return!1}GWl(b){if(b){if(this.H6b&&Si.TableReader.Pv(b)&&this.gwe){if(null!=this.yue&&0==this.yue){var k=new Wh.a;k.ed(b);xg.OutlineElementNavigator.Wr(k,!1,!1);b.ed(k)}k=xp.a.Vwn(b);
let r=ie.ParagraphReader.Rm(k);k&&r&&(this.Pi.ZXa=Ke.SelectionFactory.xe(r,0),b=Wd.GraphIterator.Za(k))}else Sm.Xjm&&xp.a.R5m(b);k=new Wd.GraphIterator;k.ed(b);Si.TableReader.TQd(k)&&(this.H6b?Object(Ib.a)("ExternalTablePasteAction",!0):Object(Ib.a)("InternalTablePasteAction",!0),Si.TableReader.Pv(k)&&!this.gwe&&Object(Ib.a)("TablePastedInsideTableWithSomeContent",!0));b&&Si.TableReader.Pv(b)&&bf.returnToContainingCell(b)&&xp.a.tak(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}MUn(b,
k){const r=new Wd.GraphIterator;r.ed(b);b=xg.OutlineElementNavigator.Fe(r);k=ie.ParagraphReader.nc(b)&&k===ie.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",k);return k}v3n(b){v.ULS.shipAssertTag(6305498,307,rf.SelectionEditor.zf(b));const k=Wd.GraphIterator.Za(b.node);var r=k.rd();xg.OutlineElementNavigator.Xd(k);r&&b.Sd||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,
["isValidIpContext"]:b.Sd});if(!Ag.OutlineElementReader.Nh(k)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;r=Sm.Ug.Uta(k,!0);const y=this.MUn(k,b.cpBegin);Sm.Ug.Hba(k,r,b,!1,!1,!0,y);return!0}static get hyperlinkEditor(){return null!=Sm.Ilg?Sm.Ilg:Sm.Ilg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ue(){return De.PageReader.instance}static get Ug(){return null!=Sm.Hpg?Sm.Hpg:Sm.Hpg=
Va.a.instance.resolve("Box4.IOutlineElementEditor")}static get ae(){return op.a.getInstance()}static get Wb(){return null!=Sm.kkg?Sm.kkg:Sm.kkg=Va.a.instance.Pa("Box4.IFeatureHelper")}static get YGi(){return null!=Sm.Kqg?Sm.Kqg:Sm.Kqg=Va.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get X5m(){return null!=Sm.Hqg?Sm.Hqg:Sm.Hqg=Va.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get U6(){null==this.U8&&(n.AFrameworkApplication.Ne("he991617;3eed2178"),
this.U8=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.U8}static get Xjm(){null==this.qve&&(n.AFrameworkApplication.Ne("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.qve=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.qve}}Sm.U8=null;Sm.qve=null;
Object(m.a)(Sm,"APasteExecutionManager",null,[]);class cw{constructor(b){this.Gj=b}reset(){this.Gj.reset()}get HDc(){return this.Gj.HDc}Uaa(b,k){this.Gj.Uaa(b,k)}sDa(b){this.Gj.sDa(b)}Iib(b){this.Gj.Iib(b)}eva(b){this.Gj.eva(b)}oDa(b){this.Gj.oDa(b)}nOa(b,k){this.Gj.nOa(b,k)}mOa(){this.Gj.mOa()}VF(b){this.Gj.VF(b)}UF(){this.Gj.UF()}Fib(){this.Gj.Fib()}Eib(){this.Gj.Eib()}vDa(b){this.Gj.vDa(b)}tDa(){this.Gj.tDa()}rOa(b){this.Gj.rOa(b)}uDa(){this.Gj.uDa()}s1a(b){this.Gj.s1a(b)}Taa(b){this.Gj.Taa(b)}Qaa(){this.Gj.Qaa()}Saa(b){this.Gj.Saa(b)}Raa(){this.Gj.Raa()}Paa(b){this.Gj.Paa(b)}Oaa(){this.Gj.Oaa()}sOa(b,
k){this.Gj.sOa(b,k)}p1a(){this.Gj.p1a()}}Object(m.a)(cw,"AHtmlNormalizer",null,[373,374]);class Sw extends cw{constructor(b){super(b);this.aJ=!1}Uaa(b,k){this.aJ?this.lM.BL(()=>{this.rOf(b,k)}):this.rOf(b,k)}rOf(b,k){this.Gj.Uaa(b,k)}sDa(b){this.aJ?this.lM.BL(()=>{this.UNf(b)}):this.UNf(b)}UNf(b){this.Gj.sDa(b)}eva(b){this.aJ?this.lM.BL(()=>{this.DVc(b)}):this.DVc(b)}DVc(b){this.Gj.eva(b)}oDa(b){this.aJ?this.lM.BL(()=>{this.TNf(b)}):this.TNf(b)}TNf(b){this.Gj.oDa(b)}nOa(b,k){this.aJ?this.lM.BL(()=>
{this.PNf(b,k)}):this.PNf(b,k)}PNf(b,k){this.Gj.nOa(b,k)}mOa(){this.aJ?this.lM.BL(Object(u.a)(this,this.ONf,"processAnchorEnd")):this.ONf()}ONf(){this.Gj.mOa()}VF(b){this.aJ?this.lM.BL(()=>{this.dOf(b)}):this.dOf(b)}dOf(b){this.Gj.VF(b)}UF(){this.aJ?this.lM.BL(Object(u.a)(this,this.cOf,"processParagraphEnd")):this.cOf()}cOf(){this.Gj.UF()}Fib(){this.aJ?this.lM.BL(Object(u.a)(this,this.fOf,"processPreFormattedTextStart")):this.fOf()}fOf(){this.Gj.Fib()}Eib(){this.aJ?this.lM.BL(Object(u.a)(this,this.eOf,
"processPreFormattedTextEnd")):this.eOf()}eOf(){this.Gj.Eib()}vDa(b){this.aJ?this.lM.BL(()=>{this.YNf(b)}):this.YNf(b)}YNf(b){this.Gj.vDa(b)}tDa(){this.aJ?this.lM.BL(Object(u.a)(this,this.VNf,"processListEnd")):this.VNf()}VNf(){this.Gj.tDa()}rOa(b){this.aJ?this.lM.BL(()=>{this.XNf(b)}):this.XNf(b)}XNf(b){this.Gj.rOa(b)}uDa(){this.aJ?this.lM.BL(Object(u.a)(this,this.WNf,"processListItemEnd")):this.WNf()}WNf(){this.Gj.uDa()}Taa(b){this.aJ?this.lM.BL(()=>{this.qOf(b)}):this.qOf(b)}qOf(b){this.Gj.Taa(b)}Qaa(){this.aJ?
this.lM.BL(Object(u.a)(this,this.nOf,"processTableEnd")):this.nOf()}nOf(){this.Gj.Qaa()}Saa(b){this.aJ?this.lM.BL(()=>{this.pOf(b)}):this.pOf(b)}pOf(b){this.Gj.Saa(b)}Raa(){this.aJ?this.lM.BL(Object(u.a)(this,this.oOf,"processTableRowEnd")):this.oOf()}oOf(){this.Gj.Raa()}Paa(b){this.aJ?this.lM.BL(()=>{this.mOf(b)}):this.mOf(b)}mOf(b){this.Gj.Paa(b)}Oaa(){this.aJ?this.lM.BL(Object(u.a)(this,this.lOf,"processTableCellEnd")):this.lOf()}lOf(){this.Gj.Oaa()}sOa(b,k){this.aJ?this.lM.BL(()=>{this.ZNf(b,
k)}):this.ZNf(b,k)}ZNf(b,k){this.Gj.sOa(b,k)}p1a(){this.aJ?this.lM.BL(Object(u.a)(this,this.DIi,"processMathEnd")):this.DIi()}DIi(){this.Gj.p1a()}}Object(m.a)(Sw,"AQueuingHtmlNormalizer",cw,[]);var dw=c(1830);class Ct{constructor(){this.kEe=new dw.a}BL(b){this.kEe.enqueue(b)}flush(b=!1){for(b&&this.G6d();!this.kEe.isEmpty;)this.kEe.dequeue()();b&&this.L4d()}G6d(){}L4d(){}}Object(m.a)(Ct,"QueuedEventManager",null,[]);class oq extends Ct{constructor(b){super();this.id=void 0;this.g2e=null;this.tPd=
!1;this.sva="";this.sPd=this.hQd=!1;this.W1e=this.Q_b=null;this.CSc=0;this.pOc=this.KPc=this.Kuf=!1;this.table=null;this.SDf=0;this.JY=b}get Ryc(){return!!this.table}G6d(){this.JY.Dac.push(this.JY.currentState);this.JY.currentState=this}L4d(){this.JY.currentState=this.JY.Dac.pop()}}oq.nextId=void 0;Object(m.a)(oq,"ContentState",Ct,[]);var yo=c(314);class Dt{constructor(b,k,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.S_a=b.S_a;this.shadingColor=b.shadingColor;
this.verticalAlignment=b.verticalAlignment;this.rha=b.rha;this.nae=b.nae;this.U7b=b.U7b;this.N5=b.N5;this.contents=r;this.nSl=k}}Object(m.a)(Dt,"TableCell",null,[]);var sA=c(1078),xz=c(1079),Pu=c(1082),ft=c(1083),ew=c(1081);class Qu extends Ct{constructor(b,k){super();this.JY=b;this.F3g=new Lj.a;this.vpa=new Lj.a;this.uze=[];this.Pkd=[];this.KGa=-1;this.SRa=0;this.VJj=k.Qbi;this.UJj=k.ebm;this.xYj=k.z4f;this.Gp=k.width;this.rNg=k.S_a;this.iHj=new yo.a(new Kx.a(k.p7.C7h,k.p7.JLd),k.FA,k.vna,k.cultureName,
k.mza);this.SIj=k.tMd;this.Bnd=k.styleId;this.DYj=k.tableLook}get Gj(){return this.JY.Gj}q$m(b){this.KGa++;this.F3g.add(b);this.Pkd[this.KGa]=b.height;this.SRa=0}get bRk(){for(;this.SRa>=this.vpa.count;)this.vpa.add(Array(this.KGa+1));return this.vpa.J(this.SRa)}O2j(b,k,r,y,R,aa,ta){if(0>this.KGa)return!1;for(;this.uze[this.SRa]>=this.KGa;)this.SRa++;b=new Dt(b,new yo.a(k,r,y,R,aa),ta);this.bRk[this.KGa]=b;if(1<b.rowSpan)for(k=this.KGa+b.rowSpan-1,y=this.SRa,r=this.SRa+b.colSpan-1;y<=r;y++)this.uze[y]>=
k||(this.uze[y]=k);this.SRa+=b.colSpan;this.Pkd[this.KGa]<b.height&&(this.Pkd[this.KGa]=b.height);return!0}G6d(){this.JY.currentState.table=this}L4d(){this.JY.currentState.table=null}yKh(){this.flush(!0);const b=this.KGa+1;var k=Array(b);for(var r=0;r<b;r++)k[r]=Array(this.vpa.count);r=!0;var y=0;for(var R=0;R<this.vpa.count;R++){var aa=this.vpa.J(R),ta=!0;for(var Ya=0;Ya<b;Ya++){var xb=aa[Ya];xb&&(ta=!1,k[Ya][R+y]=new Pu.a(xb.colSpan,xb.rowSpan,xb.width,xb.height,void 0,void 0,void 0,void 0,xb.S_a,
xb.U7b))}ta?(this.vpa.removeAt(R),R--,++y):r=!1}if(!r){(k=this.rNg?this.JY.Gkh(k,this.Gp/100):this.JY.Gkh(k))&&k.length!==this.vpa.count&&(k=null);this.JY.Icb(!0);this.JY.pvd();this.Gj.Taa(new ew.a(b,this.vpa.count,this.Gp,this.rNg,k,this.VJj,this.UJj,this.xYj,this.SIj,this.Bnd,this.DYj,this.iHj));for(k=0;k<b;k++){r=this.F3g.J(k);this.Gj.Saa(new ft.a(this.Pkd[k],new yo.a(r.p7,r.FA,r.vna,r.cultureName,r.mza)));for(r=0;r<this.vpa.count;r++){y=this.vpa.J(r)[k];var Mb=!!this.Bnd&&""!==this.Bnd&&"Custom"!==
this.Bnd;R=y?y.colSpan:0;aa=y?y.rowSpan:0;ta=y?y.width:0;Ya=y?y.height:0;xb=y?y.N5:0;const cc=y?y.S_a:!1,jc=y&&(65536&xb||!Mb)?y.shadingColor:"",Mc=y?y.verticalAlignment:0,fd=y?y.U7b:!1;Mb=y?this.JY.NCl(y.rha,r,k,this.vpa,Mb,y.N5):new sA.a;const Td=y?y.nae:new xz.a,ne=y?y.nSl:null;this.Gj.Paa(new Pu.a(R,aa,ta,Ya,jc,Mc,Mb,Td,cc,fd,xb,new yo.a(ne?ne.p7:null,ne?ne.FA:null,ne?ne.vna:null,ne?ne.cultureName:null,ne?ne.mza:null)));y&&!y.U7b&&(y.contents.G6d(),y.contents.flush(),this.JY.Icb(!1),this.JY.pvd(),
y.contents.L4d());this.Gj.Oaa()}this.Gj.Raa()}this.Gj.Qaa();this.JY.currentState.pOc=!1;this.JY.NFh(!1)}}}Object(m.a)(Qu,"NormalizedTable",Ct,[]);class Ox{constructor(b=!1,k=!1){this.GKj=b;this.o1=k}get Ugm(){return this.GKj}get Iba(){return this.o1}}Object(m.a)(Ox,"HtmlNormalizerSettings",null,[377]);var Up=c(820);class Et extends Sw{constructor(b,k=null){super(b);this.Dac=new Up.a;this.wRb=k||new Ox}reset(){super.reset();this.currentState=new oq(this);this.Dac.clear();this.aJ=!1}get lM(){return this.currentState&&
this.currentState.Ryc?this.currentState.table:this.currentState}iBd(b=!1){this.currentState.tPd||(this.pvd(),this.Gj.VF(this.currentState.g2e),this.currentState.tPd=!0,this.currentState.pOc=!1);b||!this.currentState.Q_b||this.currentState.sPd||(this.Gj.nOa(this.currentState.Q_b,this.currentState.W1e),this.currentState.sPd=!0)}AFc(){this.currentState.sPd&&(this.Gj.mOa(),this.currentState.sPd=!1)}R4k(){this.currentState.tPd&&(this.Gj.UF(),this.currentState.tPd=!1,this.currentState.sva="")}NFh(b){this.currentState.KPc&&
(this.currentState.pOc?b||(this.Gj.VF(null),this.Gj.UF(),this.Gj.uDa(),this.currentState.KPc=!1):(this.Gj.uDa(),this.currentState.KPc=!1,this.currentState.pOc=!0))}Icb(b){this.AFc();this.R4k();this.NFh(b)}w1m(b){this.Gj.vDa(new Iq.a(2,1,b));this.currentState.CSc++;this.currentState.Kuf=!0}pvd(){!this.currentState.KPc&&this.currentState.Kuf&&(this.Gj.tDa(),this.currentState.CSc--,this.currentState.Kuf=!1)}rOf(b,k){b=this.yOm(b);if(""!==b)if(this.iBd(),this.currentState.hQd)this.sOf(b,k);else{b=b.split(Et.Vpk);
for(let r=0;r<b.length-1;r++)this.sOf(b[r],k),this.Gj.Iib(k);this.sOf(b[b.length-1],k)}}ZNf(b,k){""!==b&&(this.iBd(),this.Gj.sOa(b,k))}UNf(b){this.wRb.Iba||this.AFc();this.iBd(!0);this.Gj.sDa(b)}TNf(b){this.currentState.Ryc||this.Gj.oDa(b)}DVc(b){this.currentState.Q_b&&(b.href=this.currentState.Q_b);super.DVc(b)}PNf(b,k){this.AFc();this.currentState.Q_b=b;this.currentState.W1e=k}ONf(){this.AFc();this.currentState.Q_b=null;this.currentState.W1e=null}dOf(b){this.currentState.g2e=b;this.Icb(!0)}cOf(){this.currentState.g2e=
null;this.Icb(!0)}fOf(){this.currentState.hQd=!0}eOf(){this.currentState.hQd=!1}YNf(b){this.Icb(!1);this.pvd();this.Gj.vDa(b);this.currentState.CSc++}VNf(){this.Icb(!1);this.Gj.tDa();this.currentState.CSc--}XNf(b){this.Icb(!1);this.currentState.CSc||this.w1m(b);this.Gj.rOa(b);this.currentState.KPc=!0;this.currentState.pOc=!0}WNf(){this.Icb(!1)}Taa(b){this.currentState.Ryc||(this.aJ=!0,this.currentState.table=new Qu(this,b))}qOf(){}Qaa(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.Dac.isEmpty?(this.aJ=!1,b.yKh()):this.lM.BL(Object(u.a)(b,b.yKh,"flushTable"))}}nOf(){}Saa(b){this.currentState.Ryc&&this.currentState.table.q$m(b)}pOf(){}Raa(){}oOf(){}Paa(b){let k=!1;if(this.currentState.Ryc){const r=new oq(this);this.currentState.table.O2j(b,new Kx.a(b.p7.C7h,b.p7.JLd),b.FA,b.vna,b.cultureName,b.mza,r)?(this.Dac.push(this.currentState),this.currentState=r):k=!0}else k=!0;k&&this.currentState.SDf++}mOf(){}Oaa(){0<this.currentState.SDf?this.currentState.SDf--:this.currentState=
this.Dac.pop()}lOf(){}Gkh(b,k=1){if(!b)return null;const r=b.length;if(!r)return null;const y=b[0].length;for(var R=1;R<r;R++)if(b[R].length!==y)return null;R=Array(y+1);R[0]=0;const aa=Array(y+1);for(var ta=0;ta<aa.length;ta++)aa[ta]=!1;ta=new rb.a;for(let xb=0;xb<y;xb++){for(var Ya=0;Ya<r;Ya++){const Mb=b[Ya][xb];if(Mb&&0<Mb.width){const cc=Math.min(xb+Mb.colSpan,y);R[cc]=R[xb]+Mb.width*(Mb.S_a?k:1);aa[cc]=!0}}if(aa[xb+1]){Ya=R[xb+1]-R[xb];if(0>=Ya)return null;ta.add(Ya)}else R[xb+1]=R[xb]}return ta.toArray()}uHm(b,
k){1&k||(b.borderTopStyle=12);16&k||(b.borderRightStyle=12);256&k||(b.borderBottomStyle=12);4096&k||(b.borderLeftStyle=12);return b}NCl(b,k,r,y,R,aa){if(!b)return null;R&&(b=this.uHm(b,aa));if(0>r||0>k||k>y.count-1)return b;0<=k-1&&r<=y.J(k-1).length-1&&1===b.borderLeftStyle&&(R=y.J(k-1)[r])&&1!==R.rha.borderRightStyle&&(b.borderLeftStyle=R.rha.borderRightStyle,b.borderLeftColor=R.rha.borderRightColor,b.borderLeftWidth=R.rha.borderRightWidth);0<=r-1&&r<=y.J(k).length-1&&1===b.borderTopStyle&&(k=y.J(k)[r-
1])&&1!==k.rha.borderBottomStyle&&(b.borderTopStyle=k.rha.borderBottomStyle,b.borderTopColor=k.rha.borderBottomColor,b.borderTopWidth=k.rha.borderBottomWidth);return b}yOm(b){this.currentState.hQd||(b=this.wRb.Ugm?b.replace(Et.z0l," "):b.replace(Et.y0l," "));b.startsWith(" ")&&(this.currentState.sva.endsWith(" ")||""===this.currentState.sva)&&(b=A.a.substring(b,1,b.length));return b}sOf(b,k){""!==b&&(this.Gj.Uaa(b,k),this.currentState.sva+=b)}}Et.y0l=RegExp("[ \t\f\u200b\r\n]+","g");Et.z0l=RegExp("[ \f\u200b\r\n]+",
"g");Et.Vpk="\t";Object(m.a)(Et,"DefaultHtmlNormalizer",Sw,[]);class pg extends Et{constructor(b,k,r){super(b,r);this.FIg=!1;this.uqb=k}static vdm(b){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=pg.VVk.exec(b))&&0<b.length:!1}DVc(b){this.uqb.cbc&&(n.AFrameworkApplication.Wma?this.FIg||(b=new cf.StandardDialog,b.Gd=0,b.We(1,CommonUIStrings.l_DialogClose),b.Tv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.FIg=!0):this.uqb.Iri?this.uqb.WUd=!0:b.src&&""!==b.src?Oa.a.N$(b.src)!==Oa.a.N$(window.location.href)||pg.vdm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?n.AFrameworkApplication.ya.processAction(Wa.a.rFi,2):b.src.startsWith("webkit-fake-url")?n.AFrameworkApplication.ya.processAction(Wa.a.qFi,2):(this.AFc(),this.iBd(!0),this.Gj.eva(b)):n.AFrameworkApplication.ya.processAction(Wa.a.tFi,2):n.AFrameworkApplication.ya.processAction(Wa.a.sFi,2))}}pg.VVk=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(m.a)(pg,"Box4HtmlNormalizer",Et,[]);class Hy{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.htmlProcessor=b;this.Xmf=k;this.Luk=r;this.unj=y;this.Jfl=R;this.YGn=aa;this.ZGn=ta;this.ILd=Ya;this.s0l=xb;this.u0l=Mb;this.uum=cc}}Object(m.a)(Hy,"ExecutePasteArguments",null,[]);class Iy extends Sm{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne){super(k,r,y,Mb,jc,Td);this.Iia=null;this.rOm=ye=>{this.acd.bli(this.Zia)&&n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.EWj&&this.acd.Zdo(this.Zia);ye.ui(this.u$m);return!0};this.u$m=ye=>{if(this.QVj){const ff=this.Zia.getElementsByTagName("style");if(ff&&0<ff.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let Gd=0;Gd<ff.length;Gd++)this.xpe.AHk(this.Zia,ff[Gd]),ff[Gd]&&(ff[Gd].parentNode.removeChild(ff[Gd]),Gd--)}}ye.ui(this.QHk);return!0};this.QHk=(ye,ff)=>{this.$Me.value.create(ff.unj).process(this.Zia,ye);(ff=Va.a.instance.Pa("Box4.IFeatureHelper"))&&
ff.isFeatureEnabled(11)?ye.ui(this.VGk):ye.ui(this.wIi);return!0};this.VGk=(ye,ff)=>{(new Fy(ff.Luk)).process(this.Zia,ye);ye.ui(this.wIi);return!0};this.wIi=(ye,ff)=>{ff.htmlProcessor.process(this.Zia,ye);ye.ui(ff.Xmf&&ff.Xmf.cbc?this.fJb:this.$Eh);return!0};this.fJb=(ye,ff)=>{if(ff=ff.Xmf){let Gd=!1,oe=!1,ze=!1,ug=!1,Yf=-1;const Aj=new Di.DictionaryPropertySet,cn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Jb.a)(89,this.Pi.Ed)){Gd=this.Pi.Ed.ia(wc.a.vfa,!1);const Vl=this.Pi.Ed.ia(td.a.PQ,
"");ze=this.Pi.Ed.ia(td.a.N6,!1);ug=this.Pi.Ed.ia(Te.a.wfa,!1);cn.test(Vl)&&(oe=!0);this.n4i&&(Yf=this.Pi.Ed.ia(Gh.a.pea,-1))}else this.Pi.Dz&256&&this.Zia&&(Gd=!0,cn.test(this.Zia.innerHTML)&&(oe=!0));Aj.setValue(wc.a.vfa,Gd);Aj.setValue(td.a.RPc,oe);Aj.setValue(td.a.N6,ze);Aj.setValue(Gh.a.pea,Yf);Aj.setValue(Te.a.wfa,ug);ff.$6d(Aj);ff.oIf();ff.fib&&(this.Pi.hOc=!0,this.Pi.tnf=ff.e2,this.Pi.cFf=ff.fib,Gd&&!ze&&Ib.c(Wa.a.M7k),n.AFrameworkApplication.ya.processAction(Wa.a.fJb,2))}ye.ui(this.$Eh);
return!0};this.$Eh=(ye,ff)=>{Fh.a.MEm(ff.unj);Fh.a.hAm(ff.u0l);Fh.a.oDm(ff.YGn);Fh.a.pDm(ff.ZGn);Fh.a.LAm(ff.uum);ye="Others";ff.ILd&&(ff.ILd.eAm(),ff.ILd.fAm(),ye=ff.ILd.c2f);Fh.a.gAm(ff.s0l,ye);Fh.a.Lzm(ff.Jfl,ye);return!1};this.Zia=b;this.lje=R;this.ate=aa;this.JJe=ta;this.$Me=Ya;this.Voc=xb;this.wRb=fd;this.Oa=cc;this.sJg=Object.assign(new Ou.a,{u6b:2===this.Pi.k_b||3===this.Pi.k_b});this.xpe=Mc;this.acd=ne;this.jVb=cc.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.QVj=cc.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.EWj=cc.$("RemoveSpacesAfterEndFragmentIsEnabled")}get sWd(){return!1}get H6b(){return!0}VGh(b){this.Iia=new Wd.GraphIterator;this.KOa.restore(this.Iia);v.ULS.shipAssertTag(6305550,307,Ag.OutlineElementReader.Nh(this.Iia));this.Pi.KQ&&this.Pi.KQ.WXb("external");var k=this.Pi.Dz&8192?1:0,r=this.ate.value.create(k,this.Iia,this.Pi.pBc,this.Pi.dkb);const y=this.JJe.value.create(k,this.Iia),R=Fh.a.TOh(n.AFrameworkApplication.userSessionId),aa=Fh.a.Pjf(n.AFrameworkApplication.userSessionId),ta=Fh.a.Nef(X.a.uwb,
this.Pi.pBc),Ya=Fh.a.j_h(n.AFrameworkApplication.userSessionId),xb=Fh.a.k_h(n.AFrameworkApplication.userSessionId),Mb=this.jVb?this.o5l():null,cc=Fh.a.vTh(X.a.uwb,this.Pi.pBc),jc=Fh.a.wTh(n.AFrameworkApplication.userSessionId),Mc=this.Voc.l4i?Fh.a.Zzl(n.AFrameworkApplication.userSessionId):null;k=this.lje.value.create(k,this.Iia,r,y,null,ta,this.Zbk);k=new Gy(k,Ya,xb);k=new pg(k,r,this.wRb);k=new Hu.a(k,this.Voc,this.sJg,Mc);k=new hn(k,cc,Mb,this.Oa);k=new Bt(k,jc);r=new Hy(k,r,R,aa,ta,Ya,xb,Mb,cc,
jc,Mc);r=new Rr.a(b,this.rOm,r);r.ll("paste and request pictures");r.fh=!b||b.fh;r.run()}get Zbk(){return this.Zia.getElementsByTagName("a").length}o5l(){const b=new Mx;b.Uac=X.a.uwb;this.Pi&&(b.Dz=this.Pi.Dz,b.UJf=this.Pi.pBc,this.Pi.Ed&&(b.progId=this.Pi.Ed.ia(td.a.pFi,"")));this.Zia&&this.Zia.innerHTML&&(b.Y5m=this.Zia.innerHTML.length);n.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=n.AFrameworkApplication.sessionStartInfoSettings.Platform);return b}get D4i(){return!0}get q0c(){v.ULS.shipAssertTag(6305551,
307,!!this.Iia);if(this.Voc.m4i(this.sJg)){let b=!1;Ag.OutlineElementReader.Nh(this.Iia)&&(this.Iia.T$(),b=!0);const k=ie.ParagraphReader.yh(this.Iia)&&!this.Iia.currentNode.ia(td.a.Pdi,!1);b&&this.Iia.mc();return k}return ie.ParagraphReader.yh(this.Iia)}}Object(m.a)(Iy,"ExternalPasteExecutionManager",Sm,[]);class Jy{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.lje=b;this.ate=k;this.JJe=r;this.$Me=y;this.Voc=R;this.oY=aa;this.Oa=ta;this.xpe=Ya;this.wRb=xb;this.S4=Mb;this.acd=cc}create(b,k,r,y){return new Iy(b,
k,r,y,this.lje,this.ate,this.JJe,this.$Me,this.Voc.value,this.oY,this.Oa,Ka.App.xa.jb,this.xpe,this.wRb,this.S4,this.acd)}}Object(m.a)(Jy,"Factory",null,[670]);class yz{bli(b){if(!b||!b.childNodes)return!1;const k=b.childNodes.length;return 2>k?!1:this.vem(b.childNodes[k-2])&&this.Gpm(b.childNodes[k-1])}Zdo(b){this.bli(b)&&(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}Xbm(b){return!!b&&8===b.nodeType}$nm(b){return!!b&&3===b.nodeType}vem(b){return this.Xbm(b)&&
"EndFragment"===b.nodeValue}Gpm(b){if(!this.$nm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(m.a)(yz,"HtmlNormalizerHelper",null,[669]);var Ps=c(1819),tA=c(646);class Ky extends Sm{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,r,R,aa,Ya);this.qz=y;this.QH=ta}get fl(){return this.QH.value}get sWd(){return this.qz.sWd()}get wFi(){const b=this.qz;return b.GZe&&!b.kai()}WGh(b,k){v.ULS.shipAssertTag(6305616,307,Nf.OutlineReader.Aw(b));const r=tA.a(b.currentNode);if(Nf.OutlineReader.isEmpty(b)){var y=
Re.a.create(b.currentNode);b.it(8);n.AFrameworkApplication.ya.Vf(y,Wa.a.XG,2,!0,null,null)}else b.it(8);(y=b.oE(1))&&b.mc();this.qz.gFi(this.Pi.ve,b.currentNode,y,-1,r,k)}VGh(b){const k=new Wd.GraphIterator;this.KOa.restore(k);v.ULS.shipAssertTag(6305618,307,Ag.OutlineElementReader.Nh(k));this.Pi.KQ&&this.Pi.KQ.WXb("internal");let r=-1;if(this.n4i&&Object(Jb.a)(89,this.Pi.Ed))r=this.Pi.Ed.ia(Gh.a.pea,-1);else{const y=this.Hql(k.currentNode);r=y?y.clientWidth:r}this.qz.gFi(this.Pi.ve,k.parentNode,
k.currentNode,r,null,b);this.bgi&&(this.KOa.restore(k),Ag.OutlineElementReader.Nh(k)&&this.qz.hji(k)&&(b=xg.OutlineElementNavigator.Fe(k)))&&(this.Pi.ZXa=Ke.SelectionFactory.xe(b,0))}Hql(b){return b?(b=b?b.Be(this.fl.Sb):null)?b.htmlElement:null:null}l5i(){const b=new Wd.GraphIterator;this.KOa.restore(b);return this.qz.hji(b)}get D4i(){return Vh.ListReader.sr}get q0c(){return!this.qz.Usa&&!this.qz.GZe}}Object(m.a)(Ky,"InternalPasteExecutionManager",Sm,[]);class Ly{constructor(b,k,r,y){this.qz=b;this.oY=
k;this.QH=r;this.S4=y}create(b,k,r){return new Ky(b,k,r,this.qz,this.oY,Ka.App.xa.jb,this.QH,this.S4)}}Object(m.a)(Ly,"Factory",null,[668]);var Fr;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(Fr||(Fr={}));Object(m.b)("CopySource",Fr);class Mo{constructor(b,k,r){this.qz=b;this.DKg=k;this.uEj=r}G5m(b,k,r){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,
307,rf.SelectionEditor.zf(k));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(Jb.a)(Ap.a,r.kga));const y=r.kga;y.k_b=this.qz.kQh(b);this.xAm(b,y);const R=this.ihm(y);var aa=new sf.GraphTransaction(7,Wa.a.paste);aa.Eb(k.node);k.node.xI().FF.S9(8);R?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",y.Dz,y.browserName),b=this.DKg.create(k,y,aa)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",y.Dz,y.k_b,y.browserName),
Mo.oAm(b),b=this.uEj.create(b,k,y,aa));r=new Rr.a(r,Object(u.a)(b,b.lFi,"pasteSetup"),null);r.ll("Paste");r.run()}ihm(b){return!this.$jm(b)&&3===b.k_b}$jm(b){return 1===(b.Dz&8192?1:0)}rai(b,k){v.ULS.shipAssertTag(6305624,307,rf.SelectionEditor.zf(b));v.ULS.shipAssertTag(6305625,307,!!k);v.ULS.shipAssertTag(6305626,307,Object(Jb.a)(Ap.a,k.kga));const r=new sf.GraphTransaction(7,Wa.a.oNd);r.Eb(b.node);b=this.DKg.create(b,k.kga,r);k=new Rr.a(k,Object(u.a)(b,b.lFi,"pasteSetup"),null);k.ll("InternalPasteAtIp");
k.run()}xAm(b,k){if(b){let r=!1,y=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?y=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||y)&&v.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Fr[k.k_b],r,y)}}static oAm(b){b&&Mo.F0j.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Mo.F0j=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(m.a)(Mo,"PasteCoordinator",null,[]);class My{constructor(b,k,r,y,R){this.fta=b;this.fhb=k;this.W5m=r;this.V5m=y;this.H6b=R}}Object(m.a)(My,"PastedContentsPostProcessorParams",null,[]);class Ny{J5l(b,k,r,y,R,aa){b=this.iul(b,k,R);r=this.Myl(r);if(!b||!r)return null;y=this.GFl(b,y,R);R=this.FFl(r);return new My(b,r,y,R,aa)}iul(b,k,r){b=r?b:k;if(!Ag.OutlineElementReader.Nh(b))return null;k=new Wh.a;k.ed(b);return k}Myl(b){if(!Ag.OutlineElementReader.Nh(b))return null;const k=new Wh.a;k.ed(b);
xg.OutlineElementNavigator.e3(k,!1,!1);return k}GFl(b,k,r){xg.OutlineElementNavigator.Fe(b);let y=-1;ie.ParagraphReader.yh(b)&&(y=r?k:0);xg.OutlineElementNavigator.Xd(b);return y}FFl(b){xg.OutlineElementNavigator.Fe(b);const k=ie.ParagraphReader.yh(b)?ie.ParagraphReader.textLength(b.currentNode):-1;xg.OutlineElementNavigator.Xd(b);return k}}Object(m.a)(Ny,"PastedContentsPostProcessorHelper",null,[]);var zz=c(609),Wt=c(1061),Ru=c(1060);class Tw{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc=null){this.Cna=
b;this.s7=k;this.hu=r;this.BHi=y;this.ta=R;this.I1a=aa;this.K=ta;this.K5m=Ya;this.bba=xb;this.PBb=Mb;this.qsa=cc;this.Cb=jc;this.zfa=Mc;this.myh=100;this.j8b=!1;this.sme=null;this.Zue=!1;this.xid=null;this.Fed=this.PHa=!1;this.i4n()}i4n(){this.s7.Wah(Object(u.a)(this,this.KZn,"showFloatieHandler"));this.s7.Dah(Object(u.a)(this,this.pdl,"floatieDismissedHandler"))}oLk(b,k){var r,y,R;(null===(y=null===(r=this.Cb.ib)||void 0===r?void 0:r.kb)||void 0===y?0:y.VOd)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.I1a.$of(),1===this.K5m.BLk(k.YUc)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",k.correlationId):this.showFloatie(b,k)?(this.PHa?this.PHa=!1:this.iqn(),this.sXc(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Wa.a.sT(k.OQ)||"Unknown",k.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),Ib.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ca.a,{name:"PasteCommand",int64:Wa.a.sT(k.OQ)||"Unknown"}),Object.assign(new ca.a,
{name:"CorrelationId",string:null===(R=k.correlationId)||void 0===R?void 0:R.toString()})]),this.IMb()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",k.correlationId))}tw(b){var k;!this.Zue&&(this.PHa||(this.zfa?null===(k=this.qsa)||void 0===k?0:k.QZ:this.Cna.QZ()))&&(b&&(this.I1a.$of(),this.Ngj(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.xid)),this.PHa=!b,this.Ice(),this.zfa?n.AFrameworkApplication.ya.processAction(Wa.a.jCb,
2):this.Cna.tw())}iqn(){this.Fed||(this.sme=this.hu.yd,Af.a.addHandler(this.sme.container,"scroll",Object(u.a)(this,this.KJb,"scrollHandler")),this.ta.$Y(Object(u.a)(this,this.Jga,"resizeHandler")),this.Fed=!0)}Ngj(){this.Fed&&(Af.a.removeHandler(this.sme.container,"scroll",Object(u.a)(this,this.KJb,"scrollHandler")),this.ta.mba(Object(u.a)(this,this.Jga,"resizeHandler")),this.Fed=!1)}IMb(){if(this.zfa)this.qsa.QZ&&n.AFrameworkApplication.ya.processAction(Wa.a.jCb,2),n.AFrameworkApplication.ya.processAction(Wa.a.J0c,
2),this.j8b=!1;else{const b=new Ru.a(0,n.AFrameworkApplication.isRtl);b.location=this.I1a.RLa();this.I1a.pfm(b.location)?this.showFloatie(null,b):this.s7.YDa(new Wt.a(!1))}}Jga(){this.zfa?(n.AFrameworkApplication.ya.processAction(Wa.a.jCb,2),this.BDc()):this.IMb()}KJb(){this.zfa?(n.AFrameworkApplication.ya.processAction(Wa.a.jCb,2),this.BDc()):this.IMb()}pdl(b,k){this.tw(k.t$k)}KZn(b,k){this.oLk(b,k)}sXc(){this.BHi.g9j(Object(u.a)(this,this.Yzi,"onOnlyKeyPressed"));this.s7.Iah(Object(u.a)(this.Cna,
this.Cna.SBd,"expandFloatie"));this.s7.Sah(Object(u.a)(this,this.nFi,"pastedFloatieStatusChange"));this.bba.Wt(Object(u.a)(this,this.fga,"onParagraphConnect"));this.bba.Zu(Object(u.a)(this,this.ZGb,"onParagraphDisconnected"));this.bba.qp(Object(u.a)(this,this.l3,"onParagraphPropertyChanged"))}Ice(){this.BHi.kun(Object(u.a)(this,this.Yzi,"onOnlyKeyPressed"));this.s7.AQi(Object(u.a)(this.Cna,this.Cna.SBd,"expandFloatie"));this.s7.IQi(Object(u.a)(this,this.nFi,"pastedFloatieStatusChange"));this.bba.oU(Object(u.a)(this,
this.fga,"onParagraphConnect"));this.bba.lba(Object(u.a)(this,this.ZGb,"onParagraphDisconnected"));this.bba.CX(Object(u.a)(this,this.l3,"onParagraphPropertyChanged"))}nFi(b,k){this.Zue=k.PNc;k.OQ&&(this.xid=k.OQ);k.z0f&&this.Cna.QZ()&&this.IMb()}l3(b,k){k.property===Te.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.PBb.d2e.contains(Wa.a.A9f)||this.iQf(k)):v.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")}ZGb(b,
k){this.iQf(k)}fga(b,k){k.vqf||this.iQf(k)}iQf(b){b.node.loading||this.s7.YDa(new Wt.a(!0))}showFloatie(b,k){k||(k=new Ru.a(0,n.AFrameworkApplication.isRtl));k.location||(k.location=this.I1a.RLa());if(!k.location)return!1;this.PHa&&(this.PHa=!1,this.sXc());this.zfa?n.AFrameworkApplication.ya.processAction(Wa.a.J0c,2):this.Cna.showFloatie(b,k);return!0}BDc(){if(!this.j8b){const b=new nd.a(3,1,this.myh,()=>{this.IMb()},215);Mg.a.instance.fc(b);this.j8b=!0}}Yzi(){zz.a.instance.keyCode===tb.a.Qwa&&this.s7.vKi()}}
Object(m.a)(Tw,"PasteFloatieEventManager",null,[]);class Uw{constructor(b,k){this.Yj=b;this.CH=k}BLk(b){return un.any(un.where(un.asEnumerable(Uw.P6n),k=>this.CH.fPc(k)))?(b=this.Yj.ejb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Uw.P6n=[Wa.a.reformatPastedContent.toString(),Wa.a.aPa.toString(),Wa.a.Iva.toString()];Object(m.a)(Uw,"PasteFloatieFeatureSetBuilder",null,[]);class uk{constructor(){this.vva=null;this.Yac=0}}Object(m.a)(uk,"PasteFloatieAnchorData",null,[]);class xi{constructor(b,k,r,
y,R,aa=!1){this.Esb=null;this.hb=b;this.ira=k;this.Zc=r;this.mGj=y;this.ICe=R;this.yve=aa}$of(){this.Esb=null}RLa(){const b=this.Eef(this.Esb)||this.skh();if(!b){let k="null",r="null";if(this.Esb&&this.Esb.vva){if(!this.Zc.yd)return v.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;k=Object.getType(this.Esb.vva).getName();const y=this.Esb.vva.Ii(this.Zc.yd.Sb);y&&(r=Object.getType(y).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",
k,r)}return b}pfm(b){if(!b)return!1;const k=this.ICe.FAb(),r=this.mGj(this.Zc.yd.container);b=new Sys.UI.Bounds(b.x,b.y,k.width,k.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}skh(){if(!this.hb||!this.hb.ib||!this.hb.ib.kb)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.hb.ib.kb.Qa,k=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&k){do r=this.qYh(r);while(r&&Object(Jb.a)(xn.AParagraphNode,r)&&!r.characterData.trim().length)}let y=
"";const R=Object(ia.a)(xn.AParagraphNode,r);R&&(y=R.characterData.length===b.cpBegin||k?R.characterData.trimEnd():R.characterData.substring(0,b.cpBegin).trimEnd());k=R?y.length:b.cpBegin;b=Object.assign(new uk,{vva:Object(ia.a)(57,(R?Object(ia.a)(57,R):Object(ia.a)(57,r))||b.node),Yac:k});return this.Eef(b)}qYh(b){const k=new Wd.GraphIterator;if(!b.anchor)return null;k.set(b);if(!k.rd())return null;k.kd(11);return k.dH()?k.Pb(2):null}Eef(b){if(!b||!b.vva)return null;this.Esb=b;const k=this.Zc.yd;
if(!k)return v.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.xTh(b,k);if(!b)return null;n.AFrameworkApplication.isRtl&&this.ICe.QZ()&&(b.x-=this.ICe.FAb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}xTh(b,k){k=Object(ia.a)(154,b.vva.Ii(k.Sb));if(!k)return null;let r=null;if(Object(Jb.a)(xn.AParagraphNode,b.vva)){const y=Object(ia.a)(53,k);if(!y)return null;try{r=this.ira.eZ(b.Yac,y,0<b.Yac,!1,!1,!1),r.height+=this.yve?xi.fin:
xi.sdl}catch(R){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",R),r=null}}else Object(Jb.a)(cr.TableNode,b.vva)&&(r=Object(ia.a)(182,k).Nif());r||(r=k.getBounds());return r}}xi.sdl=2;xi.fin=60;Object(m.a)(xi,"PasteFloatiePositionProvider",null,[]);class qr{constructor(b,k){this.umc=b;this.mAj=k}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get JLh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get B2e(){return CommonUIStrings.l_ClipboardCut}get rzf(){return CommonUIStrings.l_ClipboardCut_Mac}get y_e(){return CommonUIStrings.l_ClipboardCopy}get qzf(){return CommonUIStrings.l_ClipboardCopy_Mac}get tLf(){return CommonUIStrings.l_ClipboardPaste}get szf(){return CommonUIStrings.l_ClipboardPaste_Mac}get t7(){return CommonUIStrings.l_ClipboardPasteText}get tzf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get MXe(){return this.mAj}get Poh(){return CommonUIStrings.l_ClipboardExtensionLink}get ebb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}mHh(){v.ULS.sendTraceTag(8716421,
307,50,null);Qe.a.Gm(this.MXe,"_blank",void 0,"ClipboardAccessExtensionLink")}nba(b,k){let r=X.a.wl;n.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=X.a.mi||r);return r?String.format(k,"\u2318"):b}dispose(){this.umc=null}wQf(b){this.Bth(b)}jtm(b){this.Bth(b)}Bth(b){this.umc&&this.umc(b)}}qr.id="CopyPasteShortcutDialog";qr.Abj="CopyPasteText";Object(m.a)(qr,"ACopyPasteShortcutDialog",null,[10]);class Px extends qr{constructor(b,k,r){super(b,k);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";k=document.createElement("span");k.id=qr.Abj;var y=document.createElement("span");y.innerText=this.JLh;var R=document.createElement("span");R.className="UIFontBold";R.innerText=this.nba(this.B2e,this.rzf);const aa=document.createElement("span");aa.className="UIFontBold";aa.innerText=this.nba(this.y_e,this.qzf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.nba(this.tLf,this.szf);k.appendChild(y);k.appendChild(document.createElement("br"));
k.appendChild(R);k.appendChild(aa);k.appendChild(ta);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.yp||X.a.gj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.nba(this.t7,this.tzf),k.appendChild(r));b.appendChild(k);this.MXe?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),k=document.createElement("a"),k.href="#",k.innerText=this.Poh,Af.a.addHandler(k,"click",Object(u.a)(this,this.mHh,"extensionLinkHandler")),r.appendChild(k),R=this.ebb.indexOf("{0}"),
-1!==R&&(y=this.ebb.substring(0,R),R=this.ebb.substring(R+3,this.ebb.length),y=document.createTextNode(y),R=document.createTextNode(R),r.insertBefore(y,k),r.appendChild(R)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new cf.StandardDialog;r.Gd=0;r.lg=qr.id;r.Tv(this.titleText,null,0,Object(u.a)(this,this.jtm,"legacyCopyPasteShortcutDialogHandler"),b);r.J3(qr.Abj)}}Object(m.a)(Px,"CopyPasteShortcutDialog",qr,[]);class Qs extends qr{constructor(b,
k){super(b,k);k={};b=this.X8l;k.extensionStartText=this.z7k;k.extensionLink=null;k.extensionEndText=null;k.shortcutsMessageText=this.uUn;k.cutText=this.nba(this.B2e,this.rzf);k.copyText=this.nba(this.y_e,this.qzf);k.pasteText=this.nba(this.tLf,this.szf);4!==n.AFrameworkApplication.ta.Rb.ko&&(k.pasteTextOnly=this.nba(this.t7,this.tzf));k={["id"]:"CopyPasteInstallDialog",["bodyControls"]:k};const r=new yf.a(!1,!1,!0);r.lg="CopyPasteInstallDialog";r.Gd=0;r.We(1,this.W8l);r.wU(1);r.Vh(b,Object(u.a)(this,
this.wQf,"reactCopyPasteShortcutDialogHandler"),k)}get uUn(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get W8l(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get X8l(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get z7k(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static uYn(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(Qs,"ReactCopyPasteInstallDialog",qr,[]);class wv extends qr{constructor(b){super(b,null);this.ami="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var k={};b=this.RNm;var r="";let y="";this.messageText&&(r=this.messageText.split(" {")[0],y=this.messageText.split("} ")[1]);k.startText=r;k.endText=y;k.cutText=this.MRk;k.copyText=this.$Hk;k.pasteText=this.N5m;
k.cutShortcutText=this.nba(this.NRk,this.KFm);k.copyShortcutText=this.nba(this.kIk,this.JFm);k.pasteShortcutText=this.nba(this.Q5m,this.MFm);k.imageSrc=ak.a.b$("NoClipboardAccessDialogImage.svg");k.imageAltText=this.imageAltText;k.primaryButtonLabel=this.jan;this.ami&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),k.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.nhb,["onExecute"]:()=>{this.etm()}});k={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:k};
r=new yf.a(!1,!1,!0);r.Gd=0;r.lg="CopyPasteNoClipboardAccessDialog";r.Vh(b,Object(u.a)(this,this.wQf,"reactCopyPasteShortcutDialogHandler"),k)}get RNm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get nhb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get jan(){return CommonUIStrings.l_DialogOk}get MRk(){return CommonUIStrings.l_CutString}get NRk(){return CommonUIStrings.l_CutShortcut}get KFm(){return CommonUIStrings.l_CutShortcut_Mac}get $Hk(){return CommonUIStrings.l_CopyString}get kIk(){return CommonUIStrings.l_CopyShortcut}get JFm(){return CommonUIStrings.l_CopyShortcut_Mac}get N5m(){return CommonUIStrings.l_PasteString}get Q5m(){return CommonUIStrings.l_PasteShortcut}get MFm(){return CommonUIStrings.l_PasteShortcut_Mac}etm(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Qe.a.Gm(this.ami,"_blank",void 0,"learnMoreLink")}}Object(m.a)(wv,"ReactCopyPasteNoClipboardAccessDialog",qr,[]);class Vw extends qr{constructor(b,k,r){super(b,k);b={};b.forwardElementText=this.JLh;b.cutText=this.nba(this.B2e,this.rzf);b.copyText=this.nba(this.y_e,this.qzf);b.pasteText=this.nba(this.tLf,this.szf);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.yp||X.a.gj)&&(b.pasteTextOnly=this.nba(this.t7,this.tzf));this.MXe?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.Poh,["onExecute"]:y=>{this.mHh(y)}},r=this.ebb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.ebb.substring(0,r),b.suggestionSuffixElement=this.ebb.substring(r+3,this.ebb.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:qr.id,["bodyControls"]:b};b=new yf.a(!1,!1,!0);b.Gd=0;b.lg=qr.id;b.Vh(this.titleText,Object(u.a)(this,this.wQf,"reactCopyPasteShortcutDialogHandler"),r)}}Object(m.a)(Vw,"ReactCopyPasteShortcutDialog",
qr,[]);class th{constructor(){this.vqa=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA}Y_e(b,k,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.vqa,r));this.vqa?r?new Qs(b,k):new Vw(b,k,n.AFrameworkApplication.K):new Px(b,k,n.AFrameworkApplication.K)}static get instance(){return th._instance||(th._instance=new th)}}th._instance=null;Object(m.a)(th,"CopyPasteShortcutDialogFactory",null,[1088]);class Az{constructor(b,k,r,y,
R,aa,ta,Ya){this.u1g=this.sMg=this.NIe=!1;this.qYj=b;this.Zc=k;this.xt=r;this.Ub=y;this.Wd=R;this.eg=aa;this.te=ta;Ya&&(this.u1g=Ya.$("ShouldLogExecCommandCopySuccess"))}get wQa(){return this.qYj}get K_a(){return this.sMg}set K_a(b){this.sMg=b;this.eg.ignoreClipboardEvents=b}BFc(b){this.wQa.BFc(b);b||this.f2c(!0)}get Q4k(){return this.wQa.jVf}prepareForPaste(b){this.K_a=!0;this.wQa.prepareForPaste(b,this.Y4f)}reset(){this.K_a=!1}paste(){var b=null;let k=null;if(!this.wQa.pNb){(b=this.Zc.yd)&&this.Ub.Kg(b.sI);
var r=this.xt.zv;if(!r.ye||!r.editingView.Dj)return null;k=r.editingView;b=this.Wd.vp();this.K_a=!0;r.OFa()}r=null;try{k&&k.Y9m(),r=b=this.wQa.PFc(this.Y4f,b)}catch(y){v.ULS.shipAssertTag(6305672,307,!1),this.Z3h()}this.K_a=!1;return r}copy(){var b=this.Zc.yd;b&&this.Ub.Kg(b.sI);b=this.xt.zv;if(!b.ye||1!==b.editingView.mode)return!1;this.K_a=!0;let k;try{const r=new Map;r.set("View","ContentEditableView");Ga.Health.instance.recordKpiUsage(Qt.a.hud,0,Qt.a.kWe,r);const y=this.wQa.u8e(this.Y4f);k=!0;
this.u1g&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",y,this.te.dF);if(!y){const R=Object.assign(new Xa.a,{extendedProperties:r});Ga.Health.instance.recordKpiFailure(Qt.a.hud,Qt.a.imh,!0,!0,R)}}catch(r){v.ULS.shipAssertTag(6305673,307,X.a.gj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",X.a.dF),k=!1}this.K_a=!1;return k?!0:!1}f2c(){if(this.NIe)return!0;var b=this.xt.zv;if(!b.ye||!b.editingView.Dj)return!1;
const k=b.editingView;b=this.Wd.vp();this.K_a=!0;const r=new Ms.a(b);let y=!1;try{y=this.wQa.f2c(b,()=>{k.bvd()},()=>{k.tEa()})}catch(R){v.ULS.shipAssertTag(6305674,307,!X.a.Ak)}r.restore();this.K_a=!1;y?this.NIe=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",X.a.dF),X.a.Ak||this.Z3h());return y}Z3h(){this.NIe=!1;if(n.AFrameworkApplication.Ato)th.instance.Y_e(null,null);else{const b=new cf.StandardDialog;b.Gd=0;b.yU(CommonUIStrings.l_ClipboardAccessDeniedTitle,
CommonUIStrings.l_ClipboardAccessDenied,null)}}get Y4f(){const b=this.Wd.KLa();return b?b.Hn:null}}Object(m.a)(Az,"SystemClipboard",null,[665]);class Ft{constructor(b,k,r){this.hpd=!1;this.Kpd=this.hS=this.kPg=this.Kke=this.Z7c=null;this.I8m=y=>{1===y?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.yke)),this.AWb&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.AWb)),Qe.a.Gm(this.ore+this.MAe,"_blank",void 0,"ChromeCCPInstallDialog"))):
y||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.yke))};this.yke=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.ore=b.lb("ChromeClipboardAccessExtensionLink");this.j7a=k;this.Yj=r;this.MAe=b.lb("ChromeClipboardAccessExtensionId");this.N_j=b.$("UseGetClipboardDataIsEnabled");this.HYg=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.AWb=!1;b.$("CcpInstallDialogIsEnabled")&&n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&(this.AWb=Qs.uYn()||
b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.AWb));this.unc=null}BFc(b){b?this.hS=!0:(this.hS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.unc=this.j7a.wyd,this.j7a.Xkb?(this.hpd=this.N_j,this.bnh()):(this.hpd=!0,this.bnh(),v.ULS.sendTraceTag(19256732,307,50,G.a.create().toString()))):(this.aLb(),this.hS=!1))}get jVf(){return this.hS}get pNb(){return this.Kpd}f2c(){return!0}u8e(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");
(b=Qe.a.qzb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Ccf(b){if(!b)return null;var k=b.img;const r=b.text;b=b.html;const y=this.Yj.yXi(!!k,!!r,b);let R=null;if(3===y){if(!b)return null;k=this.Yj.vHh(b);(k=this.Yj.CHh(k))&&(b+=k);R=this.Yj.ejb(b)}else 2===y?R=this.Yj.iLf(r,!0):1===y&&(R=this.Yj.ejb(k));return R}PFc(b,k){if(this.pNb)k=this.Ccf(this.Kke),this.Kke=null;else{if(!this.Z7c)return k;
b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Z7c;k=b.body;this.Z7c=null}return k}prepareForPaste(b){const k=G.a.create();this.kPg=k;this.j7a.Xkb?v.ULS.sendTraceTag(7377737,307,50,k.toString()):v.ULS.sendTraceTag(19256735,307,50,k.toString());const r={};r.command=this.pNb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.unc,r,y=>{k.equals(this.kPg)?this.pNb?this.Kke=y:this.Z7c=y:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,k.toString());
chrome.runtime.lastError&&(this.c1k(),this.j7a.Xkb?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}aLb(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.AWb?b=this.ore+this.MAe:this.yke&&(b=this.ore+this.unc);th.instance.Y_e(this.I8m,b,this.AWb)}c1k(){this.j7a.Myn();this.aLb()}IYi(b,k){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},k)}Yuk(){const b=G.a.create();this.j7a.Xkb?v.ULS.sendTraceTag(592491466,
307,50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.unc,{command:"getAvailableCommands"},k=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());k?Object(Jb.a)(Array,k)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",k),this.Kpd=-1!==Array.indexOf(k,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",k),this.Kpd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Kpd=!1)})}bnh(){const b=G.a.create();this.j7a.Xkb?v.ULS.sendTraceTag(7726105,307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.hpd&&this.Yuk();this.IYi(this.unc,k=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());k&&"ping"===k?this.hS=!0:(k?"ping"!==k&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",k,chrome.runtime.lastError?chrome.runtime.lastError.message:null):
v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.aLb(),this.hS=!1);this.hpd&&!this.pNb&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}goi(b,k){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=k;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.HYg&&(b&&Ga.Health.instance.recordKpiSuccess(Ft.VTg,
null),k&&Ga.Health.instance.recordKpiSuccess(Ft.STg,null))}mzm(){this.HYg&&(Ga.Health.instance.recordKpiUsage(Ft.VTg,1,Ft.SEg,null),Ga.Health.instance.recordKpiUsage(Ft.STg,1,Ft.SEg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.j7a.Xkb;this.IYi(this.MAe,k=>{this.goi(b,!!k)})}else this.goi(!1,!1)}}Ft.VTg="OfficeOnlineExtensionInstallationStatus";Ft.STg="OfficeClipboardExtensionInstallationStatus";Ft.SEg="wwccp";Object(m.a)(Ft,"ChromeSystemClipboardAccessManager",null,[697]);class Oy{constructor(b,
k){this.hS=null;this.te=b;this.Oa=k;this.Hyj=!this.Oa.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Oa.$("BlockCopyCutOnFirefoxIsEnabled");this.IVj=k.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}BFc(b){this.Hyj&&b&&this.te.gj?(this.aLb(),this.hS=!1):this.hS=!0}get jVf(){return this.hS}get pNb(){return!1}u8e(b){return Qe.a.qzb(b,"copy")}PFc(b,k){Qe.a.qzb(b,"paste");return k}prepareForPaste(b){b()}f2c(b,k,r){if(this.te.I2)return this.IVj&&(this.hS=!1),!1;k();r();b=this.PFc(b.ownerDocument,
b);k=b.innerHTML;b.innerHTML=Ra.a.create().toString();r();b=this.PFc(b.ownerDocument,b);return this.hS=b=k===b.innerHTML}aLb(){th.instance.Y_e(null,null)}}Object(m.a)(Oy,"DefaultSystemClipboardAccessManager",null,[697]);class ss{constructor(b,k,r){this.hS=this.N8=this.NTb=this.$ia=this.PTa=this.V7c=null;this.Yj=k;this.$Ta=r;this.HNj=b.rc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.nWj=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}BFc(b){this.nWj&&
b&&(this.hS=!0)}get jVf(){return this.hS}get pNb(){return!1}u8e(b){return b?Qe.a.qzb(b,Kb.a.copy):!1}PFc(b,k){this.PTa&&(k=this.PTa,this.PTa=null);return k}prepareForPaste(b,k=null){if(b&&k){this.V7c=b;this.NTb=k;$addHandler(this.NTb,Kb.a.paste,Object(u.a)(this,this.nAi,"onPasteEvent"));this.N8=this.$ia=null;if(this.Efj(this.NTb)){if(this.N8&&0<this.N8.length&&(!this.$ia||this.Yj.Hde(this.$ia))){this.$Ta.Ush(this.N8,Object(u.a)(this,this.yVm,"onImageConverted"));this.PTa&&!this.PTa.hasChildNodes()&&
v.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.$ia&&this.$ia.innerHTML&&((this.PTa=this.D7h(this.$ia.innerHTML))&&!this.PTa.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Fd.a.rA(this.$ia))}this.GJh()}else b&&b()}f2c(b){return this.hS=b=this.Efj(b.ownerDocument)}nAi(b){try{b&&b.rawEvent&&((this.$ia=b.rawEvent.target)&&this.$ia.id&&-1<this.$ia.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.$ia.id),this.$ia=null):this.N8=this.Nwl(b.rawEvent))}catch(k){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+k.toString())}}yVm(b){b&&(this.$Ta.K4i&&(b=String.format('<img src="{0}">',b)),this.PTa=this.D7h(b));this.GJh()}GJh(){this.NTb&&($removeHandler(this.NTb,Kb.a.paste,Object(u.a)(this,this.nAi,"onPasteEvent")),this.NTb=null);this.V7c&&(this.V7c(),this.V7c=null)}Nwl(b){let k=null;(b=this.Yj.lPh(b))&&({Omf:k}=this.Yj.hfj(b,this.HNj,this.$Ta.zri));
return k}Efj(b){return Qe.a.qzb(b,Kb.a.paste)}D7h(b){const k=document.implementation.createHTMLDocument("doc");k.body.innerHTML=b;return k.body}aLb(){}}Object(m.a)(ss,"EdgeSystemClipboardAccessManager",null,[697]);class Bz{constructor(b,k,r,y){this.Oa=b;this.dAj=k;this.Yj=r;this.te=y}create(){let b=null;n.AFrameworkApplication.C0f()&&this.te.yp&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Ft(this.Oa,this.dAj,this.Yj),this.Oa.$("LogChromeExtensionInstallationStatusIsEnabled")&&
b.mzm()):this.Oa.$("EdgeContextMenuPasteFixIsEnabled")&&this.te.Ys?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),b=new ss(this.Oa,Va.a.instance.resolve("Box4.IClipboardDataHelper"),Va.a.instance.resolve("Box4.IProcessImageStrategy"),Va.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new Oy(this.te,this.Oa));return b}}Object(m.a)(Bz,"SystemClipboardAccessManagerFactory",
null,[666]);class Cz{q6k(b){return b}}Object(m.a)(Cz,"DeleteTableSegmentStrategy",null,[661]);var Xt=c(595),pq=c(1002);class Vp{get xp(){return gn.a.fBb}get paragraphEditor(){return null!=this.mqg?this.mqg:this.mqg=Va.a.instance.resolve("Box4.IParagraphEditor")}get p_(){return this.paragraphEditor.xp}get Kc(){return Db.a.instance}get gy(){return null!=this.yqg?this.yqg:this.yqg=Va.a.instance.resolve("Box4.IParagraphIndentationReader")}gzc(b,k,r,y,R,aa,ta){let Ya=2;if(!b.ye)return 2;const xb=b.Cb;
if(!xb)return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.Wfa}),8;if(n.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.ilh(k===Wa.a.XF,r,!0);if(1===y)return b?32:8;b&&(Ya=pq.a.bbc(k,r,y,R,aa,ta))}else Ya=pq.a.bbc(k,r,1,R,aa,ta),1!==y&&32===Ya?(b.Cb.IYd(),b=new sf.GraphTransaction(15),b.Eb(r.view.ld),Ya=this.ilh(k===Wa.a.XF,r,!1)?pq.a.bbc(k,r,y,R,aa,ta):8,b.dispose()):1!==y&&8===Ya&&(b.Cb.IYd(),this.FDk(k,r,xb));return Ya}ilh(b,k,r){k=k.view.Cb;if(!k||!k.ib.kb)return this.Kc.Zb($c.a.vf,
{["Reason"]:bd.a.sGb}),!1;if(k.ib.JI)return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.FZe}),!1;k=Xt.OutlineElementGeneralizer.qla(k.ib,!1);if(!k)return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dCd}),!1;let y=!1;for(let R=0;R<k.length;R++){const aa=k.getContext(R),ta=new Wd.GraphIterator;ta.set(aa.node);rf.SelectionEditor.Pt(ta);if(!Ag.OutlineElementReader.Nh(ta))if(r)continue;else return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.DXa}),!1;if(b?!this.xp.Kwb(ta):!this.xp.YYb(ta))if(r)continue;else return this.Kc.Zb($c.a.A0b,
{["Reason"]:bd.a.dWe}),!1;y=!0}return r?y:!0}FDk(b,k,r){const y=new sf.GraphTransaction(15);try{y.Eb(k.view.ld);k=!0;const R=Xt.OutlineElementGeneralizer.qla(r.ib,!1);for(let aa=0;aa<R.length;aa++){const ta=R.getContext(aa),Ya=new Wd.GraphIterator;Ya.set(ta.node);rf.SelectionEditor.Pt(Ya);if(!Ag.OutlineElementReader.Nh(Ya))k=!1;else if(b===Wa.a.XF?this.xp.Kwb(Ya):this.xp.YYb(Ya))switch(k=!1,b){case Wa.a.XF:this.xp.OOa(Ya,-1,0);break;case Wa.a.FN:this.xp.TDc(Ya,1)}}if(k){const aa=r.ib.kb;for(r=0;r<
aa.length;r++){const ta=aa.J(r);if(ta.Xk){const Ya=this.gy.ceb(ta.node),xb=Ya.Fba;if(b===Wa.a.XF?Ya.HA>xb:Ya.HA<18*xb){const Mb=new Wd.GraphIterator;Mb.set(ta.node);this.p_.iwa(Mb,1,b===Wa.a.XF?Ya.HA>=2.5*xb?Ya.HA-2*xb:xb:Ya.HA<16*xb?Ya.HA+2*xb:18*xb)}}}}}finally{y&&y.dispose()}}}Object(m.a)(Vp,"IndentationActorExtension",null,[660]);var uA=c(739),Qx=c(1205);class rr{constructor(b,k){this.Ho=new Di.DictionaryPropertySet;this.Sqb=!1;this.Dya=this.wob=null;this.Q4=b;this.rGg=k}get Ulb(){return null!=
this.ysg?this.ysg:this.ysg=Va.a.instance.Pa("Box4.ITextFormattingCommands")}get wi(){return null!=this.jlg?this.jlg:this.jlg=Va.a.instance.resolve("Box4.IFormattingEditor")}get oc(){return null!=this.xug?this.xug:this.xug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}z2a(){this.Sqb||(this.Ho.qSf(),this.wob=null,this.qsn())}jIk(b){var k;const r=null!==(k=Kk.FormattingReader.Qr(b))&&void 0!==k?k:Kk.FormattingReader.TFd(b.node,b.cpBegin,-1);!r.cache.MA&&(b=r.hn)&&(k=new Di.DictionaryPropertySet,
k.Bs(b),k.Bs(this.Ho),k.hasProperty(Hk.a.xB)&&(this.wob=r.paragraph.Mc),this.Ho=k)}hasProperty(b){return this.Ho.hasProperty(b)}UKc(){return 0<this.Ho.kI()}get i_a(){return this.Ho}freeze(){this.Sqb=!0}cFa(){this.Sqb=!1}HL(b,k){return this.i_a.ia(b,k)}Wv(b){this.Ho.setValue(Te.a.fontSize,this.wi.RZb(b));this.A_()}fontSize(){return this.Ho.ia(Te.a.fontSize,zj.a.VJ)}R6d(b){this.Ho.setValue(Te.a.font,b);this.rGg&&this.rGg.execute(k=>{null==k?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
k.R6d(this.Ho)});this.Q4&&this.Q4.enabled&&(Od.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.Q4.zMn(this.Ho,b));this.A_()}zec(b){this.Ho.setValue(wc.a.we,b);this.Q4&&this.Q4.enabled&&(Od.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.Q4.TRn(this.Ho,b));this.A_()}Ks(b){b=Ti.a.instance.Zza(bh.a.instance.ib.kb.Qa.node,b);this.Ho.setValue(Te.a.fontColor,b);this.A_()}S5(){this.Ho.setValue(Te.a.fontColor,Uo.a.auto);this.A_()}fontColor(){return this.Ho.ia(Te.a.fontColor,
Uo.a.nil)}ewa(b){this.Ho.setValue(Te.a.highlight,parseInt(b,16));this.A_()}Yud(){this.Ho.setValue(Te.a.highlight,Uo.a.auto);this.A_()}isBold(){return this.Ho.ia(Te.a.bold,!1)}$F(b){this.Ho.setValue(Te.a.bold,b);this.A_()}isItalic(){return this.Ho.ia(Te.a.italic,!1)}setItalic(b){this.Ho.setValue(Te.a.italic,b);this.A_()}isUnderline(){return this.Ho.ia(Te.a.underline,!1)}K3(b){this.Ho.setValue(Te.a.underline,b);this.Ho.setValue(Te.a.underlineType,b?zj.a.BMb:zj.a.YX);this.A_()}underlineType(){return this.Ho.ia(Te.a.underlineType,
zj.a.YX)}cha(b){b<zj.a.BMb||b>zj.a.YX||(this.Ho.setValue(Te.a.underline,b!==zj.a.YX),this.Ho.setValue(Te.a.underlineType,b),this.A_())}isSuperscript(){return this.Ho.ia(Te.a.superscript,!1)}xba(b){this.Ho.setValue(Te.a.superscript,b);b&&this.isSuperscript()&&this.Ho.setValue(Te.a.subscript,!1);this.A_()}isSubscript(){return this.Ho.ia(Te.a.subscript,!1)}soa(b){this.Ho.setValue(Te.a.subscript,b);b&&this.isSubscript()&&this.Ho.setValue(Te.a.superscript,!1);this.A_()}isStrikethrough(){return this.Ho.ia(Te.a.strikethrough,
!1)}Q7(b){this.Ho.setValue(Te.a.strikethrough,b);this.A_()}isDoubleStrikethrough(){return this.Ho.ia(Hk.a.Ds,!1)}gec(b){this.Ho.setValue(Hk.a.Ds,b);this.A_()}SOh(){return this.Ho.ia(Hk.a.xB,null)}Skb(b,k){this.Ho.qSf();this.Ho.setValue(Hk.a.xB,b.id);this.wob=k.Mc;this.A_()}K7(b){let k=Te.a.pE;if(gh.a.instance.J(1)){const r=uA.a.gSd(b);switch(r){case 1:k=wc.a.LEb;break;case 2:k=wc.a.MEb}this.Ho.setValue(wc.a.languageHint,r)}this.Ho.setValue(k,b);this.A_()}language(){let b=Te.a.pE;if(gh.a.instance.J(1))switch(this.Ho.ia(wc.a.languageHint,
0)){case 1:b=wc.a.LEb;break;case 2:b=wc.a.MEb}return this.Ho.ia(b,0)}MOn(b){this.Ho.setValue(wc.a.noProof,b);this.A_()}PDb(){return this.Ho.ia(wc.a.noProof,!1)}Sim(){return this.Ho.hasProperty(wc.a.noProof)}Bhm(){return gh.a.instance.J(1)?this.Ho.hasProperty(Te.a.pE)||this.Ho.hasProperty(wc.a.LEb)||this.Ho.hasProperty(wc.a.MEb):this.Ho.hasProperty(Te.a.pE)}A_(){if(X.a.Xfc){var b=bh.a.instance.ib.kb.Qa,k=b.node;if(k===this.Dya)this.Dya.uk(16,!0);else{this.Dya=k;k=this.Dya.QX();try{this.Dya.w$(b.cpBegin).hua=
!0}finally{k&&k.dispose()}}}}qsn(){if(X.a.Xfc&&this.Dya){var b=0,k=this.Dya.QX();try{for(let r=this.Dya.qa.length-1;0<=r;r--){const y=this.Dya.qa.J(r);y.hua&&(y.hua=!1,b++,y.isEmpty&&this.Dya.qa.removeAt(r))}}finally{k&&k.dispose()}this.Dya=null}}pGk(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.ii(b.cpBegin);return!!b&&b.hua}DRe(b){if(this.Ulb){this.freeze();var k=new sf.GraphTransaction(7);k.Eb(b.node);this.Ulb.T6d(b);this.cFa();this.z2a();k.dispose()}}aif(b){const k=ie.ParagraphReader.text(b.node);
return b.cpBegin&&b.cpBegin!==k.length&&!A.a.gv(k.charCodeAt(b.cpBegin))&&Qx.a.instance.GYa(k,b.cpBegin-1)!==b.cpBegin&&rf.SelectionEditor.Lgb(b)?(b=rf.SelectionEditor.k2(b,!1))?1<b.length||rf.SelectionEditor.Dk(b.Qa)?b:null:null:null}}Object(m.a)(rr,"InsertionPointFormatting",null,[659]);class Su{constructor(b){this.ga=b}get wc(){return this.ga}vpk(b,k,r=null){const y=new Di.DictionaryPropertySet;y.setValue(td.a.Rv,b);y.setValue(td.a.Dua,k);r&&y.Bs(r);y.CommandSource="autobulleting";this.wc.Xb(Wa.a.dA,
2,y)}numbering(b,k,r,y,R){const aa=new Di.DictionaryPropertySet;aa.setValue(td.a.Rv,b);aa.setValue(td.a.Dua,k);aa.setValue(td.a.GNa,r);R&&aa.setValue(Gh.a.uP,R);y&&aa.setValue(wc.a.Vr,y);op.a.aX&&(aa.setValue(Gh.a.Xma,"autocorrect"),R&&aa.setValue(Gh.a.Hfa,R));aa.CommandSource="autonumbering";return 32===this.wc.Xb(Wa.a.wH,2,aa)}}Object(m.a)(Su,"ListCommands",null,[658]);var kl=c(238);class No extends kl.a{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){super();this.fUb=this.Io=this.IGa=null;this.jbn=(jc,
Mc)=>{Mc=this.Nqa.V0d(this.IGa,Mc);jc.ui(this.sgl);return Mc};this.sgl=(jc,Mc)=>{if(this.Io.moveNext())return jc=this.Io.currentNode,12!==jc.type||jc===this.IGa.node?!0:this.Nqa.FVc(jc,Mc);this.Nok();jc.ui(this.tgl);return!0};this.tgl=(jc,Mc)=>{if(this.Io.moveNext()){const fd=this.Io.currentNode;return 12!==fd.type?!0:fd===this.IGa.node?(jc.ui(this.kbn),!0):this.Nqa.FVc(fd,Mc)}return!1};this.kbn=(jc,Mc)=>{this.Nqa.W0d(this.IGa,Mc);return!1};this.init(b);this.ll(cc);this.Bfb(Ya,k,y,R,aa);this.zD=aa;
this._context=r;this.hb=xb;this.He=Mb;this.Nqa=ta;this.wz=0}run(){this.PWe();this.wz||this.FTn();1===this.wz&&this.rcn();2===this.wz&&this.M9n();3===this.wz&&this.Dbl()}PWe(){this.hb.ib&&this.hb.ib.kb?1===this.behavior&&(this.Nqa.PWe(this._context)?this.dr=32:this.dr=2,this.wz=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.dr=2,this.wz=3)}FTn(){this.hok();this.Nqa.s_f(this.IGa)?(this.pnk(),this.wz=1):(this.dr=8,this.wz=3)}rcn(){this.gF||new Rr.a(this,this.jbn,this.zD);
do if(this.gF.run(),this.gF.inProgress&&!this.fh)return;while(this.gF.inProgress);this.Uud();this.wz=2}M9n(){this.Nqa.j5f(this)?this.dr=32:this.dr=8;this.wz=3}Dbl(){this.ooa()}hok(){let b=this.hb.ib.kb;if(b=this.He.Qj(b,!0,!1))this.IGa=b.Qa;this.IGa&&this.IGa.node&&(this.fUb=this.Nqa.HYh(this.IGa.node))}pnk(){if(!this.fUb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Wh.a;b.set(this.IGa.node);b.Ab(this.fUb.type);this.Io=Xj.a.Lr(b,this.fUb);this.Io.Xm(Object(u.a)(this.Nqa,
this.Nqa.yfc,"spellErrorFilter"),null)}Nok(){if(!this.fUb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Wh.a;b.set(this.fUb);this.Io=Xj.a.$p(b);this.Io.Xm(Object(u.a)(this.Nqa,this.Nqa.yfc,"spellErrorFilter"),null)}}Object(m.a)(No,"ProofingWholeDocumentOperation",kl.a,[]);var Rs=c(293);class ts extends bq{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(ts,"ContextMenuRootProperties",bq,[]);var Oq=c(1325);class Ww{constructor(b){const k=new ts;
k.ImageSideArrow=n.AFrameworkApplication.pr;k.ImageSideArrowClass=ci.getImageClass("SubmenuFlyoutArrow_13x13x32");k.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;k.CommandMenuOpen=Wa.a.s0d.toString();this.f4g=new Oq.ContextMenuRoot("ContextMenuRootName",k);b.execute(r=>{this.V_.vE=r});this.V_.refresh();n.AFrameworkApplication.ya.pa(ib.a.showContextMenu,zc.a.frame,Kd.ActionManager.Of);n.AFrameworkApplication.ya.pa(ib.a.Xec,zc.a.frame,Kd.ActionManager.Of)}get V_(){return this.f4g}dispose(){this.V_&&
(this.V_.dispose(),this.f4g=null)}showContextMenu(b,k){this.YKb(b,k.clientPoint,k.ig)}n_b(b,k,r,y,R){this.V_.n_b(b,k,r,y,R)}q3a(b,k,r){Qe.a.$Ud(this.V_.xVa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Ka.App.xa.mfl();this.Nt();this.V_.q3a(b,k,r);this.V_.xVa?n.AFrameworkApplication.ya.processAction(ib.a.Xec,2):n.AFrameworkApplication.ya.processAction(ib.a.showContextMenu,2)}YKb(b,k,r){this.q3a(b,new Sys.UI.Bounds(k.x,k.y,0,0),r)}Nt(){this.V_.root.xl()}g2(){return this.V_.g2()}Xec(b,
k,r,y){const R=this.V_;let aa=!1;r=Object(ia.a)(Eh,r);R.xVa=r;y.kwa(b,k);R.UNe?r&&(r.O8m(R,k),aa=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",y.nRk()),R.xVa=null);return aa}}Object(m.a)(Ww,"AContextMenuController",null,[698,10]);class Ul{}Ul.Dbc="faProofing";Ul.ODh="EditorMenuSection";Object(m.a)(Ul,"ContextMenuControlId",null,[]);var Yt=c(548);class Tu{constructor(b){this.He=b}PWe(b){b=Object(ia.a)(Yt.a,b);return!!b&&!!b.view&&b.view.ye}s_f(){return!0}V0d(){return!0}FVc(){return!0}W0d(){}j5f(){return!0}yfc(b){if(b.qr)return!0;
b=b.role;return 1===b||2===b||3===b||4===b||5===b}HYh(b){if(!b||!this.He)return b;const k=new Wh.a;k.set(b);if(this.He.Pt(k)){for(;!k.qr;)k.mc();return k.currentNode}return b}}Object(m.a)(Tu,"SimpleProofingWholeDocumentCallBacks",null,[512]);class gt{constructor(b){this.value=b}}Object(m.a)(gt,"RefBool",null,[]);class Wo{constructor(){this.IFc=this.pGb=null;this.qgj=new gt(!1)}}Object(m.a)(Wo,"FindNextErrorOperationParam",null,[]);class fw{constructor(){this.Priority=0;this.Context=null;this.Length=
this.StartInContext=this.Start=0;this.Metadata=fw.V2k;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}fw.V2k=[];Object(m.a)(fw,"Critique",null,[]);class Xw{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Xw,
"Suggestion",null,[]);var Li=c(613);class z extends Sys.EventArgs{constructor(b,k,r,y,R,aa){super();this.oHj=b;this.oJj=k;this.pJj=r;this.fhe=y;this.lz=R;this.vnb=aa}}Object(m.a)(z,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var V=c(337);class fa{constructor(b,k,r){this.epe=b;this.Ms=k;this.sa=r}Vsh(b){const [k,r,y]=this.h2h(b);return this.DRh(k,r,y)}Mcm(b){return qm.a.getTypeNameFor(b.content)===V.a.getTypeName()}DRh(b,k,r){if(r&&this.Mcm(r)){n.AFrameworkApplication.Ne("0847a482;1b717180");
if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideSpellingSectionForIgnoredWordsFixEnabled",!1)&&this.Vyc(r.content))return null;const R=r.content;var y=new fw;y.ExplanationTitle=R.explanationTitle;y.Suggestions=this.uMl(r);y.CategoryTitle=R.categoryName;y.TypeId=R.typeId;y.CritiqueActions=R.critiqueActions;y.Priority=R.priority;r=this.epe.create(y);y=R.context;r.token=y.substring(R.range.start,R.range.start+R.range.length);r.lcid=yh.a.qg(R.language).LCID;
r.originalText=y;return new Li.a(b,k,r)}return null}uMl(b){var k=b.content.suggestions;b=[];for(const r of k)k=new Xw,k.Action=r.suggestionActions,k.Text=r.text,k.Description=r.description,b.push(k);return b}Vyc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}h2h(b){const k=this.Ms.LIc(b,0),r=b.cpBegin,y=b.cpEnd,R=rf.SelectionEditor.zf(b);b=ie.ParagraphReader.text(b.node,0);for(const aa of k)if(R){if(aa.begin<=r&&aa.end>=y)return[aa.begin,aa.end,aa.intent]}else if(aa.begin<=
r&&aa.end>=r&&A.a.ksh(b,aa.end,y))return[aa.begin,aa.end,aa.intent];return[null,null,null]}static KA(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}zkf(b,k,r){const [y,R,aa]=this.h2h(b);aa&&this.sa.raiseEvent(fa.dgh,new z(b,y,R,k,aa,r))}E8j(b){this.sa.addHandler(fa.dgh,b)}j9k(b,k,r){b=this.Ms.iUh(b,0,0,b.characterData.length);for(let y=0;y<b.count;y++){const R=b.J(y);if(R.intent){const aa=R.intent;if(aa.content&&
(0==aa.content.priority||1==aa.content.priority)&&R.begin>=k&&(!r||r(R.intent)))return this.DRh(R.begin,R.end,R.intent)}}return null}}fa.dgh="augloopProofingContextMenuActionEventKey";Object(m.a)(fa,"AugLoopProofingErrorDetailHelper",null,[]);class Qa extends Tu{constructor(b,k,r,y){super(k);this.Zm=b;this.Nvc=r;this.jyj=y}V0d(b,k){return!this.Hxf(b.node,b.cpBegin,k)}FVc(b,k){return!this.Hxf(b,0,k)}W0d(b,k){this.Hxf(b.node,0,k);Object(ia.a)(Wo,k)}Hxf(b,k,r){r=Object(ia.a)(Wo,r);if(ie.ParagraphReader.nc(b)&&
!b.HI)if(Kk.FormattingReader.Qr(Re.a.Uc(b,k)).cache.PDb)r.qgj.value=!0;else{if(fa.KA())return k=this.jyj.j9k(b,k,this.Nvc),null!=k?(r.pGb=k,r.IFc=b,!0):!1;const y=this.Zm.q2(b);for(let R=0;R<y.length;R++){const aa=y[R];if(aa.begin>=k&&!aa.errorDetails.F_a()&&(!this.Nvc||this.Nvc(aa.errorDetails)))return r.pGb=aa,r.IFc=b,!0}return!1}}}Object(m.a)(Qa,"FindNextErrorCallbackSteps",Tu,[]);var hb=c(493);class Rb{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye){this.EAk=(ff,Gd,oe,ze,ug)=>{Gd=this.hb.ib.kb;
if(!Gd)return this.nd.Zb($c.a.vf,{["Reason"]:bd.a.noSelection}),2;Gd=this.He.Qj(Gd,!0,!1);return this.ga.Vf(Gd.Qa,ff,oe,!1,ze,ug)};this.s1m=(ff,Gd,oe)=>{if(1===oe)return this.ga.processAction(Wa.a.K7,1);this.iMj().j1f();return 32};this.FAa=(ff,Gd,oe)=>{if(1===oe)return 32;Ee.a.mark(4670);oe=this.Zm.Ala(Gd);if(this.ece(oe))return 8;Gd=Gd.node;const ze=this.Hc.Rc(15);let ug=oe.begin;" "===ie.ParagraphReader.text(Gd).charAt(ug-1)&&ug--;ze.Eb(Gd);const Yf=this.Yd.replaceTextRange(Re.a.createTextRange(Gd,
0<oe.begin?oe.begin-1:0,oe.end),"",!0,!1);this.hb.setSelection(Ke.SelectionFactory.xe(Gd,Yf+ug));ze.dispose();oe.errorDetails.fmb(ff);Ee.a.mark(4671);return 32};this.Lta=(ff,Gd,oe)=>{if(1===oe)return 32;v.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(fa.KA())return this.M5a.zkf(Gd,null,hb.b.IgnoreOnce),32;Ee.a.mark(4670);oe=this.Zm.Ala(Gd);if(this.ece(oe))return 8;Gd=Gd.node;const ze=this.Hc.Rc(15);ze.Eb(Gd);this.Zm.Qjb(Gd,[oe],!0);Gd.setValue(Te.a.BZe,!0);ze.dispose();oe.errorDetails.fmb(ff);
Ee.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.TCm(oe);this.dUa.Y7h(oe,Gd,!0);return 32};this.xIk=(ff,Gd,oe)=>{var ze=!this.Mk.naa(Gd);this.Km&&this.Km.instance&&this.Km.instance.KT(Gd)&&(ze=!1);if(1===oe||!ze)return ze?32:8;this.ga.processAction(Wa.a.uwa,2);Ee.a.mark(4670);ze=this.xpl(ff);if(0>ze)return 8;if(fa.KA())return this.M5a.zkf(Gd,ze,hb.b.Apply),32;oe=this.Zm.Ala(Gd);if(this.ece(oe))return 8;Gd=Gd.node;var ug=oe.errorDetails.suggestions;if(!ug)return this.nd.Zb($c.a.wzb,
{["Reason"]:"NoSuggestionsFound"}),Ee.a.mark(4671),8;ze=ze<ug.length?ug[ze]:null;if(!ze)return this.nd.Zb($c.a.wzb,{["Reason"]:"RequestedSuggestionIsNull"}),Ee.a.mark(4671),8;this.Knb.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(Gd);ze=ze.replace("  "," \u00a0");ug=this.Hc.Rc(15);ug.Eb(Gd);const Yf=this.Yd.replaceTextRange(Re.a.createTextRange(Gd,oe.begin,oe.end),ze,!0,!1,Wa.a.uwa);this.hb.setSelection(Ke.SelectionFactory.xe(Gd,oe.begin+ze.length+Yf));ug.dispose();oe.errorDetails.fmb(ff);Ee.a.mark(4671);this.Qxm(oe);
return 32};this.kHn=(ff,Gd)=>{Gd=this.Zm.Ala(Gd);if(this.ece(Gd))return 8;Gd.errorDetails.fmb(ff);return 32};this.Jal=(ff,Gd,oe,ze,ug)=>{if(!Gd.view.ye)return 2;const Yf=Gd.view;if(!this.hb.ib.kb)return this.nd.Zb($c.a.vf,{["Reason"]:bd.a.noSelection}),2;if(1===oe)return 32;const Aj=new Wo,cn=new Qa(this.Zm,this.He,this.Nvc,this.M5a);Gd=new No(null,ff,Gd,oe,ze,Aj,cn,this.ga,this.hb,this.He,null);Gd.fh=!0;Gd.run();if(Gd.isCompleted&&Aj.pGb){if(Gd=Ke.SelectionFactory.xe(Aj.IFc,Aj.pGb.begin),Gd=Ke.SelectionFactory.KB(Gd,
Re.a.Uc(Aj.IFc,Aj.pGb.end)),!this.aYg.instance||!this.aYg.instance.D$m(Aj.pGb,Gd,Yf)){this.hb.setSelection(Gd);let Vl=0;ug&&(Vl=ug.$w);Yf.v8d=!1;Mg.a.instance.fc(new nd.a(1,1,1,()=>{this.tFn(Yf,Vl,Aj.IFc,Aj.pGb)}))}}else{const Vl=new cf.StandardDialog;Vl.Gd=0;Ka.App.HK.uPc?Vl.fha(CommonUIStrings.l_DefaultDialogTitle,Aj.qgj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Vl.fha(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,
null),Ka.App.HK.Vqd(()=>{Vl.Hma&&(Vl.hide(),this.ga.processAction(ff,2))}))}return 32};this.s0d=(ff,Gd,oe)=>{if(1===oe)return 32;this.oca&&this.oca.V_&&(ff=this.oca.V_.Djf(Ul.Dbc))&&!ff.tK&&(ff.UZ(0),ff.menu.ZJ(0));return 32};this.ga=k;this.Zm=b;this.iMj=r;this.Yd=y;this.Hc=R;this.hb=aa;this.Km=ta;this.He=Ya;this.pVj=xb;this.Mk=Mb;this.nd=cc;this.M5a=ye;this.oca=Object(ia.a)(Ww,jc);this.XRb=Mc.UOc;this.aYg=fd;this.Knb=Td;this.dUa=ne;this.n6c=new Na.a;this.n6c.Z(1,Wa.a.w2f);this.n6c.Z(2,Wa.a.ekf);
this.n6c.Z(3,Wa.a.y3f);this.Ujd=new Na.a;this.Ujd.Z(1,Wa.a.x2f);this.Ujd.Z(2,Wa.a.fkf);this.Ujd.Z(3,Wa.a.z3f)}Vb(){const b=this.ga,k=this.xIk,r=this.EAk;b.gb(Wa.a.tZd,lc.a.view,this.s1m,1028);b.pa(Wa.a.FAa,lc.a.Wc,this.FAa);b.pa(Wa.a.Lta,lc.a.Wc,this.Lta);b.pa(Wa.a.Olb,lc.a.Wc,k);b.pa(Wa.a.Plb,lc.a.Wc,k);b.pa(Wa.a.Qlb,lc.a.Wc,k);b.pa(Wa.a.QLb,lc.a.Wc,k);b.pa(Wa.a.RLb,lc.a.Wc,k);b.pa(Wa.a.FAa,lc.a.view,r);b.pa(Wa.a.Lta,lc.a.view,r);b.pa(Wa.a.Olb,lc.a.view,r);b.pa(Wa.a.Plb,lc.a.view,r);b.pa(Wa.a.Qlb,
lc.a.view,r);b.pa(Wa.a.QLb,lc.a.view,r);b.pa(Wa.a.RLb,lc.a.view,r);b.Vc(Wa.a.FAa,1028);b.Vc(Wa.a.Lta,1028);b.Vc(Wa.a.Olb,1028);b.Vc(Wa.a.Plb,1028);b.Vc(Wa.a.Qlb,1028);b.Vc(Wa.a.QLb,1028);b.Vc(Wa.a.RLb,1028);b.pa(Wa.a.uwa,zc.a.frame,Kd.ActionManager.Of);this.XRb&&b.gb(Wa.a.s0d,lc.a.view,this.s0d,1124);b.gb(Wa.a.JSc,lc.a.view,this.Jal,1028);b.gb(Wa.a.EOf,lc.a.Hd,this.kHn,1124);this.yon([Wa.a.U9d,Wa.a.w2f,Wa.a.x2f,Wa.a.qJd,Wa.a.ekf,Wa.a.fkf,Wa.a.B$d,Wa.a.y3f,Wa.a.z3f,Wa.a.cJi,Wa.a.cui,Wa.a.q8i])}yon(b){for(let k=
0;k<b.length;k++)this.ga.gb(b[k],lc.a.view,Kd.ActionManager.uZ,1028)}Kpn(b){this.Nvc=b}ece(b){return b?b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.nd.Zb($c.a.wzb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Ee.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.nd.Zb($c.a.wzb,{["Reason"]:"RequestedErrorRangeNotFound"}),Ee.a.mark(4671),!0)}TCm(b){let k;({value:k}=this.Ujd.Bc(b.errorDetails.proofingType,
0)).returnValue&&(this.ga.processAction(k,2),v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",k,b.errorDetails.proofingType))}xpl(b){switch(b){case Wa.a.Olb:return 0;case Wa.a.Plb:return 1;case Wa.a.Qlb:return 2;case Wa.a.QLb:return 3;case Wa.a.RLb:return 4;default:return-1}}Qxm(b){let k;({value:k}=this.n6c.Bc(b.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(k,2),v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
k,b.errorDetails.proofingType))}tFn(b,k,r,y){b.qba();(b=r.Be(b.Sb))?(y=Rs.a.tq(b,n.AFrameworkApplication.isRtl?y.begin:y.end),this.pVj.kwa(new Sys.UI.Point(y.x,y.y+y.height),k)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(Rb,"ProofingActor",null,[]);var oc=c(338),Qc=c(1504);class hd{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.Pfc=null;this.ydl="StyleUsageActivity";this.zdl="StylesFloodgateSurveyIsEnabled";this.RJa=(cc,jc,Mc,fd)=>{cc=this.XLl(cc);return 0>
cc||cc>this.Pfc.length?2:(cc=this.Pfc[cc])?n.AFrameworkApplication.ya.Vf(jc,Wa.a.applyStyle,Mc,!0,fd,cc):2};this.MHb=(cc,jc,Mc,fd,Td)=>{cc=!0;jc.contextId!==lc.a.paragraph&&jc.contextId!==lc.a.Hd&&jc.contextId!==lc.a.Wc&&(cc=!1);if(1===Mc||!cc)return cc?32:8;if(2===Mc&&!Td)return 8;jc=this.oc.Sx(jc.node);Mc=gh.a.instance.J(8);Td.MenuItems=oc.a.uBl(jc,Mc);return 32};this.wfn=(cc,jc,Mc,fd,Td)=>{cc=!0;jc.contextId!==lc.a.paragraph&&(cc=!1);if(1===Mc&&!cc)return 8;jc=jc.node;Mc=this.oc.Ao(jc);if(!Mc||
!Td)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Td,jc,Mc),8;Td.sQa.Bs(Mc.ai());return 32};this.yfk=(cc,jc,Mc,fd,Td)=>{if(jc.contextId!==lc.a.paragraph)return 8;if(this.ag.R_a(jc,!1))return this.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),8;if(1===Mc)return 32;Mc=jc.node;if(ie.ParagraphReader.tka(Mc)||!Td)return 8;const ne=this.yif(Td,Mc);if(!ne)return this.Kc.Zb($c.a.a0,{["Reason"]:bd.a.xzb}),8;if(2!==this.oc.Xw(ne))return 2;cc=new sf.GraphTransaction(15);
this.Hj&&this.Hj.isProgressiveStyleEnabled&&this.uF.hfc(Td);cc.Eb(Mc);this.Uj.z2a();this.a8.pM(ne,Mc,!1);const ye=this.oc.Sx(Mc);ye&&this.oc.oe(ne,ye)&&Od.b(593078098,3017,50,"Custom linked style applied by user");Mc.Ur&&(Mc=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Ib.a("TOCFormatting",!0,void 0,Mc));cc.dispose();Td=A.a.cW(Td);fd.Mr=Td>>>16^Td&65535;fd&&Qc.a.Slb&&(fd.BB|=Qc.a.Odb(jc.node));return 32};this.xfn=(cc,jc,Mc,fd,Td)=>{cc=!0;jc.contextId!==lc.a.Hd&&(cc=!1);if(1===Mc&&
!cc)return 2;jc=Kk.FormattingReader.Qr(jc);jc=Kk.FormattingReader.Eta(jc);if(!jc)return 2;if(!Td)return 8;Td.sQa.Bs(jc.ai());return 32};this.zfk=(cc,jc,Mc,fd,Td)=>{if(jc.contextId!==lc.a.Hd||!gh.a.instance.J(8))return 8;this.ag.R_a(jc);if(1===Mc)return 32;cc=jc.node;if(!Td)return 8;const ne=this.yif(Td,jc.node);if(!ne)return this.Kc.Zb($c.a.a0,{["Reason"]:bd.a.xzb}),8;if(1!==this.oc.Xw(ne))return 2;Mc=this.oc.Sx(cc);if(!Mc)return this.Kc.Zb($c.a.a0,{["Reason"]:bd.a.JHh}),8;if(!Mc.wh(this.oc.rf(ne)))return this.Kc.Zb($c.a.a0,
{["Reason"]:bd.a.xzb}),8;const ye=new sf.GraphTransaction(7);try{if(this.Hj&&this.Hj.isProgressiveStyleEnabled&&this.uF.hfc(Td),ye.Eb(cc),this.a8.N9f(cc,Mc),this.Z3a.I1(jc,ff=>{this.wi.hka(ff);this.wi.Skb(ff,ne)}),cc.Ur){const ff=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})];Ib.a("TOCFormatting",!0,void 0,ff)}}finally{ye&&ye.dispose()}Mc&&this.oc.oe(ne,Mc)&&Od.b(593078097,3017,50,"Custom linked style applied by user");Td=A.a.cW(Td);fd.Mr=Td>>>16^Td&65535;fd&&Qc.a.Slb&&(fd.BB|=Qc.a.Odb(jc.node));
return 32};this.vfn=(cc,jc,Mc,fd,Td)=>{cc=!0;jc.contextId!==lc.a.Wc&&(cc=!1);if(1===Mc&&!cc)return 2;jc=this.a8.bMl(jc);if(!jc)return 2;if(!Td)return 8;Td.sQa.Bs(jc.ai());return 32};this.xfk=(cc,jc,Mc,fd,Td)=>{if(jc.contextId!==lc.a.Wc||!gh.a.instance.J(8))return 8;if(this.ag.R_a(jc,!1))return this.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),8;if(1===Mc)return 32;var ne=jc.node;if(!Td)return 8;Mc=this.yif(Td,jc.node);if(!Mc)return this.Kc.Zb($c.a.a0,{["Reason"]:bd.a.xzb}),8;const ye=this.oc.Xw(Mc);if(1!==
ye&&2!==ye)return 2;(jc=this.Uj.aif(jc))?(jc=bh.a.Rxb(jc),cc=n.AFrameworkApplication.ya.Vf(jc,cc,2,!1,fd,Td)):(cc=new sf.GraphTransaction(7),this.Hj&&this.Hj.isProgressiveStyleEnabled&&this.uF.hfc(Td),cc.Eb(ne),this.a8.sRn(Mc,ne),cc.dispose(),cc=32);ne.Ur&&(jc=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Ib.a("TOCFormatting",!0,void 0,jc));(ne=this.oc.Sx(ne))&&this.oc.oe(Mc,ne)&&Od.b(593078096,3017,50,"Custom linked style applied by user");Td=A.a.cW(Td);fd.Mr=Td>>>16^Td&65535;return cc};
this.yfn=(cc,jc,Mc,fd,Td)=>{if(gh.a.instance.J(8)){const ne=this.I4c.Fna(cc,jc,Mc,fd,Td,null,0);if(2!==ne)return ne}return this.I4c.Fna(cc,jc,Mc,fd,Td,null,12)};this.Afk=(cc,jc,Mc,fd,Td)=>{const ne={};ne[this.I4c.RFa]=6168;ne[this.I4c.QFa]=6169;let ye=12;if(gh.a.instance.J(8)){if(!jc.view.ye)return 2;var ff=jc.view.Cb,Gd=ff?ff.Jg:null;if(!Gd)return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.noSelection}),8;if(this.Sg.jAa(Pd.ImageReader.k_a,Gd))return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.cCc}),8;if(this.Sg.Swa(ie.ParagraphReader.HT,
Gd))return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),8;if(this.ag.t6b(Gd,!1))return this.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dE}),8;Gd=this.oc.Np();if(Td&&Gd){const oe=Gd.wh(Td);if(oe){const ze=this.oc.u2(oe,Gd);let ug=this.oc.Xw(oe);ze&&(ff=ff.ib.J(0),ff.MC&&ff.Qa.contextId===lc.a.Hd||2===ff.length&&ff.Qa.contextId===lc.a.Hd&&ff.Tc.contextId===lc.a.endOfParagraph)&&(ug=1,Td=ze.getValue(Hk.a.ja));1===ug?ye=0:3===ug&&(ye=14);!this.oc.oe(oe,Gd)&&this.oc.Bd(oe)&&(ff=this.oc.rf(oe),Od.b(562317522,3017,50,String.format("{0}: style applied by user",
ff)));this.oFa(this.ydl,this.zdl)}}}return this.I4c.Fna(cc,jc,Mc,fd,Td,ne,ye)};this.nS=k;this.ng=r;this.MM=y;this.Jw=R;this.Mk=aa;this.nd=ta;this.HV=Ya;this.q0j=xb;this.Ce=Mb}get Hj(){return null!=this.Vrg?this.Vrg:this.Vrg=Va.a.instance.Pa("Box4.Styles.StyleSettings")}get a8(){return this.nS}get Sg(){return this.MM}get Uj(){return this.Jw}get wi(){return this.ng}get ag(){return this.Mk}get Kc(){return this.nd}get Z3a(){return this.HV}get I4c(){return this.q0j}get oc(){return this.Ce}Vb(){const b=
n.AFrameworkApplication.ya,k=Ka.App.a4a.Iuh(12);gh.a.instance.J(8)&&(b.pa(Wa.a.applyStyle,lc.a.Hd,this.zfk),b.pa(Wa.a.XDa,lc.a.Hd,this.xfn),b.pa(Wa.a.applyStyle,lc.a.Wc,this.xfk),b.pa(Wa.a.XDa,lc.a.Wc,this.vfn));b.pa(Wa.a.applyStyle,lc.a.paragraph,this.yfk);b.pa(Wa.a.applyStyle,lc.a.view,this.Afk);b.Vc(Wa.a.applyStyle,1036);b.pa(Wa.a.XDa,lc.a.view,this.yfn);b.pa(Wa.a.XDa,lc.a.paragraph,this.wfn);b.Vc(Wa.a.XDa,99);b.pa(Wa.a.MHb,lc.a.view,k);b.pa(Wa.a.MHb,lc.a.paragraph,this.MHb);b.Vc(Wa.a.MHb,1127);
b.gb(Wa.a.NRe,lc.a.view,this.RJa,4);b.gb(Wa.a.ORe,lc.a.view,this.RJa,4);b.gb(Wa.a.PRe,lc.a.view,this.RJa,4);b.gb(Wa.a.QRe,lc.a.view,this.RJa,4);b.gb(Wa.a.RRe,lc.a.view,this.RJa,4);b.gb(Wa.a.SRe,lc.a.view,this.RJa,4);b.gb(Wa.a.TRe,lc.a.view,this.RJa,4);b.gb(Wa.a.Beh,lc.a.view,this.RJa,4);b.gb(Wa.a.Ceh,lc.a.view,this.RJa,4);b.gb(Wa.a.Deh,lc.a.view,this.RJa,4);this.Pfc=Array(10);rj.StyleReader.I7d(this.Pfc)}XLl(b){switch(b){case Wa.a.NRe:return 0;case Wa.a.ORe:return 1;case Wa.a.PRe:return 2;case Wa.a.QRe:return 3;
case Wa.a.RRe:return 4;case Wa.a.SRe:return 5;case Wa.a.TRe:return 6;case Wa.a.Beh:return 7;case Wa.a.Ceh:return 8;case Wa.a.Deh:return 9;default:return-1}}oFa(b,k){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const r=Va.a.instance.$a("Common.ISystemInitiatedFeedback");r&&r.execute(y=>{y.logActivity(b,k)})},hd.Nka)}yif(b,k){if(b&&k&&ie.ParagraphReader.nc(k))k=this.oc.Sx(k);else return null;return k.wh(b)}get uF(){return null!=this.Wkg?this.Wkg:this.Wkg=Va.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
hd.Nka=5E3;Object(m.a)(hd,"StyleActor",null,[]);var he=c(1829);class ae{constructor(b){this.ga=b}get wc(){return this.ga}T6d(b,k=!1){this.wc.Vf(b,Wa.a.i_a,2,!0,null,k)}K7(b){this.wc.Xb(Wa.a.K7,2,b)}}Object(m.a)(ae,"TextFormattingCommands",null,[656]);class Ve{constructor(b,k,r,y){this.cLe=this.N4g=!1;this.hco=(R,aa,ta)=>{if(2!==ta)return 2;this.N4g||(this.N4g=!0);n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.wbn=(R,aa,ta,Ya,xb)=>{if(2!==ta)return 2;this.xIi(xb,!0);return 32};this.vbn=(R,aa,ta,Ya,xb)=>{if(2!==ta)return 2;this.xIi(xb,!1);return 32};this.scn=(R,aa,ta)=>{if(2!==ta)return 2;if(!this.F7a)return 8;this.F7a.RZl();return 32};this.rbn=(R,aa,ta)=>{if(2!==ta)return 2;if(!this.F7a)return 8;this.F7a.wAn();return 32};this.ona=(R,aa)=>{3===aa.$w&&rf.SelectionEditor.Dm(aa.kl.kb)&&(Ib.c(Wa.a.cco),n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.cLe=!0)};this.ga=b;this.Oa=k;this.F7a=r;this.hb=y}get gco(){return this.cLe}Vb(){this.ga.gb(ib.a.DO,lc.a.view,this.hco,4);this.ga&&this.Oa&&(this.Oa.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.gb(Wa.a.S6f,lc.a.view,this.wbn,4),this.ga.gb(Wa.a.U6f,lc.a.view,this.vbn,4)),this.Oa.$("HideGrippersWhenPinchingIsEnabled")&&(this.ga.gb(ib.a.r9i,lc.a.application,this.scn,4),this.ga.gb(ib.a.k7e,lc.a.application,this.rbn,4)),Ym.EventHandlerManager.instance.Qon(()=>{this.Q_m()}));Ka.App.xa.jb.Fc&&
Ka.App.xa.jb.Fc.ye&&Ka.App.xa.jb.Fc.Lja(()=>{this.wFn()});this.hb&&this.hb.tB(this.ona)}Mhn(){Ib.c(Wa.a.fco);this.cLe=!0}wFn(){const b=window.performance.now();Ve.Lxe&&250>b-Ve.Lxe&&1E3<b-Ve.wPg&&(Ib.c(Wa.a.eco),Ve.wPg=b);this.F7a&&Ve.Wb&&Ve.Wb.Wx(124)&&this.F7a.showFloatie()}G$l(b,k){if(k){var r=null;X.a.iJ&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.F7a&&this.F7a.Dlo(b.getBoundingClientRect(),k)}}Q_m(){Ve.Lxe=window.performance.now()}xIi(b,k){if(b)for(b=b.firstChild;b;){if("SPAN"===
b.tagName&&b.classList.contains(Ve.R1l)){for(b=b.firstChild;b;)this.zak(b,k),b=b.nextSibling;break}b=b.nextSibling}}zak(b,k){if(b.classList.contains(Ve.j8h)){const r="WACImageResizeHandleTouch"+this.Gvl(b);k?b.classList.add(Ve.k8h,r):b.classList.remove(Ve.k8h,r)}}Gvl(b){for(const k of b.className.split(" "))if(k.startsWith("WACImageResizeHandle")&&k!==Ve.j8h)return A.a.substring(k,20,k.length);return""}static get Wb(){return null!=Ve.Wjg?Ve.Wjg:Ve.Wjg=Va.a.instance.Pa("Box4.IFeatureHelper")}}Ve.j8h=
"WACImageResizeHandles";Ve.k8h="WACImageResizeHandlesTouch";Ve.R1l="WACImgSelection";Ve.Lxe=0;Ve.wPg=0;Object(m.a)(Ve,"TouchInputActor",null,[655]);class sg{get RFa(){return pq.a.RFa}get QFa(){return pq.a.QFa}get kic(){return pq.a.kic}Fna(b,k,r,y,R,aa,ta){return pq.a.Fna(b,k,r,y,R,aa,ta)}bbc(b,k,r,y,R,aa){return pq.a.bbc(b,k,r,y,R,aa)}static get instance(){sg._instance||(sg._instance=new sg);return sg._instance}}sg._instance=null;Object(m.a)(sg,"ViewActionHandlerProxy",null,[654]);class Ih{constructor(b,
k){this.kpiName="VisiMarkersUsage";this.l6="wwaengidc";this.UT=new Map;this.F0n=(r,y,R,aa,ta)=>{if(1===R)return 32;if(!ta)return 2;this.UT.set("Source",mm.a[this.ga.F6]);this.GMe.ZPc?this.UT.set("Action","Removed"):this.UT.set("Action","Applied");Ga.Health.instance.recordKpiUsage(this.kpiName,1,this.l6,this.UT);r=document.getElementsByTagName("head")[0];if(!this.GMe.ybo(r))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Ka.App.xa.nG({ShowVisiMarkers:"ToggleButtonModel"});
return 32};this.Sen=(r,y,R,aa,ta)=>{if(1===R)return 32;ta[Ig.a.On]=this.GMe.ZPc;return 32};this.ga=b;this.GMe=k}Vb(){this.ga.gb(Wa.a.u9d,lc.a.application,this.F0n,1);this.ga.gb(Wa.a.VJi,lc.a.application,this.Sen,96)}}Object(m.a)(Ih,"VisiMarkersActor",null,[]);class Ej{zc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",()=>new Dh(gn.a.fBb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new aq(n.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new tv.ClipboardActor(b.Ze("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),Db.a.instance,b.resolve("Box4.IClipboardDataHelper"),bh.a.instance,n.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),n.AFrameworkApplication.K,Id.FocusManager.instance(),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),n.AFrameworkApplication.F0f(),n.AFrameworkApplication.B5i(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Va.a.instance.resolve("Common.IReactContextualUILauncher"),!!Ka.App.instance&&Ka.App.instance.zfa)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Ow(n.AFrameworkApplication.K)).singleInstance();
b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new Bz(n.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),nr.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();b.ha("Box4.Actors.ISystemClipboard",()=>new Az(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Bb.InteractiveViewManager.instance,
Ka.App.xa.jb,Id.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),nr.a.instance,n.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Cz).singleInstance();b.ha("Box4.ISelectionFactory",()=>new et.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>new sv).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new qs).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",
()=>new wh(bh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"),gh.a.instance.J(10))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Ny).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new xi(bh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Bb.InteractiveViewManager.instance,Qe.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Ka.App.instance&&Ka.App.instance.zfa)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",
()=>new Uw(b.resolve("Box4.IClipboardDataHelper"),Ka.App.Ev.eI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new Tw(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Bb.InteractiveViewManager.instance,Lu.a.instance(),n.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ka.App.ik.ml.Ve(12),b.resolve("Box4.Graph.IGraphTransactionManager"),
b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Ka.App.instance&&Ka.App.instance.zfa)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new $i(Db.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),$v.a.instance,bh.a.instance,n.AFrameworkApplication.ya,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ze("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new Lw(n.AFrameworkApplication.ya,Db.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),bh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),or.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),
b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Pa("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new nq(Db.a.instance,nr.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),n.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",
()=>new uv(n.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new Nw(b.resolve("Box4.Actors.InternalClipboard"),n.AFrameworkApplication.ya,n.AFrameworkApplication.C0f(),Db.a.instance,or.a.instance,nr.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),
b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Jy(b.Ze("Box4.Actors.IBox4PasteStewardFactory"),b.Ze("Box4.Actors.IBox4ImageStewardFactory"),
b.Ze("Box4.Actors.IBox4TableStewardFactory"),b.Ze("Box4.Actors.IBox4WordConverterFactory"),b.Ze("HtmlImport.IHtmlTranslatorSettings"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new Ps.a(b.resolve("Box4.Images.IImageEditor"),
b.Ze("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Ka.App.ik,b.resolve("Box4.IParagraphIndentationReader"),n.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").NYi,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Ly(b.resolve("Box4.Actors.InternalClipboard"),b.Pa("Box4.IContentControlCopyPasteHelper"),new cg.a(()=>Ka.App.xa.jb.Fc),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new Su(n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.PasteCoordinator",()=>new Mo(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();
b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new wr(b.resolve("Box4.Images.IImageEditor"),n.AFrameworkApplication.uc,b.resolve("Box4.IUndoManager"),b.Pa("Box4.Actors.IImageStewardBridge"),Ka.App.xa.notificationBar,b.Pa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("WordEditorPastePictureFailedImprovementIsEnabled"),b.resolve("Common.IAppSettingsManager").$("NotificationBarImageErrorIsEnabled"),b.resolve("Common.IAppSettingsManager").$("ImageAccessibilityAltTextOnlyIsEnabled"),
b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();b.ha("Box4.Actors.Box4TableStewardFactory",()=>new dt(Va.a.instance.resolve("Box4.List.IListEditor"),Va.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();
b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new At(Db.a.instance,bh.a.instance,Ka.App.vd,mh.a.instance,gh.a.instance.J(4))).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",()=>new aw(n.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Nu(n.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new yz).singleInstance();b.ha("Box4.ISelectionCommands",()=>
new mq(n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new ae(n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new Yv(b.$a("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new rr(b.Pa("Box4.IFontSlotProvider"),b.$a("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();
b.ha("Box4.UI.PasteFloatieManager",()=>new Am).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Rb(Va.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),n.AFrameworkApplication.ya,()=>Va.a.instance.resolve("Box4.UI.ILanguageDialog"),Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Va.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),bh.a.instance,Va.a.instance.$a("Box4.IExternalSelectionManager"),or.a.instance,Va.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
mh.a.instance,Db.a.instance,Va.a.instance.resolve("Box4.IContextMenuController"),Va.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Va.a.instance.$a("Box4.Actors.IProofingErrorPresenter"),gh.a.instance,Va.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Va.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new hd(Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Va.a.instance.resolve("Box4.Styles.IWACStyleEditor"),
Va.a.instance.resolve("Box4.IFormattingEditor"),tm.ContextSetEditor.instance,Va.a.instance.resolve("Box4.IInsertionPointFormatting"),mh.a.instance,Db.a.instance,Va.a.instance.resolve("Box4.TextFormattingHelper"),sg.instance,Va.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new zt(Va.a.instance.resolve("Box4.IUpdateStyleManager"),Va.a.instance.resolve("Box4.Styles.IWACStyleReader"),n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",
()=>new he.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Pa("Box4.IFontSlotProvider"),b.Pa("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",()=>new nu(n.AFrameworkApplication.ya,Db.a.instance,()=>Va.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new Ve(n.AFrameworkApplication.ya,n.AFrameworkApplication.K,pu.GrippersManager.instance,
bh.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(bs,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new Ih(n.AFrameworkApplication.ya,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();b.ha("Box4.Actors.IndentationActorExtension",()=>new Vp).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}Object(m.a)(Ej,"Box4ActorsComponentConfiguration",null,[2]);var cj=c(227),jn=c(1062);const rp=
()=>{const b=vr;n.AFrameworkApplication.ya.pa(Wa.a.V5e,lc.a.embeddedFile,b);n.AFrameworkApplication.ya.pa(Wa.a.V5e,lc.a.T1b,b);n.AFrameworkApplication.ya.pa(Wa.a.U5e,lc.a.embeddedFile,us);n.AFrameworkApplication.ya.pa(Wa.a.U5e,lc.a.T1b,us)},vr=(b,k,r)=>Ka.App.Fzd?8:2===r?(b=new cf.StandardDialog,b.Gd=4,b.wU(1),b.We(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.We(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.u1f(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,
sl),32):2,sl=b=>{1===b&&n.AFrameworkApplication.ya.processAction(Wa.a.U5e,2)},us=(b,k,r)=>{if(Ka.App.Fzd)return 8;if(1===r)return k.node.hasProperty(Te.a.embeddedFileContainer)?32:2;if(2===r&&(k.contextId===lc.a.view&&k.view.Cb&&(k=k.view.Cb.Jg),cj.isEmbeddedFileOrFloatingEmbeddedFileContext(k))){b=jn.a.ztl(k.node);Ea.a.ESn();try{ht(b)}catch(y){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",y)}}return 32},ht=b=>{Qe.a.Gm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var ru=
c(772),Uu=c(506),Vu=c(1190),Wu=c(1206);class Gr{constructor(b){this.iya=this.VU=null;this.jga=(k,r,y,R,aa)=>{if(1===y)return 32;n.AFrameworkApplication.ya.Xb(Wa.a.a2a,2,aa);k=aa&&0<=aa.fontColor&&16777215>=aa.fontColor?aa.fontColor:0;Ka.App.xa.tw();(new Vu.a(Gr.Jph,Wa.a.Yga)).D0c(k);return 32};this.LHb=(k,r,y,R,aa)=>{if(1===y)return 32;if(2===y&&!aa)return 8;k=Gr.Ue.nHd(r);r=new ru.a;y=null;32===n.AFrameworkApplication.ya.Xb(Wa.a.a2a,2,r)&&r&&(y=r.fontColor);R="";y&&!r.X1b&&(R=Uo.a.PC(y)||"");this.SKh.Jdc=
R;this.ZOc&&this.recentColors.K9f(R);k=this.SKh.fEd(k,Ka.App.FZb);if(!k)return 8;aa.MenuItems=k;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.pze=b}get SKh(){this.VU||(this.VU=new Wu.a(Gr.Jph),this.VZa(this.VU));return this.VU}VZa(b){b.uda(1,Wa.a.S5);b.uda(3,Wa.a.Ks);b.uda(4,Wa.a.Ks);b.uda(5,Wa.a.Yga);b.uda(6,Wa.a.jga);b.tXb(this.pze,1)}Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.jga,lc.a.view,this.jga);b.pa(Wa.a.LHb,lc.a.view,this.LHb);b.Vc(Wa.a.LHb,
1127)}static yul(){return new Gr(Uu.a.instance)}static get instance(){return null!=Gr.Smg?Gr.Smg:Gr.Smg=Gr.yul()}get recentColors(){return null!=this.Sqg?this.Sqg:this.Sqg=Va.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}static get Ue(){return De.PageReader.instance}get ZOc(){null==this.iya&&(n.AFrameworkApplication.Ne("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.iya=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",
!1):!1);return this.iya}}Gr.Jph="Font";Object(m.a)(Gr,"FontColorActor",null,[]);class it{constructor(b){this.jga=(k,r,y,R,aa)=>{if(1===y)return 32;n.AFrameworkApplication.ya.Xb(Wa.a.a2a,2,aa);k=aa&&0<=aa.highlight&&16777215>=aa.highlight?aa.highlight:0;Ka.App.xa.tw();(new Vu.a("Highlighter",Wa.a.J7)).D0c(k);return 32};this.ga=b}Vb(){this.ga.pa(Wa.a.RCi,lc.a.view,this.jga)}static nwl(){return new it(n.AFrameworkApplication.ya)}static get instance(){return null!=it.Cng?it.Cng:it.Cng=it.nwl()}}Object(m.a)(it,
"HighlighterColorActor",null,[]);var Bo=c(299),gw;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";b.Url="Url";b.RecentLinks="RecentLinks"})(gw||(gw={}));Object(m.b)("InsertLinkUserActivitySource",gw);class ii{constructor(b,k,r){this.Qpb=this.$m=this.nl=null;this.Spc=!1;this.zD=null;this.Gf=Bb.InteractiveViewManager.instance.yd;this.Vk=b;this.nl=r;this.zD=k;ii.D1&&rf.SelectionEditor.Dk(b)&&(b=rf.SelectionEditor.$2c(this.Vk),rf.SelectionEditor.Dk(b)?this.Vk=b:v.ULS.sendTraceTag(41522313,324,
15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));b=rf.SelectionEditor.pMb(this.Vk);rf.SelectionEditor.Dk(b)&&(this.Vk=b)}get Wta(){return null!=this.Qng?this.Qng:this.Qng=Va.a.instance.Pa("Box4.IInternalLinkManager")}get Oj(){return this.$m||(this.$m=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get $9h(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}hHh(b,
k,r){if(k!==this.Vk.cpEnd||b!==this.Vk.cpBegin)b=Ke.SelectionFactory.DN(r,b,k),this.Gf.Cb.setSelection(b),this.Vk=rf.SelectionEditor.pMb(b.Qa.clone())}YQh(b){const k=sh.HyperlinkReader.JJc(this.Vk);let r=this.Vk.cpBegin,y=this.Vk.cpEnd,R="";if(!k.length)return this.Qpb=b.substring(this.Vk.cpBegin,this.Vk.cpEnd),{returnValue:!0,$5d:R,QBd:r,RBd:y,OLd:k};if(k[0].hyperlink){let aa,ta=0,Ya=Math.max(0,b.length-1),xb=0;for(let Mb=0;Mb<k.length;Mb++)k[Mb].cpBegin>=ta&&({cpBegin:aa,cpEnd:ta}=ii.GI.I$(this.Vk,
k[Mb]),Ya=Math.min(aa,Ya),xb=Math.max(ta,xb));r=Math.min(Ya,r);y=Math.max(xb,y);this.Qpb=b.substring(r,y);r===Ya&&(R=k[0].hyperlink.url);return{returnValue:!0,$5d:R,QBd:r,RBd:y,OLd:k}}return{returnValue:!1,$5d:R,QBd:r,RBd:y,OLd:k}}p7f(b){gh.a.instance.J(3)&&ii.Rd.o7f(b)}TMd(b,k){if(this.Gf.Sr){var r=sh.HyperlinkReader.JJc(this.Vk);var y=this.Gf.Cb.ib.kb;if(y){y=y.Qa;ie.ParagraphReader.em(y)&&(y=Re.a.createTextRange(y.node,0,ie.ParagraphReader.textLength(y.node)));if(ii.D1&&rf.SelectionEditor.Dk(y)){var R=
rf.SelectionEditor.$2c(y);rf.SelectionEditor.Dk(R)?y=R:v.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}R=rf.SelectionEditor.pMb(y);rf.SelectionEditor.Dk(R)&&(y=R);if(0!==b&&32===n.AFrameworkApplication.ya.Vf(y,Wa.a.insertHyperlink,1,!0,null,null)&&this.Vk.equals(y)){Ee.a.mark(5562);gh.a.instance.J(4)&&Ka.App.vd&&Ka.App.vd.Pp&&this.Gf.Cb.RWb();b=new sf.GraphTransaction(15);b.Eb(this.Vk.node);this.Vk.node.xI().FF.S9(4);
y=k.txtDisplay;R=!1;if(null!=k.linkurl)if(R=!0,k.isHeading){l(this.zD,"Heading");const aa=k.paragraphNode,ta=k.startCp,Ya=k.endCp;k=this.nl.eOh(aa);this.nl.$Wb(k,ta,Ya,aa,aa,!1)}else l(this.zD,"Bookmark"),k=k.linkurl;else l(this.zD,"Url"),k=k.txtLink.trim();this.insertLink(y,k,r,R);b.Al=Wa.a.insertHyperlink;b.dispose();Ee.a.mark(5563);this.Vk.node.Jcb();this.BS()}else this.Gf.RX()}else v.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}Idj(b,
k,r,y,R,aa=!1){y?(y=Re.a.createTextRange(this.Vk.node,this.Vk.cpBegin,this.Vk.cpBegin+b.length),ii.hyperlinkEditor.GDh(y,r,k),b=Ke.SelectionFactory.xe(this.Vk.node,this.Vk.cpBegin+b.length)):(ii.hyperlinkEditor.cib(this.Vk,2),this.Oj.Pkb(this.Vk,2),r=Re.a.Uc(this.Vk.node,this.Vk.cpEnd),ii.characterPropertiesEditor.replaceTextRange(r,b,!0),y=Re.a.createTextRange(this.Vk.node,this.Vk.cpEnd,this.Vk.cpEnd+b.length),ii.hyperlinkEditor.VG(y,k,R,!1,!0,aa),b=Ke.SelectionFactory.xe(this.Vk.node,this.Vk.cpEnd+
b.length));b&&this.Gf.Cb.setSelection(b)}insertLink(b,k,r,y=!1){var R=null;b||(b=k,n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(k&&(!r.length||k!==r[0].hyperlink.url)&&!y){k=sh.HyperlinkReader.bMa(k);var aa="";this.Wta&&({hSf:aa}=this.Wta.v7f(k)).returnValue&&(k=aa)}this.Spc||(b=ii.hyperlinkEditor.$wn(b));let ta=!1;aa=!1;if(k){R=0<r.length;var Ya=!0;ii.whm&&(Ya=ie.ParagraphReader.text(this.Vk.node).substring(this.Vk.cpBegin,
this.Vk.cpEnd)!==b);if(ii.Rd.og&&1===r.length&&!r[0].hyperlink.MF&&!(r[0].cpBegin>this.Vk.cpBegin&&r[0].cpEnd<=this.Vk.cpEnd)){this.Idj(b,k,r[0].hyperlink,!Ya,R,y);return}if(R)for(var xb=0;xb<r.length;xb++)r[xb].hyperlink.MF&&(aa=!0),ii.hyperlinkEditor.VQ(this.Vk.node,r[xb].hyperlink,!1);Ya&&ii.characterPropertiesEditor.replaceTextRange(this.Vk,b,!aa);Ya||!ii.Rd.og||aa||this.Oj.Pkb(this.Vk,1);r=Re.a.createTextRange(this.Vk.node,this.Vk.cpBegin,this.Vk.cpBegin+b.length);ii.hyperlinkEditor.VG(r,k,R,
aa,!0,y);R=Ke.SelectionFactory.xe(this.Vk.node,this.Vk.cpBegin+b.length)}else if(0<r.length){Ya=r[0];const Mb=({cpBegin:y,cpEnd:xb}=ii.GI.I$(this.Vk,Ya)).returnValue;Ya.hyperlink.MF&&(aa=!0);k?Ya.hyperlink.Reb?(k!==Ya.hyperlink.url&&(ii.Rd.og&&!aa?(r=Re.a.createTextRange(this.Vk.node,y,y+b.length),ii.hyperlinkEditor.GDh(r,Ya.hyperlink,k)):ii.GI.Tlo(k,Mb)),b!==this.Qpb&&(ii.characterPropertiesEditor.replaceTextRange(Re.a.createTextRange(this.Vk.node,y,xb),b,!0),k=Re.a.createTextRange(this.Vk.node,
y,y+b.length),this.p7f(k),R=Ke.SelectionFactory.xe(this.Vk.node,y+b.length),ta=!0)):ii.Rd.og&&!aa?(y=ie.ParagraphReader.text(this.Vk.node).substring(this.Vk.cpBegin,this.Vk.cpEnd)===b,this.Idj(b,k,r[0].hyperlink,y,!1)):(ii.GI.JSf(this.Vk,Mb),ii.characterPropertiesEditor.replaceTextRange(Re.a.createTextRange(this.Vk.node,y,xb),b,!aa),r=Re.a.createTextRange(this.Vk.node,y,y+b.length),ii.hyperlinkEditor.VG(r,k,!1,aa),R=Ke.SelectionFactory.xe(this.Vk.node,y+b.length)):ii.hyperlinkEditor.VQ(Ya.paragraph,
Ya.hyperlink)}(ta||aa)&&ii.Rd.ys(aa?2:7);R&&this.Gf.Cb.setSelection(R);Ka.App.Odo()}static get hyperlinkEditor(){return ii.vC||(ii.vC=Va.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return ii.Yd||(ii.Yd=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rd(){return ii.Jd||(ii.Jd=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get GI(){return ii.AJg||(ii.AJg=Va.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get whm(){null==
ii.Sue&&(ii.Sue=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("KeepHyperlinkFormatFixIsEnabled"):!1);return ii.Sue}static get CDb(){null==ii.Uqb&&(ii.Uqb=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return ii.Uqb}static get D1(){null==ii.KU&&(ii.KU=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ii.KU}}ii.vC=null;ii.Yd=null;ii.Jd=null;ii.AJg=null;ii.Sue=null;ii.Uqb=null;ii.KU=null;
ii.source="Source";ii.aqh="CommandingInterface";ii.Kyb="DisplayText";ii.url="Url";ii.id="InsertLinkDialog";Object(m.a)(ii,"AInsertLinkDialog",null,[10]);class su{static get vg(){return yf.a.Rx(su.tl,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}su.tl="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(su,"InsertLinkDialogHtml",null,[]);class Yw extends ii{constructor(b,k){super(b,k);this.hg=new yf.a;this.hg.lg=ii.id;let r=this.Qpb="";var y=ie.ParagraphReader.text(this.Vk.node);let R=this.Vk.cpBegin,aa=this.Vk.cpEnd;({$5d:r,QBd:R,RBd:aa,OLd:y}=this.YQh(y));(k="object"===typeof k?k:null)&&(k[ii.source]&&k[ii.source]===ii.aqh||k[ii.url]&&k[ii.Kyb])?this.insertLink(k[ii.Kyb],k[ii.url],y):(y[0]&&this.hHh(R,aa,y[0].paragraph),this.hg.vg=su.vg,""===r.trim()&&this.hg.We(1,this.$9h),k={["txtLink"]:r,
["txtDisplay"]:this.Qpb},this.hg.yzd=Object(u.a)(this,this.f2,"dialogDefaultEnterKeyHandler"),this.hg.xzd=Object(u.a)(this,this.f2,"dialogDefaultEnterKeyHandler"),this.hg.Vh(this.titleText,Object(u.a)(this,this.TMd,"insertLinkDialogHandler"),k),ii.CDb&&(k=document.getElementById("txtLink"),Af.a.addHandler(k,Kb.a.input,Object(u.a)(this,this.o1a,"onLinkChanged")),Af.a.addHandler(k,Kb.a.change,Object(u.a)(this,this.o1a,"onLinkChanged"))),document.getElementById("txtLink").focus(),ii.D1?0<Qm.g(Re.a.vL(R,
aa,!1,this.Vk.node)).length&&(this.Spc=!0,document.getElementById("txtDisplay").disabled=!0):1>=y.length&&ii.GI.Xrh(b,y[0],1===y.length)&&(this.Spc=!0,document.getElementById("txtDisplay").disabled=!0))}o1a(){if(this.hg){const b=document.getElementById("txtLink");this.hg.Wga(1,!b||!b.value.length||sh.HyperlinkReader.oNa(b.value))}}f2(b){return this.hg?ii.CDb?this.hg.qOh(this.hg.MPb)?this.hg.f2(b):!1:this.hg.f2(b):!1}BS(){if(ii.CDb){const b=document.getElementById("txtLink");b&&(Af.a.removeHandler(b,
Kb.a.change,Object(u.a)(this,this.o1a,"onLinkChanged")),Af.a.removeHandler(b,Kb.a.input,Object(u.a)(this,this.o1a,"onLinkChanged")))}this.hg&&(this.hg=null)}}Object(m.a)(Yw,"InsertLinkDialog",ii,[]);class Rx{constructor(b,k,r,y,R){this.linkurl=b;this.isHeading=k;this.startCp=r;this.endCp=y;this.paragraphNode=R}}Object(m.a)(Rx,"HeadingDataForLinkDialog",null,[]);class Gt{constructor(b,k){this.linkurl=b;this.isHeading=k}}Object(m.a)(Gt,"BookmarkDataForLinkDialog",null,[]);class xv{constructor(b,k,r,
y,R,aa){this.key=b;this.name=k;this.startIndex=r;this.count=y;this.level=R;this.isCollapsed=aa}}Object(m.a)(xv,"GroupHeaderDataForLinkDialog",null,[]);class cm{constructor(b,k){this.selectedIndex=b;this.selectedGroupId=k}}Object(m.a)(cm,"SelectedItemFromLinkDialogGroupedList",null,[]);class hw extends ii{constructor(b,k,r,y,R){super(b,k,y);this.sDj=r;this.Hh=R;const aa=new yf.a(!1,!1,!0);r={};r.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;r.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
r.insertInternalLinkEnabled=!0;r.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText;r.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText;r.groupedList=this.yvl();var ta=this.Qpb="";ta=ie.ParagraphReader.text(this.Vk.node);y=this.Vk.cpBegin;R=this.Vk.cpEnd;let Ya;({$5d:ta,QBd:y,RBd:R,OLd:Ya}=this.YQh(ta));if((k="object"===typeof k?k:null)&&(k[ii.source]&&k[ii.source]===ii.aqh||k[ii.url]&&k[ii.Kyb]))this.insertLink(k[ii.Kyb],k[ii.url],Ya);else{Ya[0]&&this.hHh(y,R,Ya[0].paragraph);k=CommonUIStrings.l_DialogOk;
""===ta.trim()&&(k=this.$9h);aa.We(1,k);ta&&ta.startsWith(A.a.Cab)?(k=this.WJl(ta,r.groupedList))?r.groupedList.selectedItem=k:r.txtLink=ta:r.txtLink=ta;r.txtDisplay=this.Qpb;ii.D1?0<Qm.g(Re.a.vL(y,R,!1,this.Vk.node)).length&&(this.Spc=!0,r.textDisplayDisabled=!0):1>=Ya.length&&ii.GI.Xrh(b,Ya[0],1===Ya.length)&&(this.Spc=!0,r.textDisplayDisabled=!0);var xb={["id"]:ii.id,["bodyControls"]:r};this.Hh.Qd(()=>{aa.Vh(this.titleText,Object(u.a)(this,this.TMd,"insertLinkDialogHandler"),xb)},"RILD:IAS")}}WJl(b,
k){k=k.items;const r=b.substring(A.a.Cab.length),y=this.nl.Wgf(r);b=-1;let R=0;for(let aa=0;aa<k.length;aa++)if(k[aa].isHeading&&0!=y.count&&k[aa].paragraphNode.id==y.J(0).id){b=aa;break}else if(!k[aa].isHeading&&k[aa].linkurl==r){b=aa;R=1;break}k=new cm(b,R);return-1!=b?k:null}yvl(){const b={};let k=[],r=0,y=0;var R=this.sDj.Yvl();null!=R&&(r=R.count,k=k.concat(this.cwl(R)));R=this.nl.nHc(!1);null!=R&&(y=R.count,k=k.concat(this.jll(R)));b.groups=this.Tvl(r,y);b.items=k;return b}Tvl(b,k){const r=
[];let y=new xv("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(y);b=new xv("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,k,0,!0);r.push(b);return r}cwl(b){const k=[];for(const r of b)b=new Rx(r.characterData,!0,r.begin,r.end,r.paragraphNode),k.push(b);return k}jll(b){const k=[];for(const r of b)b=r.wg(wc.a.Rs).toString(),b=new Gt(b,!1),k.push(b);return k}BS(){}}Object(m.a)(hw,"ReactInsertLinkDialog",ii,[]);class Ht{constructor(){this.vqa=
!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA}uvh(b,k,r,y){this.vqa?new hw(b,k,r,y,Bo.a.instance):new Yw(b,k)}static get instance(){return null!=Ht.wmg?Ht.wmg:Ht.wmg=new Ht}}Object(m.a)(Ht,"InsertLinkDialogFactory",null,[652]);class zn extends yf.a{constructor(b){super();this.o1a=()=>{const k=document.getElementById("txtLink");this.Wga(1,!k||!k.value.length||sh.HyperlinkReader.oNa(k.value))};this.TMd=(k,r)=>{if(this.Gf.Sr){var y=this.Gf.Cb.ib.kb;if(y)if(y.equals(this.Ow)&&0!==k){k=
new sf.GraphTransaction(15);k.Eb(this.lS[0].node);for(y=0;y<this.lS.length;y++)this.lS[y].node.xI().FF.S9(4);y=r.txtLink.trim();r=this.STk();y=this.A7l(y);(r||y)&&zn.Rd.ys(7);this.hide();k.dispose()}else this.Gf.RX()}};this.lS=b;this.Gf=Bb.InteractiveViewManager.instance.yd;this.Ow=this.Gf.Cb.ib.kb;this.c$e=b[0].cpBegin;this.Rvf=b[b.length-1].cpEnd;this.lg="InsertMultiParagraphLinkDialog";b=this.alo();this.showDialog("",b)}showDialog(b,k){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");
this.vg=su.vg;""===k.trim()&&this.We(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Vh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.TMd,{["txtLink"]:k,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;zn.CDb&&(b=document.getElementById("txtLink"),Af.a.addHandler(b,Kb.a.input,this.o1a),Af.a.addHandler(b,Kb.a.change,this.o1a))}hide(){if(zn.CDb){const b=document.getElementById("txtLink");b&&(Af.a.removeHandler(b,Kb.a.change,this.o1a),
Af.a.removeHandler(b,Kb.a.input,this.o1a))}super.hide()}f2(b){return zn.CDb?this.qOh(this.MPb)?super.f2(b):!1:super.f2(b)}alo(){let b;var k="";const r=this.lS.length,y=sh.HyperlinkReader.aD(this.lS[0],!1);0<y.length&&({cpBegin:R,cpEnd:b}=zn.GI.I$(this.lS[0],y[0]),R<=this.lS[0].cpBegin&&(k=y[0].hyperlink.url),this.c$e=Math.min(this.c$e,R));var R=sh.HyperlinkReader.aD(this.lS[r-1],!1);0<R.length&&({cpBegin:R,cpEnd:b}=zn.GI.I$(this.lS[r-1],R[R.length-1]),this.Rvf=Math.max(this.Rvf,b));this.ueo(this.c$e,
this.Rvf);return k}ueo(b,k){const r=this.lS.length;if(b!==this.lS[0].cpBegin||k!==this.lS[r-1].cpEnd){b=Re.a.Uc(this.lS[0].node,b);b=Ke.SelectionFactory.fo(b);k=Re.a.Uc(this.lS[r-1].node,k);k=Ke.SelectionFactory.KB(b,k);b=this.l1h(k.Qa.clone());const y=this.l1h(k.Tc.clone());b&&y&&(this.lS[0]=b,this.lS[r-1]=y,this.Gf.Cb.setSelection(k),this.Ow=k)}}A7l(b){if(!b)return!1;b=sh.HyperlinkReader.bMa(b);for(let r=0;r<this.lS.length;r++){var k=this.lS[r];if(zn.D1&&rf.SelectionEditor.Dk(k)&&(k=rf.SelectionEditor.$2c(k),
!rf.SelectionEditor.Dk(k)))continue;k=Re.a.createTextRange(this.lS[r].node,k.cpBegin,k.cpEnd);this.p7f(k);zn.hyperlinkEditor.VG(k,b,!1)}return!0}p7f(b){gh.a.instance.J(3)&&zn.Rd.o7f(b)}l1h(b){return ie.ParagraphReader.em(b)&&!rf.SelectionEditor.J6(b)&&ie.ParagraphReader.textLength(b.node)?Re.a.createTextRange(b.node,0,ie.ParagraphReader.textLength(b.node)):rf.SelectionEditor.Dk(b)?b:null}STk(){let b=!1;for(const k of this.lS){const r=sh.HyperlinkReader.aD(k,!1);r&&(b=zn.GI.JSf(k,r)||b)}return b}static get GI(){return null!=
zn.Vlg?zn.Vlg:zn.Vlg=Va.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Rd(){return null!=zn.otg?zn.otg:zn.otg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=zn.Mlg?zn.Mlg:zn.Mlg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static get D1(){null==zn.KU&&(zn.KU=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return zn.KU}static get CDb(){null==zn.Uqb&&(zn.Uqb=n.AFrameworkApplication.K?
n.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return zn.Uqb}}zn.KU=null;zn.Uqb=null;Object(m.a)(zn,"InsertMultiParagraphLinkDialog",yf.a,[]);class of{static get bookmarkManager(){return null!=of.zhg?of.zhg:of.zhg=Va.a.instance.Ze("WordEditor.Bookmark.FullBookmarkManager").value}static get D0b(){return null!=of.ijg?of.ijg:of.ijg=Va.a.instance.Ze("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value}static get ag(){return mh.a.instance}static get Wda(){return null!=of.kig?
of.kig:of.kig=Va.a.instance.Pa("Box4.IContentControlChpHelper")}static get GI(){return null!=of.Xlg?of.Xlg:of.Xlg=Va.a.instance.resolve("Box4.IHyperlinkStrategy")}static xw(){return of.Km||(of.Km=Va.a.instance.$a("Box4.IExternalSelectionManager"))}static get Rd(){return null!=of.Atg?of.Atg:of.Atg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ph(){return null!=of.Gtg?of.Gtg:of.Gtg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Sg(){return tm.ContextSetEditor.instance}static get Kc(){return Db.a.instance}static get uSc(){null==
of.qnb&&(of.qnb=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return of.qnb}static get D1(){null==of.KU&&(of.KU=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return of.KU}static get hyperlinkEditor(){return null!=of.Tlg?of.Tlg:of.Tlg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=of.cig?of.cig:of.cig=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get $Oc(){n.AFrameworkApplication.Ne("recentLinks;recentLinkscf");
of.Cve||(of.Cve=n.AFrameworkApplication.K?(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)||n.AFrameworkApplication.K.$("WordRecentLinksIsEnabled"))&&(n.AFrameworkApplication.K.$("IsO365CommercialHost")||n.AFrameworkApplication.K.$("IsO365ConsumerHost")):!1);return of.Cve}static get nao(){of.q4g||(of.q4g=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.timeInMillisBetweenTwoMRUCalls",6E4):6E4);
return of.q4g}static Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.insertHyperlink,lc.a.view,of.sCb);b.pa(Wa.a.insertHyperlink,lc.a.Wc,of.insertLink);b.pa(Wa.a.insertHyperlink,lc.a.Hd,of.insertLink);b.Vc(Wa.a.insertHyperlink,1028);b.pa(Wa.a.O0b,lc.a.view,of.sCb);b.pa(Wa.a.O0b,lc.a.Wc,of.insertLink);b.pa(Wa.a.O0b,lc.a.Hd,of.insertLink);b.Vc(Wa.a.O0b,1028);b.pa(Wa.a.VQ,lc.a.view,of.sCb);b.pa(Wa.a.VQ,lc.a.Wc,of.nPi);b.pa(Wa.a.VQ,lc.a.Hd,of.nPi);b.Vc(Wa.a.VQ,1028);b.pa(Wa.a.V5d,lc.a.view,of.sCb);
b.pa(Wa.a.V5d,lc.a.Wc,of.CXi);b.pa(Wa.a.V5d,lc.a.Hd,of.CXi);b.pa(Wa.a.u1a,lc.a.view,of.sCb);b.pa(Wa.a.u1a,lc.a.Wc,of.UCi);b.pa(Wa.a.u1a,lc.a.Hd,of.UCi);b.pa(Wa.a.u1a,lc.a.image,of.OJf);b.pa(Wa.a.u1a,lc.a.Ozb,of.OJf);gh.a.instance.J(5)&&b.pa(Wa.a.u1a,lc.a.anchoredObject,of.OJf);b.pa(Wa.a.jBc,lc.a.application,of.jBc);b.pa(Wa.a.exd,lc.a.view,of.sCb);of.$Oc&&(b.gb(ib.a.j2a,lc.a.view,this.sCb.bind(this),1028),b.pa(ib.a.j2a,lc.a.Wc,this.j2a.bind(this)),b.pa(ib.a.j2a,lc.a.Hd,this.j2a.bind(this)),b.Vc(ib.a.j2a,
1028),b.pa(ib.a.zof,lc.a.Wc,this.j2a.bind(this)),b.pa(ib.a.zof,lc.a.Hd,this.j2a.bind(this)),b.Vc(ib.a.zof,1028),b.pa(ib.a.FMf,lc.a.view,this.FMf.bind(this)),b.pa(ib.a.zMf,lc.a.view,this.zMf.bind(this)),b.gb(ib.a.Hfb,lc.a.Wc,this.Hfb.bind(this),1028),b.gb(ib.a.Hfb,lc.a.Hd,this.Hfb.bind(this),1028))}static jBc(){return 32}static j2a(b,k){if(!of.$Oc)return 2;b=of.Tlj(k);return 32!=b?b:!of.nNa(k,!0).returnValue||of.UZb(k)?8:32}static FMf(b,k,r,y,R){if(!of.$Oc)return 2;if(1===r)return 32;of.j3d(of.lSj,
of.mSj,of.DYg);Bo.a.instance.Qd(()=>{of.B9f();R.MenuItems=Object.assign(new Ci.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const aa=this.rwh();aa?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),R.MenuItems.MenuSectionList.push(aa)):of.DGi(R,of.DYg)},"HA:PRLF");return 32}static zMf(b,k,r,y,R){if(!of.$Oc)return 2;if(1===r)return 32;of.j3d(of.jSj,of.kSj,of.CYg);Bo.a.instance.Qd(()=>{of.B9f();R.MenuItems=Object.assign(new Ci.a,{Id:"InsertLinkFlyoutList",
MenuSectionList:[],UpdateDynamically:!0});R.MenuItems.MenuSectionList.push(this.eMk());const aa=this.rwh(!0);aa?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),R.MenuItems.MenuSectionList.push(aa)):of.DGi(R,of.CYg)},"HA:PILF");return 32}static DGi(b,k){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+k);of.j3d(of.QOj,of.ROj,k);b.MenuItems.MenuSectionList.push(this.wOk());of.B9f(!0)}static wOk(){const b=this.b1e("RecentLinksNoDataSection",
!1);b.ControlList.push(Object.assign(new Wg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static eMk(){const b=this.b1e("InsertLinkSection");b.ControlList.push(Object.assign(new Wg.a,{ExternalId:"InsertLink"}));return b}static rwh(b=!1){if(ll.instance.Njd){var k=this.b1e("RecentLinksSection",b);b=JSON.parse(ll.instance.Njd);this.Mjd.clear();b.forEach((r,y)=>{this.Mjd.set(y,[r.FileName,r.DocumentUrl]);const R=of.JHl(r.FileName);var aa=
of.Wul(r.TimeStamp),ta=k.ControlList,Ya=ta.push,xb=Object,Mb=xb.assign,cc=new Wg.a,jc=ib.a.Hfb,Mc=ib.a.Hfb;aa=R!==r.FileName?r.FileName+"\n"+aa:aa;var fd=r.FileName;let Td="SaveAsWordDocx_32";switch(r.App){case "Word":Td="SaveAsWordDocx_32";break;case "PowerPoint":Td="SaveAsPowerPointPptx_32";break;case "Excel":Td="SaveAsExcelXlsx_32"}Ya.call(ta,Mb.call(xb,cc,{ExternalId:y,Command:jc,CommandValueId:Mc,LabelText:R,Alt:aa,AriaDescription:fd,ExternalImageId:Td,KeyTip:r.FileName}))});return k}}static b1e(b,
k=!1){return Object.assign(new oi.a,{Title:k?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Hfb(b,k,r,y,R){if(!of.$Oc)return 2;if(!R||R.CommandValueId!=ib.a.Hfb)return 32;of.j3d(of.gJj,of.hJj,of.yTj);r=k;k=new sf.GraphTransaction(15);k.Al=b;k.Eb(r.node);y=of.nNa(r,!0).hyperlink;r=rf.SelectionEditor.pMb(r);if(y)of.ZSf(r),b=Ke.SelectionFactory.DN(r.node,Math.min(r.cpBegin,y.cpBegin),Math.max(r.cpEnd,y.cpEnd)),bh.a.instance.setSelection(b),
r=b.Qa;else if(rf.SelectionEditor.zf(r)){var aa;rf.SelectionEditor.Lgb(r)&&(aa=rf.SelectionEditor.k2(r,!1));aa||(aa=this.Mjd.get(R.SourceControlId)[0],of.characterPropertiesEditor.replaceTextRange(r,aa,!0,void 0,b),aa=Ke.SelectionFactory.DN(r.node,r.cpBegin,r.cpBegin+aa.length));if(aa&&(bh.a.instance.setSelection(aa),r=aa.Qa,of.UZb(r)))return of.Rd.ZKb(!1),8}try{of.hyperlinkEditor.VG(r,this.Mjd.get(R.SourceControlId)[1],0<sh.HyperlinkReader.JJc(r).length);const ta=Ke.SelectionFactory.xe(r.node,r.cpEnd);
ta&&bh.a.instance.setSelection(ta);l(R,"RecentLinks")}finally{k&&k.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static sCb(b,k,r,y,R){if(of.uSc)return of.I0l(b,k,r,y,R);if(!k.view.ye)return 2;var aa=k.view.Cb;if(!aa||!aa.ib||!aa.ib.length)return 8;var ta=aa.ib.kb;let Ya=ta.Qa.clone();if(2===ta.length){if(ta=ta.J(1),!rf.SelectionEditor.Dk(Ya)||!rf.SelectionEditor.qk(ta)||Ya.node!==ta.node)return 8}else if(2<ta.length)return 8;if(aa.ib.JI)return 8;if(of.Sg.Swa(ie.ParagraphReader.HT,
aa.Jg))return of.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),8;ie.ParagraphReader.em(Ya)&&!rf.SelectionEditor.J6(Ya)&&(aa=Ya.node,Ya=Re.a.createTextRange(aa,0,ie.ParagraphReader.textLength(aa)));return b===Wa.a.exd?of.Ath(k,Ya,r,y):n.AFrameworkApplication.ya.Vf(Ya,b,r,!0,y,R)}static I0l(b,k,r,y,R){if(!k.view.ye)return 2;var aa=k.view.Cb;if(!aa||!aa.ib||!aa.ib.length||aa.ib.JI)return 8;var ta=aa.ib.kb;if(aa=of.auf(ta))ta=of.Zif(ta.Qa.clone(),!0);else{let Ya=ta.J(0).clone(),xb=1;for(;xb<ta.length&&(!ie.ParagraphReader.textLength(Ya.node)||
rf.SelectionEditor.qk(Ya)||of.D1&&Qm.l(Ya));)Ya=ta.J(xb).clone(),xb++;ta=of.Zif(Ya,!1)}return of.D1&&rf.SelectionEditor.Dk(ta)&&Qm.l(ta)||!rf.SelectionEditor.Dk(ta)&&!aa?8:b===Wa.a.exd?of.Ath(k,ta,r,y):n.AFrameworkApplication.ya.Vf(ta,b,r,!0,y,R)}static auf(b){if(1===b.length)return!0;if(2===b.length){const k=b.Qa.clone();b=b.J(1);return rf.SelectionEditor.Dk(k)&&rf.SelectionEditor.qk(b)&&k.node===b.node?!0:!1}return!1}static erh(b){let k=null;const r=[];for(let y=0;y<b.length;y++){const R=of.Zif(b.J(y).clone(),
!1);if(rf.SelectionEditor.Dk(R))of.D1&&Qm.l(R)||r.push(R);else if(!rf.SelectionEditor.qk(R)&&!ie.ParagraphReader.em(R))return{returnValue:!1,zbb:k}}k=r;return{returnValue:!of.D1||0<k.length?!0:!1,zbb:k}}static insertLink(b,k,r,y,R){if(of.uSc)return of.G7l(k,r,R);y=of.Tlj(k);if(32!==y)return y;let aa;if(!({hyperlink:aa}=of.nNa(k,!0)).returnValue||of.UZb(k)||!aa&&b==Wa.a.O0b)return 8;if(1===r)return 32;if(!aa&&rf.SelectionEditor.zf(k)&&rf.SelectionEditor.Lgb(k)&&(b=rf.SelectionEditor.k2(k,!1))&&(bh.a.instance.setSelection(b),
k=b.Qa,of.UZb(k)))return of.Rd.ZKb(!1),8;aa&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");Ht.instance.uvh(k,R,of.D0b,of.bookmarkManager);return 32}static Tlj(b){return!of.LVe()||!of.Otd(b)||b.node.Ur||bh.a.instance.ib.JI?8:gh.a.instance.J(5)&&rf.SelectionEditor.laa(b)||Me.a.irf(b)?2:32}static G7l(b,k,r){var y=bh.a.instance.ib.kb;const R=of.auf(y);if(R)b=[b];else if(!({zbb:b}=of.erh(y)).returnValue)return 8;if(!of.LVe())return 8;for(y=0;y<b.length;y++)if(!of.Otd(b[y]))return 8;if(bh.a.instance.ib.JI)return 8;
y=Array(b.length);let aa=null;for(let ta=0;ta<b.length;ta++)if(y[ta]=b[ta],!({hyperlink:aa}=of.nNa(y[ta],!0)).returnValue||of.UZb(y[ta]))return 8;if(1===k)return 32;if(!aa&&1===y.length&&R&&rf.SelectionEditor.zf(y[0])&&rf.SelectionEditor.Lgb(y[0])&&(k=rf.SelectionEditor.k2(y[0],!1))&&(bh.a.instance.setSelection(k),y[0]=k.Qa,of.UZb(y[0])))return of.Rd.ZKb(!1),8;R?Ht.instance.uvh(y[0],r,of.D0b,of.bookmarkManager):new zn(y,r);return 32}static nPi(b,k,r){if(of.uSc)return of.rsn(b,k,r);if(!of.Otd(k)||
gh.a.instance.J(5)&&rf.SelectionEditor.laa(k))return 2;let y;if(!({hyperlink:y}=of.nNa(k,!1)).returnValue)return 2;if(2===r){r=new sf.GraphTransaction(15);try{r.Al=b,r.Eb(y.paragraph),of.ZSf(k)}finally{r&&r.dispose()}y.hyperlink.MF&&of.Rd.ys(2)}return 32}static rsn(b,k,r){var y=bh.a.instance.ib.kb;if(of.auf(y))k=[k];else if(!({zbb:k}=of.erh(y)).returnValue)return 8;if(!of.LVe())return 8;for(y=0;y<k.length;y++)if(!of.Otd(k[y]))return 8;if(1===r&&!of.nNa(k[0],!1).returnValue)return 2;if(2===r){for(r=
0;r<k.length;r++)if(!of.nNa(k[r],!0).returnValue)return 2;r=new sf.GraphTransaction(15);try{const R=k[0];r.Al=b;r.Eb(R.node);for(b=0;b<k.length;b++)of.ZSf(k[b])}finally{r&&r.dispose()}of.Rd.ys(7)}return 32}static ZSf(b){const k=sh.HyperlinkReader.JJc(b);let r=0;for(let y=0;y<k.length;y++)if(k[y].cpBegin>=r){const R=({cpEnd:r}=of.GI.I$(b,k[y])).returnValue;of.GI.JSf(b,R)}}static CXi(b,k,r){if(gh.a.instance.J(5)&&Pd.ImageReader.Wfb(k)||!({hyperlink:b}=of.nNa(k,!1)).returnValue)return 2;2===r&&({cpBegin:k,
cpEnd:r}=of.GI.I$(k,b),bh.a.instance.setSelection(Ke.SelectionFactory.DN(b.paragraph,k,r)));return 32}static UCi(b,k,r){let y;if(gh.a.instance.J(5)&&({hyperlink:y}=of.cpm(k)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:y}=of.nNa(k,!1)).returnValue)return 2;2===r&&Ka.App.Uzb(y.hyperlink.url);return 32}static OJf(b,k,r){b=Pd.ImageReader.I$(k.node);if(!b)return 2;2===r&&Ka.App.Uzb(b);return 32}static Ath(b,k,r,y){if(gh.a.instance.J(5)&&
Pd.ImageReader.Wfb(k)||!Bb.InteractiveViewManager.instance.editingView.Dj)return 2;let R;if(!({hyperlink:R}=of.nNa(k,!1)).returnValue)return 2;if(1===r)return 32;({cpBegin:k,cpEnd:r}=of.GI.I$(k,R));bh.a.instance.setSelection(Ke.SelectionFactory.DN(R.paragraph,k,r));k=Bb.InteractiveViewManager.instance.Yza.ownerDocument.createElement("span");k.innerText=R.hyperlink.url;k.style.backgroundColor="rgb(255, 255, 255)";return n.AFrameworkApplication.ya.Vf(b,Wa.a.dxd,2,!0,y,k)}static nNa(b,k){if(rf.SelectionEditor.Dk(b)){const r=
Qm.g(b),y=Th.a.all(r,R=>6===R.li);if(0<r.length&&(!of.D1||!y)||of.ag.xh&&of.Wda&&0<of.Wda.cFd(b).count)return{returnValue:!1,hyperlink:null}}return of.Tom(b,k)}static cpm(b){let k=null;return Pd.ImageReader.Wfb(b)&&(k=sh.HyperlinkReader.h3b(b))?{returnValue:!0,hyperlink:k}:{returnValue:!1,hyperlink:k}}static Tom(b,k){let r=null;const y=sh.HyperlinkReader.JJc(b);return y.length?y[0].hyperlink?(r=y[0],b.cpBegin<y[0].cpBegin?{returnValue:k,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:
{returnValue:k,hyperlink:r}}static UZb(b){if(gh.a.instance.J(3)){b=of.Ph.eMa(b.node,b.cpBegin,b.cpEnd);for(let k=0;k<b.count;++k)if(2===b.J(k).Pd.changeType)return!0}return!1}static LVe(){return gh.a.instance.J(3)?!0:!gh.a.instance.J(3)||!Ka.App.Ev.Xgc}static Otd(b){return of.ag.mZ(b)||of.ag.fua(b)||of.xw()&&of.xw().instance&&of.xw().instance.KT(b)?!1:!0}static Zif(b,k){return ie.ParagraphReader.em(b)&&!rf.SelectionEditor.J6(b)&&(ie.ParagraphReader.textLength(b.node)||k)?Re.a.createTextRange(b.node,
0,ie.ParagraphReader.textLength(b.node)):b}static JHl(b){return b&&b.length<=of.HLi?b:b.substring(0,of.HLi)+"..."}static Wul(b){try{const k=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,k.toLocaleString(void 0,{weekday:"long"}),k.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(k){return""}}static B9f(b=!1){let k=Date.now();if(b||k-of.mli>of.nao)ll.instance.Lqi(),of.mli=k}static j3d(b,k,r){const y=new Map;y.set("Source",r);y.set("Action",k);Ga.Health.instance.recordKpiUsage(b,
0,this.CSa,y)}}of.Km=null;of.qnb=null;of.KU=null;of.Mjd=new Map;of.Cve=null;of.HLi=35;of.mli=Date.now();of.CSa="wwaengidc";of.yTj="RecentLinks";of.DYg="RecentLinksRibbonOptions";of.CYg="RecentLinksContextMenuOptions";of.lSj="PopulateRecentLinksRibbon";of.mSj="PopulateRecentLinksRibbonAction";of.jSj="PopulateRecentLinksContextMenu";of.kSj="PopulateRecentLinksContextMenuAction";of.QOj="PopulateRecentLinksContextMenu";of.ROj="PopulateRecentLinksContextMenuAction";of.gJj="InsertRecentLinks";of.hJj="InsertRecentLinksAction";
Object(m.a)(of,"HyperlinkActor",null,[]);class Xu{}Xu.jQc=Object.freeze({M2l:"WordIndentationShortcutUsage"});Xu.LB="wwaengidc";Object(m.a)(Xu,"IndentationConstants",null,[]);class dm{static get xp(){return gn.a.fBb}static get Sg(){return tm.ContextSetEditor.instance}static get ag(){return mh.a.instance}static get Kc(){return Db.a.instance}static get hu(){return Bb.InteractiveViewManager.instance}static xw(){return dm.Km||(dm.Km=Va.a.instance.$a("Box4.IExternalSelectionManager"))}static get L2l(){return null!=
dm.dmg?dm.dmg:dm.dmg=Va.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.XF,lc.a.view,dm.gzc);b.pa(Wa.a.XF,lc.a.outlineElement,dm.xeh);b.Vc(Wa.a.XF,1036);b.pa(Wa.a.FN,lc.a.view,dm.gzc);b.pa(Wa.a.FN,lc.a.outlineElement,dm.xeh);b.Vc(Wa.a.FN,1036)}static wkn(b){const k=new Map;b=b?b.ia(Gh.a.J8h,"Unknown"):"tab";k.set("actionCallSource",b);Ga.Health.instance.recordKpiUsage(Xu.jQc.M2l,1,Xu.LB,k)}static gzc(b,k,r,y,R){const aa=k.view;
if(!aa.ye)return 2;var ta=aa.Cb;if(!ta)return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.Wfa}),8;ta=ta.Jg;if(!ta)return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.noSelection}),8;if(Me.a.ufa(k))return 8;if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&dm.ag.t6b(ta))return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dE}),8;if(1===r)return 32;if(dm.Sg.jAa(dm.UQe,ta))return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.cCc}),8;if(dm.Sg.Swa(ie.ParagraphReader.HT,ta))return dm.Kc.Zb($c.a.vf,
{["Reason"]:bd.a.uN}),8;if(!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&dm.ag.t6b(ta))return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dE}),8;if(dm.xw()&&dm.xw().instance&&dm.xw().instance.KT(ta))return dm.Kc.Zb($c.a.vf,{["Reason"]:bd.a.externalSelection}),8;ta={};ta[pq.a.RFa]=5794;ta[pq.a.QFa]=5795;return dm.L2l.gzc(aa,b,k,r,y,R,ta)}static xeh(b,k,r,y,R){var aa,ta;if(k.contextId!==lc.a.outlineElement)return 2;var Ya=k.clone().r2f();if(Si.TableReader.kji(Ya)){if(dm.ag.lji(Ya))return dm.Kc.Zb($c.a.Vm,
{["Reason"]:bd.a.dE}),8}else if(dm.ag.R_a(Ya))return dm.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),2;Ya=new Wd.GraphIterator;Ya.set(k.node);rf.SelectionEditor.Pt(Ya);if(!Ag.OutlineElementReader.Nh(Ya))return 2;let xb;switch(b){case Wa.a.XF:xb=dm.xp.Kwb(Ya);break;case Wa.a.FN:xb=dm.xp.YYb(Ya);break;default:return 2}if(1===r||!xb)return xb?32:8;r=0;b===Wa.a.FN&&R&&R.ia(td.a.ogh,!1)&&(r|=2);if(Ag.OutlineElementReader.EP(Ya))return dm.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.uN}),2;(null===(ta=null===(aa=dm.hu)||void 0===
aa?void 0:aa.yd)||void 0===ta?0:ta.cO)&&dm.hu.editingView&&(dm.hu.editingView.uH=!0);switch(b){case Wa.a.XF:dm.xp.OOa(Ya,-1,r);break;case Wa.a.FN:dm.xp.TDc(Ya,1)}y&&Qc.a.Slb&&(y.Mr|=Qc.a.Odb(k.node,!0));dm.wkn(R);return 32}}dm.Km=null;dm.UQe=Pd.ImageReader.k_a;Object(m.a)(dm,"IndentationActor",null,[]);var em=c(1520);class Yj{static get paragraphEditor(){return null!=Yj.kqg?Yj.kqg:Yj.kqg=Va.a.instance.resolve("Box4.IParagraphEditor")}static get Fk(){return null!=Yj.rsg?Yj.rsg:Yj.rsg=Va.a.instance.resolve("Box4.ITableEditor")}static get ag(){return mh.a.instance}static get Kc(){return Db.a.instance}static xw(){return Yj.Km||
(Yj.Km=Va.a.instance.$a("Box4.IExternalSelectionManager"))}static Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.ybj,lc.a.view,(k,r)=>Me.a.ufa(r)?8:32);b.pa(Wa.a.leftJustify,lc.a.view,em.a.Cv);b.pa(Wa.a.leftJustify,lc.a.paragraph,Yj.Bza);b.pa(Wa.a.leftJustify,lc.a.table,Yj.URe);b.Vc(Wa.a.leftJustify,1036);b.pa(Wa.a.centerJustify,lc.a.view,em.a.Cv);b.pa(Wa.a.centerJustify,lc.a.paragraph,Yj.Bza);b.pa(Wa.a.centerJustify,lc.a.table,Yj.URe);b.Vc(Wa.a.centerJustify,1036);b.pa(Wa.a.rightJustify,lc.a.view,
em.a.Cv);b.pa(Wa.a.rightJustify,lc.a.paragraph,Yj.Bza);b.pa(Wa.a.rightJustify,lc.a.table,Yj.URe);b.Vc(Wa.a.rightJustify,1036);b.pa(Wa.a.fullJustify,lc.a.view,em.a.Cv);b.pa(Wa.a.fullJustify,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.fullJustify,1036);b.pa(Wa.a.vEc,lc.a.view,em.a.Cv);b.pa(Wa.a.vEc,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.vEc,1036);b.pa(Wa.a.JEb,lc.a.view,em.a.Cv);b.pa(Wa.a.JEb,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.JEb,1036);b.pa(Wa.a.S_c,lc.a.view,em.a.Cv);b.pa(Wa.a.S_c,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.S_c,
1036);b.pa(Wa.a.a9b,lc.a.view,em.a.Cv);b.pa(Wa.a.a9b,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.a9b,1036);b.pa(Wa.a.mZb,lc.a.view,em.a.Cv);b.pa(Wa.a.mZb,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.mZb,1036);b.pa(Wa.a.hdc,lc.a.view,em.a.Cv);b.pa(Wa.a.hdc,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.hdc,1036);b.pa(Wa.a.j2b,lc.a.view,em.a.Cv);b.pa(Wa.a.j2b,lc.a.paragraph,Yj.Bza);b.Vc(Wa.a.j2b,1036)}static URe(b,k,r,y){let R=!0;if(!k)return 8;Si.TableReader.kji(k)?Yj.ag.lji(k)?(Yj.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),R=!1):Yj.xw()&&Yj.xw().instance&&
Yj.xw().instance.KT(k)&&(Yj.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.externalSelection}),R=!1):(Yj.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.O5e}),R=!1);if(1===r||!R)return R?32:8;k=k.node;switch(b){case Wa.a.leftJustify:Yj.Fk.tD(k,1);break;case Wa.a.centerJustify:Yj.Fk.tD(k,2);break;case Wa.a.rightJustify:Yj.Fk.tD(k,3)}y&&Qc.a.Slb&&(y.Mr|=2);return 32}static Bza(b,k,r,y,R){let aa=!0;k.contextId!==lc.a.paragraph?aa=!1:Yj.ag.R_a(k)?(Yj.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),aa=!1):Yj.xw()&&Yj.xw().instance&&Yj.xw().instance.KT(k)&&
(Yj.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.externalSelection}),aa=!1);if(1===r||!aa)return aa?32:8;k=k.node;r=ie.ParagraphReader.Lv(k);switch(b){case Wa.a.leftJustify:case Wa.a.a9b:Yj.paragraphEditor.tD(k,1===r&&Yj.$Qd(R)?6:1);break;case Wa.a.centerJustify:case Wa.a.mZb:Yj.paragraphEditor.tD(k,2===r&&Yj.$Qd(R)?1:2);break;case Wa.a.rightJustify:case Wa.a.hdc:Yj.paragraphEditor.tD(k,3===r&&Yj.$Qd(R)?1:3);break;case Wa.a.fullJustify:case Wa.a.j2b:Yj.paragraphEditor.tD(k,6===r&&Yj.$Qd(R)?1:6);break;case Wa.a.JEb:Yj.paragraphEditor.tD(k,
11);break;case Wa.a.vEc:Yj.paragraphEditor.tD(k,7);break;case Wa.a.S_c:Yj.paragraphEditor.tD(k,13)}y&&Qc.a.Slb&&(y.Mr|=Qc.a.Odb(k));return 32}static $Qd(b){let k=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(k=b.InContextSet);return!k}}Yj.Km=null;Object(m.a)(Yj,"JustificationActor",null,[]);const Sx=()=>{const b=n.AFrameworkApplication.ya;b.pa(Wa.a.save,zc.a.frame,Tx);b.pa(Wa.a.sync,zc.a.frame,iw)},iw=(b,k,r)=>{if(1===r)return 32;n.AFrameworkApplication.ya.processAction(Wa.a.Mwb,
2);Ka.App.ik.fae();return 32},Tx=(b,k,r)=>{if(1===r)return 2===Ka.App.xa.mode?32:8;n.AFrameworkApplication.ya.processAction(Wa.a.Mwb,2);if(2!==Ka.App.xa.mode)return 32;Ka.App.ik.ZVi(null,null);return 32};class Zt{constructor(){this.activateRibbonTab=(b,k,r,y,R)=>{Ka.App.Ev.eI.g5d(R.toString());return 32};this.zsm=(b,k,r,y,R)=>{n.AFrameworkApplication.Gaa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Ka.App.Ev.eI.Fki(1,R.toString());return 32};this.N_m=(b,k)=>{if(k.contextId!==
zc.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.activateRibbonTab,lc.a.view,this.activateRibbonTab);b.Vc(Wa.a.activateRibbonTab,5);b.pa(Wa.a.Gki,lc.a.view,this.zsm);b.pa(Wa.a.Ocj,zc.a.frame,this.N_m)}static get instance(){return null!=Zt.Jmg?Zt.Jmg:Zt.Jmg=Zt.Hl()}static Hl(){return new Zt}}Object(m.a)(Zt,"RibbonActor",null,[]);var dr=c(568);class ds{constructor(b,k){this.xm=null;this.Vgo=(r,y,R,aa,ta)=>{let Ya;aa=y.view;if(!aa.ye)return ds.Kc.Zb($c.a.vf,
{["Reason"]:bd.a.sGb}),8;Ya=r===Wa.a.undo?this.zi.EZ:this.zi.pMa;if(1===R)return Me.a.ufa(y)&&Me.a.K6b()?8:Ya?32:8;if(!Ya)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===Wa.a.undo?"undo":"redo"),this.xGa.value.tgj(),ds.Kc.Zb($c.a.vf,{["Reason"]:bd.a.Rgo}),2;y=new sf.GraphTransaction(3);y.Eb(aa.ld);y.ZXf();r=r===Wa.a.undo?this.zi.undo():this.zi.redo();y.dispose();ta&&pu.GrippersManager.instance.PMb(ta.$w);if(r)return 32;ds.Kc.Zb($c.a.A0b,{["Reason"]:bd.a.hvi});
return 8};this.Cja=b;this.xGa=k}get zi(){return this.xm||(this.xm=this.Cja())}Vb(){const b=n.AFrameworkApplication.ya,k=this.Vgo;b.gb(Wa.a.undo,lc.a.view,k,1028);b.gb(Wa.a.redo,lc.a.view,k,1028)}static get instance(){return null!=ds.qmg?ds.qmg:ds.qmg=ds.Hl()}static Hl(){const b=Va.a.instance;return new ds(()=>b.resolve("Box4.IUndoManager"),b.Ze("Box4.ICoauthCashTelemetry"))}static get Kc(){return Db.a.instance}}Object(m.a)(ds,"UndoActor",null,[]);class Yu{constructor(){this.W=null}get name(){return"Box4.Actors"}zc(b){this.W=
b;(new Ej).zc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");b.Vb();b.y3();rp();Gr.instance.Vb();of.Vb();dm.Vb();Yj.Vb();this.W.resolve("Box4.Actors.TouchInputActor").Vb();it.instance.Vb();this.W.resolve("Box4.ISelectAllHandlers").Vb();Sx();gh.a.instance.J(9)&&this.W.resolve("Box4.Actors.ProofingActor").Vb();Zt.instance.Vb();(b=this.W.Pa("Box4.IFeatureHelper"))?b.io.continueWith(()=>{this.QNi()}):this.QNi();dr.a.Vb(Ka.App.a4a);this.W.resolve("Box4.Actors.TextFormattingActor").Vb();ds.instance.Vb();
this.W.resolve("Box4.Actors.AccessibilityActor").JRf();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Ka.App.xa.updateCommandUI()}QNi(){gh.a.instance.J(10)&&(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdateStyleContextMenuEnabled",!1)&&this.W.resolve("Box4.Actors.StyleContextMenuActor").Vb(),this.W.resolve("Box4.Actors.StyleActor").Vb())}dispose(){}static main(){M.a.instance.Pc(new Yu)}}
Object(m.a)(Yu,"Box4ActorsPackage",null,[1,2]);class jw extends Tu{constructor(b,k,r,y){super(b);this.cla=r;this.Oga=y;this.nbg=0;this.jx=k.UNa("UserAction","WordOnlineAddToDictionary")}s_f(b){this.wBd=this.cla.Ala(b);if(!this.nvk())return!1;const k=this.wBd.errorDetails.token;this.Oga.U$g(k);if(!this.Oga.g2c(k))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");
this.jx.start();this.transaction=new sf.GraphTransaction(15);this.transaction.Eb(b.node);return!0}V0d(b){this.bIb(b.node);return!0}FVc(b){this.bIb(b);return!0}W0d(b){this.bIb(b.node)}j5f(b){this.transaction.dispose();this.wBd.errorDetails.fmb(b.actionId);this.Oga.J5d("unused corelation id.");this.jx.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.nbg,this.jx.ri,this.wBd.errorDetails.proofingType));
return!0}yfc(b,k){const r=b.role;return super.yfc(b,k)||9===r||10===r||13===r||7===r||8===r}bIb(b){if(b){var k=this.cla.q2(b,r=>this.Oga.g2c(r.errorDetails.token));this.cla.Qjb(b,k,!0);this.nbg+=k.length}}nvk(){var b,k;return null!==(k=null===(b=this.wBd)||void 0===b?void 0:b.errorDetails)&&void 0!==k&&k.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(jw,"AddToDictionaryCallbackSteps",Tu,[]);class yv{constructor(b,
k,r,y,R,aa,ta){this.wc=b;this.Cb=k;this.MZc=r;this.cla=y;this.kq=R;this.Oga=aa;this.Wcn=ta;this.xTl=(Ya,xb,Mb,cc,jc,Mc)=>{const fd=new jw(this.MZc,this.kq,this.cla,this.Oga);return new No(Ya,xb,Mb,cc,jc,Mc,fd,this.wc,this.Cb,this.MZc,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Vb(){this.wc.vS(Wa.a.addToDictionary,lc.a.view,this.xTl,1124);this.Wcn.Dpn(this.Oga)}}Object(m.a)(yv,"PersonalDictionaryOrchestrator",null,[]);class Zu{get name(){return"Box4.PersonalDictionary"}zc(b){this.container=
b;b.register(yv,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Zd(()=>new yv(n.AFrameworkApplication.ya,bh.a.instance,or.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Vb()}dispose(){}static main(){kj.a.get_instance().Gl(7,()=>{M.a.instance.Pc(new Zu)})}}
Object(m.a)(Zu,"PersonalDictionaryPackage",null,[1,2]);class es{constructor(b,k,r,y,R,aa){this.iya=this.h6a=this.VU=null;this.GAc=(ta,Ya,xb,Mb,cc)=>this.Cii(Ya,xb,cc,!1)?32:8;this.cI=(ta,Ya,xb,Mb,cc)=>{if(!({Ix:ta}=this.f4i(Ya,xb,cc,!0)).returnValue)return ta;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");cc=this.nZj.Zza(Ya.node,cc);this.B6m(Ya.node,cc);this.FO();return 32};this.$wb=(ta,Ya,xb,Mb,cc)=>{if(!({Ix:ta}=this.f4i(Ya,xb,cc,!1)).returnValue)return ta;
this.x6m(Ya.node);return 32};this.den=(ta,Ya,xb,Mb,cc)=>{if(1===xb)return 32;if(!Ya||!Ya.view.ye)return 2;ta=Ya.view.Cb;if(!ta)return 2;ta=ta.Jg;if(!ta)return 2;ta=es.Sg.ZP(ta,16);if(!ta||!ta.length)return 2;Ya=null;for(xb=0;xb<ta.length;xb++){Mb=ta.getContext(xb);if(!Mb||Mb.contextId!==lc.a.tableCell)return 2;const jc={};this.x4h(Mb,jc);if(jc.CellShading)if(Ya&&Ya!==jc.CellShading){Ya=null;break}else Ya=jc.CellShading;else{Ya=null;break}}cc.CellShading=Ya;return 32};this.kIb=(ta,Ya,xb,Mb,cc)=>1===
xb?32:this.x4h(Ya,cc);this.JHb=(ta,Ya,xb,Mb,cc)=>{if(1===xb)return 32;ta=Ya.contextId===lc.a.view?this.Cya.nHd(Ya):this.Sgf(Ya);xb={};Ya=null;32===n.AFrameworkApplication.ya.Xb(Wa.a.kIb,2,xb)&&xb&&(Ya=xb.CellShading);xb="";Ya&&(xb=Uo.a.PC(Ya)||"");this.e3i.Jdc=xb;this.ZOc&&this.recentColors.K9f(xb);ta=this.e3i.fEd(ta,Ka.App.FZb);if(!ta)return 8;cc.MenuItems=ta;v.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.jga=(ta,Ya,xb,Mb,cc)=>{if(1===xb)return 32;Ka.App.xa.tw();
n.AFrameworkApplication.ya.Xb(Wa.a.kIb,2,cc);this.h6a=new Vu.a("Shading",Wa.a.aec);this.h6a.D0c(cc&&cc.CellShading?cc.CellShading:0);return 32};this.guk=(ta,Ya,xb,Mb,cc)=>{if(1===xb)return 32;n.AFrameworkApplication.ya.Xb(Wa.a.H7,2,cc);this.recentColors.X$a(cc)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.nZj=k;this.pze=r;this.Cya=y;this.Jd=R;this.$m=aa}get recentColors(){return null!=this.Rqg?this.Rqg:this.Rqg=Va.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get e3i(){this.VU||
(this.VU=new Wu.a("Shading"),this.VZa(this.VU));return this.VU}VZa(b){b.uda(2,Wa.a.$wb);b.uda(3,Wa.a.H7);b.uda(4,Wa.a.H7);b.tXb(this.pze,1)}Vb(){this.ga.pa(Wa.a.JHb,lc.a.view,this.JHb);this.ga.pa(Wa.a.JHb,lc.a.tableCell,this.JHb);this.ga.Vc(Wa.a.JHb,1126);this.ga.pa(Wa.a.GAc,lc.a.view,dr.a.dHc);this.ga.pa(Wa.a.GAc,lc.a.tableCell,this.GAc);this.ga.Vc(Wa.a.GAc,1028);this.ga.pa(Wa.a.H7,lc.a.view,dr.a.dHc);this.ga.pa(Wa.a.H7,lc.a.tableCell,this.cI);this.ga.Vc(Wa.a.H7,1028);this.ga.pa(Wa.a.$wb,lc.a.view,
dr.a.dHc);this.ga.pa(Wa.a.$wb,lc.a.tableCell,this.$wb);this.ga.Vc(Wa.a.$wb,1028);this.ga.pa(Wa.a.kIb,lc.a.view,this.den);this.ga.pa(Wa.a.kIb,lc.a.tableCell,this.kIb);this.ga.Vc(Wa.a.kIb,1124);this.ga.pa(Wa.a.aec,lc.a.view,dr.a.dHc);this.ga.pa(Wa.a.aec,lc.a.tableCell,this.guk);this.ga.Vc(Wa.a.aec,1028);this.ga.pa(Wa.a.QJf,lc.a.view,this.jga);this.ga.Vc(Wa.a.QJf,1028)}FO(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=
Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}f4i(b,k,r,y){return this.Cii(b,k,r,y)?{returnValue:2===k,Ix:32}:(2==k&&dr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],bd.a.x8k),{returnValue:!1,Ix:8})}Cii(b,k,r,y){return b.contextId!==lc.a.tableCell||2===k&&(y&&!r||!b.node)?!1:!0}B6m(b,k){const r=new sf.GraphTransaction(15);r.Eb(b);this.U1i(b);b.properties.setValue(Te.a.cI,
k);r.dispose()}x6m(b){const k=new sf.GraphTransaction(15);k.Eb(b);this.U1i(b);b.properties.removeProperty(Te.a.cI);k.dispose()}Sgf(b){return b.contextId!==lc.a.tableCell?null:(b=es.qh.pu(b.node))?b:null}U1i(b){if(this.Jd&&this.Jd.og&&(b=Object(ia.a)(Tt.TableCellNode,b))){const k=b.SQ();this.$m.Q_c(b,k)}}x4h(b,k){if(b.contextId!==lc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(Te.a.cI)&&(k.CellShading=b.getValue(Te.a.cI));return 32}static Aml(){return new es(n.AFrameworkApplication.ya,Ti.a.instance,
Uu.a.instance,De.PageReader.instance,Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get qh(){return lk.PageNavigator.instance}static get Sg(){return null!=es.Jig?es.Jig:es.Jig=tm.ContextSetEditor.instance}static get instance(){return null!=es.Lng?es.Lng:es.Lng=es.Aml()}get ZOc(){null==this.iya&&(n.AFrameworkApplication.Ne("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.iya=
n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.iya}}Object(m.a)(es,"CellShadingActor",null,[]);class fs{constructor(){this.W=null}get name(){return"Box4.CellShading"}zc(b){this.W=b}init(){const b=this.W.Pa("Box4.IFeatureHelper");b?b.io.continueWith(()=>{this.Wm()}):this.Wm()}Wm(){es.instance.Vb();Ka.App.xa.updateCommandUI()}dispose(){}}Object(m.a)(fs,"CellShadingPackage",null,[1,2]);var qq;
(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(qq||(qq={}));Object(m.b)("ListStyle",qq);const tu={[qq.style1]:{[1]:"disc",[0]:"decimal"},[qq.style2]:{[1]:"circle",[0]:"lower-alpha"},[qq.style3]:{[1]:"square",[0]:"lower-roman"},[qq.style4]:{[0]:"upper-alpha"},[qq.style5]:{[0]:"upper-roman"},[qq.bullet]:{[1]:"bullet"}};var jt;(function(b){b[b.number=
0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(jt||(jt={}));Object(m.b)("ListType",jt);var kw=c(654);class yp{constructor(b,k){this.QA=this.NQc=null;this.levelText=b;this.font=k}get L0d(){return this.levelText}get listStyle(){return 6}get Zs(){return"left"}}Object(m.a)(yp,"ListMarkerBullet",null,[483]);class fi{static get No(){return null!=fi.Hog?fi.Hog:fi.Hog=Va.a.instance.resolve("Box4.List.IListEditor")}static get hd(){return fi.Cf||
(fi.Cf=Va.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){fi.Cf=b}static get Uj(){return null!=fi.jmg?fi.jmg:fi.jmg=Va.a.instance.resolve("Box4.IInsertionPointFormatting")}static xw(){return fi.Km||(fi.Km=Va.a.instance.$a("Box4.IExternalSelectionManager"))}static get Sg(){return tm.ContextSetEditor.instance}static get ag(){return mh.a.instance}static get Kc(){return Db.a.instance}static get ae(){return op.a.getInstance()}static get ilb(){return null!=fi.trg?fi.trg:fi.trg=Va.a.instance.Pa("Box4.List.ISingleLevelListEditor")}static Vb(){const b=
n.AFrameworkApplication.ya;b.pa(Wa.a.dA,lc.a.view,fi.ezc);b.pa(Wa.a.dA,lc.a.outlineElement,fi.Mra);b.Vc(Wa.a.dA,1036);b.pa(Wa.a.wH,lc.a.view,fi.ezc);b.pa(Wa.a.wH,lc.a.outlineElement,fi.Mra);b.Vc(Wa.a.wH,1036);fi.hd.yr&&(b.pa(Wa.a.Laa,lc.a.view,fi.ezc),b.pa(Wa.a.Laa,lc.a.outlineElement,fi.Mra),b.Vc(Wa.a.Laa,1036));b.pa(Wa.a.IRe,lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.ooh,lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.joinList,lc.a.view,fi.Cyn);b.pa(Wa.a.sRe,lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.JRe,
lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.o4f,lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.gaj,lc.a.view,Kd.ActionManager.Of);b.pa(Wa.a.uce,lc.a.view,Kd.ActionManager.Of)}static Cyn(){kw.a.cTi();return 32}static ezc(b,k,r,y,R){var aa,ta;if(!k.view.ye)return 2;const Ya=fi.Kc.qo(Wa.a.ezc);y.Mr=42;y.BB=42;const xb={[pq.a.RFa]:5796,[pq.a.QFa]:5797};var Mb=k.view;if(fi.Sg.jAa(fi.t1l,Mb.Cb.Jg))return fi.Kc.Zb($c.a.vf,{["Reason"]:bd.a.CZe}),Ya.end(),8;if(fi.Sg.jAa(fi.UQe,Mb.Cb.Jg))return fi.Kc.Zb($c.a.vf,{["Reason"]:bd.a.cCc}),
Ya.end(),8;if(fi.Sg.Swa(ie.ParagraphReader.HT,Mb.Cb.Jg))return fi.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),Ya.end(),8;if(fi.ag.t6b(Mb.Cb.Jg))return fi.Kc.Zb($c.a.vf,{["Reason"]:bd.a.dE}),Ya.end(),8;if(null===(ta=null===(aa=fi.xw())||void 0===aa?void 0:aa.instance)||void 0===ta?0:ta.KT(k))return fi.Kc.Zb($c.a.vf,{["Reason"]:bd.a.externalSelection}),Ya.end(),8;if(1===r)return Ya.end(),32;R||(R=new Di.DictionaryPropertySet);aa=null;if(2===r){aa=new sf.GraphTransaction(15);aa.Eb(k.view.ld);fi.zPc=!1;ta=Xt.OutlineElementGeneralizer.qla(Mb.Cb.ib,
!1);if(!ta)return aa.dispose(),fi.Kc.Zb($c.a.hla,{["Reason"]:bd.a.dCd}),Ya.end(),8;1<ta.length&&R.setValue(td.a.ADf,null);const jc=R.ia(td.a.NI,-1),Mc=R.ia(td.a.Rv,-1);fi.ae.iEb&&fi.ilb&&fi.ilb.Fwk(ta);var cc=fi.JUn(jc,Mc,ta);cc&&(R.setValue(td.a.Rv,16),R.setValue(td.a.Dua,0));if(!rf.SelectionEditor.zf(Mb.Cb.Jg)&&!cc&&0<ta.length&&jc){Mb=new Wd.GraphIterator;cc=Array(ta.length);for(let fd=0;fd<ta.length;fd++)Mb.set(ta.getContext(fd).node),cc[fd]=fi.hd.Gs(Mb);fi.IUn(cc,R)&&(Mb=new Di.DictionaryPropertySet,
Mb.setValue(td.a.Rv,16),Mb.setValue(td.a.Dua,0),op.a.aX&&(Mb.setValue(Gh.a.Xma,"clean-list-before-apply-new-list-style"),Mb.setValue(Gh.a.Hfa,R.ia(Gh.a.Xma,"unknown")+"@"+R.ia(Gh.a.Hfa,"undefined"))),pq.a.Fna(b,k,r,y,Mb,xb,11),n.AFrameworkApplication.ya.processAction(Wa.a.gaj,2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),fi.zPc=!0)}Mb=new Wd.GraphIterator;Mb.set(ta.getContext(0).node);Mb=fi.hd.Gs(Mb);fi.KAm(jc,Mc,Mb,ta.length)}b=pq.a.Fna(b,k,r,y,R,xb,11);
32===b&&R.ia(td.a.ogh,!1)&&(b=pq.a.Fna(Wa.a.FN,k,r,y,R,xb,11));aa&&aa.dispose();Ya.end();return b}static IUn(b,k){let r=null;var y=!1;for(let R=b.length-1;0<=R&&(r?(y=b[R],y=-1!==k.ia(td.a.NI,-3)?y?r.listType!==y.listType||r.listStyle!==y.listStyle:!0:y?r.listType!==y.listType:!0):r=b[R],!y);R--);return r&&(b=!1,y||(b=k.ia(td.a.Rv,42),k=k.ia(td.a.NI,-3),b=b!==r.listType||0<k),y||b)?!0:!1}static KAm(b,k,r,y){0>=y||fi.zPc||(b?r?(r=r.listType,-1===b&&k===r?(n.AFrameworkApplication.ya.processAction(Wa.a.uce,
2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!k||1===k)&&(n.AFrameworkApplication.ya.processAction(k?Wa.a.sRe:Wa.a.JRe,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",k?"Bullet":"Numbering"))):(n.AFrameworkApplication.ya.processAction(k?Wa.a.sRe:Wa.a.JRe,2),fi.Pdo(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",k?"Bullet":"Numbering")):(n.AFrameworkApplication.ya.processAction(Wa.a.uce,2),v.ULS.sendTraceTag(39715533,
393,50,"List Actions: Clean List Style - None list style")))}static JUn(b,k,r){if(-1!==b&&b||!r.length)return!1;b=new Wd.GraphIterator;let y=null;for(let R=r.length-1;0<=R&&!(b.set(r.getContext(R).node),y=fi.hd.Gs(b));R--);return y&&k===y.listType?!0:!1}static Mra(b,k,r,y,R){if(k.contextId!==lc.a.outlineElement)return 2;var aa=k.clone().r2f();if(fi.ag.R_a(aa))return fi.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),2;const ta=new Wd.GraphIterator;ta.set(k.node);rf.SelectionEditor.Pt(ta);if(!Ag.OutlineElementReader.Nh(ta))return 2;
if(1===r)switch(b){case Wa.a.dA:return 32;case Wa.a.wH:return 32;case Wa.a.Laa:return 32;default:return 2}if(Ag.OutlineElementReader.EP(ta))return fi.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.uN}),2;k=fi.hd.Gs(ta);var Ya;op.a.aX&&(Ya=Object.freeze(null===k||void 0===k?void 0:k.clone()));let xb=R;if(!xb)return 8;!Vh.ListReader.sr&&b===Wa.a.wH&&ta.dH()&&(ta.fq(4)||xb.setValue(td.a.GNa,1),ta.xj());fi.hd.yr?(b===Wa.a.wH||b===Wa.a.dA||b===Wa.a.Laa?(xb=fi.No.l1b(b,xb),aa=Os.a.KP(xb.getValue(td.a.Rv),xb.getValue(td.a.Dua))):
aa=null,fi.YZ(b,xb),fi.iOn(aa,xb)):(xb=fi.No.l1b(b,xb),aa=Os.a.KP(xb.getValue(td.a.Rv),xb.getValue(td.a.Dua)));Vh.ListReader.sr||(aa.$z=xb.ia(Te.a.jX,bg.a.Yi));let Mb=!1;b===Wa.a.dA&&xb&&(xb.hasProperty(wc.a.Vr)&&(aa.levelText=xb.ia(wc.a.Vr,"")),xb.hasProperty(Te.a.font)&&(aa.font=xb.ia(Te.a.font,"")),xb.hasProperty(td.a.eaf)&&(Mb=xb.ia(td.a.eaf,!1)));fi.VPn(xb,ta);aa=fi.No.Mra(xb,ta,aa,Mb);if(!aa.returnValue)return fi.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.ixf}),2;aa=aa.eCa;op.a.aX&&fi.Ckn(R,Ya,aa);2===
r&&(r=R.ia(td.a.Rv,-1),aa&&-1!==r&&((Ya=R.ia(wc.a.xr,"Invalid MultiLevel Type"),b===Wa.a.wH&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===R||void 0===R?void 0:R.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:qq[null==(null===k||void 0===k?void 0:k.listStyle)?null===aa||void 0===aa?void 0:aa.listStyle:null===k||void 0===k?void 0:k.listStyle],["listType"]:jt[null==(null===k||void 0===k?void 0:k.listType)?
null===aa||void 0===aa?void 0:aa.listType:null===k||void 0===k?void 0:k.listType],["cleared"]:16===(null===aa||void 0===aa?void 0:aa.listType)})),k)?aa.listType&&1!==aa.listType||fi.zPc||(n.AFrameworkApplication.ya.processAction(Wa.a.o4f,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":"Numbering",Ya)):16===aa.listType?(n.AFrameworkApplication.ya.processAction(Wa.a.ooh,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",
r?"Bullet":"Numbering",Ya)):aa.listType&&1!==aa.listType||fi.zPc||(n.AFrameworkApplication.ya.processAction(Wa.a.IRe,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",Ya))),(b=Id.FocusManager.instance())&&b.pg&&b.pg.name===Rh.AppFrame.coa&&b.iC(id.AFrame.Wo));y.Mr=aa.listType;y.BB=aa.listStyle;return 32}static Ckn(b,k,r){var y,R,aa,ta,Ya,xb,Mb,cc;const jc=new Map;jc.set("actionCallSource",b.ia(Gh.a.Xma,"unknown"));jc.set("actionCallSourceTrigger",
b.ia(Gh.a.Hfa,"undefined"));jc.set("fromListType",jt[null!==(y=null===k||void 0===k?void 0:k.listType)&&void 0!==y?y:16]);jc.set("fromListStyle",qq[null!==(R=null===k||void 0===k?void 0:k.listStyle)&&void 0!==R?R:0]);jc.set("fromListMarkerType",null!==(Ya=a(null!==(aa=null===k||void 0===k?void 0:k.listStyle)&&void 0!==aa?aa:0,null!==(ta=null===k||void 0===k?void 0:k.listType)&&void 0!==ta?ta:16))&&void 0!==Ya?Ya:"undefined");jc.set("fromLevelText",(null===k||void 0===k?0:k.bfa)?k.levelText:"undefined");
jc.set("toListType",null!==(xb=jt[null===r||void 0===r?void 0:r.listType])&&void 0!==xb?xb:"undefined");jc.set("toListStyle",null!==(Mb=qq[null===r||void 0===r?void 0:r.listStyle])&&void 0!==Mb?Mb:"undefined");jc.set("toListMarkerType",null!==(cc=a(null===r||void 0===r?void 0:r.listStyle,null===r||void 0===r?void 0:r.listType))&&void 0!==cc?cc:"undefined");jc.set("toLevelText",(null===r||void 0===r?0:r.bfa)?r.levelText:"undefined");Ga.Health.instance.recordKpiUsage(bg.a.jQc.xum,0,bg.a.LB,jc)}static VPn(b,
k){var r=new Wd.GraphIterator;r.ed(k);(k=r.Pb(2))&&ie.ParagraphReader.nc(k)&&(r=bh.a.instance.ib.kb)&&r.Qa&&r.Qa.node===k&&rf.SelectionEditor.DQd(r)&&(fi.yMn(b),fi.vMn(b))}static iOn(b,k){k.hasProperty(wc.a.xr)&&b.o7d(k.getValue(wc.a.xr));k.hasProperty(Gh.a.uP)&&(b.uP=k.getValue(Gh.a.uP));k.hasProperty(wc.a.Vr)&&(b.levelText=k.getValue(wc.a.Vr));b.NI=k.ia(td.a.NI,-1);let r=null;b.Kma&&(r=fi.Bzl(b,k));b.Kma&&r?fi.QPn(b,r):(b.Kma?v.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
b.NI,b.xr,b.ur):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),fi.jLn(b))}static jLn(b){if(b.ur)b.WKd&&-1===b.NI||(b.levelText="%1.",b.propertySet.hasProperty(Te.a.h3)||b.L7(0,1));else if(1===b.listType)b.WKd&&-1===b.NI||(b.font=bg.a.FDc,b.levelText=bg.a.Oyd,b.propertySet.hasProperty(Te.a.h3)||b.L7(1,6));else return;b.Zs="left"}static QPn(b,k){1===b.xr?fi.DOn(b,k):fi.aNn(b,k)}static DOn(b,k){(b.QA=k.QA)?b.b4=k.QA.b4:k.QA||v.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.NI,b.xr,b.ur)}static aNn(b,k){b.levelText=k.levelText;b.ur?b.L7(0,k.listStyle):(b.font=k.font,b.L7(1,1));b.Zs=k.Zs}static Bzl(b,k){let r=null;2===b.xr?r=b.ur?Va.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Va.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.xr&&(r=Va.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let y=r.jFb.value;
const R=b.NI+"";R in y||(y=r.Y6,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",R,b.xr,b.ur));if(!(R in y)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",R,b.xr,b.ur);if(k.hasProperty(Te.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
R,b.xr,b.ur),b=k.ia(Te.a.font,""),new yp(A.a.fromCharCode(parseInt(R)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",R,b.xr,b.ur)}return y[R]}static vMn(b){fi.Uj.hasProperty(Te.a.fontColor)&&b.setValue(Te.a.fontColor,fi.Uj.fontColor())}static yMn(b){fi.Uj.hasProperty(Te.a.fontSize)&&b.setValue(Te.a.fontSize,fi.Uj.fontSize())}static YZ(b,k){b=b===Wa.a.dA?0:b===Wa.a.wH?1:b===Wa.a.Laa?2:-1;k=k.ia(td.a.NI,-1);v.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",b,k)}static Pdo(){const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");if(b){var k=n.AFrameworkApplication.K.rc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},k)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}fi.t1l=Pd.ImageReader.eOc;fi.UQe=Pd.ImageReader.k_a;fi.Cf=null;
fi.Km=null;fi.zPc=!1;Object(m.a)(fi,"ListActor",null,[]);class vs{constructor(){this.jFb=new cg.a(Object(u.a)(this,this.H0e,"createListMarkerDictionary"));this.Y6={}}KMh(b){return b}}Object(m.a)(vs,"AListMarkerGalleryLoader",null,[484]);var ws=c(1340),$t=c(438);class zo extends vs{constructor(){super();this.vrb=new kb.a(ka.a.Sj())}KMh(b){zo.vP||this.eKn();b in zo.vP&&(b=zo.vP[b]);return b}H0e(){const b={};b["0"]=new yp(Box4Intl.Box4Strings.L_ListStyleNone,ws.a.zai);b["1"]=new yp(String.fromCharCode(61623),
"Symbol");b["2"]=new yp(String.fromCharCode(111),"Courier New");b["3"]=new yp(String.fromCharCode(61607),"Wingdings");b["4"]=new yp(String.fromCharCode(9643),"Courier New");b["5"]=new yp(String.fromCharCode(61611),"Wingdings");b["6"]=new yp(String.fromCharCode(61614),"Symbol");b["7"]=new yp(String.fromCharCode(61483),"Symbol");b["8"]=new yp(String.fromCharCode(61485),"Symbol");b["9"]=new yp(String.fromCharCode(9830),"Courier New");b["10"]=new yp(String.fromCharCode(61664),"Symbol");b["11"]=new yp(String.fromCharCode(61558),
"Wingdings");b["12"]=new yp(String.fromCharCode(61656),"Wingdings");b["13"]=new yp(String.fromCharCode(61514),"Wingdings");b["14"]=new yp(String.fromCharCode(61516),"Wingdings");b["15"]=new yp(String.fromCharCode(61692),"Wingdings");b["16"]=new yp(String.fromCharCode(61691),"Wingdings");b["17"]=new yp(String.fromCharCode(61553),"Wingdings");return b}hde(b){b&&b.length&&this.VUe(b)}fNf(){if(this.Y6){var b=$t.a(this.Y6),k=b.length;for(let r=0;r<k;r++){const y=this.Y6[b[r]];this.vrb.add(y.levelText+
"_"+y.font)}}}VUe(b){this.fNf();for(const k of b)if(k&&!k.ur&&k.bfa&&k.G4b&&(b=k.levelText+"_"+k.font,!this.vrb.contains(b))){const r=$t.a(this.Y6).length+$t.a(this.jFb.value).length+"";this.Y6[r]=new yp(k.levelText,k.font);this.vrb.add(b)}}eKn(){zo.vP={};zo.vP["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;zo.vP["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;zo.vP["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;zo.vP["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;
zo.vP["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;zo.vP["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;zo.vP["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;zo.vP["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;zo.vP["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;zo.vP["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;zo.vP["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;zo.vP["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;zo.vP["Wingdings 0x004a"]=
Box4Intl.Box4Strings.L_SmilingFace;zo.vP["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;zo.vP["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;zo.vP["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;zo.vP["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}zo.vP=null;Object(m.a)(zo,"ListMarkerBulletLoader",vs,[]);class Xo{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Xo,"InfoAtLevel",null,[]);class kt{constructor(b){this.QA=b}get font(){return"Calibri"}get listStyle(){return 42}get Zs(){return"left"}get L0d(){return this.QA?
this.Z$m():this.aan()}get NQc(){return this.QA?this.$$m():null}get levelText(){return""}$tl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Z$m(){let b="";for(let k=0;3>k;k++)b+=this.uJc(k);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',kt.tdf(),b)}$$m(){const b=[];for(let k=0;3>k;k++)b.push(Object.assign(new Xo,{textAtLevel:this.oYh(k),styleAtLevel:this.ZLl(k)}));return b}aan(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
kt.udf(),Box4Intl.Box4Strings.L_ListStyleNone)}oYh(b){b=this.QA.OQc[b];for(let k=0;9>k;k++)b=A.a.replaceAll(b,"%"+(k+1),this.$tl(this.QA.lFb[k]));return b}ZLl(b){const k={};k.fontFamily=6===this.QA.lFb[b]?this.QA.gBa[b]:this.font;return k}uJc(b){const k=this.oYh(b),r=new Sys.StringBuilder;6===this.QA.lFb[b]&&r.append(String.format("font-family:{0};",this.QA.gBa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),k)}static tdf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static udf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(kt,"ListMarkerMultilevel",null,[483]);var Pq=c(773);class Ux extends vs{constructor(){super()}H0e(){const b=new Pq.a,k={};k["0"]=new kt(null);k["1"]=new kt(b.a0e());k["2"]=new kt(b.T0e("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));k["3"]=new kt(b.ruh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return k}hde(){}}Object(m.a)(Ux,"ListMarkerMultilevelLoader",vs,[]);var Oo=c(146);class Yo{constructor(b,k){this.QA=null;this.levelText=b;this.tfd=k}get font(){return"Calibri"}get listStyle(){return this.tfd}get Zs(){switch(this.tfd){case 3:case 5:return"right";default:return"left"}}get L0d(){switch(this.tfd){case 1:return this.ubc("1",
"2","3");case 2:return this.ubc("a","b","c");case 3:return this.ubc("i","ii","iii");case 4:return this.ubc("A","B","C");case 5:return this.ubc("I","II","III");case 0:return this.ban();default:return this.ubc("1","2","3")}}get NQc(){const b=[],k={};k.fontFamily=Oo.FontUtils.nAa(this.font);switch(this.tfd){case 1:return b.push(Object.assign(new Xo,{textAtLevel:this.EW("1"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("2"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("3"),
styleAtLevel:k})),b;case 2:return b.push(Object.assign(new Xo,{textAtLevel:this.EW("a"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("b"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("c"),styleAtLevel:k})),b;case 3:return b.push(Object.assign(new Xo,{textAtLevel:this.EW("i"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("ii"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("iii"),styleAtLevel:k})),b;case 4:return b.push(Object.assign(new Xo,
{textAtLevel:this.EW("A"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("B"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("C"),styleAtLevel:k})),b;case 5:return b.push(Object.assign(new Xo,{textAtLevel:this.EW("I"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("II"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("III"),styleAtLevel:k})),b;case 0:return null;default:return b.push(Object.assign(new Xo,{textAtLevel:this.EW("1"),
styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("2"),styleAtLevel:k})),b.push(Object.assign(new Xo,{textAtLevel:this.EW("3"),styleAtLevel:k})),b}}ubc(b,k,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Yo.tdf(),this.uJc(b),this.uJc(k),this.uJc(r))}ban(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Yo.udf(),Box4Intl.Box4Strings.L_ListStyleNone)}uJc(b){b=this.EW(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}EW(b){return A.a.replaceAll(this.levelText,"%1",b)}static tdf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static udf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Yo,"ListMarkerNumbering",null,[483]);class Zw extends vs{constructor(){super();this.vrb=new kb.a(ka.a.Sj())}Gmm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}H0e(){const b=
{};b["0"]=new Yo(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Yo("%1.",5);b["2"]=new Yo("%1.",4);b["3"]=new Yo("%1.",1);b["4"]=new Yo("%1.",2);b["5"]=new Yo("%1.",3);b["6"]=new Yo("%1)",5);b["7"]=new Yo("%1)",4);b["8"]=new Yo("%1)",1);b["9"]=new Yo("%1)",2);b["10"]=new Yo("%1)",3);b["11"]=new Yo("(%1)",5);b["12"]=new Yo("(%1)",4);b["13"]=new Yo("(%1)",1);b["14"]=new Yo("(%1)",2);b["15"]=new Yo("(%1)",3);return b}hde(b){b&&b.length&&this.VUe(b)}fNf(){if(this.Y6){var b=$t.a(this.Y6),k=b.length;
for(let r=0;r<k;r++){const y=this.Y6[b[r]];this.vrb.add(y.levelText+"_"+y.listStyle)}}}VUe(b){this.fNf();for(const k of b)if(k&&k.ur&&k.bfa&&this.Gmm(k.levelText)&&k.listStyle&&(b=ws.a.Taf(k.levelText))){const r=b+"_"+k.listStyle;if(!this.vrb.contains(r)){const y=$t.a(this.Y6).length+$t.a(this.jFb.value).length+"";this.Y6[y]=new Yo(b,k.listStyle)}this.vrb.add(r)}}}Object(m.a)(Zw,"ListMarkerNumberingLoader",vs,[]);class lw{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){fi.Vb()}dispose(){}zc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new zo).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Zw).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new Ux).singleInstance()}static main(){M.a.instance.Pc(new lw)}}Object(m.a)(lw,"Box4ListMarkerPackage",null,[1,2]);class $u{static get vg(){return yf.a.Rx($u.tl,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}$u.tl="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)($u,"DefineNewBulletDialogHtml",null,[]);class sr extends yf.a{constructor(b,k,r,y){super();this.grc=this.nye=this.BSb=this.uSb=null;this.csb=0;this.vzc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.l9h=!0;this.uTk=R=>{if(this.uSb&&R.target!==this.uSb){const aa=this.$h.Fs();aa&&aa.Wj&&(aa.Wj.qy(R.target),this.uSb=R.target)}this.yZm(R.target.id)};this.cum=R=>{R=R.Af;if(!this.gki(R))return!1;this.$h.Fs().Wj.qy(R);R.focus();return!0};this.dum=R=>{var aa=R.Af;if(!this.gki(aa))return!1;
var ta=aa.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.csb;if(R.Ib.ctrlKey||R.Ib.altKey||R.Ib.keyCode>=tb.a.ONb&&R.Ib.keyCode<=tb.a.PNb)return!1;const Ya=R.Ib.keyCode;if(R.eventName===Kb.a.ni){R=-1;if(Ya===Sys.UI.Key.enter)return this.$h.Fs().Wj.qy(aa),aa.focus(),this.hzi(aa.id),this.hide(),!0;Ya===Sys.UI.Key.up?R=ta-17:Ya===Sys.UI.Key.down?R=ta+17:Ya===Sys.UI.Key.left?R=n.AFrameworkApplication.isRtl?ta+1:ta-1:Ya===Sys.UI.Key.right&&(R=n.AFrameworkApplication.isRtl?ta-1:ta+1);0<=R&&(aa=this.fVh(sr.h0b+
"_"+(R+this.csb)))&&aa.focus()}return!0};this.tTk=R=>{1===R&&this.hzi(this.BSb);this.hide()};this.pp=b;this.$h=k;this.ga=r;this.WK=!1;y&&(b=y.indexOf(","),-1!==b&&(y=y.substring(0,b)));this.fontName=y;this.lg="DefineNewBulletDialog";this.vg=$u.vg;this.We(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.We(0,CommonUIStrings.l_DialogClose);this.Vh(Box4Intl.Box4Strings.L_SymbolSingle,this.tTk,null);this.K8=!1;this.$Da();document.getElementById(sr.BDd).focus()}$Da(){this.$h.Fs().scope.Er(Id.FocusManager.instance().EV);
this.$h.Fs().scope.Er(Id.FocusManager.instance().FV);this.$h.Fs().scope.bindAction(Id.FocusManager.instance().EV,Wa.a.Yyd);this.$h.Fs().scope.bindAction(Id.FocusManager.instance().FV,Wa.a.Xyd)}eU(){this.otd(sr.BDd,"DefineNewBulletFontPlaceholder",Wa.a.Wyd.toString(),Wa.a.oIb.toString(),Wa.a.hVc.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.Pmk()}vO(){super.vO();document.getElementById(this.pj("WACDialogPanel")).style.width="auto"}otd(b,k,r,y,R,aa,ta){r=Rf.c(b,r,!0,!0,y,R,A.a.Ff(aa),!0,
ta);this.Exd(b,k,r,"Medium")}Pmk(){const b=document.getElementById(sr.h0b);b&&(b.innerHTML=this.PQh(),this.zNi(b))}zNi(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let k=0;k<b.length;k++)Af.a.addHandler(b[k],Kb.a.focus,this.uTk)}llo(){var b=document.getElementById(sr.h0b);if(b){let k=this.fontName;const r=ws.a.Epf(this.fontName);r&&61472!==this.csb||!r&&32!==this.csb?(b.innerHTML=this.PQh(),this.zNi(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&k&&(k=this.f$g(k),b[0].style.fontFamily=
k)}}yZm(b){this.E0i(this.BSb,!1);this.BSb=b;this.E0i(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.BSb){let k=parseInt(this.BSb.substr(this.BSb.lastIndexOf("_")+1));-1!==k&&(k-=61472===this.csb?61440:0,b.innerText=A.a.iI(k,4))}}E0i(b,k){(b=this.fVh(b))&&(k?b.setAttribute("selected","true"):b.removeAttribute("selected"))}fVh(b){const k=document.getElementById(sr.h0b);return k?k.querySelector("#"+b):null}Wja(){const b=document.getElementById(sr.h0b);b&&(this.nye||(this.nye=this.cum,
this.oq.mb(Kb.a.click,b,this.nye)),this.grc||(this.grc=this.dum,this.le.mb(Kb.a.ni,b,this.grc),this.le.mb(Kb.a.Kt,b,this.grc),this.le.mb(Kb.a.oh,b,this.grc)));super.Wja()}gki(b){return b.classList.contains("DefineNewBulletTableCell")}hzi(b){if(b){b=b.split("_");const k=new Di.DictionaryPropertySet;k.setValue(td.a.NI,parseInt(b[1]));k.setValue(Te.a.font,this.fontName);k.setValue(td.a.Rv,1);op.a.aX&&(k.setValue(Gh.a.Xma,"command-ui"),k.setValue(Gh.a.Hfa,"define-new-bullet-dialog"));this.ga.Xb(Wa.a.dA,
2,k)}this.$h.zK(this.$J,!0)}PQh(){const b=new Sys.StringBuilder,k=ws.a.Epf(this.fontName);let r=this.fontName;r=this.f$g(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));k?(this.csb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.csb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}f$g(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}Exd(b,k,r,y){k=document.getElementById(k);this.pp.rza(b,r);r=this.pp.yYa(b,y);k.appendChild(r);this.pp.iM(b)}dispose(){this.WK||(this.pp.VA(sr.BDd),this.WK=!0);super.dispose()}}sr.BDd="DefineNewBulletFontStyleComboBox";sr.h0b="DefineNewBulletTableContainer";Object(m.a)(sr,"DefineNewBulletDialog",yf.a,[]);class Ss{PIc(){return Wa.a.Ytm}tJc(){return Wa.a.AMf}}Object(m.a)(Ss,"ListMarkerGalleryBulletCommands",
null,[482]);class $w{PIc(){return Wa.a.$tm}tJc(){return Wa.a.r8m}}Object(m.a)($w,"ListMarkerGalleryMultilevelCommands",null,[482]);class uu{PIc(){return Wa.a.aum}tJc(){return Wa.a.BMf}}Object(m.a)(uu,"ListMarkerGalleryNumberingCommands",null,[482]);class zv{constructor(b,k,r,y,R){this.Ixa=this.aIa=null;this.izh=aa=>{if(!this.Ixa)return 2;if(this.Ixa.$h.Fs().Wj.a2.id.startsWith(sr.h0b)){let ta=null;aa===Wa.a.Yyd?ta=this.Ixa.eWa:aa===Wa.a.Xyd&&(ta=document.getElementById(sr.BDd));if(!ta)return 2;this.Ixa.$h.Fs().Wj.qy(ta);
ta.focus()}else if(aa===Wa.a.Yyd)this.Ixa.$h.Fs().d$b();else if(aa===Wa.a.Xyd)this.Ixa.$h.Fs().b$b();else return 2;return 32};this.Emi=(aa,ta)=>{aa=null;ta.view.ye&&(aa=ta.view);return aa&&aa.Cb?32:(Od.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.gsm=(aa,ta,Ya)=>1===Ya?32:2===Ya?(aa=this.T3b(ta),aa=Kk.FormattingReader.Qr(aa).cache.$G,this.Ixa=new sr(this.DXj,Id.FocusManager.instance(),
n.AFrameworkApplication.ya,aa),32):8;this.hVc=(aa,ta,Ya,xb,Mb)=>{if(1===Ya)return 32;if(2===Ya&&!Mb)return 8;if(this.Ixa.l9h){for(aa=0;aa<ws.a.vzc.length;aa++)Oo.FontUtils.Qfj(ws.a.vzc[aa]);this.Ixa.l9h=!1}zj.a.CMd(ta);Mb.PopulationXML=Oo.FontUtils.tMh(zj.a.B8d,zj.a.vaf,Wa.a.Wyd);return 32};this.q8m=(aa,ta,Ya,xb,Mb)=>{aa=ta.contextId===lc.a.outlineElement;if(1===Ya||!aa)return aa?32:8;if(2===Ya&&!Mb)return 8;Mb.MenuItems=this.WMj.Fzl();return 32};this.sTk=(aa,ta,Ya,xb,Mb)=>{if(1===Ya)return 32;if(2===
Ya){aa=Object(ia.a)(25,Mb);if(!aa||!aa.Ed)return 8;this.Ixa.fontName=aa.Ed.fontName;this.Ixa.llo();return 32}return 8};this.ga=b;this.Cf=y.resolve("Box4.List.IListReader");this.a5=k;this.DXj=r;switch(this.a5){case 0:b=y.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.aIa=new Ss;break;case 1:b=y.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.aIa=new uu;break;case 2:b=y.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.aIa=new $w;break;default:b=y.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),
this.aIa=new Ss}R=this.Cf?this.Cf.rzl(R):null;b.hde(R);this.WMj=new ws.a(k,b,R,!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.hEb)}Vb(){this.ga.pa(this.aIa.tJc(),lc.a.view,Ka.App.a4a.Iuh(11));this.ga.pa(this.aIa.tJc(),lc.a.outlineElement,this.q8m);this.ga.Vc(this.aIa.tJc(),1124);this.a5||(this.ga.gb(Wa.a.nwf,lc.a.view,this.gsm,1028),this.ga.gb(Wa.a.hVc,lc.a.view,this.hVc,1124),this.ga.gb(Wa.a.Wyd,lc.a.view,this.sTk,1028),this.ga.gb(Wa.a.Yyd,zc.a.frame,this.izh,64),this.ga.gb(Wa.a.Xyd,
zc.a.frame,this.izh,64));this.ga.pa(this.aIa.PIc(),lc.a.view,this.Emi);this.ga.pa(this.aIa.PIc(),lc.a.outlineElement,this.Emi);this.ga.Vc(this.aIa.PIc(),1124)}T3b(b){return this.NEd(b).Qa}NEd(b){let k=null;b=b.view;return b?k=rf.SelectionEditor.Qj(b.Cb.ib.J(0),!1,!1):k}}Object(m.a)(zv,"ListMarkerGalleryActor",null,[432]);class mw{constructor(){this.Te=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Bb.InteractiveViewManager.instance){var b=Bb.InteractiveViewManager.instance;b.editingView&&
(this.Te=b.editingView.ld,this.von())}}dispose(){}zc(b){this.W=b}von(){(new zv(n.AFrameworkApplication.ya,1,this.W.resolve("Common.IStandaloneRootController").M3,this.W,this.Te)).Vb();(new zv(n.AFrameworkApplication.ya,0,this.W.resolve("Common.IStandaloneRootController").M3,this.W,this.Te)).Vb();(new zv(n.AFrameworkApplication.ya,2,this.W.resolve("Common.IStandaloneRootController").M3,this.W,this.Te)).Vb()}static main(){M.a.instance.Pc(new mw)}}Object(m.a)(mw,"Box4ListMarkerGalleryPackage",null,[1,
2]);var Py=c(341),nw=c(399),Dz=c(366),Wp=c(100);const An=b=>{b.element.style.top=""};var av=c(861);class Qy{constructor(b,k,r){this.JG=!1;this.G6a=0;this.pca=this.AVg=null;this.Rl=b;this.IYj=k;this.ns=r;this.AY=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.gw=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.S2)&&!this.ns.l5e&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";X.a.gj&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.AY}get visible(){return this.JG}set_visible(b){if(this.JG!==b)return(this.JG=b)?this.HSe():this.YDc(),b}dispose(){this.visible&&this.YDc();Fd.a.iZ(this.htmlElement);this.Rl=this.AY=null}U5i(b,k){const r=b.htmlElement||b.createElement();k===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[k]);b.sTi();this.G6a+=b.htmlElement.clientHeight;var y=this.htmlElement.childNodes,R=b.tch,aa=
Object(u.a)(this,this.fRm,"onAfterShowEntry");Wp.WacAirSpace.uU(r,"Shared_BasicClass");var ta=new Dz.a(r);ta.Ira(0,1);const Ya=new nw.a(r);Ya.zza(r.clientTop-30,r.clientTop);R?(Wp.WacAirSpace.Rhb(ta,null,null),Wp.WacAirSpace.Rhb(Ya,null,aa)):(Wp.WacAirSpace.animate(ta,null,null),Wp.WacAirSpace.animate(Ya,null,aa));for(k+=1;k<y.length;k++)aa=y[k],Wp.WacAirSpace.uU(aa,"Shared_BasicClass"),ta=new nw.a(aa),ta.zza(aa.clientTop-r.clientHeight,aa.clientTop),R?Wp.WacAirSpace.Rhb(ta,null,null):Wp.WacAirSpace.animate(ta,
null,null);b.vZn();this.set_visible(!0)}u6h(b){const k=b.htmlElement;if(Fd.a.FDb(k)){this.G6a-=b.htmlElement.clientHeight;var r=k.parentNode.children;b=b.tch;var y=Object(u.a)(this,this.XQm,"onAfterHideEntry");Wp.WacAirSpace.uU(k,"Shared_BasicClass");var R=new Py.a(k);R.Ira(1,0);b?Wp.WacAirSpace.Rhb(R,null,y):Wp.WacAirSpace.animate(R,null,y);y=!1;for(R=0;R<r.length;R++){if(y){const aa=r[R];Wp.WacAirSpace.uU(aa,"Shared_BasicClass");const ta=new nw.a(aa);ta.zza(aa.clientTop,-k.clientHeight);b?Wp.WacAirSpace.Rhb(ta,
null,An):Wp.WacAirSpace.animate(ta,null,An)}y||r[R]!==k||(y=!0)}}}fRm(b){b.element.style.top="";n.AFrameworkApplication.ta.VSc()}XQm(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);n.AFrameworkApplication.ta.VSc()}HSe(){""===this.Rl.style.top.trim()&&(this.Rl.style.top=this.Rl.offsetTop+"px");this.htmlElement.style.left=this.Rl.style.left;this.htmlElement.style.top=this.Rl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility=
"visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.AVg=this.Rl.style.top;this.G6a=b.height;this.sde();n.AFrameworkApplication.ta.$Y(Object(u.a)(this,this.onResize,"onResize"));Af.a.addHandler(this.htmlElement,Kb.a.Hdc,Af.a.Uab);this.pca=Object(u.a)(this,this.lAa,"contextMenuHandler");n.AFrameworkApplication.ta.ywa.mb(this.htmlElement,this.pca,null);if(Id.FocusManager.nJ()){var k=Id.FocusManager.instance();b=k.re(av.a.VJa);b.parent=id.AFrame.Qp;const r=new Gg.DOMFocusListing(()=>this.htmlElement);
r.Rn(1);r.Rn(2);r.Rn(8);k.aka(()=>this.htmlElement,b,r);k=k.getRegion(av.a.VJa);k.fPa();k.$T=!0;k.HWa=!0;const y=n.AFrameworkApplication.ta.ov;b.qvb(()=>{y.Rw(av.a.VJa)});y.wS(av.a.VJa);(r.Cea||n.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&y.LG(av.a.VJa)}}YDc(){this.z5i()&&(this.Rl.style.top=this.AVg);this.htmlElement.style.visibility="hidden";n.AFrameworkApplication.ta&&(Id.FocusManager.nJ()&&Id.FocusManager.instance().Rjb(av.a.VJa),this.pca&&(n.AFrameworkApplication.ta.ywa.sc(this.htmlElement,
this.pca),this.pca=null));Af.a.removeHandler(this.htmlElement,Kb.a.Hdc,Af.a.Uab)}sde(){if(this.z5i()&&this.visible){var b=this.Rl,k=this.G6a+this.IYj;const r=Fd.a.gM(b.style.top);Wp.WacAirSpace.uU(b,"Shared_BasicClass");b=new nw.a(b);b.zza(r,k);Wp.WacAirSpace.animate(b,null,null)}}z5i(){return!this.gw&&!this.ns.l5e}onResize(){const b=this.ns.entries.length,k=Sys.UI.DomElement.getBounds(this.htmlElement).height;let r;for(let y=0;y<b;++y)r=this.ns.entries[y],r.htmlElement&&r.sTi();this.G6a=Sys.UI.DomElement.getBounds(this.htmlElement).height;
k!==this.G6a&&this.sde()}lAa(){return!0}}Object(m.a)(Qy,"BusinessBarDom",null,[1133,10]);var vu;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=
10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]="unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";
b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]=
"dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=
40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(vu||(vu={}));Object(m.b)("BusinessBarId",vu);class Ts{constructor(b,k=0,r=null,y=null){this.nNg=this.bDg=!1;this.$Tb=null;this.iA=[];this.uRa=y||new Qy(b,k,this);this.K5l(r)}K5l(b){if(b){this.$Tb={};b=b.ranking;for(let k=0;k<b.length;k++)this.$Tb[vu[b[k]]]=k}}dispose(){this.uRa.dispose();vb.a.lWf(this.iA);
this.iA=null}get htmlElement(){return this.uRa.htmlElement}get visible(){return this.uRa.visible}get l5e(){return this.bDg}set l5e(b){this.bDg=b}get vtf(){return this.nNg}set vtf(b){this.nNg=b}get entries(){return this.iA}set entries(b){this.iA=b}jaa(b){for(let k=0;k<this.iA.length;k++)if(this.iA[k].id===b)return!0;return!1}qA(b,k=!1,r=null,y=null,R=null){b.wP=this;let aa=this.qxl(b.id);k&&!this.$Tb&&(aa=0);aa<Ts.TFb&&(this.uRa.U5i(b,aa),this.iA.length>=Ts.TFb&&this.uRa.u6h(this.iA[Ts.TFb-1]),this.uRa.sde());
Array.insert(this.iA,aa,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",vu[b.id],void 0===b.IWa||null===b.IWa?"":b.IWa);b.errorCode&&n.AFrameworkApplication.WQ(b.errorCode,r,y,R)}removeEntry(b){const k=Array.indexOf(this.iA,b);-1!==k&&k<Ts.TFb&&(this.iA.length>Ts.TFb&&this.uRa.U5i(this.iA[Ts.TFb],Ts.TFb),this.uRa.u6h(b),this.uRa.sde());Array.remove(this.iA,b);b.wP=null;b.dispose()}qxl(b){if(!this.$Tb||0===b)return this.iA.length;b=this.$Tb[vu[b]];if(void 0===
b||null===b)return this.iA.length;for(let k=0;k<this.iA.length;k++)if(b<this.$Tb[vu[this.iA[k].id]])return k;return this.iA.length}}Ts.TFb=2;Object(m.a)(Ts,"BusinessBar",null,[1103,10,1104]);class ax{create(b,k,r){return new Of.a(b,k,r)}}Object(m.a)(ax,"Factory",null,[1132]);class Av{static jEk(b,k){b.register(Ts,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Zd(()=>new Ts(k.value,0,b.Pa("CommonUI.IBusinessBarRankProvider")));b.register(ax,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}
Object(m.a)(Av,"CommonUIComponentConfiguration",null,[]);var bx=c(972);class Qq extends bx.a{constructor(){super()}static get instance(){return Qq._instance||Qq.bof()}static bof(){Qq._instance=new Qq;return Qq._instance}}Qq._instance=null;Object(m.a)(Qq,"ReactRootManager",bx.a,[270,271]);class ow extends Wg.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(ow,"CompoundButtonProps",Wg.a,[]);class Vx{constructor(b,k,r,y,R,aa,ta){this.vV=k;this.Duc=b;this.ALg=k.Ndm;this.XRb=k.UOc;this.Lue=
aa;this.vcd=y;this.wcd=R;this.pcd=r;this.pz=ta;this.Q7a=new Na.a;this.Q7a.Z(1,"SpellingIssue_16x16x32");this.Q7a.Z(2,"GrammarIssue_16x16x32");this.Q7a.Z(3,"WritingIssue_16x16x32");this.Q7a.Z(4,null);this.Q7a.Z(0,null)}create(b,k,r){k=Object(ia.a)(pi.a,k);if(!k)return v.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const y=new Sys.StringBuilder;b=this.BUh(b);this.eDc(y,k,r,b);this.B0e(y,k);this.mOk(y,k,b);return y.toString()}Qxb(b,k,r){const y=Object(ia.a)(pi.a,k);if(!y)return v.ULS.sendTraceTag(39188232,
375,15,"Expect EditorServiceErrorDetails."),[];k=[];b=this.BUh(b);this.n1e(k,y,r,b);this.C0e(k,y);this.nOk(k,y,b);for(r=0;r<k.length;r++)k[r].Id=`${Ul.ODh}_${r}`;return k}eDc(b,k,r,y=null){k.errorType?1===k.errorType&&(this.o1b(k)||b.append(this.PUe(k,r,y))):b.append(this.Duc.build())}n1e(b,k,r,y=null){k.errorType?1===k.errorType&&(this.o1b(k)||b.push(this.Lmk(k,r,y))):b.push(this.Duc.Wih())}B0e(b,k){const r=new Sys.StringBuilder;this.K6i(k)?r.append(Rf.a("btnIgnoreAllSpellingError",(2===k.errorType?
Wa.a.yFa:Wa.a.cma).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.o1b(k)||r.append(Rf.a("btnIgrnoreSpellingError",this.CTh(k.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.P6i(k)&&(this.vV.jdi&&r.append(Rf.a("btnDoNotCheckForThisIssue",Wa.a.Nyb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Rf.a("btnGrammarOptions",Wa.a.Nib.toString(),A.a.Ff(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
b.append(r.toString()),b.append("</Controls></MenuSection>"))}C0e(b,k){const r=Object.assign(new oi.a,{ControlList:[]});if(this.K6i(k)){var y=fa.KA()?Object.assign(new Wg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Wa.a.cma,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Wg.a,{ExternalId:2===k.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(y)}else this.o1b(k)||(y=Object.assign(new Wg.a,{ExternalId:"btnIgrnoreSpellingError",
Command:this.CTh(k.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(y));this.P6i(k)&&(this.vV.jdi&&(k=Object.assign(new Wg.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(k)),k=Object.assign(new Wg.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(k));b.push(r)}BUh(b){if(!this.pz)return null;b=this.pz.language(this.pz.Qr(b.Qa));return yh.a.qg(b)?yh.a.qg(b).name:null}CTh(b){return 2===b?Wa.a.yFa:this.vV.xgm?Wa.a.f1l:Wa.a.Lta}mOk(b,
k,r=null){if(this.N_f(k)){var y=A.a.Ff(k.Ss.CategoryTitle);y=Rf.o(Ul.Dbc,ib.a.Nja,this.Q7a.J(k.proofingType),""!==y?y:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.vcd,this.wcd);y=Rf.d("cgProofingOuter",[y]);b.clear();b.append(Rf.h("msProofingOuter",y,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",k.proofingType,k.typeId)}}nOk(b,k,r=null){if(this.N_f(k)){var y=A.a.Ff(k.Ss.CategoryTitle);
r=Object.assign(new Oi.a,{ExternalId:String.format("{0}_{1}",Ul.Dbc,k.proofingType),Command:ib.a.Nja.toString(),Image16by16Class:this.Q7a.J(k.proofingType),LabelText:""!==y?y:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new Ci.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.nkl(k),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);
y=Object.assign(new oi.a,{ControlList:[]});y.ControlList.push(r);b.push(y);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",k.proofingType,k.typeId)}}PUe(b,k,r=null){const y=this.Esl(b);var R=[];let aa=!1;var ta=b.Ss.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.ALg&&(aa=!Th.a.any(ta,Ya=>!Ya||!Ya.Description)),1!==ta.length||ta[0].Action){let Ya=0,xb=null;aa&&(xb="font-weight: bold;");for(const Mb of ta){if(!Mb)continue;ta=null;let cc="";
const jc=A.a.Ff(Mb.Text);aa&&(ta=this.pOh(Mb.Description),cc=this.oOh(Mb.Description));R.push(Rf.a("btnCorrectWord"+Ya,k[Ya].toString(),jc,null,null,null,null,null,xb,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,y,jc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.dth(b.token)),"ariaDescribedById",cc));Ya++}}else k=A.a.Ff(ta[0].Text),R.push(Rf.a("btnCorrectWord0",
Wa.a.yFa.toString(),k,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,y,k)));k="Menu16";0<R.length?aa&&(k="Menu16DescriptionEnabled"):R=[Rf.a("btnNoSuggestions",Wa.a.yFa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Rf.h("msUnknownWord",Rf.d(null,R),k,y,this.HAl(b),r,"ariaLabelledById")}Lmk(b,k,r=null){var y=1!==b.proofingType&&0!==b.proofingType?b.Ss.ExplanationTitle:"";y=Object.assign(new oi.a,{Title:y,
Lang:r,ControlList:[]});let R=!1;var aa=b.Ss.Suggestions;if(aa)if(aa=aa.slice(0,Math.min(3,aa.length)),this.ALg&&(R=!Th.a.any(aa,ta=>!ta||!ta.Description)),1!==aa.length||aa[0].Action){let ta=0;for(const Ya of aa){if(!Ya)continue;aa=null;let xb="";R&&(aa=this.pOh(Ya.Description),xb=this.oOh(Ya.Description));if(ta>=k.length)break;aa?(aa=Object.assign(new ow,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:k[ta].toString(),LabelText:Ya.Text,Description:aa,
Lang:r,AriaDescription:xb}),y.ControlList.push(aa)):(aa=Object.assign(new Wg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),Command:k[ta].toString(),LabelText:Ya.Text,Lang:r,RoleInMenu:"menuitem"}),y.ControlList.push(aa));ta++}}else b=aa[0],b=Object.assign(new Wg.a,{ExternalId:"NoSuggestion",Command:Wa.a.yFa.toString(),LabelText:b.Text}),y.ControlList.push(b);0>=y.ControlList.length&&y.ControlList.push(Object.assign(new Wg.a,{ExternalId:"btnNoSuggestions",Command:Wa.a.yFa.toString(),
LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return y}Esl(b){return A.a.Ff(0!==b.proofingType?b.Ss.ExplanationTitle:"")}HAl(b){return this.N_f(b)?null:this.Q7a.J(b.proofingType)}N_f(b){return this.XRb&&2!==b.errorType&&(1!==b.errorType||!this.o1b(b))}K6i(b){return this.Lue&&!!b.errorType&&1===b.proofingType&&!this.o1b(b)}nkl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.dth(b.token)):""}P6i(b){return this.vV.lQd&&this.XRb&&
1===b.errorType&&(2===b.proofingType||3===b.proofingType)}o1b(b){return!!b.errorType&&!!this.pcd&&this.pcd.contains(b.token,b.lcid)}pOh(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}oOh(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}dth(b){let k="";if(b){let r;for(r=0;r<b.length-1;r++)k=k+b.charAt(r)+",";k+=b.charAt(r)}return k}}Object(m.a)(Vx,"EditorServiceProofingContextMenuCreator",null,[]);class Wx{get ranking(){return[24,
23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(Wx,"BusinessBarRankProvider",null,[428]);class cx{constructor(){this.W=null}get name(){return"Wonca.UI"}zc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new Wx).singleInstance();Av.jEk(b,new cg.a(()=>Ka.App.xa.nea));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Vx(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
b.resolve("Box4.Proofing.IIgnoreAllKeywords"),n.AFrameworkApplication.mQ,n.AFrameworkApplication.pr,n.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>Qq.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){M.a.instance.Pc(new cx)}}Object(m.a)(cx,"WoncaUIPackage",null,[1,2]);class dx{constructor(b){this.NM=
this.Isc=null;this.nl=b}get key(){return"BOOKMARK"}get qw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get Hka(){return this.NM}reset(b){this.NM=b.node}qFa(b){let k=null;n.AFrameworkApplication.Ne("bookmarks-core-ex;bookmarks-core-ex-cf");if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Isc&&this.nl.jqf(b,this.Hka,this.Isc))return k=Object.assign(new Np.a,{YF:this.key,contentObject:this.Isc}),{returnValue:!0,
VE:k};this.Isc=null;if(!this.Hka.hasBookmark)return{returnValue:!1,VE:k};const r=new Wd.GraphIterator;r.set(this.Hka.Di());this.nl.f$b(r);if(this.nl.Obi(r)){let y=r.Ud();for(;y;){if(this.nl.jqf(b,this.Hka,y))return this.Isc=y,k=Object.assign(new Np.a,{YF:this.key,contentObject:y,description:this.Qdb()}),{returnValue:!0,VE:k};y=r.xj()}}}return{returnValue:!1,VE:k}}Qdb(){return null}}Object(m.a)(dx,"BookmarkDetailsProvider",null,[298,299]);class Bv{constructor(b,k,r,y,R=null){this.ZKg=this.Ah=!1;this.xgd=
this.HTb=null;this.yxi=(aa,ta)=>{aa=ta.node;1074135152!==aa.Qc?v.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",aa.Qc):(v.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.VAd(!0))};this.nB=r;this.Hh=y;this.Ax=k;this.rxg=b;this.fB=R}get fy(){return this.Ax.value}initialize(){this.ORf();this.Ah=!0}VAd(b=!1){if(!this.Ah)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.ZKg)return!0;let k=
!1;this.Hh.Qd(()=>{this.HTb={};this.xgd={};if(this.fy){const r=new Wd.GraphIterator;r.set(this.fy);if(this.eMm(r)){if(r.Pb(1)){do this.$4j(r.currentNode);while(r.yf(1))}k=this.ZKg=!0}}},"BGM:EBGL");return k}fOh(b){var k,r,y,R;if(!this.VAd())return null;const aa=new rb.a;if(b.toString()in this.HTb){const ta=this.HTb[b.toString()];for(let Ya of ta)this.fB.Yja.has(null===(k=Ya.id)||void 0===k?void 0:k.toString())&&this.fB.Yja.get(null===(r=Ya.id)||void 0===r?void 0:r.toString()).equals(b)&&this.fB.$Va.has(null===
(y=Ya.id)||void 0===y?void 0:y.toString())&&this.fB.$Va.get(null===(R=Ya.id)||void 0===R?void 0:R.toString()).equals(b)?aa.add(Ya):v.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return aa}Fea(b){return this.VAd()?b in this.xgd?this.xgd[b]:null:null}dispose(){this.Ah?this.Kho():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}eMm(b){if(this.nB.DQ(b))return(b=b.Pb(30))||
v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}ORf(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.rxg.Rah(this.yxi)}Kho(){v.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.rxg.EQi(this.yxi)}$4j(b){var k,r,y,R;b?(this.R9g(null!==(r=this.fB.Yja.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==r?
r:G.a.nil,b),this.R9g(null!==(R=this.fB.$Va.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&void 0!==R?R:G.a.nil,b),(k=b.properties.ia(wc.a.Rs,null))&&(this.xgd[k]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}R9g(b,k){b===G.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.HTb||(this.HTb[b]=new rb.a),b=this.HTb[b],b.contains(k)||b.add(k))}}Object(m.a)(Bv,"BookmarkGraphManager",null,[626]);class Zo{constructor(b,k){this.T9=b;this.Xyj=k}get GIb(){return this.Xyj}}
Object(m.a)(Zo,"FoundBookmarkRangeObject",null,[479]);class au{constructor(b,k=null){this.sRa=b;this.$wd={};this.X_b={};this.fB=k}q1a(b,k){if(b=this.sRa.fOh(k.node.id)){v.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",b.count,k.node.id));for(let r of b)r.id.toString()in this.$wd&&(k=this.$wd[r.id.toString()],k.id.toString()in this.X_b?b=this.X_b[k.id.toString()]:(b=new rb.a,this.X_b[k.id.toString()]=b),b.add(r),delete this.$wd[r.id.toString()])}else v.ULS.sendTraceTag(24691925,
3029,50,"Failed to get bookmarks on paragraph deletion")}OTc(b,k){if(b=this.sRa.fOh(k.original.id))for(let r of b)this.$wd[r.id.toString()]=k.clone;else v.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}QTc(b,k){var r,y;if(k.original.id.toString()in this.X_b){b=this.X_b[k.original.id.toString()];for(let R of b)this.fB.Yja.set(null===(r=R.id)||void 0===r?void 0:r.toString(),k.clone.id),this.fB.$Va.set(null===(y=R.id)||void 0===y?void 0:y.toString(),k.clone.id);delete this.X_b[k.original.id.toString()];
v.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.sRa.VAd(!0)}}hAi(){v.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}wqd(){v.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}$Wb(){v.ULS.sendTraceTag(591730835,3029,10,"New Interface Not Implemented!");return!1}RWd(){v.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}Fea(){v.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");
return null}Gdb(){v.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}tla(){v.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new Zo(null,2)}mIf(){v.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}qcc(){v.ULS.sendTraceTag(573673489,3029,10,"New interface not implemented")}nHc(){v.ULS.sendTraceTag(559228954,3029,10,"getAllBookmarks not implemented");return null}T4h(){v.ULS.sendTraceTag(512328972,3029,10,"hasBookmarksOnBoot not implemented");
return!1}sZe(){v.ULS.sendTraceTag(524321507,3029,10,"containsBookmark not implemented");return!1}uSf(){v.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}Wgf(){v.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}eOh(){v.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}Yjf(){v.ULS.sendTraceTag(544777299,3029,10,"goToBookmark not implemented")}gIc(){v.ULS.sendTraceTag(545118154,3029,
10,"getEnclosingBookmark not implemented");return null}f$b(){v.ULS.sendTraceTag(540382879,3029,10,"moveToBookmarkContainer not implemented");return null}Obi(){v.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}vhj(){v.ULS.sendTraceTag(525133728,3029,10,"updateBookmarkNameOnly not implemented");return!1}p_d(){v.ULS.sendTraceTag(523106501,3029,10,"paragraphContainsAnyBookmarks not implemented");return!1}fcf(){v.ULS.sendTraceTag(523106502,3029,10,"getBookmarksFromParagraph not implemented");
return null}dcf(){v.ULS.sendTraceTag(522735619,3029,10,"getBookmarkRangeOnly not implemented");return null}Xgf(){v.ULS.sendTraceTag(522735620,3029,10,"getParagraphContainingGivenBookmarkAnchors not implemented");return null}jqf(){v.ULS.sendTraceTag(521462493,3029,10,"isCpInsideBookmark not implemented");return!1}}Object(m.a)(au,"BookmarkManager",null,[430]);var vA=c(793),oB=c(1096);class wA{create(){return new oB.a}}Object(m.a)(wA,"BookmarkContainerNodeFactory",null,[417]);class Ez{constructor(b,
k,r,y=null){this.hAi=(R,aa)=>{this.nl.mIf(aa)};this.OTc=(R,aa)=>{var ta=this.KIh(aa.clone);R=aa.original.Mc;const Ya=new Fc.a;for(let xb of ta)ta=xb.sn.toString(),Ya.ub(ta)||(Ya.add(ta,!0),(ta=R.Db(xb.sn))&&!ta.anchor&&(ta=this.nl.Gdb(xb.sn)),ta?ta.anchor?this.bIk(ta,aa.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(wc.a.qwb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.QTc=(R,aa)=>{R=aa.clone;aa=this.KIh(R);
this.nl.qcc(R,aa)};this.Pw=k;this.nl=r;this.Myj=y||new wA}init(){vA.a.tmn(Object(u.a)(this.nl,this.nl.RWd,"onAfterFullBookmarkRangeDeleted"));this.Pw.OPe(this.hAi);Ps.a.nrd(this.OTc);Ps.a.zyc(this.QTc)}KIh(b){const k=new rb.a;for(let r=0;r<b.qa.length;r++){const y=b.qa.J(r);if(y.Lh)for(let R=0;R<y.Lh.length;R++)k.add(y.Lh.J(R))}return k}bIk(b,k){var r=k.Di().Ad;r=Vo.a(b,r,!0);k=Wd.GraphIterator.Za(k);this.T3k(k);k.Pb(30);k.A1(r,1,b.id);k.Ei(r)}T3k(b){if(b.Ab(25)&&b.kd(25)&&!b.fq(30)){const k=this.Myj.create(1074135152);
b.Rf(k,30)}}}Object(m.a)(Ez,"BookmarksEventHandler",null,[]);var lt=c(291),er=c(287),Ij=c(484),bu=c(1155),ex=c(145),fx=c(1025);class pw{create(){return new fx.a}}Object(m.a)(pw,"BookmarkNodeFactory",null,[417]);class Xx{constructor(b,k,r,y,R,aa,ta,Ya=null,xb,Mb=null){this.X0="_";this.uxg=40;this.zXj=" ";this.Ax=b;this.nB=k;this.Yd=r;this.Zxe=y;this.Hc=R;this.fb=aa;this.hb=ta;this.Wyj=Ya||new pw;this.fB=Mb}lJc(b,k){return b?this.fB.Yja.get(null===k||void 0===k?void 0:k.toString()):this.fB.$Va.get(null===
k||void 0===k?void 0:k.toString())}get fy(){return this.Ax.value}get TFa(){return this.Zxe.value}wqd(b,k){if(!k||!k.Qa||!k.Tc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=k.Qa.node,y=k.Tc.node,R=lt.a.Rdb(k,!0);k=lt.a.Rdb(k,!1);return this.$Wb(b,R,k,r,y)}$Wb(b,k,r,y,R,aa=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",aa));const ta=this.Fea(b);if(ta)if(aa)this.AOi(ta);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),
!1;if(!y||!R)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;aa=this.Hc.Rc(15);aa.Eb(this.TFa);b=this.E2j(b);if(!b)return!1;this.A2j(y,k,b,R,r);aa.dispose();return!0}Fea(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.NIh(k=>b===k.properties.ia(wc.a.Rs,null))}Gdb(b){return b&&b!==G.a.nil?this.NIh(k=>b.equals(k.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}RWd(b){const k=this.Gdb(b);k?(v.ULS.sendTraceTag(36844636,
3029,50,String.format("Removing bookmark {0}",b.toString())),this.zOi(k),this.FXc(k)):v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}tla(b,k){var r;const y=null!==(r=this.lJc(k,b.id))&&void 0!==r?r:G.a.nil;if(y===G.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Zo(null,2);r=this.fy.Ad.Db(y);return r?r.isConnected?this.getBookmarkRange(r,b,k):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Zo(null,
3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Zo(null,2))}mIf(b){const k=this.gbl(b);k[Symbol.iterator]().next().done||this.bMm(b,k)}qcc(b,k){const r=new rb.a;let y=0,R=!1;for(let aa of k)aa&&aa.Ob.Lh?(y++,aa.Ob.Lh.remove(aa),0<=aa.Ge&&aa.Ge<b.wordRunProperties.length&&(aa.Ob.cp||(R=!0),r.add(aa.Ge))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Hga(!0,r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",
y,r.count));R&&!b.wordRunProperties.length&&b.wordRunProperties.append(er.CharacterPropertiesEditor.GQ,1024)}nHc(b=!1){v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const k=new rb.a,r=Wd.GraphIterator.Za(this.fy);if(null!==this.f$b(r)){var y=r.Mp();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",y);if(0<y)for(y=r.Ud();null!==y;){let R=y.ia(wc.a.Rs,"");A.a.lf(R)||(b?k.add(y):R.startsWith(this.X0)||k.add(y));y=r.xj()}}!b&&0<k.count&&v.ULS.sendTraceTag(556889755,
3029,50,"User Bookmarks count: {0}",k.count);return k}T4h(b=!1){return this.fy?this.sZe(b):!1}sZe(b=!1){v.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",b);const k=Wd.GraphIterator.Za(this.fy);if(null!==this.f$b(k)&&0<k.Mp()){var r=k.Ud();if(b&&r)return!0;for(;null!==r;){r=r.ia(wc.a.Rs,"");if(!A.a.lf(r)&&(b||!r.startsWith(this.X0)))return!0;r=k.xj()}}return!1}Wgf(b){var k=this.Fea(b);let r=new rb.a;if(k){b=this.lJc(!0,k.id);k=this.lJc(!1,k.id);var y=this.fy.Ad.Db(b);
y&&r.add(y);if(b.equals(k))return r;b=y;do(b=y=this.fb.eh(b,!1,!1,!0))&&r.add(y);while(y&&!y.id.equals(k))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",b);return r}uSf(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.Gdb(b);return this.AOi(b)}eOh(b){let k="",r=b.id;b=b.characterData.split(this.zXj);for(let y=0;3>y&&y<b.length;y++)k+=this.X0+b[y];k.length>this.uxg&&(k=k.substring(0,this.uxg));return this.qpj(k,
r)}qpj(b,k){const r=this.nHc(!0);let y=[],R;for(let ta=0;ta<r.count;ta++){var aa=r.J(ta);R=aa.ia(wc.a.Rs,"");aa=this.lJc(!0,aa.id);R.startsWith(b)&&!k.equals(aa)&&y.push(R)}return 0<y.length?(y.sort((ta,Ya)=>ta.localeCompare(Ya,void 0,{numeric:!0})),(k=y[y.length-1].substring(b.length+1))?b+this.X0+(parseInt(k)+1):b+this.X0+1):b}Yjf(b){A.a.lf(b)?v.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.Fea(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):
(b=this.tla(b,!0))?(b=Ke.SelectionFactory.xe(b.T9.paragraph,b.T9.Ob.cp))&&this.hb.setSelection(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}AOi(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const k=this.Hc.Rc(15);k.Eb(this.TFa);this.zOi(b);this.FXc(b);k.dispose();return!0}gIc(b,k){if(!b||0>k)return v.ULS.sendTraceTag(545118153,
3029,10,String.format("Got null paragraph or negative cp value")),null;let r=null,y=new rb.a,R=new rb.a;var aa=b.qa;for(var ta=0;ta<aa.length;ta++){var Ya=aa.J(ta);if(Ya.cp>k||Ya.cp===k&&0<y.count)break;if(Ya.Lh){var xb=Ya.Lh;if(2===xb.length&&xb.J(0).sn.equals(xb.J(1).sn)&&Ya.cp===k){y.add(xb.J(0).sn.toString());break}for(let Mb=0,cc=xb.length;Mb<cc;Mb++){Ya=xb.J(Mb);const jc=b.Mc.Db(Ya.sn).ia(wc.a.Rs,"");A.a.lf(jc)||jc.startsWith(this.X0)||(Ya.Oc?y.add(Ya.sn.toString()):y.contains(Ya.sn.toString())?
y.remove(Ya.sn.toString()):R.add(Ya.sn.toString()))}}}0<y.count&&(r=b.Mc.Db(G.a.Pf(y.J(y.count-1))));if(!r)for(k=ie.ParagraphReader.eh(b,!0);k&&!r;){for(aa=0;aa<k.qa.length;aa++)if(ta=k.qa.J(aa),ta.Lh){ta=ta.Lh;for(let Mb=0,cc=ta.length;Mb<cc;Mb++)xb=ta.J(Mb),Ya=b.Mc.Db(xb.sn).ia(wc.a.Rs,""),A.a.lf(Ya)||Ya.startsWith(this.X0)||(xb.Oc?R.contains(xb.sn.toString())?R.remove(xb.sn.toString()):y.add(xb.sn.toString()):y.contains(xb.sn.toString())?y.remove(xb.sn.toString()):R.add(xb.sn.toString()))}0<y.count?
r=k.Mc.Db(G.a.Pf(y.J(y.count-1))):k=ie.ParagraphReader.eh(k,!0)}return r}vhj(b,k){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.$am(k)||this.x0k(k))return!1;const r=this.Hc.Rc(15);r.Eb(this.TFa);this.ojo(b,k);r.dispose();return!0}NIh(b){if(!this.fy)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const k=new Wd.GraphIterator;k.set(this.fy);if(!this.f$b(k))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),
null;if(!k.Pb(1))return null;do{const r=k.currentNode;if(b(r))return r}while(k.yf(1));return null}getBookmarkRange(b,k,r){for(let y=0;y<b.qa.length;y++){const R=b.qa.J(y);if(R.Lh)for(let aa=0;aa<R.Lh.length;aa++){const ta=R.Lh.J(aa);if(ta.sn.equals(k.id)&&r===ta.Oc)return new Zo(ta,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,k.ia(wc.a.qwb,-1),r,k.id,b.qa.length,this.gK(b));return new Zo(null,1)}f$b(b){if(this.nB.DQ(b))return b=
b.Pb(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}gbl(b){const k=new Fc.a;for(let r=0;r<b.qa.length;r++){const y=b.qa.J(r);if(y.Lh)for(let R=0;R<y.Lh.length;R++){const aa=y.Lh.J(R),ta=aa.sn.toString();k.ub(ta)?(v.ULS.shipAssertTag(36218379,3029,aa.Oc!==k.J(ta).Oc),k.remove(ta)):k.add(ta,aa)}}return k.values}bMm(b,k){this.qcc(b,k);this.ILm(b,k)}ILm(b,k){let r=ie.ParagraphReader.eh(b,
!1,!0);b=ie.ParagraphReader.eh(b,!0,!0);r||b?(r||this.shh(k,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||this.shh(k,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.mti(r,k,0,!0),this.mti(b,k,b.qa.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}shh(b,k){for(let r of b)if(k===r.Oc)return!0;
return!1}mti(b,k,r,y){const R=new rb.a;r=this.zcf(b,r);for(let aa of k)aa.Oc===y&&(r?(k=this.G2j(b,y,r,aa.sn))&&R.add(k):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",y));R.count&&(b.yn(),this.Z9f(b,R),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",R.count,y)))}G2j(b,k,r,y){const R=this.Gdb(y);return R?this.eOe(b,k,r,R):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",y)),null)}eOe(b,
k,r,y){var R;if(!y)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),null;r.Lh||(r.Lh=new Ij.a(r));const aa=new bu.a(r,null,y.id,k);r.Lh.add(aa);(k?this.fB.Yja:this.fB.$Va).set(null===(R=y.id)||void 0===R?void 0:R.toString(),b.id);return aa}Z9f(b,k){if(k){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",k.count);k.Sc((r,
y)=>r.Ge-y.Ge);for(let r=0;r<k.count;r++){const y=k.J(r);y.Ge?b.wordRunProperties.IZ(y.Ge-1,1024):b.wordRunProperties.Tta(y.Ge,1024);b.wordRunProperties.Iq.Z(y.Ge,er.CharacterPropertiesEditor.GQ);b.wordRunProperties.gt.Z(y.Ge,er.CharacterPropertiesEditor.cU)}}else v.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}zcf(b,k){if(!b||!b.qa||!b.qa.last)return null;v.ULS.shipAssertTag(36471766,3029,k<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===k){var r=
b.qa.length-1;if(!b.qa.J(r).formatting)for(var y=r-1;0<=y;y--){var R=b.qa.J(y);if(R.formatting){this.Yd.OX(b,r,k,R.formatting);break}}return b.qa.last}r=null;for(y=0;y<b.qa.length;y++){R=b.qa.J(y);if(R.cp>=k){if(R.cp>k||!R.formatting)this.Yd.OX(b,y,k,r),R=b.qa.J(y);R.Lh||(R.Lh=new Ij.a(R));v.ULS.shipAssertTag(36471768,3029,R!==b.qa.last);return R}R.formatting&&(r=R.formatting)}return null}E2j(b){const k=new Wd.GraphIterator;k.set(this.fy);if(!this.f$b(k))return v.ULS.sendTraceTag(36471769,3029,10,
"Unable to move to BookmarkContainer"),null;b=this.JJk(b);k.A1(b,1,null);k.Ei(b);return b}JJk(b){const k=this.Wyj.create(1074135153);k.setValue(wc.a.Rs,b);k.setValue(wc.a.qwb,Gc.a.ZF());return k}FXc(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ia(wc.a.qwb,-1),b.id);var k=new Wd.GraphIterator;k.set(b);k.Ab(64);k.Hg()}}gK(b){const k=[];let r=0;for(;b.anchor.mr&&7!==b.type;)k[r]=ex.a[b.type],b=b.anchor.mr.zr.node,r++;k[r]=ex.a[b.type];return k.join(" ")}ojo(b,
k){b.setValue(wc.a.Rs,k)}zOi(b){const k=this.tla(b,!0).T9;b=this.tla(b,!1).T9;if(k&&b&&k.paragraph===b.paragraph){let r;this.qcc(k.paragraph,(r=new rb.a,r.add(k),r.add(b),r))}else{if(k){let r;this.qcc(k.paragraph,(r=new rb.a,r.add(k),r))}if(b){let r;this.qcc(b.paragraph,(r=new rb.a,r.add(b),r))}}}A2j(b,k,r,y,R){if(k=this.eOe(b,!0,this.zcf(b,k),r)){b.yn();var aa;this.Z9f(b,(aa=new rb.a,aa.add(k),aa));(r=this.eOe(y,!1,this.zcf(y,R),r))?(y.yn(),this.Z9f(b,(aa=new rb.a,aa.add(r),aa))):v.ULS.sendTraceTag(520646733,
3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Xgf(b,k){var r;if(!b)return null;k=null!==(r=this.lJc(k,b.id))&&void 0!==r?r:G.a.nil;return b.Mc.Db(k)?b.Mc.Db(k):null}Obi(b){return!!b&&64===b.Le}p_d(b,k){var r;if(0===b.V7)return!1;for(let y=0;y<(null===(r=b.qa)||void 0===r?void 0:r.length);y++){const R=b.qa.J(y);if(null!=R.Lh)for(let aa=
0;aa<R.Lh.length;aa++){const ta=R.Lh.J(aa),Ya=b.Mc.Db(ta.sn).yLa();if(!A.a.lf(Ya)&&(!Ya.startsWith(this.X0)||k)&&ta.Oc)return!0}}return!1}fcf(b,k){var r;let y=[];if(0===b.V7)return y;for(let R=0;R<(null===(r=b.qa)||void 0===r?void 0:r.length);R++){const aa=b.qa.J(R);if(null!=aa.Lh)for(let ta=0;ta<aa.Lh.length;ta++){const Ya=aa.Lh.J(ta),xb=b.Mc.Db(Ya.sn),Mb=xb.yLa();A.a.lf(Mb)||Mb.startsWith(this.X0)&&!k||!Ya.Oc||y.push(xb)}}return y}CXn(b){return b.ia(wc.a.NF,!1)}$am(b){return A.a.lf(b)?(v.ULS.sendTraceTag(559228948,
3029,50,"bookmark name is null or empty"),!0):!1}x0k(b){return null!==this.Fea(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}dcf(b,k,r){return this.getBookmarkRange(b,k,r).T9}jqf(b,k,r){if(this.CXn(r)||this.igm(r))return!1;const y=this.Xgf(r,!0),R=this.Xgf(r,!1);if(y&&R&&this.fb.IOc(k,y,R)){if(k!==y&&k!==R)return!0;const aa=this.dcf(y,r,!0);if(aa&&(y!==k||aa.Ob.cp<=b)&&(r=this.dcf(R,r,!1))&&(R!==k||r.Ob.cp>=b))return!0}return!1}igm(b){b=
null===b||void 0===b?void 0:b.ia(wc.a.Rs,"");return!A.a.lf(b)&&b.startsWith(this.X0)?!0:!1}}Object(m.a)(Xx,"FullBookmarkManager",null,[430]);class Cv{constructor(){this.sRa=this.Lm=this.W=null}get name(){return"WordEditor.Bookmark"}zc(b){this.W=b;this.Lm=this.W.resolve("Box4.INotebookManager").ml;const k=new Xx(new cg.a(()=>Ka.App.xa.jb.Xc),lk.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new cg.a(()=>Ka.App.xa.jb.Fc.ld),Qn.a.instance,this.W.resolve("Box4.IParagraphReader"),
this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>k).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new Ez(this.Lm.Ve(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();jl.App.Cee&&(this.sRa=new Bv(this.Lm.Ve(64),new cg.a(()=>Ka.App.xa.jb.Xc),lk.PageNavigator.instance,
Bo.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.sRa).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}dispose(){this.sRa.dispose()}Wm(){v.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");if(jl.App.yee)this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();else if(jl.App.Cee){this.sRa.initialize();const b=
new au(this.sRa,this.W.resolve("Box4.BookmarkParagraphMapping"));this.Lm.Ve(12).Zu(Object(u.a)(b,b.q1a,"onParagraphDelete"));Ps.a.nrd(Object(u.a)(b,b.OTc,"onParagraphCopy"));Ps.a.zyc(Object(u.a)(b,b.QTc,"onParagraphPaste"))}v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.ymn(this.W.$a("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}ymn(b,k){b&&b.execute(r=>{r.w3(new dx(k))})}static main(){M.a.instance.Pc(new Cv)}}
Object(m.a)(Cv,"BookmarkPackage",null,[1,2]);var Yx=c(860),Dv=c(1019),It=c(1493),Hr=c(1363);class Fz extends Hr.a{constructor(b){super();this.u_j=b}get index(){return 3}run(){this.u_j()}tH(){this.rX()}}Object(m.a)(Fz,"FootnoteEndnoteGraphUpdateTracker",Hr.a,[]);class Hp{constructor(){this.tbd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}zc(){}init(){Hp.Wb.io.continueWith(()=>{this.Wm()})}Wm(){Yx.a.kdb=It.a.instance;this.cmf()}dispose(){}cmf(){this.tbd=new Fz(()=>{It.a.instance.vu()});
Dv.a.w3d(Object(u.a)(this.tbd,this.tbd.tH,"setUpdateNeeded"));Fl.GraphTransactionManager.instance.koa(this.tbd,3)}static get Wb(){return Va.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Hp,"PackageManager",null,[1,2]);var Gz=c(763),Ev=c(549),Ry=c(500),Zx=c(1577);class $x extends Tq{constructor(){super()}get qw(){return null}getTitle(b){b=b.uta();if(!b||!Ev.a.instance.uma(b))return"";const k=new Sys.StringBuilder,r=Ev.a.instance.v6(b);k.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:
WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);k.append(" ");k.append(Ev.a.instance.GAb(b));return k.toString()}}Object(m.a)($x,"FootnoteEndnoteBaseDetailsProvider",Tq,[]);class xA extends $x{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get li(){return 7}}Object(m.a)(xA,"FootnoteEndnoteDetailsProvider",$x,[]);var Hz=c(1536),cu=c(1553),yA=c(1615);class du extends $x{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get li(){return 10}}Object(m.a)(du,"FootnoteEndnoteRefMarkDetailsProvider",
$x,[]);class wu{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff){this.k$h=(Gd,oe,ze,ug,Yf)=>{ug=oe.view;if(!ug.features.R$d||this.tC.Jci)return 8;const Aj=ug.Cb.Jg;if(!Aj)return 2;if(this.Mk.mZ(Aj))return 8;ug=Gd===Jc.a.insertFootnote?1:0;var cn=this.NEd(oe);if(!cn)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;oe=!0;cn=cn.Qa;Yf&&Yf.I7b&&Yf.wCa&&(cn=Yf.wCa,oe=!Yf.keepCurrentFocus);if(1===ze&&Me.a.ufa(Aj)||!cn||!rf.SelectionEditor.zf(cn)||this.qAg.instance&&
this.qAg.instance.qhm(cn)||sh.HyperlinkReader.wma(cn,!0))return 8;if(1===ze)return 32;2===ze&&(ze=this.BV.jg("UserAction","InsertFootnoteEndnote"),Gd=this.HFj.O7l(cn,ug,Gd),Yf&&Yf.I7b&&(Yf.Dvi=Gd),oe&&this.sZd(Gd,!0,!0),ze.stop(),this.Jd.ys(6));return 32};this.r$b=(Gd,oe,ze)=>{const ug=oe.view;if(Gd===Jc.a.dlb||Gd===Jc.a.$Kb){if(!ug.features.R$d)return 8}else if(!ug.features.c4f)return 8;if(!ug.Cb.Jg)return 2;oe=this.T3b(oe);return oe?Gd!==Jc.a.dlb&&Gd!==Jc.a.$Kb||this.nHa.PXl(oe.node,Gd===Jc.a.dlb?
1:0)?1===ze?32:2===ze&&32===this.ga.Xb(Jc.a.q$,2,!0)?(this.ga.Xb(Jc.a.iui,2,Gd),32):8:8:2};this.Lel=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;if(2===ze){Gd=this.nKl(oe);if(!Gd)return 8;ze=oe=null;switch(Yf){case Jc.a.DDf:ze=Gd.Tc;oe=this.XQb.pJd(ze,1);break;case Jc.a.CDf:ze=Gd.Tc;oe=this.XQb.pJd(ze,0);break;case Jc.a.FDf:ze=Gd.Qa;oe=this.XQb.w3h(ze,1);break;case Jc.a.EDf:ze=Gd.Qa;oe=this.XQb.w3h(ze,0);break;case Jc.a.dlb:ze=Gd.Qa;(oe=this.XQb.pJd(ze,1,!0))||(oe=this.nHa.bSh(ze.node,1));break;case Jc.a.$Kb:ze=
Gd.Qa,(oe=this.XQb.pJd(ze,0,!0))||(oe=this.nHa.bSh(ze.node,0))}if(oe)this.sZd(oe);else{if(!this.xt.Fc)return 8;(Yf=Qm.d(ze.node,ze.cpBegin))&&7===Yf.li&&this.nHa.AXi(Yf)}}return 32};this.NZn=(Gd,oe,ze,ug,Yf)=>1===ze?32:2===ze?(v.ULS.shipAssertTag(4520066,308,!!Yf),v.ULS.shipAssertTag(4520067,308,!!Yf.LWa),Gd=Yf.LWa,v.ULS.shipAssertTag(4520068,308,this.GE.uma(Gd)),this.sZd(Gd,Yf.n8d)?32:8):32;this.OZn=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;2===ze&&(Gd=Yf.footnoteEndnoteNode,Yf=Yf.Oel)&&(this.aqa.j1b(),
oe=this.GE.igb(Gd),Yf.title=this.GE.Uul(Gd)+(oe?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.Mib=(Gd,oe,ze,ug,Yf)=>2===ze?(v.ULS.shipAssertTag(4520069,308,!!Yf),v.ULS.shipAssertTag(4520070,308,!!Yf.LWa),v.ULS.shipAssertTag(4520071,308,ie.ParagraphReader.nc(Yf.LWa)),Gd=this.GE.a3b(Yf.LWa),this.sZd(Gd,Yf.n8d)?32:8):32;this.hMn=(Gd,oe,ze)=>{2===ze&&this.tC.FX();return 32};this.RYk=(Gd,oe,ze,ug,Yf)=>{if(1===
ze)return 32;if(2===ze)return void 0!==Yf&&null!==Yf?this.tC.W4e(Yf,Yf):this.tC.W4e(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.tsm=(Gd,oe,ze)=>{Gd=this.T3b(oe);return Gd&&rf.SelectionEditor.zf(Gd)?1===ze?32:2===ze?(ze=0<this.kp.r2(Gd.node).mt,this.tC.k0e(),this.tC.dialog.Seb=ze,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.Jel=(Gd,oe,ze)=>1===ze?32:2===ze?(this.tC.dialog.Seb=!1,32):8;this.ren=
(Gd,oe,ze,ug,Yf)=>this.jLh(Gd,ze,Yf);this.oen=(Gd,oe,ze,ug,Yf)=>1===ze?32:this.tC.dialog&&this.tC.dialog.fontName?(Yf[ge.a.Value]=this.tC.dialog.fontName,32):this.ZBj.gLa(Wa.a.oIb.toString(),Yf,null)?32:8;this.Iel=(Gd,oe,ze)=>1===ze?32:2===ze?(this.tC.dialog.Seb=!0,32):8;this.qen=(Gd,oe,ze,ug,Yf)=>this.jLh(Gd,ze,Yf);this.Gel=(Gd,oe,ze)=>{if(1===ze)return 32;if(2===ze){Gd=this.T3b(oe);if(!Gd)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;oe=this.GE.a3b(Gd.node);
this.GE.uma(oe)&&(ze=this.Hc.Rc(15),ze.Eb(oe),this.vij(Gd),this.nHa.Zdh(oe,this.tC.dialog),ze.dispose());this.tC.JYc();return 32}return 8};this.Fel=(Gd,oe,ze)=>{if(1===ze)return 32;if(2===ze){Gd=this.T3b(oe);if(!Gd)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;oe=this.GE.a3b(Gd.node);this.GE.uma(oe)&&(ze=this.Hc.Rc(15),ze.Eb(oe),this.vij(Gd),this.nHa.uek(oe,this.tC.dialog),ze.dispose());this.tC.JYc();return 32}return 8};this.Hel=(Gd,oe,ze)=>1===ze?32:2===ze?(this.tC.JYc(),
32):8;this.Cel=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;if(2===ze){Gd=Object(ia.a)(25,Yf);if(!Gd||!Gd.Ed)return 8;this.tC.dialog.fontName=Gd.Ed.fontName;return 32}return 8};this.Eel=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;if(2===ze){Gd=Object(ia.a)(25,Yf);if(!Gd||!Gd.Ed)return 8;this.tC.dialog.WQb=Gd.Ed;return 32}return 8};this.ga=b;this.xt=k;this.ZBj=r;this.Zc=y;this.GE=R;this.HFj=aa;this.nHa=ta;this.aqa=Ya;this.tC=xb;this.kp=Mb;this.XQb=cc;this.Hc=jc;this.Mk=Mc;this.Hb=fd;this.BV=Td;this.Jd=ne;this.gwj=
ye;this.qAg=ff}vij(b){(b=Kk.FormattingReader.Qr(b))?(this.tC.dialog.fontName||(this.tC.dialog.fontName=b.cache.$G),-1===this.tC.dialog.fontSize&&(this.tC.dialog.WQb=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}jLh(b,k,r){return 1===k&&this.tC.dialog?32:2===k&&this.tC.dialog?(r[eh.a.On]=b===Jc.a.mPf?this.tC.dialog.Seb:!this.tC.dialog.Seb,32):8}Vb(){this.ga.gb(Jc.a.insertFootnote,lc.a.view,this.k$h,4);this.ga.gb(Jc.a.insertEndnote,
lc.a.view,this.k$h,4);this.ga.pa(Jc.a.DDf,lc.a.view,this.r$b);this.ga.pa(Jc.a.iui,lc.a.view,this.Lel);this.ga.pa(Jc.a.CDf,lc.a.view,this.r$b);this.ga.pa(Jc.a.FDf,lc.a.view,this.r$b);this.ga.pa(Jc.a.EDf,lc.a.view,this.r$b);this.ga.pa(Jc.a.dlb,lc.a.view,this.r$b);this.ga.pa(Jc.a.$Kb,lc.a.view,this.r$b);this.ga.pa(Jc.a.a6i,lc.a.view,this.NZn);this.ga.gb(Jc.a.hLh,lc.a.view,this.Iel,4);this.ga.gb(Jc.a.mPf,lc.a.view,this.qen,100);this.ga.gb(Jc.a.iLh,lc.a.view,this.Jel,4);this.ga.gb(Jc.a.EJi,lc.a.view,this.ren,
100);this.ga.pa(Jc.a.b6i,lc.a.view,this.OZn);this.ga.gb(Jc.a.Mib,lc.a.view,this.Mib,96);this.ga.gb(Jc.a.T$e,lc.a.view,this.hMn,96);this.ga.pa(Jc.a.q$,lc.a.view,this.RYk);this.ga.gb(Jc.a.Oli,lc.a.view,this.tsm,4);this.ga.gb(Jc.a.eLh,lc.a.view,this.Gel,4);this.ga.gb(Jc.a.fLh,lc.a.view,this.Fel,4);this.ga.gb(Jc.a.gLh,lc.a.view,this.Hel,4);this.ga.gb(Jc.a.EDd,lc.a.view,this.Cel,4);this.ga.gb(Jc.a.DJi,lc.a.view,this.oen,100);this.ga.gb(Jc.a.FDd,lc.a.view,this.Eel,4);this.ga.gb(Jc.a.kVc,lc.a.view,wu.kVc,
100);this.ga.gb(Jc.a.lVc,lc.a.view,wu.lVc,100)}IRf(){this.gwj.execute(b=>{b.w3(new xA);b.w3(new du)})}T3b(b){b=this.NEd(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}NEd(b){let k=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),k;b=b.Cb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),k;b=b.ib;if(!b||!b.length)return v.ULS.sendTraceTag(51512528,308,
10,"We expected that we have a selection collection here."),k;b=b.J(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),k;(k=rf.SelectionEditor.Qj(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return k}nKl(b){return(b=b.view)?b.Cb.ib.J(0):null}sZd(b,k=!0,r=!1){if(b){this.aqa.j1b();var y=b.nla;if(y){var R=y.Ob;const aa=Ke.SelectionFactory.DN(R.paragraph,R.cp,R.cp+1);R=this.xt.Fc;if(!R)return!1;this.Zc.uoa(R,aa);R.lkb=
150;R.qba();b=new Ry.a(b,k);y=y.XYa(R);if(!y)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||y.element?this.tC.P0f(b):(this.tC.P0f(new Ry.a(b.LWa,!1)),k&&(k=new nd.a(2,1,10,()=>{this.tC.FX()}),this.Hb.fc(k)));return!0}}return!1}static Lul(){return new wu(n.AFrameworkApplication.ya,Ka.App.xa.jb,Va.a.instance.resolve("Box4.IGeneralCuiUser"),Bb.InteractiveViewManager.instance,Ev.a.instance,cu.a.instance,Hz.a.instance,It.a.instance,Zx.FootnoteEndnoteControlManager.instance,
Va.a.instance.resolve("Box4.IParagraphIndentationReader"),yA.a.instance,new Qn.a,mh.a.instance,Mg.a.instance,n.AFrameworkApplication.ta.lq,Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Va.a.instance.$a("Box4.Accessibility.IAccessibilityContextManager"),Va.a.instance.$a("Box4.IContentControlReader"))}static Kul(){return wu.Lul()}static kVc(b,k,r,y,R){if(1===r)return 32;if(2===r&&!R)return 8;zj.a.CMd(k);R.PopulationXML=Oo.FontUtils.tMh(zj.a.B8d,zj.a.vaf,Jc.a.EDd);return 32}static lVc(b,
k,r,y,R){if(1===r)return 32;if(2===r&&!R)return 8;R.PopulationXML=Oo.FontUtils.uMh(Jc.a.FDd);return 32}}Object(m.a)(wu,"FootnoteEndnoteActor",null,[580]);class zA extends Hr.a{constructor(b){super();this.VLe=b}get index(){return 1}run(){this.VLe()}tH(){this.rX()}}Object(m.a)(zA,"FootnoteEndnoteControlUpdateTracker",Hr.a,[]);var bv=c(371);class pB extends bv.a{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,r,y);this.Xr=()=>{this.D3c(this.zb)};this.DH=b.container;this.sv=document.createElement("div");b.container.appendChild(this.sv);
this.$A(this.sv);this.eUj=R;this.Kn.execute(xb=>{xb.z7(this.Xr)});this.rHa=aa;this.ME=ta;this.OH=Ya;this.rHa.execute(xb=>{xb.r_f(this.Yb,this.DH)});this.OH&&(this.DH.style.backgroundColor=this.ME.C3b())}dispose(){super.dispose();this.Kn.instance&&this.Kn.instance.Sjb(this.Xr)}get Kn(){return null!=this.zlg?this.zlg:this.zlg=Va.a.instance.$a("Common.IZoomManager")}kz(b){this.DH.classList.add("FootnoteEndnoteViewElement");this.D3c(b.currentNode)}D3c(b){this.Kn.instance&&(this.Kn.instance.m5c(this.sv),
this.sv.style.width=Math.round(100/this.Kn.instance.vj)+"%");this.eUj(b)}}Object(m.a)(pB,"FootnoteEndnoteViewElement",bv.a,[]);class qB{constructor(){this._initialized=!1;this.S8c=this.sqe=this.W=null;this.Qel=(b,k,r,y)=>b.D_a?new pB(b,k,r,y,R=>{Zx.FootnoteEndnoteControlManager.instance.Mxn(R)},this.W.$a("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ka.App.instance&&Ka.App.instance.XB):null}get name(){return"WordEditor.FootnoteEndnote"}zc(b){this.W=
b}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){np.WordSectionNavigator.instance.KDf=Object(u.a)(Hz.a.instance,Hz.a.instance.VMm,"navigateToWordSectionNodeWithFootnoteEndnote");Gz.a.g_f(this.Qel);Zx.FootnoteEndnoteControlManager.instance.bind(Ka.App.xa.nC);this.sqe=wu.Kul();this.sqe.Vb();this.sqe.IRf();Ka.App.xa.updateCommandUI();this.cmf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,Zx.FootnoteEndnoteControlManager.instance.dispose())}cmf(){this.S8c=
new zA(()=>{Zx.FootnoteEndnoteControlManager.instance.E3c()});Dv.a.w3d(Object(u.a)(this.S8c,this.S8c.tH,"setUpdateNeeded"));Fl.GraphTransactionManager.instance.koa(this.S8c,3)}}Object(m.a)(qB,"PackageManager",null,[1,2]);class qw{constructor(b,k,r,y,R=null){this.qMj=b;this.hb=k;this.Nca=y;this.fB=R}get qhh(){return this.qMj.value}get bookmarkManager(){return this.Nca.value}hhm(b){return jl.App.Cee||jl.App.yee?b.startsWith(A.a.Cab):!1}gVl(b){var k,r;try{if(jl.App.yee)this.hVl(b);else if(jl.App.Cee&&
this.qhh){var y=b.split("/"),R=this.qhh.Fea(y[y.length-1]);if(R&&R.anchor)if(this.fB.Yja.has(null===(k=R.id)||void 0===k?void 0:k.toString())){var aa=this.fB.Yja.get(null===(r=R.id)||void 0===r?void 0:r.toString());if(void 0===aa||null===aa)v.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.zRd();else{var ta=Ka.App.xa.jb.Xc.Ad.Db(aa);if(ta&&ta.anchor){var Ya=Ke.SelectionFactory.xe(ta,0);this.hb.setSelection(Ya)}else v.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),
this.zRd()}}else v.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.zRd();else v.ULS.sendTraceTag(24691931,324,15,"Cannot find bookmark node"),this.zRd()}}catch(xb){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",xb.message))}}v7f(b){return{returnValue:!1,hSf:b,QLh:""}}hVl(b){if(this.bookmarkManager){b=b.split("/");var k=this.bookmarkManager.Fea(b[b.length-1]);k&&k.anchor?(b=this.bookmarkManager.tla(k,!0).T9,k=this.bookmarkManager.tla(k,
!1).T9,b||k?b?this.C1i(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.C1i(k)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.kvf(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.kvf(!0))}}zRd(){this.kvf(!0)}kvf(b){b=Ke.SelectionFactory.xo(Ka.App.xa.jb.Xc.fdf(),b);this.hb.setSelection(b)}C1i(b){b.paragraph&&b.Ob?(b=Ke.SelectionFactory.xe(b.paragraph,b.Ob.cp),b.Pbi=!0,this.hb.setSelection(b)):v.ULS.shipAssertTag(35992279,
324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(qw,"InternalLinkManager",null,[429]);class Iz{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}zc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",()=>new qw(new cg.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new cg.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){M.a.instance.Pc(new Iz)}}
Object(m.a)(Iz,"WordEditorInternalLinksPackage",null,[1,2]);class rw{constructor(b){this.WHa=null;this.checkAndDeleteEphemeralOutline=k=>{k=k.customData;if(k.anchor){Ee.a.mark(4763);var r=Wd.GraphIterator.Za(k);if(r.Ab(8)&&r.kd(8)&&r.ofj(k)===k){if(Nf.OutlineReader.isEmpty(r)){let y=!1;for(let R=0;R<bh.a.instance.ib.length;R++){const aa=bh.a.instance.ib.J(R);for(let ta=0;ta<aa.length;ta++)if(aa.J(ta).node===k){y=!0;break}}y||this.Ozh(r)}Ee.a.mark(4764)}}};rw.IJ=b}Sxd(b){if(!rw.Ue.aQd(b))return null;
b.Pb(1)&&(b.currentNode.uk(8,!0),b.mc());const k=rw.IJ.LNk();rw.Ue.isRtl(b.currentNode)?k.setValue(Te.a.Dq,11):k.setValue(Te.a.Dq,9);b.Rf(k,1);b.Ei(k);return k}JNn(b){if(this.WHa&&b!==this.WHa){const k=new nd.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);k.customData=this.WHa;n.AFrameworkApplication.uc.fc(k)}this.WHa=b}Ozh(b){this.WHa===b.currentNode&&(this.WHa=null);const k=new sf.GraphTransaction(7);k.Qu(b);b.Hg();k.dispose()}Nnh(){if(this.WHa&&this.WHa.anchor){const b=Wd.GraphIterator.Za(this.WHa);
b.ro()&&Nf.OutlineReader.LNc(b)&&this.Ozh(b);this.WHa=null}}static get Ue(){return De.PageReader.instance}}rw.IJ=null;Object(m.a)(rw,"PageContentEditor",null,[1241]);var gx=c(1150),sw=c(650);class rq extends Qh{constructor(){super()}F4i(b,k,r,y,R){let aa=!1,ta=!0;rf.SelectionEditor.zf(R)&&(k=Vh.ListReader.ei(b)&&k,R=Ag.OutlineElementReader.Uz(b,R,!1)&&!Ag.OutlineElementReader.Uz(b,R,!0),k&&r.NVe(b,y)&&(aa=!0),Ka.App.vd.Pp&&(R||k&&!aa)&&(ta=!1));return{E4i:ta,fnj:aa}}}Object(m.a)(rq,"CursorMoveValidator",
Qh,[]);class Bn{constructor(b,k,r,y){this.xCe=b;this.O4=y;this.LH=k;this.Kh=r;this.RIj=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("QoEIndentLeftForListImprovementIsEnabled")}get Rd(){return null!=this.ltg?this.ltg:this.ltg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Oj(){return null!=this.Xsg?this.Xsg:this.Xsg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get oc(){return null!=this.Cug?this.Cug:this.Cug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Pr(){return this.O4.value}get Ug(){return this.Kh.value}get Cm(){return this.LH}iTl(b){const k=
window.performance.now(),r=new tn.ScriptSharpLegacyMap;let y=new $m.a,R=new tn.ScriptSharpLegacyMap;if(b&&b.zw){var aa=null;for(let ta=0;ta<b.length;ta++){const Ya=b.getContext(ta);aa=aa||Bn.qh.pu(Ya.node);let xb;if(!({groupId:xb}=this.Qeo(Ya.node,aa)).returnValue)continue;let Mb;r.ub(xb)||(Mb=[],r.add(xb,Mb));Mb=r.J(xb);Mb.push(Ya)}for(let ta of un.toArray(r.keys))b=r.J(ta),aa=new Wd.GraphIterator,aa.set(b[0].node),({MTi:b,$s:aa}=this.LH.neo(aa)).returnValue?(r.Z(ta,b),R.add(ta,aa)):y.add(ta)}v.ULS.sendTraceTag(589592455,
338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-k));return{returnValue:r,lTl:y,kTl:R}}Kwb(b){return this.Wsk(b)}YYb(b){return this.wsk(b)}Qtd(b,k,r=!0){return Wd.GraphIterator.fla(()=>{var y=!1;if(Vh.ListReader.ei(b))return this.NVe(b,k,r);y||(xg.OutlineElementNavigator.Fe(b),y=ie.ParagraphReader.yh(b)||Si.TableReader.isTable(b),xg.OutlineElementNavigator.Xd(b),y=y&&this.Usk(b,k));return y})}NVe(b,k,r=!0){return Wd.GraphIterator.fla(()=>{const y=
Ag.OutlineElementReader.vBa(b),R=Nf.OutlineReader.EL(b.currentNode);if(r?!this.Fim(b,k):!this.Gim(b,k))return!1;var aa=Wd.GraphIterator.Za(b.currentNode);if(0<k&&aa.Ab(14)){aa.kd(16);var ta=aa.currentNode;const Ya=Ei.TableCellReader.Lif(aa);aa.kd(14);const xb=aa.currentNode;aa=ko.a.EI(ta,xb,wc.a.wM,wc.a.za,0);ta=ko.a.EI(ta,xb,wc.a.zO,wc.a.Aa,0);aa=Vf.a.az(aa,0);ta=Vf.a.az(ta,0);return y+R<Ya-aa-ta}return!0})}Usk(b,k){const r=Ag.OutlineElementReader.vBa(b);var y=Ag.OutlineElementReader.zF(b);if(0<
k){k=Nf.OutlineReader.EL(b.currentNode);y=0;let Ya,xb;({Oo:ta,marginLeft:Ya,marginRight:xb}=Bn.lHd(b.currentNode));var R=Wd.GraphIterator.Za(b.currentNode);xg.OutlineElementNavigator.Fe(b);if(Si.TableReader.isTable(b)){y=Si.TableReader.Jea(b);let Mb=0;for(var aa of y)Mb+=aa;y=Vf.a.az(Vf.a.uf(Mb,0),0)}xg.OutlineElementNavigator.Xd(b);if(R.Ab(14)){R.kd(16);aa=R.currentNode;b=Ei.TableCellReader.Lif(R);R.kd(14);var ta=R.currentNode;R=ko.a.EI(aa,ta,wc.a.wM,wc.a.za,0);aa=ko.a.EI(aa,ta,wc.a.zO,wc.a.Aa,0);
R=Vf.a.az(R,0);aa=Vf.a.az(aa,0);return r+k<b-R-aa-y}return r+k<ta-Ya-xb-y}return 0<r-y}OOa(b,k){this.tDi(b,-1*Math.abs(k))}TDc(b,k){this.tDi(b,Math.abs(k))}SWk(b,k,r,y,R){let aa=Bn.Hsi;if(k>=Bn.Hsi){aa=k-=r;const ta=y*R,Ya=Math.abs(ta),xb=Math.abs(k)%Ya;xb&&(aa=0>aa?0>y?aa+xb:aa-(Ya-xb):0<y?aa-xb:aa+(Ya-xb));aa+=ta;aa+=r;Bn.t_d&&(r=Ag.OutlineElementReader.r2(b),aa=Bn.t_d.mPh(b.currentNode,k+r,aa+r,R,aa<k)-r)}return aa}Ssk(b,k,r){if(!b||!b.length)return!1;k=r?k?-1:1:this.SQh(b[0].node,k);return this.Tsk(b,
k,r)}p2m(b,k,r){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const y=b[0].node;
k=this.SQh(y,k);if(!this.rLm(y,r[0],k)||!this.oLm(b,k))return 8;this.Pr.m8();return 32}oLm(b,k){for(let r=0;r<b.length;r++){const y=new Wd.GraphIterator;y.set(b[r].node);let R=null;xg.OutlineElementNavigator.Fe(y);if(ie.ParagraphReader.yh(y)){if(R=y.currentNode,!R)return v.ULS.shipAssertTag(589592461,338,!R,"The paraNode is null for the list OE node"),!1}else if(!ie.ParagraphReader.yh(y)&&!Si.TableReader.isTable(y))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),
!1;y.mc();if(R){if(this.WXl(R)){const aa=R.Qz(),ta=Ag.OutlineElementReader.vBa(y);this.Ug.iwa(y,1,ta+k);aa&&this.Oj.oM(R,aa,this.Rd.og)}R.setValue(Te.a.WT,new Date)}}return!0}rLm(b,k,r){for(let y=0;y<bg.a.Tfa;y++){const R=this.LH.Tw(b,k,y);if(!R)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",k),!1;const aa=R.getValue(wc.a.fe);aa&&R.setValue(wc.a.fe,aa+r)}return!0}WXl(b){return b.hasProperty(wc.a.fe)||b.hasProperty(wc.a.ht)||b.hasProperty(wc.a.bC)}wsk(b){return this.Qtd(b,
1,!0)}Wsk(b){return this.Qtd(b,-1,!0)}SQh(b,k){var r=new Wd.GraphIterator;r.set(b);const y=Ag.OutlineElementReader.vBa(r),R=Ag.OutlineElementReader.zF(r),aa=Ag.OutlineElementReader.r2(r);r=Nf.OutlineReader.EL(b);Bn.lHd(b);b=(R?y-R:aa)%r;return k?-1*(b?b:r):r-b>Bn.Ryh?Bn.Ryh:r-b}Qeo(b,k){let r;const y=new Wd.GraphIterator;y.set(b);b=y.Pb(4).getValue(wc.a.listID);return({id:r}=this.LH.rMb(b,k)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}Tsk(b,k,r){var y=!1;for(let R=0;R<b.length;R++){y=
b[R];const aa=new Wd.GraphIterator;aa.set(y.node);rf.SelectionEditor.Pt(aa);if(!Ag.OutlineElementReader.Nh(aa))return Bn.Kc.Zb($c.a.vf,{["Reason"]:bd.a.DXa}),!1;if(this.Qtd(aa,k,r))y=!0;else return Bn.Kc.Zb($c.a.A0b,{["Reason"]:bd.a.dWe}),!1}return y}tDi(b,k){if(this.Qtd(b,k,!0)){var r=!1;if(Vh.ListReader.ei(b)){var y=new Wd.GraphIterator;y.ed(b);this.Cm.kD(y);var R=y.currentNode;y.mc();const ta=R.getValue(wc.a.listLevel);r=!0;var aa=R.getValue(wc.a.listID);if(aa=this.ULl(aa,ta+k))xg.OutlineElementNavigator.Fe(y),
ie.ParagraphReader.yh(y)&&Bn.iR.pM(aa,y.currentNode,!1),y.mc();else{aa=null;let Ya;xg.OutlineElementNavigator.Fe(y);ie.ParagraphReader.yh(y)&&(aa=y.currentNode);y.mc();Ya=aa?aa.Qz():null;this.RIj&&(aa||(xg.OutlineElementNavigator.Fe(y),ie.ParagraphReader.yh(y)&&(aa=y.currentNode),y.mc()),aa&&(aa.hasProperty(wc.a.fe)&&aa.removeProperty(wc.a.fe),aa.hasProperty(wc.a.ht)&&aa.removeProperty(wc.a.ht)));this.Pr.RTf(y,ta,k);R.setValue(wc.a.listLevel,ta+k);R.removeProperty(wc.a.Ifa);aa&&Ya&&(this.Oj.oM(aa,
Ya,this.Rd.og),this.Pr.m8());this.N7n(b,R)}}r||(r=Ag.OutlineElementReader.vBa(b),y=Ag.OutlineElementReader.zF(b),R=Nf.OutlineReader.EL(b.currentNode),k=this.SWk(b,r,y,k,R),this.Ug.iwa(b,1,k))}}Gim(b,k){const r=Ag.OutlineElementReader.vBa(b);var y=Ag.OutlineElementReader.zF(b);const R=Ag.OutlineElementReader.r2(b);let aa,ta;({Oo:b,marginLeft:aa,marginRight:ta}=Bn.lHd(b.currentNode));if(0<k){if(y=b-aa-ta,R&&R+k+Ka.App.Wwa>y||r+k+Ka.App.Wwa>y)return!1}else if(R&&0>r+k||0>r-y+k)return!1;return!0}Fim(b,
k){var r=this.Pr.Uw(b),y=r.level;const R=Nf.OutlineReader.EL(b.currentNode),aa=y+k;if(ao.a.URd<aa||aa<ao.a.j$e)return!1;const ta=b.currentNode;if(!Vh.ListReader.sr){var Ya=xg.OutlineElementNavigator.Fe(b);xg.OutlineElementNavigator.Xd(b);if(Ya.hasProperty(wc.a.fe)&&(Ya=Ya.getValue(wc.a.fe),R*(y+1)!==Ya))return!1}r=this.Cm.Tw(ta,r.listID,aa);return r?0<k&&r.hasProperty(wc.a.fe)&&(k=r.getValue(wc.a.fe),{Oo:b,marginLeft:r,marginRight:y}=Bn.lHd(b.currentNode),k+Ka.App.Wwa>b-r-y)?!1:!0:(v.ULS.shipAssertTag(590700875,
338,!!r),!1)}ULl(b,k){const r=this.oc.Np();for(let y=0;y<r.yN;y++){const R=r.Pla(y);if(this.Cm.Uyb(R)&&R.ia(wc.a.listID,this.Pr.X6+1)===b&&R.ia(wc.a.listLevel,-1)===k)return R}return null}N7n(b,k){xg.OutlineElementNavigator.Fe(b);if(ie.ParagraphReader.yh(b)&&b.currentNode.hasProperty(wc.a.fe)&&(k=this.Cm.QIc(k))){const y=Vh.ListReader.sr;if(y&&k.hasProperty(wc.a.ht)){var r=k.getValue(wc.a.ht);this.xCe.Ckb(b.currentNode,r)}k.hasProperty(wc.a.fe)&&(r=k.getValue(wc.a.fe),this.xCe.iwa(b,1,r));y&&k.hasProperty(wc.a.bC)&&
(k=k.getValue(wc.a.bC),this.xCe.uba(b.currentNode,k))}xg.OutlineElementNavigator.Xd(b)}static get iR(){return null!=Bn.bug?Bn.bug:Bn.bug=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get t_d(){return null!=Bn.Dqg?Bn.Dqg:Bn.Dqg=Va.a.instance.Pa("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Bn.yu||(Bn.yu=Va.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Bn.yu=b}static get Kc(){return Db.a.instance}static get Bg(){return Al.a.instance}static get qh(){return lk.PageNavigator.instance}static lHd(b){let k;
var r=np.WordSectionNavigator.instance.XI(b);k=Bn.Bg.ev(r);b=Bn.Bg.DI(r);r=Bn.Bg.eK(r);return{Oo:k,marginLeft:b,marginRight:r}}}Bn.Ryh=Rg.a.GA(.25);Bn.yu=null;Bn.Hsi=Rg.a.GA(-11);Object(m.a)(Bn,"OutlineElementIndentationEditor",null,[628,629]);var Jz=c(301),hj=c(474),ay=c(214),Kz;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(Kz||(Kz={}));Object(m.b)("StyleTargetType",Kz);var tw=c(169);class Cj{constructor(b,k){this.KC=null;this.AG=
k;this.Cf=b}get paragraphEditor(){return null!=this.jqg?this.jqg:this.jqg=Va.a.instance.resolve("Box4.IParagraphEditor")}get uF(){return null!=this.Tkg?this.Tkg:this.Tkg=Va.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Hj(){return null!=this.Yrg?this.Yrg:this.Yrg=Va.a.instance.Pa("Box4.Styles.StyleSettings")}get wi(){return null!=this.nlg?this.nlg:this.nlg=Va.a.instance.resolve("Box4.IFormattingEditor")}get oc(){return null!=this.Fug?this.Fug:this.Fug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get aca(){return this.KC||
(this.KC=new sw.WACStyleSet)}set aca(b){this.KC=b}get Wb(){return null!=this.Dkg?this.Dkg:this.Dkg=Va.a.instance.Pa("Box4.IFeatureHelper")}get No(){return this.AG.value}get Uj(){return null!=this.mmg?this.mmg:this.mmg=Va.a.instance.Pa("Box4.IInsertionPointFormatting")}get ySd(){return this.Cf||(this.Cf=Va.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=this.aig?this.aig:this.aig=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Rd(){return null!=
this.Ctg?this.Ctg:this.Ctg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Oj(){return null!=this.dtg?this.dtg:this.dtg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}bMl(b){const k=b.node;var r=this.Uj?this.Uj.SOh():null;if(r&&!r.equals(G.a.nil)){b=k.Mc;if(!b)return null;r=b.Db(r);if(!r||(r=new tw.a(r),1!==this.oc.Xw(r)))return null}else r=Kk.FormattingReader.Qr(b),r=Kk.FormattingReader.Eta(r);return r}sRn(b,k){const r=this.oc.Sx(k);
r&&r.wh(this.oc.rf(b))&&(this.N9f(k,r),this.Uj&&(this.Uj.z2a(),this.Uj.Skb(b,k)))}Vdk(b,k){if(k)if(k.$zb&&0<k.$zb.length){let R=new Ia.a;for(var r of k.$zb)R.add(r);if(k.xvf){k=Kk.FormattingReader.ejl(b);r=[];for(var y of k)y.formatting&&y.formatting.hn&&r.push(y.formatting.hn);if(0<r.length){y=Jz.APropertySet.mUh(r);k=new Ia.a;for(const aa of R)y.hasProperty(aa)||k.add(aa);R=k}}this.paragraphEditor.uZb(b,!0,R)}else this.paragraphEditor.uZb(b,!0);else Od.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}pM(b,
k,r,y=!1,R=!1,aa=!1,ta=null){if(ie.ParagraphReader.nc(k))if(b)if(this.oc.LI(b.ai()))if(2!==this.oc.Xw(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Ya=this.oc.Sx(k);if(Ya){var xb=this.oc.rf(b);if(!xb)v.ULS.shipAssertTag(593506377,324,!1);else if(Ya.wh(xb)){var Mb=null,cc=gh.a.instance.J(3)&&!y?k.Qz():null;r||(ta&&ta.nsk&&this.Wb&&this.Wb.isFeatureEnabled(106)?(this.Vdk(k,ta),this.Mmo(k,b,ta)):(Mb=this.No.IQf(Mb,k),this.paragraphEditor.uZb(k,!0)));this.N9f(k,Ya);gh.a.instance.J(8)||(b=Ya.wh(this.oc.rf(b)));
R&&cc&&cc.hasProperty(Hk.a.paragraphStyle)&&cc.removeProperty(Hk.a.paragraphStyle);k.properties.setValue(Hk.a.paragraphStyle,b.id);null!=hj.a.ae&&!hj.a.ae.WL&&this.Wb&&this.Wb.isFeatureEnabled(106)&&this.lij(k,b,ta);k.oJ=b;k.R3=null;for(r=0;r<k.qa.length;r++)k.qa.J(r).formatting&&k.qa.J(r).formatting.R5b();this.ySd.Uyb(b)&&(Mb||(Mb=new Wd.GraphIterator,Mb.set(k),Mb.rd(),xg.OutlineElementNavigator.Xd(Mb)),Vh.ListReader.ei(Mb)||(k.Vg(wc.a.fe,wc.a.NQ,wc.a.bC,wc.a.n_,wc.a.DOa,wc.a.Uv),this.fsd(Mb,b)));
this.Hj&&this.Hj.isProgressiveStyleEnabled&&null!=this.uF&&this.uF.hfc(xb);y||!cc||aa||this.Oj.oM(k,cc,this.Rd.og)}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,324,!1)}Mmo(b,k,r){const y=this.ySd.BF(b),R=this.ySd.Uyb(k);if(y){if(null!=hj.a.ae&&hj.a.ae.WL)this.lij(b,k,r);else{r=r&&!r.xvf&&r.$zb?r.$zb:null;var aa=this.ySd.XN(y);aa&&this.No.Lmo(y,k,r,aa.ur)}R||b.setValue(wc.a.Ifa,!1)}else R&&
b.setValue(wc.a.Ifa,!0)}lij(b,k,r){const y=b.Mc;if(b=this.characterPropertiesEditor.aLa(b)){var R=null==b.hn?new ay.a:b.hn.clone();mi.a.Qno(R,k,r&&!r.xvf&&r.$zb?r.$zb:null);R.Gma?k=y.UQ(R,!0):(y.Lu(R,null),k=R);b.Bj=k.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}fsd(){}J7d(b,k){if(k){v.ULS.shipAssertTag(593506371,324,k.isConnected,"paragraphNode not connected");var r=this.oc.Sx(k);r?(b=r.Bta(b))?this.oc.LI(b.ai())?this.pM(b,k,!1,void 0,void 0,
void 0,null):v.ULS.shipAssertTag(593506368,324,this.oc.LI(b.ai())):v.ULS.shipAssertTag(593506369,324,!!b):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}xXe(b,k=!1,r=!1){const y=this.oc.Sx(b).wh(gh.a.instance.J(8)?rj.StyleReader.wordStyleIdNormal:rj.StyleReader.styleIdNormal);this.pM(y,b,k,void 0,r)}N9f(b,k){(b=Cj.qh.pu(b))&&k.P_c(b,!1)}oUk(b){var k=null;if(this.Wb&&this.Wb.isFeatureEnabled(34)){if(!b||!b.count)return v.ULS.sendTraceTag(592221652,
3018,10,"No style IDs provided for delete."),!1;if(!k&&(k=mi.a.Vw(),!k))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.aca.ZN(k);if(!r)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var y=new Map;y.set("NumberOfStyles",b.count.toString());y.set("Source","DeleteStyleAPI");Ga.Health.instance.recordKpiUsage(Jo.a.wee,0,Jo.a.LB,y);y=0;const ta=(new Date).getTime();var R=null;let Ya=null,xb=null,Mb=null;
const cc=this.Wb.isFeatureEnabled(33)&&!0;cc&&(R=new rb.a,Ya=new rb.a,xb=new rb.a,Mb=new rb.a);for(var aa of b){if(!aa)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const jc=r.wh(aa);if(!jc||!this.oc.oe(jc,r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!jc,!!jc&&this.oc.oe(jc,r)),!1;const Mc=this.oc.Xw(jc);if(2!==Mc&&1!==Mc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Mc),!1;const fd=
this.oc.u2(jc,r);let Td=0;if(fd){if(!this.oc.oe(fd,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;Td=this.oc.Xw(fd);if(2!==Td&&1!==Td)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Mc,Td),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let ne=this.Cyb(jc,r);if(!ne)return!1;y++;cc&&(1===Mc?(Ya.add(aa),Mb.add(jc.id)):(R.add(aa),
xb.add(jc.id)));if(fd){ne=this.Cyb(fd,r);if(!ne)return!1;y++;cc&&(1===Td?(Ya.add(this.oc.rf(fd)),Mb.add(fd.id)):(R.add(this.oc.rf(fd)),xb.add(fd.id)))}}oc.a.gDb();r=mi.a.xif(r);aa=new sf.GraphTransaction(15);aa.Eb(k);cc&&this.stn(R,Ya,xb,Mb,k);k.setValue(Hk.a.kha,r);Od.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));aa.L6d();aa.dispose();k=(new Date).getTime();R=new Map;R.set("Source","DeleteStyleAPI");R.set("NumberOfStyles",b.count.toString());R.set("TrueStyleCount",y.toString());
R.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Xa.a,{extendedProperties:R,durationMs:k-ta});Ga.Health.instance.recordKpiSuccess(Jo.a.wee,b);return!0}return!1}stn(b,k,r,y,R){if(b&&b.count||k&&k.count)if(R){var aa=(new Date).getTime();if(R=this.Zrl(R)){for(;R.moveNext();){if(!ie.ParagraphReader.yh(R.iterator))continue;const ta=R.currentNode;this.btn(ta,b,r);this.ctn(ta,k,y)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
r-aa));y=new Map;y.set("Source","DeleteStyleRemoveStylesReferences");y.set("NumberOfStyles",(b.count+k.count).toString());b=Object.assign(new Xa.a,{extendedProperties:y,durationMs:r-aa});Ga.Health.instance.recordKpiSuccess(Jo.a.wee,b)}}else Od.b(577520338,3018,50,"PageContentNode not provided.");else Od.b(577520337,3018,50,"No style IDs provided")}btn(b,k,r){if(k&&k.count&&b){var y=b.RA;y&&y.hasProperty(Hk.a.paragraphStyle)&&r.contains(y.getValue(Hk.a.paragraphStyle))&&(y.removeProperty(Hk.a.paragraphStyle),
b.RA=y,b.Qz()&&this.Oj.oM(b,b.Qz(),this.Rd.og));(r=this.oc.Ao(b))&&(r=this.oc.rf(r))&&k.contains(r)&&this.xXe(b,!0,!0)}}ctn(b,k,r){if(b&&b.qa&&b.qa.length&&k&&k.count)for(let ta=0;ta<b.qa.length;ta++){var y=b.qa.J(ta);if(y&&y.formatting&&(y=y.formatting)&&y.Ob){var R=Kk.FormattingReader.Eta(y);R&&(R=this.oc.rf(R))&&k.contains(R)&&this.wi.nXe(y);if(R=y.Ob.qn){var aa=R.hn;aa&&(aa=aa.clone(),aa.hasProperty(Hk.a.xB)&&r.contains(aa.getValue(Hk.a.xB))&&this.orn(b,aa,R,y));gh.a.instance.J(3)&&(aa=ta===b.qa.length-
1?b.characterData.length:b.qa.J(ta+1).cp,this.Oj.eKb(b,y.Ob,y.Ob.cp,aa,R,y,this.Rd.og))}}}}orn(b,k,r,y){b&&k&&r&&y&&(b=b.Mc)&&(k.removeProperty(Hk.a.xB),k.Gma?k=b.UQ(k,!0):b.Lu(k,null),r.Bj=k.id,y.Ob.qn=r)}Zrl(b){if(!b)return null;b=Wd.GraphIterator.Za(b);return b.ro()?Pm.a.Lr(b,b.origin):null}Cyb(b,k){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.ai();return this.oc.LI(r)?k.qtn(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",
Kz[this.oc.Xw(b)]),r.set("IsCustomStyle",this.oc.oe(b,k).toString()),r.set("IsLinkedStyle",(!!this.oc.u2(b,k)).toString()),b=Object.assign(new Xa.a,{extendedProperties:r}),Ga.Health.instance.recordKpiFailure(Jo.a.wee,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}a$b(b,k,r,y){var R,aa,ta;if(this.Wb&&this.Wb.isFeatureEnabled(84)){if(!b)return v.ULS.sendTraceTag(591138959,
3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=mi.a.Vw(),!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const xb=this.aca.ZN(r);if(!xb)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=xb.wh(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Ya=this.oc.Xw(b);if(2!==Ya&&1!==Ya)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",
Ya),!1;Ga.Health.instance.recordKpiUsage(Jo.a.bbg,0,Jo.a.LB,new Map([["Source","ModifyStyleAPI"]]));Ya=Date.now();const Mb=new sf.GraphTransaction(15);let cc,jc;try{Mb.Eb(r);if(!(y&&0!=y.length||k&&0!=k.count))return!1;if(y&&0!=y.length){if(null===(R=hj.a.ae)||void 0===R?0:R.GOc)cc=mi.a.IGd(b);if(!xb.$Uk(b,y))return this.Hua("ModifyStyleAPI",b,xb,Ya,"UnableToDeleteStyleProperties"),!1}if(k&&0!=k.count){const ye=xb.Qoo(b,k);if(null===(aa=hj.a.ae)||void 0===aa?0:aa.GOc)jc=mi.a.IGd(b);if(!ye)return this.Hua("ModifyStyleAPI",
b,xb,Ya,"UnableToModifyStyle"),!1}(null===(ta=hj.a.ae)||void 0===ta?0:ta.GOc)&&this.tLm(b,r,jc,cc);oc.a.gDb();const Mc=mi.a.xif(xb);r.setValue(Hk.a.kha,Mc);Od.b(572302818,3018,50,String.format("Style Object Ids - {0}",Mc));const fd=Date.now(),Td=new Map([["Source","ModifyStyleAPI"]]),ne=Object.assign(new Xa.a,{extendedProperties:Td,durationMs:fd-Ya});Ga.Health.instance.recordKpiSuccess(Jo.a.bbg,ne);return!0}finally{Mb&&Mb.dispose()}}return!1}tLm(b,k,r,y){var R,aa;if(null!==b){var ta;y&&((ta=null===
(R=this.No)||void 0===R?void 0:R.lde(k,y,b,!0))||Od.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((ta=null===(aa=this.No)||void 0===aa?void 0:aa.lde(k,r,b,!1))||Od.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}Hua(b,k,r,y,R){const aa=Date.now();b=new Map([["Source",b],["StyleType",Kz[this.oc.Xw(k)]],["IsCustomStyle",this.oc.oe(k,r).toString()],["IsLinkedStyle",(!!this.oc.u2(k,r)).toString()]]);
y=Object.assign(new Xa.a,{extendedProperties:b,durationMs:aa-y});Ga.Health.instance.recordKpiFailure(Jo.a.bbg,R,!1,!0,y)}static get qh(){return lk.PageNavigator.instance}}Object(m.a)(Cj,"WACStyleEditor",null,[1011]);class hx extends Cj{constructor(b,k,r){super(b,r);this.O4=k}get Pr(){return this.O4.value}fsd(b,k){this.Pr.fsd(b,k)}}Object(m.a)(hx,"WACStyleEditor",Cj,[]);var Jj=c(46);class AA{e3a(b,k){b.properties.setValue(wc.a.marginTop,k)}c3a(b,k){b.properties.setValue(wc.a.marginBottom,k)}Zga(b,
k){b.properties.setValue(wc.a.marginLeft,k)}d3a(b,k){b.properties.setValue(wc.a.marginRight,k)}pZf(b,k){b.properties.setValue(wc.a.Oo,k)}oZf(b,k){b.properties.setValue(wc.a.ey,k)}n0i(b,k){b.properties.setValue(wc.a.Zki,k)}bKb(b,k){b.properties.setValue(Jj.a.LC,k)}zKn(b,k){b.properties.setValue(Jj.a.iW,k)}dec(b,k){b.properties.setValue(Jj.a.Mx,k)}}Object(m.a)(AA,"WordSectionEditor",null,[427]);class mt{get name(){return"WordEditor.OutlineLevelEditors"}zc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",
()=>new AA).as("Box4.IWordSectionEditor").singleInstance();n.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new rw(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Bn(gn.a.$La,b.resolve("WordEditor.List.IFlatListReader"),b.Ze("Box4.IOutlineElementEditor"),b.Ze("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Bn(gn.a.$La,b.resolve("WordEditor.List.IFlatListReader"),b.Ze("Box4.IOutlineElementEditor"),b.Ze("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new rq).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new gx.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),
new sw.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new hx(b.resolve("Box4.List.IListReader"),b.Ze("WordEditor.IFlatListEditor"),b.Ze("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Pc(new mt)}}Object(m.a)(mt,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var gs=c(1184),ix=c(536),uw=c(798),Sy=c(117),cv=c(316);class hs{constructor(b,k,r,y,R,aa){this.Cf=
R;this._pageContent=r;this.Xrb=Array(hs.Tfa);this.xVb=Array(hs.Tfa);this.A2g=Array(hs.Tfa);this.rFe=Array(hs.Tfa);this.HZg=Array(hs.Tfa);this.k1=y;this.vxc=aa;for(y=0;y<hs.Tfa;y++){var ta=this.TUh(b,y,r,R);ta?(aa=ta.ia(Te.a.jX,bg.a.Yi),ta=ta.ia(wc.a.TYc,bg.a.Yi)):ta=aa=bg.a.Yi;this.xVb[y]=aa!==bg.a.Yi?aa:bg.a.JDc;this.rFe[y]=ta===bg.a.Yi?y-1:ta-1;hs.Z6(k)&&(this.A2g[y]=bg.a.Yi,this.HZg[y]=bg.a.Yi);this.Xrb[y]=this.xVb[y]}}TUh(b,k,r,y){y.j2(r);return op.a.getInstance().qNc&&this.vxc?this.Cf.Rff(b,
k,this.k1,r):this.Cf.o3b(b,k,r.Mc,r)}restart(b){this.Xrb[b]=this.xVb[b]}Yui(b){for(var k=0;k<b;k++)this.Xrb[k]===this.xVb[k]&&this.Xrb[k]++;for(k=b+1;k<hs.Tfa;k++)this.rFe[k]>=b&&this.restart(k);return this.Xrb[b]++}static Z6(b){return!!b&&b.isFeatureEnabled(72)}}hs.Tfa=9;Object(m.a)(hs,"AWordList",null,[30]);class by{constructor(b,k,r,y){this.y8a=new tn.ScriptSharpLegacyMap;this.Cf=b;this.xz=k;this.k1=r;this.vxc=y}Gs(b,k){this.y8a.ub(b)||this.y8a.Z(b,new hs(b,k,this.xz,this.k1,this.Cf,this.vxc));
return this.y8a.J(b)}rEf(b,k,r){return this.Gs(b,r).Yui(k)}}Object(m.a)(by,"AListNumberingMap",null,[1303]);class Jt extends hs{constructor(b,k,r,y,R,aa){super(b,k,r,y,R,aa)}WDl(b,k,r,y){y.j2(r);return op.a.getInstance().qNc&&this.vxc?this.Cf.Qzl(b,k,this.k1):this.Cf.Pzl(b,k,this._pageContent.Mc)}fij(b,k,r){var y=this.WDl(b,k,this._pageContent,this.Cf);y?(b=y.ia(Te.a.jX,bg.a.JDc),y=y.ia(wc.a.TYc,bg.a.Yi),this.Xrb[k]=this.A2g[k]=this.xVb[k]=b,y!==bg.a.Yi&&(this.HZg[k]=this.rFe[k]=y-1)):r&&(y=this.TUh(b,
k,this._pageContent,this.Cf),b=bg.a.JDc,y&&(b=y.ia(Te.a.jX,bg.a.JDc)),this.Xrb[k]=this.xVb[k]=b)}}Object(m.a)(Jt,"WordList",hs,[]);class Lz extends by{constructor(b){super(b.hd,b.pageContentNode,b.uJb,b.dlj);this.YXg=new rb.a}pzl(b,k,r){let y;op.a.getInstance().RT?{value:y}=this.Cf.yQ.Bc(b,y):{value:y}=this.Cf.xQ.Bc(b,y);this.y8a.ub(y)||this.y8a.Z(y,new Jt(b,r,this.xz,this.k1,this.Cf,this.vxc));if(!this.YXg.contains(b))for(this.YXg.add(b);k<bg.a.Tfa;k++)this.y8a.J(y).fij(b,k,!1);else if(!k)for(k+=
1;k<bg.a.Tfa;k++)this.y8a.J(y).fij(b,k,!0);return this.y8a.J(y)}rEf(b,k,r){return hs.Z6(r)?this.pzl(b,k,r).Yui(k):super.rEf(b,k,r)}}Object(m.a)(Lz,"ListNumberingMap",by,[]);class jx{constructor(){this.Xfa=0;this.Lmj=!1}}Object(m.a)(jx,"LastNumber",null,[]);var rB=c(573),kx=c(716),vw=c(874);class sB{constructor(){this.startAt=this.v_=0}}Object(m.a)(sB,"WordListRestartInfo",null,[]);class Cn{constructor(b,k,r,y){this.pWd=!1;this.Pr=b;this.ufi=r;this.Y5b=y;this.Yr=this.Pr.Uw(k);this.outlineElement=new Wd.GraphIterator;
this.outlineElement.ed(k)}static get hd(){return Cn.Cf||(Cn.Cf=Va.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){Cn.Cf=b}static get ae(){return op.a.getInstance()}static ral(b,k,r,y=!1,R=!1){var aa=k.currentNode;let ta=null;new Wd.GraphIterator;let Ya=!1,xb=!1;k=k.Nwa();const Mb=Pm.a.Zp(k);Mb.moveNext();for(k=Mb.iterator;k.currentNode!==aa;){let jc=xb=Ya=!1;var cc=!1;Vh.ListReader.sr&&(cc=Cn.C0k(k));if(Ag.OutlineElementReader.Nh(k)&&!cc){cc=!1;if(k.fq(4))if(Cn.qwi(k,r,!0,y,R))if(Vh.ListReader.wZ){if(jc=
!0,ta=new Cn(b,k,!1,!1),Mb.moveNext(),Mb.iterator===aa&&(Ya=!0),y)break}else ta=new Cn(b,k,!1,!1),Ya=!0;else Ag.OutlineElementReader.isEmpty(k,!1)||(cc=!0),xb=!0;else!Ag.OutlineElementReader.isEmpty(k,!1)&&k.Peb(12)&&(Ag.OutlineElementReader.EP(k)||(cc=!0));!y&&cc&&ta&&(!r.propertySet.hasProperty(wc.a.listLevel)&&Vh.ListReader.sr?ta=null:ta.Yr.level=0)}jc||Mb.moveNext();k=Mb.iterator}ta&&(ta.Y5b=Ya);if(!ta&&k.yf(1))for(aa=!0;k.currentNode;){if(Ag.OutlineElementReader.Nh(k)){if(k.fq(4)&&Cn.qwi(k,r,
!1,y,R)){ta=new Cn(b,k,!0,aa);break}if(!Ag.OutlineElementReader.isEmpty(k,!1))break}if(!k.yf(1))break;aa=!1}ta&&(ta.pWd=xb);return ta}static C0k(b){var k=b.Pb(2);if(!k)return!1;k=ie.ParagraphReader.yh(b)&&Cn.Njm(k);b.mc();return k}static Njm(b){return Qm.a(b,8)}static qwi(b,k,r,y=!1,R=!1){Cn.hd.kD(b);var aa=b.currentNode;b.mc();if(aa.ia(wc.a.Ifa,!1)&&!Cn.ae.iEb)return!1;const ta=Cn.hd.XN(aa);(b=k.ur===ta.ur)&&k.listStyle&&1!==k.xr&&(b=k.listStyle===ta.listStyle);Cn.hd.yr&&b&&(k.Kma&&1!==k.xr||k.h2b||
R)&&(b=Cn.Mhm(k,ta),k.ur||(b=b&&k.font===ta.font));if(1===k.xr)if(1===ta.xr&&ta.propertySet.hasProperty(Gh.a.zhb))b=k.b4===ta.b4;else return!1;b&&k.ur&&k.$z!==bg.a.Yi&&(b=ta.jq,r&&(y&&1===k.$z&&1===b||b++),b=k.$z===b);b&&(y||k.h2b)&&(k=k.propertySet.ia(wc.a.listID,0),aa=aa.ia(wc.a.listID,0),0<k&&0<aa&&(b=k===aa));return b}static Mhm(b,k){k=k.iSd;b.Kma&&(k=k.replace(RegExp("%\\d"),"%1"));return k.toLocaleLowerCase()===b.iSd.toLocaleLowerCase()}static sal(b,k,r){var y=k.currentNode;let R=null;const aa=
new Wd.GraphIterator,ta=b.JL(y,r);var Ya=!1;let xb=!1;aa.ed(k);aa.mc();for(aa.Pb(1);aa.currentNode!==y;)xb=Ya=!1,Ag.OutlineElementReader.Nh(aa)&&aa.fq(4)&&(k=b.Uw(aa),Cn.rwi(k,r,!0)?(R=new Cn(b,aa,!1,!1),Ya=!0):(xb=!0,k.listID===r.listID&&k.level<=ta.v_&&(R=null))),aa.yf(1);R&&(R.Y5b=Ya);if(!R&&aa.yf(1))for(y=!0;aa.currentNode;){if(Ag.OutlineElementReader.Nh(aa)&&aa.fq(4)){Ya=b.Uw(aa);if(Ya.listID===r.listID&&Ya.level<=ta.v_)break;if(Cn.rwi(Ya,r,!1)){R=new Cn(b,aa,!0,y);break}}if(!aa.yf(1))break;
y=!1}R&&(R.pWd=xb);return R}static rwi(b,k,r){let y=b.listID===k.listID&&b.level===k.level;y&&k.jq!==bg.a.Yi&&(b=b.jq,r&&b++,y=k.jq===b);return y}}Cn.Cf=null;Object(m.a)(Cn,"JoinTargetInfo",null,[]);class Ty{constructor(){this.action=0;this.Yr=null}}Object(m.a)(Ty,"ApplyListInfoWordResult",null,[]);class Fv{constructor(b,k,r){this.$co=b;this.Ffc=r;this.O1m=k;this.F8=r-k.jq;this.kUc=k.listID}get delta(){-1!==this.F8&&(this.F8=this.Ffc-this.O1m.jq);return this.F8}set delta(b){this.F8=b}}Object(m.a)(Fv,
"ListTransferInfo",null,[]);class mo extends hj.a{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc){super(b,r,xb);this.OUa=!1;this.emc=this.I9c=this.OPb=null;this.kp=R;this.LH=b;this.BRb=k;this.Hc=y;this.uLf={};this.kye=aa;this.Jd=ta;this.$m=Ya;this.Ic=Mb;this.DC=cc;this.nS=jc}get Z6(){return this.LH.qaa}get Cm(){return this.LH}get a8(){return this.nS}get oc(){return this.DC}get $s(){return this.Cm.$s}get zp(){return this.Cm.zp}get G9(){return this.Cm.G9}get yr(){return this.hd.yr}get X6(){return this.Cm.X6}set X6(b){this.Cm.X6=
b}get zNa(){return this.Cm.zNa}set zNa(b){this.Cm.zNa=b}get ilb(){return null!=this.srg?this.srg:this.srg=Va.a.instance.Pa("Box4.List.ISingleLevelListEditor")}pak(b,k,r,y){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const R=r.ia(td.a.eOd,!1);let aa=!1,ta=-1;!R||k.listStyle&&1!==k.xr||(aa=!r.ia(td.a.ivf,!1),ta=r.ia(td.a.Uwf,-1));b=this.YXb(b,k,!0,aa,ta,y,r);R||r.setValue(td.a.ivf,2===b.action);3===b.action&&!r.hasProperty(td.a.Uwf)&&b.Yr&&r.setValue(td.a.Uwf,b.Yr.level)}merge(b,
k,r,y=null){const R=Vh.ListReader.ei(b)||Vh.ListReader.ei(k);b=super.merge(b,k,r,y);R&&this.m8();return b}EIi(b,k){this.Htk(b,k)}Htk(b,k){b=this.hd.Mff(b);const r=this.hd.Mff(k);-1!==b&&-1!==r&&(b-=r,0<b?this.BRb.value.TDc(k,b):0>b&&this.BRb.value.OOa(k,b,0))}vPi(b){this.hd.kD(b);this.leaveList(b);b.Hg();gh.a.instance.J(3)&&this.m8()}Xco(b,k,r,y){var R=Wd.GraphIterator.Za(r);R=this.Uw(R);this.Yco(R,b,k,r,y);Ka.App.whb&&!hj.a.ae.WL&&this.Zco(r,y)}Uw(b){this.hd.kD(b);const k=this.Sea(b.currentNode);
b.mc();return k}IOn(b,k){this.hd.kD(b);b.currentNode.setValue(wc.a.listID,k);k=this.Sea(b.currentNode);b.mc();return k}Sea(b){const k=new uw.a;if(gh.a.instance.J(3)){var r=this.hd.GL(b,!1,!0);k.listID=r.listId;k.level=r.listLevel}else k.listID=b.ia(wc.a.listID,0),k.level=b.ia(wc.a.listLevel,-1);k.Ifa=b.ia(wc.a.Ifa,!1);this.yr&&(r=this.OGd(b),k.tMn(r));k.jq=b.ia(hj.a.ae.ry,bg.a.Yi);k.IEc=b.ia(hj.a.ae.pJ,bg.a.Yi);return k}ZXb(b,k){b||Db.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});
k||Db.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});b.setValue(wc.a.listID,k.listID);b.setValue(wc.a.listLevel,k.level);k.Ifa&&b.setValue(wc.a.Ifa,!0)}fjj(b){this.Cm.j2(b);b=mo.qh.pu(b);let k=b.ia(wc.a.zp,null);k=k?Array.clone(k):[];b.setValue(wc.a.zp,k);this.Cm.fDb()}q$i(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}yzl(b){b=b.view;if(!b.Cb||!b.Cb.ib)return null;b=Xt.OutlineElementGeneralizer.qla(b.Cb.ib,
!1);if(1!==b.length)return null;b=Wd.GraphIterator.Za(b.getContext(0).node);if(!Vh.ListReader.ei(b))if(14===b.Ud().type){const k=this.Cm.tSl(b.currentNode);k&&b.set(k)}else Od.b(589177753,393,15,"Encountered an OE of non list type."),b.mc();b.rd();return b}gNk(b,k,r,y){const R=b.xI(),aa=new uw.a;aa.listID=this.Svh(b);this.Z6?(aa.qSd=hj.a.ae.RT?this.Tvh(b):this.Kvh(b),this.hMi(b,aa.listID,aa.qSd)):this.jMi(b,aa.listID);aa.u0i(k.propertySet,this.MQc(r));this.ZAd(b);r=this.ZUh(b,k);for(let Ya=0;9>Ya;Ya++){const xb=
new Sy.a;R.Ad.Lu(xb);this.iMi(b,this.Z6?G.a.nil:xb.id,this.Z6?xb.id:G.a.nil);this.G3j(xb,k.ur,Ya);this.Z9g(xb,r,Ya);var ta=y.lFb[Ya];ta=6===ta?Os.a.KP(1,1):Os.a.KP(0,ta);ta.Yma&&xb.setValue(Te.a.h3,ta.Yma);k.$z!==bg.a.Yi&&Ya===aa.level&&xb.setValue(Te.a.jX,k.$z);y.gBa&&y.gBa[Ya]&&xb.setValue(Te.a.font,y.gBa[Ya]);ta=y.OQc[Ya];v.ULS.shipAssertTag(22127636,338,!!ta);xb.setValue(wc.a.Vr,ta);xb.setValue(wc.a.Daa,y.ARd[Ya]);cv.a.Z7d(y.b4,xb)}return aa}fNk(b,k,r){const y=b.xI(),R=new uw.a;R.listID=this.Svh(b);
this.Z6?(R.qSd=hj.a.ae.RT?this.Tvh(b):this.Kvh(b),this.hMi(b,R.listID,R.qSd)):this.jMi(b,R.listID);R.u0i(k.propertySet,this.MQc(r));if(!k.listStyle)switch(R.level%3){case 0:k.L7(k.listType,1);break;case 1:k.L7(k.listType,2);break;case 2:k.L7(k.listType,3)}this.ZAd(b);r=this.ZUh(b,k);for(let aa=0;9>aa;aa++){const ta=new Sy.a;y.Ad.Lu(ta);this.iMi(b,this.Z6?G.a.nil:ta.id,this.Z6?ta.id:G.a.nil);this.F3j(ta,k.ur,aa);this.Z9g(ta,r,aa);this.yr&&(2===aa%3&&k.ur?ta.setValue(wc.a.Daa,"right"):ta.setValue(wc.a.Daa,
"left"));aa===R.level&&(k.Yma&&ta.setValue(Te.a.h3,k.Yma),k.$z!==bg.a.Yi&&ta.setValue(Te.a.jX,k.$z),this.yr&&(k.ur?this.A0i(k,ta,aa):(mo.x0i(k,ta),mo.z0i(k,ta)),mo.y0i(k,ta)),Hu.a.qOc&&k.h2b&&ta.jI(k.propertySet,wc.a.listID,wc.a.listLevel))}return R}A0i(b,k,r){b.Kma?(b=b.levelText,b=A.a.replaceAll(b,"%1","%"+(r+1))):b=b.cNc||b.bfa?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);k.setValue(wc.a.Vr,b)}s5i(b,k,r,y){if(b.cNc)return!1;if(1===b.xr)return y;if(y)return!0;if(k){y=b.listType===
k.listType;const R=!b.listStyle&&b.$z===bg.a.Yi;let aa=b.listStyle===k.listStyle&&b.$z===k.$z;this.yr&&(b=(!b.Kma||this.oWf(k,b))&&!r,aa=aa&&b);return y&&(R||aa)}return!1}ZAd(b){this.OPb||(this.OPb=b.ia(wc.a.QSk,null));this.I9c||(this.I9c=b.ia(wc.a.PSk,null));this.emc||(this.emc=b.ia(wc.a.RSk,null))}MQc(b){720>b&&(b=0);b=Math.floor(b/720);0>b&&(b=0);8<b&&(b=8);return b}jMi(b,k){const r=b.ia(wc.a.$s,null),y=r?r.length:0,R=Array(y+1);let aa=0;for(;aa<y;aa++)R[aa]=r[aa];R[aa]=k;b.setValue(wc.a.$s,R);
this.Cm.fDb()}hMi(b,k,r){this.KOe(wc.a.$s,b,k);if(hj.a.ae.RT){this.KOe(Jj.a.x$b,b,r);var y=this.Cm.KGd(b);y.add(k,r);b.setValue(Jj.a.yQ,kx.b(gs.a.Lgc(y)))}else this.KOe(wc.a.G9,b,r),y=this.Cm.JGd(b),y.add(k,r),b.setValue(wc.a.xQ,kx.b(gs.a.Lgc(y)))}iMi(b,k,r){this.Z6?(this.O9g(wc.a.zp,b,r),this.O9g(wc.a.p3,b,k)):(r=(r=b.ia(wc.a.zp,null))?Array.clone(r):[],r.push(k),b.setValue(wc.a.zp,r),this.Cm.fDb())}KOe(b,k,r){const y=k.ia(b,null),R=y?y.length:0,aa=Array(R+1);let ta=0;for(;ta<R;ta++)aa[ta]=y[ta];
aa[ta]=r;k.setValue(b,aa)}O9g(b,k,r){let y=k.ia(b,null);y=y?Array.clone(y):[];y.push(r);k.setValue(b,y)}F3j(b,k,r){var y=r%3+1;if(Vh.ListReader.sr){const R=k?this.emc:this.I9c;R&&r<R.length?b.setValue(wc.a.ht,R[r]):b.setValue(wc.a.ht,360)}y=Vh.ListReader.wZ?Os.a.KP(k?0:1,this.q$i(y),null,0,r):Os.a.KP(k?0:1,this.q$i(y));b.Bs(y.propertySet);b.setValue(wc.a.kTe,k?-1:-2);this.yr&&(k?b.setValue(wc.a.Vr,"%"+(r+1)+"."):(b.setValue(Te.a.font,this.erl(r)),b.setValue(wc.a.Vr,String.fromCharCode(this.Vql(r)))),
cv.a.lec(2,b))}G3j(b,k,r){if(Vh.ListReader.sr){const y=k?this.emc:this.I9c;y&&r<y.length?b.setValue(wc.a.ht,y[r]):b.setValue(wc.a.ht,360)}b.setValue(wc.a.kTe,k?-1:-2);cv.a.lec(1,b)}Vql(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}erl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}Svh(b){if(this.Z6)this.X6<bg.a.ZQc&&this.Cm.j2(b),this.X6=this.WVh(this.$s,this.X6,bg.a.ZQc);else{if(this.X6<
bg.a.ZQc&&(this.Cm.j2(b),this.$s&&this.zp)){b=this.$s.length;for(let k=0;k<b;k++)this.$s[k]>=this.X6&&(this.X6=this.$s[k])}this.X6+=1}return this.X6}Kvh(b){this.zNa<bg.a.Tpd&&this.Cm.j2(b);return this.zNa=this.WVh(this.G9,this.zNa,bg.a.Tpd)}Tvh(b){var k;this.Cm.j2(b);do b=Math.floor(Math.random()*(mo.gIm-mo.Osi))+mo.Osi;while(null===(k=this.Cm.uGb)||void 0===k?0:k.includes(b));return b}WVh(b,k,r){if(k<r&&b){r=b.length;for(let y=0;y<r;y++)b[y]>k&&(k=b[y])}k++;return k}STf(b,k,r){mo.bPc||this.Y$e(b,
k,r,Object(u.a)(this,this.S0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.N0n,"siblingRenumberSimple"))}pwn(b,k,r,y=!1){this.Y$e(b,k,r,Object(u.a)(this,this.S0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.j7i,"siblingRenumberAndUpdateSublistsDelta"),null,y)}own(b,k,r){this.Vel(b,k,r,Object(u.a)(this,this.S0c,"siblingMatchesListAndLevel"),Object(u.a)(this,this.i7i,"siblingRenumberAndUpdateSublists"))}RTf(b,k,r){const y=Db.a.instance.qo(Wa.a.RTf);1>Math.abs(r)&&Db.a.instance.Zb("PossiblyIncorrectListPromoteDemote",
{["Reason"]:"DepthIsIncorrect"});(k<ao.a.j$e||k>ao.a.URd)&&Db.a.instance.Zb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"LevelHasInvalidRange"});(k+r<ao.a.j$e||k+r>ao.a.URd)&&Db.a.instance.Zb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"Level+DepthHasInvalidRange"});const R={};let aa=null;const ta=this.Uw(b);const Ya=b.currentNode,xb=ta.listID,Mb=k+r;let cc,jc=bg.a.Yi,Mc=!0,fd=!0,Td=!1;const ne=Array(9);let ye=!1,ff=!1;var Gd=new uw.a;Gd.listID=ta.listID;Gd.level=ta.level+r;Gd=this.Cm.Rea(b.currentNode,
Gd);var oe=this.hd.Gs(b);Gd=Gd.ur;const ze=oe.ur,ug=this.yr&&(Gd||ze);if(ze||Gd){var Yf=new uw.a;Yf.listID=ta.listID;Yf.level=k;R[k.toString()]=this.JL(Ya,Yf);oe=R[k.toString()].v_;Yf.level=Mb;R[Mb.toString()]=this.JL(Ya,Yf);cc=R[Mb.toString()].v_;for(var Aj=0;9>Aj;Aj++)ne[Aj]=!1;Aj=new Wd.GraphIterator;Aj.ed(b);Yf=Aj.Nwa();var cn=Pm.a.Lr(Aj,Yf);for(cn.moveNext();cn.moveNext();){Aj=cn.iterator;var Vl=void 0;let Rv;if(Aj.fq(4)&&(Yf=this.Uw(Aj),Yf.listID===xb)){var st=this.hd.Gs(Aj);var tt=st.ur;Yf.level<=
oe&&(Mc=!1);Yf.level<=cc&&(fd=!1);if(!Mc&&!fd)break;Rv=Yf.level.toString();R[Rv]||(R[Rv]=this.JL(Ya,Yf));st=R[Rv];this.Qxo(st,ne)||(st.v_>=k?(aa||(aa=this.ZYe(ta,b,R)),Vl=bg.a.Yi,aa[Rv]?Vl=!this.yr||tt?aa[Rv]+1:bg.a.Yi:Yf.level===Mb&&(Vl=!this.yr||tt?st.startAt:bg.a.Yi),Vl!==bg.a.Yi?(Yf.level!==Mb||Td||(jc=Vl,Td=!0,this.hd.kD(Aj),Aj.mc(),Vl++),this.Swb(Aj,Vl),aa[Rv]=Vl):ug&&this.U8f(Aj,Yf)):st.v_>=Mb?(aa||(aa=this.ZYe(ta,b,R)),Vl=ne[Yf.level]?!this.yr||tt?aa[Rv]+1:bg.a.Yi:!this.yr||tt?st.startAt:
bg.a.Yi,this.yr&&Vl===bg.a.Yi?ug&&this.U8f(Aj,Yf):this.Swb(Aj,Vl),aa[Rv]=Vl):Yf.level===k&&ze||Yf.level===Mb&&Gd?(this.hd.kD(Aj),Vl=Aj.currentNode,Aj.mc(),Vl=Vl.getValue(hj.a.ae.ry),tt=Vl===(st.startAt===bg.a.Yi?1:st.startAt)+1,Yf.level===k?!(0>r)&&tt||ye?ye=!0:Vl--:(ff?Vl--:0>r&&tt&&this.Hrf(Aj,st,null)&&(Vl--,ff=!0),Td||(jc=Vl,Td=!0),Vl++),this.Swb(Aj,Vl)):Yf.level!==k&&Yf.level!==Mb||!ug||this.U8f(Aj,Yf),ne[Yf.level]=!0)}}Gd&&!Td&&(k=R[Mb.toString()],ta.level=Mb,jc=this.oQc(ta,b,k).Xfa,jc===bg.a.Yi?
jc=k.startAt:jc++);Gd&&this.Swb(b,jc)}y.end()}ngh(){this.m8()}m8(){var b=null,k,r;if(gh.a.instance.J(3)){var y=new Wd.GraphIterator;if(b)if(8===b.type)y.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else y.set(Ka.App.xa.jb.Xc),mo.qh.I7f(y),b=mo.qh.pu(y.currentNode);if(y.Ab(7)||y.kd(7)){y=Pm.a.Lr(y,y.origin);var R=new Lz({hd:this.Cm,pageContentNode:b,uJb:null,dlj:!1});for(b=new Lz({hd:this.Cm,pageContentNode:b,uJb:null,
dlj:!1});y.moveNext();){var aa=y.iterator;if(!aa.fq(4)&&!aa.fq(31))continue;this.hd.hGb(aa);const Ya=aa.currentNode;aa.mc();if(!Ya){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",aa.Sd);continue}if(!this.Z6&&63!==Ya.type&&this.hd.XN(Ya).listType)continue;var ta=this.hd.GL(Ya,!1,!1);if(this.Z6&&ta&&this.hd.vPd(ta.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const xb=
Object(ia.a)(xn.AParagraphNode,xg.OutlineElementNavigator.Fe(aa,!0));xb&&(xb.qa?(null==xb.qa.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),aa.mc(),this.Z6&&this.Cm.j2(aa.currentNode),12===xb.type&&(xb.hj&&xb.RA.hasProperty(wc.a.listID)||null===(k=xb.qa.last)||void 0===k||!k.Zi)&&((aa=this.hd.GL(Ya,!0,!0))?this.C0i(Ya,b,hj.a.ae.Sic,aa):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ya.type)),
!ta||null!==(r=xb.qa.last)&&void 0!==r&&r.fi||!this.C0i(Ya,R,hj.a.ae.ry,ta)||(ta=Ya.getValue(hj.a.ae.ry),this.Z6&&this.hd.XN(Ya).listType||Ya.setValue(hj.a.ae.pJ,ta))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,376,7===y.Le,"Couldnt reach to page manifest node")}}C0i(b,k,r,y){r||v.ULS.shipAssertTag(571757918,393,!!r,"Prop definition is null");k=k.rEf(y.listId,y.listLevel,this.Ic);y=-1;b.hasProperty(r)&&(y=
b.getValue(r));return k===y||this.Z6&&63!==b.type&&this.hd.XN(b).listType&&(!hj.a.ae.xma||r!==hj.a.ae.Sic||1!==this.hd.XN(b).listType)?!1:(b.setValue(r,k),!0)}U8f(b,k){this.hd.kD(b);const r=b.currentNode;b.mc();r&&this.hd.paa(r)&&this.$$e(b,k,Object(u.a)(this,this.Jzf,"matchesListId"),Object(u.a)(this,this.G3f,"sublistsUpdateListItem"))}Hrf(b,k,r){let y=!1,R=!0,aa=0;const ta=this.Uw(b),Ya=b.currentNode;let xb=null;b=b.Nwa();b=Pm.a.Zp(b);for(b.Xm(vw.a.t0a,null);b.moveNext();){const Mb=b.iterator.currentNode;
if(Mb===Ya)break;if(!Vh.ListReader.M2(Mb))continue;const cc=this.Uw(b.iterator);cc.listID===ta.listID&&(cc.level>ta.level?(y=!0,xb=Mb,aa++):cc.level===ta.level?(R=!1,xb=null,aa=0):cc.level<=k.v_&&(R=!0,xb=null,aa=0))}return y&&R&&(!r||1===aa&&xb===r)}Qxo(b,k){for(b=b.v_;0<=b;b--)if(k[b])return!0;return!1}Swb(b,k){this.hd.kD(b);const r=b.currentNode;b.mc();const y=this.Uw(b);y&&this.Cm.g9b(r,y.listID,y.level)?this.own(b.currentNode,y,k):mo.bPc||(r.setValue(hj.a.ae.ry,k),r.setValue(hj.a.ae.pJ,k))}qwn(b,
k,r){const y={};let R=null;const aa=new Wd.GraphIterator;const ta=b.jq===k.startAt;let Ya=!1;var xb=new Wd.GraphIterator;xb.ed(r);var Mb=r.Nwa();Mb=Pm.a.Lr(xb,Mb);Mb.Xm(vw.a.t0a,null);Mb.moveNext();let cc=!1;for(;Mb.moveNext();)if(aa.ed(Mb.iterator),aa.fq(4)){var jc=this.Uw(aa);if(jc.listID===b.listID)if(jc.level>b.level)Ya=!0,xb=jc.level.toString(),y[xb]||(y[xb]=this.JL(r.currentNode,jc)),jc=y[xb].v_,jc===b.level&&(R||(R=this.ZYe(b,r,y)),R[xb]&&(jc=R[xb]+1,this.Swb(aa,jc),R[xb]=jc));else if(jc.level===
b.level||jc.level<=k.v_){cc=!0;break}}return!cc||ta&&Ya?null:aa}nwn(b){Vh.ListReader.ei(b)||Db.a.instance.Zb("PossiblyIncorrectListRenumber",{["Reason"]:ix.a.Tyb});const k=this.Uw(b);var r=this.JL(b.currentNode,k);const y=b.Pb(4);y.removeProperty(hj.a.ae.Sic);b.mc();const R=this.SGc(b,k,Object(u.a)(this,this.F3f,"sublistsEnsureSameList"),Object(u.a)(this,this.C$i,"sublistsUpdateLevel"));if(this.hd.Gs(b).ur){var aa=null;R&&(aa=this.Uw(R));aa&&aa.listID===k.listID&&aa.level===k.level?r=this.hd.Gs(R).jq:
(aa=this.oQc(k,b,r),r=aa.Xfa===bg.a.Yi?r.startAt:aa.Xfa+1);r!==bg.a.Yi&&(y.setValue(hj.a.ae.ry,r),y.setValue(hj.a.ae.pJ,r));R&&this.STf(R.currentNode,k,1)}b.u4b()&&Vh.ListReader.ei(b)&&(b=this.hd.Gs(b),b.ur&&(b.oea=b.jq))}get V4i(){return this.yr}cVh(b){const k=this.hd.Gs(b);if(this.yr){k.h2b=!0;this.hd.kD(b);const r=b.currentNode.ia(wc.a.listID,0);k.propertySet.setValue(wc.a.listID,r);b.kd(11)}return k}ZYe(b,k,r){const y={},R=new Wd.GraphIterator,aa=k.currentNode;var ta=k.Nwa();const Ya=Pm.a.Zp(ta);
for(Ya.Xm(vw.a.t0a,null);Ya.moveNext();){R.ed(Ya.iterator);if(R.currentNode===aa)break;if(R.fq(4)&&(ta=this.Uw(R),ta.listID===b.listID)){if(ta.level>b.level){this.hd.kD(R);var xb=R.currentNode;R.mc();y[ta.level.toString()]=xb.ia(hj.a.ae.ry,bg.a.Yi)}for(xb=ta.level;xb<=ao.a.URd;xb++){const Mb=xb.toString();y[Mb]&&(r[Mb]||(r[Mb]=this.JL(k.currentNode,ta)),r[Mb].v_>=ta.level&&delete y[Mb])}}}return y}oQc(b,k,r){const y=new Wd.GraphIterator,R=k.currentNode;let aa;var ta=bg.a.Yi;let Ya=!1,xb=!1,Mb=!1,
cc=null;var jc=k.Nwa();jc=Pm.a.Zp(jc);for(jc.Xm(vw.a.t0a,null);jc.moveNext();){y.ed(jc.iterator);if(y.currentNode===R)break;Ya=!1;y.fq(4)&&(aa=this.Uw(y),aa.listID===b.listID&&(aa.level===b.level?(this.hd.kD(y),ta=y.currentNode,y.mc(),ta=ta.ia(hj.a.ae.ry,bg.a.Yi),Ya=!0,cc=y.Phc(1),xb=!0):aa.level>b.level?Mb=!0:aa.level<=r.v_&&(ta=bg.a.Yi,Mb=xb=!1)))}!xb&&Mb&&(ta=r.startAt);Ya&&(Ya=k.Phc(1)===cc);b=new jx;b.Xfa=ta;b.Lmj=Ya;return b}zRi(b,k=!1,r=0){const y=this.Sea(b),R=this.JL(b,y),aa=this.Cm.Rea(b,
y);var ta=new Wd.GraphIterator;const Ya=aa.ur;let xb=R.startAt,Mb=!1,cc=!1;v.ULS.shipAssertTag(22127639,338,aa.bfa,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(wc.a.Vr,null));const jc=aa.listStyle;ta.set(b);if(ta.rd()&&(b=ta.BPa()))for(b=Pm.a.Zp(b),b.Xm(vw.a.t0a,y);b.moveNext();){ta=b.iterator.currentNode;if(!Vh.ListReader.M2(ta))continue;var Mc=this.Uw(b.iterator);k&&Mc.listID===r&&(Mc=this.IOn(b.iterator,y.listID));if(Mc.listID!==y.listID)continue;const fd=b.iterator.Pb(4);fd&&
b.iterator.mc();Mc.level>y.level?(this.Cm.g9b(fd,y.listID,Mc.level)&&this.fpf(ta,fd),cc=!0):(Mc.level<=R.v_?(xb=R.startAt,cc=Mb=!1):(Mc=this.Jti(b,jc),this.yr&&Mc.currentNode.setValue(wc.a.Vr,aa.iSd),{nXi:Mb,Xfa:xb}=this.BRi(Ya,cc,Mb,Mc,xb,ta)),mo.Gai(b))}}fpf(b,k){v.ULS.shipAssertTag(22819227,338,!!b&&!!k);Vh.ListReader.Yfa?k.setValue(Kc.a.fxf,G.a.create().toString()):b.setValue(Kc.a.fxf,G.a.create().toString())}lwn(b){if(!hj.a.ae.Cgb){var k=this.Sea(b),r;this.JL(b,k);var y=this.Cm.Rea(b,k),R=y.ur,
aa=Array(10),ta=Array(10),Ya=null;v.ULS.shipAssertTag(22127640,338,y.bfa,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(wc.a.Vr,null));var xb=y.listStyle;var Mb=new Wd.GraphIterator;Mb.set(b);if(Mb.rd()&&(Mb=Mb.BPa()))for(Mb=Pm.a.Zp(Mb),Mb.Xm(vw.a.t0a,k);Mb.moveNext();){var cc=Mb.iterator.currentNode;if(!Vh.ListReader.M2(cc))continue;const jc=this.Uw(Mb.iterator);if(jc.listID!==k.listID)continue;(r=Mb.iterator.Pb(4))&&Mb.iterator.mc();const Mc=jc.level;Ya=Ya?Ya.level:-1;k=this.Sea(r);
r=this.JL(r,k);this.fpf(cc,b);if(Ya<Mc||void 0===aa[Mc]||null===aa[Mc])aa[Mc]=r.startAt,ta[Mc]=!1;r=this.Jti(Mb,xb);r.currentNode.setValue(wc.a.Vr,y.iSd);({nXi:ta[void 0],Xfa:aa[void 0]}=this.BRi(R,Ya>Mc,ta[Mc],r,aa[Mc],cc));Ya=jc;mo.Gai(Mb)}}}Jti(b,k){b=b.iterator;this.hd.kD(b);hj.a.ae.Cgb||this.mOn(b.currentNode,k);return b}BRi(b,k,r,y,R,aa){b?(k&&!r&&R++,xg.OutlineElementNavigator.Xd(y),this.Swb(y,R),R++,r=!0,Vh.ListReader.sr&&(y.Pb(2),rB.a.i7b(y.currentNode)&&y.currentNode.uk(4,!0))):(y.currentNode.removeProperty(hj.a.ae.ry),
xg.OutlineElementNavigator.Xd(y));aa.uk(4,!0);(b=y.gp(16))&&b.uk(8,!0);return{nXi:r,Xfa:R}}mOn(b,k){b.setValue(wc.a.listStyle,k)}JL(b,k){const r=Db.a.instance.qo(Wa.a.JL),y=new sB;(b=this.Cm.Tw(b,k.listID,k.level))?(y.v_=b.ia(wc.a.TYc,k.level-1),y.startAt=b.ia(Te.a.jX,1)):Db.a.instance.Zb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return y}cPk(b){const k=br.a.instance.createInstance(1074135151);b.Rf(k,31)}Yco(b,k,r,y,R){const aa=this.createList(k);k.mc();this.ZXb(aa,
b);k=this.Cm.Rea(k.currentNode,b);k.listType||(aa.setValue(hj.a.ae.ry,b.jq),aa.setValue(hj.a.ae.pJ,b.IEc),this.t4d(aa,b,r?y:R,1));switch(k.listType){case 0:r="Numbering";break;case 1:r="Bullet";break;default:r="Invalid List Type"}n.AFrameworkApplication.ya.processAction(Wa.a.joinList,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",r);Vh.ListReader.wZ&&(aa.setValue(wc.a.listID,b.listID),aa.setValue(wc.a.listLevel,b.level))}Zco(b,k){b=Wd.GraphIterator.Za(b).Pb(4);k=Wd.GraphIterator.Za(k).Pb(4);
b.hasProperty(Te.a.fontColor)&&k.setValue(Te.a.fontColor,b.getValue(Te.a.fontColor));b.hasProperty(Te.a.fontSize)&&k.setValue(Te.a.fontSize,b.getValue(Te.a.fontSize));b.hasProperty(Te.a.font)&&k.setValue(Te.a.font,b.getValue(Te.a.font));b.hasProperty(wc.a.we)&&k.setValue(wc.a.we,b.getValue(wc.a.we));b.hasProperty(Te.a.bold)&&k.setValue(Te.a.bold,b.getValue(Te.a.bold));b.hasProperty(Te.a.italic)&&k.setValue(Te.a.italic,b.getValue(Te.a.italic));b.hasProperty(Te.a.superscript)&&k.setValue(Te.a.superscript,
b.getValue(Te.a.superscript));b.hasProperty(Te.a.subscript)&&k.setValue(Te.a.subscript,b.getValue(Te.a.subscript));b.hasProperty(Te.a.strikethrough)&&k.setValue(Te.a.strikethrough,b.getValue(Te.a.strikethrough))}pPi(b){if(gh.a.instance.J(10)){var k=this.oc.Ao(b);k?this.oc.rf(k)===rj.StyleReader.wordStyleIdListParagraph&&(k=this.oc.Sx(b),this.a8.pM(k.wh(rj.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.OUa&&n.AFrameworkApplication.K.$("WordEditorSkipTrackingChangeForList"))):v.ULS.shipAssertTag(8271188,
315,!1)}}gOn(b){if(gh.a.instance.J(10)){if(this.oc.rf(this.oc.Ao(b))===rj.StyleReader.wordStyleIdNormal){const k=this.oc.Sx(b);this.a8.pM(k.wh(rj.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Vg(wc.a.fe,wc.a.NQ,wc.a.bC,wc.a.n_,wc.a.ht,wc.a.qga);b.setValue(wc.a.DOa,0)}}wuk(b,k){const r=b.getValue(wc.a.listID),y=b.getValue(wc.a.listLevel);for(let aa=0;9>aa;aa++){const ta=this.Cm.Tw(b,r,aa);if(!ta)return Db.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var R=k.lFb[aa];
R=6===R?Os.a.KP(1,1):Os.a.KP(0,R);R.Yma&&ta.setValue(Te.a.h3,R.Yma);ta.hasProperty(Te.a.font)&&ta.removeProperty(Te.a.font);k.gBa&&k.gBa[aa]&&ta.setValue(Te.a.font,k.gBa[aa]);R=k.OQc[aa];v.ULS.shipAssertTag(22127641,338,!!R);ta.setValue(wc.a.Vr,R);ta.setValue(wc.a.xr,cv.a.i$b);cv.a.Z7d(k.b4,ta);ta.setValue(wc.a.Daa,k.ARd[aa]);ta.Vg(wc.a.TYc,Te.a.jX);this.fjj(b)}this.lwn(b);b=new uw.a;b.listID=r;b.level=y;return b}vmh(b,k,r,y=null){if(this.yr&&y)return this.wuk(b,y);y=b.getValue(wc.a.listID);const R=
b.getValue(wc.a.listLevel),aa=this.Cm.Tw(b,y,R);if(!aa)return Db.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),k&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",k.listStyle,k.listType,y,R),null;Hu.a.qOc&&k.h2b&&(aa instanceof Jz.APropertySet?aa.jI(k.propertySet,wc.a.listID,wc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===
aa||void 0===aa?void 0:aa.constructor.name));var ta=aa.ia(wc.a.xr,null);ta&&ta===cv.a.i$b&&this.uuk(b,y);if(!k.listStyle){ta=0;if(-1!==r){for(ta+=R-r;0>ta;)ta+=3;ta%=3}switch(ta){default:r=1;break;case 1:r=2;break;case 2:r=3}k.L7(k.listType,r)}k.Yma&&aa.setValue(Te.a.h3,k.Yma);this.yr&&(k.ur?(this.A0i(k,aa,R),aa.hasProperty(Te.a.font)&&aa.removeProperty(Te.a.font)):(mo.x0i(k,aa),mo.z0i(k,aa)),mo.y0i(k,aa));aa.Vg(wc.a.TYc,Te.a.jX,wc.a.POc);this.fjj(b);hj.a.ae.Cgb||this.zRi(b);b=new uw.a;b.listID=y;
b.level=R;return b}uuk(b,k){let r;for(let y=0;9>y;y++){r=this.Cm.Tw(b,k,y);if(!r){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",k,y);break}r.setValue(wc.a.xr,cv.a.MLd);r.removeProperty(Gh.a.zhb)}}n7d(b,k){const r=Db.a.instance.qo(Wa.a.n7d);this.BRb.value||Db.a.instance.Zb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.RTa?(r.properties.Z("PendingListInfo","true"),Vh.ListReader.ei(b)&&(r.properties.Z("RemoveCurrentListInfo",
"true"),this.OUa=!0,this.QJa(b,null,!0,!1,-1),this.BRb.value.OOa(b,-1,0),this.OUa=!1),this.YXb(b,this.RTa,!1,!0,-1,!1,null,Vh.ListReader.wZ),this.RTa=null):k||(r.properties.Z("CurrentlyUnderPastedList","true"),this.QJa(b,null,!1,!1,-1));r.end()}aZf(b,k,r,y){const R=Db.a.instance.qo(Wa.a.aZf);if(Vh.ListReader.ei(b)&&Ag.OutlineElementReader.isEmpty(b,!1))this.BRb.value.NVe(b,-1)?this.BRb.value.OOa(b,-1,0):this.QJa(b,null,!1,!1,-1);else{const aa=!r.cpBegin,ta=r.cpBegin===ie.ParagraphReader.textLength(y),
Ya=gh.a.instance.J(4)&&Ka.App.vd.Pp;let xb=!0;Ya&&aa&&!ta?(xb=!1,y=new Wd.GraphIterator,y.ed(b),y.rd(),this.Kh.TB(y,!0,!1)):y=this.Kh.Uta(b);this.Kh.Hba(b,y,r,!1,!0,xb,!1,k);!Ya||aa||ta||(k=mo.Sg.Tcf(r),Ka.App.vd.Mq.KG(k));this.OUa||(xg.OutlineElementNavigator.Fe(b),k=b.currentNode,xg.OutlineElementNavigator.Xd(b),Vh.ListReader.ei(b)&&k.hj&&!k.RA.hasProperty(wc.a.listID)&&(xg.OutlineElementNavigator.Fe(y),b=y.currentNode,y=new Sy.a,b.Mc.Lu(y),this.$m.oM(b,y,this.Jd.og)),this.m8())}R.end()}j8d(b,k){var r;
if(Vh.ListReader.ei(b))return!1;b.Pb(2);var y=Jd.a.vik;const R=[!0,!1].map(aa=>ie.ParagraphReader.eh(b.currentNode,aa,void 0,!1));b.mc();for(let aa=0;aa<R.length;aa++){const ta=R[aa];if(ta&&!Vh.ListReader.yma(ta))for(const Ya of y)if(Ya.test(ta.characterData))return y=null===(r=Ya.exec(ta.characterData))||void 0===r?void 0:r[0],this.Rkn(k,aa?"nextPara":"prevPara",y),!1}return!0}Rkn(b,k,r){const y=new Map;y.set("CurrentAutoListPreventedAutoListText",b);y.set("UndoAutoListPreferenceFoundIn",k);y.set("UndoAutoListPreferenceAutoListText",
r);Ga.Health.instance.recordKpiUsage(bg.a.jQc.Mqn,0,bg.a.LB,y)}SXn(b,k){return b&&k}LSf(b){for(let k=0;k<b.count;k++){const r=Wd.GraphIterator.Za(b.J(k));r.ro();this.gEa(r)}b.clear()}ARi(b){if(Vh.ListReader.M2(b)){if(!mo.bPc){const k=new Wd.GraphIterator;k.set(b);k.rd();this.nwn(k)}this.m8()}}IQf(b,k){b=new Wd.GraphIterator;b.set(k);b.rd();xg.OutlineElementNavigator.Xd(b);b.Oeb(k)||Db.a.instance.Zb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.QJa(b,null,!0,!1,-1);
return super.IQf(b,k)}s0i(b,k,r){this.Kh.iwa(b,k,r,!0)}w0i(b){b.L7(1,1)}fsd(b,k){const r=Db.a.instance.qo(Wa.a.Oek);if(this.oc.LI(k.ai())){if(Vh.ListReader.ei(b)&&this.YXb(b,null,!0,!1,-1),k=this.Cm.kVh(k)){r.properties.Z("EarlyReturn","False");this.Cm.Rea(b.currentNode,k);var y=Cn.sal(this,b,k),R=this.createList(b);b.mc();if(y)this.joinList(R,y,!0);else{if(y=this.SGc(b,k,Object(u.a)(this,this.F3f,"sublistsEnsureSameList"),Object(u.a)(this,this.C$i,"sublistsUpdateLevel"))){const aa=this.Uw(y);if(aa.listID===
k.listID&&aa.level<k.level&&this.hd.Gs(y).ur){const ta=this.JL(y.currentNode,aa);aa.jq===(ta.startAt===bg.a.Yi?1:ta.startAt)&&(aa.IEc=aa.jq,this.t4d(R,aa,y.currentNode,1))}}y=this.JL(R,k);b=this.oQc(k,b,y);b=b.Xfa!==bg.a.Yi?b.Xfa+1:y.startAt===bg.a.Yi?1:y.startAt;this.ZXb(R,k);R.setValue(hj.a.ae.ry,b);R.setValue(hj.a.ae.pJ,b)}R.setValue(wc.a.Ifa,!0);r.end()}}else Db.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}t4d(b,k,r,y,R=!1){this.Cm.g9b(b,k.listID,k.level)?
this.pwn(r,k,y,R):this.STf(r,k,y)}oeh(b,k,r,y,R=null){b=this.yr&&R?this.gNk(b,r,y,R):this.fNk(b,r,y);this.ZXb(k,b);r.listType||(y=r.$z,y===bg.a.Yi&&(y=1),k.setValue(hj.a.ae.ry,y),k.setValue(hj.a.ae.pJ,y));this.yr&&(r.bfa?(r=r.levelText,R||(r=r.replace("%1","%"+(b.level+1))),k.setValue(wc.a.Vr,r)):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),k.setValue(wc.a.Vr,"")));return b}leaveList(b){const k=this.Sea(b.currentNode);var r=this.Cm.Rea(b.currentNode,
k);const y=new Wd.GraphIterator;y.ed(b);y.mc();Vh.ListReader.ei(y)||Db.a.instance.Zb("PossibleErrorInLeaveList",{["Reason"]:ix.a.Tyb});var R=this.JL(y.currentNode,k),aa=k.jq===R.startAt;Vh.ListReader.Yfa&&mo.H9l(y);if(R=this.qwn(k,R,y)){const ta=this.hd.Gs(R);ta.oea=ta.ur?ta.jq:bg.a.Yi}r.ur&&R&&this.t4d(b.currentNode,k,R.currentNode,-1);aa&&R&&(r=this.Uw(R),this.Cm.Rea(R.currentNode,r).ur&&(aa=this.JL(R.currentNode,r),r.jq===(aa.startAt===bg.a.Yi?1:aa.startAt)+1&&this.Hrf(R,aa,y.currentNode)&&this.t4d(b.currentNode,
k,R.currentNode,-1,!0)));!R&&this.Cm.g9b(b.currentNode,k.listID,k.level)&&this.$$e(y,k,Object(u.a)(this,this.Jzf,"matchesListId"),Object(u.a)(this,this.G3f,"sublistsUpdateListItem"))}joinList(b,k,r,y=null){let R=null,aa=null;if(b)if(22!==b.type&&63!==b.type)v.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",b.type);else{gh.a.instance.J(3)&&(R=this.Cm.PYa(b),aa=R.Qz());(gh.a.instance.J(3)||hj.a.ae.aEb)&&this.ZXb(b,k.Yr);if(this.Cm.Rea(b,k.Yr).ur){var ta=
new Wd.GraphIterator;ta.set(b);ta.rd();ta.mc();let Ya=null;hj.a.ae.Pkm&&y&&!y.$co&&(Ya=this.Cm.lWh(ta.currentNode,k.Yr));const xb=this.fdl(ta,k,y);ta=this.Xcl(ta,b,k,r,y,xb);this.bdl(k,r,y,xb,ta);Ya&&xb&&this.STf(Ya,k.Yr,this.vqm(xb,Ya)-(k.Yr.jq-1))}gh.a.instance.J(3)||hj.a.ae.aEb||this.ZXb(b,k.Yr);gh.a.instance.J(3)&&R&&aa&&!this.OUa&&(this.$m.oM(R,aa,this.Jd.og),this.m8())}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}vqm(b,k){let r=0;const y=
this.Uw(b),R=new Wd.GraphIterator;R.set(b.currentNode);R.rd();b=Xj.a.Lr(R,R.Nwa());for(b.Xm(vw.a.t0a,null);b.moveNext();){if(!Vh.ListReader.ei(R))continue;this.hd.kD(R);const aa=this.Sea(R.currentNode);R.mc();if(R.currentNode.id===k.id)break;aa.listID===y.listID&&aa.level===y.level&&r++}return r}fdl(b,k,r){if(k.ufi)k=k.outlineElement;else{let y,R;r?(y=Object(u.a)(this,this.B$i,"sublistsEnsureSameListAsOriginal"),R=Object(u.a)(this,this.F$d,"sublistsUpdateId")):k.Y5b?(y=Object(u.a)(this,this.F3f,"sublistsEnsureSameList"),
R=Object(u.a)(this,this.F$d,"sublistsUpdateId")):(y=Object(u.a)(this,this.t6n,"sublistsEnsureLevelHigherThanOrEqualTo"),R=Object(u.a)(this,this.u6n,"sublistsUpdateLevelAndId"));k=this.SGc(b,k.Yr,y,R,r)}!k&&r&&(r=new Wd.GraphIterator,r.ed(b),r.u4b()&&Vh.ListReader.ei(r)&&(k=r));return k}Xcl(b,k,r,y,R,aa){y?(R?b=R.Ffc:(aa=this.JL(k,r.Yr),r=this.oQc(r.Yr,b,aa),b=r.Xfa!==bg.a.Yi?r.Xfa+1:aa.startAt===bg.a.Yi?1:aa.startAt),k.setValue(hj.a.ae.ry,b),k.setValue(hj.a.ae.pJ,b)):(b=bg.a.Yi,this.OOn(k,aa,r));
return b}bdl(b,k,r,y,R){if(y){var aa=!1,ta=this.Uw(y),Ya=ta.level===b.Yr.level,xb=!!r&&ta.listID===r.kUc;(ta.listID===b.Yr.listID||xb)&&Ya&&(Ya=this.JL(y.currentNode,ta),xb=Ya.startAt===bg.a.Yi?1:Ya.startAt,ta.jq===xb+1&&(aa=k?R===xb:this.Hrf(y,Ya,null)));if(!aa||r)r?(k=r.delta,R=Object(u.a)(this,this.L0n,"siblingMatchesLevel"),aa=Object(u.a)(this,this.M0n,"siblingRenumberAndUpdateListID")):(k=1,R=Object(u.a)(this,this.S0c,"siblingMatchesListAndLevel"),aa=Object(u.a)(this,this.j7i,"siblingRenumberAndUpdateSublistsDelta")),
ta=new Wd.GraphIterator,ta.set(y.currentNode),ta.rd(),this.hd.kD(ta),ta.mc(),this.Y$e(y.currentNode,b.Yr,k,R,aa,r)}}OOn(b,k,r){let y=null;k&&(y=this.Uw(k));if(y&&y.listID===r.Yr.listID&&y.level===r.Yr.level){const R=this.hd.Gs(k);let aa=R.jq;b.setValue(hj.a.ae.ry,aa);b.setValue(hj.a.ae.pJ,aa);Vh.ListReader.wZ&&(R.propertySet.setValue(wc.a.listID,y.listID),R.propertySet.setValue(wc.a.listLevel,y.level));if(!r.Y5b||r.pWd)r.ufi&&!r.pWd&&(this.hd.kD(k),b=k.currentNode,xg.OutlineElementNavigator.Xd(k)),
b.setValue(hj.a.ae.pJ,b.getValue(hj.a.ae.ry))}else k=r.Yr.jq+1,b.setValue(hj.a.ae.ry,k),b.setValue(hj.a.ae.pJ,k)}QJa(b,k,r=!0,y=!1,R=-1){this.YXb(b,k,r,y,R)}YXb(b,k,r=!0,y=!1,R=-1,aa=!1,ta=null,Ya=!1){const xb=Db.a.instance.qo(Wa.a.YXb),Mb=new Ty;Mb.Yr=null;Mb.action=0;if(!Ag.OutlineElementReader.Nh(b))return Db.a.instance.Zb("PossibleListStateNotUpdated",{["Reason"]:ix.a.DXa}),xb.end(),v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),Mb;let cc=-1,jc;jc=
Ag.OutlineElementReader.r2(b);var Mc=mo.qh.pu(b.currentNode);const fd=b.Pb(2);let Td=!1,ne=null;if(fd&&ie.ParagraphReader.nc(fd)&&(Td=!0,ne=fd,cc=this.kp.qT(b.currentNode).mt-this.kp.zF(fd).mt,Qm.a(fd,8)))return xb.end(),v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Mb;let ye=null;if(gh.a.instance.J(3)&&12===fd.type){if(ne.qa.last.fi)return v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),Mb;ye=ne.Qz()}xg.OutlineElementNavigator.Xd(b);
var ff=Ag.OutlineElementReader.vBa(b);const Gd=Ag.OutlineElementReader.zF(b),oe=Ag.OutlineElementReader.r2(b);let ze=null,ug=null;k&&(ze=k.QA,ug=this.infoAtLevel(b,k));let Yf=b.Pb(4);Yf?k&&16!==k.listType?(this.vmh(Yf,ug,R,ze,!!ta&&ta.hasProperty(td.a.ADf)),b.mc(),Mb.action=3,Mb.Yr=this.Uw(b)):(Td&&(this.pPi(ne),this.tsn(ne),ne.kW=null),y=this.hd.vPd(Yf.ia(wc.a.listID,0)),!hj.a.ae.xma||y?(Yf.D8d=!1,this.leaveList(b),b.Hg()):b.mc(),r&&Td&&(this.ZAd(Mc),Mc=ff+(oe?oe:-1*Gd)-this.emc[0],Mc=0>Mc?0:Mc,
this.Kh.iwa(b,1,Mc)),hj.a.ae.xma&&b.Pb(4)&&(Yf.D8d=!1,this.leaveList(b),b.Hg()),Mb.action=1,Mb.Yr=null,ne&&(this.Jd.og&&!this.OUa||hj.a.ae.xma&&!this.Jd.og&&ne.hj)&&(!ne.hj||ne.RA&&ne.RA.hasProperty(wc.a.listID))&&this.cPk(b)):k&&16!==k.listType&&(r=-1,ff=k.propertySet.ia(wc.a.listID,-1),Vh.ListReader.wZ&&Ya&&0<ff&&ff+""in this.uLf&&(r=this.uLf[ff+""]),k=k.iib?new Cn(this,Wd.GraphIterator.Za(k.iib),!1,!0):Cn.ral(this,b,ug,Ya,aa),this.$2l(b,ug,y,Ya,k),Yf=this.FMk(b),this.yr&&this.uMn(k,ug),Td&&!hj.a.ae.WL&&
this.l7d(Yf,fd,ta),void 0===k||null===k||aa||ug.ur!==this.hd.Rea(Yf,k.Yr).ur?this.kdm(ug,r,k,Yf)?(this.Kmo(ug,Yf,r,cc),Mb.action=3,Mb.Yr=this.vmh(Yf,ug,-1,ze)):(Mb.action=4,0<jc&&(cc+=jc),Mb.Yr=this.oeh(Mc,Yf,ug,cc,ze),this.Cmo(r,ff,Mb.Yr,Yf)):(Mb.action=2,Mb.Yr=k.Yr,ug.listStyle||(k.Y5b=!0),this.uqm(r,Mb.Yr,Yf,k)),Td&&this.gOn(fd),b.mc());gh.a.instance.J(3)&&!this.OUa&&(ne&&ye&&this.$m.oM(ne,ye,this.Jd.og),this.m8());xb.end();return Mb}FMk(b){hj.a.ae.xma&&b.Pb(31)&&b.Hg();return this.createList(b)}tsn(b){b.hasProperty(wc.a.fe)&&
b.removeProperty(wc.a.fe);b.hasProperty(wc.a.bC)&&b.removeProperty(wc.a.bC);b.hasProperty(wc.a.ht)&&b.removeProperty(wc.a.ht)}infoAtLevel(b,k){if(!k)return null;const r=k.QA;if(this.yr)if(1===k.xr){if(k.Kma&&!k.NI||!k.ZWe(!1))return k;let y;b=Ag.OutlineElementReader.vBa(b);y=this.MQc(b);const R=r.lFb[y];b=Os.a.Z1(k.propertySet,k.propertySet);6===R?b.L7(1,1):b.L7(0,R);b.o7d("multilevel");b.levelText=r.OQc[y];r.gBa&&r.gBa[y]&&(b.font=r.gBa[y]);b.Zs=r.ARd[y];b.b4=r.b4;b.rSd=k.rSd}else b=k;else b=k;return b}uMn(b,
k){b&&b.Yr&&(k.levelText=b.Yr.levelText,k.ur||(k.font=b.Yr.font))}$2l(b,k,r,y,R){if(r&&R){r=Ag.OutlineElementReader.vBa(b);if(this.yr){var aa=Ag.OutlineElementReader.r2(b);0<aa?r+=aa:(aa=Ag.OutlineElementReader.zF(b),0<aa&&(r-=aa))}k=k.propertySet.ia(wc.a.listLevel,-1);R.Yr.level=y&&0<=k?k:this.MQc(r);this.Cm.Rea(b.currentNode,R.Yr).listType||(y=this.JL(b.currentNode,R.Yr),b=this.oQc(R.Yr,b,y),R.Yr.IEc=R.Yr.jq=b.Xfa===bg.a.Yi?y.startAt-1:b.Xfa,R.Y5b=b.Lmj)}else R&&R.Yr&&k.propertySet&&k.propertySet.hasProperty(wc.a.listLevel)&&
(R.Yr.level=k.propertySet.getValue(wc.a.listLevel))}Cmo(b,k,r,y){Vh.ListReader.wZ&&(0>=b?this.uLf[k+""]=r.listID:(y.properties.setValue(wc.a.listID,b),r.listID=b))}Kmo(b,k,r,y){k.properties.setValue(wc.a.listID,r);k.properties.hasProperty(wc.a.listLevel)||(r=b.propertySet&&b.propertySet.hasProperty(wc.a.listLevel)?b.propertySet.wg(wc.a.listLevel):this.MQc(y),k.properties.setValue(wc.a.listLevel,r),this.yr&&(b.propertySet&&b.bfa&&(r=b.levelText.replace("%1","%"+(r+1)),k.setValue(wc.a.Vr,r)),b.propertySet&&
b.G4b&&!hj.a.ae.WL&&k.setValue(Te.a.font,b.font)))}uqm(b,k,r,y){if(Vh.ListReader.wZ){let R=null;0<b&&(R=new Fv(0,k,-1),R.kUc=b,R.delta=-1);this.joinList(r,y,!1,R)}else this.joinList(r,y,!1)}kdm(b,k,r,y){return!Vh.ListReader.wZ||0>=k?!1:void 0===r||null===r?(r=b.propertySet.ia(wc.a.listLevel,-1),0<=r&&(k=this.Cm.Tw(y,k,r))&&(k=k.ia(Te.a.h3,null))?b.Yma!==k:!1):b.ur!==this.hd.Rea(y,r.Yr).ur||b.Yma!==this.hd.Rea(y,r.Yr).Yma}ssn(b,k){const r=!!k&&ie.ParagraphReader.nc(k);let y=0,R=0;r&&(y=this.kp.qT(b.currentNode).mt,
R=this.kp.zF(k).mt);r&&this.pPi(k);b.Hg();r&&this.Kh.iwa(b,1,y-R)}f$(b,k,r,y=-1,R=!1,aa=null,ta=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ya=Db.a.instance.qo(Wa.a.f$),xb=this.Hc.Rc(15);xb.Qu(b);let Mb=null,cc=0;({tqm:Mb,DPm:cc,returnValue:y}=this.Ual(b,k,y,Mb,cc,R,aa));if(!Mb||ta&&(1===r||0>r-Mb.Yr.jq||2<r-Mb.Yr.jq))return xb.dispose(),Ya.end(),!1;for(;0<cc;)b.u4b(),cc--;this.Dmo(b,k,y,Mb);xb.dispose();Ya.end();return!0}Dmo(b,k,r,y){for(;b.u4b();)if(b.Pb(4)){if(this.Sea(b.currentNode).listID===
k.listID){k=new Fv(0,k,r);this.joinList(b.currentNode,y,!0,k);break}b.mc()}}Ual(b,k,r,y,R,aa=!1,ta=null){for(;b.oJd();){if(b.fq(4)){const Ya=this.Uw(b),xb=this.hd.Gs(b);if(xb.listType!==ta.listType){R++;continue}if(aa&&xb.listStyle!==ta.listStyle||!aa&&k.level<Ya.level){R++;continue}-1===r&&(r=Ya.jq+1);y=null;if(k.level===Ya.level||aa)hj.a.ae.iEb&&this.ilb&&this.ilb.ynf(b),y=new Cn(this,b,!1,!1);aa&&Ya.level!==k.level&&b.fq(4)&&(b.Pb(4).setValue(wc.a.listLevel,Ya.level),b.mc());break}R++}return{returnValue:r,
tqm:y,DPm:R}}OGd(b){let k=0;var r=0;gh.a.instance.J(3)&&(r=this.hd.GL(b,!1,!0),k=r.listId,r=r.listLevel);return this.hd.Tw(b,k,r)}startNewList(b,k,r){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(k){var y=Db.a.instance.qo(Wa.a.startNewList),R=this.Hc.Rc(15);R.Qu(b);var aa=Os.a.KP(0,k.listStyle,null,0,k.propertySet.ia(wc.a.listLevel,-1));b.Pb(4);var ta=b.currentNode.ia(wc.a.listID,0),Ya=b.currentNode.ia(wc.a.listLevel,-1);b.mc();aa.rSd=ta;var xb=k.propertySet.ia(wc.a.fe,
0);0<xb&&aa.propertySet.setValue(wc.a.fe,xb);-1===aa.propertySet.ia(wc.a.listLevel,-1)&&aa.propertySet.setValue(wc.a.listLevel,Ya);1===k.xr&&((Ya=new Pq.a,ta=k.Z1h(b.currentNode,ta),ta)?1===ta&&(aa.o7d(cv.a.i$b),aa.QA=Ya.T0e(Ya.hFf,Ya.iFf),aa.b4=aa.QA.b4):(aa.o7d(cv.a.i$b),aa.QA=Ya.a0e(),aa.b4=aa.QA.b4));k.Uea()&&1>r&&(r=1);aa.$z=r;ta=new Di.DictionaryPropertySet;ta=this.l1b(Wa.a.wH,ta);Ya=b.Pb(2);b.mc();b.Pb(4);k=this.Sea(b.currentNode);this.yr&&(xb=this.OGd(b.currentNode))&&(aa.levelText=xb.ia(wc.a.Vr,
""),aa.NI=42,aa.Zs=xb.ia(wc.a.Daa,"left"));this.ssn(b,Ya);({eCa:aa}=this.Mra(ta,b,aa,!0));b.Pb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);b.currentNode.setValue(wc.a.listLevel,k.level);b.mc();aa=new Cn(this,b,!1,!1);this.hd.kD(b);r=new Fv(1,k,r);this.joinList(b.currentNode,aa,!0,r);R.dispose();y.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}Vsf(b){if(!b)return!1;
const k=b.Pb(2);k&&b.mc();return gh.a.instance.J(3)&&k&&12===k.type&&k.qa&&k.qa.last&&k.qa.last.fi?!0:!1}S_d(b,k,r,y){return this.kye.S_d(b,k,r,y)}oWf(b,k){if(!b||!k)return!1;const r=b.propertySet.ia(wc.a.Vr,null);k=k.propertySet.ia(wc.a.Vr,null);if(!r||!k)return!1;const y=b.propertySet.ia(Te.a.font,null);b=b.propertySet.ia(Te.a.font,null);return r===k&&y===b}m1i(b,k,r){r||k.listType||(k.$z=b.ia(Te.a.jX,bg.a.Yi))}ZUh(b,k){if(!k)return null;const r=Array(9),y=k.rSd;if(!this.Vhm(k,b)||1>y)return null;
for(k=0;9>k;k++){const R=this.hd.Tw(b,y,k);if(null===R||void 0===R?0:R.hasProperty(wc.a.fe))r[k]=R.getValue(wc.a.fe);else return null}return r}Vhm(b,k){if(!b)return!1;const r=b.propertySet.ia(wc.a.listLevel,-1);b=b.propertySet.ia(wc.a.fe,-1);if(0>r||0>b)return!1;this.ZAd(k);return b!==this.OPb[r]?!0:!1}Z9g(b,k,r){b&&b.setValue(wc.a.fe,k?k[r]:this.OPb&&r<this.OPb.length?this.OPb[r]:720*(r+1))}Y$e(b,k,r,y,R,aa=null,ta=!1){const Ya=new Wd.GraphIterator,xb=this.JL(b,k);Ya.set(b);Ya.rd();b=Xj.a.Lr(Ya,
Ya.Nwa());b.Xm(vw.a.t0a,null);let Mb=-1;for(;b.moveNext();){if(!Vh.ListReader.ei(Ya))continue;this.hd.kD(Ya);const cc=Ya.currentNode,jc=this.Sea(cc);Ya.mc();if(y!==Object(u.a)(this,this.S0c,"siblingMatchesListAndLevel")||jc.listID===k.listID){if(ta){if(-1!==Mb&&Mb>jc.level)break;if(-1===Mb)Mb=jc.level;else if(jc.level!==Mb)continue}else{if(jc.level<=xb.v_)break;if(!y(k,jc,aa))continue}R(cc,r,k.listID,aa)}}}Vel(b,k,r,y,R){const aa=new Wd.GraphIterator,ta=this.JL(b,k);aa.set(b);aa.rd();if(Vh.ListReader.ei(aa)){this.hd.kD(aa);
b=aa.currentNode;var Ya=this.Sea(b);aa.mc();Ya.level<=ta.v_||y(k,Ya,null)&&R(b,r,k.listID,null)}}$$e(b,k,r,y,R=null){const aa=new Wd.GraphIterator;aa.ed(b);y(b,k,this.Uw(aa),aa,0);this.SGc(b,k,r,y,R)}SGc(b,k,r,y,R=null){let aa=new Wd.GraphIterator;const ta=this.JL(b.currentNode,k);let Ya=null,xb=0;var Mb=new Wd.GraphIterator;Mb.ed(b);Mb.Ab(10);const cc=Pm.a.Lr(Mb,Mb.origin);for(cc.moveNext();cc.moveNext();)if(Ya=null,aa=cc.iterator,1===aa.role&&(Ya=cc.currentNode,aa.fq(4)&&(Mb=this.Uw(aa),r(k,Mb,
R))))if(Mb.level>k.level)y(b,k,Mb,aa,xb),xb++;else if(Mb.level===k.level||Mb.level<=ta.v_)break;return Ya?aa:null}S0c(b,k){return k.listID!==b.listID||k.level!==b.level?!1:!0}L0n(b,k,r){return k.listID!==b.listID&&k.listID!==r.kUc||k.level!==b.level?!1:!0}Jzf(b,k,r){return k.listID===b.listID||r&&k.listID===r.kUc?!0:!1}j7i(b,k,r,y){const R=b.ia(hj.a.ae.ry,-1);this.i7i(b,R+k,r,y)}i7i(b,k,r,y){if(!mo.bPc){const R=b.ia(hj.a.ae.ry,-1);b.hasProperty(hj.a.ae.ry)&&-1===R&&Db.a.instance.Zb("PossibleIncorrectListRenumbering",
{["Reason"]:"PropertyNotExist"});b.setValue(hj.a.ae.ry,k);b.setValue(hj.a.ae.pJ,k)}b.setValue(wc.a.listID,r);k=this.Sea(b);b=Wd.GraphIterator.Za(b);b.rd();b.mc();this.$$e(b,k,Object(u.a)(this,this.Jzf,"matchesListId"),Object(u.a)(this,this.G3f,"sublistsUpdateListItem"),y)}N0n(b,k){const r=b.getValue(hj.a.ae.ry);b.setValue(hj.a.ae.ry,r+k);b.hasProperty(hj.a.ae.pJ);b.setValue(hj.a.ae.pJ,r+k)}M0n(b,k,r,y){let R,aa;R=this.Cm.PYa(b);aa=R.Qz();if(!mo.bPc){b.hasProperty(hj.a.ae.ry)||Db.a.instance.Zb("PossibleIncorrectListRenumbering",
{["Reason"]:"PropertyNotExist"});const ta=b.getValue(hj.a.ae.ry);b.setValue(hj.a.ae.ry,ta+k);b.hasProperty(hj.a.ae.pJ)&&b.getValue(hj.a.ae.pJ)!==ta&&Db.a.instance.Zb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});b.setValue(hj.a.ae.pJ,ta+k)}b.setValue(wc.a.listID,r);k=this.Sea(b);b=Wd.GraphIterator.Za(b);b.rd();b.mc();R&&aa&&!this.OUa&&(this.$m.oM(R,aa,this.Jd.og),this.m8());this.SGc(b,k,Object(u.a)(this,this.B$i,"sublistsEnsureSameListAsOriginal"),Object(u.a)(this,this.F$d,"sublistsUpdateId"),
y)}kLi(b,k,r,y,R){b=this.JL(b.currentNode,r);b.v_>=k.level&&this.Swb(y,b.startAt+R)}C$i(b,k,r,y,R){this.kLi(b,k,r,y,R)}F$d(b,k,r,y){r.listID=k.listID;y.Pb(4);b=this.Cm.PYa(y.currentNode);k=b.Qz();this.ZXb(y.currentNode,r);y.mc();b&&k&&!this.OUa&&(this.$m.oM(b,k,this.Jd.og),this.m8())}G3f(b,k,r,y){Vh.ListReader.ei(y)&&(b=new Wd.GraphIterator,b.ed(y),b.rd(),this.hd.kD(b),this.fpf(y.currentNode,b.currentNode))}u6n(b,k,r,y,R){r.listID=k.listID;this.kLi(b,k,r,y,R);this.F$d(b,k,r,y,R)}F3f(b,k){return k.listID!==
b.listID?!1:!0}t6n(b,k){return k.level>b.level?!1:!0}B$i(b,k,r){return k.listID!==r.kUc?!1:!0}static get bPc(){null==mo.Yjd&&(n.AFrameworkApplication.K?(n.AFrameworkApplication.Ne("i75ig452;a229j208"),mo.Yjd=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):mo.Yjd=!1);return mo.Yjd}static get Sg(){return tm.ContextSetEditor.instance}static get qh(){return lk.PageNavigator.instance}static x0i(b,k){k.setValue(Te.a.font,b.Kma||
b.cNc||b.G4b?b.font:"Symbol")}static z0i(b,k){b=b.Kma||b.cNc||b.bfa?b.levelText:bg.a.Oyd;v.ULS.shipAssertTag(22127637,338,!!b);k.setValue(wc.a.Vr,b)}static y0i(b,k){b=b.propertySet.ia(wc.a.Daa,"left");k.setValue(wc.a.Daa,b)}static Gai(b){b=b.iterator.parentNode;const k=Wd.GraphIterator.Za(b);b&&Ag.OutlineElementReader.Psf(k,null)&&b.uk(8,!0)}static H9l(b){const k=new Wd.GraphIterator;k.set(b.currentNode);xg.OutlineElementNavigator.Xd(b);for(b=k.Ud();b&&!rB.a.i7b(b);)b=k.xj();b&&b.uk(4,!0)}}mo.gIm=
2147450879;mo.Osi=1;mo.Yjd=null;Object(m.a)(mo,"FlatListEditorCssVersion",hj.a,[662,663,42]);class mC{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc){this.LH=b;this.Kh=r;this.Qhd=k;this.Hc=y;this.kp=R;this.kye=aa;this.Jd=ta;this.$m=Ya;this.$Ha=xb;this.Ic=Mb;this.Ce=cc;this.vJa=jc}create(){return new mo(this.LH,this.Qhd,this.Kh,this.Hc,this.kp,this.kye,this.Jd,this.$m,this.$Ha,this.Ic,this.Ce,this.vJa)}}Object(m.a)(mC,"FlatListEditorFactory",null,[]);class nC{constructor(){this.startAt=this.listLevel=
this.listId=0;this.iib=null}}Object(m.a)(nC,"ListAutoCorrectionRefInfo",null,[]);class Uy{constructor(b,k){this.tMj=b;this.Cf=k}S_d(b,k,r,y){if(!b.hasProperty(td.a.GNa))return!0;k=Wd.GraphIterator.Za(k.currentNode);rf.SelectionEditor.Pt(k);let R=!0;if(!r.listType&&!y){23===k.Le&&k.oE(1);y=b.ia(td.a.GNa,1);if(1!==y){var aa=new Wd.GraphIterator;aa.ed(k);aa.Ab(10);aa=Pm.a.Zp(aa.origin);y=this.Tal(aa,y,r,k.currentNode);r.iib||(R=!1)}b.setValue(td.a.GNa,y)}return R}Tal(b,k,r,y){const R=new rb.a;for(;b.moveNext()&&
b.iterator.currentNode!==y;){const aa=b.iterator;if(!aa.fq(4))continue;const ta=this.tMj.value.Uw(aa),Ya=this.Cf.Gs(aa);this.Wdn(R,ta);Ya.listType===r.listType&&Ya.listStyle===r.listStyle&&(0>k-ta.jq||2<k-ta.jq||R.add(Object.assign(new nC,{listId:ta.listID,listLevel:ta.level,iib:aa.currentNode,startAt:ta.jq+1})))}0<R.count&&(k=R.J(R.count-1).startAt,r.iib=R.J(R.count-1).iib);return k}Wdn(b,k){let r=0;for(;r<b.count;){const y=b.J(r);y.listId===k.listID&&y.listLevel>=k.level?b.removeAt(r):r++}}}Object(m.a)(Uy,
"ListAutoCorrector",null,[633]);class tB{constructor(b,k,r,y,R){this.F3a=(aa,ta,Ya)=>{var xb;aa=this.WCc(ta);if(!aa||this.Pr.Vsf(aa))return 8;ta=this.Pr.Uw(aa);if(1===ta.jq||this.lOc(ta.level))return 8;ta=null===(xb=this.hd)||void 0===xb?void 0:xb.Gs(aa);if(!ta||this.Jfi(ta))return 8;if(1===Ya)return 32;this.Pr.startNewList(aa,ta,1);return 32};this.E3a=(aa,ta,Ya)=>{aa=this.WCc(ta);if(!aa||this.Pr.Vsf(aa))return 8;ta=this.Pr.Uw(aa);if(this.lOc(ta.level))return 8;const xb=this.hd.Gs(aa);if(!xb||this.Jfi(xb))return 8;
if(1===Ya)return 32;this.h4e.UBl(aa.currentNode,ta.jq,this.hd,this.Pr,this.GQa);return 32};this.f$=(aa,ta,Ya)=>{aa=this.WCc(ta);if(!aa||this.Pr.Vsf(aa))return 8;ta=this.Pr.Uw(aa);if(1!==ta.jq||this.lOc(ta.level))return 8;if(1===Ya)return 32;Ya=this.hd.Gs(aa);return this.Pr.f$(aa,ta,Ya.$z,-1,!1,Ya)?32:8};this.rlb=(aa,ta,Ya,xb,Mb)=>{aa=this.WCc(ta);if(!aa)return 8;ta=this.Pr.Uw(aa);if(this.lOc(ta.level))return 8;if(1===Ya)return 32;Ya=this.hd.Gs(aa);this.Pr.startNewList(aa,Ya,Mb);return 32};this.Abb=
(aa,ta,Ya,xb,Mb)=>{aa=this.WCc(ta);if(!aa)return 8;ta=this.Pr.Uw(aa);return this.lOc(ta.level)?8:1===Ya?32:this.Pr.f$(aa,ta,ta.jq,Mb)?32:8};this.wc=b;this.hd=r;this.Pr=y;this.h4e=R}get qem(){return Vh.ListReader.sr}lOc(b){return 0>b?!0:this.qem?!1:!!b}Vb(){this.wc.pa(Wa.a.F3a,lc.a.outlineElement,this.F3a);this.wc.pa(Wa.a.F3a,lc.a.Wc,this.F3a);this.wc.pa(Wa.a.F3a,lc.a.view,this.F3a);this.wc.Vc(Wa.a.F3a,12);this.wc.pa(Wa.a.E3a,lc.a.outlineElement,this.E3a);this.wc.pa(Wa.a.E3a,lc.a.Wc,this.E3a);this.wc.pa(Wa.a.E3a,
lc.a.view,this.E3a);this.wc.Vc(Wa.a.E3a,12);this.wc.pa(Wa.a.f$,lc.a.outlineElement,this.f$);this.wc.pa(Wa.a.f$,lc.a.Wc,this.f$);this.wc.pa(Wa.a.f$,lc.a.view,this.f$);this.wc.Vc(Wa.a.f$,12);this.wc.pa(Wa.a.rlb,lc.a.outlineElement,this.rlb);this.wc.pa(Wa.a.rlb,lc.a.Wc,this.rlb);this.wc.pa(Wa.a.rlb,lc.a.view,this.rlb);this.wc.Vc(Wa.a.rlb,12);this.wc.pa(Wa.a.Abb,lc.a.outlineElement,this.Abb);this.wc.pa(Wa.a.Abb,lc.a.Wc,this.Abb);this.wc.pa(Wa.a.Abb,lc.a.view,this.Abb);this.wc.Vc(Wa.a.Abb,12)}get GQa(){return Va.a.instance.resolve("Common.IStandaloneRootController").M3}WCc(b){return this.Pr.yzl(b)}Jfi(b){return 1===
(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(tB,"ListContextMenuSectionActor",null,[]);class kn{static get Ptm(){return yf.a.Rx(kn.tl,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}kn.tl="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(kn,"ListSetStartValueDialogHtml",null,[]);class Gv extends yf.a{constructor(b,k,r,y,R){super();this.jhd=this.Lle=this.Chd=this.yIe=null;this.Hne=!0;this.WK=!1;this.L8a=0;this.U7=[Wa.a.bZf,Wa.a.z2f,Wa.a.uPf];this.jRn=(aa,ta)=>{Vh.ListReader.sr?(aa=ta[rc.a.Number],this.E4=Number.isInteger(ta[rc.a.Number])&&aa>=this.L8a?aa:this.L8a):this.E4=ta[rc.a.Number]};this.rLl=(aa,ta)=>{Vh.ListReader.sr&&(this.E4=this.E4>=this.L8a?this.E4:this.L8a);ta[rc.a.Number]=this.E4;ta[rc.a.UnitType]=0};this.jOn=
(aa,ta)=>{if(1===aa){var Ya=ta.ListRadioStartNew,xb=ta.ListRadioContinue,Mb=Wd.GraphIterator.Za(this.Te);Mb.rd();ta=this.Pr.Uw(Mb);aa=this.Cf.Gs(Mb);if(Ya)this.Pr.startNewList(Mb,aa,this.E4);else if(xb)if(this.Hne)this.Pr.f$(Mb,ta,this.JBe,-1,!1,aa);else{Ya=!0;for(xb=null;Mb.dH();)if(Mb.fq(4)){xb=new Cn(this.Pr,Mb,!1,!1);break}if(!xb||this.Pr.Uw(Mb).jq>=this.E4)Ya=!1;Ya?(Mb=Wd.GraphIterator.Za(this.Te),Mb.rd(),this.Pr.f$(Mb,ta,this.JBe,this.E4,!1,aa)):(this.dispose(),this.dwa(CommonUIStrings.l_ErrorDialogMessage,
this.Otm))}}};this.Otm=()=>{new Gv(this.Te,this.JBe,this.Cf,this.Pr,this.zd)};this.e_m=()=>{document.getElementById(Gv.Gmi).style.visibility="visible"};this.lTm=()=>{document.getElementById(Gv.Gmi).style.visibility="hidden"};this.lg="ListSetStartValueDialog";this.vg=kn.Ptm;this.Te=b;this.E4=k;this.Cf=r;this.JBe=k;this.O4=y;Vh.ListReader.sr&&(k=new Wd.GraphIterator,b?(k.set(b),k.rd(),Ag.OutlineElementReader.Nh(k)||xg.OutlineElementNavigator.Xd(k),Vh.ListReader.ei(k)&&(k.Pb(4),b=k.currentNode,22===
b.type&&(this.Cf.XN(b).Uea()?this.L8a=1:this.L8a=0))):this.L8a=1);this.zd=R;this.Vh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.jOn,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Hne&&(this.yIe=document.getElementById("ListRadioStartNew"),this.Chd=this.e_m,this.Lle=document.getElementById("ListRadioContinue"),this.jhd=this.lTm,Af.a.addHandler(this.yIe,"click",this.Chd),Af.a.addHandler(this.Lle,"click",this.jhd));for(let aa of this.U7)Mh.a.Vja(aa,this.jRn,this.rLl);this.zd.xl()}get Pr(){return this.O4}dispose(){this.WK||
(this.Hne&&(this.Chd&&Af.a.removeHandler(this.yIe,"click",this.Chd),this.jhd&&Af.a.removeHandler(this.Lle,"click",this.jhd)),this.zd.VA("ListStartSpinner"),super.dispose(),this.WK=!0)}Knk(){const b=Rf.n("none",Vh.ListReader.sr?this.L8a+"":"0","100","1");return Rf.l(Gv.Hmi,Wa.a.bZf,Wa.a.uPf,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Wa.a.z2f)}VVa(b){const k=document.getElementById(Gv.Hmi);this.zd.rza("ListStartSpinner",b);b=this.zd.yYa("ListStartSpinner","Medium");k.appendChild(b)}eU(){const b=this.Knk();
this.VVa(b)}}Gv.Hmi="SetListStartSpinnerContainer";Gv.Gmi="ListStartAtSpinnerBox";Object(m.a)(Gv,"ListSetStartValueDialog",yf.a,[]);class fr{UBl(b,k,r,y,R){new Gv(b,k,r,y,R)}static get instance(){return fr._instance||(fr._instance=new fr)}}fr._instance=null;Object(m.a)(fr,"ListDialogFactory",null,[632]);class cy{constructor(b,k,r){this.O4=b;this.Cf=k;this.Hc=r}ynf(b){v.ULS.shipAssertTag(40420184,393,Ag.OutlineElementReader.Nh(b));const k=b.Pb(4);b.mc();if(k){const r=this.Cf.XN(k);r.xr||this.a3l(b,
k,r)}}Fwk(b){for(let k=0;k<b.length;k++){const r=new Wd.GraphIterator;r.set(b.getContext(k).node);this.ynf(r)}}a3l(b,k,r){const y=lk.PageNavigator.instance.pu(k),R=this.O4.Sea(k),aa=this.Hc.Rc(15);aa.Qu(b);b=this.O4.oeh(y,k,r,0,null);this.O4.zRi(k,!0,R.listID);aa.dispose();this.Cf.Rea(k,b)}}Object(m.a)(cy,"SingleLevelListEditor",null,[630]);var Vy=c(334);class xu extends Rl{constructor(b){super();xu.tpc=b}mIi(b,k,r,y,R,aa){if(!b||!b.length)return 8;let ta;const Ya=({lTl:b,kTl:ta}=xu.xp.iTl(b)).returnValue;
let xb=1;for(let cc of Ya.keys){var Mb=b.contains(cc);const jc=Ya.J(cc);xu.xp.Ssk(Ya.J(cc),this.RAc(k),Mb)?Mb?(v.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.RAc(k)?"Promote":"Demote"),Mb=n.AFrameworkApplication.ya.Vf(Vy.a.qAa(jc),k,r,y,R,aa)):(v.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.RAc(k)?"Promote":"Demote"),Mb=xu.xp.p2m(Ya.J(cc),this.RAc(k),ta.J(cc))):(v.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",
this.RAc(k)?"Promote":"Demote"),Mb=8);xb=Kd.ActionManager.eSc(xb,Mb)}return xb}RAc(b){return b===Wa.a.XF?!0:!1}static get xp(){return xu.tpc||(xu.tpc=Va.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}xu.tpc=null;Object(m.a)(xu,"WordEditorListContextManager",Rl,[]);class Ah{get name(){return"WordEditor.ListEditors"}zc(b){n.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new Uy(b.Ze("WordEditor.IFlatListEditor"),
b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new mC(b.resolve("WordEditor.List.IFlatListReader"),b.Ze("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Qn.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new cy(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new xu(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new tB(n.AFrameworkApplication.ya,
new Io.a,Ah.hd,Ah.Pr,fr.instance)).Vb();const b=n.AFrameworkApplication.ya;b.gb(Wa.a.uPf,lc.a.view,Mh.a.TQ,96);b.gb(Wa.a.z2f,lc.a.view,Mh.a.HF,96);b.gb(Wa.a.bZf,lc.a.view,Mh.a.HF,96)}dispose(){}static get hd(){return null!=Ah.Xog?Ah.Xog:Ah.Xog=Va.a.instance.resolve("Box4.List.IListReader")}static get Pr(){return null!=Ah.Ikg?Ah.Ikg:Ah.Ikg=Va.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){M.a.instance.Pc(new Ah)}}Object(m.a)(Ah,"WordEditorListEditorsPackage",null,[1,2]);var BA=c(1616),
Ug=c(525),gr=c(79),Mz=c(1890);class dy extends Xb.a{constructor(b,k,r,y,R,aa){super(b,k);this.styleId=null;this.yj=0;this.HNa=null;this.characterData=r;this.paragraphNode=y;this.listMarker=R;this.sMa=aa}}Object(m.a)(dy,"HeadingText",Xb.a,[]);class Nz{constructor(b,k,r,y,R,aa,ta){this.$Jg=!0;this.aRg=0;this.O5g=8;this.pga=null;this.wZl=Ya=>{if(Ya.qr)return!0;Ya=Ya.role;return 1===Ya||2===Ya||4===Ya};this.mMj=b;this.nB=k;this.Ce=r;this.Cf=y;this.mB=R;this.hca=aa;this.Yxe=ta}get fy(){return this.mMj.value}get onf(){return this.$Jg}set onf(b){this.$Jg=
b}get DFb(){return this.aRg}set DFb(b){this.aRg=b}get QMb(){return this.O5g}set QMb(b){this.O5g=b}Xvl(){return Object(gr.__awaiter)(this,void 0,void 0,function*(){var b=this.Yxe.value;if(!isNullOrUndefined(b)&&b.Qv)return b=yield this.hEl(),this.eNf(b,!0);b=this.pga;return isNullOrUndefined(b)?null:Promise.resolve(this.eNf(b,!0))})}Yvl(){return this.eNf([],!1)}eNf(b,k){const r=window.performance.now(),y=this.hTh();if(!y)return null;const R=new rb.a;let aa=0;for(;y.moveNext();){var ta=y.iterator;if(11===
ta.Le){const Ya=this.Cf.ZAb(ta),xb=xg.OutlineElementNavigator.Fe(ta,!0);k&&b[aa]&&b[aa].ParaId===ie.ParagraphReader.eQ(xb)&&aa++;xg.OutlineElementNavigator.Xd(ta);if(!xb||!ie.ParagraphReader.nc(xb)||xb.Ur||""===xb.characterData||"\ufffc"===xb.characterData)continue;const Mb=this.gGd(xb);Mb&&(Ya&&(Mb.listMarker=this.mB.v0a(Ya,!1).Y2,ta=this.Cf.Gs(ta),1===ta.listType&&ta.G4b&&(Mb.HNa=ta.font)),k&&(b[aa-1]&&b[aa-1].ParaId===ie.ParagraphReader.eQ(xb)?Mb.yj=aa:Mb.yj=aa+1),R.add(Mb))}}v.ULS.sendTraceTag(591963592,
3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return R}hEl(){let b=new zh.a;var k=Mz.a.d$(n.AFrameworkApplication.rootQuerySignature,null);let r=new Er.a;r.Zr=k;r.status=1;this.NQj=window.performance.now();k=this.hca.sla(0,()=>{if(2!=r.statusCode||null==r.hk||0==r.hk.length||null==r.hk[0]){const y=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(y));v.ULS.sendTraceTag(543802465,3019,10,y)}else b.Eg(r.hk[0].PageEnds),
v.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.NQj))});k.QJ(r);k.qW();return wb.b(b.task)}Vvl(){const b=this.hTh();if(!b)return-1;let k=0;for(;b.moveNext();){const r=b.iterator;if(11===r.Le){const y=xg.OutlineElementNavigator.Fe(r,!0);xg.OutlineElementNavigator.Xd(r);y&&ie.ParagraphReader.nc(y)&&!y.Ur&&""!==y.characterData&&"\ufffc"!==y.characterData&&this.gGd(y)&&k++}}return k}hTh(){if(!this.fy)return v.ULS.sendTraceTag(591000526,
3019,10,"PageNode is null"),null;var b=this.nB.tT(this.fy);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=Wd.GraphIterator.Za(b);if(!b.ro())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Pm.a.Lr(b,b.origin);b.Xm(this.wZl,null);return b}gGd(b){return this.gRl(b)||this.Uvl(b)}Uvl(b){var k;let r=k=null,y=-1;var R=-1,aa=this.Ce.Sx(b);for(let Ya=0;Ya<b.qa.length;Ya++)if(k=b.qa.J(Ya),k.formatting){var ta=Kk.FormattingReader.Eta(k.formatting);
const xb=this.Ce.rf(ta);if(!r&&(r=xb,R=(R=mi.a.AIc(r))?Number.parseInvariant(R):0,!this.Rsf(R-1)))break;ta=(ta=this.Ce.u2(ta,aa))?ta.ia(wc.a.lj,9):9;y=-1===y?ta:y;if(!(this.Suf(ta)&&y===ta||mi.a.Nuf(xb)&&r===xb))break}k=k.cp;aa=b.characterData.substring(0,k);return this.Suf(y)?new dy(0,k,aa,b,null,y+1):mi.a.Nuf(r)?new dy(0,k,aa,b,null,R):null}Suf(b){return this.onf&&this.Rsf(b)}Rsf(b){return b<=this.QMb&&b>=this.DFb}gRl(b){const k=ie.ParagraphReader.xBa(b);if(this.Suf(k))return new dy(0,b.characterData.length,
b.characterData,b,null,k+1);if(this.Rsf(k)){var r=this.Ce.Ao(b);r=this.Ce.rf(r);if(mi.a.n8b(r))return new dy(0,b.characterData.length,b.characterData,b,null,k+1)}return null}}Object(m.a)(Nz,"StyleBasedDocumentHeadings",null,[582]);class Oz{constructor(){this.startTime=0}}Object(m.a)(Oz,"TocCallbackData",null,[]);class nt{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.P9f=(jc,Mc,fd)=>{const Td=Mc.node;if(!Td)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==Td.type)return v.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!Td.Ur)return 2;if(1===fd)return Ae.SessionStatusManager.instance.Tj?8:32;this.Ic&&this.Ic.isFeatureEnabled(128)?this.jod.dlo(Td).then(ne=>{ne||this.Akj(Td)}):this.Akj(Td);return 32};this.zpo=jc=>{jc=window.performance.now()-jc.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",jc));jc=Object.assign(new Xa.a,{durationMs:jc});Ga.Health.instance.recordKpiSuccess(nt.Znj,
jc);nt.Ewa()};this.F8l=(jc,Mc,fd)=>{if(ie.ParagraphReader.nc(Mc.node)&&Mc.node.Ur)return 2;if(1===fd)return Ae.SessionStatusManager.instance.Tj?8:32;if(Mc.contextId!==lc.a.Wc||this.Mk.naa(Mc)||!ie.ParagraphReader.nc(Mc.node))return 32;this.Jd.ys(17);this.jod.fKk(Mc);return 32};this.eTf=(jc,Mc,fd)=>{jc=Mc.node;if(!jc)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==jc.type)return v.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!jc.Ur)return 2;if(1===fd)return Ae.SessionStatusManager.instance.Tj?8:32;fd=new Wd.GraphIterator;fd.set(jc);fd.Ab(8);fd.kd(8);Mc=this.Hc.Rc(15);Mc.Qu(fd);this.jod.Srn(jc)?(Mc.dispose(),nt.Ewa()):(Mc.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.p7c=k;this.Yc=y;this.Hc=R;this.Mk=aa;this.jod=ta;this.Jd=Ya;this.Ic=xb;this.UGg=Mb;this.PD=cc}Vb(){this.ga.pa(Wa.a.Khc,lc.a.paragraph,this.P9f);this.ga.pa(Wa.a.Khc,lc.a.Hd,this.P9f);this.ga.pa(Wa.a.Khc,
lc.a.Wc,this.P9f);this.ga.Vc(Wa.a.Khc,1028);this.ga.pa(Jc.a.Nof,lc.a.Wc,this.F8l);this.ga.Vc(Jc.a.Nof,1028);this.ga.pa(Jc.a.VXc,lc.a.paragraph,this.eTf);this.ga.pa(Jc.a.VXc,lc.a.Hd,this.eTf);this.ga.pa(Jc.a.VXc,lc.a.Wc,this.eTf);this.ga.Vc(Jc.a.VXc,1028)}Akj(b){Ga.Health.instance.recordKpiUsage(nt.Znj,1,nt.LB,null);const k=this.xkl(b),r=new Oz;r.startTime=window.performance.now();this.p7c.FYi(k,wc.a.$8f,this.NPl(this.vEl(b)),this.zpo,null,r);this.jod.lvk()}Vrj(b){if(null!=b&&b.Ur)if(null==this.UGg.instance)v.ULS.sendTraceTag(539628835,
3019,10,"Page Number Finder instance is null.");else{var k=this.UGg.instance.mXh();b=this.Nal(b);var r=!1;1===this.PD.Qw&&(r=!0);0!=b&&k!=b&&(k=[Object.assign(new ca.a,{name:"TOCPageNo",string:b}),Object.assign(new ca.a,{name:"HeadingPageNo",string:k}),Object.assign(new ca.a,{name:"isPageView",string:r})],Ib.a("TOCPageNoMismatch",!0,void 0,k))}}Nal(b){for(let k=0;k<b.qa.length;k++){const r=b.qa.J(k);if(null!=r.gf)for(let y=0;y<r.gf.length;y++){const R=r.gf.J(y);if(1===R.Wl&&R.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,
b.characterData.length-r.cp))}}return 0}vEl(b){return b?b.ia(wc.a.AM,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}xkl(b){return this.Yc.pBa(b,7,7).Pb(35)}NPl(b){const k=[];k.push(b+",TOC,0");return k}static Ewa(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
nt.Nka)}}nt.Nka=5E3;nt.Znj="WordUpdateTOC";nt.LB="wwaengidc";Object(m.a)(nt,"TableOfContentsActor",null,[583]);class CA{}Object(m.a)(CA,"FieldData",null,[]);class DA extends CA{constructor(){super();this.$lb=null}}Object(m.a)(DA,"TOCFieldData",CA,[]);class ey{constructor(b,k,r,y,R,aa=null){this.yZl=b;this.Rs=k;this.yj=r;this.r$i=y;this.listMarker=R;this.HNa=aa}}Object(m.a)(ey,"TOCHeadingData",null,[]);class EA{constructor(b,k){this.nSa=b;this.nl=k}iTh(b){return Object(gr.__awaiter)(this,void 0,void 0,
function*(){this.nSa.onf=b.pnf;this.nSa.DFb=b.DFb;this.nSa.QMb=b.QMb;return this.nSa.Xvl()})}hll(b){if(b=this.gll(b))return this.nl.Fea(b)}gll(b){const k=b.qa.length;for(let r=0;r<k;r++){const y=b.qa.J(r);if(y.hyperlink&&y.hyperlink.oma&&y.hyperlink.url.startsWith(A.a.Cab))return y.hyperlink.url.substr(y.hyperlink.url.indexOf("_Toc"))}return null}L3d(b){(b=this.hll(b))&&this.nl.RWd(b.id)}GMl(){return this.nSa.Vvl()}uHi(b,k){const r=new DA,y=new rb.a;for(let R of b){b=this.FMl(R,k);if(!b)return null;
y.add(b)}r.$lb=y;return r}FMl(b,k){let r;if(k&&(r=this.HJk(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;k=xn.AParagraphNode.nU(b.characterData.trim());const y=this.qOl(b.sMa);return new ey(k,r,b.yj,y,b.listMarker,b.HNa)}HJk(b){const k=String.format("{0}{1}","_Toc",Gc.a.ZF());return this.nl.$Wb(k,b.begin,b.end,b.paragraphNode,b.paragraphNode)?k:null}qOl(b){return String.format("toc {0}",b)}}Object(m.a)(EA,"TOCDataManager",null,[581]);class fy{p1f(){const b=
Object.assign(new cf.StandardDialog,{It:n.AFrameworkApplication.faa,Gd:0,IEa:!1});b.wU(1);b.fha(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=fy.vng?fy.vng:fy.vng=new fy}}Object(m.a)(fy,"TOCDialogHelper",null,[]);var uB=c(198),vB=c(828),bo=c(339),wB=c(172);class ww{constructor(b,k,r,y,R,aa,ta){this.q1f=b;this.lgb=k;this.pnf=r;this.DFb=y;this.QMb=R;this.pvb=aa;this.y3c=[];this.instruction=ta}toString(){return"showPageNumber:"+
this.q1f+"  isHyperlink:"+this.lgb+" includeOutlineLevels:"+this.pnf+" lowerOutlineLevel:"+this.DFb+" upperOutlineLevel:"+this.QMb+" addContentControl:"+this.pvb+" unsupportedSwitches:"+this.y3c.toString()}}Object(m.a)(ww,"TOCSettings",null,[]);class Kj{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff,Gd){this.AKg="TOC";this.Bme=this.JKe=null;this.c4a=b;this.Kh=k;this.vC=r;this.nS=y;this.DC=R;this.Mk=aa;this.hb=ta;this.Yd=Ya;this.C4g=xb;this.ng=Mb;this.HKe=cc;this.Qo=Mc;this.TH=fd;this.Bn=
Td;this.Hc=ne;this.Hb=ye;this.sg=ff;this.fb=Gd}get MMc(){return this.AKg}set MMc(b){this.AKg=b}get amb(){this.JKe||(this.JKe=this.OQh());return this.JKe}OQh(){return new ww(!0,!0,!0,0,8,!0,this.V9m())}fKk(b){Object(gr.__awaiter)(this,void 0,void 0,function*(){Ib.a(Kj.SPk);const k=window.performance.now();if(this.fb.nc(b.node))if(this.Mk.naa(b))v.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Kj.NNa("IP is in locked range");else{var r=
yield this.c4a.iTh(this.amb);if(r){var y=new nd.a(2,1,0,()=>{this.UPk(b,r,this.amb.lgb,k)});this.Hb.fc(y)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Kj.NNa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Kj.NNa("Context should be paragraph")})}UPk(b,k,r,y=0){let R;try{if(0==y&&(y=window.performance.now()),this.iIh(b.node)){var aa=new Wd.GraphIterator;aa.set(b.node);
aa.Ab(7);aa.kd(7);R=this.Hc.Rc(15);R.Qu(aa);var ta=this.c4a.uHi(k,r);ta||Kj.NNa("Failed to prepare TOC Field data");var Ya=ta.$lb?ta.$lb.count:0;if(Ya){k=null;var xb;for(r=0;r<Ya;r++){const Mc=ta.$lb.J(r);if(!({jyb:xb}=this.D$h(b,k,r,Ya,Mc,cc?cc.toString():void 0)).returnValue){Kj.NNa("Failed to populate new TOC paragraph");return}if(0==r){var Mb=xb.currentNode;var cc=ie.ParagraphReader.eQ(Mb)}k=xb}if(this.amb.pvb&&!this.V_e(Mb.id,k.Gn.id))Kj.NNa("Failed to add content control block");else{var jc=
window.performance.now()-y;Ib.a(Kj.x1e,!0,jc)}}else if(this.HKe.p1f(),this.YKk(b)){const Mc=window.performance.now()-y;Ib.a(Kj.x1e,!0,Mc)}}else Kj.NNa("Failed to fetch style set")}catch(Mc){Kj.NNa(String.format("{0} {1}",Mc.message,Mc.stack))}finally{R&&R.dispose()}}iIh(b){this.Bme=this.DC.Sx(b);return this.Bme?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static aDa(b){b=[Object.assign(new ca.a,{name:Kj.xpo,string:b})];Ib.a(Kj.R9f,!1,void 0,b)}static xyf(b){b=[Object.assign(new ca.a,
{name:Kj.wtn,string:b})];Ib.a(Kj.ZPi,!1,void 0,b)}static NNa(b){b=[Object.assign(new ca.a,{name:Kj.TPk,string:b})];Ib.a(Kj.x1e,!1,void 0,b)}dlo(b){return Object(gr.__awaiter)(this,void 0,void 0,function*(){const k=this.s0h(b);if(null==k)Kj.aDa("Cannot update TOC when firstTocPara = null");else{var r=this.IMl(k);if(0<r.y3c.length)return this.qEm(r.y3c),!1;Ib.a(Kj.wpo);var y=window.performance.now(),R=yield this.c4a.iTh(r);if(!R)return v.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),
Kj.aDa("Failed to fetch TOC data"),!1;var aa=new nd.a(1,1,0,()=>{this.ypo(k,R,r,y)});this.Hb.fc(aa);return!0}})}ypo(b,k,r,y=0){let R;try{if(null==b)Kj.aDa("Attempt to update TOC when firstTocPara = null");else{0==y&&(y=window.performance.now());var aa=new Wd.GraphIterator;aa.set(b);aa.Ab(7);aa.kd(7);R=this.Hc.Rc(15);R.Qu(aa);var ta=this.c4a.uHi(k,r.lgb);if(null==ta)Kj.aDa("Attempt to update TOC when tocFieldData = null");else{var Ya;if(({jWe:Ya}=this.wPi(b,r)).response){v.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var xb=ta.$lb?ta.$lb.count:0;if(this.iIh(b)){var Mb;this.Vgi(b)&&(this.YPi(b),(b=this.fb.eh(b,!1,!0))&&(Mb=b.ia(wc.a.Nc,null).toString()));var cc=b.ia(wc.a.AM,null);k=cc;Mb=null!==Mb&&void 0!==Mb?Mb:cc;if(xb){for(var jc=0,Mc;b.Ur&&k==cc&&jc<xb;){let ne=ta.$lb.J(jc);r.lgb&&this.c4a.L3d(b);if(!this.$oo(b,jc,xb,ne,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Kj.aDa("Failed to update TOC paragraph");
return}b.setValue(wc.a.AM,Mb);jc++;Mc=b;b=this.fb.eh(Mc,!1,!0);if(!b){k=null;break}this.$gi(b)&&this.XPi(b);k=b.ia(wc.a.AM,null)}k==cc&&this.VSf(b);var fd;if(({Xvf:fd}=this.R5j(ta,jc,xb,Mc,Mb)).response)if(r.pvb&&!this.V_e(Ya,fd.id))Kj.aDa("Failed to add content control block");else{var Td=window.performance.now()-y;Ib.a(Kj.R9f,!0,Td)}else Kj.aDa("Failed to add new paragraph")}else this.HKe.p1f(),this.tpo(b,r.pvb,Ya,r.instruction,Mb)&&(jc=window.performance.now()-y,Ib.a(Kj.R9f,!0,jc))}else Kj.aDa("Failed to fetch style set")}else Kj.aDa("Failed to remove Content Control")}}}catch(ne){Kj.aDa(String.format("{0} {1}",
ne.message,ne.stack))}finally{R&&R.dispose()}}R5j(b,k,r,y,R){let aa=new Wd.GraphIterator;for(aa.set(y);k<r;){y=b.$lb.J(k);if(!({jyb:y}=this.D$h(null,aa,k,r,y,R)).returnValue)return{Xvf:aa.currentNode,response:!1};aa=y;k++}return{Xvf:aa.currentNode,response:!0}}wPi(b,k){var r,y,R;let aa,ta;const Ya=null===(r=null===b||void 0===b?void 0:b.qa)||void 0===r?void 0:r.first.Jb;if(Ya&&0<Ya.length)if(b=b.qa.first.Jb.J(0),b.Tf){r=b.contentControlNode.getValue(wc.a.My);aa=this.sg.jr.get(null===(y=b.contentControlNode.id)||
void 0===y?void 0:y.toString());ta=this.sg.As.get(null===(R=b.contentControlNode.id)||void 0===R?void 0:R.toString());if(0!=this.Qo.Njb(r))return v.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,jWe:aa,hmh:ta};k.pvb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),k.pvb=!1;else k.pvb=!1;return{response:!0,jWe:aa,hmh:ta}}tpo(b,k,r,y,R){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.c4a.L3d(b);let aa=
this.gFd(b);if(!this.EGi(aa,k,r,y))return Kj.aDa("Failed to populate empty TOC."),!1;if(k=this.fb.eh(b,!1,!0))r=b.ia(wc.a.AM,null),y=k.ia(wc.a.AM,null),r==y&&this.VSf(k);b.setValue(wc.a.AM,R);return!0}EGi(b,k,r,y){this.Yd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.Bti(b);this.ng.$F(b.qa.first.formatting,!0);this.g0e(b,0,1,y);return k&&r&&!this.V_e(r,b.id)?!1:!0}gFd(b){b.qa.reset();b.xWa();const k=new uB.a(b,0);k.formatting=new wB.a(k,G.a.nil);k.Xh=!0;b.qa.add(k);
return Re.a.createTextRange(b,0,b.characterData.length)}Vgi(b){if(ie.ParagraphReader.wT(b)){var k=b.qa.last.gf;if(!k||!k.length)return!1;if(4<=k.length){b=0===k.J(k.length-4).Wl;const r=1===k.J(k.length-3).Wl&&k.J(k.length-3).instruction.trim().startsWith(this.MMc),y=2===k.J(k.length-2).Wl;k=5===k.J(k.length-1).Wl;return b&&r&&y&&k}}return!1}$gi(b){if(ie.ParagraphReader.wT(b)){var k=b.qa.first.gf;if(!k||!k.length)return!1;if(2<=k.length)return b=4===k.J(0).Wl,k=3===k.J(1).Wl,b&&k}return!1}YPi(b){const k=
b.qa.last.gf,r=k.J(k.length-4),y=k.J(k.length-3),R=k.J(k.length-2),aa=k.J(k.length-1);k.remove(r);k.remove(y);k.remove(R);k.remove(aa);b.removeProperty(wc.a.AM)}XPi(b){const k=b.qa.first.gf,r=k.J(0),y=k.J(1);k.remove(r);k.remove(y);b.removeProperty(wc.a.AM)}VSf(b){if(b){var k=b.ia(wc.a.AM,null),r=b.ia(wc.a.Nc,null).toString(),y=k;r==k&&this.Vgi(b)&&(this.YPi(b),(b=this.fb.eh(b,!1,!0))&&(y=b.ia(wc.a.AM,null)));r=new Wd.GraphIterator;r.set(b);r.Ab(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");
for(var R;b&&b.Ur&&y==k&&R!=b;){if(this.$gi(b)){this.XPi(b);break}this.c4a.L3d(b);this.Bn.Xd(r);y=this.Bn.Wr(r,!1,!0);this.Kh.kPa(b);if(!y)return null;R=b;r.Pb(2);y=(b=r.currentNode)?b.ia(wc.a.AM,null):null}return b}}IMl(b){var k=b.qa,r=k?k.length:0,y=null;b=new ww(!0,!1,!1,0,8,!0,void 0);for(let R=0;R<r&&(y=this.HMl(k.J(R)),b.instruction=y,y=this.MJl(y),y[0]!==this.MMc);R++);k=y?y.length:0;for(r=1;r<k;r++)switch(y[r]){case "\\h":b.lgb=!0;break;case "\\u":b.pnf=!0;break;case "\\o":this.hPn(y[r+1],
b)&&r++;break;case "\\z":break;case "\\n":b.q1f=!1;b.y3c.push(y[r]);break;default:b.y3c.push(y[r])}return b}hPn(b,k){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(k.DFb=Number.parseInvariant(b[1])-1,k.QMb=Number.parseInvariant(b[2])-1,!0):!1}Srn(b){try{Ib.a(Kj.vtn);const k=window.performance.now(),r=this.s0h(b);if(null==r){Kj.xyf("Attempt to remove TOC when firstTocPara = null");return}let y,R,aa;const ta=this.OQh();if(!({jWe:y,hmh:R}=this.wPi(r,ta)).response)return Kj.xyf("Failed to remove content control"),
!1;if(void 0==y&&void 0==R)aa=this.VSf(r);else{aa=r.Mc.Db(y);let xb=new Wd.GraphIterator;xb.set(aa);xb.Ab(8);b=!1;let Mb;for(;!b&&aa&&Mb!=aa;){aa.id.equals(R)&&(b=!0);aa&&aa.Ur&&this.c4a.L3d(aa);this.Bn.Xd(xb);const cc=this.Bn.Wr(xb,!1,!0);this.Kh.kPa(aa);if(!cc){aa=null;break}xb.Pb(2);Mb=aa;aa=xb.currentNode}}aa&&this.rSc(aa);const Ya=window.performance.now()-k;Ib.a(Kj.ZPi,!0,Ya)}catch(k){Kj.xyf(String.format("{0} {1}",k.message,k.stack))}return!0}rSc(b){b=Re.a.Uc(b,0);b=new lj.Selection([b],!0);
this.hb.setSelection(b)}V_e(b,k){return this.Qo.Hja(b,k,null,Kj.O_k,!0).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}lvk(){this.c4a.GMl()||this.HKe.p1f()}s0h(b){if(!b.Ur)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(wc.a.AM,null);return this.TH.EEl(b)}qEm(b){b.length&&(b=[Object.assign(new ca.a,{name:"UnsupportedSwitches",string:b.toString()})],Ib.a("UnsupportedTocInstruction",
void 0,void 0,b))}HMl(b){const k=(b=b.gf)?b.length:0;for(let r=0;r<k;r++)if(1===b.J(r).Wl&&b.J(r).instruction.trim().startsWith(this.MMc))return b.J(r).instruction.trim();return null}MJl(b){const k=[];if(!b)return k;b=b.split(" ");return b.length?b:k}YKk(b){b=this.Uvh(b,null,!0,void 0).returnValue;if(!b)return Kj.NNa("Failed to create paragraph"),!1;const k=Re.a.Uc(b,0);if(!this.EGi(k,!0,b.id,this.amb.instruction))return Kj.NNa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,
50,"Created an empty table of contents.");return!0}Uvh(b,k,r,y){let R,aa;r&&b?(R=this.nLk(b),aa=R.currentNode,y=ie.ParagraphReader.eQ(aa).toString()):k&&(R=this.WBl(k),aa=this.Kh.zN(R));if(!aa)return v.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,jyb:R};aa.setValue(wc.a.AM,y);return{returnValue:aa,jyb:R}}V9m(){const b=new Sys.StringBuilder(this.MMc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}i$m(b){const k=new Sys.StringBuilder("PAGEREF ");
k.append(b);this.amb.lgb&&k.append(" \\h");return k.toString()}WBl(b){b.rd();this.Bn.Xd(b);return this.Kh.Uta(b,!1)}nLk(b){const k=new Wd.GraphIterator;k.set(b.node);k.rd();this.Bn.Xd(k);let r=this.XVh(k);const y=!b.cpBegin;if(Ag.OutlineElementReader.isEmpty(k,!0))return this.s$h(r);if(y)return this.Kh.TB(r,!0,!1),this.Kh.Hba(k,r,b,!1,!1,!1),b=this.XVh(r),this.s$h(b);r=this.Kh.Uta(k);this.Kh.Hba(k,r,b,!1,!1,!0);b=this.Kh.Uta(k);this.Kh.qKb(b.currentNode,!1);this.Kh.zN(b);this.Bn.Fe(b);return b}XVh(b){const k=
new Wd.GraphIterator;k.ed(b);k.rd();return k}s$h(b){this.Kh.TB(b,!0,!0);this.Kh.qKb(b.currentNode,!1);this.Bn.Fe(b);return b}Bti(b){const k=b.qa;1===k.length&&(k.first.Xh=!1,b.XAd().Xh=!0)}$oo(b,k,r,y,R){let aa=this.gFd(b);this.Yd.replaceTextRange(aa,"");this.IGi(b,y,R);this.g0e(b,k,r,R.instruction);return R.lgb&&!this.VG(b,y.Rs)?!1:!0}D$h(b,k,r,y,R,aa){k=({jyb:b}=this.Uvh(b,k,0==r,aa)).returnValue;if(!k)return{returnValue:!1,jyb:b};this.IGi(k,R,this.amb);this.g0e(k,r,y,this.amb.instruction);return this.amb.lgb&&
!this.VG(k,R.Rs)?{returnValue:!1,jyb:b}:{returnValue:!0,jyb:b}}IGi(b,k,r){this.u7l(b,k.yZl,k.listMarker,k.r$i,k.HNa);this.C4g.P8l(b,b.characterData.length);r.q1f&&this.k8l(b,k);this.Bti(b);this.yRn(b,k.r$i)}Gzl(b,k){if(!b)return 0;const r=Kj.rOl();return 4<b.length?r.J(k)+.5*Math.floor(b.length/3):r.J(k)}u7l(b,k,r,y,R){r&&this.H7l(b,r,y);r=Re.a.Uc(b,b.characterData.length);this.Yd.replaceTextRange(r,k);R&&(b=b.qa.ii(0),this.ng.z_(b.formatting,R))}H7l(b,k,r){r=this.Gzl(k,r);const y=Re.a.Uc(b,0);this.Yd.replaceTextRange(y,
k);this.C4g.I7l(b,k.length,r)}k8l(b,k){var r=Re.a.Uc(b,b.characterData.length);this.Yd.replaceTextRange(r,k.yj.toString());r=b.qa.ii(b.characterData.length-k.yj.toString().length);k=this.i$m(k.Rs);this.CMa(b,r,0,2,k);this.CMa(b,r,1,2,k);this.CMa(b,r,2,2,k);r=b.qa.ii(b.characterData.length);this.CMa(b,r,3,2,k)}yRn(b,k){k=this.Bme.wh(k);this.nS.pM(k,b,!0)}g0e(b,k,r,y){const R=b.qa.first,aa=b.qa.last;k?this.CMa(b,R,4,1,y):(this.CMa(b,R,0,1,y),this.CMa(b,R,1,1,y),this.CMa(b,R,2,1,y));k===r-1?this.CMa(b,
aa,3,1,y):this.CMa(b,aa,5,1,y)}CMa(b,k,r,y,R=null){r=new vB.a(k,null,r,y,!0,!1,!1,R);k.gf||(k.gf=new bo.a(k));k.gf.add(r);b.yn();this.vQk(r,b)}vQk(b,k){gh.a.instance.J(6)&&(b.Ge?k.wordRunProperties.IZ(b.Ge-1,2):k.wordRunProperties.Tta(b.Ge,2),k.wordRunProperties.Iq.Z(b.Ge,er.CharacterPropertiesEditor.GQ),k.wordRunProperties.gt.Z(b.Ge,er.CharacterPropertiesEditor.cU))}VG(b,k){b=Re.a.createTextRange(b,0,b.characterData.length);return this.vC.VG(b,k,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,
50,"Failed to create hyperlink for table of contents entries"),!1)}static rOl(){Kj.nra||(Kj.nra=new Fc.a,Kj.nra.Z("toc 1",1),Kj.nra.Z("toc 2",1.5),Kj.nra.Z("toc 3",2),Kj.nra.Z("toc 4",2.5),Kj.nra.Z("toc 5",3),Kj.nra.Z("toc 6",3.5),Kj.nra.Z("toc 7",4),Kj.nra.Z("toc 8",4.5),Kj.nra.Z("toc 9",5));return Kj.nra}}Kj.nra=null;Kj.O_k="Table of Contents";Kj.SPk="CreateTocClient";Kj.x1e="CreateTocSuccess";Kj.TPk="CreateTocFailureCause";Kj.wpo="UpdateTocClient";Kj.R9f="UpdateTocSuccess";Kj.xpo="UpdateTocFailureCause";
Kj.vtn="RemoveTocClient";Kj.ZPi="RemoveTocSuccess";Kj.wtn="RemoveTocFailureCause";Object(m.a)(Kj,"TOCField",null,[470,471]);var gy=c(648);class Pz{constructor(b,k){this.Fxa=b;this.iGa=k}P8l(b,k){if(ie.ParagraphReader.nc(b)&&!(0>k)){var r=Al.a.TYb(b);r=new gy.a(r,4,1,1);this.Fxa.MMd(b,r);b=Re.a.Uc(b,k);this.iGa.$Md(b)}}I7l(b,k,r){var y=zj.a.VJ/2;const R=b.qa.X2b(k);y=Kk.FormattingReader.Jn(R.formatting,Te.a.fontSize,2*y)/2;r=new gy.a(Rg.a.GA(y/36)*r,1,0,1);this.Fxa.MMd(b,r);b=Re.a.Uc(b,k);this.iGa.$Md(b)}}
Object(m.a)(Pz,"TOCTabUtility",null,[469]);class xB{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}zc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new BA.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Ug.a.XP)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new Nz(new cg.a(()=>Ka.App.xa.jb.Xc),lk.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),
new bt.a,new cg.a(()=>Ka.App.xa.jb.Fc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new EA(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new Pz(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Kj(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),mh.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),fy.instance,this.W.resolve("Box4.IFeatureHelper"),
this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Pa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),Qn.a.instance,n.AFrameworkApplication.uc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new nt(n.AFrameworkApplication.ya,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),
this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Qn.a.instance,mh.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.$a("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Vb()}dispose(){}}
Object(m.a)(xB,"PackageManager",null,[1,2]);class pp{constructor(b,k,r,y,R,aa,ta,Ya){this.UOa=(xb,Mb,cc,jc,Mc)=>{if(!({Ix:xb}=this.Zkb(Mb,cc,Mc,!0,!0)).returnValue)return xb;this.Cnd.fvh(Mc,Mb.node);return 32};this.Eva=(xb,Mb,cc,jc,Mc)=>this.K4h(Mb,cc,jc,Mc,!0);this.NHb=(xb,Mb,cc,jc,Mc)=>{if(!({Ix:xb}=this.Zkb(Mb,cc,Mc,!1,!0)).returnValue)return xb;this.Cnd.TMk(Mc,Mb.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Tja=(xb,Mb,cc,jc,Mc)=>{if(!({Ix:jc}=this.Zkb(Mb,cc,Mc,!1,
!0)).returnValue)return 2==cc&&8==jc&&dr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],bd.a.xzb),jc;const fd=Mb.node;let Td=null;(Td=xb===Wa.a.Tja?this.Cnd.iNb(Mc[Ig.a.SourceControlId],fd):this.wt.xBb(fd,Mc))?(this.R_d(fd,()=>{this.Cpd.XPa(Td,fd)}),this.FO(),jc=32):(dr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],bd.a.xzb),jc=8);xb===Wa.a.Tja&&32===jc&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,
324,32===jc);return jc};this.Nra=(xb,Mb,cc,jc,Mc)=>this.K4h(Mb,cc,jc,Mc,!1);this.xae=(xb,Mb,cc,jc,Mc)=>pq.a.Fna(xb,Mb,cc,jc,Mc,{},14);this.bxb=(xb,Mb,cc,jc,Mc)=>{if(!({Ix:xb}=this.Zkb(Mb,cc,Mc,!1,!1)).returnValue)return xb;const fd=Mb.node;this.R_d(fd,()=>{this.Cpd.Doh(fd)});return 32};this.wt=b;this.Cnd=k;this.ga=r;this.Cpd=y;this.Hc=R;this.Jw=aa;this.BLj=Ya}Vb(){this.icc(Ka.App.a4a.Juh())}icc(b){this.ga.pa(Wa.a.UOa,lc.a.view,b);this.ga.pa(Wa.a.UOa,lc.a.table,this.UOa);this.ga.Vc(Wa.a.UOa,1127);
this.ga.pa(Wa.a.Tja,lc.a.view,this.xae);this.ga.pa(Wa.a.Tja,lc.a.table,this.Tja);this.ga.Vc(Wa.a.Tja,1030);this.ga.pa(Wa.a.applyStyle,lc.a.table,this.Tja);this.ga.pa(Wa.a.Nra,lc.a.view,this.xae);this.ga.pa(Wa.a.Nra,lc.a.table,this.Nra);this.ga.Vc(Wa.a.Nra,1038);this.ga.pa(Wa.a.Eva,lc.a.view,b);this.ga.pa(Wa.a.Eva,lc.a.table,this.Eva);this.ga.Vc(Wa.a.Eva,1127);this.ga.pa(Wa.a.NHb,lc.a.view,b);this.ga.pa(Wa.a.NHb,lc.a.table,this.NHb);this.ga.Vc(Wa.a.NHb,1126);this.ga.pa(Wa.a.bxb,lc.a.view,this.xae);
this.ga.pa(Wa.a.bxb,lc.a.table,this.bxb);this.ga.Vc(Wa.a.bxb,1028)}FO(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}K4h(b,k,r,y,R){if(!({Ix:aa}=this.Zkb(b,k,y,R,!0)).returnValue)return 2==k&&8==aa&&dr.a.recordQosError("TableStyleOptionButtonClickNoResponse",
["TableInteractionFailed"],bd.a.y8k),aa;b=b.node;k=this.wt.rT(b);var aa=y[Ig.a.On];const ta=pp.aNl(y.MenuItemId);R?y[Ig.a.On]=pp.aXn(k,ta):(this.Efk(k,ta,aa,b),r.Mr=ta,r.BB=aa?0:1,v.ULS.shipAssertTag(0,324,!!ta));return 32}R_d(b,k){const r=this.Hc.Rc(15);try{r.Eb(b),this.Jw.z2a(),k()}finally{r&&r.dispose()}}Zkb(b,k,r,y,R){return this.Mnm(b,k,r,y,R)?{returnValue:y||2===k,Ix:32}:{returnValue:!1,Ix:8}}Mnm(b,k,r,y,R){if(b.contextId!==lc.a.table)return!1;if(y||2===k)if(R&&!r||!Object(Jb.a)(cr.TableNode,
b.node)||this.BLj(b.node))return!1;return!0}Efk(b,k,r,y){const R=(512===k||1024===k?!r:r)?b|k:b&~k;R!==b&&this.R_d(y,()=>{this.Cpd.qoa(R,y)})}static fA(){pp.k$a[pp.Tbl]=32;pp.k$a[pp.Kbl]=128;pp.k$a[pp.Mrm]=64;pp.k$a[pp.Erm]=256;pp.k$a[pp.Tik]=512;pp.k$a[pp.Sik]=1024}static aXn(b,k){b=!!(b&k);if(512===k||1024===k)b=!b;return b}static aNl(b){let k=0;b in pp.k$a&&(k=pp.k$a[b]);return k}}pp.Tbl="buttonFirstRow";pp.Kbl="buttonFirstColumn";pp.Mrm="buttonLastRow";pp.Erm="buttonLastColumn";pp.Tik="buttonBandedRow";
pp.Sik="buttonBandedColumn";pp.k$a={};Object(m.a)(pp,"TableStyleActor",null,[]);pp.fA();var FA=c(767);class Hv extends kq.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(Hv,"TableGalleryButtonProps",kq.a,[]);class Qz extends Hv{constructor(){super()}get Type(){return 6}}Object(m.a)(Qz,"TableStyleGalleryButtonProps",Hv,[]);class xw{}xw.DOm=2147483647;Object(m.a)(xw,"TableStyleUtil",null,[]);class xs{constructor(b,k,r){this.AXe="Clear";this.vzb=null;this.FYj=
b;this.Ce=k;this.wt=r;this.mQ=n.AFrameworkApplication.mQ;this.pr=n.AFrameworkApplication.pr}QXa(){}l4j(b,k){this.QXa(b);const r=this.mNh(b),y=r.length;if(!(0>=y)){var R=xw.DOm,aa=null;for(let xb=0;xb<y;xb++){var ta=r[xb],Ya=this.wt.nNl(ta);R!==Ya&&(R=Object.assign(new oi.a,{Id:"msMoreTableStyles"+Ya,Title:this.oNl(Ya),ControlList:[]}),aa=Object.assign(new $r.a,{Type:6,Id:"galleryMoreTableStyles"+Ya,ExternalGalleryId:"TableStylesGallery",Width:xs.B3f,ElementDimensions:"Size64by48",GalleryItems:[]}),
this.vzb&&(aa.ExternalId=this.vzb[Ya.toString()]),R.ControlList.push(aa),k.MenuSectionList.push(R),R=Ya);Ya=this.Ce.DF(ta);ta=xs.R4f+xb;Ya=Object.assign(new Qz,{Id:ta,ExternalId:ta,Command:Wa.a.Tja.toString(),QueryCommand:Wa.a.UOa.toString(),LabelText:Ya?A.a.Ff(Ya):"",Alt:Ya,VerticalCenterAlign:"true"});Ya.TableCellStyles=this.zId(ta,b);Ya.TableStyles=this.TJc(ta,b);aa&&aa.GalleryItems.push(Ya)}}}k4j(b){const k=Object.assign(new oi.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new Wg.a,{Id:"fseaClearTableFormatting",Command:Wa.a.bxb.toString(),LabelText:A.a.Ff(this.AXe),Alt:A.a.Ff(this.AXe),Image16by16:this.pr,Image16by16Class:ci.getImageClassWithCluster(this.mQ,xs.Pyk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});k.ControlList.push(r);b.MenuSectionList.push(k)}fvh(b,k){this.QXa(k);const r=b[Ig.a.SourceControlId];var y=this.iNb(r,k);if(y){var R=this.wt.Sz(k);R=R?this.Ce.rf(R):null;var aa=this.Ce.DF(y);y=this.Ce.rf(y);b[eh.a.Alt]=
aa;b[eh.a.On]=y===R;k=Object.assign(new Qz,{Id:r,ExternalId:r,Command:Wa.a.Tja.toString(),QueryCommand:Wa.a.UOa.toString(),TableCellStyles:this.zId(r,k),TableStyles:this.TJc(r,k),Alt:aa});b[eh.a.GalleryButtonProps]=k}else b[eh.a.InnerHTML]=null,b[eh.a.Alt]=null,b[eh.a.On]=!1,b[eh.a.GalleryButtonProps]=null}zId(b,k){this.QXa(k);return(b=this.iNb(b,k))?this.FYj.KOh(b,k):null}TJc(b,k){this.QXa(k);return this.iNb(b,k),null}TMk(b,k){b.MenuItems=this.vBl(k)}vBl(b){const k=Object.assign(new Ci.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.l4j(b,k);this.k4j(k);return k}iNb(b,k){return b?b.startsWith(xs.R4f)?this.Njf(parseInt(b.substr(xs.R4f.length)),k):this.Wzn(parseInt(b.substr(xs.W8n.length)),k):null}}xs.R4f="buttonTableStyleMenu";xs.W8n="buttonTableStyleRibbon";xs.B3f=7;xs.Pyk="ClearTableStyle_16x16x32";Object(m.a)(xs,"ATableStyleRibbonControl",null,[474]);class Gk extends xs{constructor(b,k,r){super(null,k,r);this.I3g=b}fvh(b,k){this.QXa(k);const r=b[Ig.a.SourceControlId];var y=this.iNb(r,k);if(y){var R=
this.wt.Sz(k);R=R?this.Ce.rf(R):null;var aa=this.Ce.DF(y);y=this.Ce.rf(y);b[eh.a.Alt]=aa;b[eh.a.On]=y===R;k=Object.assign(new Qz,{Id:r,ExternalId:r,Command:Wa.a.Tja.toString(),QueryCommand:Wa.a.UOa.toString(),TableCellStyles:this.zId(r,k),TableStyles:this.TJc(r,k),Alt:aa});b[eh.a.GalleryButtonProps]=k}else b[eh.a.InnerHTML]=null,b[eh.a.Alt]=null,b[eh.a.On]=!1,b[eh.a.GalleryButtonProps]=null}zId(b,k){this.QXa(k);return(b=this.iNb(b,k))?this.I3g.KOh(b,k,5,5):null}TJc(b,k){this.QXa(k);return this.iNb(b,
k),null}}Object(m.a)(Gk,"ATableStyleRibbonControlVariableSizePreviews",xs,[]);var dv=c(1416),Dq=c(1084);class eu{constructor(b,k,r,y){this.xll=(R,aa)=>this.getBorder(R,this.eY.KL(aa));this.wll=(R,aa)=>this.getBorder(R,this.eY.RN(aa));this.DC=b;this.Au=k;this.VUa=r;this.eY=y;this.azj=new cg.a(()=>this.vll());this.U5a=new cg.a(()=>this.ull())}vll(){const b={},k=n.AFrameworkApplication.isRtl;b.top="border-top";b.left=k?"border-right":"border-left";b.bottom="border-bottom";b.right=k?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=k?"border-left":"border-right";return b}ull(){const b={};b[Pf.a.Nza]=Pf.a.Iab;b[Pf.a.Iab]=Pf.a.Iab;b[Pf.a.bWa]=Pf.a.bWa;return b}hKk(b,k,r,y){const R=new Dq.a;R.rowCount=r;R.hbb=y;R.tQa=this.VUa.AMl(b);R.Ha=b.ia(wc.a.Ha,1);R.Ga=b.ia(wc.a.Ga,1);R.tableLook=k;R.rae=1;return R}KOh(b,k,r,y){if(!this.DC.rf(b)||!Object(Jb.a)(24,b)||!Object(Jb.a)(Pj.a,k))return null;const R=this.Au.rT(k);r=this.hKk(b,R,r,y);y=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.k6j(b,
k,r,y);return y}TJc(){return null}C2(){}k6j(b,k,r,y){r.t5b=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.hbb;r.cellIndex++)this.P2j(b,k,r,y)}P2j(b,k,r,y){k=this.VUa.zDk(r,this.VUa.Pcf(r),k,b);const R={};var aa=this.Au.REd(b,k,Te.a.fontColor,!0,qn.a.WP(),"None");R.color=aa?aa:"inherit";aa=this.Au.REd(b,k,Te.a.cI,!0,qn.a.WP(),"None");R["background-color"]=aa?aa:"inherit";this.P6j(r,b,k,R);y.push(R)}P6j(b,k,r,y){b=this.VUa.CLa(b);this.Eqd(5,b,k,r,y);this.Eqd(3,b,k,r,y);this.Eqd(0,b,k,r,y);this.Eqd(4,b,
k,r,y)}Eqd(b,k,r,y,R){k=this.nsl(b,k,r,y);k!==Pf.a.aF&&(R[this.azj.value[dv.a[b]]]=k)}nsl(b,k,r,y){let R=Pf.a.aF;if(({$ja:R}=this.sFa(y,b,1,k,this.wll,R)).returnValue)return R;({$ja:R}=this.sFa(r,b,3,k,this.xll,R));return R}sFa(b,k,r,y,R,aa){return this.eY.h4i(r,k,y)&&(aa=R(b,k))!==Pf.a.aF||!k&&({$ja:aa}=this.sFa(b,1,r,y,R,aa)).returnValue||4===k&&({$ja:aa}=this.sFa(b,2,r,y,R,aa)).returnValue?{returnValue:!0,$ja:aa}:{returnValue:aa!==Pf.a.aF,$ja:aa}}getBorder(b,k){let r="",y,R;({borderStyle:y,borderWidth:R}=
this.zll(b,k));if(y===Pf.a.bWa)return r;r=String.format(Pf.a.Ysd,R,y,this.oll(b,k));return r.trim()}oll(b,k){if(!k)return Pf.a.dZ;b=this.Au.Czb(b,k.color,Uo.a.auto);return b!==Uo.a.auto?Uo.a.PC(b):Pf.a.dZ}zll(b,k){var r=Pf.a.Ura;let y=Pf.a.bF+Pf.a.GYb;if(!k)return{borderStyle:r,borderWidth:y};r=this.Au.Czb(b,k.style,Pf.a.bWa);b=this.Au.Czb(b,k.size,Pf.a.bF);y=this.yll(r,b)+Pf.a.GYb;r=this.pll(r);return{borderStyle:r,borderWidth:y}}yll(b,k){let r=2;b===Pf.a.DYb&&k<Pf.a.Zja&&(r=1);return r}pll(b){return this.U5a.value[b]||
Pf.a.EYb}static pNl(){return new eu(Va.a.instance.resolve("Box4.Styles.IWACStyleReader"),Va.a.instance.resolve("WordEditor.IWACTableStyleReader"),lq.a.instance,Pf.a.instance)}static get instance(){return null!=eu.Fmg?eu.Fmg:eu.Fmg=eu.pNl()}}Object(m.a)(eu,"TableStylePreviewGenerator",null,[475]);var $o;(function(b){b[b.oEo=0]="background1";b[b.IOo=1]="text1";b[b.pEo=2]="background2";b[b.JOo=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.zHo=11]="followedHyperlink";b[b.BFo=12]="dark1";b[b.zJo=13]="light1";b[b.CFo=14]="dark2";b[b.AJo=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})($o||($o={}));Object(m.b)("ThemeColor",$o);class yu{constructor(b){this.tya=b}Ajl(b,k,r){let y;({gLi:k,Bgh:y}=this.CHl(k));b=[];const R=[];for(let ta=0;16>ta;ta++){if(!($o[ta]in r.qub))continue;const Ya=ta,xb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[y[Ya]],this.xyl(ta));var aa=k[Ya];aa=aa&4278190080|(aa&255)<<16|aa&65280|(aa&16711680)>>>16;R.push(Object.assign(new Kq.a,{Color:Ya.toString(),DisplayColor:"#"+A.a.iI(aa,6),Alt:A.a.Ff(xb)}));b[b.length]=ta}return{returnValue:R,R$n:b}}xyl(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}CHl(b){let k=null,r=null;b=this.tya(b);if(!b)return{gLi:k,Bgh:r};k=b.properties.ia(wc.a.themeColors,null);r=b.properties.getValue(wc.a.abe).split(" ");return{gLi:k,Bgh:r}}static rNl(){return new yu(Object(u.a)(yu.qh,yu.qh.pu,"navigateToPageContentNode"))}static get qh(){return lk.PageNavigator.instance}static get instance(){return null!=
yu.Ymg?yu.Ymg:yu.Ymg=yu.rNl()}}Object(m.a)(yu,"TableStyleThemeHelper",null,[511]);var hy=c(845);class Bl{constructor(b,k){this.KJe={};this.qub={};this.Ce=b;this.wt=k}T7e(b,k){const r=this.KJe[$o[k]];return r&&r.length?r:this.Bhl(b,k)}STh(b,k,r){if(k=this.T7e(k,r))for(b=this.Ce.rf(b),r=0;r<k.length;r++)if(this.Ce.rf(k[r])===b)return r;return-1}C2(){this.KJe={};this.qub={}}Bhl(b,k){const r=[];this.qub={};b=this.wt.dMa(b);this.Xrd(r,this.qub,0,k,b);this.Xrd(r,this.qub,1,k,b);this.Xrd(r,this.qub,2,k,
b);this.Xrd(r,this.qub,3,k,b);return this.KJe[$o[k]]=r}Xrd(b,k,r,y,R){const aa=R.yN;for(let ta=0;ta<aa;ta++){const Ya=R.Pla(ta);if(3!==this.Ce.Xw(Ya))continue;const xb=this.wt.mNl(Ya),Mb=this.wt.SJc(Ya);k[$o[Mb]]=!0;xb!==r||Mb!==y&&16!==Mb||this.Ce.rf(Ya)===hy.a.e5c||(b[b.length]=Ya)}}static VQl(){return new Bl(Va.a.instance.resolve("Box4.Styles.IWACStyleReader"),Va.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static oQk(){return Bl.VQl()}}Object(m.a)(Bl,"WACTableStyleRibbonList",null,[510]);
class ot extends Gk{constructor(b,k,r,y,R){super(b,k,r);this.APb=4;this.Wnd=[];this.Z9l=()=>{this.HWb.C2();this.I3g.C2()};this.GYj=R;this.HWb=y;this.AXe=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.k8m()}bKk(b,k){b.MenuItems=this.Ngl(k)}k8m(){this.vzb={};this.vzb["0"]="CustomTableStyles";this.vzb["1"]="PlainTableStyles";this.vzb["2"]="GridTableStyles";this.vzb["3"]="ListTableStyles"}Ngl(b){const k=Object.assign(new Ci.a,{Id:"menuTableTheme"});k.MenuSectionList=[];if(this.anm(b))return k;
const r=Object.assign(new oi.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),y=Object.assign(new FA.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Jc.a.kab.toString(),QueryCommand:Jc.a.BIb.toString(),Width:ot.S$n});y.Colors=({R$n:this.Wnd}=this.GYj.Ajl(this.Wnd,b,this.HWb)).returnValue;r.ControlList.push(y);k.MenuSectionList.push(r);return k}QXa(b){if(b=this.wt.Sz(b))b=this.wt.SJc(b),16!==b&&(this.APb=b)}mNh(b){return this.HWb.T7e(b,this.APb)}Njf(b,
k){k=this.HWb.T7e(k,this.APb);return 0>b||b>=k.length?null:k[b]}Wzn(b,k){var r=this.wt.Sz(k);r=this.HWb.STh(r,k,this.APb);r=-1!==r?Math.floor(r/xs.B3f)*xs.B3f:0;return this.Njf(r+b,k)}oNl(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}anm(b){this.QXa(b);
return 0>=this.mNh(b).length}rpo(b,k){if(!b||!k)return null;b=parseInt(b[pm.Color]);var r=this.wt.Sz(k);const y=this.wt.SJc(r);if(y===b)return null;if(16===y)return this.APb=b,null;r=this.HWb.STh(r,k,y);this.APb=b;return this.Njf(r,k)}XWk(b){b=this.wt.Sz(b);b=this.wt.SJc(b);if(16!==b)for(let k=0;k<this.Wnd.length;k++)if(this.Wnd[k]===b)return k;return-1}tXb(b){b.gOe(this.Z9l,2)}static qNl(){return new ot(eu.instance,Va.a.instance.resolve("Box4.Styles.IWACStyleReader"),Va.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Bl.oQk(),yu.instance)}static get instance(){return null!=ot.Bng?ot.Bng:ot.Bng=ot.qNl()}}ot.S$n=4;Object(m.a)(ot,"TableStyleRibbonControls",Gk,[473,474]);var iy=c(1505);class qi extends pp{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,r,y,R,aa,ta,Ya)}icc(b){super.icc(b);this.ga.pa(Jc.a.kab,lc.a.view,Object(u.a)(this,this.xae,"tableStyleGenericViewActionHandler"));this.ga.pa(Jc.a.kab,lc.a.table,Object(u.a)(this,this.kab,"applyTableTheme"));this.ga.Vc(Jc.a.kab,1030);this.ga.pa(Jc.a.nbc,lc.a.view,b);this.ga.pa(Jc.a.nbc,
lc.a.table,Object(u.a)(this,this.nbc,"populateMenuTableTheme"));this.ga.Vc(Jc.a.nbc,1126);this.ga.pa(Jc.a.BIb,lc.a.view,b);this.ga.pa(Jc.a.BIb,lc.a.table,Object(u.a)(this,this.BIb,"queryTableTheme"));this.ga.Vc(Jc.a.BIb,1127)}nbc(b,k,r,y,R){if(!({Ix:b}=this.Zkb(k,r,R,!1,!0)).returnValue)return b;this.S4f.bKk(R,k.node);return 32}kab(b,k,r,y,R){if(!({Ix:b}=this.Zkb(k,r,R,!1,!0)).returnValue)return 2==r&&8==b&&dr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],bd.a.z8k),
b;const aa=k.node,ta=this.S4f.rpo(R,aa);ta&&this.R_d(aa,()=>{this.Cpd.XPa(ta,aa)});return 32}BIb(b,k,r,y,R){if(!({Ix:b}=this.Zkb(k,r,R,!0,!0)).returnValue)return b;R[pm.IndexColorSelected]=this.S4f.XWk(k.node);return 32}get S4f(){return this.Cnd}static lNl(){return new qi(Va.a.instance.resolve("WordEditor.IWACTableStyleReader"),ot.instance,n.AFrameworkApplication.ya,iy.a.instance,new Qn.a,Va.a.instance.resolve("Box4.IInsertionPointFormatting"),Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(u.a)(mh.a.instance,mh.a.instance.Rgb,"isTableNodeInLockedRange"))}static get instance(){return null!=qi.Nmg?qi.Nmg:qi.Nmg=qi.lNl()}}Object(m.a)(qi,"TableStyleActor",pp,[]);var Kt=c(1554);class Rz{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}zc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>eu.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>Kt.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",
()=>iy.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(119)&&(qi.instance.Vb(),ot.instance.tXb(Uu.a.instance),rj.StyleReader.yae=Kt.a.instance,Ka.App.xa.updateCommandUI())}dispose(){}}Object(m.a)(Rz,"TableStylePackage",null,[1,2]);var zu=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",
attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",
TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",
attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",
MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",
MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},
oC=c(1411);class Wy{constructor(b,k){this.zHa=b;this.Bxa=k}Non(b){this.zHa.mrd(b)}eAa(b){this.Bxa.eAa(b)}KKb(b,k){return this.Bxa.KKb(b,k)}JKb(b,k){return this.Bxa.JKb(b,k)}m7f(b,k,r){this.Bxa.m7f(b,k,r)}}Object(m.a)(Wy,"ClientPaginationHeaderFooterBridge",null,[611]);class lx{constructor(b,k){this.Ll=b;this.ga=k;this.b9=new xk.a;this.c9=new xk.a}eAa(b){b=Wd.GraphIterator.Za(b);if(b.ro()&&b.Mp()){b.Ud();do 10===b.Le&&this.xMf(b.currentNode),b.Ht();while(8!==b.Le)}}KKb(b,k){var r=this.sBb(k);if(!this.b9.ub(r))return v.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;k=this.b9.J(r);v.ULS.shipAssertTag(573400389,336,this.c9.ub(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");r=this.c9.J(r);return this.Dlf(k,b,r)}JKb(b,k){var r=this.sBb(k);if(!this.b9.ub(r))return v.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;k=this.b9.J(r);
v.ULS.shipAssertTag(573400391,336,this.c9.ub(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.c9.J(r);return this.Q$e(k,b,r)}m7f(b,k,r){k=this.Uif(k,r);this.ga.Xb(b?Jc.a.eee:Jc.a.K4c,2,k)}Uif(b,k){k=this.Ll.IAb(k);if(!k)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;k=this.Ll.Rla(k);const r=1===b;b=!(b%2);return 1===k?1:2===k?r?2:1:3===k?b?3:4:r?2:b?3:4}xMf(b){if(10===
b.type){var k=new xk.a,r=this.Ll.IAb(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var y=this.Ll.Rla(r);b=this.sBb(b);this.J9f(b,y);this.I9f(b,k);r=Wd.GraphIterator.Za(r);if(r.Mp()){r.Ud();do b=r.currentNode,y=this.Ll.fGd(b),b=this.Ll.d6h(b),k.add(y,b),r.Ht();while(36===r.Le)}}}J9f(b,k){this.c9.ub(b)?this.c9.Z(b,k):this.c9.add(b,k)}I9f(b,k){this.b9.ub(b)?this.b9.Z(b,k):this.b9.add(b,
k)}sBb(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(wc.a.Sga,0)}Dlf(b,k,r){const y=1===k;k=!(k%2);switch(r){case 2:if(y){if(b.ub(2))return b.J(2)}else if(b.ub(0))return b.J(0);break;case 3:if(k){if(b.ub(1))return b.J(1)}else if(b.ub(0))return b.J(0);break;case 4:if(y){if(b.ub(2))return b.J(2)}else if(k){if(b.ub(1))return b.J(1)}else if(b.ub(0))return b.J(0);break;case 1:if(b.ub(0))return b.J(0)}return!1}Q$e(b,k,r){const y=
1===k;k=!(k%2);switch(r){case 2:if(y){if(b.ub(5))return b.J(5)}else if(b.ub(3))return b.J(3);break;case 3:if(k){if(b.ub(4))return b.J(4)}else if(b.ub(3))return b.J(3);break;case 4:if(y){if(b.ub(5))return b.J(5)}else if(k){if(b.ub(4))return b.J(4)}else if(b.ub(3))return b.J(3);break;case 1:if(b.ub(3))return b.J(3)}return!1}}Object(m.a)(lx,"ClientPaginationPageAdornmentContentManager",null,[610]);class yw{constructor(b,k,r,y,R,aa){this.qEk=ta=>{1===ta&&this.JD.QD&&(ta=this.Yc.pBa(this.JD.QD,8,8),this.Ll.ssk(ta)?
this.BUk(ta):this.WYn())};this.Jgo=ta=>{1===ta&&this.ga.Xb(Wa.a.openInClient,2,!1)};this.JD=b;this.Ll=k;this.Yc=r;this.Hc=y;this.Doc=R;this.ga=aa}iZn(){const b=new cf.StandardDialog;b.Gd=1;b.We(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.wU(0);b.Tv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.qEk)}BUk(b){b.kd(8);const k=this.Hc.Rc(15);k.set(b.Gn.Ui);this.Doc.Xqn(b);this.JD.dismiss();k.dispose();
v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}WYn(){const b=new cf.StandardDialog;b.Gd=1;b.We(1,Box4Intl.Box4Strings.L_OpenInWord);b.We(0,CommonUIStrings.l_Close);b.wU(0);b.Tv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.Jgo);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(yw,"DeleteHeaderFooterDialog",null,[]);class GA{constructor(b,k,r,y,R){this.Ll=b;this.Yc=
k;this.Hc=r;this.Doc=y;this.ga=R}create(b){return new yw(b,this.Ll,this.Yc,this.Hc,this.Doc,this.ga)}}Object(m.a)(GA,"DeleteHeaderFooterDialogFactory",null,[609]);class Lt{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.J8=null;this.x6f=(cc,jc,Mc,fd,Td)=>{var ne=this.Rjf(jc);return ne?1===Mc?32:(Mc=this.control)?(jc=this.Hc.Rc(15),jc.Eb(ne),jc.Al=cc,Mc.s$?this.ga.processAction(Jc.a.WS,2):(ne=this.SFh(ne),fd.Mr=ne?1:0,fd=cc!==Jc.a.K4c,(cc=this.Zef(cc,Td))&&Mc.awa(cc),this.ga.Xb(Jc.a.Ozd,2,fd)),jc.dispose(),
32):8:8};this.r3e=(cc,jc,Mc)=>{if(1===Mc)return 32;this.JCj.create(this.control).iZn();return 32};this.Cen=(cc,jc,Mc,fd,Td)=>1===Mc?32:(cc=this.control)?(Td[Ig.a.On]=cc.s$,32):8;this.Okb=(cc,jc,Mc,fd,Td)=>{if(1===Mc||!this.control.s$)return 32;jc=this.gTh(cc,Td);Mc=Lt.C2h(this.control.QD);fd=this.Hc.Rc(15);fd.Eb(Mc);fd.Al=cc;cc=this.Yc.Ck();cc.set(Mc);this.AHa.R7e(cc.currentNode,jc);this.Ll.fGb(cc);this.Doc.X1i(cc,jc);fd.dispose();return 32};this.awa=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;cc=this.Zef(cc,
Td);this.control.s$&&this.control.awa(cc);return 32};this.v6d=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;cc=this.XZh(cc,Td);fd.Mr=cc;jc=this.Rjf(jc);if(!jc)return 8;fd=this.Yc.Ck();fd.set(jc);fd.Ab(8);fd.it(8);if(!this.Jk.lMm(fd,cc))return 8;this.Ll.fGb(fd);this.control.uea(fd.currentNode);return 32};this.yMf=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;cc=this.GZj.XOk(this.Rjf(jc));Td.PopulationXML=cc;return 32};this.p2d=(cc,jc,Mc,fd,Td)=>{cc=this.gTh(cc,Td);jc=this.control.QD;Mc=this.Ll.Rla(jc);Td[Ig.a.On]=
cc===Mc;1===cc&&(Td[Ig.a.LabelText]=this.B3h(jc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.p1d=(cc,jc,Mc,fd,Td)=>{if(1===Mc||!this.control.s$)return 32;jc=this.control.QD;void 0!==jc&&null!==jc&&(jc=this.Ll.Rla(jc),cc=this.Zef(cc,Td),Mc=this.control.CPb,Td[Ig.a.Visible]=this.$9n(cc,jc),Td[Ig.a.On]=cc===Mc);return 32};this.Oen=(cc,jc,Mc,fd,Td)=>{if(1===Mc||!this.control.s$)return 32;cc=this.control.QD;void 0!==
cc&&null!==cc&&this.B8m(cc,Td);return 32};this.aen=(cc,jc,Mc,fd,Td)=>{if(1===Mc||!this.control.s$)return 32;cc=this.XZh(cc,Td);jc=this.control.QD;Mc=0;void 0!==jc&&null!==jc&&(Mc=jc.getValue(wc.a.Sga));Td[Ig.a.On]=cc===Mc;return 32};this.WS=(cc,jc,Mc)=>{if(1===Mc)return 32;this.control.dismiss();return 32};this.lLd=()=>32;this.Ozd=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;this.control.show(Td);return 32};this.khb=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;if(!Td)return 8;jc=Td.LWa;if(!jc||!jc.isConnected)return 8;
cc=this.Ll.GDf(jc);if(!({isHeader:Mc,B5f:jc}=this.Ll.e1h(jc)).returnValue)return 8;this.control.uea(cc);this.control.awa(jc);this.control.show(Mc,Td.n8d);return 32};this.ga=b;this.Ll=k;this.Doc=r;this.AHa=y;this.Jk=R;this.Yc=aa;this.Hc=ta;this.GZj=Ya;this.fHj=xb;this.JCj=Mb}get control(){return this.J8}set control(b){this.J8=b}Vb(){this.ga.pa(Jc.a.PMd,lc.a.view,this.x6f);this.ga.gb(Jc.a.rPf,lc.a.application,this.Cen,96);this.ga.pa(Jc.a.eee,lc.a.view,this.x6f);this.ga.pa(Jc.a.K4c,lc.a.view,this.x6f);
this.ga.gb(Jc.a.lLd,lc.a.view,this.lLd,64);this.ga.pa(Jc.a.Ozd,lc.a.view,this.Ozd);this.ga.gb(Jc.a.WS,lc.a.application,this.WS,96);this.ga.gb(Jc.a.khb,lc.a.application,this.khb,96);this.ga.gb(Jc.a.rJn,lc.a.view,this.awa,96);this.ga.pa(Jc.a.fZi,lc.a.view,this.awa);this.ga.pa(Jc.a.hZi,lc.a.view,this.awa);this.ga.pa(Jc.a.gZi,lc.a.view,this.awa);this.ga.pa(Jc.a.iZi,lc.a.view,this.awa);this.ga.gb(Jc.a.RMn,lc.a.view,this.Okb,100);this.ga.gb(Jc.a.P_i,lc.a.view,this.Okb,4);this.ga.gb(Jc.a.O_i,lc.a.view,this.Okb,
4);this.ga.gb(Jc.a.M_i,lc.a.view,this.Okb,4);this.ga.gb(Jc.a.N_i,lc.a.view,this.Okb,4);this.ga.pa(Jc.a.v6d,lc.a.view,this.v6d);this.ga.pa(Jc.a.QXf,lc.a.view,this.v6d);this.ga.gb(Jc.a.yMf,lc.a.view,this.yMf,96);this.ga.gb(Jc.a.r3e,lc.a.view,this.r3e,4);this.ga.gb(Jc.a.pJi,lc.a.view,this.p1d,97);this.ga.gb(Jc.a.rJi,lc.a.view,this.p1d,97);this.ga.gb(Jc.a.qJi,lc.a.view,this.p1d,97);this.ga.gb(Jc.a.sJi,lc.a.view,this.p1d,97);this.ga.gb(Jc.a.LJi,lc.a.view,this.p2d,97);this.ga.gb(Jc.a.KJi,lc.a.view,this.p2d,
97);this.ga.gb(Jc.a.IJi,lc.a.view,this.p2d,97);this.ga.gb(Jc.a.JJi,lc.a.view,this.p2d,97);this.ga.gb(Jc.a.wen,lc.a.view,this.Oen,97);this.ga.gb(Jc.a.QOf,lc.a.view,this.aen,97)}SFh(b){const k=this.Ll.IAb(b),r=this.Ll.Rla(k);b=this.AHa.R7e(b,r);this.control.uea(k);return b}gTh(b,k){switch(b){case Jc.a.P_i:case Jc.a.LJi:b=1;break;case Jc.a.O_i:case Jc.a.KJi:b=2;break;case Jc.a.M_i:case Jc.a.IJi:b=3;break;case Jc.a.N_i:case Jc.a.JJi:b=4;break;default:b=k}return b}Zef(b,k){switch(b){case Jc.a.fZi:case Jc.a.pJi:b=
1;break;case Jc.a.hZi:case Jc.a.rJi:b=2;break;case Jc.a.gZi:case Jc.a.qJi:b=3;break;case Jc.a.iZi:case Jc.a.sJi:b=4;break;case Jc.a.eee:case Jc.a.K4c:b=k;break;case Jc.a.PMd:b=0;break;default:b=k}return b}XZh(b,k){return b===Jc.a.QXf||b===Jc.a.QOf?parseInt(k.MenuItemId):k}Rjf(b){return this.Jk.S$(b.rk)}$9n(b,k){switch(k){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}B8m(b,k){const r=this.B3h(b);if(k[Ki.a.Visible]=r)b=this.Jk.D2h(this.fHj(b)),
b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),k[Ki.a.LabelText]=b}B3h(b){const k=this.Yc.Ck();k.set(b);k.Ab(8);k.it(8);return 1<this.Jk.qjf(k)}static C2h(b){const k=new Wd.GraphIterator;k.set(b);k.Ab(10);return np.WordSectionNavigator.yBn(k)}}Object(m.a)(Lt,"HeaderFooterActor",null,[]);var Po=c(608),Iv=c(748);class mx{constructor(b,k,r,y,R){this.UOj=b;this.Ll=k;this.Jk=r;this.Yc=y;this.ga=R}FFh(b,k){this.Ll.fGb(b);k=this.y4k(b,k);b.mc();return k}R7e(b,k){b=
this.Yc.pBa(b,8,8);let r=!1;this.Jk.rLa(b,y=>{const R=this.Yc.Ck();R.set(y);r=(y=this.FFh(R,k))||r;return y});return r}y4k(b,k){if(3!==this.ga.mode)return!1;let r=!1;k=Iv.a.f4e(k);for(let y=0;y<k.length;++y)r=this.UOj.x4k(b,k[y])||r;return r}}mx.iTk=1;Object(m.a)(mx,"HeaderFooterInserter",null,[602]);class Ip{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.S0g=this.cDg=!1;this.QD=null;this.Gue=!1;this.CPb=0;this.JGb=()=>{this.Gue=!0};this.A4=b;b.bind(this);this.TLe=y;this.hDj=xb;this.sUg=R;this.KPj=
aa;this.C7a=ta;this.header=k;this.footer=r;this.header.WPk();this.A4.ez();this.YJe=mx.iTk;this.AHa=Ya;Ip.ga=Mb;this.LM=cc}get s$(){return this.cDg}show(b=!0,k=!0){this.s$||(this.xkj(),this.l_i(!0),this.header.imn(),this.hDj(),this.u4n(),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Po.a,{state:0,disablePopover:!0}))));(this.S0g=k)&&this.sUg(b)}dismiss(b=!1){this.s$&&(this.KPj(b),this.l_i(!1),this.Gyb(),this.CPb=
0,this.B5n(),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Po.a,{disablePopover:!1}))))}l_i(b){this.cDg=b;Ip.ga.processAction(Wa.a.qaf,2);this.A4.y_(b);this.header.y_(b);this.footer.y_(b);this.TLe()}uea(b){this.QD!==b&&(this.QD=b,this.header.uea(b),this.footer.uea(b),this.CPb=0,this.Okb(this.C7a.Rla(b)))}Gyb(){this.QD&&(this.header.ecb(),this.footer.ecb(),this.QD=null)}update(){this.s$&&this.fde()}fde(){this.QD&&
(this.C7a.z0k(this.QD)&&this.C7a.kZl(this.QD)?this.xkj():this.dismiss())}xkj(){const b=this.C7a.Rla(this.QD);b!==this.YJe&&this.Okb(b)}Okb(b){this.YJe=b;this.awa(this.LNl(b))}LNl(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}awa(b,k=!0){this.CPb!==b&&(this.AHa.R7e(this.QD,this.YJe),this.header.eZi(b),this.header.Pfh(Rh.AppFrame.V$),this.footer.eZi(b),this.footer.Pfh(Rh.AppFrame.A$),this.CPb=b,this.s$&&this.S0g&&this.e5k(k))}e5k(b){this.sUg(b);b?this.header.setInitialSelection():
this.footer.setInitialSelection()}dispose(){this.A4.j8();this.header.dispose();this.footer.dispose()}u4n(){this.LM.krd(this.JGb);this.Gue=!1}B5n(){this.LM.oTf(this.JGb);this.Gue&&Ip.ga.processAction(Jc.a.lLd,2)}static WYk(){Ip.ga.Xb(ib.a.cfb,2,!0);Ip.ga.processAction(Jc.a.q$,2)}}Ip.ga=null;Object(m.a)(Ip,"HeaderFooterControl",null,[631,10]);class HA{constructor(b,k,r,y,R){this.TLe=b;this.C7a=k;this.AHa=r;this.ga=y;this.LM=R}create(b,k,r,y,R){return new Ip(b,k,r,this.TLe,y,R,this.C7a,this.AHa,Ip.WYk,
this.ga,this.LM)}}Object(m.a)(HA,"Factory",null,[608]);class nx{constructor(){this.J8=null}get control(){return this.J8}set control(b){this.J8=b}$af(b){return this.abf(this.control.QD,this.control.CPb,b.isHeader,b)}abf(b,k,r,y){return()=>{if(!b.isConnected)return null;this.control.uea(b);this.control.awa(k);this.control.show(r);return y}}dismiss(){this.J8.s$&&this.J8.dismiss()}}Object(m.a)(nx,"HeaderFooterControlLauncher",null,[]);var yB=c(1137),Jv=c(531),ys=c(335),zw=c(801);class Kv{constructor(b,
k,r){this.Pgc=null;const y=k?"Header":"Footer";this.Yq=b.ownerDocument.createElement("div");this.Yq.id=k?"HeaderPane":"FooterPane";this.Yq.classList.add(Kv.nZl,y);this.Wub=(new zw.a(this.Yq,"WACViewPanel_"+y)).BE;this.Yq.appendChild(this.Wub);b.appendChild(this.Yq);k&&(this.Pgc=b.ownerDocument.createElement("div"),this.Pgc.classList.add(Kv.sZl),this.Yq.appendChild(this.Pgc));this.Yvg=r.rEl(this.Yq)}bind(){}y_(b){b?this.Yvg.bck():this.Yvg.dck()}Qjk(b){b.Aab(this.Wub)}}Kv.sZl="HeaderToolbarContainer";
Kv.nZl="HeaderFooterPane";Object(m.a)(Kv,"PaneControlDom",null,[657]);class ev{constructor(b,k,r,y,R){this.JD=this.qq=null;this.bAi=()=>{this.JD.dismiss(!0);if(this.GQb){let aa=new Wt.a(!0);this.GQb.YDa(aa)}return!0};this.nD=aa=>{aa.Ib.preventDefault();return!1};this.Yq=b.ownerDocument.createElement("div");this.Yq.id=ev.Ish;this.Yq.className=ev.Ish;this.MY=y;this.GQb=R;this.b6h=new Kv(this.Yq,!0,k);this.NNk(this.Yq);this.dLh=new Kv(this.Yq,!1,k);this.y_(!1);b.appendChild(this.Yq)}NNk(b){this.qq=b.ownerDocument.createElement("div");
this.qq.id=ev.E2m;this.qq.className=ev.C2m;this.qq.tabIndex=0;this.qq.setAttribute(Ef.a.Bh,Ef.a.J1);this.qq.setAttribute(Ef.a.Eda,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.qq)}bind(b){this.JD=b}y_(b){if(!b&&this.MY){var k=new Wt.a(!0);this.MY.YDa(k)}!b&&this.GQb&&(k=new Wt.a(!0),this.GQb.YDa(k));this.Yq.style.display=b?"":"none";this.b6h.y_(b);this.dLh.y_(b)}iMn(){this.qq.focus()}ez(){Sf.a.instance.mb(Kb.a.click,this.qq,this.bAi);pf.a.instance.mb(Kb.a.ex,
this.Yq,this.nD)}j8(){Sf.a.instance.sc(Kb.a.click,this.qq,this.bAi);pf.a.instance.sc(Kb.a.ex,this.Yq,this.nD)}}ev.Ish="HeaderFooterControl";ev.E2m="HeaderFooterOverlay";ev.C2m="EditingSurfaceOverlay HeaderFooterOverlay";Object(m.a)(ev,"HeaderFooterControlDom",null,[627]);class pC{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.A4=null;this.sa=new Fe.a;this.JD=this.gld=null;this.lHf=cc=>{this.I7(cc);this.sa.raiseEvent("OnShowEventKey")};this.kHf=cc=>{this.mf&&(this.gld=new yB.a(this.mf));this.Ub.ADc(Rh.AppFrame.V$);
this.Ub.ADc(Rh.AppFrame.A$);this.vba(cc);this.sa.raiseEvent("OnDismissEventKey")};this.d_d=()=>{this.gld&&(this.gld.dispose(),this.gld=null)};this.Ub=b;this.Ro=k;this.nWg=r;this.GHj=y;this.DRj=R;this.ga=aa;this.EAg=Jv.a.create();this.xEg=bc.KeyInputManager.lc(tb.a.hs,0);this.wY=bc.KeyInputManager.lc(tb.a.h0,0);this.AXj=bc.KeyInputManager.lc(tb.a.KFa,0);this.QH=ta;this.Oa=Ya;this.MY=xb;this.GQb=Mb;this.mf&&this.mf.Lja(this.d_d)}Vah(b){this.sa.addHandler("OnShowEventKey",b)}qun(b){this.sa.removeHandler("OnShowEventKey",
b)}mrd(b){this.sa.addHandler("OnDismissEventKey",b)}yQi(b){this.sa.removeHandler("OnDismissEventKey",b)}get mf(){const b=this.QH.value;return b?b.yi?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.JD}get HGk(){return this.EAg}bind(b){this.JD=this.UEk(b);this.EAg.instance=this.JD}UEk(b){this.A4=new ev(b,this.DRj.value,
this.Oa,this.MY,this.GQb);b=this.nWg.value.create(this.ga,this.A4.b6h,!0,Rh.AppFrame.V$);const k=this.nWg.value.create(this.ga,this.A4.dLh,!1,Rh.AppFrame.A$);this.JD=this.GHj.value.create(this.A4,b,k,this.lHf,this.kHf);this.Xnf();this.wS();return this.control}Xnf(){var b=3===this.ga.mode?Rh.AppFrame.sF:Rh.AppFrame.bXc;const k=this.Ub.re(Rh.AppFrame.V$);k.parent=b;this.Ub.wOe(Rh.AppFrame.V$);const r=this.Ub.re(Rh.AppFrame.A$);r.parent=b;this.Ub.wOe(Rh.AppFrame.A$);b=this.Ub.re(ys.a.gCb);b.parent=id.AFrame.Qp;
b.wda(()=>{this.A4.iMn()});b.bindAction(this.xEg,Jc.a.WS);b.bindAction(this.wY,Jc.a.WS);b.bindAction(this.AXj,Jc.a.WS);k.bindAction(this.wY,Jc.a.WS);r.bindAction(this.wY,Jc.a.WS)}wS(){this.Ro.wS(Rh.AppFrame.V$);this.Ro.wS(ys.a.BZa);this.Ro.wS(Rh.AppFrame.A$);this.Ro.wS(ys.a.gCb)}I7(b){this.Ro.LG(Rh.AppFrame.V$);this.Ro.LG(ys.a.BZa);this.Ro.LG(Rh.AppFrame.A$);this.Ro.LG(ys.a.gCb);this.Ro.Rw(id.AFrame.Wo);this.Ub.ayc(Rh.AppFrame.V$);this.Ub.ayc(Rh.AppFrame.A$);b?this.Ub.Kg(Rh.AppFrame.V$):this.Ub.Kg(Rh.AppFrame.A$)}vba(b){this.Ro.Rw(Rh.AppFrame.V$);
this.Ro.Rw(ys.a.BZa);this.Ro.Rw(Rh.AppFrame.A$);this.Ro.Rw(ys.a.gCb);this.Ro.LG(id.AFrame.Wo);(b||this.Ub.pg&&(this.Ub.pg.name===Rh.AppFrame.V$||this.Ub.pg.name===ys.a.BZa||this.Ub.pg.name===Rh.AppFrame.A$||this.Ub.pg.name===ys.a.gCb))&&this.Ub.Kg(id.AFrame.Wo)}dispose(){const b=this.Ub.re(ys.a.gCb);b.Er(this.xEg);b.Er(this.wY);this.Ub.re(Rh.AppFrame.V$).Er(this.wY);this.Ub.re(Rh.AppFrame.A$).Er(this.wY);this.mf&&this.mf.g4d(this.d_d);this.control.dispose()}}Object(m.a)(pC,"HeaderFooterControlOwner",
null,[606,607]);var zB=c(1085);class jy{constructor(b,k,r,y,R,aa){this.Ll=b;this.Yc=k;this.$Qj=r;this.Nl=y;this.cRj=R;this.IHj=aa}k7l(b,k){const r=this.Yc.Ck();r.set(b);this.Ll.gGb(r,k);this.$Qj(r);this.cRj(r.currentNode,this.Nl);this.IHj.l7l(r,zB.a(k))}}Object(m.a)(jy,"HeaderFooterDefaultContentInserter",null,[605]);class fm{constructor(b,k,r,y,R,aa,ta,Ya){this.oS=b;this.AYj=k;this.bke=r;this.Nl=y;this.bRj=R;this.VWj=aa;this.wHj=ta;fm.Kh=Ya}l7l(b,k){this.AYj(b,1,3,null,!1);this.oS.O_c(hy.a.e5c,1696,
b.currentNode);this.bke(b,0,this.Nl?3:1,k);this.bke(b,1,2,k);this.bke(b,2,this.Nl?1:3,k);this.bRj(b);this.VWj(b,!1,!0,null);this.wHj(b,k)}static get iR(){return null!=fm.Ztg?fm.Ztg:fm.Ztg=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=fm.sqg?fm.sqg:fm.sqg=Va.a.instance.resolve("Box4.IParagraphEditor")}static nKn(b,k,r){bf.moveToCellContent(b,0,k);xg.OutlineElementNavigator.Fe(b);fm.iR.J7d(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);fm.paragraphEditor.tD(b.currentNode,
r);k||fm.paragraphEditor.xp.iwa(b,1,-115);2===k&&fm.paragraphEditor.xp.gKb(b.currentNode,1,-115);bf.returnToContainingTable(b)}static PMn(b,k){xg.OutlineElementNavigator.Fe(b);fm.iR.J7d(k?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);xg.OutlineElementNavigator.Xd(b)}static zml(){return(b,k,r)=>{fm.nKn(b,k,r)}}static Cvl(){return(b,k)=>{fm.PMn(b,k)}}static YMl(b){return(k,r,y,R,aa)=>b.rAa(k,r,y,R,aa)}static aLl(){return(b,k,r,y,R)=>fm.Kh.TB(b,k,r,y,R)}}
fm.Kh=null;Object(m.a)(fm,"HeaderFooterDefaultTableInserter",null,[604]);class Lv{constructor(b,k,r,y){this.Ll=b;this.xTb=k;this.Yc=r;this.Jk=y}X1i(b,k){b.Gn.properties.setValue(wc.a.flf,2===k||4===k);b.Ab(8);b.l4c(8).properties.setValue(wc.a.TKd,3===k||4===k)}Xqn(b){this.Jk.rLa(b,k=>{const r=this.Yc.Ck();r.set(k);this.Ll.fGb(r);this.X1i(r,1);this.Yqn(r);return!0})}Yqn(b){for(;b.Ud();)b.Hg()}}Object(m.a)(Lv,"HeaderFooterEditor",null,[603]);var qC=c(1090);class AB extends Hr.a{constructor(b){super();
this.VLe=b}get index(){return 0}run(){this.VLe()}jZl(b,k){k.property===wc.a.flf&&this.tH()}b3m(b,k){k.property===wc.a.TKd&&this.tH()}tH(){this.rX()}}Object(m.a)(AB,"ControlUpdateNeededTracker",Hr.a,[]);class IA{constructor(b,k,r,y,R,aa){this.r6a=null;this.HHj=r;this.Gbd=k;this.oRb=b;this.rRj=y;this.zIa=aa}start(){this.oRb.bind(Ka.App.xa.nC);this.Gbd.control=this.oRb.control;this.Gbd.Vb();this.HHj.control=this.oRb.control;this.rRj.value.create(this.oRb.control,Object(u.a)(this.Gbd,this.Gbd.SFh,"ensureSectionHeaderFooterAttachedToControl")).Vb();
this.K_l()}K_l(){this.r6a=new AB(()=>{this.oRb.control.update()});const b=Ka.App.ik.ml;b.Ve(35).qp(Object(u.a)(this.r6a,this.r6a.jZl,"headerFooterContainerNodePropertyChanged"));b.Ve(8).qp(Object(u.a)(this.r6a,this.r6a.b3m,"pageContentNodePropertyChanged"));qC.a.w3d(Object(u.a)(this.r6a,this.r6a.tH,"setUpdateNeeded"));Fl.GraphTransactionManager.instance.koa(this.r6a,3)}dispose(){this.oRb.dispose();this.zIa.EBh()}}Object(m.a)(IA,"HeaderFooterManager",null,[]);class JA{constructor(b,k,r,y){this.Jk=
b;this.Ll=k;this.TOj=r;this.Ume=y}x4k(b,k){let r=!1;const y=Iv.a.ygf(k);b.fq(y)||(this.t7l(b,k),this.Ume.k7l(b.currentNode,k),r=!0);return r}t7l(b,k){const r=this.TOj.create(1074135123),y=b.currentNode.ia(wc.a.Sga,0);r.properties.setValue(wc.a.Sga,y);r.properties.setValue(wc.a.P4b,k);k=Iv.a.ygf(k);b.Rf(r,k)}}Object(m.a)(JA,"HeaderFooterNodeLevelInserter",null,[601]);var fv=c(234),ox=c(423);class Aw extends fv.a{constructor(b,k,r){super(b,k,"","");this.qsb=null;this.m6h=Aw.Oyh;this.dLc=[];this.dse=
r}get eA(){return!0}get cssClass(){return"cui-herodock"}im(){this.cmn();super.im()}$Ka(){for(const b of this.dLc)b.UAd();super.$Ka()}t3n(){let b,k,r;b=[];k=[];r=[];for(let y=0;y<this.dLc.length;y++){const R=this.dLc[y];R.visible?b.length<this.m6h?b.push(R):Object(Jb.a)(ox.FlyoutAnchor,R)?Array.addRange(k,R.rpl()):k.push(R):r.push(R)}return{Qbo:b,A2m:k,f$l:r}}MNk(b){if(!b||!b.length)return null;const k=new Xi.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new nc.a(this.root,this.id+"OverflowMenuSection",
null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},k);for(const y of b)r.Rf(y.JP("Menu20"));k.Rf(r);return k}cmn(){this.P3d();this.Lc=mg.a.jPa(this.Lc);this.JB();var b;({Qbo:r,A2m:b,f$l:y}=this.t3n());for(var k of r){var r=k.JP("Medium20");r.enabled=!0;this.aXb(r,this.children.count);this.Lc.appendChild(r.Lc);r.ala()}if(b=this.MNk(b))this.qsb?this.qsb.menu=b:(k=this.id+"OverflowMenuLauncher",r={},r.Image20by20=this.dse.OverflowMenuImage20by20,r.Image20by20Class=this.dse.OverflowMenuImage20by20Class,
r.PopulateDynamically="false",r.HideDefaultArrow="true",r.Alt=this.dse.OverflowMenuTooltip,r.Command="798637440",r.Id=k,this.qsb=new ox.FlyoutAnchor(this.root,k,r,b)),b=this.qsb.JP("Small20"),b.enabled=!0,this.aXb(b,this.children.count),this.Lc.appendChild(b.Lc),b.ala();if(n.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const R of y){var y=R.JP("Medium20");this.Rf(y);y.ala()}}dispose(){this.qsb&&(this.qsb.dispose(),this.qsb=null);for(const b of this.dLc)b.dispose();
this.P3d();super.dispose()}set eA(b){super.eA=b}}Aw.Oyh=4;Object(m.a)(Aw,"HeroDock",fv.a,[]);var px=c(615);class KA extends px.a{constructor(){super();this.Q$d=this.ijm=this.e5n=!1;this.THm=n.AFrameworkApplication.tsf?1:Aw.Oyh}}Object(m.a)(KA,"ToolbarBuildOptions",px.a,[]);var nj=c(52),LA=c(856),Au=c(711);class ky extends fv.a{constructor(b,k,r){super(b,k,"","");this.Fjc=r.Alignment;this.GDg=r.ScalingDirection===nj.a.Iqj}im(){this.Vsa();this.ZV(this.Lc);super.im()}ZV(b){for(let k of this.children){k.JB();
switch(this.Fjc){case nj.a.Dfe:mg.a.Qf(k.Lc,"cui-toolbar-button-left");break;case nj.a.h5a:mg.a.Qf(k.Lc,"cui-toolbar-button-center");break;case nj.a.HNb:mg.a.Qf(k.Lc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Fjc);}k.visible&&b.appendChild(k.Lc);k.ala()}}LN(b){if(!Object(Jb.a)(fg.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.Fjc){case nj.a.Dfe:return"cui-toolbar-buttondock alignleft";case nj.a.h5a:return"cui-toolbar-buttondock aligncenter";
case nj.a.HNb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Fjc);}}get eA(){return!0}get alignment(){return this.Fjc}r4b(){let b=0;if(this.alignment===nj.a.h5a)for(let k of this.children){const r=k;r.visible&&(b+=r.Lc.offsetWidth)}else b=this.Lc.offsetWidth;return b}sId(){let b=null;if(this.alignment===nj.a.h5a)for(let k of this.children){if(k.visible){b=Sys.UI.DomElement.getBounds(k.Lc);break}}else b=Sys.UI.DomElement.getBounds(this.Lc);return b?0===this.root.P_?
b.x:b.x+b.width:0}FFd(){let b=null;if(this.alignment===nj.a.h5a){if(0<this.children.count){const k=this.children.GFd(this.children.count-1);for(;k.W0a();){const r=k.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Lc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Lc);return b?0===this.root.P_?b.x+b.width:b.x:0}L7e(){for(let b of this.children){const k=b;if(!Object(Jb.a)(fg.a,k)||k.control.visible)k.visible=!0}}HEn(b){const k=this.children.toArray(),r=new Au.a;let y=this.GDg?0:k.length-
1;const R=this.children.count,aa=this.root.uQa;for(;this.r4b()>=b&&!(y>=R||0>y);){const ta=k[y];aa&&Object(Jb.a)(fg.a,ta)&&ta.control.visible&&(r.add(ta),ta.beh());y+=this.GDg?1:-1}for(let ta of r)ta.ePi(),ta.visible=!1}set eA(b){super.eA=b}}Object(m.a)(ky,"ButtonDock",fv.a,[]);class Us extends Dd.a{constructor(b,k,r,y,R,aa,ta=!1){super(b,k,aa);this.Rpa=this.jY=this.rja=null;this.Uze=!1;this.V_a=y;this.Q$d=R;this.nod=0;xf.c(k.Size)||(k.Size===nj.a.Beg||r.options.ijm?this.nod=0:k.Size===nj.a.utj&&
(this.nod=1));this.HZj=ta}get uQa(){return!0}Rf(b){super.Rf(b);Object(Jb.a)(ky,b)&&!this.Uze&&(b.alignment===nj.a.Dfe?(this.rja&&this.kZf(),this.rja=b):b.alignment===nj.a.h5a?(this.jY&&this.kZf(),this.jY=b):b.alignment===nj.a.HNb&&(this.Rpa&&this.kZf(),this.Rpa=b))}kZf(){this.Uze=!0;this.Rpa=this.jY=this.rja=null}wkb(b,k){b=this.THc(b);xf.c(b)||b.visible===k||(b.visible=k,this.refresh())}im(){super.im();this.TMi(!0)}TMi(b){const k=this.root.zxb;xf.c(this.Lc)&&this.XPk();this.Lc=mg.a.jPa(this.Lc);
this.eLc&&this.Lc.appendChild(this.eLc);for(let r of this.children)r.visible&&(r.JB(),this.Lc.appendChild(r.Lc),r.ala());this.jY&&b&&this.Y3k();k&&k.FX();this.dirty=!1}Y3k(){if(this.jY.visible&&this.jY.children.count&&(this.neh(0,0),this.y0k(this.rja,this.jY,this.Rpa))){let b=0,k=0;const r=this.rja?this.rja.r4b():0,y=this.Rpa?this.Rpa.r4b():0;if(0<y||0<r)y>r?(b=0,k=y-r):(b=r-y,k=0);this.neh(b,k)}}y0k(b,k,r){let y=!1;0===this.root.P_?(b&&(y=b.FFd()>k.sId()),!y&&r&&(y=k.FFd()>r.sId())):(b&&(y=b.FFd()<
k.sId()),!y&&r&&(y=k.FFd()<r.sId()));return y}neh(b,k){0===this.P_?(this.jY.Lc.style.marginLeft=b+"px",this.jY.Lc.style.marginRight=k+"px"):(this.jY.Lc.style.marginRight=b+"px",this.jY.Lc.style.marginLeft=k+"px")}XPk(){this.JB()}Nt(){this.oCh(()=>{qu.a.prototype.Nt.call(this)})}iM(b){b=this.THc(b);xf.c(b)||this.oCh(Object(u.a)(b,b.xl,"pollForStateAndUpdate"))}oCh(b){this.l$b=this.Z0a=!1;b();if(this.Z0a||this.l$b)this.HZj||this.refresh(),this.scale()}LN(b){if(!Object(Jb.a)(Aw,b)&&!Object(Jb.a)(ky,
b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Jb.a)(ky,b)&&b.alignment===nj.a.h5a)for(let k of this.children)if(k.alignment===nj.a.h5a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.nod?(b+="cui-toolbar-onerow ",n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.R6||(b+="UITextTranformUpperCase ")):1===this.nod&&(b+="cui-toolbar-singledock ");
return b+super.cssClass}get Lsa(){return"div"}get D7(){return 26}get Vcj(){return this.rN}set Vcj(b){this.rN=b}OJk(b){b=b[nj.a.Yv];return new ky(this.root,b.Id,b)}JB(){super.JB();this.Lc.setAttribute("role","toolbar");this.properties.Title&&this.Lc.setAttribute("title",this.properties.Title)}EFa(b){return this.root&&this.root.hcc(b)?!0:!1}lMn(){this.RPa()}scale(){super.scale();if(!mg.a.vr(this.properties.Scale)||this.Uze)return!1;xf.c(this.rja)||(this.rja.visible=!0,this.rja.L7e());xf.c(this.jY)||
(this.jY.visible=!0,this.jY.L7e());xf.c(this.Rpa)||(this.Rpa.visible=!0,this.Rpa.L7e());this.TMi(!1);const b=this.Lc.offsetWidth,k=xf.c(this.rja)?0:this.rja.r4b(),r=xf.c(this.jY)?0:this.jY.r4b(),y=xf.c(this.Rpa)?0:this.Rpa.r4b();y+r+k>=b&&(y+k>=b?(this.r6h(this.jY),y>=b?(this.r6h(this.rja),this.BWf(this.Rpa,b)):this.BWf(this.rja,b-y)):this.BWf(this.jY,b-y-k));this.Z0a=!1;this.im();return!1}r6h(b){b&&(b.visible=!1)}BWf(b,k){b&&b.HEn(k)}}Object(m.a)(Us,"Toolbar",Dd.a,[930]);class Mv extends Us{constructor(b,
k,r,y,R=!1){super(b,k,r,!1,!1,y,R);this.NPg=!0}get D7(){return 7}get cssClass(){return Mv.f5n+" "+super.cssClass}static get f5n(){let b="cui-statusbar";n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.R6||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(Mv,"StatusBar",Us,[]);var Xy=c(510);class qx extends Xy.a{constructor(){super();this.toolbar=null;this.LQd=!1}}Object(m.a)(qx,"ToolbarBuildContext",Xy.a,[]);class MA extends ma.Builder{constructor(b,k,r,y){super(b,k,Fj.Task.C$(r),
y);if(xf.c(k))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}n_f(b){this.root=b}get G6f(){return this.options}fpk(){const b=new qx,k=new LA.a;k.id="toolbar";k.JWc=1;k.handler=Object(u.a)(this,this.UYm,"onReturnToolbarData");k.data=b;this.Bsa.A5d(k)}UYm(b){this.n_f(this.hpk(b.cWc,b.nCc));this.toolbar.Vcj=this;this.toolbar.im();this.placeholder.appendChild(this.toolbar.Lc);mg.a.Qf(this.placeholder,"loaded");this.Xra.continueWith(()=>{this.Xra.result.IGb(this.toolbar)},
11)}hpk(b,k){var r=nj.a.Oea(b,nj.a.cuj);xf.c(r)&&(r=nj.a.Oea(b,nj.a.Btj),k.LQd=!0);if(xf.c(r))throw Error.create("No toolbar element was present in the data");b=new nj.a(r);r=n.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");k.LQd?this.n_f(new Mv(b.attributes[nj.a.id],b.attributes,this,this.p9,r)):this.n_f(new Us(b.attributes[nj.a.id],b.attributes,this,this.G6f.e5n,this.G6f.Q$d,this.p9,r));this.toolbar.bsa=this.options.bsa;this.toolbar.Dde=!0;this.toolbar.im();b=nj.a.Mv(nj.a.Oea(b.node,
nj.a.sqj));k=this.kmk(b,k);for(const y of k)this.toolbar.Rf(y);return this.toolbar}kmk(b,k){const r=[];for(let y=0;y<b.length;y++)this.bNa(b[y])||Array.add(r,this.Smk(b[y],k));return r}Smk(b,k){const r=nj.a.cJc(b);let y=null;r===nj.a.Zoj?y=this.tmk(b,k):r===nj.a.Xqj&&(y=this.qnk(b,k));return y}qnk(b,k){var r=new nj.a(b);r=new Aw(this.root,r.attributes[nj.a.id],b[nj.a.Yv]);r.m6h=this.G6f.THm;b=nj.a.Oea(b,nj.a.inb);b=nj.a.Mv(b);const y=[];for(let aa=0;aa<b.length;aa++){var R=b[aa];this.bNa(R)||(R=this.Lda(R,
k),Array.add(y,R))}r.dLc=y;return r}tmk(b,k){new nj.a(b);const r=this.toolbar.OJk(b);b=nj.a.Oea(b,nj.a.inb);b=nj.a.Mv(b);for(let y=0;y<b.length;y++){if(this.bNa(b[y]))continue;const R=this.gpk(b[y],k);r.Rf(R)}return r}gpk(b,k){var r=new nj.a(b);const y=r.name;r=r.attributes[nj.a.Jic];let R;R=k.LQd?"Small14":"Small";switch(y){case nj.a.button:return b=this.Lda(b,k),b.JP(xf.b(r)?R:r);case nj.a.eBa:return R=k.LQd?"Medium14":"Medium",b=this.Lda(b,k),b.JP(xf.b(r)?R:r);case nj.a.label:return b=this.Lda(b,
k),b.JP(xf.b(r)?R:r);case nj.a.separator:return b=this.Lda(b,k),b.JP("Small");case nj.a.toggleButton:return b=this.Lda(b,k),b.JP(xf.b(r)?R:r);default:throw Error.create("Invalid control type.");}}}Object(m.a)(MA,"ToolbarBuilder",ma.Builder,[]);var Yy=c(1423);class ly{constructor(b,k,r,y,R,aa){this.oib=()=>{this.toolbar.xl()};this.DH=b;b=new en.CuiHelper(Qk.a.Kab,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);y=new KA;y.kG={};aa=3!==aa.mode;y.kG.HeaderToolbarControlsRight=
aa;y.kG.HeaderToolbarButtonDockRight=aa;y.kG.HeaderToolbarButtonRemovePageNumbers=aa;R=new MA(y,this.DH,this,R);R.Bsa=new Yy.a(ly.tZl,b);R.fpk();this.Aja=R.toolbar;r.execute(ta=>{this.toolbar.vE=ta});this.toolbar.refresh();this.toolbar.xl();this.Dh=k;k.GVa(this.oib)}get toolbar(){return this.Aja}dispose(){this.Dh.ycc(this.oib);this.toolbar&&(this.toolbar.dispose(),this.Aja=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.lMn()}VYk(){this.toolbar.g2()}IGb(){}}ly.tZl="WordEditorHeaderToolbarData";
Object(m.a)(ly,"HeaderFooterToolbar",null,[129,625]);class NA{constructor(b,k,r,y,R){this.Dh=b;this.jme=k;this.Ic=r;this.p9=y;this.ga=R}create(b){return new ly(b,this.Dh,this.jme,this.Ic,this.p9,this.ga)}}Object(m.a)(NA,"Factory",null,[600]);class Sz{constructor(b,k){this.Yc=b;this.Jk=k}XOk(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.WOk(b)+"</Controls></MenuSection></Menu>"}nvl(b){const k=
this.Yc.Ck();k.set(b);k.Ab(8);k.kd(8);return k}WOk(b){if(!b)return"";let k="";b=this.nvl(b);this.Jk.rLa(b,r=>{const y=this.Jk.D2h(r);r=r.getValue(wc.a.Sga);k+=Rf.m(r.toString(),r.toString(),Jc.a.QXf.toString(),Jc.a.QOf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,y));return!0});return k}}Object(m.a)(Sz,"HeaderFooterToolbarGenerator",null,[598]);var OA=c(119);class Zy extends bv.a{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,r,y);this.Xr=()=>{this.D3c(this.zb)};
this.DH=b.container;this.sv=document.createElement("div");this.$A(this.sv);this.Gya=R;this.rHa=aa;this.Kn.execute(xb=>{xb.z7(this.Xr)});this.ME=ta;if(this.OH=Ya)this.DH.style.backgroundColor=this.ME.C3b()}dispose(){super.dispose();this.Kn.instance&&this.Kn.instance.Sjb(this.Xr)}get Kn(){return null!=this.vlg?this.vlg:this.vlg=Va.a.instance.$a("Common.IZoomManager")}kz(b){this.DH.classList.add("HeaderFooterViewElement");this.sv.classList.add("HeaderFooterViewContent");this.D3c(b.currentNode)}l8(b){this.sv.parentNode&&
this.sv.parentNode===this.DH||(this.DH.appendChild(this.sv),this.rHa.instance&&this.rHa.instance.r_f(this.Yb,this.DH));super.l8(b)}Emb(b){OA.a.Qd(()=>{OA.a.prototype.Emb.call(this,b);this.Uhj();this.rHa.instance&&this.rHa.instance.chj(this.Yb,this.sv.style.paddingLeft,this.sv.style.paddingTop)},"HFVE:UFO")}D3c(b){this.Kn.instance&&this.Kn.instance.m5c(this.sv);this.Uhj();b=this.Gya.V3b(b);this.sv.style.paddingLeft=b.b_b+"px";this.sv.style.width=b.mCc+"px";this.rHa.instance&&this.rHa.instance.chj(this.Yb,
this.sv.style.paddingLeft,this.sv.style.paddingTop)}Uhj(){if(this.Kn.instance){this.sv.style.paddingTop="";var b=Sl.a.MB(this.sv);b.paddingTop&&(b=Fd.a.gM(b.paddingTop),this.sv.style.paddingTop=Math.round(b/this.Kn.instance.vj)+"px")}}}Object(m.a)(Zy,"HeaderFooterViewElement",bv.a,[]);class PA{constructor(b,k,r,y){this.Gya=b;this.rHa=k;this.ME=r;this.OH=y}create(b,k,r,y){return new Zy(b,k,r,y,this.Gya,this.rHa,this.ME,this.OH)}}Object(m.a)(PA,"Factory",null,[597]);var Bw=c(370),BB=c(192),Tz=c(946),
CB=c(579);class my extends Bw.a{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff){super(k,aa,ta,Ya,xb,BB.a.umf,Mb,cc,jc,Mc,fd,Td,ne,ye,ff);this.isHeader=this.isHeader=b;this.oUa=R;this.oUa.Z1c=this;y(this);this.N8c=r;this.Pxa=document.createElement("div");this.Pxa.setAttribute("Unselectable","on");this.Pxa.setAttribute("hideselection","hideselection");this.Pxa.setAttribute("style","outline:none;");this.Pxa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.Pxa.tabIndex=0;this.features.i5i=!0;this.features.RVe=!0}get yrf(){return!0}Jjf(){const b=this.N8c.$af(this);return Tz.ViewReference.vF(this,b)}Z4e(b){Object(Jb.a)(my,b)||this.N8c.dismiss()}get Glf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}IJc(){return CB.a.$si}onResize(){super.onResize();this.oUa.RFh()}vB(b,k=null){this.Pxa.parentNode&&this.Pxa.parentNode.removeChild(this.Pxa);super.vB(b,k);this.oUa.EFh(this.ld.Ui)}detach(){this.oUa.QFh();super.detach();this.Pxa.parentNode||
this.container.insertBefore(this.Pxa,this.container.firstChild)}J_c(){this.Sr?super.J_c():this.Pxa.focus()}ODd(){this.onResize()}}Object(m.a)(my,"HeaderFooterView",Bw.a,[620,183,184,143,10,86,185,186,187]);class QA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne){this.N8c=b;this.t0j=k;this.s0j=r;this.xt=y;this.Zc=R;this.Cja=aa;this.ga=ta;this.XSa=Ya;this.jra=xb;this.q5=Mb;this.$0j=cc;this.Fr=jc;this.hA=Mc;this.Bf=fd;this.hh=Td;this.H8c=ne}create(b,k){return new my(b,k,this.N8c,this.t0j,this.s0j(),
this.xt,this.Zc,this.Cja,this.ga,this.XSa,this.jra,this.q5,this.$0j,this.Fr,this.hA,this.Bf,this.hh,this.H8c)}}Object(m.a)(QA,"Factory",null,[596]);class Eq{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff){this.aWg=!1;this.p2g="SourceControlId";this.iao=1;this.jao=1E3;this.Q1d=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;this.lbd(Yf[this.p2g]);Yf[eh.a.Text]=this.mCe.p3m(this.e9a.DCb);return 32};this.Ben=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;Yf[Ig.a.On]=this.e9a.DCb;return 32};this.u2l=(Gd,
oe,ze,ug,Yf)=>{if(1===ze)return 32;this.e9a.dmo(Yf[Ig.a.On]);return 32};this.zPi=(Gd,oe,ze)=>{if(1===ze)return 32;if(this.J8){oe=Eq.qh.pu(oe.view.ld);ze=Wd.GraphIterator.Za(oe);const ug=this.Jd.ZVa();try{const Yf=this.Hc.Rc(15);try{Yf.Eb(oe),Yf.Al=Gd,Al.a.instance.rLa(ze,Aj=>{this.ETb.RXc(Aj,this.oql,this.CNn);return!0})}finally{Yf&&Yf.dispose()}}finally{ug&&ug.dispose()}}return 32};this.mVc=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;Yf.MenuItems=this.tRj.value;this.aWg?this.e9a.Syn():this.aWg=!0;return 32};
this.l8l=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;const Aj=this.lbd(Yf[this.p2g]);if(this.J8){oe=Eq.qh.pu(oe.view.ld);ze=Wd.GraphIterator.Za(oe);ug=this.Hc.Rc(15);try{ug.Eb(oe);ug.Al=Gd;let cn=null;const Vl=this.me.jg("UserAction","InsertPageNumber");Al.a.instance.rLa(ze,st=>{this.J8.s$||this.cEj(st);cn=this.lCe.j8l(st,Aj,this.e9a.DCb)||cn;return!0});Vl.stop();if(!cn)return 8;this.UZn(cn,Aj)}finally{ug&&ug.dispose()}this.Jd.ys(12)}return 32};this.o3m=()=>32;this.y_n=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;
2===ze&&this.zIa.showCallout(Yf);return 32};this.x_n=(Gd,oe,ze,ug,Yf,Aj)=>this.JHe.create(Gd,oe,ze,ug,Yf,Aj);this.YYk=(Gd,oe,ze)=>{if(1===ze)return 32;this.zIa.EBh();return 32};this.RYn=Gd=>{n.AFrameworkApplication.ya.Ona(null,Jc.a.F6i,Gd.customData,null)};this.oql=Gd=>{const oe=bh.a.instance.ib.kb;let ze=-1;for(let ug of oe)if(ug.node===Gd){ze=ug.cpBegin;break}return{returnValue:ze,zPd:rf.SelectionEditor.Dm(oe)}};this.CNn=(Gd,oe)=>{Gd=Ke.SelectionFactory.xe(Gd,oe);bh.a.instance.setSelection(Gd)};
this.ga=b;this.Hc=k;this.Hb=r;this.e9a=y;this.J8=R;this.Ll=aa;this.mCe=ta;this.lCe=Ya;this.ETb=xb;this.zIa=Mb;this.hb=cc;this.JHe=jc;this.me=Mc;this.Jd=fd;this.lbd=Td;this.cEj=ff;this.tRj=new cg.a(()=>this.e9a.lEl())}Vb(){this.ga.gb(Jc.a.mVc,lc.a.view,this.mVc,100);this.ga.gb(Jc.a.gEi,lc.a.view,this.o3m,68);this.ga.gb(Jc.a.w$h,lc.a.view,this.l8l,4);this.ga.gb(Jc.a.DCb,lc.a.view,this.u2l,4);this.ga.gb(Jc.a.RXc,lc.a.view,this.zPi,4);this.ga.gb(Jc.a.Qsn,lc.a.view,this.zPi,4);this.ga.gb(Jc.a.pPf,lc.a.application,
this.Ben,97);this.ga.gb(Jc.a.Q1d,lc.a.application,this.Q1d,97);this.ga.gb(Jc.a.E6i,lc.a.view,this.y_n,4);this.ga.vS(Jc.a.F6i,lc.a.view,this.x_n,100);this.ga.gb(Jc.a.XYk,lc.a.view,this.YYk,4)}UZn(b,k){const r=b.Ob.paragraph;if(r){var y=this.Ll.GDf(r);y&&this.J8.uea(y)}y=this.J8.s$;this.J8.show(4>k);r&&this.QMn(r)&&(this.TQn(b,r),this.Y6j(b,y))}QMn(b){let k;if(!({isHeader:k,B5f:b}=this.Ll.e1h(b)).returnValue)return!1;this.J8.awa(b,k);return!0}TQn(b,k){b=Ke.SelectionFactory.xe(k,b.Ob.cp);this.hb.setSelection(b)}Y6j(b,
k){k=new nd.a(2,1,k?this.iao:this.jao,this.RYn);k.customData=b;this.Hb.fc(k)}static get qh(){return lk.PageNavigator.instance}}Object(m.a)(Eq,"PageNumbersActor",null,[624]);class RA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc){this.ga=b;this.Hb=k;this.e9a=r;this.mCe=y;this.lCe=R;this.ETb=aa;this.zIa=ta;this.JHe=Ya;this.Ll=xb;this.Jd=Mb;this.lbd=cc;this.D_j=jc;this.nda=Mc}create(b,k){return new Eq(this.ga,new Qn.a,this.Hb,this.e9a,b,this.Ll,this.mCe,this.lCe,this.ETb,this.zIa,bh.a.instance,this.JHe,
Ka.App.xa.lq,this.Jd,this.lbd,this.D_j,this.nda,k)}}Object(m.a)(RA,"Factory",null,[595]);var Cw=c(1823),rx;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(rx||(rx={}));Object(m.b)("ModalCalloutSize",rx);var sx;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(sx||
(sx={}));Object(m.b)("BeakLocation",sx);class tx{constructor(b,k,r){this.hao=1;this.JEe=!1;this.WUb=null;this.Cnn=()=>{this.hb.tB(this.Pna);this.JEe=!0;this.WUb=null};this.Pna=(y,R)=>{if(y=R.kl.kb)1<y.length||!y.length?y=!0:(y=y.Qa,y=y.cpEnd-y.cpBegin,y=1<y||!y),y&&this.fDj()};this.Hb=b;this.hb=k;this.fDj=r}ez(){this.X6j()}j8(){this.JEe?(this.hb.Iga(this.Pna),this.JEe=!1):this.WUb&&(this.Hb.Ye(this.WUb),this.WUb=null)}X6j(){this.WUb=new nd.a(2,1,this.hao,this.Cnn);this.Hb.fc(this.WUb)}}Object(m.a)(tx,
"CalloutDismissManager",null,[]);class gv{constructor(b,k,r,y){this.dismiss=()=>{this.iH&&(this.Cmc.j8(),this.lSc.dismiss())};this.lSc=b;this.Ep=y;this.Cmc=new tx(k,r,this.dismiss)}get iH(){return this.lSc.iH}show(){if(!this.iH){const b=document.createElement("div");b.classList.add(gv.n3m);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.lSc.content=b;this.lSc.show();this.Ep&&this.Ep.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Cmc.ez()}}dispose(){this.dismiss();
this.lSc.dispose()}static ZMk(b,k){k=Cw.a.Ivh(Qe.a.getElementBounds(b.targetElement),k,Ka.App.xa.nC,rx.small);k.Hda=gv.rcf(b);k.It=!1;return k}static rcf(b){let k=sx.bottomCenter;Object(Jb.a)(620,b.view)&&b.view.isHeader&&(k=sx.topCenter);return k}}gv.n3m="PageNumbersCalloutControl";Object(m.a)(gv,"PageNumbersCallOutControl",null,[619]);class $y{constructor(b,k,r){this.$R=null;this.TR=!1;this.dismiss=()=>{this.iH&&this.$R&&Sk.UISurfaces.hK().then(y=>{this.Cmc.j8();y.removeNotification(this.$R);this.TR=
!1;return null},y=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",y);return null})};this.Rl=b;this.Cmc=new tx(k,r,this.dismiss)}get iH(){return this.TR}show(){this.iH||Sk.UISurfaces.hK().then(b=>{const k=b.callout(Object.assign(new Vq.a,{target:this.Rl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new U.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.TR=!0},expirationOptions:Object.assign(new la.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.$R=b.addNotification(k,r);this.Cmc.ez();return null},b=>{v.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)($y,"ReactPageNumbersCallOutControl",null,[619]);class SA{constructor(b,k,r){this.hb=k;this.Hb=b;this.Ep=r}create(b,k){if(n.AFrameworkApplication.ta.Rb&&n.AFrameworkApplication.ta.Rb.gNa)return new $y(k.targetElement,this.Hb,this.hb);b=gv.ZMk(k,b);return new gv(b,this.Hb,this.hb,this.Ep,n.AFrameworkApplication.ta.xM)}}
Object(m.a)(SA,"Factory",null,[594]);class DB{constructor(b,k){this.JD=null;this.sRj=b;this.Ti=k}get control(){return this.JD}showCallout(b){this.control&&this.control.iH&&this.control.dismiss();this.JD=this.j$m(b);this.control.show()}EBh(){this.control&&(this.control.dismiss(),this.JD=null)}j$m(b){const k=this.Ti.yla();this.JD=this.sRj.value.create(k,b);return this.control}}Object(m.a)(DB,"PageNumbersCalloutControlManager",null,[593]);var Nv=c(759);class az extends kq.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(az,"PageNumberGalleryButtonProps",kq.a,[]);const pt=(b,k,r)=>{b=b.Ck();b.set(r);k.fGb(b);return b};class Bu{constructor(b,k,r){this.lte=!1;this.nda=k;this.Nl=r}get DCb(){return this.lte}lEl(){const b=Object.assign(new Ci.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.E4j());b.MenuSectionList.push(this.q5j());b.MenuSectionList.push(this.S5j());return b}dmo(b){this.lte=b;this.QMi()}Syn(){this.lte=!1;const b={};b[Bu.B8h]="CheckboxModel";
this.nda(b);this.QMi()}E4j(){const b=Object.assign(new oi.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:A.a.Ff(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),k=Object.assign(new Nv.a,{Id:Bu.v2l,Command:Jc.a.DCb.toString(),QueryCommand:Jc.a.pPf.toString(),LabelText:A.a.Ff(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:A.a.Ff(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(k);return b}q5j(){const b=Object.assign(new oi.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),k=Object.assign(new $r.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Nl){for(var r=3;1<=r;r--)k.GalleryItems.push(this.Ref(r));for(r=6;4<=r;r--)k.GalleryItems.push(this.Ref(r))}else for(r=
1;6>=r;r++)k.GalleryItems.push(this.Ref(r));b.ControlList.push(k);return b}S5j(){const b=Object.assign(new oi.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),k=Object.assign(new Wg.a,{Id:"btnRemovePageNumber",Command:Jc.a.RXc.toString(),LabelText:A.a.Ff(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:A.a.Ff(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:n.AFrameworkApplication.pr,Image16by16Class:ci.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(k);return b}Ref(b){const k=Bu.vKf+b.toString();var r=Object,y=r.assign,R=new az,aa=Jc.a.w$h.toString(),ta=Jc.a.Q1d.toString(),Ya=A.a,xb=Ya.Ff;let Mb="";switch(b){case 1:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return y.call(r,R,{Id:k,Command:aa,QueryCommand:ta,Alt:xb.call(Ya,Mb)})}QMi(){const b={};for(let k=1;6>=k;k++)b[Bu.vKf+k.toString()]="PageNumberGalleryButtonModel";b[Bu.B8h]="CheckboxModel";this.nda(b)}static mEl(b){return b?parseInt(b.substr(Bu.vKf.length)):1}}Bu.v2l="btnIncludePageCount";Bu.B8h="IncludePageCount";Bu.vKf="btnPageNumbersPosition";
Object(m.a)(Bu,"PageNumbersControl",null,[592]);class Mt{constructor(b,k,r,y,R=null,aa=null,ta=null,Ya=null){this.Ovl=(xb,Mb)=>{const cc=new Ge.a;xb=4>xb;switch(Mb){case 1:case 2:cc.add(xb?0:3);break;case 3:case 4:cc.add(xb?0:3),cc.add(xb?1:4)}return cc};this.Uol=(xb,Mb,cc)=>{var jc=pt(this.Yc,this.Ll,xb);this.Ll.gGb(jc,cc);let Mc=this.BBj(jc,Mb);if(Mc)this.ETb.aQi(Mc);else{jc=pt(this.Yc,this.Ll,xb);this.Ll.gGb(jc,cc);jc.Ud();if(Ag.OutlineElementReader.Nh(jc)&&(xg.OutlineElementNavigator.Fe(jc),ie.ParagraphReader.yh(jc))){jc=
jc.currentNode;const fd=this.j1h(Mb);ie.ParagraphReader.Lv(jc)===fd&&this.ETb.aQi(jc)&&(Mc=jc)}Mc||(jc=pt(this.Yc,this.Ll,xb),this.Ll.gGb(jc,cc),this.xK.Gfb(jc,null,!0),Mc=xg.OutlineElementNavigator.Fe(jc),this.tD(Mb,Mc))}return Mc};this.Vol=(xb,Mb)=>{let cc=null;xb.Pb(1);if(Ag.OutlineElementReader.Nh(xb)&&(xb.Pb(2),Si.TableReader.isTable(xb))){var jc=xb.currentNode;if(3===Si.TableReader.Yg(jc)){let Mc=0;jc=Si.TableReader.fm(jc);switch(Mb){case 1:case 4:Mc=jc?2:0;break;case 2:case 5:Mc=1;break;case 3:case 6:Mc=
jc?0:2}bf.moveToCellContent(xb,0,Mc);xb.currentNode&&Ag.OutlineElementReader.Nh(xb)&&(xb=xg.OutlineElementNavigator.Fe(xb),ie.ParagraphReader.nc(xb)&&(cc=xb))}}return cc};this.bgm=(xb,Mb)=>{const cc=pt(this.Yc,this.Ll,xb);xb=cc.currentNode.ia(wc.a.Sga,0);this.Ll.gGb(cc,Mb);Mb=cc.currentNode.ia(wc.a.Sga,0);return xb===Mb};this.Yc=b;this.uRj=k;this.ETb=r;this.Ll=y;this.Eoc=R||this.Ovl;this.CBj=aa||this.Uol;this.BBj=ta||this.Vol;this.AKj=Ya||this.bgm}get xK(){return null!=this.vpg?this.vpg:this.vpg=
Va.a.instance.resolve("Box4.IOutlineEditor")}j8l(b,k,r){var y=pt(this.Yc,this.Ll,b).Gn;y=this.Ll.Rla(y);y=this.Eoc(k,y);let R=null;for(let ta=0;ta<y.length;ta++){var aa=y.mg(ta);this.AKj(b,aa)&&(aa=this.CBj(b,k,aa),R=this.uRj.p5j(aa,r)||R)}return R}tD(b,k){Mt.a8.J7d(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,k);Mt.paragraphEditor.tD(k,this.j1h(b))}j1h(b){let k=1;switch(b){case 1:case 4:k=1;break;case 2:case 5:k=2;break;case 3:case 6:k=3}return k}static get paragraphEditor(){return null!=
Mt.qqg?Mt.qqg:Mt.qqg=Va.a.instance.resolve("Box4.IParagraphEditor")}static get a8(){return null!=Mt.Jrg?Mt.Jrg:Mt.Jrg=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(Mt,"PageNumbersInserter",null,[591]);var ri=c(867),ny=c(875);class Nt{constructor(b,k,r=null,y=null,R=null){this.mJk=(aa,ta)=>{aa=Re.a.Uc(aa,ie.ParagraphReader.textLength(aa));const Ya=aa.node.Mc;return Ya?Nt.characterPropertiesEditor.ifa(aa,xb=>{xb=ny.a.getInstance(xb);this.uxd(xb,15,Ya,ta);this.uxd(xb,47,Ya,ta);this.uxd(xb,
16,Ya);this.uxd(xb,17,Ya);return xb}):null};this.L8l=(aa,ta)=>{aa=Re.a.Uc(aa,ie.ParagraphReader.textLength(aa));Nt.characterPropertiesEditor.replaceTextRange(aa,ta)};this.Hc=b;this.Xhd=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.dme=y||this.mJk;this.$3g=R||this.L8l}p5j(b,k){const r=this.Hc.Rc(15);r.Eb(b);var y=ie.ParagraphReader.text(b),R=!1;0<y.length&&" "!==y.charAt(y.length-1)&&(R=!0);if(k){k=String.format(this.Xhd,"#","$");R&&(k=" "+k);R=k.indexOf("#");y=k.indexOf("$");
v.ULS.shipAssertTag(4256717,309,-1!==R,"{0}",{["PageNumberIndex"]:R});v.ULS.shipAssertTag(4256718,309,-1!==y,"{0}",{["PageCountIndex"]:y});v.ULS.shipAssertTag(4256719,309,R!==y,"{0}",{["PageNumberIndex"]:R,["PageCountIndex"]:y});let Ya;let xb;if(R<y){var aa=R;Ya=y;var ta=ri.a.lIc(0);xb=ri.a.lIc(1)}else aa=y,Ya=R,ta=ri.a.lIc(1),xb=ri.a.lIc(0);this.Oof(b,k,0,aa);ta=this.dme(b,ta);this.Oof(b,k,aa+1,Ya);aa=this.dme(b,xb);this.Oof(b,k,Ya+1,k.length);b=R<y?ta:aa}else R&&this.$3g(b," "),b=this.dme(b,ri.a.lIc(0));
r.dispose();return b}uxd(b,k,r,y=null){const R=new Sy.a;R.setValue(Te.a.e8,!0);R.setValue(wc.a.Dzb,1);R.setValue(wc.a.Gq,k);switch(k){case 15:R.setValue(wc.a.lNa,!0);R.setValue(wc.a.fieldInstruction,y);break;case 47:R.setValue(wc.a.fieldInstruction,y);break;case 17:R.setValue(wc.a.oEb,!0)}k=r.Lu(R,G.a.create());this.n6j(b,k)}n6j(b,k){b.Era(k,G.a.nil,xn.AParagraphNode.IB,null)}Oof(b,k,r,y){k=k.substring(r,y);0<k.length&&this.$3g(b,k)}static get characterPropertiesEditor(){return Nt.Yd||(Nt.Yd=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Nt.Yd=
b}}Nt.Yd=null;Object(m.a)(Nt,"PageNumbersNodeLevelInserter",null,[590]);class qt{p3m(b){return qt.AGl(b)}static AGl(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,qt.QDi,qt.QDi)}}qt.QDi="1";Object(m.a)(qt,"PageNumbersPositionPreviewGenerator",null,[589]);class Jp{constructor(){this.fAg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.aBj=this.fAg.length}JYl(b){let k=b.characterData.lastIndexOf("\ufffc");return-1!==k&&k+1===ie.ParagraphReader.textLength(b)?{returnValue:!0,pVc:k}:{returnValue:!1,pVc:-1}}wXl(b){let k=b.characterData.lastIndexOf(this.fAg);return-1!==k&&k+this.aBj===ie.ParagraphReader.textLength(b)?{returnValue:!0,pVc:k}:{returnValue:!1,pVc:-1}}oYl(b){return Qm.a(b,9)?!0:!1}}Object(m.a)(Jp,"PageNumbersReader",null,[588]);class bz{constructor(b,k,r,y,R,aa=null,ta=null){this.Psn=(Ya,xb,Mb,cc)=>{Ya=pt(this.Yc,this.Ll,
Ya);this.Ll.gGb(Ya,xb);xb=Xj.a.$p(Ya);for(Ya=!1;xb.moveNext();){const jc=xb.currentNode;if(ie.ParagraphReader.nc(xb.currentNode)&&Qm.a(xb.currentNode,9)){Ya=!0;let Mc;const fd=({zPd:Mc}=Mb(jc,Mc)).returnValue;let Td=fd;Td=this.urn(jc,Td);Td=this.itn(jc,Td);-1<fd&&(Td===fd&&Mc||cc(jc,Td))}}Ya&&this.Jd.ys(12)};this.Yc=b;this.Ll=k;this.nCe=r;this.Jd=y;this.Fuc=R;this.Eoc=aa||Iv.a.f4e;this.HTj=ta||this.Psn;this.Xhd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.JGg=String.format(this.Xhd,
"#","$");this.UIj=this.JGg.indexOf("#");this.TIj=this.JGg.indexOf("$");this.Bqe=String.format(this.Xhd,"\ufffc","\ufffc");this.CGg=this.Bqe.length}RXc(b,k,r){var y=pt(this.Yc,this.Ll,b).Gn;y=this.Ll.Rla(y);y=this.Eoc(y);for(let R of y)this.HTj(b,R,k,r)}aQi(b){if(this.nCe.oYl(b)){let k=-1;if(({pVc:k}=this.nCe.wXl(b)).returnValue&&this.Smh(b,k)||({pVc:k}=this.nCe.JYl(b)).returnValue&&this.Suk(b,k))return!0}return!1}itn(b,k){var r=b.qa.length;for(let R=0;R<r;R++){var y=b.qa.J(R);y.blob&&9===y.blob.li&&
(y=y.cp,r=Re.a.createTextRange(b,y,y+1),this.Fuc(r,""),r=b.qa.length,R--,k=this.Jbh(k,y,1))}return k}urn(b,k){let r=b.characterData.indexOf(this.Bqe);for(;-1!==r;)this.Smh(b,r)&&(k=this.Jbh(k,r,this.CGg)),r=b.characterData.indexOf(this.Bqe);return k}Suk(b,k){const r=b.qa.ii(k);return r&&r.blob&&9===r.blob.li?(b=Re.a.createTextRange(b,k,k+1),this.Fuc(b,""),!0):!1}Smh(b,k){const r=b.qa.ii(k+this.UIj),y=b.qa.ii(k+this.TIj);return r&&r.blob&&9===r.blob.li&&y&&y.blob&&9===y.blob.li?(b=Re.a.createTextRange(b,
k,k+this.CGg),this.Fuc(b,""),!0):!1}Jbh(b,k,r){-1<b&&b>k&&(k=b-k,b=k>r?b-r:b-k);return b}}Object(m.a)(bz,"PageNumbersRemover",null,[587]);class ux{constructor(b,k){this.Jnb=this.Inb=null;this.Yq=b;this.Hb=k}bck(){this.Yq.style.display="";this.Inb||(this.Jnb&&(this.Hb.Ye(this.Jnb),this.Jnb=null),this.Inb=new nd.a(0,1,10,()=>{this.Yq.classList.add("Displayed");this.Inb=null}),this.Hb.fc(this.Inb))}dck(){this.Yq.classList.remove("Displayed");this.Jnb||(this.Inb&&(this.Hb.Ye(this.Inb),this.Inb=null),
this.Jnb=new nd.a(0,1,200,()=>{this.Yq.style.display="none";this.Jnb=null}),this.Hb.fc(this.Jnb))}}Object(m.a)(ux,"PaneControlAnimationHelper",null,[618]);class vx{constructor(b){this.Hb=b}rEl(b){return new ux(b,this.Hb)}}Object(m.a)(vx,"PaneControlAnimationHelperFactory",null,[586]);class TA{constructor(b,k,r,y,R,aa,ta,Ya,xb=!1){this.fvg=this.Aja=this.Hbd=null;this.mZl=()=>{this.lw.sendNotification(this.fvg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.A4=k;this.A4.bind(this);this.Fue=r;this.dja=R;this.NKe=ta;this.Ub=Ya;this.hdd=xb;this.xca=aa.value.create(r,y);this.A4.Qjk(this.xca);this.wY=bc.KeyInputManager.lc(tb.a.h0,0)}get lw(){return null!=this.phg?this.phg:this.phg=Va.a.instance.resolve("Common.Utils.IAriaNotifier")}y_(b){this.A4.y_(b);this.Aja&&!b&&this.Aja.VYk()}uea(b){this.Hbd!==b&&(this.ecb(),this.Hbd=b)}eZi(b){if(this.Hbd){var k=this.dja.Zdb(this.Hbd,Iv.a.Nvl(b,this.Fue));this.hdd?(this.fvg=this.UMh(b,this.Fue),this.xca.dKb(Ef.a.osd)):
this.Rio(b);k&&this.ISe(k)}}Pfh(b){this.hdd&&this.Ub&&(b=this.Ub.re(b))&&b.vda(this.mZl)}UMh(b,k){let r="";switch(b){case 1:r=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?k?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:k?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}Rio(b){this.xca.p_i(this.UMh(b,this.Fue),Ef.a.osd)}setInitialSelection(){this.xca.J_c()}ISe(b){this.ecb();this.xca.vB(b,b.Ui)}ecb(){this.xca.detach()}WPk(){this.Aja=
this.NKe.value.create(this.A4.Pgc);this.KTn(this.Aja)}KTn(b){if(this.Ub){const k=this.Ub.re(ys.a.BZa);k.parent=id.AFrame.Qp;k.wda(()=>{b.setFocus();this.ZRn()});k.bindAction(this.wY,Jc.a.WS)}}ZRn(){if(this.Ub){var b=this.Ub.re(ys.a.BZa);const k=new Gg.DOMFocusListing(()=>this.A4.Pgc);k.fEa=!0;k.Rn(1);this.Ub.qtd(this.A4.Pgc,b,k);b=this.Ub.getRegion(ys.a.BZa);b.fPa();b.$T=!0;k.Cea&&k.qy(k.Cea)}}dispose(){void 0!==this.Aja&&null!==this.Aja&&(this.Ub.re(ys.a.BZa).Er(this.wY),this.Aja.dispose())}imn(){void 0!==
this.Aja&&null!==this.Aja&&this.Aja.refresh()}}Object(m.a)(TA,"PaneControl",null,[617]);class UA{constructor(b,k,r,y){this.Ll=b;this.JHj=k;this.NKe=r;this.Ub=y}create(b,k,r,y){return new TA(b,k,r,y,this.Ll,this.JHj,this.NKe,this.Ub,n.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(UA,"Factory",null,[585]);var Uz=c(1076);class Vz extends kl.a{constructor(b,k,r,y,R,aa,ta,Ya,xb){super();this.init(b);this.ll("ShowCalloutForPageNumberOperation");this.pwj=Ya;
this.Bfb(this.pwj,k,y,R,aa);this.wz=0;this.mtc=aa;this.zIa=ta;this.Dh=xb;1===this.behavior&&(this.dr=32,this.ooa())}run(){var b=this.Dh.jb.zv;!this.wz&&this.mtc.cLd(b)&&this.mtc.XYa(b).element&&(this.wz=1);if(1===this.wz){const k=this.mtc.XYa(b);b=new Uz.a(k.element,b);this.zIa.showCallout(b);this.wz=2}2===this.wz&&(this.dr=32,this.ooa())}}Object(m.a)(Vz,"ShowCalloutForPageNumberOperation",kl.a,[]);class VA{constructor(b,k,r){this.zIa=b;this.ga=k;this.ZNb=r}create(b,k,r,y,R,aa){return new Vz(b,k,
r,y,R,aa,this.zIa,this.ga,this.ZNb)}}Object(m.a)(VA,"Factory",null,[468]);class oy{get xK(){return null!=this.tpg?this.tpg:this.tpg=Va.a.instance.resolve("Box4.IOutlineEditor")}zc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new IA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ze("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),
b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new QA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),oC.a.hZe,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Ka.App.xa.jb,Bb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),n.AFrameworkApplication.ya,b.resolve("Box4.IInteractiveEventNotifier"),b.$a("Box4.ITextMetricsAdapter"),
b.resolve("Box4.IRotatingCoordinateConverter"),b.$a("Common.IZoomManager"),b.Pa("Box4.IContentControlViewElementManager"),b.Pa("Box4.CpConversionManagerImpl"),b.Pa("Box4.ContentControlConfigSettings"),b.Pa("Box4.IContentControlReader"),b.Pa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new PA(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.$a("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),
b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ka.App.instance&&Ka.App.instance.XB)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new NA(jl.App.En,b.$a("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),jl.App.En,n.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",()=>new UA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.Ze("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ze("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),Id.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new HA(()=>{Ka.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),n.AFrameworkApplication.ya,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new RA(n.AFrameworkApplication.ya,Mg.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Bu.mEl,Object(u.a)(Ka.App.xa,Ka.App.xa.V3c,"updateRibbonControl"),Object(u.a)(Ka.App.xa,Ka.App.xa.nG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new nx).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new vx(Mg.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",
()=>new pC(Id.FocusManager.instance(),Ka.App.xa.ov,b.Ze("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ze("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ze("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),n.AFrameworkApplication.ya,new cg.a(()=>Ka.App.xa.jb.Fc),n.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",
()=>new Lv(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),De.PageReader.instance,new Io.a,Al.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Sz(new Io.a,Al.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Lt(n.AFrameworkApplication.ya,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Al.a.instance,new Io.a,
new Qn.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Lt.C2h,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new fm(iy.a.instance,fm.YMl(b.resolve("Box4.ITableEditor")),fm.zml(),n.AFrameworkApplication.isRtl,xg.OutlineElementNavigator.Xd,fm.aLl(),fm.Cvl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new jy(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
new Io.a,k=>this.xK.Gfb(k),n.AFrameworkApplication.isRtl,Object(u.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").qKb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new JA(Al.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new GA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Io.a,new Qn.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new mx(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Al.a.instance,new Io.a,n.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Bu(Object(u.a)(Ka.App.xa,Ka.App.xa.V3c,"updateRibbonControl"),Object(u.a)(Ka.App.xa,Ka.App.xa.nG,"updateRibbonControls"),n.AFrameworkApplication.isRtl)).singleInstance();b.register(qt,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Nt(new Qn.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new Mt(new Io.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new Jp).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new bz(new Io.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(u.a)(oy.characterPropertiesEditor,oy.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new DB(b.Ze("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Ka.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new SA(Mg.a.instance,bh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new VA(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),n.AFrameworkApplication.ya,Ka.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new lx(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),n.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Wy(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=oy.Thg?oy.Thg:oy.Thg=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(oy,"HeaderFooterComponentConfiguration",null,[2]);class Vs{constructor(){this.Jbd=
this.W=null}get name(){return"WordEditor.HeaderFooter"}zc(b){this.W=b;(new oy).zc(b)}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(119)&&(this.Jbd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Jbd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Jbd&&this.Jbd.dispose()}static main(){M.a.instance.Pc(new Vs)}}Object(m.a)(Vs,"PackageManager",null,[1,
2]);var Wz=c(384),rC=c(806);class WA{constructor(b,k){this.Bf=b;this.qm=k}create(){return new rC.a(this.Bf.instance,this.qm.instance)}}Object(m.a)(WA,"ContentControlNodeFactory",null,[417]);var fu=c(1617),py=c(1024);class Xz{create(){return new py.a}}Object(m.a)(Xz,"ContentControlContainerNodeFactory",null,[417]);class EB{constructor(b,k,r,y,R){this.nsa=b;this.nsh=k;this.Gwd=r;this.$I=y;this.Oj=R;this.HFk=new Xz;this.GRm=(aa,ta)=>{this.$I.Qd(()=>{if(ta){ta.yo.selectedContentControls||(ta.yo.selectedContentControls=
{});var Ya=ta.yo.selectedContentControls,xb=ta.MPa;if(xb&&xb.length){var Mb=xb[0];xb=xb[xb.length-1];Mb=this.nsa.edf(Re.a.Uc(Mb.node,Mb.gl),Re.a.Uc(xb.node,xb.zt),!1);for(let cc of Mb)Ya[cc.contentControlNode.id.toString()]=!0}}},"CC:OnBeforeCopy")};this.OTc=(aa,ta)=>{this.$I.Qd(()=>{if(ta){var Ya=ta.clone,xb=ta.original;try{const Mb=ta.yo.selectedContentControls,cc=this.nsa.ocf(xb,0,xb.characterData.length,!0,!0,!1);for(let jc of cc){const Mc=jc.pe.toString();Mb[Mc]?jc.Cq&&!this.THk(jc.contentControlNode,
Ya,Mb)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Mc)),this.xSf(Ya,jc.pe)):this.xSf(Ya,jc.pe)}}catch(Mb){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Mb.toString()),this.nsh.Uqn(Ya)}}},"CC:onParagraphCopy")};this.QTc=(aa,ta)=>{this.$I.Qd(()=>{if(ta){var Ya=ta.clone,xb=ta.original;try{const Mb=this.nsa.ocf(Ya,0,xb.characterData.length);ta.yo.ccObjectIdMapping||(ta.yo.ccObjectIdMapping={});const cc=
ta.yo.ccObjectIdMapping;for(let jc=0;jc<Mb.count;jc++){const Mc=Mb.J(jc),fd=Mc.pe.toString();if(this.dlm(Mc))if(Mc.Oc){const Td=xb.Di().Ad.Db(fd),ne=this.EFl(Mc),ye=this.xzk(Td,ne.LEi,ne.W9h,Ya.Di().Ad);cc[fd]=ye.id;this.Gwd.Thj(cc[fd],Ya.id,G.a.nil);this.Oj.D9b(ye)}else this.Gwd.Thj(cc[fd],null,Ya.id);cc[fd]?(Mc.pe=cc[fd],Mc.Us=null):this.xSf(Ya,Mc.pe)}}catch(Mb){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Mb.toString())}}},"CC:onParagraphPaste")}}init(){Ps.a.$7j(this.GRm);
Ps.a.nrd(this.OTc);Ps.a.zyc(this.QTc)}snl(b){if(!b.Ab(25)||!b.kd(25))return null;if(!b.fq(25)){const k=this.HFk.create(1074135144);b.Rf(k,25)}return b.Pb(25)}THk(b,k,r){var y=b.ia(wc.a.U5,null);const R=Wd.GraphIterator.Za(k);k=k.Di().Ad;r=y&&r[y.toString()]?k.Db(y):this.snl(R);if(!r)return v.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;y=Vo.a(b,k,!0);Wd.GraphIterator.Za(r).A1(y,26,b.id);54!==r.type&&y.setValue(wc.a.U5,
r.id);return y}xSf(b,k){this.nsh.lUk(new rb.a([b]),k)}dlm(b){var k=b.Ob.paragraph.Mc;if(!k)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.pe.toString())),!1;k=k.Db(b.Us);if(!k)return v.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.pe.toString())),!1;b=k.getValue(wc.a.Gq);return 38===b||39==b}Vll(b,k){var r,y=b.qa.J(b.qa.length-1);let R=
b.characterData.length;y=(null===(r=null===y||void 0===y?void 0:y.Jb)||void 0===r?void 0:r.length)||0;b.id.equals(k.Ob.paragraph.id)&&(R=k.Ob.cp,y=k.Ob.Jb.zI(k.pe,k.Oc));return this.nsa.tOh(b,0,R,0,y)}EFl(b){let k=null,r=b.Ob.paragraph;const y={};for(;r;){const R=this.Vll(r,b);for(let aa=R.count-1;0<=aa;aa--){const ta=R.J(aa);if(!ta.Cq)continue;const Ya=ta.pe.toString();if(ta.Oc){if(!y[Ya])return{LEi:ta.contentControlNode,W9h:k}}else y[Ya]=!0,k||(k=ta.contentControlNode)}r=ie.ParagraphReader.eh(r,
!0,!0)}return{LEi:null,W9h:k}}xzk(b,k,r,y){let R;k?R=this.Gwd.pta(k):(R=this.Gwd.qta(),k=R.currentNode);b=Vo.a(b,y,!0);b.lh(wc.a.My,Gc.a.ZF());54!==k.type&&b.setValue(wc.a.U5,k.id);R.eH(b,r,26);return b}}Object(m.a)(EB,"ContentControlCCP",null,[]);var Dw=c(193),sC=c(718);class FB{constructor(b,k,r,y){this.Yd=b;this.Bf=k;this.fb=r;this.sg=y}get VW(){return!!this.Bf.instance&&this.Bf.instance.VW}get qDb(){return!!this.Bf.instance&&this.Bf.instance.qDb}Cra(b,k,r,y,R,aa=Dw.a.yyb,ta=Dw.a.b0b,Ya=null,xb=
Dw.a.Z2e,Mb=-1){(b=this.jHd(b,r))?(b.Jb||(b.Jb=new Wz.a(b)),this.u3j(k,b.Jb,y,R,aa,ta,Ya,xb,Mb)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}Gzh(b,k,r){if(b){new rb.a;for(let R=0;R<b.count;R++){var y=this.$cf(b.J(R),k,!1);for(let aa of y)this.wrn(aa,r)}}}kUk(b,k){this.Gzh(b,k,!0)}lUk(b,k){this.Gzh(b,k,!1)}replaceTextRange(b,k){this.Yd.replaceTextRange(b,k)}jHd(b,k){var r=Re.a.Uc(b,k);this.Yd.lLb(r);for(r=0;r<b.qa.length;r++){const y=b.qa.J(r);
if(y.cp>k)break;if(y.cp===k)return y}return null}u3j(b,k,r,y,R=Dw.a.yyb,aa=Dw.a.b0b,ta=null,Ya=Dw.a.Z2e,xb=-1){const Mb=k.Ob.paragraph;b=new sC.a(k.Ob,!0,!0,!0,null,b,y,r,R,aa,ta,Ya,null,this.sg);if(!this.VW||-1>=xb||xb>k.length)xb=k.length;k.insert(b,xb);Mb.yn();gh.a.instance.J(6)&&(b.Ge?Mb.wordRunProperties.IZ(b.Ge-1,512):Mb.wordRunProperties.Tta(b.Ge,512),Mb.wordRunProperties.Iq.Z(b.Ge,er.CharacterPropertiesEditor.GQ),Mb.wordRunProperties.gt.Z(b.Ge,er.CharacterPropertiesEditor.cU))}$cf(b,k,r){const y=
new rb.a;for(let R=0;R<b.qa.length;R++){const aa=b.qa.J(R);if(aa.Jb)for(let ta=0;ta<aa.Jb.length;ta++)if(aa.Jb.J(ta).pe.equals(k)&&(y.add(aa.Jb.J(ta)),r))return y}return y}A3c(b,k,r){if(this.qDb&&b){var y=b.node,R=b.gl,aa=b.zt,ta=this.VPh(y,R,k,!0);k=this.VPh(y,aa,k,!1);r?-1!==ta&&ta++:-1!==k&&k++;R||-1===ta||(ta=Math.max(ta,this.fb.dv(y)));aa===this.fb.textLength(y)&&-1!==k&&(k=Math.min(k,this.fb.Fu(y)));b.Fb=ta;b.Tb=k}}VPh(b,k,r,y){return(b=(b=b.qa.ii(k))?b.Jb:null)&&b.length?b.zI(r,y):-1}wrn(b,
k){b&&b.Ob.Jb&&(k?b.Ob.Jb.remove(b):b.Ob.Jb.Yna(b),k=b.Ob.paragraph,0<=b.Ge&&b.Ge<k.wordRunProperties.length&&(b.Ob.cp||1!==k.wordRunProperties.length||(k.wordRunProperties.IZ(0,512),k.wordRunProperties.Iq.Z(1,er.CharacterPropertiesEditor.GQ),k.wordRunProperties.gt.Z(1,er.CharacterPropertiesEditor.cU)),k.wordRunProperties.removeAt(b.Ge,512)),k.yn())}Uqn(b){const k=b.qa;if(k){var r=new rb.a;for(let y=0;y<k.length;y++){const R=k.J(y);if(R&&R.Jb){for(let aa=0;aa<R.Jb.length;aa++)r.add(R.Jb.J(aa).Ge);
R.Jb=null}}b.Hga(!0,r)}}}Object(m.a)(FB,"ContentControlChpManager",null,[642]);class Yz{constructor(b,k,r,y,R){this.fb=b;this.Fo=k;this.hh=r;this.Ic=y;this.sg=R}acf(b){if(!b||!rf.SelectionEditor.zf(b))return null;if(!b.cpBegin){const k=this.aOh(b.node,b.Fb,!0);if(k)return k}return b.cpBegin===this.fb.textLength(b.node)?this.aOh(b.node,b.Fb-1,!1):null}Zkl(b,k){b=this.wvh(b,k);return this.acf(b)}aOh(b,k,r){return b.qa&&b.qa.length?(b=r?b.qa.first.Jb:b.qa.last.Jb)&&0<=k&&k<b.length&&b.J(k).Tf&&b.J(k).Oc===
r&&this.cqf(b.J(k))?b.J(k):null:null}uff(b){if(!b||!rf.SelectionEditor.ju(b))return null;var k=this.Fo.dFd(b,b);b=0<k.count?k.J(k.count-1):null;return b&&!b.Tf&&this.cqf(b)?(k=1<k.count?k.J(k.count-2):null)&&!k.Tf&&this.cqf(k)?null:b:null}cqf(b){if(!b)return!1;var k=this.qXh(b);if(!k)return!1;if(b.Oc)var r=b;else r=k,k=b;var y=this.fb.textLength(b.Ob.paragraph);if(r.Ob.cp||k.Ob.cp!==y||!r.Cq||r.vua||!k.Cq||k.vua)return!1;r=r.Ob.Jb;k=k.Ob.Jb;for(y=0;y<r.length&&!r.J(y).pe.equals(b.pe);y++)if(!r.J(y).Oc)return!1;
for(r=k.length-1;0<=r&&!k.J(r).pe.equals(b.pe);r--)if(k.J(r).Oc)return!1;return!0}j3c(b){b=this.acf(b);this.Pwd(b,!1)}Ufj(b,k){b=this.wvh(b,k);this.j3c(b)}tFa(b){b=this.uff(b);return this.Pwd(b,!0)?b:null}Yam(b,k){b=this.acf(b);return!!b&&b.pe.equals(k)}h6b(b,k,r){b=this.Zkl(b,k);return!!b&&b.pe.equals(r)}Krf(b,k){b=this.uff(b);return!!b&&b.pe.equals(k)}Pwd(b,k){if(!b)return!1;const r=this.qXh(b);return this.Qsh(b,k)&&(!r||this.Qsh(r,k))}Qsh(b,k){if(!b||b.Tf===k)return!1;var r=this.Fo.mce(b.Ob.paragraph,
b.Oc);const y=b.Ob.Jb;-1!==r||b.Oc||(r=y.length);const R=k===b.Oc?1:-1;r+=k?R:0;b=y.zI(b.pe,b.Oc)+R;if(r===b||0<R!==b>r)return v.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,R),v.ULS.shipAssertTag(24933848,368,0<R===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,R),!1;for(var aa=r;aa!==b;aa+=R){var ta=
y.J(aa);y.Yna(ta);ta.Tf=k;y.R8l(ta,aa);this.hmo(y.J(aa))}if(this.iaa)for(y.Ob.paragraph.yn(),aa=r;aa!==b;aa+=R)ta=y.J(aa),ta.paragraph.wordRunProperties.Iq.Z(ta.Ge,er.CharacterPropertiesEditor.GQ),ta.paragraph.wordRunProperties.gt.Z(ta.Ge,er.CharacterPropertiesEditor.cU);k?this.Ioo(y,r,b,R):this.Joo(y,r,b,R);v.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),k?"block":"inline");return!0}EHd(b){var k,r;return b.Oc&&this.sg.jr.get(null===(k=b.contentControlNode.id)||
void 0===k?void 0:k.toString()).equals(b.Ob.paragraph.id)?38:!b.Oc&&this.sg.As.get(null===(r=b.contentControlNode.id)||void 0===r?void 0:r.toString()).equals(b.Ob.paragraph.id)?39:b.Tf&&b.Oc?40:b.Tf&&!b.Oc?41:!b.Tf&&b.Oc?38:39}hmo(b){const k=b.Ob.paragraph.Mc;if(k){var r=k.Db(b.Us),y=b.contentControlNode;if(cs.a.ACa||r&&y){if(r){r=r.clone();r.setValue(wc.a.quf,b.Tf);const R=this.EHd(b);r.setValue(wc.a.Gq,R);k.Lu(r,null);b.Us=r.id}y&&y.setValue(wc.a.I6,b.Tf)}}}qXh(b){if(b.Ob.cp&&b.Ob.cp!==this.fb.textLength(b.Ob.paragraph)||
!b.Ob.paragraph.qa||!b.Ob.paragraph.qa.length)return null;const k=b.Oc?b.Ob.paragraph.qa.last:b.Ob.paragraph.qa.first;if(!k.Jb)return null;b=k.Jb.zI(b.pe,!b.Oc);return-1===b?null:k.Jb.J(b)}Joo(b,k,r,y){var R,aa,ta,Ya,xb=b.J(k).contentControlNode;if(xb){var Mb=b.J(k).Oc?this.sg.jr:this.sg.As;xb=null!==(aa=Mb.get(null===(R=xb.id)||void 0===R?void 0:R.toString()))&&void 0!==aa?aa:G.a.nil;if(!xb.equals(G.a.nil))if(b.Ob&&b.Ob.paragraph&&b.Ob.paragraph.id.equals(xb)){for(k+=y;k!==r;k+=y){R=b.J(k).contentControlNode;
if(!R)return;Mb.set(null===(ta=R.id)||void 0===ta?void 0:ta.toString(),xb)}0<=r&&r<b.length&&b.J(r).Tf&&this.Y7b(b.J(r))&&(b=b.J(r).contentControlNode)&&Mb.set(null===(Ya=b.id)||void 0===Ya?void 0:Ya.toString(),xb)}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}Ioo(b,k,r,y){var R;if(!cs.a.r6b){var aa=null,ta=k-y;0<=ta&&ta<b.length&&b.J(ta).Tf&&this.Y7b(b.J(ta))&&(aa=b.J(ta).contentControlNode);for(ta=
b.J(k).Oc;k!==r;k+=y){const Ya=b.J(k).contentControlNode;if(!Ya)break;aa&&(ta?this.sg.jr:this.sg.As).set(null===(R=aa.id)||void 0===R?void 0:R.toString(),Ya.id);aa=Ya}}}Y7b(b){return b.Cq&&!b.vua}wvh(b,k){if(!b||!this.hh)return null;const r=k?Re.a.Uc(b,0):Re.a.rw(b);b=this.hh.Aq(b,k);r.Tb=r.Fb=b;return r}get iaa(){return this.Ic.isFeatureEnabled(27)}}Object(m.a)(Yz,"ContentControlConverter",null,[641]);var Ov;(function(b){b[b.lzo=0]="BoundingBox";b[b.uCo=1]="Tags";b[b.uAo=2]="Hidden";b[b.lBo=3]="NumberOfContentControlAppearance"})(Ov||
(Ov={}));Object(m.b)("ContentControlAppearance",Ov);var qy;(function(b){b[b.Unknown=-1]="Unknown";b[b.bCo=0]="RichText";b[b.ABo=1]="PlainText";b[b.yBo=2]="Picture";b[b.uzo=3]="ComboBox";b[b.bAo=4]="DropDownList";b[b.mzo=5]="BuildingBlockGallery";b[b.Date=6]="Date";b[b.VBo=7]="RepeatSectionItem";b[b.rzo=8]="CheckBox";b[b.UBo=9]="RepeatSection";b[b.Bibliography=10]="Bibliography";b[b.tCo=11]="TableOfContents";b[b.mBo=12]="NumberOfContentControlKinds"})(qy||(qy={}));Object(m.b)("ContentControlKind",
qy);class XA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.e7a=this.hwc=this.G$c=this.Hmd=this.bhd=null;this.Vha=this.Fl=this.ytc=this._id=0;this.fQb=this.STb=this.Dnd=this._title=this.sxa=null;this.ded=this.ced=this.ONg=this.$jd=this.Upc=this.Ppc=this.Z9c=!1;this.ePg=null;this.Tf=!1;this.Ale=null;this.Ci=r;this.Ax=k;this.$g=y;this.us=R;this.qm=aa;this.A0=ta;this.dqa=Ya;this.qda=xb;this.bvb=Mb;this.sg=cc;b?(this.bhd=b.id,this.Ale=b,this.eT(!1)):this._id=Gc.a.ZF()}get Mi(){return this.Ci.value}get id(){this.eT();
return this._id}set id(b){this._id=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.My,this._id),this.d0())}get parentId(){this.eT();return this.ytc}set parentId(b){this.ytc=b}get title(){this.eT();return this._title}set title(b){this._title=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.ubb,this._title),this.d0(),this.C3c(k=>{k.title=this._title?this._title:Dw.a.yyb}))}get tag(){this.eT();return this.Dnd}set tag(b){this.Dnd=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.ZZb,this.Dnd),
this.d0())}get type(){this.eT();return this.Fl}set type(b){this.Fl=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.yxb,qy[this.Fl]),this.d0())}get appearance(){this.eT();return this.Vha}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Vha=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.vbb,Ov[this.Vha].toLowerCase()),this.d0(),this.C3c(k=>{k.appearance=Ov[this.Vha].toLowerCase()}))}get color(){this.eT();return this.sxa}set color(b){if(b&&
16777215>=b)this.sxa=b,this.Sd()&&(this.contentControlNode.setValue(wc.a.gCc,this.sxa),this.d0(),this.C3c(k=>{k.color=this.sxa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get a0d(){this.eT();return this.STb}set a0d(b){this.STb=b}get Yzd(){this.eT();return this.fQb}set Yzd(b){this.fQb=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.WZb,this.fQb),this.d0())}get C5e(){this.eT();return this.Z9c}set C5e(b){b&&(this.Z9c=b,this.Sd()&&(this.contentControlNode.setValue(wc.a.Ewd,
this.Z9c),this.d0()))}get removeWhenEdited(){this.eT();return this.$jd}set removeWhenEdited(b){if(b&&!this.pfa)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.$jd=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.psh,this.$jd),this.d0())}get pfa(){this.eT();return this.Ppc}set pfa(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");
this.Ppc=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.YZb,this.Ppc),this.C3c(k=>{k.QS=this.Ppc}),this.d0())}get isEditable(){this.eT();return this.Upc}set isEditable(b){this.Upc=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.xxb,this.Upc),this.C3c(k=>{k.editable=this.Upc}),this.d0())}get isSupported(){this.eT();return this.ONg}get hlm(){return this.isSupported&&11!==this.type&&10!==this.type}get mom(){this.eT();return this.fQb&&"table of contents"===this.fQb.toLowerCase()?!0:!1}get WPd(){this.eT();
return this.ced}set WPd(b){this.ced=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.ssh,this.ced),this.d0())}get r7b(){this.eT();return this.ded}set r7b(b){this.ded=b;this.Sd()&&(this.contentControlNode.setValue(wc.a.tsh,this.ded),this.d0())}get fO(){return this.contentControlNode.ia(wc.a.V5,!1)}set fO(b){this.Sd()&&this.contentControlNode.setValue(wc.a.V5,b)}get su(){this.eT();return this.Hmd}set su(b){this.Hmd=b}get Oz(){this.eT();return this.G$c}set Oz(b){this.G$c=b}get objectId(){return this.bhd}set objectId(b){this.bhd=
b;this.Ale=this.Mi.Db(this.bhd)}get start(){this.kkj();return this.hwc}set start(b){this.hwc=b}get end(){this.kkj();return this.e7a}set end(b){this.e7a=b}get contentControlNode(){return this.Ale}T4m(b){for(let k=0;3>k;++k)if(Ov[k].toLowerCase()===b)return k;return 0}U4m(b){for(let k=0;12>k;++k)if(qy[k]===b)return k;return-1}d0(){const b=this.start.node;b&&b.setValue(Te.a.WT,new Date)}R3c(){var b,k,r,y;this._id=this.contentControlNode.ia(wc.a.My,0);this.Vha=this.T4m(this.contentControlNode.ia(wc.a.vbb,
null));this.sxa=this.contentControlNode.ia(wc.a.gCc,null);this._title=this.contentControlNode.ia(wc.a.ubb,null);this.Dnd=this.contentControlNode.ia(wc.a.ZZb,null);this.Tf=this.contentControlNode.ia(wc.a.I6,!1);this.Ppc=this.contentControlNode.ia(wc.a.YZb,!1);this.Upc=this.contentControlNode.ia(wc.a.xxb,!1);this.ONg=this.contentControlNode.ia(wc.a.Yda,!1);this.fQb=this.contentControlNode.ia(wc.a.WZb,null);this.Z9c=this.contentControlNode.ia(wc.a.Ewd,!1);this.Hmd=null!==(k=this.sg.jr.get(null===(b=
this.contentControlNode.id)||void 0===b?void 0:b.toString()))&&void 0!==k?k:G.a.nil;this.G$c=null!==(y=this.sg.As.get(null===(r=this.contentControlNode.id)||void 0===r?void 0:r.toString()))&&void 0!==y?y:G.a.nil;this.ded=this.contentControlNode.ia(wc.a.tsh,!1);this.ced=this.contentControlNode.ia(wc.a.ssh,!1);this.$jd=this.contentControlNode.ia(wc.a.psh,!1);this.Fl=this.U4m(this.contentControlNode.ia(wc.a.yxb,"RichText"));b=null;try{const R=this.contentControlNode.ia(wc.a.U5,G.a.nil);if(G.a.Jp(R,G.a.nil))this.ytc=
0;else if(b=this.Mi.Db(R))this.ytc=b.ia(wc.a.My,0)}catch(R){this.ytc=0}this.Hno()}Hno(){if(this.bvb){var b=this.contentControlNode.ia(wc.a.LZe,"");if((b=this.dqa.r2h(b))&&0<b.length){this.STb=this.kNh(b.Qa,b.Tc);return}}this.STb=(b=this.$g.qta())&&b.currentNode?b.currentNode.ia(wc.a.hCc,null):null}eT(b=!0){if(!b||this.Sd())b=this.contentControlNode.ia(Te.a.lastModifiedTime,new Date(0)),this.ePg!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.R3c(),
this.ePg=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}Hoo(b,k){var r,y;this.Hmd=b;this.G$c=k;this.sg.jr.set(null===(r=this.contentControlNode.id)||void 0===r?void 0:r.toString(),b);this.sg.As.set(null===(y=this.contentControlNode.id)||void 0===y?void 0:y.toString(),k)}kkj(){if(this.contentControlNode){var b=this.su,k=this.Oz;if(!b||!k||b.equals(G.a.nil)||k.equals(G.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.$g.rla(b,!0),k=this.$g.rla(k,!1),b&&k)if(b.isConnected&&k.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Tf)b=Re.a.create(b),this.us.A3c(b,this.objectId,!0),this.start=b,b=Re.a.create(k),this.us.A3c(b,this.objectId,!0),this.end=b;else{let r=k=-1;if(b.qa){for(let y=0;y<b.qa.length&&(-1===k||-1===r);y++){const R=b.qa.J(y);if(R.Jb)for(let aa=0;aa<R.Jb.length&&(-1===k||-1===r);aa++){const ta=R.Jb.J(aa);G.a.Jp(ta.pe,this.objectId)&&(ta.Oc?
k=R.cp:r=R.cp)}}0<=k&&0<=r&&(b=Re.a.vL(k,r,!1,b),this.us.A3c(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var k=this.start;const r=this.end;if(!k||!r)return b;this.Tf?b=this.kNh(k,r):(k=ie.ParagraphReader.text(k.node).substring(k.cpBegin,r.cpEnd),b+=xn.AParagraphNode.nU(k));return b}Sd(){return!!this.contentControlNode&&this.contentControlNode.isConnected}O7d(b){return this.qda?this.qm.$1i(this,b)?0:2:2}clear(){return this.qda?this.qm.$1i(this,"")?0:2:2}ePh(){const b=new rb.a;
var k=this.contentControlNode.ia(wc.a.contentControlNode,[]);for(let r of k)if(!G.a.Jp(r,G.a.nil)){k=this.Ci.value.Db(r);try{b.add(this.A0.Lxb(k,this.Ax,this.Ci,this.$g,this.us,this.qm,this.dqa,this.qda,this.bvb))}catch(y){}}return b}ybf(){const b=new rb.a;this.dNh(this,b);return b}dNh(b,k){b=b.ePh();if(b.count)for(let r of b)k.add(r),this.dNh(r,k)}lE(b=!1){const k=new rb.a;if(this.Tf){var r=this.qm.lT(this.start,this.end);for(var y of r)r=Re.a.create(y),this.us.A3c(r,this.objectId,b),k.add(r)}else y=
this.start.clone(),this.us.A3c(y,this.objectId,b),k.add(y);return k}C3c(b){const k=this.qm.lT(this.start,this.end);for(let r=0;r<k.count;r++){const y=this.us.$cf(k.J(r),this.objectId,!1);if(y){for(let R=0;R<y.count;R++)b(y.J(R));k.J(r).gk()}}}kNh(b,k){const r=new Sys.StringBuilder;k=this.qm.lT(b,k);for(let y of k)y.id.equals(b.node.id)||r.append("\r"),r.append(ie.ParagraphReader.plainText(y));return r.toString()}}Object(m.a)(XA,"ContentControl",null,[664]);class cz{constructor(b){this.sg=b}Lxb(b,
k,r,y,R,aa,ta,Ya,xb){return new XA(b,k,r,y,R,aa,this,ta,Ya,xb,this.sg)}}Object(m.a)(cz,"ContentControlFactory",null,[640]);var tC=c(914);class gu{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.Ax=b;this.Ci=k;this.Yc=r;this.DTb=y;this.sBj=R;this.IJ=aa;this.Kh=ta;this.fb=Ya;this.iid=xb;this.abd=Mb;this.sg=cc}get jr(){return this.sg.jr}get As(){return this.sg.As}get fy(){return this.Ax.value}qta(){const b=this.Yc.Ck();b.set(this.fy);this.DTb.DQ(b);if(b.Pb(25))return b;this.abd.instance&&this.abd.instance.rma&&
v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}xIc(b,k,r=!1){this.i1b();const y=new rb.a;let R;if(b){R=b.Pb(26);if(!R)return y;for(;R&&(!k(R)||(y.add(R),!r));){y.addRange(this.xIc(b,k));if(r&&0<y.count)break;R=b.yf(26)}b.mc()}return y}jEl(){const b=this.Yc.Ck();b.set(this.Ax.value);this.DTb.DQ(b);return b.currentNode}eNa(b,k,r){let y;y=b.equals(k);y||(y=(b=this.rla(b,r))?
b.id.equals(k):!1);return y}xLa(b,k){var r,y,R,aa;b=this.Gu(b);if(!b)return null;let ta=null;for(;55===b.type;){let Ya;Ya=k?null!==(y=this.sg.jr.get(null===(r=b.id)||void 0===r?void 0:r.toString()))&&void 0!==y?y:G.a.nil:null!==(aa=this.sg.As.get(null===(R=b.id)||void 0===R?void 0:R.toString()))&&void 0!==aa?aa:G.a.nil;if(Ya.equals(ta)){b=null;break}else b=this.Gu(Ya);ta=Ya}return b}rla(b,k){return(b=this.xLa(b,k))?ie.ParagraphReader.nc(b)?b:k?this.fb.Rm(b):this.fb.dK(b):null}Ezh(b,k=!1){this.ujo(b);
this.Fzh(b,k)}ujo(b){var k,r,y,R,aa,ta,Ya,xb,Mb=this.pta(b);Mb=this.pta(Mb.parentNode);Mb=55===Mb.currentNode.type?Mb.currentNode.id:null;let cc;cc=this.Gu(null!==(r=this.sg.jr.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==r?r:G.a.nil);for(k=this.Gu(null!==(R=this.sg.As.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&void 0!==R?R:G.a.nil);cc&&55===cc.type;)cc=this.Gu(null!==(ta=this.sg.jr.get(null===(aa=cc.id)||void 0===aa?void 0:aa.toString()))&&void 0!==ta?ta:G.a.nil);for(;k&&
55===k.type;)k=this.Gu(null!==(xb=this.sg.As.get(null===(Ya=k.id)||void 0===Ya?void 0:Ya.toString()))&&void 0!==xb?xb:G.a.nil);cc&&k&&this.Shj(cc.id,k.id,Mb,jc=>{jc=jc.ia(wc.a.lW,G.a.nil);return!jc||jc.equals(G.a.nil)||b.id.equals(jc)})}Fzh(b,k=!1){var r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd;v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const Td=this.pta(b),ne=this.pta(Td.parentNode);let ye=G.a.nil,ff=G.a.nil;var Gd=ne.currentNode.ia(wc.a.contentControlNode,[]);const oe=
new rb.a;for(let ug=0;ug<Gd.length;ug++)oe.add(Gd[ug]);if(k){if(54!==ne.currentNode.type){ye=this.sg.jr.get(null===(r=ne.currentNode.id)||void 0===r?void 0:r.toString());ff=this.sg.As.get(null===(y=ne.currentNode.id)||void 0===y?void 0:y.toString());Gd=this.Gu(ye);for(r=this.Gu(ff);Gd&&55===Gd.type;)ye=this.sg.jr.get(null===(R=Gd.id)||void 0===R?void 0:R.toString()),Gd=this.Gu(ye);for(;r&&55===r.type;)ff=this.sg.As.get(null===(aa=r.id)||void 0===aa?void 0:aa.toString()),r=this.Gu(ff)}R=this.pta(b);
if(R.Pb(26)){aa=new rb.a;for(aa.add(R.currentNode);R.yf(26);)aa.add(R.currentNode);for(var ze of aa)this.Fzh(ze,k)}}else if(ye=this.sg.jr.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),ff=this.sg.As.get(null===(Ya=b.id)||void 0===Ya?void 0:Ya.toString()),k=this.txl(oe,b.id),ze=this.pta(b),ze.Pb(26))for(R=this.pta(ze.currentNode),aa=R.currentNode,Gd=b;aa;)r=ze.currentNode,oe.insert(k++,r.id),aa=R.yf(26),y=this.pta(r),54!==ne.currentNode.type?r.setValue(wc.a.U5,ne.currentNode.id):r.removeProperty(wc.a.U5),
Vo.g(y,ne,Gd,26),Gd=y.currentNode,aa&&(ze.set(aa),ze.$_(this.qta().currentNode));54!==ne.currentNode.type&&(k=null!==(Mb=this.sg.jr.get(null===(xb=ne.currentNode.id)||void 0===xb?void 0:xb.toString()))&&void 0!==Mb?Mb:G.a.nil,xb=null!==(jc=this.sg.As.get(null===(cc=ne.currentNode.id)||void 0===cc?void 0:cc.toString()))&&void 0!==jc?jc:G.a.nil,k.equals(b.id)&&this.sg.jr.set(null===(Mc=ne.currentNode.id)||void 0===Mc?void 0:Mc.toString(),ye),xb.equals(b.id)&&this.sg.As.set(null===(fd=ne.currentNode.id)||
void 0===fd?void 0:fd.toString(),ff));Td.Hg();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(oe,b.id);Gd=Array(oe.count);for(cc=0;cc<oe.count;cc++)Gd[cc]=oe.J(cc);ne.currentNode.setValue(wc.a.contentControlNode,Gd);tC.a.$Ca(b.id)}t3j(b,k,r,y,R,aa,ta=null){var Ya,xb,Mb,cc,jc,Mc,fd,Td;let ne,ye;k?(ne=this.Gu(k.objectId),ye=this.pta(ne)):(ye=this.qta(),ne=ye.currentNode);const ff=this.sBj.create(1074135145);ta&&ff.properties.Bs(ta.properties);54!==ne.type&&ff.setValue(wc.a.U5,
ne.id);ta?ye.PCb(ff,r,26,ta.id):ye.eH(ff,r,26);this.sg.jr.set(null===(Ya=ff.id)||void 0===Ya?void 0:Ya.toString(),R);this.sg.As.set(null===(xb=ff.id)||void 0===xb?void 0:xb.toString(),aa);b.Tf&&(k&&(r=null!==(cc=this.sg.jr.get(null===(Mb=ne.id)||void 0===Mb?void 0:Mb.toString()))&&void 0!==cc?cc:G.a.nil,Mb=null!==(Mc=this.sg.As.get(null===(jc=ne.id)||void 0===jc?void 0:jc.toString()))&&void 0!==Mc?Mc:G.a.nil,r.equals(R)&&this.sg.jr.set(null===(fd=ne.id)||void 0===fd?void 0:fd.toString(),ff.id),Mb.equals(aa)&&
this.sg.As.set(null===(Td=ne.id)||void 0===Td?void 0:Td.toString(),ff.id)),this.Shj(R,aa,ff.id,Gd=>{Gd=Gd.ia(wc.a.lW,G.a.nil);const oe=k?k.objectId:null;return!Gd||Gd.equals(G.a.nil)||Gd.equals(oe)}));R=this.pta(ff);aa=Array(y.count);for(jc=y.count-1;0<=jc;jc--)aa[jc]=y.J(jc).objectId,Mc=this.Gu(y.J(jc).objectId),Mc=this.pta(Mc),Mc.currentNode.setValue(wc.a.U5,ff.id),Vo.g(Mc,R,null,26);0<aa.length&&ff.setValue(wc.a.contentControlNode,aa);gu.Wb.isFeatureEnabled(36)&&(b.Yzd&&ff.setValue(wc.a.WZb,b.Yzd),
b.C5e&&ff.setValue(wc.a.Ewd,!0));return ff}kLn(b,k,r,y){b.setValue(wc.a.I6,k);b.setValue(wc.a.YZb,!0);b.setValue(wc.a.xxb,!0);b.setValue(wc.a.My,r);b.setValue(wc.a.vbb,Ov[0]);b.setValue(wc.a.Yda,!0);b.setValue(wc.a.yxb,"RichText");y&&b.setValue(wc.a.cmb,y);b.setValue(wc.a.$Zb,0)}Thj(b,k=null,r=null){k&&this.sg.jr.set(b.toString(),k);r&&this.sg.As.set(b.toString(),r)}Szh(b){if(!b||!b.count||!b.J(0))return null;const k=this.thf(b);for(let r=0;r<b.count;r++)this.Kh.kPa(b.J(r));return k}thf(b){if(!b||
!b.J(0))return null;const k=this.Yc.Ck();k.set(b.J(0));k.rd();k.mc();return k.dH()?k.currentNode:null}rFl(b){const k=this.Yc.Ck();k.set(b);k.rd();k.mc();k.mc();return k}$9g(b,k,r){const y=new rb.a;for(let R=0;R<r;R++){k=this.IJ.Gfb(b,k,!0,null);if(!k||!b.Ud())return null;const aa=b.currentNode;b.mc();b.mc();y.add(aa)}return y}m4b(b){const k=this.Yc.Ck();k.set(b);for(k.Ab(7);k.mc();)switch(k.currentNode.type){case 8:case 16:case 36:case 40:return k.currentNode.id}return null}bXh(b){const k=this.Yc.Ck();
k.set(b);k.rd();return(b=k.BPa())?b.id:null}zff(b){const k=this.Yc.Ck();k.set(b);return k.Ab(7)?k:null}Gu(b){return this.Ci.value.Db(b)}i1b(){if(!gu.oLg){var b=this.qta();b&&this.h7f(b);gu.oLg=!0}}kQa(b){return this.iid.kQa(b)}uak(b,k){const r=this.Yc.Ck();r.set(b.node);const y=this.Yc.Ck();y.set(k.node);r.rd();y.rd();const R=this.Yc.Ck();R.set(r.currentNode);const aa=this.Yc.Ck();aa.set(y.currentNode);const ta=bf.returnToLowestCommonTableCell(r,y);return ta?(R.rd(),aa.rd(),{returnValue:({Tx:b}=this.Gud(R,
!0,ta,b)).returnValue&&({Tx:k}=this.Gud(aa,!1,ta,k)).returnValue,g9i:b,WEh:k}):{returnValue:({Tx:b}=this.Gud(r,!0,null,b)).returnValue&&({Tx:k}=this.Gud(y,!1,null,k)).returnValue,g9i:b,WEh:k}}Gud(b,k,r,y){let R=null,aa=b.kd(16);for(;aa!==r;){if(k&&Ei.TableCellReader.Xem(b)||!k&&Ei.TableCellReader.zfi(b))R=b.kd(14);else return{returnValue:!1,Tx:y};aa=b.kd(16)}R&&(y=Re.a.create(R));return{returnValue:!0,Tx:y}}h7f(b){if(b.Pb(26)){for(this.h7f(b);b.yf(26);)this.h7f(b);b.mc()}}remove(b,k){for(let r=0;r<
b.count;r++)if(b.J(r).toString()===k.toString()){b.removeAt(r);break}}pta(b){const k=this.Yc.Ck();k.set(b);k.$_(this.qta().currentNode);return k}txl(b,k){for(let r=0;r<b.count;r++)if(b.J(r).equals(k))return r;return-1}Shj(b,k,r,y){b=this.yol(b,k);for(k=0;k<b.count;k++)y(b.J(k))&&(r?b.J(k).setValue(wc.a.lW,r):b.J(k).removeProperty(wc.a.lW),this.abd.instance&&this.abd.instance.xci&&b.J(k).uk(16,!0))}yol(b,k){const r=new rb.a;var y=this.Gu(b);const R=this.Gu(k);if(!y||!R)return r;const aa=({JQc:ta}=
this.qEd(y,R)).returnValue;y=ta[aa];if(14===y.type)r.add(y);else if(15===y.type&&1<=aa){const Ya=ta[aa-1];1===Si.TableReader.$f(Ya)&&r.add(Ya)}var ta=Wd.GraphIterator.Za(aa>=ta.length-1?y:ta[aa+1]);ta.Ab(7);for(y=Pm.a.Lr(ta,y);y.moveNext()&&y.currentNode!==R;)14===y.currentNode.type&&r.add(y.currentNode);if(!G.a.Jp(k,b)&&14===R.type)for(ta=Wd.GraphIterator.Za(R),y=Pm.a.Lr(ta,R);y.moveNext();)14===y.currentNode.type&&r.add(y.currentNode);return r}qEd(b,k){b=this.Adb(b);k=this.Adb(k);let r=0;for(;r<
b.length&&r<k.length&&b[r]===k[r];++r);return{returnValue:0<r?r-1:r,JQc:b,PVf:k}}Adb(b){const k=[];k.push(b);b=Wd.GraphIterator.Za(b);for(b.Ab(7);b.mc();)k.push(b.currentNode);k.reverse();return k}static get Wb(){return null!=gu.Ujg?gu.Ujg:gu.Ujg=Va.a.instance.Pa("Box4.IFeatureHelper")}}gu.oLg=!1;Object(m.a)(gu,"ContentControlGraphManager",null,[639]);class Cu{constructor(b,k,r,y,R,aa,ta,Ya,xb){this.opa=null;this.pjm=(Mb,cc)=>{if(this.VW)return this.qjm(Mb,cc);if(!Mb||!Mb.count)return v.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let jc=!0;switch(cc){case 0:cc=this.$P(Mb.J(0),Mb.J(Mb.count-1),1);if((Mb=this.$P(Mb.J(0),Mb.J(Mb.count-1),3))&&0<Mb.count){if(!Mb.J(0).isSupported||!Mb.J(0).isEditable){jc=!1;break}for(Mb=Mb.J(0);Mb;)this.JXc(cc,Mb.id),Mb=this.getById(Mb.parentId)}if(cc)for(var Mc of cc)if(!Mc.isSupported||!Mc.isEditable){jc=!1;break}break;case 1:if(Mb.J(0).contextId!==lc.a.Wc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
jc=!1;break}(cc=this.$P(Mb.J(0),Mb.J(0),1))&&0<cc.count&&(jc=!1);break;case 2:if(Mb.J(0).contextId!==lc.a.Wc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");jc=!1;break}(cc=this.$P(Mb.J(0),Mb.J(0),3))&&0<cc.count&&(jc=!1);break;case 3:case 4:cc=this.vGd(Mb.J(0),!0);Mc=this.vGd(Mb.J(Mb.count-1),!1);if(!cc||!Mc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
jc=!1;break}if((cc=this.$P(cc,cc,3))&&0<cc.count){jc=!1;break}if((cc=this.$P(Mc,Mc,3))&&0<cc.count){jc=!1;break}if(cc=this.qm.$P(Mb.J(0),Mb.J(Mb.count-1),1))for(let fd of cc)if(!fd.pfa){jc=!1;break}break;default:jc=!1}return jc};Cu.Ax=b;Cu.Ci=k;this.$g=r;this.us=y;this.qm=R;this.A0=aa;this.dqa=ta;this.Bf=Ya;this.Fo=xb}get PMa(){return!!this.Bf.instance&&this.Bf.instance.PMa}get rma(){return!!this.Bf.instance&&this.Bf.instance.rma}get pOd(){return!!this.Bf.instance&&this.Bf.instance.pOd}get VW(){return!!this.Bf.instance&&
this.Bf.instance.VW}get rOd(){return!!this.Bf.instance&&this.Bf.instance.rOd}qDb(){return!!this.Bf.instance&&this.Bf.instance.qDb}Hja(b,k,r=null,y=null,R=!1){if(!this.PMa)return{returnValue:2,id:0};b=this.$g.rla(b,!0);k=this.$g.rla(k,!1);if(!b||!k)return{returnValue:2,id:0};b=Re.a.create(b);k=Re.a.create(k);return this.K8g(b,k,r,y,R)}z2j(b,k,r=!1){return this.PMa&&b&&k?this.K8g(b,k,null,null,!1,r):{returnValue:2,id:0}}svb(b,k=null,r=!1){let y=0;if(!this.PMa)return{returnValue:2,id:y};const R=this.A0.Lxb(k,
Cu.Ax,Cu.Ci,this.$g,this.us,this.qm,this.dqa,this.PMa,this.pOd);R.start=b;R.end=b;R.su=b.node.id;R.Oz=b.node.id;R.Tf=!1;return this.qm.N9g(R,k,r)?(y=R.id,{returnValue:0,id:y}):{returnValue:2,id:y}}s3j(b,k=null){if(!this.PMa||!this.Tfm(b))return{returnValue:2,id:0};var r=b.J(0).contextId===lc.a.endOfParagraph?b.J(1):b.J(0);const y=b.J(b.count-1);if(this.tZe(b,lc.a.paragraph)||this.tZe(b,lc.a.endOfParagraph)){b=r.node.id;let R=y.node.id;const aa=b.equals(R);r=this.qm.I8i(r,!0);void 0!==r&&null!==r&&
(b=r,R=aa?b:R);this.qm.I8i(y,!1);k.setValue(wc.a.I6,!0);return this.Hja(b,R,k)}return r!==y||r.contextId!==lc.a.Hd&&r.contextId!==lc.a.Wc?{returnValue:2,id:0}:(k.setValue(wc.a.I6,!1),this.svb(r,k))}getById(b){if(!this.rma)return null;const k=this.$g.xIc(this.$g.qta(),r=>r.getValue(wc.a.My)===b,!0);return 0<k.count?this.qm.mT(k.J(0)):null}getByTitle(b){if(!this.rma)return null;const k=this.$g.xIc(this.$g.qta(),y=>y.ia(wc.a.ubb,null)===b,!1),r=new rb.a;for(let y of k)r.add(this.qm.mT(y));return r}getByTag(b){if(!this.rma)return null;
const k=this.$g.xIc(this.$g.qta(),y=>y.ia(wc.a.ZZb,null)===b,!1),r=new rb.a;for(let y of k)r.add(this.qm.mT(y));return r}$P(b,k,r,y=!1){return this.rma?this.VW?this.qm.Hea(b,k,r):this.qm.$P(b,k,r,y):null}lT(b,k){return this.qm.lT(b,k)}cjl(){if(!this.rma)return null;const b=this.$g.xIc(this.$g.qta(),()=>!0,!1),k=new rb.a;for(let r of b)k.add(this.qm.mT(r));return k}Njb(b){if(!this.PMa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;b=this.getById(b);return this.qm.eEa(b)?0:2}aUk(b){if(!this.PMa)return 2;b=this.getById(b);return this.qm.deleteContentControl(b)?0:2}J3j(b){this.qm.Wmn(b)}Fjk(b){this.opa=b;this.opa.Ron(this.pjm)}Pol(b){if(!this.qDb())return null;let k;var r=b.lE();k=this.vGd(r.J(r.count-1),!1);r=this.us.jHd(r.J(r.count-1).node,k.cpBegin).Jb;b=this.xNl(r,b);if(-1===b)return null;k.Fb=b;k.Tb=k.Fb;return k}qjm(b,k){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),
!1;switch(k){case 0:return this.dem(b);case 3:case 4:case 6:return this.rlm(b,6===k);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==lc.a.Wc?(v.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.dfi(b.J(0),5===k,!1);default:return!1}}dem(b){const k=this.qm.Hea(b.J(0),b.J(b.count-1),3);if(k&&0<k.count){var r=k.J(0);if(!r.isSupported||!r.isEditable)return!1}b=this.qm.Hea(b.J(0),b.J(b.count-1),
1);for(r=0;k&&r<k.count;r++)this.JXc(b,k.J(r).id);if(b)for(let y of b)if(!y.isSupported||!y.isEditable)return!1;return!0}rlm(b,k){var r=b.J(0),y=b.J(b.count-1),R=r.gl,aa=y.zt;if(-1===R||-1===aa)return!1;R=this.Fo.r6(r.node,R,r.Fb);aa=this.Fo.r6(y.node,aa,y.Tb);var ta=-1,Ya=Math.min(R.count,aa.count);for(--Ya;0<=Ya;Ya--){const xb=R.J(Ya).pe,Mb=aa.J(Ya).pe;if(xb.equals(Mb)){ta=Ya;break}}if(-1<ta&&(Ya=this.qm.mT(R.J(ta).contentControlNode),!Ya.isEditable||!Ya.isSupported||Ya.fO&&!this.Kdm(Ya,b)))return!1;
r=this.qm.Hea(r,y,1);for(y=0;y<=ta;y++)this.JXc(r,this.qm.mT(R.J(y).contentControlNode).id);for(y=ta+1;y<R.count;y++){Ya=this.qm.mT(R.J(y).contentControlNode);if(!Ya.isEditable||!Ya.pfa||!Ya.isSupported||Ya.fO)return!1;this.JXc(r,Ya.id)}for(R=ta+1;R<aa.count;R++){ta=this.qm.mT(aa.J(R).contentControlNode);if(!ta.isEditable||!ta.pfa||!ta.isSupported||ta.fO)return!1;this.JXc(r,ta.id)}if(r)for(let xb of r)if(!xb.isSupported||!xb.pfa)return!1;return k&&(b=this.vGd(b.J(0),!0))?this.dfi(b,!0,!0):!0}Kdm(b,
k){k=this.Fo.nFl(k.J(0),k.J(k.count-1));return!!b&&!!k&&b.objectId.equals(k.pe)}dfi(b,k,r){return(b=this.qm.Hea(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.rOd&&k&&!b.Tf||!r&&b.fO)?!1:!0}vGd(b,k){if(!b)return null;let r=null;switch(b.contextId){case lc.a.paragraph:r=k?Re.a.Uc(b.node,0):Re.a.rw(b.node);break;case lc.a.endOfParagraph:r=Re.a.rw(b.node);break;case lc.a.Hd:r=k?Re.a.Uc(b.node,b.cpBegin):Re.a.Uc(b.node,b.cpEnd);break;case lc.a.Wc:r=b}r&&(r.Tb=r.Fb=k?b.Fb:b.Tb);return r}JXc(b,
k){if(b)for(let r of b)if(r.id===k){b.remove(r);break}}xNl(b,k){if(!b)return-1;let r=-1;for(let y=0;y<b.length;y++)if(b.J(y).pe.equals(k.objectId)&&!1===b.J(y).Oc){r=y;if(k.Tf&&0<y&&b.J(y-1).Tf&&!b.J(y-1).Oc)return-1;break}return r}Tfm(b){if(void 0===b||null===b)return!1;for(let k=0;k<b.count;k++){const r=b.J(k).contextId;if(r!==lc.a.paragraph&&r!==lc.a.endOfParagraph&&r!==lc.a.Hd&&r!==lc.a.Wc||0<k&&k<b.count-1&&r===lc.a.Hd&&(b.J(k).cpBegin||b.J(k).cpEnd!==b.J(k).node.characterData.length))return!1}return b.J(0).contextId===
lc.a.endOfParagraph&&1===b.count||this.tZe(b,lc.a.Wc)&&1<b.count?!1:!0}tZe(b,k){for(let r of b)if(r.contextId===k)return!0;return!1}K8g(b,k,r=null,y=null,R=!1,aa=!1){let ta=0;var Ya=k.node;let xb=Re.a.create(b.node);Ya=Re.a.create(Ya);if(!({g9i:xb,WEh:Ya}=this.$g.uak(xb,Ya)).returnValue)return{returnValue:2,id:ta};const Mb=this.A0.Lxb(r,Cu.Ax,Cu.Ci,this.$g,this.us,this.qm,this.dqa,this.PMa,this.pOd);Mb.start=b;Mb.end=k;Mb.su=xb.node.id;Mb.Oz=Ya.node.id;Mb.Tf=!0;Mb.Yzd=y;Mb.C5e=R;return this.qm.N9g(Mb,
r,aa)?(ta=Mb.id,{returnValue:0,id:ta}):{returnValue:2,id:ta}}}Cu.Ax=null;Cu.Ci=null;Object(m.a)(Cu,"ContentControlManager",null,[638]);var ry=c(696),uC=c(161),Pv=c(195);class YA extends Sys.EventArgs{constructor(b){super();this.aSk=b}}Object(m.a)(YA,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class GB{constructor(){this.svi=0;this.PEi=null}}Object(m.a)(GB,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class Kp{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff,Gd,
oe,ze,ug,Yf,Aj){this.Oj=Aj;this.pYg=[];this.lEe=[];this.Ax=b;this.Ci=k;this.$g=r;this.us=y;this.A0=R;this.ng=xb;this.DC=Mb;this.hb=aa;this.Dy=ta;this.Cya=Ya;this.dqa=fd;this.bvb=Td;this.qda=cc;this.EH=jc;this.ga=Mc;this.Fo=ne;this.Bf=ye;this.hh=ff;this.fb=Gd;this.Hc=oe;this.y6g=ze;this.Ic=ug;this.sg=Yf;this.EH&&(this.EH.addHandler(ry.a.SIb,Object(u.a)(this,this.CBi,"onShowingPlaceholder")),this.EH.addHandler(ry.a.b4d,Object(u.a)(this,this.OAi,"onRemoveWhenEdited")))}get fy(){return this.Ax.value}get Mi(){return this.Ci.value}get VW(){return!!this.Bf.instance&&
this.Bf.instance.VW}get iaa(){return!!this.Ic&&this.Ic.isFeatureEnabled(27)}dispose(){this.EH&&(this.EH.removeHandler(ry.a.SIb,Object(u.a)(this,this.CBi,"onShowingPlaceholder")),this.EH.removeHandler(ry.a.b4d,Object(u.a)(this,this.OAi,"onRemoveWhenEdited")))}$P(b,k,r,y=!1){if(this.VW)return this.Hea(b,k,r);if(!b||!k)return null;const R=this.$g.rla(b.node.id,!0);var aa=this.$g.rla(k.node.id,!1);if(!R||!aa)return null;b=b.contextId===lc.a.endOfParagraph?b:Re.a.Uc(R,-1===b.cpBegin?0:b.cpBegin);k=k.contextId===
lc.a.endOfParagraph?k:Re.a.Uc(aa,-1===k.cpEnd?aa.characterData.length:k.cpEnd);aa=null;switch(r){case 0:aa=this.Usl(b,k);break;case 1:aa=this.yFl(b,k);break;case 3:aa=this.FXh(b,k,y);break;case 2:aa=this.yOl(b,k);break;case 4:aa=this.edf(b,k,!1)}return aa}Hea(b,k,r){if(!b||!k||b.contextId!==lc.a.endOfParagraph&&(b=this.Rsh(b,!0),!b)||k.contextId!==lc.a.endOfParagraph&&(k=this.Rsh(k,!1),!k))return null;let y=null;switch(r){case 0:y=this.Vsl(b,k);break;case 1:y=this.zFl(b,k);break;case 3:y=this.GXh(b,
k);break;case 2:y=this.zOl(b,k);break;case 4:y=this.edf(b,k,!0)}return y}Rsh(b,k){var r=this.$g.rla(b.node.id,k);if(!r)return null;k?(k=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(k=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Tb);r=Re.a.Uc(r,k);r.Fb=b;r.Tb=b;return r}Usl(b,k){const r=new rb.a;if(b.contextId===lc.a.endOfParagraph||k.contextId===lc.a.endOfParagraph||b.equals(k))return r;const y=new $m.a,R=this.kAb(b,b),aa=this.kAb(k,k);for(let ta=0;ta<R.count;ta++)if(R.J(ta).Oc)for(let Ya=0;Ya<aa.count;Ya++)aa.J(Ya).Oc||
R.J(ta).pe.equals(aa.J(Ya).pe)&&(!R.J(ta).Tf||this.$g.eNa(R.J(ta).pe,b.node.id,!0)&&this.$g.eNa(aa.J(Ya).pe,k.node.id,!1))&&this.Bqd(r,y,R.J(ta).pe);return r}Vsl(b,k){const r=new rb.a;if(b.contextId===lc.a.endOfParagraph||k.contextId===lc.a.endOfParagraph||b.equals(k)&&b.Fb===b.Tb||-1===b.Fb||-1===k.Tb)return r;var y=b.node.qa.ii(b.cpBegin),R=k.node.qa.ii(k.cpEnd);y&&y.Jb&&0<y.Jb.length&&b.Fb<=y.Jb.length&&R&&R.Jb&&0<R.Jb.length&&k.Tb<=R.Jb.length&&(b=b.Fb,k=k.Tb,b===y.Jb.length&&b--,0<k&&k--,y=y.Jb.J(b),
R=R.Jb.J(k),y.Oc&&!R.Oc&&G.a.Jp(y.pe,R.pe)&&y.Cq&&R.Cq&&(R=y.contentControlNode)&&r.add(this.mT(R)));return r}yFl(b,k){const r=new rb.a,y=new $m.a,R=this.kAb(b,k);for(let aa=0;aa<R.count;aa++)this.Bqd(r,y,R.J(aa).pe);b=this.FXh(b,k,!1,!1);for(let aa of b)y.contains(aa.objectId)||(r.add(aa),y.add(aa.objectId));return r}zFl(b,k){const r=new rb.a,y=new $m.a,R=this.ncf(b,k);for(let aa=0;aa<R.count;aa++)this.jOe(r,y,R.J(aa));b=this.GXh(b,k);for(let aa of b)y.contains(aa.objectId)||(r.add(aa),y.add(aa.objectId));
return r}FXh(b,k,r,y=!0){const R=new rb.a;b.equals(k)&&(r=!1);const aa=new $m.a;let ta=!1;b=this.kAb(null,b,!0,r);k=this.kAb(k,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Ya=0;Ya<k.count&&!(b.J(r).pe.equals(k.J(Ya).pe)&&(b.J(r),this.Bqd(R,aa,b.J(r).pe)&&(ta=!this.$g.Gu(b.J(r).pe).ia(wc.a.U5,null),y||ta)));Ya++);if(0<R.count&&(y||ta))break}return R}GXh(b,k){const r=new rb.a,y=new $m.a,R=b.node;var aa=k.node;const ta=k.contextId===lc.a.endOfParagraph?aa.characterData.length:k.cpEnd;b=this.Fo.r6(R,
b.contextId===lc.a.endOfParagraph?R.characterData.length:b.cpBegin,b.Fb);k=this.Fo.r6(aa,ta,k.Tb);aa=b.count>k.count?k.count:b.count;for(--aa;0<=aa;aa--)b.J(aa).pe.equals(k.J(aa).pe)&&this.jOe(r,y,b.J(aa));return r}yOl(b,k){const r=new rb.a;let y=new $m.a;const R=this.kAb(b,k);let aa=0,ta=null;if(b.equals(k))return r;for(b=0;b<R.count;b++)!R.J(b).Oc||R.J(b).Tf&&!this.$g.eNa(R.J(b).pe,R.J(b).Ob.paragraph.id,!0)?R.J(b).Oc||R.J(b).Tf&&!this.$g.eNa(R.J(b).pe,R.J(b).Ob.paragraph.id,!1)||(aa--,0>aa?(aa=
0,y=new $m.a):!aa&&ta&&R.J(b).pe.equals(ta)&&this.Bqd(r,y,ta)):(aa||(ta=R.J(b).pe),aa++);return r}zOl(b,k){const r=new rb.a;if(b.equals(k)&&b.Fb===k.Tb)return r;let y=new $m.a;b=this.ncf(b,k);k=0;let R=null;for(let aa=0;aa<b.count;aa++){const ta=b.J(aa);!ta.Oc||ta.Tf&&!this.$g.eNa(ta.pe,ta.Ob.paragraph.id,!0)?ta.Oc||ta.Tf&&!this.$g.eNa(ta.pe,ta.Ob.paragraph.id,!1)||(k--,0>k?(k=0,y=new $m.a):!k&&R&&ta.pe.equals(R.pe)&&this.jOe(r,y,R)):(k||(R=ta),k++)}return r}edf(b,k,r){const y=new rb.a;b=r?this.ncf(b,
k):this.kAb(b,k);k=0;for(r=0;r<b.count;r++){var R=b.J(r);R.Cq&&(R.Oc?k++:(k--,0>k?k=0:(R=this.mT(R.contentControlNode))&&y.add(R)))}return y}kAb(b,k,r=!0,y=!0){const R=new rb.a,aa=this.lT(b,k);if(!aa.count)return R;let ta,Ya,xb,Mb;for(let cc=0;cc<aa.count;cc++){ta=0;Ya=aa.J(cc).characterData.length;xb=Mb=!0;if(b&&aa.J(cc).id.equals(b.node.id)){if(b.contextId===lc.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}k&&aa.J(cc).id.equals(k.node.id)&&0<=k.cpEnd&&(Ya=k.cpEnd);cc||(xb=r);cc!==aa.count-
1||k&&k.contextId===lc.a.endOfParagraph||(Mb=y);R.addRange(this.ocf(aa.J(cc),ta,Ya,xb,Mb))}return R}ncf(b,k){const r=new rb.a,y=this.lT(b,k);let R,aa,ta;for(let xb=0;xb<y.count;xb++){const Mb=y.J(xb);var Ya=Mb.qa.J(Mb.qa.length-1);R=0;aa=Mb.characterData.length;ta=0;Ya=Ya&&Ya.Jb?Ya.Jb.length:0;b&&Mb.id.equals(b.node.id)&&(R=b.gl,ta=b.Fb);k&&Mb.id.equals(k.node.id)&&(aa=k.zt,Ya=k.Tb);r.addRange(this.tOh(Mb,R,aa,ta,Ya))}return r}ocf(b,k,r,y=!0,R=!0,aa=!0){const ta=new rb.a;b=b.qa;for(let Ya=0;Ya<b.length;Ya++){if(b.J(Ya).cp<
k)continue;if(b.J(Ya).cp>r)break;const xb=b.J(Ya);if(xb.Jb&&0<xb.Jb.length&&(xb.cp!==k||y)&&(xb.cp!==r||R))for(let Mb=0;Mb<xb.Jb.length;Mb++){const cc=xb.Jb.J(Mb);(aa||cc.Oc)&&ta.add(cc)}}return ta}tOh(b,k,r,y,R){const aa=new rb.a;b=b.qa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<k)continue;if(b.J(ta).cp>r)break;const Ya=b.J(ta);if(Ya.Jb&&0<Ya.Jb.length){let xb=0,Mb=Ya.Jb.length;Ya.cp===k&&(xb=y);for(Ya.cp===r&&(Mb=R);xb<Mb&&xb<Ya.Jb.length;xb++)aa.add(Ya.Jb.J(xb))}}return aa}Bqd(b,k,r){let y=null;
if(k.contains(r)||!(y=this.Mi.Db(r)))return!1;b.add(this.mT(y));k.add(r);return!0}jOe(b,k,r){let y=null;!k.contains(r.pe)&&(y=r.contentControlNode)&&(b.add(this.mT(y)),k.add(r.pe))}Uej(b,k){let r,y=!1;r=({A1a:k,z1a:b,n0c:y}=this.Vej(b,k,!1,y)).returnValue||y;y&&(r=r||({A1a:k,z1a:b,n0c:y}=this.Vej(k,b,!0,y)).returnValue);return{returnValue:r,A1a:k,z1a:b}}Vej(b,k,r,y){var R,aa,ta,Ya;let xb,Mb;if(r)return xb=Mb=null,{returnValue:!1,A1a:Mb,z1a:xb,n0c:!1};let cc=!1;Mb=b;xb=k;const jc=b.cpBegin,Mc=k.cpEnd;
y=!1;var fd=r?this.gNh(k):this.pjl(b);let Td=!1,ne=!1,ye=0,ff=0;for(let Gd of fd)for(fd=0;fd<Gd.qa.length;fd++){const oe=Gd.qa.J(fd);!ne&&Gd.id.equals(k.node.id)&&(ne=!0);if(!Td&&(Gd.id.equals(k.node.id)&&-1!==Mc&&oe.cp>Mc||ne&&!Gd.id.equals(k.node.id)))if(Td=!0,ye!==ff)cc=!0;else return{returnValue:!1,A1a:Mb,z1a:xb,n0c:y};if((!Gd.id.equals(b.node.id)||oe.cp>=jc||-1===jc)&&oe.Jb)for(let ze=0;ze<oe.Jb.length;ze++){const ug=oe.Jb.J(ze),Yf=this.Mi.Db(ug.pe);if(!Yf.getValue(wc.a.I6)||(!ug.Oc||this.$g.eNa(null!==
(aa=this.sg.jr.get(null===(R=Yf.id)||void 0===R?void 0:R.toString()))&&void 0!==aa?aa:G.a.nil,Gd.id,!0))&&(ug.Oc||this.$g.eNa(null!==(Ya=this.sg.As.get(null===(ta=Yf.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Ya?Ya:G.a.nil,Gd.id,!1))){ug.Oc?ye++:ye--;if(cc&&ye===ff)return{A1a:Mb,z1a:xb}=this.qKk(b.node,Gd,b.cpBegin,oe.cp),{returnValue:!0,A1a:Mb,z1a:xb,n0c:y};!r&&ye<ff&&(y=!0,ff--)}}}return{returnValue:cc,A1a:Mb,z1a:xb,n0c:y}}qKk(b,k,r,y){let R;k.id.equals(b.id)?b=0<r||y<ie.ParagraphReader.textLength(k)?
R=Re.a.createTextRange(k,r,y):R=Re.a.create(k):(R=0<r?Re.a.createTextRange(b,r,ie.ParagraphReader.textLength(b)):Re.a.create(b),b=y<ie.ParagraphReader.textLength(k)?Re.a.createTextRange(k,0,y):Re.a.create(k));return{A1a:R,z1a:b}}JBl(b){var k,r,y,R;const aa=b.cpBegin,ta=this.gNh(b);for(let xb=ta.count-1;0<=xb;xb--){const Mb=ta.J(xb);for(let cc=Mb.qa.length-1;0<=cc;cc--){const jc=Mb.qa.J(cc);if((!Mb.id.equals(b.node.id)||jc.cp<=aa||-1===aa&&!jc.cp)&&jc.Jb){var Ya=jc.Jb.length-1;for((jc.cp===aa||-1===
aa&&!jc.cp)&&this.VW&&Mb.id.equals(b.node.id)&&(Ya=b.Fb-1);0<=Ya;Ya--){const Mc=jc.Jb.J(Ya),fd=this.Mi.Db(Mc.pe);if(Mc.Oc){if(fd.getValue(wc.a.I6)&&!this.$g.eNa(null!==(R=this.sg.jr.get(null===(y=fd.id)||void 0===y?void 0:y.toString()))&&void 0!==R?R:G.a.nil,Mb.id,!0))continue;return null}if(!fd.getValue(wc.a.I6)||this.$g.eNa(null!==(r=this.sg.As.get(null===(k=fd.id)||void 0===k?void 0:k.toString()))&&void 0!==r?r:G.a.nil,Mb.id,!1))return this.mT(fd)}}}}return null}mT(b){if(!b)return null;this.$g.i1b();
return this.A0.Lxb(b,this.Ax,this.Ci,this.$g,this.us,this,this.dqa,this.qda,this.bvb)}lT(b,k){b=this.fNh(b,k,Kp.VAb(12));if(!b)return null;k=new rb.a;for(let r of b)k.add(r);return k}njl(b,k){const r=Kp.dyl();return this.fNh(Re.a.create(b.node),Re.a.create(k.node),r)}fNh(b,k,r){if(!r||!b&&!k)return null;if(b&&k&&(b.equals(k)||b.node.id.equals(k.node.id))){var y=b.node;if(y&&r(y)){var R;return R=new rb.a,R.add(y),R}}y=Object.assign(new GB,{svi:35,PEi:r});b=b?b.node:null;k=k?k.node:null;R=this.xJl(b,
k);if(!R)return null;k=this.xak(k,r,Kp.Bjh,y);return this.jjl(b,k,R,r,Kp.Bjh,y)}xJl(b,k){return(b=b?this.vUh(b):this.vUh(k))?b.kd(35):this.$g.jEl()}xak(b,k,r,y){if(!b)return null;k(b)||(k=this.kjl(b,k,r,y),k.count&&(b=k.J(k.count-1)));return b}jjl(b,k,r,y,R,aa){b?(b=Wd.GraphIterator.Za(b),b.Ab(7),r=Pm.a.Lr(b,r)):r=Pm.a.Zp(r);R&&r.Xm(R,aa);for(R=new rb.a;r.moveNext()&&(y(r.currentNode)&&R.add(r.currentNode),!k||!r.currentNode.id.equals(k.id)););return R}kjl(b,k,r,y){b=Pm.a.Zp(b);r&&b.Xm(r,y);for(r=
new rb.a;b.moveNext();)k(b.currentNode)&&r.add(b.currentNode);return r}vUh(b){b=Wd.GraphIterator.Za(b);return b.Ab(35)?b:null}x5h(b,k){b=this.lT(b,k);for(let r of b)if((b=this.$g.zff(r))&&b.y6(4))return!0;return!1}N9g(b,k=null,r=!1){if(!b)return!1;var y=b.start,R=b.end;if(!rf.SelectionEditor.ju(y)&&y.contextId!==lc.a.paragraph||!rf.SelectionEditor.ju(R)&&R.contextId!==lc.a.paragraph||!this.VW&&({A1a:y,z1a:R}=this.Uej(b.start,b.end)).returnValue||this.VW&&!({start:y,end:R}=this.Gsk(y,R)).returnValue)return!1;
b.start=y;b.end=R;const aa=this.mem(y,R);if(this.VW){var ta=this.Hea(b.start,b.end,3);var Ya=this.Hea(b.start,b.end,2)}else ta=this.$P(b.start,b.end,3),Ya=this.$P(b.start,b.end,2);const xb=ta&&0<ta.count?ta.J(0):null,Mb=Ya&&0<Ya.count?Ya.J(0):null;if(r)return this.yNc(b,0,ta)?!0:!1;if(this.yNc(b,0,ta)){r=(r=Object(ia.a)(XA,this.JBl(b.start)))?this.$g.Gu(r.objectId):null;Ya=this.$g.t3j(b,xb,r,Ya,b.su,b.Oz,k);this.Oj.D9b(Ya);if(b.Tf)for(y=this.lT(b.start,b.end),R=0;R<y.count;R++)this.VW?(r=xb?xb.objectId:
null,ta=this.cUh(r,y.J(R),!0),this.us.Cra(y.J(R),Ya.id,0,!0,!0,void 0,void 0,void 0,void 0,ta),r=this.cUh(r,y.J(R),!1),this.us.Cra(y.J(R),Ya.id,y.J(R).characterData.length,!0,!1,void 0,void 0,void 0,void 0,r)):(this.us.Cra(y.J(R),Ya.id,0,!0,!0),this.us.Cra(y.J(R),Ya.id,y.J(R).characterData.length,!0,!1));else this.VW?(r=-1===y.Fb?0:y.Fb,this.us.Cra(b.start.node,Ya.id,y.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.us.Cra(b.end.node,Ya.id,R.cpEnd,!1,!1,void 0,void 0,void 0,void 0,aa?r+1:R.Tb)):
(this.us.Cra(b.start.node,Ya.id,b.start.cpBegin,!1,!0),this.us.Cra(b.start.node,Ya.id,b.start.cpEnd,!1,!1));k||this.$g.kLn(Ya,b.Tf,b.id,this.$g.m4b(this.$g.Gu(b.su)));b.objectId=Ya.id;k=this.$g.qta().currentNode;k.hasProperty(wc.a.hCc)||k.setValue(wc.a.hCc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);xb&&this.Djj(xb.contentControlNode,b);Mb&&this.Djj(Ya,Mb);aa&&this.ga.Xb(Wa.a.O0f,2,b.id);return!0}return!1}deleteContentControl(b){if(!this.yNc(b,3))return v.ULS.sendTraceTag(528537614,
368,15,"Invalid content control to delete"),!1;if(this.Oj.h3c(b.contentControlNode))return!0;b.fO&&(b.fO=!1);const k=this.hb.ib.kb;b=b.lE();const r=new lj.Selection(b.toArray(),!0);let y=!1;this.hb.EJb(()=>{this.hb.setSelection(r);if(32===this.ga.processAction(Wa.a.XG,2)){if(this.y6g.instance){const R=this.y6g.instance.LVh(k,r,this.hb.ib.kb);this.hb.Wio(new uC.SelectionCollection([R],0))}y=!0}});return y}eEa(b,k=!1){if(this.yNc(b,2)){if(b.fO)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),
this.deleteContentControl(b);const r=cs.a.tA?b.contentControlNode:this.$g.Gu(b.objectId);let y=new rb.a;k&&(y=b.ybf());y.add(b);if(!this.Oj.h3c(b.contentControlNode)){r&&r.anchor&&this.$g.Ezh(r,k);for(let R of y)b=this.lT(R.start,R.end),this.us.kUk(b,R.objectId);this.rKi(y)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}$1i(b,k){if(this.yNc(b,1)){let Ya=!1;k||(Ya=!0,{rWn:r,returnValue:k}=
this.rJc(b),r&&this.$g.qta().currentNode.setValue(wc.a.hCc,k));var r=b.ePh().toArray();for(var y=0;y<r.length;y++)this.eEa(r[y],!0);k=this.p3n(k);if(b.Tf){y=this.lT(b.start,b.end);if(!y.count)return!1;if(1===y.count&&n.AFrameworkApplication.qF)k=k.join(" "),this.us.replaceTextRange(Re.a.createTextRange(y.J(0),0,y.J(0).characterData.length),k);else{var R=this.$g.rFl(y.J(0));r=y.J(0).t2b();y=this.$g.Szh(y);y=this.$g.$9g(R,y,k.length);for(R=0;R<y.count;R++){this.us.replaceTextRange(Re.a.createTextRange(y.J(R),
0,0),k[R]);for(var aa=0;aa<r.count;aa++)this.us.Cra(y.J(R),r.J(aa),0,!0,!0),this.us.Cra(y.J(R),r.J(r.count-aa-1),y.J(R).characterData.length,!0,!1)}b.Hoo(y.J(0).id,y.J(y.count-1).id);k=this.Dy.xe(y.J(0),0);this.hb.setSelection(k)}}else{R=0;1<k.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");r=b.start;y=r.node;for(var ta=0;ta<y.qa.length&&r.contextId===lc.a.Hd;ta++)if(aa=y.qa.J(ta),aa.cp===r.cpBegin&&aa.blob){R++;
for(ta+=1;ta<y.qa.length;ta++)if(aa=y.qa.J(ta),aa.cp>r.cpBegin&&aa.cp<=r.cpEnd)if(aa.blob)R++;else break;else if(aa.cp>r.cpEnd)break;break}if(0<R&&R+r.cpBegin<r.cpEnd)y=Re.a.createTextRange(r.node,r.cpBegin,r.cpBegin+R),r=Re.a.createTextRange(r.node,r.cpBegin+R,r.cpEnd),this.us.replaceTextRange(r,k[0]),this.us.replaceTextRange(y,"");else if(0<R&&R+r.cpBegin===r.cpEnd)for(this.us.replaceTextRange(b.start,k[0]),k=0;k<y.qa.length;k++){if(R=y.qa.J(k),R.cp===r.cpBegin){R.blob=null;break}}else n.AFrameworkApplication.qF?
(k=k.join(" "),this.us.replaceTextRange(b.start,k)):this.us.replaceTextRange(b.start,k[0])}this.ksd(b,Ya);let xb;this.ygn((xb=new rb.a,xb.add(b),xb));return!0}return!1}ksd(b,k){const r=this.us.jHd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(!r)v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(gh.a.instance.J(10)){const y=this.$g.Gu(b.objectId);if(k){k=this.DC.Sx(b.start.node);let R=k.wh(Kp.y7m);R||(R=k.Bta(Kp.x7m));R&&(this.ng.hka(r.formatting),
this.ng.Skb(r.formatting,R));y&&(b.fO=!0)}else y&&b.fO&&(this.yAn(b,r),b.fO=!1)}}yAn(b,k){b=this.$g.Gu(b.objectId);let r=null;b&&(r=b.ia(wc.a.iCc,G.a.nil));this.ng.hka(k.formatting);r&&!r.equals(G.a.nil)&&(b=this.Ci.value.Db(r),k.formatting=b)}rJc(b){let k=!1;b=b.a0d;this.$mm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,k=!0);return{returnValue:b,rWn:k}}Cqn(b,k=!0){this.qda&&(k&&this.yqn(b),this.Gqn(b))}Dqn(b){if(this.qda&&(b=this.$P(b,b,4)))for(let k of b)this.eEa(k,!1)}gTm(b,
k){if(k&&!b.Oc&&(this.$g.i1b(),(b=b.Ob.paragraph.Mc.Db(b.pe))&&b.anchor)){this.$g.Ezh(b);b=this.A0.Lxb(b,this.Ax,this.Ci,this.$g,this.us,this,this.dqa,this.qda,this.bvb);let r;this.rKi((r=new rb.a,r.add(b),r))}}OAi(b,k){this.$g.i1b();b=this.$g.Gu(k.pe);const r=this.mT(b);if(r&&r.Sd()&&r.removeWhenEdited){const y=this.Hc.Rc(7);y.Eb(b);this.eEa(r,!1);k.state=2;y.dispose()}}CBi(b,k){this.$g.i1b();b=this.$g.Gu(k.pe);this.qcm(b)&&(b=b.ia(wc.a.My,0),this.ga&&(this.ga.Xb(Wa.a.O0f,2,b),Kp.Rd.zQe()))}qcm(b){return b&&
b.isConnected&&!b.ia(wc.a.V5,!1)?this.Bci(b):!1}Bci(b){b=this.A0.Lxb(b,this.Ax,this.Ci,this.$g,this.us,this,this.dqa,this.qda,this.bvb);if(!b.Sd())return!1;if(b.Tf){if(b.su.toString()===b.Oz.toString()){var k=this.$g.Gu(b.su);if(!k)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===k.type&&1===k.qa.length)return this.yci(k.qa.J(0),b.objectId)}}else{k=b.start;if(!k)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(k.cpBegin===k.cpEnd)return k=this.$g.Gu(b.su).qa.ii(k.cpBegin),this.yci(k,b.objectId)}return!1}yci(b,k){b=b?b.Jb:null;if(!b)return!1;const r=b.zI(k,!0);return-1<r&&r+1<b.length&&b.J(r+1).pe.toString()===k.toString()}Wmn(b){this.lEe.push(b)}I8i(b,k){if(void 0===b||null===b||b.contextId!==lc.a.Hd)return null;b=Re.a.Uc(b.node,k?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<ie.ParagraphReader.textLength(b.node)?this.$g.kQa(b):null}select(b,k){if(b&&!b.equals(G.a.nil)){var r=this.$g.Gu(b);if(r&&
55===r.type){r=this.mT(r);if(r.Tf)r=this.$kl(r);else{r=r.start;if(!r)return;r=this.Dy.fo(r)}r&&r.length&&(this.XZi(r.Qa,b,k,!0,!0),this.XZi(r.Tc,b,k,!1,!1),this.hb.setSelection(r))}}}ZFn(b,k){if(!rf.SelectionEditor.zf(b)||b.Fb!==b.Tb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Fo.uYa(b.node,b.cpBegin,r,!k))&&k===b.Oc?(k=this.mT(b.contentControlNode),this.select(b.pe,!k.isEditable),!0):!1}$kl(b){var k=this.$g.xLa(b.su,!0);b=this.$g.xLa(b.Oz,!1);if(!k||!b)return null;k=this.njl(Re.a.create(k),Re.a.create(b));
if(!k||!k.count)return null;b=new rb.a;for(let r=0;r<k.count;r++){let y;if(12===k.J(r).type)y=r===k.count-1?Re.a.createTextRange(k.J(r),0,ie.ParagraphReader.textLength(k.J(r))):Re.a.create(k.J(r)),this.hh&&(y.Fb=this.hh.Aq(y.node,!0),y.Tb=this.hh.Aq(y.node,!1));else if(15===k.J(r).type)y=Pv.TableNodeContext.create(k.J(r));else continue;b.add(y)}return new lj.Selection(b.toArray(),!0)}HKn(b){if(b&&!b.equals(G.a.nil)&&(this.$g.i1b(),(b=this.$g.Gu(b))&&55===b.type&&b.isConnected)){var k=b.ia(wc.a.V5,
!1);b.setValue(wc.a.V5,!1);k&&this.Qln(b)}}Qln(b){var k,r;const y=null!==(r=this.sg.jr.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==r?r:G.a.nil;y.equals(G.a.nil)||(k=this.$g.rla(y,!0))&&(b=this.us.$cf(k,b.id,!0))&&0<b.count&&(b=b.J(0),k=b.Ob,k.formatting=b.YP?b.YP.Yf(k):new wB.a(k,G.a.nil))}iOi(b){if(b=this.aQh(b))for(let k of b)k.fO=!1,this.eEa(k,!1)}Jol(b){const k=new rb.a;if(b=this.aQh(b))for(let r of b)k.add(r.contentControlNode);return k}Eqn(b){if(b&&(11===b.type||14===b.type||
15===b.type||16===b.type)){var k=this.fb.Rm(b),r=this.fb.dK(b);if(this.hh&&k&&r){b=this.hh.Aq(k,!0);const y=this.hh.Aq(r,!1);k=Re.a.create(k);r=Re.a.create(r);k.Fb=b;r.Tb=y;if(b=this.Hea(k,r,4))for(let R of b)this.eEa(R,!1)}}}qjl(b){var k,r,y,R;const aa=null!==(r=this.sg.jr.get(null===(k=b.id)||void 0===k?void 0:k.toString()))&&void 0!==r?r:G.a.nil;b=null!==(R=this.sg.As.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&void 0!==R?R:G.a.nil;if(aa.equals(G.a.nil)||b.equals(G.a.nil))return new rb.a;
y=this.$g.rla(aa,!0);R=this.$g.rla(b,!1);return y&&R?this.lT(Re.a.create(y),Re.a.create(R))||new rb.a:new rb.a}xLa(b,k){return this.$g.xLa(b,k)}iff(b,k){if(b&&55===b.type&&(b=this.mT(b),b=k?b.start:b.end)){const r=Re.a.Uc(b.node,k?b.gl:b.zt);r.Fb=r.Tb=(k?b.Fb:b.Tb)+(k?-1:1);return r}return null}Mol(b){return(b=this.mT(b))?b.start:null}XZi(b,k,r,y,R){if((b.contextId===lc.a.Hd||b.contextId===lc.a.Wc||b.contextId===lc.a.paragraph)&&(R=b.node.qa.ii(R?b.gl:b.zt))&&R.Jb)for(let aa=0;aa<R.Jb.length;aa++){const ta=
R.Jb.J(aa);if(ta.pe.equals(k)&&ta.Cq)if(y&&ta.Oc){b.Fb=r?aa:aa+1;break}else if(!y&&!ta.Oc){b.Tb=r?aa+1:aa;break}}}ygn(b){for(let k=0;k<this.pYg.length;++k)(0,this.pYg[k])(this,new YA(b))}rKi(b){for(let k=0;k<this.lEe.length;++k)(0,this.lEe[k])(this,new YA(b))}Gqn(b){b=Re.a.create(b);if(b=this.$P(b,b,4))for(let k of b)k.Tf||this.eEa(k,!1)}yqn(b){if(b=b.t2b())for(let r=0;r<b.count;r++){var k=this.$g.Gu(b.J(0));k=this.A0.Lxb(k,this.Ax,this.Ci,this.$g,this.us,this,this.dqa,this.qda,this.bvb);this.eEa(k)}}pjl(b){return this.lT(b,
null)}yNc(b,k,r=null){let y=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",k,b.isSupported,b.pfa));if(!cs.a.tA&&this.Cya&&gh.a.instance.J(3)&&this.Cya.gX(this.Ax.value))return v.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.rjm(k)&&this.sjm(k)&&!this.rcm(b))return!1;if(!r){const ta=
this.mFl(b);ta&&(r=new rb.a,r.add(ta))}var R=this.$g.bXh(b.start.node);const aa=this.$g.bXh(b.end.node);if(R&&aa&&!R.equals(aa)||!R&&aa||R&&!aa)return!1;R=!0;if(r&&0<r.count){if(!r.J(0).isSupported)return!1;R=r.J(0).isEditable}switch(k){case 0:y=this.U$l(b,R);break;case 1:y=(this.iaa||!this.Jrf(b))&&b.isSupported&&b.isEditable&&this.Ueh(b)&&this.Cci(b);n.AFrameworkApplication.qF||(y=y&&!this.x5h(b.start,b.end));break;case 2:const ta=b.mom?!0:b.isSupported;y=(this.iaa||!this.Jrf(b))&&ta&&b.pfa&&R;
v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:y=b.isSupported&&b.pfa&&R&&this.Ueh(b)&&this.Cci(b)&&!this.x5h(b.start,b.end)}}catch(aa){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+k+", Exception: "+aa),y=!1}return y}sjm(b){n.AFrameworkApplication.qF&&n.AFrameworkApplication.Ne("7gbeh287;7cff7940");return!(n.AFrameworkApplication.qF&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.skipNestedCCCheck",!1)&&
1===b)}rjm(b){return!(this.VW&&(!b||2===b||3===b))}U$l(b,k){let r=!0;if(!this.iaa&&this.Jrf(b))r=!1;else if(this.VW)this.VW?b.Tf||rf.SelectionEditor.ju(b.start)||b.start.contextId===lc.a.endOfParagraph?b.Tf&&(b.start.contextId!==lc.a.paragraph&&b.start.contextId!==lc.a.endOfParagraph||b.end.contextId!==lc.a.paragraph&&b.end.contextId!==lc.a.endOfParagraph)&&(r=!1):r=!1:r=k?this.Xam(b):!1;else if(!(b.Tf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))r=!1;else if(b.Tf&&(b.start.contextId!==
lc.a.paragraph||b.end.contextId!==lc.a.paragraph||b.start.equals(b.end)&&!ie.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===lc.a.Wc||b.end.contextId===lc.a.Wc||b.start.contextId===lc.a.endOfParagraph||b.end.contextId===lc.a.endOfParagraph)r=!1;return r}aQh(b){if(!b||!b.length)return null;const k=b[0];b=b[b.length-1];this.hh&&(this.fb.em(k)&&12===k.node.type&&(k.Fb=this.hh.Aq(k.node,!0)),this.fb.em(b)&&12===b.node.type&&(b.Tb=this.hh.Aq(b.node,!1)));return this.Hea(k,b,
4)}Ueh(b){b=b.ybf();for(let k of b)if(!k.isSupported||!k.pfa)return!1;return!0}rcm(b){if(this.Uej(b.start,b.end).returnValue)return!1;const k=this.$P(b.start,b.end,2);if(!k)return!0;for(let r of k)if(!r.objectId.equals(b.objectId)&&(r.Tf&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===ie.ParagraphReader.textLength(r.end.node)))||!r.Tf&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?
r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===ie.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Cci(b){if(b.Tf){var k=this.$g.Gu(b.su),r=this.$g.Gu(b.Oz);let y=null;if(12===k.type&&12===r.type){k=this.$g.m4b(k);k=this.$g.Gu(k);r=this.$g.m4b(r);r=this.$g.Gu(r);if(!k||!r)return!1;16===k.type&&16===r.type&&k.id.equals(r.id)&&(y=k)}b=this.lT(b.start,b.end);if(!b.count)return!1;for(let R of b)if(b=
this.$g.m4b(R),b=this.$g.Gu(b),!b||!(16!==b.type||y&&b.id.equals(y.id)))return!1}return!0}Jrf(b){return b.Tf?!1:(b=b.start.node)?!b.ia(wc.a.N6b,!0):!0}Xam(b){if(b.Tf){var k=this.$g.Gu(b.su);b=this.$g.Gu(b.Oz);if(Ei.TableCellReader.wua(k)||Ei.TableCellReader.wua(b)||bm.a.Nma(k)||bm.a.Nma(b))return!1;k=this.$g.m4b(k);k=this.$g.Gu(k);b=this.$g.m4b(b);b=this.$g.Gu(b);if(!k||!b||(16===k.type||16===b.type)&&!k.id.equals(b.id))return!1}return!0}mFl(b){if(!b)return null;b=this.$g.Gu(b.objectId);if(!b)return null;
b=b.ia(wc.a.U5,G.a.nil);return b.equals(G.a.nil)?null:(b=this.$g.Gu(b))?this.mT(b):null}gNh(b){return this.lT(null,b)}p3n(b){return(b||"").split(RegExp("\r\n|\r|\n"))}$mm(b){return b&&""!==b?!1:!0}cUh(b,k,r){k=k.qa.ii(r?0:k.characterData.length);if(!k)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!k.Jb||!k.Jb.length)return 0;if(!b)return r?0:k.Jb.length;for(let y=0;y<k.Jb.length;y++){const R=k.Jb.J(y);if(G.a.Jp(R.pe,b)&&R.Oc===r)return r?
y+1:y}return r?0:k.Jb.length}Gsk(b,k){var r=b.node,y=k.node,R=b.contextId===lc.a.paragraph?0:b.cpBegin,aa=k.contextId===lc.a.paragraph?ie.ParagraphReader.textLength(y):k.cpEnd;r=this.Fo.r6(r,R,b.Fb);y=this.Fo.r6(y,aa,k.Tb);aa=!r||!r.count;R=!y||!y.count;if(aa&&R)return{returnValue:!0,start:b,end:k};if(aa)return{returnValue:this.lce(b,y.J(y.count-1).pe,!0),start:b,end:k};if(R)return{returnValue:this.lce(k,r.J(r.count-1).pe,!1),start:b,end:k};if(r.count===y.count)return r=r.J(r.count-1),y=y.J(y.count-
1),{returnValue:r.pe.equals(y.pe),start:b,end:k};r=(aa=r.count<y.count)?y.J(y.count-1):r.J(r.count-1);return{returnValue:aa?this.lce(b,r.pe,!0):this.lce(k,r.pe,!1),start:b,end:k}}lce(b,k,r){var y=b.node;let R;if(r){R=b.contextId===lc.a.paragraph?0:b.cpBegin;var aa=b.Fb}else R=b.contextId===lc.a.paragraph?ie.ParagraphReader.textLength(y):b.cpEnd,aa=b.Tb;y=y.qa.ii(R);if(-1===aa||!y||!y.Jb||!y.Jb.length)return!1;y=y.Jb;if(r)for(r=aa;r<y.length;r++){aa=y.J(r);if(!aa.Oc)break;if(aa.pe.equals(k))return b.Fb=
r+1,!0}else for(r=aa-1;0<=r;r--){aa=y.J(r);if(aa.Oc)break;if(aa.pe.equals(k))return b.Tb=r,!0}return!1}mem(b,k){return this.ogk(b,k)&&b.Fb===b.Tb&&(b.contextId===lc.a.Wc||b.contextId===lc.a.paragraph&&!b.node.characterData.length)}ogk(b,k){return b.equals(k)&&b.Fb===k.Fb&&b.Tb===k.Tb}Djj(b,k){var r,y,R,aa,ta,Ya;if(b&&k.Tf){var xb=null!==(y=this.sg.jr.get(null===(r=b.id)||void 0===r?void 0:r.toString()))&&void 0!==y?y:G.a.nil;r=this.$g.rla(k.su,!0);xb.equals(r?r.id:null)&&this.sg.jr.set(null===(R=
b.id)||void 0===R?void 0:R.toString(),k.objectId);R=null!==(ta=this.sg.As.get(null===(aa=b.id)||void 0===aa?void 0:aa.toString()))&&void 0!==ta?ta:G.a.nil;aa=this.$g.rla(k.Oz,!1);R.equals(aa?aa.id:null)&&this.sg.As.set(null===(Ya=b.id)||void 0===Ya?void 0:Ya.toString(),k.objectId)}}static get Rd(){return null!=Kp.ktg?Kp.ktg:Kp.ktg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static VAb(b){return k=>k.type===b}static dyl(){return b=>12===b.type||15===b.type}static Bjh(b,
k){return b.Le===k.svi||b.parentNode&&k.PEi(b.parentNode)?!1:!0}}Kp.y7m="Placeholder Text";Kp.x7m="Placeholder Text";Object(m.a)(Kp,"ContentControlOperator",null,[636,10,637]);class ZA{constructor(b,k,r){this.Yc=b;this.Ax=k;this.DTb=r}r2h(b){const k=this.hyl();return k&&b&&this.sSl(k,b)?this.RQl(k):null}sSl(b,k){if(!b)return!1;do{const r=b.currentNode;if(!r)break;if(r.ia(wc.a.pSl,null)===k)return!0}while(b.yf(29));return!1}RQl(b){var k=b.Pb(1);b.mc();b=b.oE(1);if(!k||!b)return null;k=Ke.SelectionFactory.zwh(k,
b);b=rf.SelectionEditor.Qj(k,!1,!1);return Ke.SelectionFactory.KB(k,b.Tc)}hyl(){const b=this.Yc.Ck();b.set(this.Ax.value);this.DTb.DQ(b);return b.Pb(28)&&b.Pb(29)?b:null}}Object(m.a)(ZA,"GlossaryNavigator",null,[634]);class hv{constructor(b,k,r,y,R,aa){this.us=b;this.$g=k;this.qm=r;this.fb=y;this.vh=R;this.qda=aa}i_c(b,k,r){if(!this.qda)return 1;if(!({tableNode:R}=this.suf(b)).returnValue||!this.vh.gji(R,k)||this.fOi(b,k))return 2;var y=this.vh.hNh(k);var R=y.J(0).t2b();R&&R.count||(R=new rb.a,R.add(b.objectId));
b=this.$g.Szh(y);r=r.split("\n");k=Object(ia.a)(Wd.GraphIterator,this.$g.zff(k));k=this.$g.$9g(k,b,r.length);for(b=0;b<k.count;++b){y=k.J(b);this.us.replaceTextRange(Re.a.createTextRange(y,0,0),r[b]);for(let aa=0;aa<R.count;++aa)this.us.Cra(y,R.J(aa),0,!0,!0),this.us.Cra(y,R.J(R.count-aa-1),y.characterData.length,!0,!1)}return 0}fOi(b,k){if(!this.qda)return 1;let r;if(!({tableNode:r}=this.suf(b)).returnValue||!this.vh.gji(r,k))return 2;k=this.vh.hNh(k);if(0<k.count&&(k=this.qm.$P(Re.a.create(k.J(0)),
Re.a.create(k.J(k.count-1)),2)))for(let y of k)if(y.id!==b.id&&!this.qm.eEa(y,!0))return 2;return 0}c8b(b){if(!this.qda||!({tableNode:r}=this.suf(b)).returnValue)return!1;b=b.ybf();for(var k of b)if(!k.pfa||!k.isSupported)return!1;if(this.vh.gcm(r))return!1;var r=Object(ia.a)(Wd.GraphIterator,this.$g.zff(r));k=new rb.a;this.fb.peb(r,!0,!1,k);for(let y of k)if(0<y.ia(wc.a.Dzb,0)||this.fb.WYa(y).Cw)return!1;return!0}suf(b){let k=null;return b&&b.su.toString()===b.Oz.toString()&&b.Sd()&&b.isEditable&&
b.isSupported?(k=this.$g.Gu(b.su))&&14===k.type?{returnValue:!0,tableNode:k}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:k}}}Object(m.a)(hv,"TableContentControlEditor",null,[635]);class dz{gcm(b){let k=!1;const r=new Wd.GraphIterator;r.set(b);bf.forEachCellInTable(r,y=>{if(!Ei.TableCellReader.gg(y)){let R=af.OutlineNavigator.f7(y);for(;R;){if(Ag.OutlineElementReader.eLd(y))return k=!0,!1;R=y.xi(1)}}return!0});return k}gji(b,k){const r=new Wd.GraphIterator;r.set(k);return Ei.TableCellReader.wua(k)&&
r.Ab(14)&&r.kd(14).id===b.id?!0:!1}hNh(b){const k=new rb.a,r=new Wd.GraphIterator;r.set(b);b=new rb.a;ie.ParagraphReader.peb(r,!0,!1,b);for(let y of b)k.add(y);return k}}Object(m.a)(dz,"TableReader",null,[426]);class f{constructor(){this.qm=null}get name(){return"WordEditor.ContentControl"}init(){n.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(Wz.a.dPa(Object(u.a)(Va.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Va.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").gTm,
"onContentControlRangeChanged")),this.qm=Va.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator"),cs.a.ACa&&Va.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init())}dispose(){this.qm&&(this.qm.dispose(),this.qm=null)}zc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new fu.a(Qe.a.kf)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new cz(Va.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
b.ha("WordEditor.ContentControlNodeFactory",()=>new WA(Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.$a("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new gu(new cg.a(()=>Ka.App.xa.jb.Xc),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),new Io.a,lk.PageNavigator.instance,Va.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Va.a.instance.resolve("Box4.IOutlineEditor"),Va.a.instance.resolve("Box4.IOutlineElementEditor"),
Va.a.instance.resolve("Box4.IParagraphReader"),Va.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new ZA(new Io.a,new cg.a(()=>Ka.App.xa.jb.Xc),lk.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",
()=>new Kp(new cg.a(()=>Ka.App.xa.jb.Xc),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Va.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),bh.a.instance,Va.a.instance.resolve("Box4.ISelectionFactory"),De.PageReader.instance,Va.a.instance.resolve("Box4.IFormattingEditor"),Va.a.instance.resolve("Box4.Styles.IWACStyleReader"),n.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),
Va.a.instance.Pa("Box4.IContentControlDataChangedManager"),n.AFrameworkApplication.ya,Va.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),n.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Va.a.instance.resolve("Box4.IContentControlChpHelper"),Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.Pa("Box4.IContentControlReader"),Va.a.instance.resolve("Box4.IParagraphReader"),Va.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Va.a.instance.$a("Box4.Actors.IVirtualSelectionMerger"),Va.a.instance.resolve("Box4.IFeatureHelper"),Va.a.instance.resolve("Box4.ContentControlParagraphMapping"),Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlManager",()=>new Cu(new cg.a(()=>Ka.App.xa.jb.Xc),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
Va.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Va.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",
()=>new FB(Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.resolve("Box4.IParagraphReader"),Va.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new hv(Va.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Va.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
Va.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Va.a.instance.resolve("Box4.IParagraphReader"),new dz,n.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();n.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ha("Box4.ContentControlConverter",()=>new Yz(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();cs.a.ACa&&b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new EB(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance()}static main(){M.a.instance.Pc(new f)}}
Object(m.a)(f,"ContentControlPackage",null,[1,2]);var w=c(1368),D=c(1675);class Z extends Sys.EventArgs{constructor(b,k,r){super();this.definition=b;this.source=k;this.fDk=r}}Object(m.a)(Z,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class na extends Sys.EventArgs{constructor(b,k){super();this.definition=b;this.source=k}}Object(m.a)(na,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class Ha{constructor(b,k,r,y,R,aa,ta=!1,Ya=null,xb=null,Mb=null,cc=!1,jc=null,Mc=!1,fd=!0,Td=null,ne=!1,ye=9){this.target=this.container=
this.menu=null;this.isDismissed=!1;this.DTc=this.oTc=this.qHh=this.onScroll=this.onResize=this.i_=this.bva=this.yDa=this.documentElement=this.joa=this.editingElement=null;this.isFocused=!1;this.Izd=null;this.DLf=this.Vqf=!1;this.tde=null;this.z0d=0;this.paragraphNode=b;this.cpBegin=k;this.cpEnd=r;this.definition=y;this.P1j=R;this.wNa=aa;this.QKa=ta;this.G5i=Ya;this.Rka=xb;this.hostServices=Mb;this.lZn=cc;this.CDi=jc;this.S5i=Mc;this.UYk=fd;this.qHh=Td;this.showDictationCommandUx=ne;this.source=ye}}
Object(m.a)(Ha,"UxManagerState",null,[]);var eb=c(1555);class yb{constructor(b){this.contextualIntentInvocationSource=9;this.contextualIntentInvocationSource=b}}Object(m.a)(yb,"UxManagerMenuActionTelemetryData",null,[]);class Qb{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.Ub=b;this.hb=k;this.nz=r;this.Zc=y;this.le=R;this.Hb=aa;this.Ti=ta;this.Lj=Ya;this.mS=xb;this.JOb=Mb;this.LHe=!1;this._state=this.NMg=null;this.shouldIgnoreFocusEvent=cc=>{var jc;return this.Zc.yd.Qv&&!this.Zc.yd.cO&&cc===(null===
(jc=this.Zc.editingView)||void 0===jc?void 0:jc.editingElement)};this.sa=new Fe.a;this.Uvc=new Fc.a;this.hrd((cc,jc)=>{Qb.aBm(r,jc.definition,jc.source)});this.kah((cc,jc)=>{Qb.$Am(r,jc.definition,jc.source,jc.fDk)});this.Ub.re(Qb.wDd).XL=!0}hrd(b){this.sa.addHandler(Qb.kAf,b)}lTf(b){this.sa.removeHandler(Qb.kAf,b)}Ugn(b,k){this.sa.raiseEvent(Qb.kAf,new na(b,k))}kah(b){this.sa.addHandler(Qb.jAf,b)}Stn(b){this.sa.removeHandler(Qb.jAf,b)}Tgn(b,k,r){this.sa.raiseEvent(Qb.jAf,new Z(b,k,r))}ipo(b){var k;
if(!b.isDismissed&&b.joa){var r=eb.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=eb.b(r);var y=Qe.a.getElementBounds(b.joa);r.width||r.height?r.x+r.width<y.x||r.x>y.x+y.width||r.y+r.height<y.y||r.y>y.y+y.height?this.dismiss():(y=b.target,y.style.left=r.x+"px",y.style.top=r.y+"px",y.style.width=r.width+"px",y.style.height=r.height+"px",null===(k=b.menu)||void 0===k?void 0:k.updatePosition(),b.menu||v.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):(v.ULS.sendTraceTag(50968328,
341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}lKi(b){b.isDismissed||b.tde||(b.tde=new nd.a(2,1,1,()=>{b.tde=null;this.ipo(b)},147),this.Hb.fc(b.tde))}yDa(b,k){!b.isDismissed&&b.UYk&&0<k.tU.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}Ebk(b){return!!b&&b.id===Qb.T1j}bva(b,k){if(b.isDismissed||!k||!k.Ib)return!1;
k=k.Ib;const r=k.keyCode,y=!b.isFocused&&!!b.menu,R=k.altKey||k.ctrlKey||k.shiftKey;let aa=!1;r===tb.a.h0?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),aa=!0):r!==tb.a.hs&&r!==tb.a.px||!y||R||!this.Ebk(b.definition)?r!==tb.a.YMb&&r!==tb.a.B4c||!y||R||(this.OOf(b),b.menu?(b.menu.focus(),aa=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):(b.menu.executeDefaultAction(),
v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),aa=!0);aa&&(k.preventDefault(),k.stopPropagation());return aa}oTc(b,k){if(b.isDismissed||!b.menu)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(k);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}DTc(b,k){if(b.isDismissed||!b.menu)return v.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(k);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}i_(b,k){if(b.isDismissed||!k||!k.Ib||!b.menu)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!k,!(null===k||void 0===
k?0:k.Ib),!b.menu),!1;const r=b.target;b=b.menu.getElementBounds();var y=k.Ib;k=y.clientX;y=y.clientY;r&&Qb.nGi(k,y,Qe.a.getElementBounds(r),16)||b&&Qb.nGi(k,y,Qb.vlk(b),4)||this.dismiss();return!1}uTn(b){var k=eb.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!k||!k.length)return!1;k=eb.a(k,"OfficeContextualTarget");if(!k)return!1;b.container=Qb.LCc();b.target=k;b.editingElement=this.Zc.editingView.editingElement;b.joa=this.Zc.yd.container;b.documentElement=document.documentElement;b.yDa=(r,y)=>{this.yDa(b,
y)};b.bva=r=>this.bva(b,r);b.i_=r=>this.i_(b,r);b.onScroll=()=>{this.lKi(b)};b.onResize=()=>{this.lKi(b)};b.showDictationCommandUx&&(b.oTc=r=>this.oTc(b,r),b.DTc=r=>this.DTc(b,r),this.JOb&&this.JOb.execute(r=>{r.UOn(b.oTc);r.WOn(b.DTc)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.tB(b.yDa);this.Ti.$Y(b.onResize);this.le.mb(Kb.a.aI,b.editingElement,b.bva);b.QKa&&this.Lj.mb(Kb.a.Jaa,b.documentElement,b.i_);Af.a.addHandler(b.joa,"scroll",b.onScroll);b.wNa||this.OOf(b);
return!0}TBb(b,k){const r=!!b.menu;this.Tgn(b.definition,b.source,k);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Ub.pg.name===Qb.wDd&&this.Ub.RQ(Qb.wDd);b.yDa&&this.hb.Iga(b.yDa);b.bva&&b.editingElement&&this.le.sc(Kb.a.aI,b.editingElement,b.bva);this.JOb&&this.JOb.execute(y=>{b.showDictationCommandUx&&(y.czn(),y.dzn());y.j0i(!1,b.showDictationCommandUx)});b.i_&&b.documentElement&&b.QKa&&this.Lj.sc(Kb.a.Jaa,b.documentElement,
b.i_);b.onScroll&&b.joa&&Af.a.removeHandler(b.joa,"scroll",b.onScroll);b.onResize&&this.Ti.mba(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.joa=null;b.yDa=null;b.bva=null;b.i_=null;b.onScroll=null;b.onResize=null;b.oTc=null;b.DTc=null;r&&b.Rka&&(b.Vqf?b.DLf=!0:b.Rka(b.Izd))}pZa(b,k){var r;if(!k)return!1;switch(k.actionType){case hb.b.Toggle:if(k.objectFulfillment===Qb.obo)return this.LHe=!this.LHe,this.r9f(),this.kEc(b),!0;
if(k.objectFulfillment===Qb.sbo)return{value:r}=this.Uvc.Bc(k.suggestionGroup.type,!1),this.Uvc.Z(k.suggestionGroup.type,!r),this.kEc(b),!0;break;case hb.b.GiveFeedback:if(D.a.wdm(null===(r=k.suggestionGroup)||void 0===r?void 0:r.type))break;this.focus();this.r9f();this.kEc(b);return!0;case hb.b.RevealSuggestions:this.kEc(b)}b.Vqf=!0;k=b.P1j.executeAction(k,b.paragraphNode,b.cpBegin,b.cpEnd);b.Vqf=!1;k&&this.kEc(b);b.DLf&&(b.DLf=!1,b.Rka(b.Izd),b.Izd=null);return k}kEc(b){b.i_&&b.documentElement&&
b.QKa&&(this.Lj.sc(Kb.a.Jaa,b.documentElement,b.i_),b.QKa=!1)}eXn(b,k){return!(0<=b.positionInSet&&0<b.setSize)&&!k}Nfj(b){var k;if(this.uTn(b)){var r=1;n.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var y=!1;0<(null===(k=b.definition.suggestionGroups)||void 0===k?void 0:k.length)&&(y=b.definition.suggestionGroups[0].type,y=this.Uvc.ub(y)?this.Uvc.J(y):b.lZn);k=!1;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(k=!0);const R=n.AFrameworkApplication.ya;r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:aa=>this.pZa(b,aa),onDismiss:aa=>{this.TBb(b,aa)},openCustomDictionaryDialog:()=>R.processAction(Jc.a.t2e,2),keepCurrentFocus:b.wNa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.LHe,showDescription:y,showEditorButton:b.S5i,showEditorBranding:this.eXn(b.definition,b.S5i),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:k,
shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.qHh,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};b.CDi&&b.CDi(r);this.nz.createContextualUi(r).then(aa=>{this.Ugn(b.definition,b.source);b.menu=aa;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.G5i&&b.G5i();this.JOb&&this.JOb.execute(ta=>ta.j0i(!0,b.showDictationCommandUx))}).catch(aa=>{this.TBb(b,{SDo:w.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",
aa)});0<b.z0d&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.z0d)}else 5<++b.z0d?(v.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Hb.fc(new nd.a(2,1,Math.pow(3,b.z0d),()=>{b.isDismissed||this.Nfj(b)},146))}get eO(){return!!this._state&&!this._state.isDismissed}set d7d(b){this.NMg=b}get kim(){return this.NMg}Gii(b){let k=!1;({value:k}=this.Uvc.Bc(b,!1));return k}P8f(b,k){this.eO&&
(this._state.cpBegin=b,this._state.cpEnd=k)}get definition(){return this.eO?this._state.definition:null}set definition(b){this.eO&&(this._state.definition=b,this._state.menu&&this._state.menu.setDefinition(b))}focus(){this.eO&&this._state.menu&&(this._state.isFocused||this.OOf(this._state),this._state.menu.focus())}r9f(){this.eO&&this._state.menu&&this._state.menu.updatePosition()}OOf(b){this.Ub.zK(Qb.wDd,!1);b.isFocused=!0}w3a(b,k,r,y,R,aa=null,ta=null,Ya=null,xb=!1,Mb=null,cc=!1,jc=!0,Mc=null,fd=
!1,Td=9){if(!k||this._state&&!this._state.isDismissed)return!1;let ne,ye;if(!({paragraphNode:ye,start:b,end:ne}=Qb.peo(b)).returnValue)return!1;this._state=new Ha(ye,b,ne,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td);this.Nfj(this._state);return!0}M6d(){this._state&&(this._state.Izd=!0)}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static aBm(b,k,r){r=new yb(r);b.logAction({actionType:hb.b.SessionStart,engagement:hb.a.Try,objectName:Qb.nbj,
objectId:k.id,data:r});if(k.suggestionGroups)for(let y of k.suggestionGroups)b.logAction({actionType:hb.b.Presented,engagement:hb.a.See,objectName:y.type,objectId:y.id,data:r})}static $Am(b,k,r,y){r=new yb(r);b.logAction({actionType:hb.b.SessionEnd,engagement:hb.a.None,objectName:Qb.nbj,objectId:k.id,data:r},y)}static LCc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static vlk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static nGi(b,k,r,y){const R=
r.y-y,aa=r.x+r.width+y,ta=r.y+r.height+y;return r.x-y<=b&&b<=aa&&R<=k&&k<=ta}static peo(b){let k,r;if(!b||!ie.ParagraphReader.nc(b.node)||b.contextId!==lc.a.Wc&&b.contextId!==lc.a.Hd&&b.contextId!==lc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==lc.a.paragraph?(k=b.cpBegin,b=b.cpEnd):(k=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:k,end:b}}mRc(){this.mS&&this.mS.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Qb.T1j=
"ActionSet";Qb.nbj="IntentGroup";Qb.wDd="CanvasContextualUxReact";Qb.obo="Context";Qb.sbo="Description";Qb.kAf="MenuDidOpen";Qb.jAf="MenuDidClose";Object(m.a)(Qb,"UxManager",null,[]);class gc{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}zc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=n.AFrameworkApplication.K.$("EditorGoalsEnabled");
(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(63)||n.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||n.AFrameworkApplication.K.$("RewriteIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:n.AFrameworkApplication.uiCulture,dataCulture:n.AFrameworkApplication.dataCulture,isRightToLeft:n.AFrameworkApplication.isRtl,ulsLogger:new il.a,dimeCallback:()=>Object(gr.__awaiter)(this,void 0,void 0,function*(){this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")}),loadUpsellDependencies:()=>Object(gr.__awaiter)(this,void 0,void 0,function*(){this.W.$a("Common.IInProductMessagingUIManager").execute(k=>
{k.Umi()})}),getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter")})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Qb(Id.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Bb.InteractiveViewManager.instance,bc.KeyInputManager.instance,n.AFrameworkApplication.uc,
n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.U_,this.W.$a("Common.ISystemInitiatedFeedback"),this.W.$a("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:n.AFrameworkApplication.uiCulture,ulsLogger:new il.a})).singleInstance(),
this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new il.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(k=>{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",k)})}dispose(){}static main(){M.a.instance.Pc(new gc)}}Object(m.a)(gc,"PackageManager",null,[1,2]);
class d{constructor(b,k,r,y){this.E7l=(R,aa,ta)=>{R=null;aa.view.ye&&(R=aa.view);if(!R||!R.Cb)return 8;if(!this.zG.Prf())return 2;if(1===ta)return 32;this.ZRj.GKk();return 32};this.ari=(R,aa,ta)=>{let Ya=null;aa.view.ye&&(Ya=aa.view);if(!Ya||!Ya.Cb)return 8;if(!this.zG.Prf())return 2;if(1===ta)return 32;if(1!==this.zG.U3b(this.hb.ib,!0).count)return 2;aa=new sf.GraphTransaction(15);try{if(aa.Eb(Ya.ld),!this.zG.sfo(R===Jc.a.Ezf))return 8}finally{aa&&aa.dispose()}return 32};this.ga=b;this.hb=k;this.zG=
r;this.ZRj=y}Vb(){this.ga.pa(Jc.a.RMd,lc.a.view,this.E7l);this.ga.pa(Jc.a.Ezf,lc.a.view,this.ari);this.ga.pa(Jc.a.bri,lc.a.view,this.ari)}}Object(m.a)(d,"IntelligentPlaceholderActor",null,[]);class t{constructor(){this.gkc=new Fc.a;this.n8c=new Fc.a}D2j(b,k){let r;({value:r}=this.gkc.Bc(b,r)).returnValue||this.gkc.Z(b,r=new Ia.a);r.add(k)}i3j(b,k){this.n8c.ub(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.n8c.Z(b,k)}B2j(b,k,r){this.D2j(b,k);this.i3j(k,r)}ill(b){let k;
return({value:k}=this.gkc.Bc(b,k)).returnValue?k:null}Unl(b){let k;return({value:k}=this.n8c.Bc(b,k)).returnValue?k:null}Ctn(b){let k;if(({value:k}=this.gkc.Bc(b,k)).returnValue){for(let r of k)this.n8c.remove(r);this.gkc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(t,"IntelligentPlaceholderAtMentionManager",null,[649]);var B=c(1602);class T extends B.a{constructor(b,k){super(b,k)}get key(){return"FOLLOW UP"}get qw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}j5i(b){return!b.ia(wc.a.NF,
!1)}Qdb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(T,"IntelligentPlaceholderDetailsProvider",B.a,[]);var da=c(1730),Ja=c(1885),db=c(1734);class Ob{constructor(){this.vxa=""}kfa(b){this.vxa+=b}y$h(b){this.vxa+=b}pof(b){this.vxa+=b}insertImage(b){this.vxa+=b}m$h(b){this.vxa+=b}}Object(m.a)(Ob,"PlainTextFormatCreator",null,[955]);var Sb=c(1546),qc=c(1884);c(383);var cd=c(1601),od=c(1462);class md{constructor(){this.wmc=new Fc.a}contains(b){return this.wmc.ub(md.Avf(b))}add(b){this.wmc.Z(md.Avf(b),
b)}remove(b){this.wmc.remove(md.Avf(b))}hho(b){for(let k of b.wmc)this.add(k.value)}lHh(){const b=new rb.a;for(let k of this.wmc)b.add(k.value.Rj);return b}static Avf(b){return b.Rj.toString()}}Object(m.a)(md,"CommentRangeSet",null,[]);class Ld extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(m.a)(Ld,"OnFollowUpEventArgs",Sys.EventArgs,[]);class we extends Ld{constructor(b,k){super(b);this.w7m=k}}Object(m.a)(we,"OnCreateEventArgs",Ld,[]);class Ze extends Ld{constructor(b,k){super(b);
this.jlm=k}}Object(m.a)(Ze,"OnResolveEventArgs",Ld,[]);var fe=c(223);class Pe{}Pe.Jfe="MentionExperienceDegraded";Object(m.a)(Pe,"AtMentionsConstants",null,[]);class lf{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.$Rc=b;this.nhk=k;this.j2c=r;this.$td=y;this.Cb=R;this.hu=aa;this.kNd=ta;this.bai=Ya;this.lw=xb;this.hYb=Mb;this.HOa=null;this.pEc=!1;(b=Va.a.instance.Pa("Box4.IEditStateEventManager"))&&b.addHandler(fe.a.xza,this.BAn.bind(this));this.pEc=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DismissOnSpaceAfterAtIsEnabled",
!1)}btf(){return!!this.HOa}BAn(){this.btf()&&this.Mlh&&(this.HOa.updateInputText(this.nQc,!1),this.Mlh=!1)}ariaNotify(b,k){this.lw.sendNotification(b,k)}w5j(){const b=this.hu.editingView.editingElement;if(b){var k=b.getAttribute(Ef.a.ozc);b.setAttribute(Ef.a.ozc,k?k.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}Usn(){const b=this.hu.editingView.editingElement;if(b){var k=b.getAttribute(Ef.a.ozc);k?(k=k.toString().split(" "),
Array.remove(k,"PeoplePickerAutomationID"),k.length?b.setAttribute(Ef.a.ozc,k.join(" ")):b.removeAttribute(Ef.a.ozc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}lxk(){this.Usn();this.HOa&&this.HOa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.HOa=null;this.bai.r_i(!0)}KYm(b,k,r){v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");
b=this.kNd.d_a(b,r.displayName,r.email,r.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,k),!0);b?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.hYb.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:Pe.Jfe,isInternal:!0})}KXm(b,k){v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");k&&this.hYb.OA(Jc.a.Atk);this.kNd.KVl(b.id,k)}TTm(){this.hu.yd.Qv&&!this.hu.yd.cO&&this.hu.editingView.m6e?
this.Mlh=!0:(this.$Rc.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))}TZm(){v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.w5j()}JXm(b,k,r,y=new Map){y=Object.assign(new Xa.a,{extendedProperties:y});this.hYb.logKpiFailure("LPPWordEditorKPI",b,{isIntentional:k,isInternal:r,additionalValues:y},{name:Pe.Jfe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:k,isInternal:r,additionalValues:y})}JNi(){this.$Rc.SNi(()=>{this.lxk()});this.$Rc.ENi((b,
k)=>{this.nQc=b;if(this.HOa)this.pEc&&1<this.nQc.length&&"@"===this.nQc.trimEnd()?(this.hYb.OA(Jc.a.ztk),this.$Rc.reset()):this.HOa.updateInputText(this.nQc,!1);else if(this.hYb.logKpiUsage("LPPWordEditorKPI",0),this.hYb.OA(Jc.a.Y0m),(b=this.Ewl(k))&&b.height){k=b.y;const r=b.height,y=document.createElement("div");y.id="PeoplePicker";y.style.position="absolute";y.style.top=k-5+"px";y.style.left=b.x+"px";y.style.height=r+10+"px";document.body.appendChild(y);b={editingElementId:this.hu.editingView.editingElement.id,
containerElement:y,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:Object(u.a)(this,this.KYm,"onReplaceTextFromPicker"),onPermissionsReceivedCallback:Object(u.a)(this,this.KXm,"onPermissionsReceivedFromPicker"),onDismiss:Object(u.a)(this,this.TTm,"onDismissPicker"),onShow:Object(u.a)(this,this.TZm,"onShowPicker"),onFailure:Object(u.a)(this,this.JXm,"onPeoplePickerServiceFailure")};this.nhk.createPeoplePicker(b).then(R=>{R.updateInputText(this.nQc,!1);this.HOa=R;this.bai.r_i(!1)})}});
this.$Rc.FNi(b=>{if(this.HOa)this.HOa.onKeyDown(b.Ib.rawEvent)})}Ewl(b){var k=this.Cb.ib;if(!k)return null;k=k.kb;if(!k)return null;k=k.Qa;if(!k)return null;k=k.node;if(!k)return null;k=Object(ia.a)(57,k);if(!k)return null;k=Object(ia.a)(154,k.Ii(this.hu.yd.Sb));if(!k)return null;k=Object(ia.a)(53,k);if(!k)return null;let r=null;try{r=this.j2c.eZ(this.$td.w2b(2,b),k,!1,!1,!1,!1)}catch(y){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",y)}return r}}
Object(m.a)(lf,"WordEditorAtMentionsHandler",null,[283]);var ig=c(1453),Kg=c(706);class Pg{static Edo(b){Kg.a.WOd()&&(Si.TableReader.BOc(b)?Pg.k1f(Pg.SIm):Vh.ListReader.yma(b)&&Pg.k1f(Pg.RIm))}static k1f(b){var k;null!==(k=n.AFrameworkApplication.K)&&void 0!==k&&k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1)&&(Pg.Kfi||Pg.addEventListener(),(k=Va.a.instance.$a("Common.ISystemInitiatedFeedback"))&&k.execute(r=>{r.logActivity(b,null)}))}static addEventListener(){window.addEventListener(Pg.A7n,
Pg.z7n,!0);Pg.Kfi=!0}}Pg.H9n="LoopsTeachingCalloutOnInsertTabActivity";Pg.A7n="switchToInsertTabEvent";Pg.RIm="mentionWithinListActivity";Pg.SIm="mentionWithinTableActivity";Pg.Kfi=!1;Pg.z7n=()=>{appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"))};Object(m.a)(Pg,"FluidComponentsTUIHelper",null,[]);class hh{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td){this.ga=b;this.Yc=k;this.h9a=r;this.hb=y;this.Hp=R;this.Yd=aa;this.vC=ta;this.Xcd=Ya;this.Jd=xb;this.$m=Mb;this.Wxj=jc;this.Ci=
Mc;this.Hc=cc;this.sa=new Fe.a;this.wf=fd;this.Dwg=Td;od.a.GPe((ne,ye)=>{this.NF(ye.commentNode,!0)&&this.sa.raiseEvent(hh.yTc)})}Bah(b){this.sa.addHandler(hh.Wxi,b)}A9j(b){this.sa.addHandler(hh.VAi,b)}i9j(b){this.sa.addHandler(hh.CWm,b)}GPe(b){this.sa.addHandler(hh.yTc,b)}NF(b,k){let r=b.ia(wc.a.NF,!1);k&&(r=r&&!b.ia(wc.a.a$,!1));return r}k7b(b){return this.Hp.k7b(b)}XCl(b){for(let k of b)for(let r of k)if(hh.Ouf(r.contextId))return r.node.Mc;return null}UJl(b,k,r){const y=new md,R=b.Mc;for(let aa=
0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);if(ta.cp>=k)break;if(ta.Hf&&ta.Hf.length)for(let Ya=0;Ya<ta.Hf.length;Ya++){const xb=ta.Hf.J(Ya);this.NF(R.Db(xb.Rj),r)&&(xb.Oc?y.add(xb):y.remove(xb))}}return y}VJl(b,k,r,y){const R=new md,aa=b.Mc;for(let ta=0;ta<b.qa.length;ta++){const Ya=b.qa.J(ta);if(Ya.cp>r)break;if(Ya.Hf&&Ya.Hf.length)for(let xb=0;xb<Ya.Hf.length;xb++){const Mb=Ya.Hf.J(xb);this.NF(aa.Db(Mb.Rj),y)&&(Mb.Oc?Ya.cp<r&&R.add(Mb):Ya.cp<=k&&R.remove(Mb))}}return R}a_h(b,k){let r;const y=b.node;
b.contextId!==lc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=y.characterData.length);return r===b?this.UJl(y,r,k):this.VJl(y,r,b,k)}KJc(b,k){return hh.Ouf(b.contextId)?this.a_h(b,k).lHh():new rb.a}U3b(b,k){const r=new md;for(let y of b)for(let R of y)hh.Ouf(R.contextId)&&r.hho(this.a_h(R,k));return r.lHh()}Prf(){var b=this.hb.ib;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return ie.ParagraphReader.nc(b)&&!ie.ParagraphReader.tka(b)&&this.Hp.$fb(this.ga,!0)?!0:!1}o$h(b,k){if(!this.Prf())return null;
if(this.Hp.EXl())return v.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var y=this.hb.ib.J(0).Qa;y.contextId===lc.a.Wc?(b=b?rf.SelectionEditor.k2(y,!1):null)&&b.MC&&b.Qa.contextId===lc.a.Hd?this.hb.setSelection(b):(this.Yd.replaceTextRange(y,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.hb.setSelection(Ke.SelectionFactory.DN(y.node,y.cpBegin,y.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):
r=!0;this.wf.Byb||da.a.instance.rMc();b=this.Hp.Sxb(this.hb.ib.kb);if(!b)return null;this.k7b(b)&&this.Dwg.OA(ib.a.newComment,{succeeded:!0,zMb:29});var R=this.Yc.Zf(b);const aa=R.Pb(1);if(!aa||393229!==aa.Qc)return null;R=R.Pb(2);if(!R||393230!==R.Qc)return null;this.L8f(b.Mc,b.id);this.sa.raiseEvent(hh.Wxi,new we(b,k));r&&(k=y.node,y=y.contextId!==lc.a.paragraph?y.cpEnd:k.characterData.length,this.hb.setSelection(Ke.SelectionFactory.DN(k,y,y)));return b}RMd(b){return!!this.o$h(!0,b)}Bof(b,k,r,y,
R,aa){if(0>k)return!1;y="@"+y;const ta=y+" ",Ya=new sf.GraphTransaction(15);try{Ya.Eb(b);this.Yd.replaceTextRange(Re.a.createTextRange(b,k,r),ta);this.Jd.og&&(this.$m.DXe(b,k,k+y.length),this.$m.toa(b,k+y.length,k+ta.length,1));const xb=this.vC.VG(Re.a.createTextRange(b,k,k+y.length),"mailto:"+R,!1,!0,!1);if(!xb)return!1;const Mb=xb.Jx;if(!Mb)return v.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.hb.setSelection(Ke.SelectionFactory.DN(b,k,k+y.length));
let cc=this.o$h(!1,2);if(!cc)return!1;aa&&this.Xcd.B2j(aa,Mb,cc.id);this.hb.setSelection(Ke.SelectionFactory.xe(b,k+ta.length));Pg.Edo(b)}finally{Ya&&Ya.dispose()}return!0}d_a(b,k,r,y){const R=this.hb.Jg;return rf.SelectionEditor.zf(R)?this.Bof(R.node,R.cpBegin-b,R.cpBegin,k,r,y):!1}ZFl(b){if(1===b.length&&b.J(0).MC&&(b=b.J(0).Qa,b.contextId===lc.a.Wc&&ie.ParagraphReader.nc(b.node))){const k=b.node;for(let r=0;r<k.qa.length;r++){const y=k.qa.J(r);if(y.cp===b.cpBegin){b=y.IHd(!0,!0);if(0<b.length)return b[0].Rj;
break}}}return null}Hxb(b,k,r){return this.Hp.FCc(b,k,r).returnValue}sEd(b,k,r,y,R){let aa=!1;const ta=b.characterData;if(k>=ta.length||r>ta.length||r<k)return{returnValue:!1,tLa:aa};let Ya=k,xb=null;for(let cc=0;cc<b.qa.length;cc++){const jc=b.qa.J(cc),Mc=jc.cp;if(!(Mc<k)){if(jc.vl&&xb)try{const fd=ta.substring(Ya,Mc),Td=new Ja.a;Td.fullName=fd.startsWith("@")?fd.substr(1):fd;cd.a(xb,Td);const ne=new db.a;cd.b(xb,ne);R&&(ne.contentId=this.Wxj.Vaf());y.pof(fd,Td,ne);aa=!0;xb=null;Ya=Mc}catch(fd){var Mb=
Object.assign(new Xa.a,{extendedProperties:new Map});Mb.extendedProperties.set("exception",fd.message);this.Dwg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Mb},{name:Pe.Jfe,isInternal:!0,additionalValues:Mb})}Mc<=r&&!xb&&(Mb=Math.min(Mc,r),Mb>Ya&&y.kfa(ta.substring(Ya,Mb)),Ya=Mc);jc.hyperlink&&jc.hyperlink.MF&&(xb=jc.hyperlink);if(Mc>=r)break}}return{returnValue:!0,tLa:aa}}sNh(b,k,r,y,R=-1){var aa=!1,ta=b.Db(k),Ya=b.Db(ig.k(ta));ta=b.Db(ig.h(ta));R=0<
R?R:Number.MAX_VALUE;b=this.Hxb(Ya,k,!0);k=this.Hxb(ta,k,!1);if(-1===b||-1===k)return{returnValue:!1,tLa:aa};if(Ya===ta)return this.sEd(Ya,b,k,r,y);const xb=this.h9a.YWa(Ya,!1,!1);if(!xb)return{returnValue:!1,tLa:aa};Ya=new rb.a;let Mb=0;do Ya.add(xb.Jz),Mb+=xb.Jz.characterData.length;while(xb.Jz!==ta&&xb.Vla()&&Mb<R);for(R=0;R<Ya.count;R++)if(aa=Ya.J(R),ta=aa.characterData,R)if(R===Ya.count-1){if(!({tLa:aa}=this.sEd(aa,0,k,r,y)).returnValue)return{returnValue:!1,tLa:aa}}else{if(!({tLa:aa}=this.sEd(aa,
0,ta.length,r,y)).returnValue)return{returnValue:!1,tLa:aa};r.kfa("\n")}else{if(!({tLa:aa}=this.sEd(aa,b,ta.length,r,y)).returnValue)return{returnValue:!1,tLa:aa};r.kfa("\n")}return{returnValue:!0,tLa:aa}}rEd(b,k){const r=new Ob;return this.sNh(b,k,r,!1,-1).returnValue?r.vxa:null}OBd(b,k){var r=b.Db(k);if(!r)return null;b=b.Db(ig.h(r));if(!b)return null;k=this.Hxb(b,k,!1);if(-1===k)return null;r=b.characterData;if(k>=r.length||!A.a.xaa(r.charAt(k))){r=this.Hc.Rc(15);try{r.Eb(b),this.Yd.replaceTextRange(Re.a.Uc(b,
k)," ")}finally{r&&r.dispose()}}return Ke.SelectionFactory.xe(b,k+1)}L8f(b,k){const r=b.Db(k),y=new Sb.a;this.sNh(b,k,y,!0).returnValue&&(y.kfa("\n"),this.Hp.Mhj(r,y.F8),this.sa.raiseEvent(hh.f0m))}NGn(b,k){for(let r of b){if(r.contains(k))return!0;for(let y of r)for(let R of k)if(y.node===R.node&&y.gl>=R.gl)return!0}return!1}Dzh(b,k,r,y,R){const aa=this.hb.ib.clone(),ta=new Yt.a(Ka.App.xa.jb.Fc);b=Ke.SelectionFactory.xe(b,k);r=Re.a.Uc(r,y);b=Ke.SelectionFactory.KB(b,r);this.hb.setSelection(b);r=
!this.NGn(aa,b);return 32===this.ga.Vf(ta,Wa.a.XG,2,!0,null,null)?(r?this.hb.JX(aa):R!==G.a.nil&&(R=this.OBd(this.Ci.value,R),this.hb.setSelection(R)),!0):!1}Drn(b,k){var r=b.Db(k);const y=b.Db(ig.k(r));b=b.Db(ig.h(r));if(y===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var R=y.characterData.indexOf(r);-1!==R&&this.Dzh(y,R,b,R+r.length,k)}}Lzh(b,k,r){var y=b.Db(k);if(!y)return!1;const R=b.Db(ig.k(y));b=b.Db(ig.h(y));y=this.Hxb(R,k,!0);const aa=this.Hxb(b,k,!1);
if(-1===y||-1===aa||!this.Dzh(R,y,b,aa,G.a.nil))return!1;r&&this.Uzh(k);return!0}Uzh(b){this.Hp.RSf(b,!0)}sfo(b){var k=this.XCl(this.hb.ib);if(!k)return!1;const r=this.U3b(this.hb.ib,!0);if(1!==r.count)return!1;const y=k.Db(r.J(0));if(b)k=this.Lzh(k,r.J(0),!1);else{const R=ig.k(y),aa=ig.h(y);G.a.Jp(R,aa)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.pHk(r.J(0));k.Db(R).uk(16,!0);k=!0}k&&(y.setValue(wc.a.a$,!0),this.sa.raiseEvent(hh.VAi,
new Ze(y,b)));return k}Ggh(b,k){b=this.U3b(this.hb.ib,!1);k.yo[hh.sBh]=!!b.count}jzi(b,k){if(k.yo[hh.sBh]&&ie.ParagraphReader.nc(k.clone)&&(k=k.clone,b=k.Mc)&&(k=Re.a.createTextRange(k,0,k.characterData.length),k=this.KJc(k,!1),k.count))for(let r of k)(k=b.Db(r))&&k.setValue(wc.a.NF,!1)}Jpl(b,k,r){let y;const R=({YAc:xb}=this.Hp.FCc(k,r,!0)).returnValue;r=({YAc:y}=this.Hp.FCc(k,r,!1)).returnValue;let aa=null,ta=-1,Ya=-1;for(;xb<y;xb++){let Mb=k.qa.J(xb);if(Mb.hyperlink&&Mb.hyperlink.MF&&Mb.hyperlink.Jx===
b){aa=Mb.hyperlink;ta=Mb.cp;break}}if(!aa||ta<R)return{returnValue:!1,Vth:ta,Uth:Ya};for(b=xb;b<k.qa.length;b++){var xb=k.qa.J(b);if(xb.cp>r)break;if(xb.zT){Ya=xb.cp;break}}return{returnValue:-1!==Ya,Vth:ta,Uth:Ya}}Bsn(b){var k=this.Xcd.Unl(b);if(k){var r=null;Ka.App.xa&&(r=Ka.App.xa.jb.Xc.Ad);if(r){var y=r.Db(k);k=r.Db(ig.k(y));var R=r.Db(ig.h(y));if(k!==R)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({Vth:b,Uth:R}=this.Jpl(b,k,y.id)).returnValue){var aa=
new sf.GraphTransaction(7);try{aa.Eb(k);let ta=Re.a.createTextRange(k,b,R);this.Yd.replaceTextRange(ta,"");this.L8f(r,y.id)}finally{aa&&aa.dispose()}this.hb.ib&&0<this.hb.ib.length?(r=this.hb.ib.J(0).Qa,r.node===k?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.setSelection(Ke.SelectionFactory.xe(k,
b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}KVl(b,k){if(!k){k=this.Xcd.ill(b);if(!k){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(let r of k)this.Bsn(r)}this.Xcd.Ctn(b)}fjl(){da.a.instance.rMc();const b=new rb.a;for(let r of this.Hp.HQe)if(r.Rq!==
qc.a.beingCreated){var k=G.a.Pf(r.objectId);k=this.Ci.value.Db(k);this.NF(k,!0)&&b.add(k)}return b}pGn(b){b=this.Hp.$hf(b);this.hb.setSelection(b)}pHk(b){b?this.Ci.value.Db(b).setValue(wc.a.NF,!1):v.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static Ouf(b){return b===lc.a.Hd||b===lc.a.Wc||b===lc.a.paragraph}}hh.sBh="DisableNestedIntelligentPlaceholder";hh.Wxi="CreateIntelligentPlaceholder";hh.VAi="ResolveIntelligentPlaceholder";hh.f0m="UpdateIntelligentPlaceholder";
hh.yTc="DeleteIntelligentPlaceholder";hh.CWm="MentionAddedToFollowUpEventKey";Object(m.a)(hh,"IntelligentPlaceholderEditor",null,[645,646,647]);class fo{constructor(b,k,r,y){this.uqa=!1;this.Ml=!0;this.le=null;this.xab=R=>{if(!this.Ml||!this.Ask(R,this.hb.ib))return!1;R.Ib.preventDefault();R.Ib.stopPropagation();this.Zc.yd&&this.Zc.yd.xFc(!1);R=this.OBd(this.hb.ib);if(!R)return!1;this.hb.setSelection(R);return!0};this.Zc=b;this.Ci=k;this.hb=r;this.Y4=y}Hzc(b,k){this.uqa||(b.Xta?(this.yab(k),this.uqa=
!0):b.zda(()=>{this.uqa||(this.yab(k),this.uqa=!0)}))}dispose(){this.le&&this.le.sc(Kb.a.aI,this.Zc.editingView.editingElement,this.xab)}yab(b){this.le=b;this.Zc.yd.yi&&this.le.mb(Kb.a.aI,this.Zc.editingView.editingElement,this.xab)}Ask(b,k){if(b.Ib.keyCode!==tb.a.px&&b.Ib.keyCode!==tb.a.hs||1!==k.length||!k.J(0).MC)return!1;var r=this.Y4.U3b(k,!0);if(1!==r.count)return!1;const y=k.J(0).Qa.node;if(!ie.ParagraphReader.nc(y))return!1;b=this.Y4.Hxb(y,r.J(0),!0);r=this.Y4.Hxb(y,r.J(0),!1);return k.J(0).Qa.cpBegin<
b||k.J(0).Qa.cpEnd>r?!1:!0}OBd(b){b=this.Y4.U3b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.Y4.OBd(this.Ci.value,b)}r_i(b){this.Ml=b}}Object(m.a)(fo,"IntelligentPlaceholderKeyboardListener",null,[643,10]);class Ud{constructor(b,k){this.g9l=r=>{1===r&&this.ga.processAction(ib.a.newComment,2);2===r&&(this.I_g.instance?this.I_g.instance.ohc("https://go.microsoft.com/fwlink/?linkid=2154656")&&A.a.$W("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656",
"_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new ca.a,{name:"DialogResult",int64:r})];Ib.d(Jc.a.RKh,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.I_g=k}GKk(){const b=new cf.StandardDialog;b.Gd=11;b.We(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.We(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Tv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,
0,this.g9l);Ib.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(Ud,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var je=c(1435);class Hj{constructor(b,k,r,y,R,aa){this.l5=this.iDe=null;this.n3=()=>{this.l5||(this.l5=new nd.a(3,1,0,()=>{this.l5=null;this.JKd(this.hb.ib)},130),this.Hb.fc(this.l5))};this.Hc=b;this.zG=k;this.hb=r;this.Hb=y;this.FLe=R;this.Ci=aa;this.O0=new mc.a;this.ps=new je.a;this.yWg=new kb.a(this.O0);this.zG.Bah((ta,Ya)=>{this.C5j(Ya.commentNode)})}C5j(b){b=b.id;const k=this.ZXh(this.Ci.value,
b);k&&this.ps.Z(b,k)}ZXh(b,k){const r=b.Db(k);return!r||this.zG.k7b(r)?null:this.zG.rEd(b,k)}umk(b){const k=new je.a;var r=this.zG.U3b(b,!0);if(!r)return k;b=this.Ci.value;for(let y of r)(r=this.ZXh(b,y))&&k.Z(y,r);return k}RSf(b){if(this.iDe){const k=this.Hc.Rc(15);try{k.Eb(this.FLe()),this.zG.Uzh(this.iDe)}finally{k&&k.dispose()}}this.iDe=b?this.zG.ZFl(b):null}iWl(b){const k=this.Ci.value;if(b=b?this.umk(b):new je.a){var r=new kb.a(this.O0),y=new kb.a(this.O0);Hj.Ksl(this.ps,b,r,y);for(var R of r)this.ps.Z(R,
b.J(R));for(let aa of y)if(r=this.ps.J(aa),y=this.zG.rEd(k,aa),this.ps.remove(aa),y&&(b=R=!1,ka.a.mKc().equals(y,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<y.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?R=!0:!ka.a.mKc().equals(r,y),r||R||b)){y=this.Hc.Rc(15);try{y.Eb(this.FLe()),b?this.zG.Lzh(k,aa,!0):(R&&this.zG.Drn(k,aa),r&&this.zG.L8f(k,aa))}finally{y&&y.dispose()}}}}cFl(b){const k=new kb.a(this.O0);for(let r of b)for(let y of r)b=
y.node,ie.ParagraphReader.nc(b)&&k.add(b.id);return k}JUl(b){var k=this.Ci.value;const r=b?this.cFl(b):new kb.a(this.O0);if(r){b=new rb.a;for(let aa of this.yWg)if(!r.contains(aa)){var y=k.Db(aa);if(y){y=y.qa;for(let ta=0;ta<y.length;ta++){const Ya=y.J(ta).Hf;if(Ya)for(let xb=0;xb<Ya.length;xb++){var R=Ya.J(xb);R.Oc&&(R=k.Db(R.Rj))&&R.ia(wc.a.Uji,!1)&&G.a.Jp(aa,ig.h(R))&&this.zG.k7b(R)&&b.add(R)}}}}this.yWg=r;if(b.count){k=this.Hc.Rc(7);try{k.Eb(this.FLe());for(let aa of b)aa.Vg(wc.a.Uji)}finally{k&&
k.dispose()}}}}JKd(b){this.RSf(b);this.iWl(b);this.JUl(b)}Blh(){this.l5&&(this.Hb.Ye(this.l5),this.l5=null)}pTc(){if(this.l5||this.Ci.iLd)this.Blh(),this.JKd(null)}UA(){this.hb.tB(this.n3);n.AFrameworkApplication.FK(()=>{this.pTc()})}dispose(){this.hb.Iga(this.n3);this.Blh()}static Ksl(b,k,r,y){for(let R of k){let aa=R.key;b.ub(aa)||r.add(aa)}for(let R of b)b=R.key,k.ub(b)||y.add(b)}}Object(m.a)(Hj,"IntelligentPlaceholderSelectionCache",null,[10]);var qk;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=
1]="contextMenu";b[b.atMention=2]="atMention";b[b.MOo=3]="textGesture";b[b.paste=4]="paste";b[b.Mxo=5]="workItemIntent";b[b.YEo=6]="characterTrigger"})(qk||(qk={}));Object(m.b)("IntelligentPlaceholderCreation",qk);class cp{constructor(b,k,r,y){this.Nxa=b;this.xm=k;this.GOb=r;this.Ax=y}t8d(b){return b&&b.Mc&&b.Mc.id.equals(this.Ax.value.Ad.id)?!0:!1}A4i(b){return this.t8d(b)&&b.ia(wc.a.NF,!1)?!0:!1}cCm(){this.GOb.execute(b=>{b.logAction({actionType:hb.b.SessionStart,engagement:hb.a.Offer,objectName:cp.qgc})})}LTd(b,
k){let r=!1;n.AFrameworkApplication.K.$("FixInCanvasMentionLogging")&&(r=2==k&&this.t8d(b));if(this.A4i(b)||r){var y=b.getValue(wc.a.hE);this.GOb.execute(R=>{R.logAction({actionType:hb.b.Created,engagement:hb.a.None,objectName:cp.qgc,objectId:y.toString(),objectFulfillment:qk[k]})})}}Qym(b){if(this.A4i(b)){var k=b.getValue(wc.a.hE);this.GOb.execute(r=>{r.logAction({actionType:hb.b.Deleted,engagement:hb.a.None,objectName:cp.qgc,objectId:k.toString()})})}}YCm(b,k){if(this.t8d(b)){var r=b.getValue(wc.a.hE);
this.GOb.execute(y=>{y.logAction({actionType:hb.b.Resolved,engagement:hb.a.None,objectName:cp.qgc,objectId:r.toString(),objectFulfillment:k?"RemoveText":"KeepText"})})}}eEm(b){b===Jc.a.RMd&&this.GOb.execute(k=>{k.logAction({actionType:hb.b.Deleted,engagement:hb.a.None,objectName:cp.qgc,objectFulfillment:cp.U9n})})}ZAm(b){if(this.t8d(b)){var k=b.getValue(wc.a.hE);this.GOb.execute(r=>{r.logAction({actionType:hb.b.Modified,engagement:hb.a.None,objectName:cp.qgc,objectId:k.toString(),objectFulfillment:"MentionInserted"})})}}ojk(){this.cCm();
this.Nxa.Bah((b,k)=>{this.LTd(k.commentNode,k.w7m)});this.Nxa.A9j((b,k)=>{this.YCm(k.commentNode,k.jlm)});this.Nxa.i9j((b,k)=>{this.ZAm(k.commentNode)});this.xm.RPe((b,k)=>{this.eEm(k.actionId)});od.a.GPe((b,k)=>{this.Qym(k.commentNode)})}}cp.qgc="IntelligentPlaceholder";cp.U9n="Undo";Object(m.a)(cp,"IntelligentPlaceholderTelemetry",null,[]);class Do{constructor(){this.Y4=this.Led=this.zld=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}zc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",
()=>new Ud(n.AFrameworkApplication.ya,b.$a("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new t).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new hh(n.AFrameworkApplication.ya,new Io.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new d(n.AFrameworkApplication.ya,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Hj(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),n.AFrameworkApplication.uc,()=>Ka.App.xa.jb.Fc.ld,new cg.a(()=>Ka.App.xa.jb.Xc.Ad))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new fo(Bb.InteractiveViewManager.instance,new cg.a(()=>Ka.App.xa.jb.Xc.Ad),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new cp(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.$a("CanvasContextual.ICanvasContextualController"),new cg.a(()=>Ka.App.xa.jb.Xc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()})}Wm(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.$a("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Vb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").ojk();this.Y4=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");Ps.a.b8j(Object(u.a)(this.Y4,this.Y4.Ggh,"beforeIntelligentPlaceholderPaste"));Ps.a.zyc(Object(u.a)(this.Y4,this.Y4.jzi,"onIntelligentPlaceholderPaste"));this.zld=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(102)||this.zld.UA();this.Led=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.Led.Hzc(Ka.App.xa.jb,bc.KeyInputManager.instance);this.oon(this.W.$a("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.zld&&this.zld.dispose();this.Led&&this.Led.dispose();this.Y4&&(Ps.a.Ktn(Object(u.a)(this.Y4,this.Y4.Ggh,"beforeIntelligentPlaceholderPaste")),Ps.a.mun(Object(u.a)(this.Y4,this.Y4.jzi,"onIntelligentPlaceholderPaste")))}oon(b,k,r){b&&b.execute(y=>{y.w3(new T(k,
r))})}static main(){M.a.instance.Pc(new Do)}}Object(m.a)(Do,"PackageManager",null,[1,2]);var Cp=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},ks=c(1920),oA=c(1818),xr=c(1891);class Zs{}Zs.k3n="Search_16x16x32";Zs.c3n="ClosePaneGlyph_16x16x32";Object(m.a)(Zs,"SearchBoxIcons",
null,[]);var Zv=c(1894),Fs=c(1895),$s=c(1893);class mB{constructor(){this.JFg=null}get key(){return"FIND_HIT"}get qw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.JFg=b.node.TLa()}qFa(b){let k=null;for(let r of this.JFg)if(r.begin<=b&&b<r.end)return k=Object.assign(new Np.a,{YF:this.key,contentObject:r}),{returnValue:!0,VE:k};return{returnValue:!1,VE:k}}}Object(m.a)(mB,"FindHitDetailsProvider",null,[298,299]);var Gs=c(1576),vz=c(1522),nB=c(1558);class Ju{constructor(b,
k,r,y,R,aa,ta,Ya=null,xb=null){this.Ql=null;this.find=(Mb,cc,jc,Mc,fd)=>1===jc?32:void 0===fd||null===fd?8:fd.length?this.W2f(fd):(this.YVe(xr.a.initial),32);this.findInDocument=(Mb,cc,jc,Mc,fd)=>this.G6i(Jc.a.clb,Mb,cc,jc,Mc,fd);this.C$k=(Mb,cc,jc,Mc,fd)=>this.G6i(Jc.a.elb,Mb,cc,jc,Mc,fd);this.qJh=(Mb,cc,jc)=>1===jc?32:this.W2f(this.Yn.OLa());this.dWc=(Mb,cc,jc,Mc,fd)=>{Mb=!this.Yn.mF;fd[Sd.a.Image16by16Class]=Mb?ci.getImageClass(Zs.k3n):ci.getImageClass(Zs.c3n);fd[Sd.a.LabelText]=Mb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;fd[Sd.a.ApplyLabelTextToControlOnly]=!0;fd[Sd.a.EnsureControlRoleIsButton]=!0;fd[Sd.a.On]=!1;return 32};this.Gal=(Mb,cc,jc)=>{if(1===jc)return 32;this.p3h(!1);return 32};this.Qal=(Mb,cc,jc)=>{if(1===jc)return 32;this.p3h(!0);return 32};this.xPf=(Mb,cc,jc,Mc,fd)=>{fd[cl.a.Visible]=this.Yn.N6i;return 32};this.HPf=(Mb,cc,jc,Mc,fd)=>{fd[cl.a.Visible]=this.Yn.N6i;return 32};this.jJd=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return 32;this.jA.VYc.u3h(fd);
return 32};this.cancelSearch=(Mb,cc,jc)=>{if(1===jc)return 32;this.YVe(xr.a.initial);return 32};this.rBc=(Mb,cc,jc)=>{if(1===jc)return 32;this.YVe(xr.a.initial);this.Yn.aB(!1);return 32};this.clearSearch=(Mb,cc,jc)=>{if(1===jc)return this.Ebm(Mb===ib.a.yoh);this.Yn.clearSearch();return 32};this.bde=(Mb,cc,jc)=>{if(1===jc)return 32;switch(Mb){case ib.a.L9e:this.Yn.matchCase=!this.Yn.matchCase;break;case ib.a.$9e:this.Yn.matchWholeWord=!this.Yn.matchWholeWord}return this.W2f(this.Yn.OLa())};this.y1d=
(Mb,cc,jc,Mc,fd)=>{fd[Ig.a.On]=this.Yn.matchCase;return 32};this.A1d=(Mb,cc,jc,Mc,fd)=>{fd[Ig.a.On]=this.Yn.matchWholeWord;return 32};this.iPf=(Mb,cc,jc,Mc,fd)=>{Mb=this.Yn.matchCase;cc=this.Yn.matchWholeWord;jc="";Mb&&cc?jc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Mb?jc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
cc&&(jc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));fd[Md.a.Value]=jc;fd[Md.a.Visible]=Mb||cc;return 32};this.Tbc=(Mb,cc,jc,Mc,fd)=>{Mb=this.Yn.Y0;cc="";switch(this.Yn.mF){case xr.a.startSearch:cc=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case xr.a.searching:cc=Mb?this.Ghf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case xr.a.searchComplete:cc=
this.Ghf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case xr.a.tooManyResults:cc=this.Ghf(this.Yn.FCa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case xr.a.noMatchesFound:cc=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case xr.a.replaceAllInProgress:cc=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case xr.a.replaceAllComplete:cc=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}fd[Md.a.Value]=
cc;return 32};this.z1d=(Mb,cc,jc,Mc,fd)=>{fd&&(fd.CommandValueId=this.Yn.OLa());return 32};this.replace=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return this.Ctf()?32:8;if(!this.Ctf())return 8;Mb=this.Yn.pBb();"string"===typeof fd&&fd&&(Mb=fd);v.ULS.sendTraceTag(6033813,312,50,"Replace Called");Ib.a("NavigationPaneReplace");fd=this.ptb.replace(Mb);this.Yn.LJn(fd);return 32};this.replaceAll=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return this.qlm()?32:8;Mb=this.Yn.pBb();"string"===typeof fd&&fd&&(Mb=fd);Ib.a("NavigationPaneReplace");
this.Ql=this.me.jg("UserAction","ReplaceAll");this.Yn.O5(xr.a.replaceAllInProgress);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");nB.a.wwn(this.Yn.OLa(),this.Yn.pBb());this.ptb.replaceAll(Mb,this.IYm);return 32};this.IYm=(Mb,cc)=>{this.Ql&&(this.Ql.stop(),this.Ql=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Mb,["TotalCount"]:cc});nB.a.twn(Mb,cc);this.Yn.O5(xr.a.replaceAllComplete)};this.CJi=(Mb,cc,jc,Mc,fd)=>{cc=!1;if(!fd)return 8;
this.Yn.ih.isVisible&&(cc=Mb===Jc.a.yWc===this.Yn.FJc());Mb!==Jc.a.yWc||this.vNg||(cc=!1);fd[Ig.a.On]=cc;return 32};this.jPf=(Mb,cc,jc,Mc,fd)=>{if(!fd||!this.Yn.ih.isVisible)return 32;fd[Ig.a.On]=this.Yn.FCa;return 32};this.lPf=(Mb,cc,jc,Mc,fd)=>{if(!fd)return 32;fd.currentFindReplaceViewType=this.Yn.mF;return 32};this.Gen=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return 32;Mb=fd[Ig.a.On];fd&&(fd[Ig.a.On]=this.Yn.ih.isVisible);Mb&&!fd[Ig.a.On]&&(Ju.oej(),Ib.a("NavigationPaneCrossClick"));return 32};this.d4a=(Mb,
cc,jc,Mc,fd)=>{const Td=this.Yn.ih.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",Td);return Td?this.rBc(Mb,cc,jc,Mc,fd):this.afc(Mb,cc,jc,Mc,fd)};this.afc=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return Ae.SessionStatusManager.instance.pK?32:8;if(2===jc){n.AFrameworkApplication.Gaa("AutoDetectedHeadingsIsEnabled");Ju.oej();this.y3();Gs.FindReplaceUIManager.jqk(Mb,fd,this.Yn.ih.isVisible);cc=!0;Mb===Jc.a.ffc&&void 0!==fd&&null!==fd&&(cc=fd);this.Yn.aB(!0,cc);fd=$s.a.initial;switch(Mb){case Jc.a.bfc:v.ULS.sendTraceTag(42501022,
367,50,"");fd=$s.a.headings;break;case Jc.a.clb:fd=$s.a.find;break;case Jc.a.elb:fd=$s.a.replace;break;case Jc.a.ffc:fd=$s.a.intelligentPlaceholder;break;case Jc.a.d4a:fd=this.Yn.Sbb,fd||(v.ULS.sendTraceTag(42501023,367,50,""),fd=$s.a.headings)}this.Yn.FOn(fd,cc);return 32}return 8};this.i1a=()=>{this.Yn.mF&&!this.Yn.FCa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.Yn=k;this.jA=r;this.ptb=y;this.vNg=R;this.me=ta;xb&&xb(1,this.i1a,null);this.qHa=Ya}y3(){}Vb(){this.ga.gb(Jc.a.YPf,
lc.a.view,this.Gen,96);this.ga.pa(Jc.a.d4a,lc.a.view,this.d4a);this.ga.pa(Jc.a.bfc,lc.a.view,this.afc);this.ga.pa(Jc.a.clb,lc.a.view,this.afc);this.ga.pa(Wa.a.OCd,lc.a.view,this.find);this.ga.pa(ib.a.findInDocument,lc.a.view,this.findInDocument);this.ga.pa(Wa.a.findOnPage,lc.a.view,this.qJh);this.ga.gb(ib.a.gen,lc.a.view,this.dWc,97);this.ga.pa(Wa.a.jWd,lc.a.view,this.Gal);this.ga.pa(Wa.a.Q0d,lc.a.view,this.Qal);this.ga.gb(Wa.a.xPf,lc.a.view,this.xPf,97);this.ga.gb(Wa.a.HPf,lc.a.view,this.HPf,97);
this.ga.pa(Jc.a.jJd,lc.a.view,this.jJd);this.ga.pa(Wa.a.Mwb,lc.a.view,this.cancelSearch);this.ga.pa(ib.a.clearSearch,lc.a.view,this.clearSearch);this.ga.pa(ib.a.yoh,lc.a.application,this.clearSearch);this.ga.pa(Jc.a.rBc,lc.a.view,this.rBc);this.ga.pa(ib.a.L9e,lc.a.view,this.bde);this.ga.pa(ib.a.$9e,lc.a.view,this.bde);this.ga.gb(ib.a.y1d,lc.a.view,this.y1d,97);this.ga.gb(ib.a.A1d,lc.a.view,this.A1d,97);this.ga.gb(Jc.a.iPf,lc.a.view,this.iPf,97);this.ga.gb(Jc.a.Tbc,lc.a.view,this.Tbc,97);this.ga.gb(Jc.a.jPf,
lc.a.view,this.jPf,97);this.ga.gb(Jc.a.lPf,lc.a.view,this.lPf,97);this.ga.gb(Jc.a.kPf,lc.a.view,this.CJi,97);Object(vz.b)()&&this.ga.gb(Jc.a.z1d,lc.a.view,this.z1d,96);this.vNg&&(this.ga.gb(Jc.a.elb,lc.a.view,this.afc,1028),this.ga.gb(Jc.a.yWc,lc.a.view,this.CJi,97),this.ga.gb(Jc.a.replace,lc.a.view,this.replace,1028),this.ga.gb(Jc.a.replaceAll,lc.a.view,this.replaceAll,1028),n.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.gb(ib.a.U9e,lc.a.view,this.C$k,1028));this.ga.pa(Jc.a.ffc,lc.a.view,this.afc)}IRf(){this.qHa&&this.qHa.execute(b=>{b.w3(new mB)})}G6i(b,k,r,y,R,aa){if(1===y)return Ae.SessionStatusManager.instance.pK?32:8;if(void 0===aa||null===aa)return 8;this.afc(b,r,2,R,aa);b=this.Yn;b.DYf(aa.CommandValueId);Object(vz.b)()&&("MatchCase"in aa&&(b.matchCase=aa.MatchCase),"MatchWholeWord"in aa&&(b.matchWholeWord=aa.MatchWholeWord));return this.qJh(k,r,y,R,aa)}W2f(b){if(void 0===b||null===b||!b.length)return 32;
b=Zv.a.createQuery(b,this.men);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.jA.find(b);return 32}get men(){let b=Fs.a.none;this.Yn.matchCase&&(b|=Fs.a.matchCase);this.Yn.matchWholeWord&&(b|=Fs.a.wholeWordOnly);return b}p3h(b){this.Yn.Sbb!==$s.a.headings&&this.Yn.Y0&&(b?this.jA.VYc.vSl():this.jA.VYc.r3h())}YVe(b){this.Yn.mF&&(this.Yn.FCa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.jA.mWa(),this.Yn.O5(b))}Ebm(b){return this.Yn.mF===
xr.a.replaceAllInProgress||b&&!this.Yn.mF?8:32}Ghf(b){return String.format(b,this.Yn.l9c,this.Yn.Y0)}Ctf(){return this.Yn.FJc()&&0<this.Yn.Y0}qlm(){return this.Ctf()&&this.Yn.FCa}static oej(){null!=n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Ju.Nka)}static Ftl(b,k,r,y){return new Ju(n.AFrameworkApplication.ya,
b,k,r,y,Id.FocusManager.instance(),Ka.App.xa.lq,Va.a.instance.$a("Box4.Accessibility.IAccessibilityContextManager"),Object(u.a)(n.AFrameworkApplication.ta.xM,n.AFrameworkApplication.ta.xM.mb,"registerHandler"))}static Etl(b,k,r,y){return Ju.Ftl(b,k,r,y)}}Ju.Nka=5E3;Object(m.a)(Ju,"FindReplaceActor",null,[]);var pA=c(202),lC=c(887),wz=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.KH},set:function(k){this.KH=k},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.sSb},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(k){return this._map.get(k)};b.prototype.insert=function(k,r){this.removeItem(k);r={key:k,fba:this.sSb,next:void 0,data:r};this.first||(this.first=r);this.sSb&&(this.sSb.next=r);this.sSb=r;this._map.set(k,r)};b.prototype.insertAfter=function(k,r,y){k=this._map.get(k);if(!k)return!1;y={key:r,fba:k,next:k.next,data:y};
var R=k.next;R&&(R.fba=y);k.next=y;this._map.set(r,y);return!0};b.prototype.insertBefore=function(k,r,y){k=this._map.get(k);if(!k)return!1;y={key:r,fba:k.fba,next:k,data:y};var R=k.fba;R&&(R.next=y);k.fba=y;this._map.set(r,y);return!0};b.prototype.removeItem=function(k){var r=this._map.get(k);r&&(this.first===r&&(this.first=r.next),this.sSb===r&&(this.sSb=r.fba),r.fba&&(r.fba.next=r.next),r.next&&(r.next.fba=r.fba),this._map.delete(k))};return b}();class qA{constructor(){this.type="heading"}}Object(m.a)(qA,
"NavPaneHeadingItem",null,[]);class Ku{constructor(){this.type="bookmark"}}Object(m.a)(Ku,"NavPaneBookmarkItem",null,[]);class qv{constructor(b,k,r,y,R,aa,ta){var Ya,xb;this.fb=b;this.hb=k;this.Ub=r;this.nl=y;this.Ci=R;this.mB=aa;this.KHj=ta;this.eUa=0;this.Vgd=new Map;this.IIg=!1;this.Izf={[1]:1,[0]:1,[2]:1};this.jxa=new Map;this.Evg=null===(Ya=n.AFrameworkApplication.K)||void 0===Ya?void 0:Ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.hPj=null===(xb=
n.AFrameworkApplication.K)||void 0===xb?void 0:xb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.IIg}set headingsReady(b){this.IIg=b}get iIb(){return this.eUa}get r7(){this.KTb&&0!=this.KTb.length()||(this.KTb=this.c$m());return this.KTb}set r7(b){this.KTb=b}get Ldc(){return this.kVj}set Ldc(b){this.Ldc&&(this.Ldc.isSelected=!1);b.isSelected=!0;this.kVj=b}jgf(b,k){return"bookmark"===b.type?b.text:k.id.toString()}c$m(){var b;
const k=new wz;var r=null===(b=this.Ci.value)||void 0===b?void 0:b.BEi;if(!r)return k;this.Vgd=new Map;b=r.dDd();let y;const R=[];for(;b;){const aa=this.Ci.value.Db(b.id);r=this.UVh(aa,R);null===r||void 0===r?void 0:r.forEach(ta=>{(y=this.IXh(ta,R))&&"heading"===y.type&&y.indentLevel<ta.indentLevel&&(1>=y.indentLevel?(y.isCollapsed=!1,ta.isHidden=!1):(y.isCollapsed=!0,ta.isHidden=!0));k.insert(this.jgf(ta,aa),ta)});b=b.next}return k}IXh(b,k){return"heading"===b.type?1<k.length?k[k.length-2]:void 0:
0<k.length?k[k.length-1]:void 0}t9f(b){var k;let r=ie.ParagraphReader.xBa(b),y=!1;9===r&&this.jxa.has(b.id.toString())&&(r=this.jxa.get(b.id.toString()),y=!0);const R=null===(k=this.r7.get(b.id.toString()))||void 0===k?void 0:k.data;if(R){if(R.indentLevel===r){k=xn.AParagraphNode.nU(b.characterData.trim());b=this.nl.value.p_d(b,!1);if(k!==R.text||R.hasBookmark!==b)return R.text=k,R.hasBookmark=b,!0;!y&&R.isPurelyADH&&(R.isPurelyADH=!1,--this.eUa);return!1}this.rVc();return!0}if(9===r)return this.ram(b)?
(this.rVc(),!0):!1;this.rVc();return!0}ram(b){var k;const r=this.nl.value.fcf(b,!1);b=null!==(k=this.Vgd.get(b.id.toString()))&&void 0!==k?k:0;if(b!==r.length)return!0;for(k=0;k<b;++k)if(!this.r7.get(r[k].yLa()))return!0;return!1}EUk(b){if(this.r7.get(b.id.toString())||this.nl.value.p_d(b,!1))return this.rVc(),!0;this.jxa.has(b.id.toString())&&(this.jxa.delete(b.id.toString()),--this.eUa);return!1}rVc(){var b,k=null===(b=this.Ci.value)||void 0===b?void 0:b.BEi;const r=new wz;this.eUa=0;if(k){this.Vgd=
new Map;var y=[];b=k.dDd();for(var R,aa;b;){const ta=this.Ci.value.Db(b.id);k=this.UVh(ta,y);null===k||void 0===k?void 0:k.forEach(Ya=>{var xb=this.jgf(Ya,ta);aa=this.IXh(Ya,y);this.QAn(xb,Ya,aa);r.insert(xb,Ya);"heading"===(null===R||void 0===R?void 0:R.type)&&(xb=R,xb.indentLevel>=Ya.indentLevel&&(xb.isCollapsed=void 0));R=Ya});b=b.next}}this.r7=r}QAn(b,k,r){var y,R;if(b=null===(y=this.KTb.get(b))||void 0===y?void 0:y.data)b.isSelected&&(k.isSelected=!0,this.Ldc=k),k.isHidden=b.isHidden;if(r){if(y=
null===(R=this.KTb.get(this.jgf(r,r.paragraphNode)))||void 0===R?void 0:R.data)r.isCollapsed=y.isCollapsed;r.isCollapsed?k.isHidden=!0:r.isHidden?(r.isCollapsed=!0,k.isHidden=!0):(r.isCollapsed=!1,k.isHidden=!1)}}UVh(b,k){var r=ie.ParagraphReader.xBa(b),y=!this.zrf(b);const R=this.fgm(r)&&y?!0:!1;y=this.jxa.has(b.id.toString())&&y;let aa=[];if(R)aa.push(this.kvh(b,r,!1,k));else if(y)this.eUa+=1,this.RFc&&(r=this.jxa.get(b.id.toString()),aa.push(this.kvh(b,r,!0,k)));else{let ta=0;this.nl.value.fcf(b,
!1).forEach(Ya=>{const xb=new Ku;xb.text=Ya.yLa();xb.isSelected=!1;xb.bookmarkManager=this.nl;xb.indentLevel=0<k.length?k[k.length-1].indentLevel+1:0;ta+=1;aa.push(xb)});this.Vgd.set(b.id.toString(),ta)}return aa}kvh(b,k,r,y){var R,aa;const ta=new qA;ta.text=xn.AParagraphNode.nU(b.characterData.trim());ta.indentLevel=k;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=r;this.hPj&&(ta.listMarker=this.Dgf(b));ta.hasBookmark=this.nl.value.p_d(b,!1);for(b=null===(R=y[y.length-1])||void 0===R?void 0:
R.indentLevel;b&&b>=k;)y.pop(),b=null===(aa=y[y.length-1])||void 0===aa?void 0:aa.indentLevel;(!b||b<k)&&y.push(ta);return ta}zrf(b){return this.fb.nc(b)&&0===this.fb.textLength(b,this.Izf[pA.a.Vi]|4)}b7k(b){(b=this.r7.get(b))&&(1==b.data.isCollapsed?this.S6i(b):this.b_l(b))}onClickHeading(b){var k;this.Ldc=b=null===(k=this.r7.get(b))||void 0===k?void 0:k.data;k=Ke.SelectionFactory.xe(b.paragraphNode,0);this.hb.setSelection(k);this.Ub.Kg(id.AFrame.Wo)}onClickBookmark(b){var k;this.Ldc=b=null===(k=
this.r7.get(b))||void 0===k?void 0:k.data;this.nl.value.Yjf(b.text);this.Ub.Kg(id.AFrame.Wo)}onShareHeadingClick(b){var k;n.AFrameworkApplication.Ne("NavPaneShareHeadingLink-Treatment;NavPaneShareHeadingLink-Control");if(b=null===(k=this.r7.get(b))||void 0===k?void 0:k.data)k=b.paragraphNode.getValue(wc.a.Nc),this.KHj.value.lvh(k)}H8f(b,k){const r=b.id.toString(),y=this.jxa.has(r);if(!y||this.jxa.get(r)!==k){this.jxa.set(r,k);if(this.RFc)return this.t9f(b);!this.Evg||y||this.r7.get(r)||(this.eUa+=
1)}return!1}ZTk(b){const k=b.id.toString(),r=this.jxa.has(k);if(r){this.jxa.delete(k);if(this.RFc)return this.t9f(b);this.Evg&&r&&!this.r7.get(k)&&--this.eUa}return!1}lbo(b){this.RFc=b;this.rVc()}f9f(b){var k;const r=null===(k=this.r7.get(b.id.toString()))||void 0===k?void 0:k.data;if(!r)return!1;b=this.Dgf(b);if(r.listMarker===b)return!1;this.Zio();return!0}A3e(b){var k;b=null===(k=this.r7.get(b.id.toString()))||void 0===k?void 0:k.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}S6i(b){var k=
b.data;1==k.isCollapsed&&(k.isCollapsed=!1);k=k.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>k;)r=b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.v1n(r):this.S6i(r));return b}b_l(b){var k=b.data;k.isCollapsed=!0;k=k.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>k;)r=b,b=r.next,r.data.isHidden=!0}v1n(b){const k=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>k;)b=b.next;return b}fgm(b){return 0<=b&&8>=b}Zio(){let b=this.r7.first;for(;b;){if("heading"===
b.data.type){const k=b.data;k.listMarker=this.Dgf(k.paragraphNode)}b=b.next}}Dgf(b){var k;if(b.kW instanceof lC.a)return this.rQl(null===(k=this.mB.v0a(b.kW))||void 0===k?void 0:k.Y2)}rQl(b){for(let k=0;k<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(k)?void 0:b}}Object(m.a)(qv,"NavPaneHeadingsManager",null,[]);var Vn=c(1523);class Zz{constructor(){this.ptb=this.jA=this.Nnc=this.qad=this.W=null}get name(){return"WordEditor.FindReplace"}zc(b){this.W=b;const k=new qv(Va.a.instance.resolve("Box4.IParagraphReader"),
Va.a.instance.resolve("Box4.ISelectionManager"),Id.FocusManager.instance(),Va.a.instance.Ze("WordEditor.Bookmark.IBookmarkManager"),new cg.a(()=>Ka.App.xa.jb.Xc.Ad),b.resolve("Box4.IListMarkerUtility"),b.Ze("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>k).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){Zz.Wb.io.continueWith(()=>{this.Wm()})}Wm(){if(Ka.App.Uag){const b=Ka.App.Bee;this.Nnc=Gs.FindReplaceUIManager.getInstance(b);
this.jA=oA.FindManager.createInstance(this.Nnc,ks.a.instance,Vn.a.instance,!0);this.ptb=this.jA.aJb;this.qad=Ju.Etl(this.Nnc,this.jA,this.ptb,b);this.qad.Vb();this.qad.y3();this.qad.IRf();Ka.App.xa.updateCommandUI()}}dispose(){this.Nnc&&this.Nnc.dispose()}static get Wb(){return null!=Zz.Pjg?Zz.Pjg:Zz.Pjg=Va.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Zz,"FindReplacePackageManager",null,[1,2]);class HB{constructor(){}Vaf(){return"_@_"+Ra.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+
"Z"}Ilo(b,k,r,y){k.NJn(b,y);k.Yl(b,Te.a.e8,!0);k.Yl(b,wc.a.lNa,!0);k.Yl(b,wc.a.fieldInstruction,HB.mIh(r));k.Yl(b,wc.a.Gq,15)}jak(b,k,r,y){const R=b.txd(y);k.Yl(R,Te.a.e8,!0);k.Yl(R,wc.a.Gq,47);k.Yl(R,wc.a.fieldInstruction,HB.mIh(r));b=b.txd(y);k.Yl(b,Te.a.e8,!0);k.Yl(b,wc.a.Gq,16);return[R.Bj,b.Bj]}ahl(b,k,r){b=b.txd(r);k.Yl(b,Te.a.e8,!0);k.Yl(b,wc.a.oEb,!0);return b.Bj}static mIh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(HB,"AtMentionHyperlinkConfigurator",null,[288]);class vC{constructor(b,
k,r){this.WSb=b;this.hb=k;this.pEc=this.S4h=this.Fbi=this.Pue=!1;this.uHf=this.uHf.bind(this);this.KHf=this.KHf.bind(this);this.IIf=this.IIf.bind(this);r&&r.execute(y=>{this.fia=y});Ho.a.Csd.zdf.then(y=>{this.S4h=!0;this.Fbi=y.isSuccess});this.pEc=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DismissOnSpaceAfterAtIsEnabled",!1)}JNi(){this.WSb.ENi(this.uHf);this.WSb.FNi(this.KHf);this.WSb.SNi(this.IIf)}btf(){return!1}uHf(b,k,r){var y,R;k=Date.now();if(this.fia)if(this.S4h&&
!this.Fbi)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var aa=null===(R=null===(y=this.hb.ib)||void 0===y?void 0:y.kb)||void 0===R?void 0:R.Tc;aa?(y=aa.node,ie.ParagraphReader.nc(y)?(R=ie.ParagraphReader.text(y),0>r||r>R.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):this.pEc&&1<b.length&&"@"===b.trimEnd()?(Ib.c(Jc.a.qGk,
!0,void 0,void 0,void 0,void 0),this.WSb.reset()):(this.Pue||(this.Pue=!0,this.fia.C0n(aa)),this.fia.P8f(r,r+b.length),b=R.substring(0,r)+b,this.fia.gbf(y,b,r,k))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}KHf(b){if(this.fia)this.fia.onKeyDown(b)}IIf(){this.Pue=
!1;this.fia&&this.fia.iph()}}Object(m.a)(vC,"ContextIQUserInitHandler",null,[283]);var eE=c(1683);class iv{constructor(){this.nz=null}get name(){return"WordEditor.AtMentions"}zc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new HB(b.resolve("Box4.IFeatureHelper"))).singleInstance();const k={crewAlias:iv.jpj,featureName:iv.Hqj,topLevelKpiName:iv.duj,vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new ei.a(Ga.Health.instance,new Vj.a,k)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>
{this.Wm()})}dispose(){}Wm(){n.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&this.W.$a("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(k=>{n.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(k=k&&n.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));k&&this.Eum()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}Eum(){(n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):
this.W.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("canvasAtMentions")).then(()=>{n.AFrameworkApplication.K.gq(()=>{this.Nmn()})})}Nmn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:n.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Znm()};this.nz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(k=>
{k.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&eE.a.C5c()?this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new vC(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.$a("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new lf(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.nz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),
this.W.resolve("Box4.ISelectionManager"),Bb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").JNi()})})}Znm(){var b,k;const r=null!==(b=n.AFrameworkApplication.sessionStartInfoSettings.Ring)&&
void 0!==b?b:"-1";b=null!==(k=n.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==k?k:"";return r===iv.Yoj&&b===iv.Xoj}}iv.Yoj="-4";iv.Xoj="DC2";iv.jpj="webasynccollabeng";iv.Hqj="AtMentions";iv.duj="AtMentionsFeatureUsage";Object(m.a)(iv,"PackageManager",null,[1,2]);var tr=c(1613),Oh=c(1353);class ur{constructor(b,k,r,y){this.ga=b;this.Jf=k;this._augLoopRuntimeManager=r;this.L0j=y;this.mra=0;this.Spd=this.iVb=!1;this.xyg=this.fFe=this.sze=this.tZg=0;this.o6a=null;this.HMg=this.iMg=
!1;this.BDj=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.qCj=[{id:`${Ul.Dbc}_${1}`},{id:`${Ul.Dbc}_${2}`},{id:`${Ul.Dbc}_${3}`},{id:Oh.a.Eyd},{id:Oh.a.cxd},{id:Oh.a.L_d},{id:Oh.a.I_d}];this.Rwj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];
this.k8c=new Map;this.FJj=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.SNj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.iMg=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.GenericSignalSchemaIsEnabled",!1);this.HMg=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingIntentIsEnabled",!1);this.Rzj=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",
!1);this.Jf.mb(this,tr.SearchSuggestionAnnotation.getTypeName());(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)||n.AFrameworkApplication.K.$("WordRecentLinksIsEnabled"))&&(n.AFrameworkApplication.K.$("IsO365CommercialHost")||n.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.k8c.set("InsertLink","InsertLinkFlyout");this.k8c.set("GraphicsEditor","");this.phj();this.Vb(this.ga)}pbn(b,k){const r=Date.now();this.sze&&1250>r-this.sze||this.psb||
(this.sze=r,this.o6a=b,this.Emd=this.BLl(k),this.Czn(),this.iMg?this.Uxn():this.Sxn())}GF(b,k){if(b.annotationType===tr.SearchSuggestionAnnotation.getTypeName()&&b.content&&k===Zq.a.getTypeName()&&(k=Date.now(),b=b.content,this.psb&&this.psb===b.correlationId)){window.clearTimeout(this.mra);this.psb=void 0;var r=b.menuSuggestions&&0<b.menuSuggestions.length,y=this.iVb;r&&(this.Vmo(b.menuSuggestions),this.Spd&&(y=!1));y&&this.tRi();v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify({["description"]:"[Zero term context menu] augloop response latency",
["correlationId"]:b.correlationId,["requestPreparationTime"]:this.fFe,["canvasContextRetrievalTime"]:this.xyg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-k,["latencyMs"]:k-this.tZg,["containsZTM"]:r,["shouldFallBack"]:this.iVb,["fallBack"]:y}))}}Vb(b){b.gb(ib.a.Cni,lc.a.application,this.Txn.bind(this),96)}BLl(b){const k=[],r=new Map,y=Date.now();for(const R of b){if(!R)continue;b=[];const aa={itemsMetadata:new Fc.a};for(let ta=0;ta<R.ControlList.length;ta++){const Ya=
R.ControlList[ta];if(Ya&&!Ya.ExternalId)continue;b.push(Ya.ExternalId);const xb={timeStamp:y,source:"FallbackZeroTermMenu",confidenceScore:-1};aa.itemsMetadata[Ya.ExternalId]=xb;r.set(Ya.ExternalId,xb)}k.push(appChrome.api.menuSection(b,R.Title,R.Lang,R.Id,aa))}return{sections:k,commands:r}}Rdj(b){return this.k8c.has(b)?this.k8c.get(b):b}BFa(b){const k={};for(const r of b)b=this.Rdj(r.suggestion),appChrome.selectors.isControlDefined(b)&&(k[b]=appChrome.selectors.getModelType(b));Ka.App.xa.TDd(k)}Ubm(b){return!appChrome.selectors.isControlDefined(b)||
appChrome.selectors.isControlDisabled(b)?!1:this.BDj.has(b)?this.Emd.commands.has(b):!0}kxh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.o6a})}xdb(b=!1){b=b?Yl.a.instance.Jnc:Yl.a.instance.xdb();const k=[],r=Date.now();for(let y of b)y.commandId&&k.push({Id:y.commandId,TimeElapsedSinceClick:(r-y.timeStamp)/1E3,ContentType:y.contentType,CommandSurface:y.commandSurface,InputMethod:y.$w});return k}G2b(){const b=Yl.a.instance.G2b(),k=[],r=Date.now();
for(let y of b)y.controlId&&k.push({Id:y.controlId,TimeElapsedSinceClick:(r-y.timeStamp)/1E3,ContentType:y.contentType,CommandSurface:y.commandSurface,InputMethod:y.$w});return k}tcf(){let b={semantic:tr.ObjectSemantic.CanvasContext,type:tr.ObjectSchemaType.WordCanvasContext,value:{contentType:this.o6a}};if(this.Rzj){const k=Date.now(),r=this.L0j.tcf(bh.a.instance.ib.kb);r&&r.value.contentType&&(b.value=r.value);this.xyg=Date.now()-k}return b}fQh(){const b=this.G2b(),k=this.xdb(),r=this.xdb(!0),y=
[];y.push({semantic:tr.ObjectSemantic.ControlIdHistory,type:tr.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:tr.SequenceType.ControlId,Sequence:b}});y.push({semantic:tr.ObjectSemantic.CommandIdHistory,type:tr.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:tr.SequenceType.CommandId,Sequence:k}});y.push({semantic:tr.ObjectSemantic.FilteredCommandIdHistory,type:tr.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:tr.SequenceType.CommandId,Sequence:r}});y.push(this.tcf());
return y}phj(){this._augLoopRuntimeManager.getSession().then(b=>this.k7c=b).catch(()=>{this.k7c=void 0})}Uxn(){const b=Date.now(),k=this.fQh(),r=[tr.IntentIds.ZeroTermMenu];this.HMg&&r.push(tr.IntentIds.Logging);this.fFe=Date.now()-b;this.I3f(null,r,k)}Txn(b,k,r){2===r&&(b=this.fQh(),this.I3f(null,[tr.IntentIds.Logging],b));return 32}Sxn(){const b=Date.now(),k={CommandClickedEvents:this.G2b(),CommandActionEvents:this.xdb(),ContentType:this.o6a};this.fFe=Date.now()-b;this.I3f(k)}I3f(b,k,r){if(b||r){var y=
new tr.SearchSuggestionSignal({correlationId:this.zpl(),intents:k,contextObjects:r,zeroTermMenuRequest:b});this.iVb=!!b||0<=(null===k||void 0===k?void 0:k.indexOf(tr.IntentIds.ZeroTermMenu));this.tZg=Date.now();this.psb=y.correlationId;this.mra=window.setTimeout(()=>{this.NYm(y.correlationId)},750);b=new Zq.l({parentPath:["Signal",tr.SearchSuggestionSignal.getTypeName()],items:[{id:Ra.a.create().toString(),body:y}]});this.k7c&&!this.k7c.isClosed?this.k7c.submitOperation(b):(this._augLoopRuntimeManager.submitOperation({operation:b}),
this.phj());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:y.correlationId,["shouldFallBack"]:this.iVb,["intents"]:k}))}else v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated")}zpl(){const b=Ra.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",b);return b}NYm(b){this.psb&&this.psb===b&&(this.psb=void 0,this.iVb&&this.tRi(),v.ULS.sendTraceTag(572057624,
1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.iVb})))}tRi(){const b=this.kxh(this.Emd.sections);appChrome.api.dispatch(b);this.Wqh()}Wqh(){this.Spd=!0}Lrn(b){var k,r;const y=[],R=new Map;if(!b||0===b.length)return y;for(const aa of b){if(!aa||!aa.controlIds||0===aa.controlIds.length)continue;b={controlIds:[],id:aa.id,title:aa.title,lang:aa.lang,data:{itemsMetadata:new Fc.a}};const ta="CommandsZTM"===aa.id;for(const Ya of aa.controlIds){if(R.has(Ya))continue;
if(ta&&b.controlIds.length>=this.SNj)break;const xb=null===(r=null===(k=aa.data)||void 0===k?void 0:k.itemsMetadata)||void 0===r?void 0:r[Ya];R.set(Ya,xb);b.controlIds.push(Ya);xb&&(b.data.itemsMetadata[Ya]=xb)}0<b.controlIds.length&&y.push(b)}return y}Czn(){this.Spd=!1;if(this.FJj){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}Vmo(b){this.Spd||(b=this.Uhl(b),0<b.length&&
appChrome.api.dispatch(b))}Uhl(b){const k=[];let r=[];var y=this.AFl();y&&0<y.length&&r.push(...y);(y=this.Sgl())&&r.push(y);Array.isArray(b)&&0<b.length&&(b=this.vsa(b))&&(b.id="CommandsZTM",r.push(b));(b=this.Kgl())&&r.push(b);r=this.Lrn(r);if(0===r.length)return[];k.push(this.kxh(r));this.Wqh();return k}AFl(){var b,k;const r=null===(b=this.Emd)||void 0===b?void 0:b.sections.filter(y=>{var R;return null===(R=y.id)||void 0===R?void 0:R.startsWith(Ul.ODh)});for(const y of r)if(null===(k=y.data)||
void 0===k?0:k.itemsMetadata)for(const R in y.data.itemsMetadata)y.data.itemsMetadata[R].source="PassThroughZeroTermMenu";return r}Sgl(){const b=this.sMh(this.qCj,"DefaultZeroTermMenu");return this.vsa(b)}Kgl(){const b=this.sMh(this.Rwj,"AdvertizedZeroTermMenu");return this.vsa(b)}sMh(b,k){const r=[];for(const y of b)y&&this.iXn(y)&&this.Emd.commands.has(y.id)&&r.push({suggestion:y.id,rankingScore:-1,suggestionSource:k});return r}iXn(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;
if(0===b.count)return!1;b.count--;return!0}vsa(b){const k=[],r={itemsMetadata:new Fc.a},y=Date.now();this.BFa(b);for(let R of b)b=this.Rdj(R.suggestion),this.Ubm(b)&&(k.push(b),r.itemsMetadata[b]={timeStamp:y,source:R.suggestionSource,confidenceScore:R.rankingScore});return 0<k.length?appChrome.api.menuSection(k,null,null,null,r):null}}Object(m.a)(ur,"AugLoopSearchSuggestionManager",null,[54,240]);class Ws{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}zc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",
()=>new ur(n.AFrameworkApplication.ya,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{Ho.a.Qm().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){M.a.instance.Pc(new Ws)}}
Object(m.a)(Ws,"PackageManager",null,[1,2]);var ez=c(333),Lp=c(933);class Ao extends Lp.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(Ao,"BootMessage",Lp.a,[]);var fD=c(1021);class gD{constructor(){this.PJ=null;this.IWm=b=>{if(b.target===this.PJ)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const k=x.a(b.data);this.N$d(k.api)?this.W6c.J(k.api).U9b(k.method,
k):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(k){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",k)}};this.W6c=new Na.a}bvf(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,k){let r=!1;try{this.PJ=new Worker(b);this.PJ.onmessage=this.IWm;const y=Object.assign(new Ao,
{api:0,method:0,scripts:k,documentUrl:document.URL});this.postMessage(y);this.bvf()&&fD.a.Cvj(this.PJ);r=!0}catch(y){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",y)}return r}postMessage(b){try{const k=x.c(b);this.PJ.postMessage(k)}catch(k){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",k)}}N$d(b){return this.W6c.ub(b)}h2j(b,k){this.N$d(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.W6c.Z(b,k)}Zjl(b){return this.N$d(b)?this.W6c.J(b):null}}Object(m.a)(gD,"WebWorker",null,[62]);class hD{constructor(){this.pbg=[]}rQk(b,k){if(k){var r=n.AFrameworkApplication.Dw(b.NWi,7),y=[];for(let R=0;R<b.yLb.length;R++){let aa;switch(b.yLb[R].format){case 5:case 6:aa=ez.a.veb(b.yLb[R].name);break;default:aa=b.yLb[R].name}y.push(n.AFrameworkApplication.Dw(aa,b.yLb[R].format))}try{const R=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),aa=new gD;
if(aa.create(R,y))for(this.pbg.push(aa),r=0;r<b.M$d.length;r++){const ta=k.vJk(aa,b.M$d[r]);ta&&aa.h2j(b.M$d[r],ta)}}catch(R){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",R.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(hD,"WebWorkerCollection",null,[]);class iD{constructor(b,k){this.kNe=new hD;if(b){b=b.create();for(let r=0;r<b.length;r++)this.kNe.rQk(b[r],k)}else v.ULS.sendTraceTag(50442779,
3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,k,...r){let y=!1;for(let aa=0;aa<this.kNe.pbg.length;aa++){var R=this.kNe.pbg[aa];R.N$d(b)&&((R=R.Zjl(b))?y=R.WYb(k,r)||y:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}y||v.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,k)}}Object(m.a)(iD,
"WebWorkerRouter",null,[19]);class IB{constructor(){this.D=this.ST=0}}Object(m.a)(IB,"LongTaskInfo",null,[]);class jD{constructor(b,k){this.cNe=null;this.YEm=r=>{if(r){var y=[];for(let R of r.getEntries())R.duration>=this.rvo&&(r=new IB,r.ST=R.startTime,r.D=Math.round(R.duration),y.push(r));if(0<y.length){let R;(R=this.qP).sendMessage.apply(R,[1,3].concat(y))}}};b.x3(this.YEm);this.qP=k}get rvo(){null==this.cNe&&(this.cNe=n.AFrameworkApplication.K?n.AFrameworkApplication.K.rc("WordHangDetectionHangThresholdTime",
2E3):2E3);return this.cNe}}Object(m.a)(jD,"HangDetector",null,[]);class kD{constructor(){this.VWg=null;this.n9l=b=>{for(let k of this.aN)k(b)};this.aN=[];this.jTb=0}x3(b){this.jTb||this.dQm();1===this.jTb&&this.aN.push(b)}XEm(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}dQm(){if(!this.jTb)if(this.XEm())try{this.VWg=new PerformanceObserver(this.n9l),this.VWg.observe({type:"longtask"}),
this.jTb=1}catch(b){this.jTb=2,v.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",b.message)}else this.jTb=2}}Object(m.a)(kD,"LongTaskListeners",null,[239]);class fz extends Lp.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}
Object(m.a)(fz,"SettingsMessage",Lp.a,[]);class ap{constructor(b){this.PJ=b}}Object(m.a)(ap,"WebWorkerApiMain",null,[]);class lD extends ap{constructor(b){super(b)}bvf(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}WYb(b,k){if(!k)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.Qrk(k);v.ULS.sendTraceTag(591972376,
3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}U9b(b,k){switch(b){case 14:this.aVl(k);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Qrk(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,
3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new fz,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:n.AFrameworkApplication.userSessionId,LocalCobaltSessionId:pk.a.instance.zQ,LocalCobaltMachineId:pk.a.instance.qFb,LocalCobaltClusterId:pk.a.instance.n9b,LocalCobaltSessionHasBackup:pk.a.instance.Gua,WaciiEnabledRequests:pk.a.instance.epa,
SettingsRoutedToServer:pk.a.instance.q_f,WacClusterId:n.AFrameworkApplication.af.h4});this.PJ.postMessage(b);return!0}aVl(b){this.bvf()&&b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.Zqo())}Zqo(){Object(gr.__awaiter)(this,void 0,void 0,function*(){try{const b=yield new fD.a.Dvj.WorkerUtilsTestClass(10);yield b.Gh(5);15==(yield b.counter)?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,
3007,10,"WorkerUtils failed with exception: {0}",b.message)}})}}Object(m.a)(lD,"InitializeWorkerApiMain",ap,[]);class mD extends Lp.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(mD,"CatchUpNetworkRequestWorkerRequestMessage",Lp.a,[]);class nD extends ap{constructor(b,k){super(b);this.DAc=k}WYb(b,k){if(4===b)return b=Object.assign(new mD,{rootQuerySignature:k[0],requestEndpoint:k[1],
appMode:k[2],activityFeedIsEnabled:k[3]}),this.PJ.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}U9b(b,k){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.DAc.hKn(k);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}
Object(m.a)(nD,"CatchUpNetworkRequestWorkerExternalApi",ap,[]);class JB extends Lp.a{constructor(){super();this.taskInfo=null}}Object(m.a)(JB,"HangDetectionMessage",Lp.a,[]);class wC extends Lp.a{constructor(){super();this.taskInfo=null}}Object(m.a)(wC,"ReportLongTasksMessage",Lp.a,[]);class xC extends ap{constructor(b){super(b)}WYb(b,k){if(!k)return v.ULS.sendTraceTag(591972370,3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(b){case 2:return this.Prk(k);
case 3:return this.zxn(k);default:return v.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}U9b(b){v.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}Prk(b){if(1!==b.length||"object"!==typeof b[0])return v.ULS.sendTraceTag(591972373,3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=Object.assign(new JB,{api:1,method:2,taskInfo:b[0]});this.PJ.postMessage(b);return!0}zxn(b){if(!b.length||!Object(Jb.a)(IB,b[0]))return v.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",b.length,0<b.length?Object(Jb.a)(IB,b[0]):!1),!1;b=Object.assign(new wC,{api:1,method:3,taskInfo:b});this.PJ.postMessage(b);return!0}}Object(m.a)(xC,"HangDetectionWorkerApiMain",
ap,[]);class gz extends Lp.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(m.a)(gz,"LocalInferenceMessage",Lp.a,[]);class oD{constructor(){this.prediction=this.context=null}}Object(m.a)(oD,"LocalInferenceOutput",null,[]);class Ew{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(m.a)(Ew,"TextPredictionConfig",null,[]);class Fw{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=
3}}Object(m.a)(Fw,"TextPredictionSettings",null,[]);class wx{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(wx,"TextPredictionDynamicPayload",null,[]);class hz extends ap{constructor(b,k){super(b);this.S0j=k}WYb(b,k){if(!k)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.Wrk(k);case 7:return this.Rrk(k);case 9:return this.Vrk(k);case 10:return this.Srk(k);case 13:return this.Trk(k);
case 14:return this.Urk(k);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}U9b(b,k){switch(b){case 9:this.$Vl(k);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}$Vl(b){b&&b.prediction&&(b=Object.assign(new oD,{prediction:b.prediction,context:b.context}),this.S0j.agh().zbn(b))}Rrk(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new gz,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.PJ.postMessage(b);return!0}Wrk(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new gz,{api:4,method:8,paragraphContent:b});this.PJ.postMessage(b);return!0}Vrk(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var k=b[0];b=b[1];k=Object.assign(new gz,{api:4,method:9,paragraphContent:b,context:k});this.PJ.postMessage(k);return!0}Srk(b){if(1>
b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new gz,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.PJ.postMessage(b);return!0}Trk(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new gz,{api:4,method:13,textPredictionConfig:this.oRh(b)});this.PJ.postMessage(b);return!0}Urk(b){if(1>b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Jb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new gz,{api:4,method:14,textPredictionConfig:this.oRh(b)});this.PJ.postMessage(b);return!0}getConfig(b=
null){return Object.assign(new Ew,{scriptDirectory:n.AFrameworkApplication.Q3+"/intelligence/",settings:Object.assign(new Fw,{extendedRankLimit:0}),modelFilesUrl:b})}oRh(b=null){return Object.assign(new Ew,{scriptDirectory:n.AFrameworkApplication.Q3+"/intelligence/",settings:Object.assign(new Fw,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(m.a)(hz,"LocalInferenceWorkerApiMain",ap,[]);class Qj extends ap{constructor(b){super(b);n.AFrameworkApplication.FK(()=>
{this.pTc()})}WYb(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}U9b(b){v.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}pTc(){const b=Object.assign(new Lp.a,{api:3,method:6});this.PJ.postMessage(b)}}Object(m.a)(Qj,"ShutdownWorkerApiMain",ap,[]);var fE=c(855),pD=c(603);class qD extends Lp.a{constructor(){super();this.args=null;this.numLogs=
0}}Object(m.a)(qD,"UlsWorkerMessage",Lp.a,[]);var yC=c(848),rD=c(977),sD=c(1037);class tD extends rD.a{constructor(b,k,r,y,R){super(b,k,r,y,R);this.wze=null;this.qHe=!1;if(this.$Ng=this.Huf())if(b=y.lb("ContentBaseUrl")?6:5,y=y.lb("AppScriptBaseName"))y=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",y+".{0}ulsworker.js"),y=ez.a.veb(y),y=n.AFrameworkApplication.Dw(y,b),yC.createWorker({createMode:"Thread"},{local:yC.paramInsideDef(sD.ulsWorkerInsideInit),
bao:yC.paramInsideDef(Object(sD.ulsWorkerInsideScript)(y))}).then(aa=>{aa.onClose=()=>{this.BLe=void 0};this.BLe=aa},aa=>{var ta=new Date;aa=`UlsWorkerDefererHost threw an error: ${this.pKm(aa)}`;console.error(aa);ta=new pD.a(ta.getTime(),3007,545653664,10,aa,0,!1,null,null);super.HW(ta);this.qHe=!0})}Huf(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}get yKm(){this.wze||(this.wze=Va.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));
return this.wze}lLa(b){this.qHe=b}HW(b){if(this.qHe)super.HW(b);else if(this.$Ng)null!=this.BLe&&this.BLe.call.HW(b);else{let k;(k=this.yKm).sendMessage.apply(k,[5,11].concat([b]))}}pKm(b){if(null==b||"object"!==typeof b)return"unknown";const k=String(b.name),r=String(b.message);return null!=b.stack?(b=String(b.stack),0<=b.indexOf(r)&&0<=b.indexOf(k)?b:`${k}: ${r}\n${b}`):0<=r.indexOf(k)?r:`${k}: ${r}`}}Object(m.a)(tD,"UlsWorkerDefererHost",rD.a,[]);class uD extends ap{constructor(b){super(b);this.wTg=
0;b=Va.a.instance.Pa("Common.IRefreshableAppSettings");this.qWb=new tD(fE.a.Ryd,!0,n.AFrameworkApplication.af,null!==b&&void 0!==b?b:n.AFrameworkApplication.K,b);b=v.ULS.host;null!=b&&b.A4b(this.qWb);v.ULS.Rkb(this.qWb);this.JOg=Qe.a.kf();this.RXj=2*n.AFrameworkApplication.K.rc("UlsWorkerStayAliveIntervalMS",6E4);this.qWb.lLa(!0)}WYb(b,k){if(11!==b||!k||1!==k.length||!Object(Jb.a)(pD.a,k[0]))return!1;if(Qe.a.kf()-this.JOg>this.RXj)return this.qWb.lLa(!0),this.qWb.HW(k[0]),v.ULS.sendTraceTag(570770058,
3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;b=Object.assign(new qD,{api:5,method:b,args:k[0],numLogs:this.wTg});this.wTg++;this.PJ.postMessage(b);return!0}U9b(b,k){void 0!==k&&null!==k&&12===b&&(this.JOg=Qe.a.kf(),this.qWb.lLa(!1))}}Object(m.a)(uD,"UlsWorkerApiMain",ap,[]);class vD{constructor(b){this.container=b}vJk(b,k){var r=null;switch(k){case 0:r=new lD(b);break;case 1:r=new xC(b);break;case 2:r=new nD(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));
break;case 3:r=new Qj(b);break;case 4:r=new hz(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:k=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);r=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);r=(k||r)&&n.AFrameworkApplication.mtd?new uD(b):null;break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",
k)}return r}}Object(m.a)(vD,"WordWebWorkerApiFactory",null,[238]);var zC=c(258);class $A{constructor(b,k){this.name=b;this.format=k}}Object(m.a)($A,"ImportedScript",null,[]);class wD{constructor(){this.M$d=this.yLb=this.NWi=null}}Object(m.a)(wD,"WebWorkerConfig",null,[]);var gE=c(1404);class AC{constructor(b){this.lJe=[];this.MKj=b;if(n.AFrameworkApplication.K){b=n.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||n.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const k=n.AFrameworkApplication.K.lb("ContentBaseUrl")?
6:5,r=n.AFrameworkApplication.K.lb("AppScriptBaseName"),y=b?"":".";if(r){const R=b?"":"{0}",aa=r+`${y}${R}worker.js`;this.lJe.push(new $A(`MicrosoftAjax${b?"":"DS"}.${R}js`,k),new $A(aa,k));this.Huf()&&this.lJe.push(new $A(r+`${y}${R}ulsworker.js`,k))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],k=Object.assign(new wD,{NWi:"workerboot",yLb:this.lJe,M$d:[0,1,2,3,4,5]});this.MKj&&this.Xdm()&&k.yLb.push(new $A("intelligence/edge-inference-web.js",5));b.push(k);return b}Xdm(){return(new zC.a("arrowFunction",()=>{try{Object(gE.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}Huf(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}}Object(m.a)(AC,"WordWebWorkerConfigFactory",
null,[236]);class BC{constructor(){this.Oa=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.Oa.appSettings,n.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}zc(b){this.W=b;this.Oa=this.W.resolve("Common.IAppSettingsManager");const k=this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new iD(new AC(k),new vD(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance();
b.ha("WordEditor.Workers.LongTaskListeners",()=>new kD).as("WordEditor.Workers.ILongTaskListeners").singleInstance();b.ha("WordEditor.Workers.HangDetector",()=>new jD(b.resolve("WordEditor.Workers.ILongTaskListeners"),b.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){M.a.instance.Pc(new BC)}}Object(m.a)(BC,"WordEditorWorkersPackage",null,[1,2]);var sy=c(1157);class vk{constructor(){this.rkd=[]}sZh(b,k){let r=-1,y=null;y=R=>{R?k(this.rkd[r]):(++r,r<this.rkd.length?this.rkd[r].$Yb(b,
y):k(null))};y(!1)}$Yb(b,k){this.sZh(b,r=>{k(!!r)})}Rcc(b,k,r){this.sZh(b,y=>{if(!y)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");y.Rcc(b,k,r)})}k$g(b){this.rkd.push(b)}}Object(m.a)(vk,"CompositeExternalContentURLResolver",null,[243,171]);var xD=c(1399);class aB extends xD.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.IFrameHtml=null}}Object(m.a)(aB,"ExternalContentEmbedResponse",xD.a,[]);var yD=c(1414),
zD=c(1828),AD=c(1756),BD=c(1324),CD=c(709),iz=c(692),ty=c(188),KB=c(849),Du;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.MGo=3]="externalContentFloatieConversion"})(Du||(Du={}));Object(m.b)("ExternalContentConversionContext",Du);class nh{constructor(){this.UEb=this.TEb=null;this.N8e=new BD.ExternalContentEmbedRetriever;this.Mvc=!0;this.wnc=this.Un=this.K7h=this.J7h=this.$l=this.lp=null;
this.picturePasteRequestSucceeded=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.dbc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=nh.gla&&nh.gla.hQh()}get FKb(){return this.Mvc}set FKb(b){this.Mvc=b}MVe(b,k){let r=!1;if(b){switch(b.contextId){case lc.a.Wc:r=!k;break;case lc.a.Hd:r=!0}r&&!KB.a(b.node)&&(r=!1)}return r}qpm(b){const k=b.startsWith(sh.HyperlinkReader.Fbc),r=b.startsWith(sh.HyperlinkReader.UVc),
y=b.startsWith(sh.HyperlinkReader.m1d);return(k||r||y)&&sh.HyperlinkReader.oNa(b)}jLi(){this.Un=G.a.create();nh.xf.Txb(this.Un,4);nh.xf.v3(this.Un,0,nh.xf.ho());this.SCb(this.TEb,3,this.UEb,!0)}BMa(b,k,r){this.Un=G.a.create();nh.xf.Txb(this.Un,r?0:2);nh.xf.v3(this.Un,0,nh.xf.ho());this.wnc();this.SCb(b,r?0:2,k)}K_d(b,k){this.Un=G.a.create();nh.xf.Txb(this.Un,1);nh.xf.v3(this.Un,0,nh.xf.ho());this.SCb(b,1,k)}QMd(b,k,r){if(!b||!b.isConnected||!Pd.ImageReader.Ov(b))return null;const y=new CD.a;y.setValue(Hk.a.j5b,
r);y.setValue(Hk.a.FZa,k);y.KWa=this.J7h;y.qw=this.K7h;y.c0a=1===r;Wd.GraphIterator.Za(b).Rf(y,2);this.JRc(y);return y}fNi(b){this.wnc=b}rge(b,k){const r=nh.F_.p0b(k)||0;k=nh.F_.qXa(k)||0;const y=b.Width/b.Height;1<=y?(b.Width=r,b.Height=r/y):(b.Height=k,b.Width=k/y)}kdg(b,k,r){if(null!=b&&null!=k&&!A.a.lf(r)){var y=nh.aTc.B3b(r);y.JEa=!0;y.hideFloatie=!0;this.rge(b,k.node);this.H5b(b,k,!1,!1,y,r)}}ueb(b){return b?b.Df:0}L$f(b,k,r){let y=null;const R=b.node;if(!ie.ParagraphReader.nc(R)||!R.isConnected)return{returnValue:!1,
$oa:y};if(r)return{returnValue:!0,$oa:b};r=b.cpBegin;const aa=b.cpEnd,ta=ie.ParagraphReader.text(R);if(0<=r&&aa<=ta.length&&ta.substring(r,aa)===k)return{returnValue:!0,$oa:b};const Ya=ta.indexOf(k);return 0<=Ya?(y=Re.a.createTextRange(R,Ya,Ya+k.length),{returnValue:!0,$oa:y}):0<=r&&aa<=ta.length&&this.M4b(b)?{returnValue:!0,$oa:b}:{returnValue:!1,$oa:y}}M4b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var k=Re.a.createTextRange(b.node,b.cpBegin,b.cpEnd);k=sh.HyperlinkReader.aD(k,!1);if(1===k.length){k=
k[0];const r=ie.ParagraphReader.text(b.node).substring(k.cpBegin,k.cpEnd).trim();if(b.cpEnd===k.cpEnd&&k.hyperlink.url!==r)return!0}return!1}Tuf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Ewa(b,k){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const r=Va.a.instance.$a("Common.ISystemInitiatedFeedback");r&&r.execute(y=>{y.logActivity(b,k)})},nh.Nka)}mef(b,k){const r=!A.a.S1(k);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,
k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}SCb(b,k,r,y=!1){if(this.qpm(r)){var R=nh.aTc.B3b(r);if(R)if(this.Tuf(R)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(ia.a)(Re.a,
b);var aa=!k;this.MVe(b,aa)?this.RNc(r)?(k=1===k,y=this.uul(b),R.hideFloatie=!0,this.H5b(y,b,aa,k,R,r)):this.cNf(b,k,R,r,y):nh.xf.VP(this.Un,2,"URL inserted in Non-Embedable context",nh.xf.ho())}else v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),nh.xf.VP(this.Un,2,"Size provided is not valid for OEmbed",nh.xf.ho())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),nh.xf.VP(this.Un,2,
"URL inserted is not valid for ExternalContent",nh.xf.ho())}uul(b){let k=new aB;k.Width=nh.F_.p0b(b.node)||0;k.Height=nh.F_.qXa(b.node)||0;k.Title="Fluid Component";k.MediaType="fluid";return k}RNc(b){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=nh.Nfa&&nh.Nfa.$ii(b)}cNf(b,k,r,y,R){const aa=!k,ta=1===k,Ya=nh.F_.p0b(b.node)||0,xb=nh.F_.qXa(b.node)||0,Mb=yD.a.oZe(r.d$f,!0,Ya,xb);this.qRc(b,y,k,!0);this.N8e.Rmh(Mb,cc=>{nh.xf.v3(this.Un,
4,nh.xf.ho());nh.xf.p_c(this.Un,this.ueb(cc.data));if(cc=this.iNf(cc)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var jc=ty.r(cc.MediaType);nh.xf.i3d(this.Un,7,jc);jc=b;({$oa:jc}=this.L$f(b,y,ta)).returnValue?(this.qRc(jc,y,k,!1),null==r.width?0<Ya&&cc.Width>Ya&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),cc.Width=Ya):(v.ULS.sendTraceTag(572618198,
324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),cc.Width=this.C4c(r.width,cc.Width,Ya)),null==r.height?0<xb&&cc.Height>xb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),cc.Height=xb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),cc.Height=this.C4c(r.height,cc.Height,xb)),nh.gla.s6a||R?this.H5b(cc,jc,aa,ta,
r,y):(this.TEb=b,this.UEb=y,this.OCc(y))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),nh.xf.VP(this.Un,2,"No conversion as the context is no longer valid for the external content conversion",nh.xf.ho()));ta&&this.yWa(jc.node)}else ta&&this.yWa(b.node),nh.xf.VP(this.Un,1,"URL not oEmbedable",nh.xf.ho())},cc=>{nh.xf.v3(this.Un,4,nh.xf.ho());nh.xf.p_c(this.Un,this.ueb(cc.data));ta&&this.yWa(b.node);
v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+cc.data.Ie);nh.xf.VP(this.Un,2,"ExternalContentEmbedRequest failed",nh.xf.ho())},cc=>{ta&&this.yWa(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+cc)},this.Un)}C4c(b,k,r){!b&&0<r&&k>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),k=r):b>r?k=r:b&&b<r&&(k=b);return k}H5b(b,k,r,y,
R,aa){this.$l=Ra.a.create();b.Width=b.Width/b.Height*(b.Height-(iz.a.pLd+iz.a.U9))+2*iz.a.U9;const ta=new sf.GraphTransaction(15);ta.Eb(k.node);ta.Al=Jc.a.BMa;const Ya=this.M4b(k);null!=R.JEa&&!R.JEa||y||Ya||(b.Title=""===R.title||R.title?R.title:b.Title,!b.Title&&""!==b.Title)||(k=this.Pof(k,ta,b.Title,aa,r));if(k){y&&(k=this.x3e(k));var xb=this.Mxd(k,y);if(xb){r=ty.r(b.MediaType);var Mb=this.QHd(b,r);this.J7h=b.IFrameHtml;this.K7h=b.Title;if(xb=this.wof(xb,Mb,ta,y,aa,r))ta.dDa(this.$l,1),ta.dispose(),
this.TEb=k,this.UEb=aa,this.jKf(R,b,xb),this.OMf(aa,y||R.hideFloatie,Ya,r,b.Title)}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),nh.xf.VP(this.Un,2,"Could not create IP context on splitting the paragraph",nh.xf.ho())}else nh.xf.VP(this.Un,2,"GraphNodeContext is null",nh.xf.ho())}QHd(b,k){const r=new Di.DictionaryPropertySet;nh.PL.F0d(r,b.Width,b.Height);b=this.lef(k,b.Title);r.setValue(Te.a.imageAltText,
b);r.setValue(wc.a.BT,Gc.a.ZF());r.setValue(wc.a.imageType,0);return r}wof(b,k,r,y,R,aa){if(!b)return null;b=nh.PL.WMd(b,k);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),nh.xf.VP(this.Un,2,"The anchored image could not be inserted",nh.xf.ho()),null;r=b.node;R=this.QMd(r,R,aa);nh.xf.i9f(this.Un,R.id);y||this.tYf(r);return r}jKf(b,k,r){A.a.S1(b.thumbnailUrl)||(k.Thumbnail=b.thumbnailUrl);k.Thumbnail&&k.Thumbnail.length&&
(nh.xf.v3(this.Un,8,nh.xf.ho()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.Wzd(r,k.Thumbnail))}OMf(b,k,r,y,R){k||this.OCc(b);this.Ewa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.LZd("IsHyperlinkWithNonURLDisplayText",r);this.ariaNotify(y,R);nh.xf.v3(this.Un,5,nh.xf.ho())}LZd(b,k){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new ha.a,
{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ca.a,{name:b,bool:k})]}))}ariaNotify(b,k){this.FKb&&nh.lw&&(b=this.mef(b,k),nh.lw.sendNotification(b,!0))}Pof(b,k,r,y,R){if(R){if((R=sh.HyperlinkReader.aD(b,!1))&&1!==R.length)return k.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;nh.hyperlinkEditor.VQ(R[0].paragraph,R[0].hyperlink)}return this.YTf(b,r,y)}x3e(b){const k=
b.node,r=ie.ParagraphReader.text(k);return 0<r.length&&!r.trim().length?(b=Re.a.createTextRange(k,0,r.length),nh.characterPropertiesEditor.replaceTextRange(b,""),Re.a.Uc(k,0)):b}Mxd(b,k){return k?b:this.hff(b)}hff(b){const k=ie.ParagraphReader.text(b.node),r=Wd.GraphIterator.Za(b.node);if(r.rd()){b=Re.a.Uc(b.node,b.cpEnd);xg.OutlineElementNavigator.Xd(r);const y=nh.Ug.Uta(r);nh.Kh.Hba(r,y,b,!0,!0,!0,!0);""!=k&&nh.Kh.TB(r,!1,!0);r.Ud();return Re.a.Uc(r.currentNode,0)}return null}iNf(b){if(!({group:b}=
vi.a.g8(b.data.Ie)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}YTf(b,k,r){const y=b.cpBegin+k.length;nh.characterPropertiesEditor.replaceTextRange(b,k);b=Re.a.createTextRange(b.node,b.cpBegin,y);nh.hyperlinkEditor.VG(b,r,!1);return b}lef(b,k){const r=!A.a.S1(k);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?
String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}Wzd(b,k){b.Di().contentReplicator.forceOutbound(()=>{this.gNf(k,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}JRc(b){b=Wd.GraphIterator.Za(b);b.Ab(12);b.kd(12);b.Gn.EP=!0}yWa(b){b.Zac=null}tYf(b){b=Wd.GraphIterator.Za(b);b.Ab(11)&&(b.kd(11),
b.rd()&&b.xj()&&b.Ud()&&ie.ParagraphReader.nc(b.currentNode)&&(b=Ke.SelectionFactory.xe(b.currentNode,0),bh.a.instance.setSelection(b)))}qRc(b,k,r,y){const R=b.cpBegin,aa=b.cpEnd;b=ie.ParagraphReader.text(b.node).trim();R||b!==k&&""!==b?R?aa===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y):0<R&&aa<b.length&&v.ULS.sendTraceTag(590958602,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Du[r],y)}OCc(b){this.v0b();const k=new Ru.a(1,n.AFrameworkApplication.isRtl);k.YUc=b;nh.Rcb.VWc(k)}v0b(){const b=new Wt.a(!0);nh.s7.YDa(b)}gNf(b,k){if(b=this.ghf(b,k))k=Array(1),k[0]=b,b=zD.a.construct(k,!1,n.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.lp.Es:null),k=this.y1e(),this.tkb(k,b)}ghf(b,k){if(!k)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.lp=k.Di();(new Wd.GraphIterator).set(k);
if(!k.anchor||!k.anchor.mr||!k.anchor.mr.zr)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=k.anchor.mr.zr.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;let y=ml.a.Eq;gh.a.instance.J(4)&&(y=r.ia(Gh.a.sK,ml.a.Eq));r=k.getValue(Te.a.gI);const R=Vf.a.uf(Pd.ImageReader.bD(k.properties),0),aa=Vf.a.uf(Pd.ImageReader.yI(k.properties),
1);return AD.a.construct(k.id.toString(),b,k.ia(Te.a.imageAltText,""),R,aa,k.ia(wc.a.PW,""),y,k.ia(wc.a.BT,0),k.ia(wc.a.vfa,!1),k.ia(Gh.a.pea,-1),k.ia(wc.a.Ahb,Box4Intl.Box4Strings.l_Picture),k.ia(Te.a.wfa,!1),r,k.ia(wc.a.runId,1),k.ia(wc.a.Nc,0))}tkb(b,k){n.AFrameworkApplication.af.Mj(b,2,x.c(k),{},!1,2,this.picturePasteRequestSucceeded,this.dbc,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}y1e(){let b=Oa.a.mEd("PicturePaste.ashx");
n.AFrameworkApplication.K&&!n.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Oa.a.Qn(b,Ri.a.fileId,this.lp.Es));b=Oa.a.Qn(b,Ri.a.cellId,this.lp.Xl.toString());this.$l||(this.$l=Ra.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Oa.a.Qn(b,Ri.a.e2,this.$l.toString());b=Oa.a.Qn(b,Ri.a.classId,(393233).toString());this.lp.pI&&(b=Oa.a.Qn(b,Ri.a.pI,this.lp.pI));b=Oa.a.Qn(b,Ri.a.Wmb,"1");b=Oa.a.Qn(b,Og.a.imageType,
"0");b=pk.a.instance.qPe(b);this.lp.contentReplicator&&this.lp.contentReplicator.yEb&&(b=Oa.a.Qn(b,Ri.a.JTe,"1"));b=Oa.a.Qn(b,Ri.a.Tra,this.lp.contentReplicator.ku.toString());b=Oa.a.Qn(b,Ri.a.Xac,"0");return b=Oa.a.Qn(b,Ri.a.WMb,"1")}static get Rcb(){return null!=nh.yjg?nh.yjg:nh.yjg=Va.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get gla(){nh.Sxa||(nh.Sxa=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return nh.Sxa}static get s7(){return null!=
nh.Fqg?nh.Fqg:nh.Fqg=Va.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get lw(){return null!=nh.rhg?nh.rhg:nh.rhg=Va.a.instance.resolve("Common.Utils.IAriaNotifier")}static get F_(){return null!=nh.yrg?nh.yrg:nh.yrg=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get PL(){return null!=nh.cmg?nh.cmg:nh.cmg=Va.a.instance.resolve("WordEditor.IImageEditor")}static get Ug(){return nh.Kh||(nh.Kh=Va.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=
nh.Slg?nh.Slg:nh.Slg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=nh.$hg?nh.$hg:nh.$hg=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get xf(){return null!=nh.Hjg?nh.Hjg:nh.Hjg=Va.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get aTc(){return null!=nh.qpg?nh.qpg:nh.qpg=Va.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get Nfa(){return null!=nh.jpg?nh.jpg:nh.jpg=Va.a.instance.resolve("Fluid.Host.LoopComponentManager")}}
nh.Kh=null;nh.Nka=5E3;nh.Sxa=null;Object(m.a)(nh,"ExternalContentEditor",null,[152]);var $z=c(265),DD=c(1203);class LB{constructor(b,k){this.s6a=!0;this.r1a=r=>{if(null!=r.result)return r.result.Value;v.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.s6a};this.pDa=r=>{r.jo||r.Ki?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.Mjh(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.s6a};this.Xu=b;this.MJ=k}hQh(){const b=new zh.a;this.$hi()&&this.MJ?this.MJ.m2a($z.a.sCc).CWRCo(this.r1a,0).CWRCo(this.pDa,8):b.Eg(this.s6a)}f0(b){this.MJ&&this.MJ.f0($z.a.sCc,new DD.a($z.a.sCc,b))}ZDn(b){this.$hi()&&(this.Xu.dha("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.Mjh(b),this.f0(b))}$hi(){const b=n.AFrameworkApplication.K.$("IsAnonymousUser");if(n.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Mjh(b){this.s6a=b}}Object(m.a)(LB,"ExternalContentSettingInfo",null,[247]);var hE=c(1130);class jz{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(jz,"FluidComponentProperties",
null,[]);class aA{constructor(){this.loopType=this.qw=this.KWa=this.url=null;this.mediaType=0;this.ypi=null}}Object(m.a)(aA,"IFrameProps",null,[]);class Uk{static get F_(){return null!=Uk.wrg?Uk.wrg:Uk.wrg=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get PL(){return Uk.tj||(Uk.tj=Va.a.instance.resolve("WordEditor.IImageEditor"))}static get lw(){return null!=Uk.qhg?Uk.qhg:Uk.qhg=Va.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
Uk.Nlg?Uk.Nlg:Uk.Nlg=Va.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ug(){return null!=Uk.Kpg?Uk.Kpg:Uk.Kpg=Va.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=Uk.Zhg?Uk.Zhg:Uk.Zhg=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static oNa(b){const k=b.startsWith(sh.HyperlinkReader.Fbc),r=b.startsWith(sh.HyperlinkReader.UVc),y=b.startsWith(sh.HyperlinkReader.m1d);return(k||r||y)&&sh.HyperlinkReader.oNa(b)}static MVe(b,k){let r=
!1;if(b){switch(b.contextId){case lc.a.Wc:r=!k;break;case lc.a.Hd:r=!0}r&&!KB.a(b.node)&&(r=!1)}return r}static M4b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var k=Re.a.createTextRange(b.node,b.cpBegin,b.cpEnd);k=sh.HyperlinkReader.aD(k,!1);if(1===k.length){k=k[0];const r=ie.ParagraphReader.text(b.node).substring(k.cpBegin,k.cpEnd).trim();if(b.cpEnd===k.cpEnd&&k.hyperlink.url!==r)return!0}return!1}static lef(b,k){const r=!A.a.S1(k);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static JRc(b){b=Wd.GraphIterator.Za(b);b.Ab(12);b.kd(12);b.Gn.EP=!0}static QHd(b,k,r,y){const R=new Di.DictionaryPropertySet;Uk.PL.F0d(R,k,b);b=Uk.lef(y,r);R.setValue(Te.a.imageAltText,b);R.setValue(wc.a.BT,Gc.a.ZF());R.setValue(wc.a.imageType,
0);return R}static QMd(b,k){if(!b||!b.isConnected||!Pd.ImageReader.Ov(b))return null;const r=new CD.a;r.setValue(Hk.a.j5b,k.mediaType);r.setValue(Hk.a.FZa,k.url);r.setValue(td.a.loopComponentType,k.loopType);r.KWa=k.KWa;r.qw=k.qw;r.c0a=1===k.mediaType;r.createMode=k.ypi;Wd.GraphIterator.Za(b).Rf(r,2);Uk.JRc(r);return r}static Mxd(b,k){return k?b:Uk.hff(b)}static hff(b){const k=ie.ParagraphReader.text(b.node),r=Wd.GraphIterator.Za(b.node);if(r.rd()){b=Re.a.Uc(b.node,b.cpEnd);xg.OutlineElementNavigator.Xd(r);
const y=Uk.Ug.Uta(r);Uk.Ug.Hba(r,y,b,!0,!0,!0,!0);""!=k&&Uk.Ug.TB(r,!1,!0);r.Ud();return Re.a.Uc(r.currentNode,0)}return null}static tYf(b){b=Wd.GraphIterator.Za(b);b.Ab(11)&&(b.kd(11),b.rd()&&b.xj()&&b.Ud()&&ie.ParagraphReader.nc(b.currentNode)&&(b=Ke.SelectionFactory.xe(b.currentNode,0),bh.a.instance.setSelection(b)))}static mef(b,k){const r=!A.a.S1(k);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,k):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,k){Uk.lw&&(b=Uk.mef(b,k),Uk.lw.sendNotification(b,!0))}static LZd(b,k,r){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new ha.a,{name:r,dataFields:[Object.assign(new ca.a,
{name:b,bool:k})]}))}}Object(m.a)(Uk,"ExternalContentHelper",null,[]);var Qv=c(918);class uy{constructor(){this.$l=this.lp=null}Wzd(b,k,r){b.Di().contentReplicator.forceOutbound(()=>{this.gNf(k,b,r)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}gNf(b,k,r){if(b=this.ghf(b,k))k=Array(1),k[0]=b,r=zD.a.construct(k,r,n.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.lp.Es:null),b=this.y1e(),this.tkb(b,
r)}ghf(b,k){if(!k)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.lp=k.Di();(new Wd.GraphIterator).set(k);if(!k.anchor||!k.anchor.mr||!k.anchor.mr.zr)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=k.anchor.mr.zr.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;let y=ml.a.Eq;gh.a.instance.J(4)&&(y=r.ia(Gh.a.sK,ml.a.Eq));r=k.getValue(Te.a.gI);const R=Vf.a.uf(Pd.ImageReader.bD(k.properties),0),aa=Vf.a.uf(Pd.ImageReader.yI(k.properties),1);return AD.a.construct(k.id.toString(),b,k.ia(Te.a.imageAltText,""),R,aa,k.ia(wc.a.PW,""),y,k.ia(wc.a.BT,0),k.ia(wc.a.vfa,!1),k.ia(Gh.a.pea,-1),k.ia(wc.a.Ahb,Box4Intl.Box4Strings.l_Picture),k.ia(Te.a.wfa,!1),r,k.ia(wc.a.runId,1),k.ia(wc.a.Nc,0))}tkb(b,k){n.AFrameworkApplication.af.Mj(b,2,x.c(k),{},!1,2,this.picturePasteRequestSucceeded.bind(this),
this.dbc.bind(this),null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}dbc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}y1e(){let b=Oa.a.mEd("PicturePaste.ashx");n.AFrameworkApplication.K&&!n.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&
(b=Oa.a.Qn(b,Ri.a.fileId,this.lp.Es));b=Oa.a.Qn(b,Ri.a.cellId,this.lp.Xl.toString());this.$l||(this.$l=Ra.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Oa.a.Qn(b,Ri.a.e2,this.$l.toString());b=Oa.a.Qn(b,Ri.a.classId,(393233).toString());this.lp.pI&&(b=Oa.a.Qn(b,Ri.a.pI,this.lp.pI));b=Oa.a.Qn(b,Ri.a.Wmb,"1");b=Oa.a.Qn(b,Og.a.imageType,"0");b=pk.a.instance.qPe(b);this.lp.contentReplicator&&this.lp.contentReplicator.yEb&&(b=Oa.a.Qn(b,
Ri.a.JTe,"1"));b=Oa.a.Qn(b,Ri.a.Tra,this.lp.contentReplicator.ku.toString());b=Oa.a.Qn(b,Ri.a.Xac,"0");return b=Oa.a.Qn(b,Ri.a.WMb,"1")}}Object(m.a)(uy,"ExternalContentThumbnailHelper",null,[]);class is extends uy{constructor(){super(...arguments);this.Un=null}static get xf(){return null!=is.Gjg?is.Gjg:is.Gjg=Va.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}hmj(b,k,r){return Uk.oNa(k)?Uk.MVe(b,r)?!0:(is.xf.VP(this.Un,2,"URL inserted in Non-Embedable context",is.xf.ho()),!1):(v.ULS.sendTraceTag(591267584,
324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),is.xf.VP(this.Un,2,"URL inserted is not valid for ExternalContent",is.xf.ho()),!1)}}Object(m.a)(is,"AbstractExternalContentEditor",uy,[152]);var ED=c(892),Lk=c(1158);class Ir extends is{constructor(b){super();Ir.dIa=b;this.txf()}txf(){(this.t$f||this.v4c)&&Lk.a.txf(Ir.dIa.Jdf())}static get paragraphEditor(){return null!=Ir.hqg?Ir.hqg:Ir.hqg=Va.a.instance.resolve("Box4.IParagraphEditor")}pLk(b,k){k=this.xVh(b,k);this.j$h(k,
b,5)}BMa(b,k,r){this.hmj(b,k,r)&&(r=this.xVh(b,null),r.url=k,this.j$h(r,b,2))}K_d(b,k){this.BMa(b,k,!1)}j$h(b,k,r){this.$l=Ra.a.create();const y=new sf.GraphTransaction(15);y.Eb(k.node);y.Al=Jc.a.r7l;const R=Uk.M4b(k),aa=ty.r(b.mediaType),ta=Uk.QHd(b.height,b.width,b.title,aa);k=this.zlo(k,1==r);(k=Uk.tj.WMd(k,ta))?(k=k.node,Uk.QMd(k,{url:b.url,mediaType:aa,qw:b.title,loopType:b.type,ypi:r})||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),y.dDa(this.$l,1),y.dispose(),
this.Wzd(k,b.thumbnail,this.gdm),this.e9m(R,aa,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}zlo(b,k){Uk.characterPropertiesEditor.replaceTextRange(b,"");return Uk.Mxd(b,k)}e9m(b,k,r){Uk.LZd("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Uk.ariaNotify(k,this.okl(r))}okl(b){switch(b){case Qv.a.CheckList:return"Checklist Component";case Qv.a.TaskAssignment:return"Task List Component";case Qv.a.Poll:return"Poll Component";
default:return"Fluid Component"}}xVh(b,k){let r=new jz;r.width=Uk.F_.p0b(b.node)||0;ty.j()?r.height=null!=Ir.dIa&&Ir.dIa.MQh(k)||Uk.F_.qXa(b.node)||0:r.height=null!=Ir.dIa&&Ir.dIa.MQh(k)+2*iz.a.U9||Uk.F_.qXa(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=k;r.thumbnail=this.vul(r.width,r.height);r.url=null!=Ir.dIa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return r}vul(b,k){return this.v4c?Ir.dIa.Jdf():
this.t$f?Lk.a.sul(b,k):Ir.dIa.Jdf()}get gdm(){return this.v4c?!1:this.t$f}get v4c(){return null!=this.Qtg?this.Qtg:this.Qtg=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}get t$f(){return null!=this.Stg?this.Stg:this.Stg=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabled",!1)}static RNc(b){n.AFrameworkApplication.Ne("04a02846;bab1g953");return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=Ir.dIa&&Ir.dIa.$ii(b)&&ED.a.QNc()}}Object(m.a)(Ir,"FluidComponentEditor",is,[]);class CC{get F7k(){return null!=this.xjg?this.xjg:this.xjg=Va.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get qDd(){return null!=this.Lkg?this.Lkg:this.Lkg=Va.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}$8m(b,k){b&&(Ir.RNc(k)?this.qDd.BMa(b,k,!0):this.F7k.BMa(b,k,!0))}}Object(m.a)(CC,"PostHyperlinkAutoCorrectStrategy",null,[245]);class bA{$Yb(b,k){k(bA.i9m.test(b))}Rcc(b,
k){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new aB,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:bA.thumbnailUrl,Title:"Power BI",IFrameHtml:b});k(b)}}bA.i9m=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");bA.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(bA,"PowerBIURLResolver",null,[243,171]);class cA{constructor(b){this.S5g=b}$Yb(b,k){let r=!1;try{if(cA.pnm(b)){const y=this.S5g.B3b(b);r=null!=y.width&&null!=y.height&&!!y.thumbnailUrl&&!!y.title&&null!=y.JEa}}catch(y){}k(r)}Rcc(b,k){var r=this.S5g.B3b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new aB,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});k(r)}static pnm(b){for(let k of cA.W6n)if(b.startsWith(k))return!0;return!1}static dea(){return new cA(Va.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}cA.W6n=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(cA,"WedgeComponentExperimentsURLResolver",null,[243,
171]);class DC{constructor(b,k,r){this.ga=b;this.xFj=k;this.Mk=r}Vb(){this.ga.gb(Jc.a.p$h,lc.a.Wc,this.K7l.bind(this),1028);this.ga.gb(Jc.a.HMc,lc.a.Wc,this.Aof.bind(this),1028);this.ga.gb(Jc.a.wMc,lc.a.Wc,this.Aof.bind(this),1028);this.ga.gb(Jc.a.Kof,lc.a.Wc,this.Aof.bind(this),1028);this.ga.gb(Jc.a.$li,lc.a.Wc,this.Grj.bind(this),1028)}K7l(){return 32}Aof(b,k,r){var y,R;if(1===r){if(!this.QNc(b)||!Kg.a.WOd())return 2;Pg.k1f(Pg.H9n);if(!k.Xk||!rf.SelectionEditor.zf(k)||cs.a.Hwd&&(null===(y=this.Mk)||
void 0===y?0:y.mZ(k))||(null===(R=this.Mk)||void 0===R?0:R.fua(k)))return 2;if(k&&k.node&&KB.a(k.node))return 32}else if(2===r)return this.xFj.pLk(k,DC.tul(b)),32;return 2}QNc(b){return b===Jc.a.wMc||b===Jc.a.HMc?ED.a.QNc():!0}Grj(b,k,r){2===r&&A.a.$W("https://go.microsoft.com/fwlink/?linkid=2194838")&&Ka.App.mWf.ohc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static tul(b){switch(b){case Jc.a.HMc:return Qv.a.TaskAssignment;case Jc.a.wMc:return Qv.a.CheckList;case Jc.a.Kof:return Qv.a.Poll;
default:return null}}}Object(m.a)(DC,"FluidComponentsActor",null,[]);class Dj extends is{constructor(){super();this.UEb=this.TEb=null;this.N8e=new BD.ExternalContentEmbedRetriever;this.wnc=null;null!=Dj.gla&&Dj.gla.hQh()}jLi(){this.Un=G.a.create();Dj.xf.Txb(this.Un,4);Dj.xf.v3(this.Un,0,Dj.xf.ho());this.SCb(this.TEb,3,this.UEb,!0)}BMa(b,k,r){this.Un=G.a.create();Dj.xf.Txb(this.Un,r?0:2);Dj.xf.v3(this.Un,0,Dj.xf.ho());this.wnc();this.SCb(b,r?0:2,k)}K_d(b,k){this.Un=G.a.create();Dj.xf.Txb(this.Un,1);
Dj.xf.v3(this.Un,0,Dj.xf.ho());this.SCb(b,1,k)}fNi(b){this.wnc=b}rge(b,k){const r=Dj.F_.p0b(k)||0;k=Dj.F_.qXa(k)||0;const y=b.Width/b.Height;1<=y?(b.Width=r,b.Height=r/y):(b.Height=k,b.Width=k/y)}kdg(b,k,r){if(null!=b&&null!=k&&!A.a.lf(r)){var y=Dj.aTc.B3b(r);y.JEa=!0;y.hideFloatie=!0;this.rge(b,k.node);this.H5b(b,k,!1,!1,y,r)}}ueb(b){return b?b.Df:0}L$f(b,k,r){let y=null;const R=b.node;if(!ie.ParagraphReader.nc(R)||!R.isConnected)return{returnValue:!1,$oa:y};if(r)return{returnValue:!0,$oa:b};r=b.cpBegin;
const aa=b.cpEnd,ta=ie.ParagraphReader.text(R);if(0<=r&&aa<=ta.length&&ta.substring(r,aa)===k)return{returnValue:!0,$oa:b};const Ya=ta.indexOf(k);return 0<=Ya?(y=Re.a.createTextRange(R,Ya,Ya+k.length),{returnValue:!0,$oa:y}):0<=r&&aa<=ta.length&&Uk.M4b(b)?{returnValue:!0,$oa:b}:{returnValue:!1,$oa:y}}Tuf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Ewa(b,k){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$(k)&&window.setTimeout(()=>{const r=
Va.a.instance.$a("Common.ISystemInitiatedFeedback");r&&r.execute(y=>{y.logActivity(b,k)})},Dj.Nka)}SCb(b,k,r,y=!1){if(this.hmj(b,r,!k)){var R=Dj.aTc.B3b(r);R&&(this.Tuf(R)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.cNf(b,k,R,r,y)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Dj.xf.VP(this.Un,2,"Size provided is not valid for OEmbed",Dj.xf.ho())))}}cNf(b,k,r,y,R){const aa=!k,ta=1===k,Ya=
Dj.F_.p0b(b.node)||0,xb=Dj.F_.qXa(b.node)||0,Mb=yD.a.oZe(r.d$f,!0,Ya,xb);this.qRc(b,y,k,!0);this.N8e.Rmh(Mb,cc=>{Dj.xf.v3(this.Un,4,Dj.xf.ho());Dj.xf.p_c(this.Un,this.ueb(cc.data));if(cc=this.iNf(cc)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var jc=ty.r(cc.MediaType);Dj.xf.i3d(this.Un,7,jc);jc=b;({$oa:jc}=this.L$f(b,y,ta)).returnValue?(this.qRc(jc,y,k,!1),null==r.width?0<Ya&&cc.Width>Ya&&(v.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),cc.Width=Ya):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),cc.Width=this.C4c(r.width,cc.Width,Ya)),null==r.height?0<xb&&cc.Height>xb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),cc.Height=xb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
cc.Height=this.C4c(r.height,cc.Height,xb)),Dj.gla.s6a||R?this.H5b(cc,jc,aa,ta,r,y):(this.TEb=b,this.UEb=y,this.OCc(y))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Dj.xf.VP(this.Un,2,"No conversion as the context is no longer valid for the external content conversion",Dj.xf.ho()));ta&&this.yWa(jc.node)}else ta&&this.yWa(b.node),Dj.xf.VP(this.Un,1,"URL not oEmbedable",Dj.xf.ho())},cc=>{Dj.xf.v3(this.Un,
4,Dj.xf.ho());Dj.xf.p_c(this.Un,this.ueb(cc.data));ta&&this.yWa(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+cc.data.Ie);Dj.xf.VP(this.Un,2,"ExternalContentEmbedRequest failed",Dj.xf.ho())},cc=>{ta&&this.yWa(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+cc)},this.Un)}C4c(b,k,r){!b&&0<r&&k>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
k=r):b>r?k=r:b&&b<r&&(k=b);return k}H5b(b,k,r,y,R,aa){this.$l=Ra.a.create();b.Width=b.Width/b.Height*(b.Height-(iz.a.pLd+iz.a.U9))+2*iz.a.U9;const ta=new sf.GraphTransaction(15);ta.Eb(k.node);ta.Al=Jc.a.BMa;const Ya=Uk.M4b(k);null!=R.JEa&&!R.JEa||y||Ya||(b.Title=""===R.title||R.title?R.title:b.Title,!b.Title&&""!==b.Title)||(k=this.Pof(k,ta,b.Title,aa,r));if(k){y&&(k=this.x3e(k));var xb=Uk.Mxd(k,y);if(xb){r=ty.r(b.MediaType);var Mb=Uk.QHd(b.Height,b.Width,b.Title,r);(xb=this.wof(xb,Mb,y,{url:aa,KWa:b.IFrameHtml,
qw:b.Title,mediaType:r}))?(ta.dDa(this.$l,1),ta.dispose(),this.TEb=k,this.UEb=aa,this.jKf(R,b,xb),this.OMf(aa,y||R.hideFloatie,Ya,r,b.Title)):ta.dispose()}else ta.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Dj.xf.VP(this.Un,2,"Could not create IP context on splitting the paragraph",Dj.xf.ho())}else Dj.xf.VP(this.Un,2,"GraphNodeContext is null",Dj.xf.ho())}wof(b,k,r,y){if(!b)return null;b=Dj.PL.WMd(b,k);
if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Dj.xf.VP(this.Un,2,"The anchored image could not be inserted",Dj.xf.ho()),null;b=b.node;y=Uk.QMd(b,y);Dj.xf.i9f(this.Un,y.id);r||Uk.tYf(b);return b}jKf(b,k,r){A.a.S1(b.thumbnailUrl)||(k.Thumbnail=b.thumbnailUrl);k.Thumbnail&&k.Thumbnail.length&&(Dj.xf.v3(this.Un,8,Dj.xf.ho()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.Wzd(r,k.Thumbnail,!1))}OMf(b,k,r,y,R){k||this.OCc(b);this.Ewa("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Uk.LZd("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions");Uk.ariaNotify(y,R);Dj.xf.v3(this.Un,5,Dj.xf.ho())}Pof(b,k,r,y,R){if(R){if((R=sh.HyperlinkReader.aD(b,!1))&&1!==R.length)return k.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;
Uk.hyperlinkEditor.VQ(R[0].paragraph,R[0].hyperlink)}return this.YTf(b,r,y)}x3e(b){const k=b.node,r=ie.ParagraphReader.text(k);return 0<r.length&&!r.trim().length?(b=Re.a.createTextRange(k,0,r.length),Uk.characterPropertiesEditor.replaceTextRange(b,""),Re.a.Uc(k,0)):b}iNf(b){if(!({group:b}=vi.a.g8(b.data.Ie)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}YTf(b,k,r){const y=b.cpBegin+k.length;Uk.characterPropertiesEditor.replaceTextRange(b,k);b=Re.a.createTextRange(b.node,b.cpBegin,
y);Uk.hyperlinkEditor.VG(b,r,!1);return b}yWa(b){b.Zac=null}qRc(b,k,r,y){const R=b.cpBegin,aa=b.cpEnd;b=ie.ParagraphReader.text(b.node).trim();R||b!==k&&""!==b?R?aa===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y):0<R&&aa<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Du[r],y):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Du[r],y)}OCc(b){this.v0b();const k=new Ru.a(1,n.AFrameworkApplication.isRtl);k.YUc=b;Dj.Rcb.VWc(k)}v0b(){const b=
new Wt.a(!0);Dj.s7.YDa(b)}static get Rcb(){return null!=Dj.zjg?Dj.zjg:Dj.zjg=Va.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get gla(){Dj.Sxa||(Dj.Sxa=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Dj.Sxa}static get s7(){return null!=Dj.Gqg?Dj.Gqg:Dj.Gqg=Va.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get F_(){return null!=Dj.xrg?Dj.xrg:Dj.xrg=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get PL(){return null!=
Dj.bmg?Dj.bmg:Dj.bmg=Va.a.instance.resolve("WordEditor.IImageEditor")}static get aTc(){return null!=Dj.ppg?Dj.ppg:Dj.ppg=Va.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Dj.Nka=5E3;Dj.Sxa=null;Object(m.a)(Dj,"ExternalContentEditorV2",is,[]);class EC{constructor(){this.Ic=this.W=null}get name(){return"WordEditor.ExternalContent"}get Wb(){return this.Ic?this.Ic:this.Ic=this.W.resolve("Box4.IFeatureHelper")}zc(b){this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",
()=>new sy.a(Al.a.instance,np.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new CC).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new LB(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Dj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new Ir(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new DC(n.AFrameworkApplication.ya,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),
mh.a.instance)).singleInstance()):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new nh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Wb.io.continueWith(()=>{this.Wm()});n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Vb()}dispose(){}hLk(){const b=new vk;this.GEh()&&b.k$g(cA.dea());b.k$g(new bA);return b}Wm(){null==n.AFrameworkApplication.K||
n.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new hE.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.GEh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.hLk()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}GEh(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",
!1)}static main(){M.a.instance.Pc(new EC)}}Object(m.a)(EC,"ExternalContentPackage",null,[1,2]);var Gw;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.qEo=7]="bar";b[b.Xfa=8]="num"})(Gw||(Gw={}));Object(m.b)("TabStopValues",Gw);class no{}no.azh=8;no.pTk=1;no.l6="wwaengidc";no.kpiName="WordRuler";no.precision=.0625;no.E8n=1;no.rro="ShowHideRuler";Object(m.a)(no,
"Constants",null,[]);var FD=c(393),MB=c(757);class Jr{static R3b(b,k){if(!Jr.gPc)return null;switch(b){case "Left":return r=>{const y=r.rulerCanvasProps;r=r.indents;return{cFb:0,yJb:y.scale-(y.margins[1].value+r[2].value+Math.max(r[0].value,r[1].value)+8*y.precision)}};case "Right":return r=>{const y=r.rulerCanvasProps;r=r.indents;return{cFb:0,yJb:y.scale-(r[2].value+(y.margins[0].value+Math.max(r[0].value,r[1].value))+8*y.precision)}};case "MoveTableColumn":return()=>{let r=0,y=0;if(0===k){var R=
{};32===Jr.wc.Xb(Wa.a.Vbc,2,R)&&(r=Rg.a.mC(R.MinIndent),y=Rg.a.mC(R.MaxIndent))}else R={eo:k-1},32===Jr.wc.Xb(Wa.a.Ubc,2,R)&&(r=Rg.a.mC(R.MinResize),y=Rg.a.mC(R.MaxResize));return{cFb:r,yJb:y}};case "Top":return r=>{r=r.rulerCanvasProps;return{cFb:0,yJb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{cFb:0,yJb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static fId(b){if(!Jr.gPc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return k=>
{var r=k.rulerCanvasProps,y=k.indents,R=k.ipContextIndex;k=r.margins;var aa=r.scale;r=r.precision;if("MoveTableColumn"!==k[0].type){R=k[0].value;k=k[1].value+y[2].value;var ta=R;"LeftIndent"===b&&(ta+=Math.max(y[0].value,y[1].value));y=-1*R;r=aa-(ta+k+8*r)}else{aa=0;for(ta=0;ta<=R;ta++)aa+=k[ta].value;ta=0;if("LeftIndent"===b){ta=y[0].value;const Ya=y[1].value;aa+=Math.max(ta,Ya);ta=Math.max(ta,Ya)}k=k[R+1].value;ta+=y[2].value;y=-1*aa;r=k-ta-r}return{cFb:y,yJb:r}};case "RightIndent":return k=>{var r=
k.rulerCanvasProps,y=k.indents,R=k.ipContextIndex,aa=r.margins;k=r.scale;r=r.precision;if("MoveTableColumn"!==aa[0].type){var ta=aa[0].value;aa=aa[1].value;R=y[0].value;var Ya=y[1].value;y=-1*aa;k-=ta+aa+Math.max(R,Ya)+8*r}else{ta=0;for(Ya=0;Ya<=R;Ya++)ta+=aa[Ya].value;aa=aa[R+1].value;R=y[0].value;Ya=y[1].value;y=-1*(k-ta-aa);k=aa-Math.max(R,Ya)-r}return{cFb:y,yJb:k}}}return null}static oJl(){return b=>{var k=b.rulerCanvasProps,r=b.indents,y=b.ipContextIndex,R=k.margins;b=k.precision;k=k.scale;"MoveTableColumn"!==
R[0].type?(y=R[0].value,R=R[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=k-(y+R+b)):(k=r[2].value,R=R[y+1].value,r=Math.min(r[0].value,r[1].value)+b,b=R-(k+b));return{cFb:r,yJb:b}}}static get wc(){return null!=Jr.jhg?Jr.jhg:Jr.jhg=n.AFrameworkApplication.ya}static get gPc(){null==this.h8a&&(n.AFrameworkApplication.a7("WoRul910;WoRul910cf"),this.h8a=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):
!1);return this.h8a}}Jr.h8a=null;Object(m.a)(Jr,"RulerPropertyBoundaryHelper",null,[]);var dA=c(909),oo;(function(b){b[b.appChromeReady=0]="appChromeReady";b[b.appChromeLazyReady=1]="appChromeLazyReady"})(oo||(oo={}));Object(m.b)("WoncaAppChromeState",oo);const FC=b=>{ni.c()?b():v.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},NB=(b,k)=>{const r=Va.a.instance.Pa("Wonca.IWoncaAppChromeStateManager");r?r.Gl(b,()=>{FC(k)}):FC(k)};var iE=c(1220),jE=c(1221);class hu{constructor(b,k,r,y,
R,aa){this.i2m="OutlineContainer";this.x_j="UpdateCustomTabFailed";this.htb="ReadRulerPropertiesFailed";this.B_j="UpdateIndentFailed";this.H5g="UpdateMarginFailed";this.Om=b;this.fTb=k;this.ga=r;this.$Fe=y;this.BC=R;this.HY=aa;this.sQb=null;this.gw=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.S2}UA(){this.ePe();this.o$g();this.fTb.ml.Ve(10).qp(Object(u.a)(this,this.NTc,"onOutlinePropertyChanged"));Af.a.addHandler(this.IMe,Kb.a.scroll,Object(u.a)(this,this.Zjj,"updateRulerLocationOnScroll"));
this.Om.execute(k=>{k.z7(Object(u.a)(this,this.Xr,"onZoomChanged"))});const b=[this.Ugf(),document.getElementById(Rh.AppFrame.M4c),document.getElementById("PageContentContainer")];this.sQb?this.sQb.register(b,Object(u.a)(this,this.FFa,"updateRulerLocation")):NB(oo.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(k=>{this.sQb=k.createResizeObserver();this.sQb.register(b,Object(u.a)(this,this.FFa,"updateRulerLocation"));return null})});Ka.App.xa.Bu.registerBoundingWindowRectsChanged("documentPanel",
(k,r)=>{"undefined"!==r&&this.D4a([1,0])})}Ugf(){return 1===this.HY.Qw?this.ARj:this.WQj}get IMe(){return document.getElementById(Rh.AppFrame.SFa)}get WQj(){const b=document.getElementsByClassName(this.i2m);return b&&0<b.length?b[0]:null}get ARj(){var b=this.BC.P1b;if(!b)return null;b=this.LFn(ie.ParagraphReader.eQ(b));return dA.a.nXh(b)}LFn(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}CYd(b){b.button===Sys.UI.MouseButton.rightButton&&this.$Fe.show(new Sys.UI.Point(b.clientX,
b.clientY),2)}Zjj(){this.FFa()}get OM(){return this.Om&&this.Om.instance?this.Om.instance.vj:no.pTk}n3b(){const b={};return 32!==this.ga.Xb(Wa.a.VDa,2,b)?(v.ULS.sendTraceTag(529065947,iE.a.msoulscat_Wac_WordRuler,jE.a.warning,"Unable to read page properties for Ruler"),om.recordQosError(this.htb,[om.dda],"Unable to read page properties for Ruler"),null):b}dispose(){this.p6h();this.fTb.ml.Ve(10).CX(Object(u.a)(this,this.NTc,"onOutlinePropertyChanged"));Af.a.removeHandler(this.IMe,Kb.a.scroll,Object(u.a)(this,
this.Zjj,"updateRulerLocationOnScroll"));this.Om.execute(b=>{b.Sjb(Object(u.a)(this,this.Xr,"onZoomChanged"))});this.sQb&&this.sQb.dispose();Ka.App.xa.Bu.unregisterBoundingWindowRectsChanged("documentPanel",(b,k)=>{"undefined"!==k&&this.D4a([1,0])})}get ggi(){null==hu.gve&&(hu.gve=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&n.AFrameworkApplication.K.$("RulerThemingIsEnabled"):
!1);return hu.gve}}hu.gve=null;Object(m.a)(hu,"ARuler",null,[306]);var Fq=c(313);class js extends hu{constructor(b,k,r,y,R,aa,ta){super(b,k,r,R,aa,ta);this.X2="HorizontalRuler";this.Ppj="CustomTabModificationFromRuler";this.mrj="IndentModificationFromRuler";this.Ife="MarginModificationFromRuler";this.cJg=this.bJg=this._tabStops=null;if(FD.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Uqa=y;else{const Ya=y();this.Uqa=()=>Ya}this.vv={}}get LW(){return this.bJg}get TBa(){return this.cJg}renderRuler(){this.LW.classList.remove("HideWACHorizontalRulerContainer");
this.LW.classList.add("ShowWACHorizontalRulerContainer");var b=this.n3b();if(b){var k=Object(u.a)(this,this.THf,"onMarginChange"),r=Object(u.a)(this,this.HVm,"onIndentChange"),y=Object(u.a)(this,this.vTm,"onCustomTabChange"),R=this.c3c(),aa=this.Mej(),ta=this.Lej();R&&aa&&ta||(this.vv.disabled=!0);this.vv.onIndentChange=r;this.vv.onMarginChange=k;this.vv.onTabChange=y;this.FFa();b=Vf.a.Ri(b.Oo,0);this.TBa.style.width=(b*this.OM).toString()+"px";return this.Uqa().then(Ya=>{Ya.renderRuler(this.TBa,
this.vv)})}}vTm(b,k,r){if(!(b>=this._tabStops.length)){b=this._tabStops[b];var y="Modify"===r?this.ga.Xb(Jc.a.$9b,2,{["tabStop"]:b,["value"]:Rg.a.GA(k)}):this.ga.Xb(Jc.a.q2a,2,b);if(32===y){k=1;var R=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",r,Gw[b.Kba]);v.ULS.sendTraceTag(591213271,3014,50,R)}else k=0,R=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",r,Gw[b.Kba]),v.ULS.sendTraceTag(591213272,3014,15,R),om.recordQosError(this.x_j,
[om.dda],"Unable to modify custom tab using ruler");Ib.a(this.Ppj,32===y,void 0,[Object.assign(new ca.a,{name:"Operation",string:r}),Object.assign(new ca.a,{name:"TabType",int64:Gw[b.Kba]})]);r=new Map;r.set("Command","OnCustomTabChange");r.set("Source",this.X2);r.set("Response",R);Ga.Health.instance.recordKpiUsage(no.kpiName,k,no.l6,r)}}Lej(){const b=[];var k={};if(32!==this.ga.Xb(Jc.a.lIb,2,k))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),om.recordQosError(this.htb,
[om.dda],"Unable to read paragraph tabs for Ruler"),!1;var r=k.customTabs;if(!r||0>=r.length)return this.vv.tabs=b,!0;this._tabStops=r;k="";for(let y of r){switch(y.Kba){case 1:k="LeftTab";break;case 4:k="RightTab";break;case 3:k="CenterTab";break;case 6:k="DecimalTab";break;case 7:k="BarTab"}r=Vf.a.kjb(y.WEa,0);b.push({["type"]:k,["value"]:r,["getRulerPropertyBoundary"]:Jr.oJl()})}this.vv.tabs=b;return!0}D4a(b){if(this.LW){this.LW.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.vv&&
delete this.vv.disabled;for(let k of b)switch(k){case 0:b=this.Mej();const r=this.Lej();b&&r||(this.vv.disabled=!0);break;case 1:this.c3c()||(this.vv.disabled=!0)}this.BC.kb.VOd&&(this.vv.disabled=!0);this.Uqa().then(k=>{k.renderRuler(this.TBa,this.vv);return null})}}c3c(){const b={};var k=this.n3b();if(!k)return!1;b.scale=Rg.a.mC(k.Oo);b.precision=no.precision;b.rulerType="Horizontal";if(!this.O0m())return this.vv.ipContextIndex=0,this.vv.permittedUnits=no.azh,k=[{["type"]:"Left",["value"]:Rg.a.mC(k.marginLeft),
["getRulerPropertyBoundary"]:Jr.R3b("Left",0)},{["type"]:"Right",["value"]:Rg.a.mC(k.marginRight),["getRulerPropertyBoundary"]:Jr.R3b("Right",1)}],b.margins=k,this.vv.rulerCanvasProps=b,!0;var r={};k={};var y=this.ga.Xb(Wa.a.EWc,2,r);const R=this.ga.Xb(Wa.a.zIb,2,k);if(32!==y||32!==R)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),om.recordQosError(this.htb,[om.dda],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;y=k.TablePosition;if(!y||!r||
0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),om.recordQosError(this.htb,[om.dda],"Cannot show table properties on the ruler as they are null"),!1;k=Array(r.length+1);k[0]={["type"]:"MoveTableColumn",["value"]:Rg.a.mC(y.x/this.OM),["getRulerPropertyBoundary"]:Jr.R3b("MoveTableColumn",0)};for(y=0;y<r.length;y+=1)k[y+1]={["type"]:"MoveTableColumn",["value"]:Rg.a.mC(r[y]),["getRulerPropertyBoundary"]:Jr.R3b("MoveTableColumn",y+1)};
this.vv.ipContextIndex=this.VMl();this.vv.permittedUnits=no.E8n;b.margins=k;this.vv.rulerCanvasProps=b;return!0}Mej(){var b={};if(32!==this.ga.Xb(Wa.a.d2a,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),om.recordQosError(this.htb,[om.dda],"Unable to read paragraph indentation for Ruler"),!1;const k={type:"FirstLineIndent"};k.getRulerPropertyBoundary=Jr.fId("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=Jr.fId("HangingIndent");
const y={type:"RightIndent"};y.getRulerPropertyBoundary=Jr.fId("RightIndent");const R={type:"LeftIndent"};R.getRulerPropertyBoundary=Jr.fId("LeftIndent");this.vv.rtl=b.isRtl;b=b.Ws;k.value=1===b.specialIndentType?Rg.a.mC(b.Fba+b.HA):2===b.specialIndentType?Rg.a.mC(b.HA-b.Fba):Rg.a.mC(b.HA);r.value=Rg.a.mC(b.HA);R.value=Rg.a.mC(b.HA);y.value=Rg.a.mC(b.gma);this.vv.indents=[k,r,y,R];return!0}HVm(b,k){var r=new MB.a;r.unit=1;r.value=Rg.a.GA(k);k=8;switch(b){case "FirstLineIndent":k=this.ga.Xb(Wa.a.L_c,
2,r);break;case "HangingIndent":k=this.ga.Xb(Wa.a.M_c,2,r);break;case "LeftIndent":k=this.ga.Xb(Wa.a.RZa,2,r);break;case "RightIndent":k=this.ga.Xb(Wa.a.QZa,2,r)}let y;32===k?(r=1,y=String.format("Indents set using Ruler. Indent: {0}",b),v.ULS.sendTraceTag(592517017,3014,50,y)):(r=0,y=String.format("Unable to set indent using Ruler. Indent: {0}",b),v.ULS.sendTraceTag(592496523,3014,15,y,b),om.recordQosError(this.B_j,[om.dda],"Unable to set indent using Ruler."));Ib.a(this.mrj,32===k,void 0,[Object.assign(new ca.a,
{name:"Type",string:b})]);b=new Map;b.set("Command","OnIndentChange");b.set("Source",this.X2);b.set("Response",y);Ga.Health.instance.recordKpiUsage(no.kpiName,r,no.l6,b)}o$g(){Af.a.addHandler(this.LW,Kb.a.ex,Object(u.a)(this,this.CYd,"onRulerMouseDown"))}p6h(){this.LW.classList.remove("ShowWACHorizontalRulerContainer");this.LW.classList.add("HideWACHorizontalRulerContainer");Af.a.removeHandler(this.LW,Kb.a.ex,Object(u.a)(this,this.CYd,"onRulerMouseDown"));this.Uqa().then(b=>{b.dispose(this.TBa);return null})}THf(b,
k,r){let y;y="Left"===b?this.ga.Xb(Wa.a.Zga,2,Rg.a.GA(k)):"Right"===b?this.ga.Xb(Wa.a.d3a,2,Rg.a.GA(k)):r?this.ga.Xb(Wa.a.pae,2,{["columnIndex"]:r-1,["width"]:Rg.a.GA(k)}):this.ga.Xb(Wa.a.xec,2,Rg.a.GA(k));32===y?(k=1,r=String.format("Margins set using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(592517018,3014,50,r)):(k=0,r=String.format("Unable to set margins using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(592496524,3014,15,r),om.recordQosError(this.H5g,[om.dda],"Unable to set margins using Ruler."));
Ib.a(this.Ife,32===y,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");b.set("Source",this.X2);b.set("Response",r);Ga.Health.instance.recordKpiUsage(no.kpiName,k,no.l6,b)}Xr(){this.akj();this.FFa();this.D4a([1,0])}NTc(b,k){b=k.property;if(b===wc.a.Oo||b===wc.a.marginLeft||b===wc.a.marginRight)this.akj(),this.FFa(),this.D4a([1])}akj(){var b=this.n3b();b&&(b=Vf.a.Ri(b.Oo,0),this.TBa.style.width=Math.round(b*this.OM).toString()+"px")}FFa(){window.requestAnimationFrame(()=>
{var b=this.Ugf();b&&(b=Qe.a.getElementBounds(b),n.AFrameworkApplication.isRtl?this.TBa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.TBa.style.marginLeft=b.x.toString()+"px")})}VMl(){const b=Wd.GraphIterator.Za(this.BC.P1b);if(b.Ab(14))return b.kd(16),Jl.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");om.recordQosError(this.htb,[om.dda],"Unable to read table column index for Ruler");return 0}O0m(){let b=
!0;const k=this.BC.kb.BN();if(null===k)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),om.recordQosError(this.htb,[om.dda],"Unable to get Context Iterator for the Ruler"),!1;for(;k.moveNext()&&b;){const r=Wd.GraphIterator.Za(k.current.node);r.rd();b=b&&Si.TableReader.Pv(r)}return b}ePe(){var b;if(!this.TBa&&!this.LW){this.bJg=document.createElement("div");this.LW.id=js.WHj;this.LW.className=js.VHj;this.LW.setAttribute(Ef.a.Eda,WordEditorIntl.WordEditorStrings.L_Ruler);
this.LW.setAttribute(Ef.a.Bh,Ef.a.vfh);this.LW.classList.add("HideWACHorizontalRulerContainer");if(this.ggi){var k=n.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");const r=n.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ea.a.ula(k,!r)&&this.LW.classList.add(js.lOj)}this.cJg=document.createElement("div");this.TBa.className=js.UHj;this.TBa.id=js.XHj;this.LW.appendChild(this.TBa);k=null;this.gw&&((k=n.AFrameworkApplication.K.$("IsSharedLayoutEnabled")?null!==
(b=Object(Fq.a)("EditorBars"))&&void 0!==b?b:Ka.App.xa.Bu.getRegion(Ka.App.xa.Bu.Gjb.J("Ruler")):Ka.App.xa.Bu.getRegion(Ka.App.xa.Bu.Gjb.J("Ruler")))&&k.appendChild(this.LW),this.LW.classList.add("regionComposer"));k||(k=document.getElementById(Rh.AppFrame.M4c),k.insertBefore(this.LW,k.firstChild))}}static fE(){return new js(Va.a.instance.$a("Common.IZoomManager"),Ka.App.ik,n.AFrameworkApplication.ya,Sk.UISurfaces.PZh,Va.a.instance.resolve("WordEditor.IRulerContextMenu"),lt.a.instance,Va.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
js.yng?js.yng:js.yng=js.fE()}}js.WHj="WACHorizontalRulerContainer";js.VHj="WACHorizontalRulerContainer";js.XHj="WACHorizontalRuler";js.UHj="WACHorizontalRuler";js.lOj="ModernUxWACHorizontalRulerContainer";Object(m.a)(js,"HorizontalRuler",hu,[]);var OB=c(934);class zs extends hu{constructor(b,k,r,y,R,aa,ta){super(b,k,r,R,aa,ta);this.X2="VerticalRuler";this.Ife="MarginModificationFromRuler";this.v6g=this.u6g=null;if(FD.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Uqa=
y;else{const Ya=y();this.Uqa=()=>Ya}this.vv={}}get f4(){return this.u6g}get PFa(){return this.v6g}renderRuler(){Fd.a.Mu(this.f4,"HideWACVerticalRulerContainer");Fd.a.Qf(this.f4,"ShowWACVerticalRulerContainer");var b=this.n3b();if(b){var k=Object(u.a)(this,this.THf,"onMarginChange");this.c3c()||(this.vv.disabled=!0);this.vv.onMarginChange=k;this.FFa();b=Vf.a.Ri(b.ey,1);this.PFa.style.height=(b*this.OM).toString()+"px";this.Uqa().then(r=>{r.renderRuler(this.PFa,this.vv);return null})}}D4a(b){if(this.f4){Fd.a.Qf(this.f4,
"ShowWACVerticalRulerContainer");"disabled"in this.vv&&delete this.vv.disabled;for(let k of b)switch(k){case 1:this.c3c()?this.FFa():this.vv.disabled=!0}this.BC.kb.VOd&&(this.vv.disabled=!0);this.Uqa().then(k=>{k.renderRuler(this.PFa,this.vv);return null})}}c3c(){const b={},k=this.n3b();if(!k)return!1;b.scale=Rg.a.mC(k.ey);b.precision=no.precision;b.rulerType="Vertical";this.vv.ipContextIndex=0;this.vv.permittedUnits=no.azh;b.margins=[{["type"]:"Top",["value"]:Rg.a.mC(k.marginTop),["getRulerPropertyBoundary"]:Jr.R3b("Top",
0)},{["type"]:"Bottom",["value"]:Rg.a.mC(k.marginBottom),["getRulerPropertyBoundary"]:Jr.R3b("Bottom",1)}];this.vv.rulerCanvasProps=b;return!0}o$g(){this.ePe();Af.a.addHandler(this.f4,Kb.a.ex,Object(u.a)(this,this.CYd,"onRulerMouseDown"))}p6h(){Fd.a.Mu(this.f4,"ShowWACVerticalRulerContainer");Fd.a.Qf(this.f4,"HideWACVerticalRulerContainer");Af.a.removeHandler(this.f4,Kb.a.ex,Object(u.a)(this,this.CYd,"onRulerMouseDown"));this.Uqa().then(b=>{b.dispose(this.PFa);return null})}THf(b,k){let r=8;"Top"===
b?r=this.ga.Xb(Wa.a.e3a,2,Rg.a.GA(k)):"Bottom"===b&&(r=this.ga.Xb(Wa.a.c3a,2,Rg.a.GA(k)));let y;32===r?(k=1,y=String.format("Margins set using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(529065945,3014,50,y)):(k=0,y=String.format("Unable to set margins using Ruler. Margin: {0}",b),v.ULS.sendTraceTag(529065946,3014,15,y),om.recordQosError(this.H5g,[om.dda],"Unable to set margins using Ruler."));Ib.a(this.Ife,32===r,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");
b.set("Source",this.X2);b.set("Response",y);Ga.Health.instance.recordKpiUsage(no.kpiName,k,no.l6,b)}Xr(){this.Yjj();this.FFa();this.D4a([1])}NTc(b,k){b=k.property;if(b===wc.a.ey||b===wc.a.marginTop||b===wc.a.marginBottom)this.Yjj(),this.FFa(),this.D4a([1])}Yjj(){var b=this.n3b();b&&(b=Vf.a.Ri(b.ey,1),this.PFa.style.height=Math.round(b*this.OM).toString()+"px")}FFa(){window.requestAnimationFrame(()=>{var b=this.Ugf();if(b){const k=Qe.a.getElementBounds(b);this.PFa.style.height=k.height.toString()+
"px";b=this.COl(b);this.PFa.style.marginTop=b+"px"}})}COl(b){b=b.getBoundingClientRect().y;let k=this.IMe.getBoundingClientRect().y;return b-k}ePe(){if(!this.PFa&&!this.f4){this.u6g=document.createElement("div");this.f4.id=zs.n0j;this.f4.className=zs.m0j;this.f4.setAttribute(Ef.a.Eda,WordEditorIntl.WordEditorStrings.L_Ruler);this.f4.setAttribute(Ef.a.Bh,Ef.a.vfh);Sys.UI.DomElement.addCssClass(this.f4,"HideWACVerticalRulerContainer");if(this.ggi){var b=n.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");
const k=n.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ea.a.ula(b,!k)&&Sys.UI.DomElement.addCssClass(this.f4,zs.mOj)}this.v6g=document.createElement("div");this.PFa.className=zs.l0j;this.PFa.id=zs.o0j;this.f4.appendChild(this.PFa);b=document.getElementById(Rh.AppFrame.M4c);b.insertBefore(this.f4,b.firstChild)}}static fE(){return new zs(Va.a.instance.$a("Common.IZoomManager"),Ka.App.ik,n.AFrameworkApplication.ya,Sk.UISurfaces.PZh,Va.a.instance.resolve("WordEditor.IRulerContextMenu"),
lt.a.instance,Va.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=zs.xng?zs.xng:zs.xng=zs.fE()}}zs.n0j="WACVerticalRulerContainer";zs.m0j="WACVerticalRulerContainer";zs.o0j="WACVerticalRuler";zs.l0j="WACVerticalRuler";zs.mOj="ModernUxWACVerticalRulerContainer";Object(m.a)(zs,"VerticalRuler",hu,[]);class om{constructor(b,k,r,y,R,aa,ta,Ya,xb){this.hse=this.Hue=!1;this.X2="RulerActor";this.z_g=null;this.Ema=!1;this.iAj="ClearAllTabStopsFailed";this.Q1g="ShowHideRulerFailed";
this.zwe=null;this.Sud=(Mb,cc,jc)=>{if(1===jc)return 32;Mb=this.ga.processAction(Jc.a.UIb,2,null);32===Mb?(jc=1,cc=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,cc)):(jc=0,cc=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,3014,15,cc),om.recordQosError(this.iAj,[om.dda],cc));const Mc=new Map;Mc.set("Command","ClearAllTabStops");Mc.set("Source",this.X2);Mc.set("Response",cc);Ga.Health.instance.recordKpiUsage(no.kpiName,jc,
no.l6,Mc);return Mb};this.zMc=(Mb,cc,jc)=>{if(1===jc)switch(Mb){case Jc.a.hTe:case Jc.a.R2e:return 2;default:return 32}cc=this.$Fe.WHl();switch(Mb){case Jc.a.Rwf:var Mc=1;break;case Jc.a.QVf:Mc=4;break;case Jc.a.rWe:Mc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Mb=new gy.a(cc,Mc,0,1);Mb=this.ga.Xb(Jc.a.h_c,2,Mb);32===Mb?(jc=1,cc=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",Gw[Mc],cc.toString()),v.ULS.sendTraceTag(591213269,
3014,50,cc)):(jc=0,cc=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",Gw[Mc],cc.toString()),v.ULS.sendTraceTag(591213270,3014,15,cc));Mc=new Map;Mc.set("Command","InsertCustomTabStopRuler");Mc.set("Source",this.X2);Mc.set("Response",cc);Ga.Health.instance.recordKpiUsage(no.kpiName,jc,no.l6,Mc);return Mb};this.bLb=(Mb,cc,jc,Mc,fd)=>this.Hue||1===jc&&Me.a.ufa(cc.rk)?8:this.Ema?this.gLc(Mb,cc,jc,Mc,fd):this.W_n(cc,jc);this.RCn=()=>{this.Ema?v.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Wa.a.bLb,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),om.recordQosError(this.Q1g,[om.dda],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.gLc=(Mb,cc,jc)=>{if(1===jc||!this.Ema)return 32;this.Ema=!1;this.aGe.cWi(!1);this.L7a.dispose();this.nRd()&&this.r5e();this.$jj();v.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Mb=new Map;Mb.set("Command","HideRuler");Mb.set("Source",this.X2);Mb.set("Response","");Ga.Health.instance.recordKpiUsage(no.kpiName,1,no.l6,Mb);return 32};this.e2d=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return 32;fd&&(fd[Ig.a.On]=this.Ema);return 32};this.K3l=Mb=>{this.Ema=Mb.result};this.fCb=()=>{this.Hue=!1};this.e6h=()=>{this.Hue=!0};this.ga=b;this.L7a=k;this.wMe=r;this.ZNb=y;this.$Fe=R;this.aGe=aa;om.Jk=Ya;this.zHa=ta;this.HY=xb;this.zHa.Vah(this.e6h);this.zHa.mrd(this.fCb)}initialize(){this.Vb();
this.z_g=this.RCn;window.addEventListener("TurnRulerOnAction",this.z_g,!0);return this.aGe.nJl().continueWith(this.K3l,8)}Vb(){this.ga.pa(Wa.a.bLb,lc.a.view,this.bLb);this.ga.gb(Wa.a.e2d,lc.a.view,this.e2d,96);this.ga.pa(Jc.a.hTe,lc.a.view,this.zMc);this.ga.pa(Jc.a.rWe,lc.a.view,this.zMc);this.ga.pa(Jc.a.Sud,lc.a.view,this.Sud);this.ga.pa(Jc.a.R2e,lc.a.view,this.zMc);this.ga.pa(Jc.a.gLc,lc.a.view,this.gLc);this.ga.pa(Jc.a.Rwf,lc.a.view,this.zMc);this.ga.pa(Jc.a.QVf,lc.a.view,this.zMc);OB.a.ie.addHandler(OB.a.hYd,
this.cUc.bind(this));this.HY.Gvb(this.BJf)}E9h(){this.Ema&&(this.L7a.UA(),this.L7a.renderRuler(),this.nRd()&&this.rRi())}rRi(){this.wMe.UA();this.wMe.renderRuler()}r5e(){this.wMe.dispose()}nRd(){return this.pki()&&this.isPaginatedView()}pki(){null==this.zwe&&null!=n.AFrameworkApplication.K&&(this.zwe=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.zwe}dhc(){this.Ema||Va.a.instance.$a("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}BS(){this.zHa.qun(this.e6h);this.zHa.yQi(this.fCb);this.Ema&&(this.L7a.dispose(),this.nRd()&&this.r5e())}$jj(){if(this.ZNb){const b={};b[no.rro]="ToggleButtonModel";this.ZNb.nG(b)}}W_n(b,k){if(!om.Jk.S$(b.rk))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),om.recordQosError(this.Q1g,[om.dda],"Cannot show ruler. Word Section Node not found."),8;if(1===k)return 32;this.Ema=!0;this.aGe.cWi(!0);this.E9h();this.$jj();
v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.X2);b.set("Response","");Ga.Health.instance.recordKpiUsage(no.kpiName,1,no.l6,b);return 32}isPaginatedView(){return 1===this.HY.Qw}cUc(b,k){switch(k.documentMode){case "View":this.Ema&&(this.ga.processAction(Wa.a.bLb,2),this.hse=!0);break;case "Edit":this.hse&&(this.ga.processAction(Wa.a.bLb,2),this.hse=!1)}}BJf(b,k){if(om.instance.Ema&&om.instance.pki())switch(k.q$b){case 1:om.instance.rRi();
break;case 0:om.instance.r5e()}}static recordQosError(b,k,r){const y=Object.assign(new Xa.a,{extendedProperties:new Map});r&&y.extendedProperties.set("exception",r);Ga.Health.instance.recordQosError(b,k,!1,!0,!1,!1,y)}static fE(){return new om(n.AFrameworkApplication.ya,js.instance,zs.instance,Ka.App.xa,Va.a.instance.resolve("WordEditor.IRulerContextMenu"),Va.a.instance.Pa("WordEditor.Ruler.IRulerSettingInfo"),Va.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Al.a.instance,
Va.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=om.zmg?om.zmg:om.zmg=om.fE()}}om.Jk=null;om.dda="RulerInteractionFailed";Object(m.a)(om,"RulerActor",null,[]);class kz{constructor(b,k){this.$uc=null;this.r1a=r=>r.result?r.result.Value.toString():"";this.pDa=r=>{r.jo||r.Ki?(v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.$uc=!1):(r=r.result,""===r&&n.AFrameworkApplication.K&&(r=n.AFrameworkApplication.K.lb("RulerDefaultOn")),
this.$uc="true"===r.toLowerCase(),v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.$uc};this.Xu=b;this.MJ=k}nJl(){const b=new zh.a;if(null==this.$uc){if(this.dii())return this.MJ.m2a($z.a.qZc).CWRCo(this.r1a,0).CWRCo(this.pDa,8);b.Eg(!1)}else b.Eg(this.$uc);return b.task}f0(b){this.MJ.f0($z.a.qZc,new DD.a($z.a.qZc,b))}cWi(b){this.dii()&&(this.Xu.dha("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.f0(b)}dii(){const b=n.AFrameworkApplication.K.$("IsAnonymousUser");if(n.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(kz,"RulerSettingInfo",null,[280]);class eA{constructor(){this.mKg=this.W=null}get name(){return"WordEditor.Ruler"}zc(b){this.W=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new kz(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").io.continueWith(()=>{this.Wm()});this.mKg=om.instance.initialize();v.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Wm(){this.mKg.continueWith(()=>{om.instance.E9h();om.instance.dhc()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){om.instance.BS();
v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(m.a)(eA,"PackageManager",null,[1,2]);class Eu{constructor(){this.w5b=this.JXb=null}}Object(m.a)(Eu,"CreatePickerCustomizationDictionaryOptions",null,[998]);class As{}As.vg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(As,"InsertMediaM365DialogHtml",
null,[]);class fA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye){var ff;this.d2=ye;this.v6a=null;this.Uci=this.Zqf=this.Ded=!1;this.C6i=Gd=>{if(Gd.rawEvent&&(Gd=Gd.rawEvent.data))try{const oe=Sys.Serialization.JavaScriptSerializer.deserialize(Gd,!0),ze=oe.MessageId?oe.MessageId.toString():null;oe&&ze&&(ze===E.a.insertImage||ze===E.a.sof)&&this.Vsc.start(ze===E.a.insertImage?this.Y7a:this.xKg)}catch(oe){}};this.Vko=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;this.cNg?Gd=CommonUIStrings.l_OneDriveName:
""!==this.Vbd?Gd=this.Vbd:(Gd=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Yf[cl.a.LabelText]=Gd;return 32};this.Yko=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;if(!n.AFrameworkApplication.Nrf())return Yf[cl.a.Visible]=!1,32;this.cNg?Gd=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Vbd?Gd=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Vbd):
(Gd=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Yf[cl.a.LabelText]=Gd;return 32};this.Wko=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;n.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Yf[cl.a.Visible]=!1);return 32};this.Xko=(Gd,oe,ze,ug,Yf)=>{if(1===ze)return 32;n.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Yf[cl.a.Visible]=
!1);return 32};this.$8d=(Gd,oe,ze)=>{oe=this.npc.value.Nda(oe);if(1===ze)return oe&&this.X7a.Ygm?32:8;if(2!==ze||!oe)return 8;this.v6a=Ra.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Gd=this.Nxl(Gd,this.v6a);Gd=this.oOe(Gd);Gd=this.Scd.KIc(Gd);Gd.correlationId=this.v6a;Gd.K5b=this.yKg;Gd.Ufa=1;return this.Y8d(Gd,CommonUIStrings.L_PictureInsertTitle,this.Y7a)};this.e_n=(Gd,oe,ze)=>{Gd=32===this.ga.Vf(oe,Wa.a.insertHyperlink,1,!1,
null,null);if(1===ze)return Gd&&this.X7a.cfi?32:8;if(2!==ze||!Gd)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Y8d(this.wKg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.xKg)};this.p6i=(Gd,oe,ze)=>{Gd=this.npc.value.Nda(oe);if(1===ze)return Gd&&this.X7a.Mrf?32:8;if(2!==ze||!Gd)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");
return this.Y8d(this.wKg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Y7a)};this.W8d=(Gd,oe,ze)=>{oe=this.npc.value.Nda(oe);if(1===ze)return oe&&this.X7a.$gm?32:8;if(2!==ze||!oe)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.v6a=Ra.a.create();ze=n.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.pR.isFreemiumUpsellEnabled();ze=this.Ded?1:ze?0:-1;Gd=this.rAl(Gd,this.v6a,ze);Gd=this.Scd.KIc(Gd);
Gd.vg=As.vg;Gd.correlationId=this.v6a;Gd.Ufa=2;Gd.K5b=this.yKg;Gd.OJa=this.pR;Gd.ulj=ze;return this.Y8d(Gd,CommonUIStrings.L_PictureInsertTitle,this.Y7a)};this.a9d=(Gd,oe,ze)=>{oe=this.npc.value.Nda(oe);Gd=Va.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===ze)return oe&&!this.X7a.Mrf&&Gd&&Gd.Xtf()?32:8;if(2!==ze||!oe||!Gd)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.v6a=Ra.a.create();ze=fA.q6g;oe=!1;n.AFrameworkApplication.Orf()&&
(oe=this.gil());const ug=new Eu;ug.JXb=oe;ug.w5b=!0;ze=Gd.o0e(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,ze,"Insert Media",1,ug);Gd.wef(ze).then(Yf=>{if(null!=Yf&&0<Yf.length){const Aj=[];for(let cn=0;cn<Yf.length;cn++){const Vl=Yf[cn][H.a.eGi],st=Yf[cn][H.a.dGi],tt={};tt.Extension=Vl;tt.OriginalUrl=st;tt.caption=Vl;Aj.push(tt)}this.Y7a.DMa=Wa.a.Q1;this.Y7a.c_a(Aj)}});return 32};this.Z8d=(Gd,oe,ze)=>{var ug=this.npc.value.Nda(oe);oe=Va.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===ze)return ug&&oe&&oe.Xtf()?32:8;if(2!==ze||!ug||!oe)return 8;ze=Va.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");null!=ze&&ze.m9k(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.v6a=Ra.a.create();ze=fA.q6g;ug=new Eu;ug.JXb=!0;ug.w5b=!0;ze=oe.o0e(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,
!0,!1,!0,ze,"InsertPictureFromMobile",3,ug);oe.wef(ze).then(Yf=>{if(null!=Yf&&0<Yf.length){var Aj=[];const cn=Gd===Wa.a.XMd;let Vl=!1;const st=n.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");for(let tt=0;tt<Yf.length;tt++){const Rv=Yf[tt][H.a.eGi],lE=Yf[tt][H.a.dGi],Iw={};Iw.Extension=Rv;Iw.OriginalUrl=lE;Iw.caption=Rv;Aj.push(Iw);Vl||(Vl=-1!==Iw.OriginalUrl.indexOf(st))}this.Y7a.DMa=Wa.a.Q1;this.Y7a.c_a(Aj);Aj={};Aj.InsertImageCount=Yf.length;Vl&&Ib.c(cn?Wa.a.L7l:Wa.a.vuk,void 0,void 0,
void 0,void 0,void 0,Aj)}});return 32};this.Vsc=y;this.Fhd=R;this.Scd=ta;this.wKg=Ya;this.$0=xb;this.ga=b;this.npc=aa;this.cNg=Mc;this.Vbd=Td;this.X7a=r;this.Y7a=Mb;this.xKg=cc;this.yKg=ne;this.pR=jc;this.Uci=null!==(ff=null===k||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.DarkModeForHubble",!1))&&void 0!==ff?ff:!1;this.pR&&this.pR.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Gd=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
Gd)).then(Gd=>{(this.Ded=Gd)||this.pR.Kva("MsoPremiumStockImages",()=>{this.Ded=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Vb(){(this.X7a.Mrf||this.X7a.cfi)&&this.X7a.Zgm&&this.g$m();this.non();this.mon();this.ga.gb(Wa.a.Bmh,lc.a.view,this.p6i,1284);this.ga.gb(Wa.a.wJi,lc.a.view,this.Yko,1124);this.ga.gb(Wa.a.Eof,lc.a.view,this.p6i,1284);this.ga.gb(Wa.a.sPf,lc.a.view,this.Vko,1124);this.ga.gb(Wa.a.T7l,lc.a.view,this.e_n,
1284)}non(){this.ga.gb(Wa.a.insertOnlinePicture,lc.a.view,this.$8d,1284);this.ga.gb(Wa.a.UMd,lc.a.view,this.W8d,1284);this.ga.jba("word_insertOnlinePictures",Wa.a.insertOnlinePicture,lc.a.view,this.$8d,b=>{Ka.App.xa.MMb(b,Object(u.a)(new Oh.a,(new Oh.a).Mdb,"getCommandById"))});this.ga.jba("word_insertOnlinePictures",Wa.a.UMd,lc.a.view,this.W8d,b=>{Ka.App.xa.MMb(b,Object(u.a)(new Oh.a,(new Oh.a).Mdb,"getCommandById"))});this.ga.gb(Wa.a.AWe,lc.a.view,this.$8d,1284);this.ga.gb(Wa.a.CWe,lc.a.view,this.a9d,
1284);this.ga.jba("word_insertOnlinePictures",Wa.a.CWe,lc.a.view,this.a9d);this.ga.gb(Wa.a.DWe,lc.a.view,this.W8d,1284);this.ga.gb(Wa.a.uJi,lc.a.view,this.Wko,1284);this.ga.gb(Wa.a.vJi,lc.a.view,this.Xko,1284);this.ga.jba("word_insertOnlinePictures",Wa.a.AWe,lc.a.view,this.$8d);this.ga.jba("word_insertOnlinePictures",Wa.a.DWe,lc.a.view,this.W8d);this.ga.gb(Wa.a.Gof,lc.a.view,this.a9d,1284);this.ga.jba("word_insertOnlinePictures",Wa.a.Gof,lc.a.view,this.a9d,b=>{Ka.App.xa.MMb(b,Object(u.a)(new Oh.a,
(new Oh.a).Mdb,"getCommandById"))})}mon(){n.AFrameworkApplication.Orf()&&(this.ga.gb(Wa.a.XMd,lc.a.view,this.Z8d,1284),this.ga.gb(Wa.a.BWe,lc.a.view,this.Z8d,1284),this.ga.jba("mso_insertMobileDevicePictures",Wa.a.XMd,lc.a.view,this.Z8d,b=>{Ka.App.xa.MMb(b,Object(u.a)(new Oh.a,(new Oh.a).Mdb,"getCommandById"))}),this.ga.jba("mso_insertMobileDevicePictures",Wa.a.BWe,lc.a.view,this.Z8d,b=>{Ka.App.xa.MMb(b,Object(u.a)(new Oh.a,(new Oh.a).Mdb,"getCommandById"))}))}g$m(){n.AFrameworkApplication.ta.get_element().appendChild(this.Fhd.WXa);
Af.a.addHandler(this.Fhd.WXa.contentWindow,"message",this.C6i);this.Zqf=!0}Nxl(b,k){let r=0;n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb&&5===n.AFrameworkApplication.ta.Rb.ko&&(r=12);const y=yh.a.qg(n.AFrameworkApplication.lcid);return String.format(n.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Wa.a.insertOnlinePicture?1:0,n.AFrameworkApplication.lcid,y?y.name:"en-us",n.AFrameworkApplication.buildVersion,k,r,n.AFrameworkApplication.K.lb("UserId"))}Y8d(b,k,
r){try{return b.X8d(k,r),v.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(y){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",y.toString()),this.Bp(pj.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}rAl(b,k,r){if(Wa.a.UMd===b)return b=this.$0.Jih(n.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),
k.toString(),1,r),this.oOe(b);b=this.$0.Jih(n.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),k.toString(),0,r);return this.oOe(b)}Bp(b,k,r){const y=new cf.StandardDialog(!0);y.It=n.AFrameworkApplication.faa;y.Gd=0;y.We(1,CommonUIStrings.l_DialogClose);y.my(b,k,r,()=>{})}gil(){const b=Va.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.Zll():!1}dispose(){this.Zqf&&this.Fhd.WXa.contentWindow&&(Af.a.removeHandler(this.Fhd.WXa.contentWindow,"message",this.C6i),this.Zqf=
!1)}oOe(b){return this.Uci&&this.d2&&this.d2.yL?(b=new pa.QueryStringBuilder(b),b.Ke("theme","4"),b.toString()):b}}fA.q6g=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(fA,"InsertMediaActor",null,[10]);var sq=c(935);class lz extends sq.a{constructor(b,k){super(b,Oa.a.N$(k))}Ar(b,k){this.isEnabled()&&this.AVa(this.W3a)&&(this.Av(b),this.fC(b,k))}}Object(m.a)(lz,"InsertMediaCrossDocumentMessenger",sq.a,[336,64,10]);class bB{getInstance(b,k){return new lz(b,k)}}Object(m.a)(bB,"InsertMediaCrossDocumentMessengerFactory",
null,[325]);var cB=c(1013);class dB{}dB.vg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(dB,"InsertMediaDialogHtml",null,[]);var Fu;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(Fu||(Fu={}));Object(m.b)("HubbleAction",Fu);var xx;(function(b){b[b.unknown=0]="unknown";b[b.bing=
1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(xx||(xx={}));Object(m.b)("InsertMediaProviders",xx);class rt extends yf.a{constructor(b,k,r,y=null,R=!1){super(!1,!1,R);this.EG=null;this.ync=!1;this.DRc=this.a_=null;this.qVe="KeepFocusDiv";this.Btd="KeepFocusStartDiv";this.correlationId=null;this.Ufa=0;this.OJa=this.K5b=null;this.ulj=0;this.eye=null;this.RVm=()=>{this.a_&&(this.a_.style.visibility="visible",window.setTimeout(()=>{if(this.Gk){const aa=
this.Gk.getElementById(this.Btd);aa&&aa.focus()}},0))};this.zaa=aa=>{aa.keyCode===Sys.UI.Key.tab&&(aa.target.id!==this.qVe||aa.shiftKey?aa.target.id===this.Btd&&aa.shiftKey&&(aa.preventDefault(),this.Gk.getElementById(this.qVe).focus()):(aa.preventDefault(),this.Gk.getElementById(this.Btd).focus()))};this.Dxi=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.pzb(this.eWa);this.ukb(1)};this.Nyi=()=>{this.EG&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),
this.EG.sendMessage(E.a.aLn,{["CustomHeaders"]:""}))};this.Qyi=()=>{this.EG&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.EG.sendMessage(E.a.$Qn,{["SessionId"]:n.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.Myi=()=>{this.EG&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.EG.sendMessage(E.a.gKn,{["CID"]:""}))};this.lWm=()=>{this.OJa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.OJa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Tcd=b;this.XPb="";this.$0=r;this.eda=[];this.Wid=k;this.vg=y||dB.vg;this.lg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}X8d(b,k){this.XPb=b;this.ync=!1;this.showDialog(this.XPb,null);this.a_=this.R2b(this.pj("insertmediaframe"));if(!this.a_)throw this.pzb(this.eWa),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.Btd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.a_.parentNode.insertBefore(b,this.a_.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.qVe);b.setAttribute("tabindex","0");this.a_.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.g4e,
"keydown",this.zaa);this.a_.src=this.Tcd;this.a_.style.width="100%";this.a_.style.height="100%";this.a_.frameBorder="0";n.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&X.a.gj?(this.a_.style.visibility="hidden",this.DRc=this.RVm,Af.a.addHandler(this.a_,"load",this.DRc)):this.a_.style.visibility="visible";this.R2b(this.pj("WACDialogButtonPanel")).style.display="none";this.R2b(this.pj("WACDialogTitleText")).style.display="none";2===this.Ufa&&(this.R2b(this.pj("WACDialogTitlePanel")).style.display=
"none",this.R2b(this.pj("WACDialogBodyPanel")).style.padding="0");Id.FocusManager.instance().Fs().scope.XL=!0;this.EG=this.Wid.getInstance(this.a_.contentWindow,this.Tcd);this.EG.Ar(E.a.C9g,r=>{this.Twi(r,Object(u.a)(k,k.c_a,"insertMediaCallback"))});this.EG.Ar(E.a.insert,r=>{this.TXd(r,Object(u.a)(k,k.c_a,"insertMediaCallback"))});this.EG.Ar(E.a.m5j,r=>{this.iXm(r)});this.EG.Ar(E.a.FQh,this.Nyi);this.EG.Ar(E.a.getSessionId,this.Qyi);this.EG.Ar(E.a.uOh,this.Myi);this.EG.Ar(E.a.Ttd,this.Dxi);2!==this.Ufa||
this.ulj||(this.EG.Ar(E.a.Asm,this.lWm),this.eye=this.OJa.Kva("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.EG.sendMessage(E.a.Zpo,{["LicenseTier"]:r.toString()})}));this.ukb(3)}dispose(){this.OJa&&this.eye&&this.OJa.scc("MsoPremiumStockImages",this.eye);this.EG&&(this.EG.dispose(),this.EG=null);this.DRc&&(Af.a.removeHandler(this.a_,"load",this.DRc),this.DRc=null);super.dispose()}Twi(b,k){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.$0.j5m(b))this.eda.push(b),this.ync&&(k(this.eda),this.ync=!1)}Bp(){const b=new cf.StandardDialog(!0);b.It=n.AFrameworkApplication.faa;b.Gd=0;b.We(1,CommonUIStrings.l_DialogOk);b.Tv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}ukb(b){var k=RegExp("hubble","gi");if(this.K5b&&0<this.K5b.search(k)&&this.correlationId){k=n.AFrameworkApplication.sessionStartInfoSettings;var r={};r.InsertedFiles=this.eda.length;
r.MediaDetails=this.eda;r.DialogResult=Fu[b];r.DialogMode=this.Yff();r.CorrelationId="{"+this.correlationId.toString()+"}";r.Platform="Wac";r.Provider=xx[this.Ufa]||"Unknown";r.AudienceGroup=k&&"AudienceGroup"in k?k.AudienceGroup.toString():"Unknown";r.Ring=k&&"Ring"in k?k.Ring.toString():"Unknown";r.AppId=2;r.Build=n.AFrameworkApplication.buildVersion;r.Locale=yh.a.qg(n.AFrameworkApplication.lcid).name;this.l$m().send(JSON.stringify(r))}2===this.Ufa&&(r=n.AFrameworkApplication.K.lb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==r&&(k=[],k.push(Object.assign(new ca.a,{name:"InsertedFiles",int64:this.eda.length})),k.push(Object.assign(new ca.a,{name:"MediaDetails",string:JSON.stringify(this.eda)})),k.push(Object.assign(new ca.a,{name:"DialogResult",string:Fu[b]})),k.push(Object.assign(new ca.a,{name:"DialogMode",string:this.Yff()})),k.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()})),k.push(Object.assign(new ca.a,{name:"Provider",string:xx[this.Ufa]||"Unknown"})),Y.a.sendTelemetryEvent(Object.assign(new ha.a,
{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:k})))}Yff(){return 3===this.Ufa?"Icons":5===this.Ufa?"ExternalContent":"Images"}R2b(b){const k=document.getElementById(b);if(!k)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return k}l$m(){const b=new XMLHttpRequest;b.open("POST",this.K5b,!0);b.setRequestHeader("Content-Type","");return b}TXd(b,k){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.pzb(this.eWa);k?this.eda&&50<this.eda.length?(this.Bp(),
this.ukb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.eda.length,xx[this.Ufa])):this.eda&&0<this.eda.length?(k(this.eda),this.ukb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.eda.length,xx[this.Ufa])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.ync=!0,k(this.eda),this.ukb(2)):this.ukb(2)}iXm(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),Y.a.sendOtelEvent(Object.assign(new cB.a,{otelEvent:b})))}}Object(m.a)(rt,"InsertMediaDialog",yf.a,[324,10]);class gA{constructor(b,k){this.zte=b;this.$0=k}KIc(b,k=!1){return new rt(b,this.zte,this.$0,dB.vg,k)}getInstance(){throw Error.notImplemented();}}Object(m.a)(gA,"InsertMediaDialogFactory",null,[323]);class iu{constructor(b,k,r){this.Xbi=!1;this.correlationId=null;this.Ufa=0;this.K5b=null;this.aIj=b;this.mxc=[];this.Wbd=
k;this.l3g=r.split(";")}X8d(b,k){Array.clear(this.mxc);b=this.aIj.value;b.AVa(this.Wbd);b.Av(k.pLc);this.Xbi||(b.fC(k.pLc,r=>{this.TXd(r,k)}),this.Xbi=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(k.qxh,{["FileExtensionFilterList"]:this.l3g})}t7j(b){Array.contains(this.mxc,b)||this.mxc.push(b)}TXd(b,k){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=k.VEi(b);const r=[];
for(let y=0;y<b.length;y++){const R=b[y];k.OOd(R,this.l3g)?r.push(R):this.t7j(k.tZh(R))}r&&r.length?k.c_a(r):v.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.mxc.length&&(k=this.mxc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",k),this.A0n(k))}A0n(b){const k=new cf.StandardDialog;k.Gd=0;k.yU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(m.a)(iu,"InsertMediaFromHostManager",null,[324,10]);class yx{constructor(b){this.fJj=b}KIc(){throw Error.notImplemented();}getInstance(){return this.fJj}}Object(m.a)(yx,"InsertMediaFromHostManagerFactory",null,[322,323]);class PB{constructor(){this.WXa=document.createElement("iframe");this.WXa.src="about:blank";this.WXa.style.visibility="hidden";this.WXa.style.position="absolute";this.WXa.style.zIndex="-100"}}Object(m.a)(PB,"InsertMediaFromHostOneDriveHostFrame",null,[321]);
class Gq extends sq.a{constructor(b,k){super(b,"*"===k?k:Oa.a.N$(k));this.E8g(E.a.insertImage);this.E8g(E.a.sof)}C4d(){}}Object(m.a)(Gq,"InsertMediaFromOneDriveCrossDocumentMessenger",sq.a,[320,64,10]);class hA{}Object(m.a)(hA,"OnlineMediaSearchResult",null,[]);class mz{Jih(b,k,r,y){const R=yh.a.qg(n.AFrameworkApplication.lcid).name,aa=n.AFrameworkApplication.buildVersion,ta=A.a.cW(n.AFrameworkApplication.K.lb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ya=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;n.AFrameworkApplication.Ne("ShIns226;ShIns226cf");return String.format(b,n.AFrameworkApplication.lcid,R,aa,k,mz.Ege,ta,y,r,Ya)}return String.format(b,n.AFrameworkApplication.lcid,R,aa,k,mz.Ege,ta,y,r)}j5m(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let k="";"sourceProvider"in b&&(k=b.sourceProvider||"");return Object.assign(new hA,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:k,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||""})}k5m(b){const k=[];if(!b||!b.Values||!b.Values.Items)return k;b=b.Values.Items;for(let y=0;y<b.length;y++){var r=b[y];r&&(r=Object.assign(new hA,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),k.push(r))}return k}jLf(b){const k=[];for(let y=
0;y<b.data.files.length;y++){var r=b.data.files[y];r&&(r=Object.assign(new hA,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),k.push(r))}return k}OOd(b,k){if(!b)return!1;for(let r=0;r<k.length;r++)if(0<=b.toLowerCase().indexOf(k[r]))return!0;return!1}b$m(b){let k="";if(b)for(let r=0;r<b.length;r++){const y=b[r];y&&(k+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',y.OriginalUrl,
y.Width,y.Height))}return k}}mz.Ege=0;Object(m.a)(mz,"InsertMediaHelper",null,[319]);class nz{constructor(b,k,r,y,R){this.Ygm=b;this.Mrf=k;this.cfi=r;this.Zgm=y;this.$gm=R}}Object(m.a)(nz,"InsertMediaSettingsManager",null,[]);class oz{constructor(b){this.Apc=Wa.a.insertHyperlink;this.ga=b}get DMa(){return this.Apc}set DMa(b){this.Apc=b}c_a(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let k=0;k<b.length;k++)this.ga.Xb(this.DMa,
2,b[k]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(k){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",k.toString())}}}Object(m.a)(oz,"InsertOneDriveFileHandler",null,[304]);class kg extends oz{constructor(b){super(b)}get qxh(){return E.a.sof}get pLc(){return E.a.p7l}VEi(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}tZh(){Od.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}OOd(){return!0}IIi(b,k,r){b=r(b);b.length&&(r={},r.Items=b,k.sendMessage(this.pLc,r))}XEi(b){const k=[];for(let r=0;r<b.data.files.length;r++){const y=b.data.files[r];if(y){const R={};R.DisplayText=String.format("{0}{1}",y.name,y.extension);R.Url=this.dcl([y.urls.viewInBrowser,y.urls.open,y.urls.download]);k.push(R)}}return k}dcl(b){for(let k=0;k<b.length;k++)if(b[k]&&""!==b[k])return b[k];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(kg,
"InsertOneDriveFileHelper",oz,[303,304]);class eB{constructor(b,k,r){this.Apc=Wa.a.Q1;this.Ep=null;this.ga=b;this.$0=k;this.kda=r}get wc(){return this.ga}get lw(){return this.Ep||(this.Ep=Va.a.instance.resolve("Common.Utils.IAriaNotifier"))}get DMa(){return this.Apc}set DMa(b){this.Apc=b}c_a(b){try{v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const k=this.$0.b$m(b);let r=2;if(k&&0<k.length){const y=new Di.DictionaryPropertySet;
y.setValue(td.a.PQ,k);y.setValue(td.a.N6,!0);if(this.kda){const R=this.kda.o1c();R.WXb("insertOnlineImage");y.setValue(td.a.csa,R)}r=this.ga.Xb(this.DMa,2,y)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===k)}catch(k){v.ULS.CK(21612225,352,10,k,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(eB,"InsertOnlineImageHandler",null,[304]);class zx extends eB{constructor(b,
k,r=null){super(b,k,r)}get qxh(){return E.a.insertImage}get pLc(){return E.a.B7l}VEi(b){return this.$0.k5m(b)}tZh(b){return b.Type}OOd(b,k){return this.$0.OOd(b.Type,k)}XEi(b){return this.$0.jLf(b)}IIi(b,k,r){r=r(b);if(r.length){b=[];for(let y=0;y<r.length;y++){const R=r[y],aa={};aa.Extension=R.Type;aa.SourceUrl=R.OriginalUrl;aa.caption=R.Type;aa.SourceUrl=R.OriginalUrl;aa.Width=R.Width;aa.Height=R.Height;b.push(aa)}r={};r.Items=b;k.sendMessage(this.pLc,r)}}}Object(m.a)(zx,"InsertOnlineImageHelper",
eB,[303,304]);class GC{constructor(b,k){this.Gpb=b;this.Wid=k}start(b){this.Gpb.start({mode:"open",select:"multi",lightbox:"white"},(k,r)=>{this.iOf(k,r,b)})}iOf(b,k,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&k&&k.data&&k.data.files&&0<k.data.files.length?(b=this.Wid.getInstance(window.frames[0].parent,window.document.URL),r.IIi(k,b,Object(u.a)(r,r.XEi,"parseOneDriveV5Response"))):v.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(GC,"OneDriveFilePickerHelperV5",null,[281]);class QB{constructor(){this.Rcd=this.W=null}get name(){return"Box4.Media"}zc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new PB).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const k=new nz(Boolean.parse(n.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),n.AFrameworkApplication.Nrf(),
!1,n.AFrameworkApplication.D0f(),n.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new GC(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new fA(n.AFrameworkApplication.ya,n.AFrameworkApplication.K,k,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new cg.a(()=>Va.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),n.AFrameworkApplication.V7b,n.AFrameworkApplication.Wma,
n.AFrameworkApplication.W_l,n.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new gA(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new yx(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new iu(new cg.a(()=>{if(n.AFrameworkApplication.D0f()){var r=Va.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").WXa;r=new Gq(r.contentWindow,"*")}else r=n.AFrameworkApplication.MW;return r}),n.AFrameworkApplication.D0f()?Oa.a.N$(window.document.URL):Oa.a.N$(n.AFrameworkApplication.RHb),n.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(bB,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(mz,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new zx(n.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new kg(n.AFrameworkApplication.ya)).singleInstance()}init(){this.Rcd=this.W.resolve("Box4.Media.InsertMediaActor");this.Rcd.Vb()}dispose(){this.Rcd&&this.Rcd.dispose()}}Object(m.a)(QB,"MediaPackage",null,
[1,2]);var vy=c(282);class Hw{constructor(){this.jCn="getAddinShortcutsPreference";this.kCn="saveAddinShortcutsPreference";this.lCn="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Hil=6E4;this.gWd=this.Mka=this.R7=null}AZh(b){return String.format(this.lCn,n.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,n.AFrameworkApplication.ym)}executeRequest(b,k,r,y,R=null){return Hw.kka.pXb(b,k,R,null,r,y,!1,null,this.Hil)}saveSetting(b,k,r,y,R){return this.dWi(b,k,r,null,y,
R)}startBatchUpdateScope(){this.gWd=[]}saveShortcutInfoArrayBatch(b,k,r){this.pEn(r,b,k)}pEn(b,k,r){const y={action:"",addinId:"",ownerType:0};y.timestamp=(new Date).toUTCString();const R=this.getShortcutInfoArray(k.toString(),r.toString());b?(y.shortcutInfoArray=b,this.nOe(k,r,b)):R&&(y.shortcutInfoArray=R);b={};b[k.toString()]=y;k=new vy.a(r.toString(),b);this.gWd.push(k)}commitBatchUpdateScope(){return this.z0c()?this.rEn().then(()=>{this.MYb();return Promise.resolve(!0)}):this.tEn().then(()=>
{this.MYb();return Promise.resolve(!0)})}rEn(){return this.getSetting().then(b=>{let k=null;if(b&&!({Iv:k}=x.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);k||(k={});for(const r of this.gWd){(b=k[r.key])||(b={});const y=r.value;for(const R of Ba.a.WN(y))b[R]=y[R];k[r.key]=b}this.R7=k;try{return localStorage.setItem("AddinShortcutPreferenceData",x.c(k)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}tEn(){return this.WIn().then(b=>this.I5d(b))}WIn(){return this.fif().then(b=>{let k=null;b&&(({Iv:k}=x.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));k||(k={});for(const r of this.gWd){(b=k[r.key])||(b={});const y=r.value;for(const R of Ba.a.WN(y))b[R]=y[R];k[r.key]=b}this.R7=k;return x.c(k)})}saveShortcutInfoArray(b,k,r){return this.dWi(0,
"","",r,b,k)}dWi(b,k,r,y,R,aa){const ta=this.z0c(),Ya={};Ya.action=r;Ya.addinId=k;Ya.ownerType=b;Ya.timestamp=(new Date).toUTCString();k=this.getShortcutInfoArray(R.toString(),aa.toString());0===b&&y?(Ya.shortcutInfoArray=y,this.nOe(R,aa,y)):k&&(Ya.shortcutInfoArray=k);b={};b[R.toString()]=Ya;R=new vy.a(aa.toString(),b);return ta?this.qEn(R):this.sEn(R)}qEn(b){return this.getSetting().then(k=>{let r=null;if(k&&!({Iv:r}=x.d(k)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.R7=r;try{return localStorage.setItem("AddinShortcutPreferenceData",x.c(r)),Promise.resolve(!0)}catch(y){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",y),Promise.resolve(!1)}})}sEn(b){return this.VIn(b).then(k=>this.I5d(k))}VIn(b){return this.fif().then(k=>{let r=null;k&&(({Iv:r}=x.d(k)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
r||(r={});r[b.key]=b.value;this.R7=r;return x.c(r)})}saveSettings(b){this.R7=x.a(b);this.MYb();return this.z0c()?this.gWi(b):this.I5d(b)}gWi(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(k){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",k),Promise.resolve(!1)}}I5d(b){const k={};k.Wac=b;const r=x.c(k);return new Promise(y=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)y(!1);else{var R=this.executeRequest(this.AZh(this.kCn),
2,"SaveAddinShortcutsPreferenceRequest","38",r);R.continueWith(()=>{if(R.jo||R.Ki)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),y(!1);else{var aa=R.result;void 0!==aa.args&&null!==aa.args&&void 0!==aa.args.data&&null!==aa.args.data&&aa.args.data.Df===Za.a.yD?y(!0):y(!1)}})}}catch(aa){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",aa.toString()),y(!1)}})}getSetting(){const b=this.z0c();return this.R7?Promise.resolve(x.c(this.R7)):
b?this.IKl():this.fif()}z0c(){const b=n.AFrameworkApplication.K.$("IsAnonymousUser"),k=n.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!k}IKl(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}fif(){return new Promise((b,k)=>{try{const r=this.executeRequest(this.AZh(this.jCn),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.jo||
r.Ki)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let R="";var y=r.result;y&&y.args&&y.args.data?y.args.data.Df!==Za.a.yD?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",y.args.data.Df):y.args.data.Ie?(y=x.a(y.args.data.Ie),y.Wac&&(R=y.Wac)):v.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(R)}})}catch(r){v.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),k("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const k=this.z0c(),r=this;return this.getSetting().then(y=>{let R=null;y&&(R=x.a(y));if(!R)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const aa of Ba.a.WN(R)){y=R[aa.toString()];for(const ta of Ba.a.WN(y)){const Ya=y[ta];if(Ya.addinId===b)delete y[ta.toString()];else if(0===Ya.ownerType&&
Ya.shortcutInfoArray){const xb=Ya.shortcutInfoArray,Mb=new rb.a;for(let cc=0;cc<xb.length;++cc)xb[cc].addinId!==b&&Mb.add(xb[cc]);Ya.shortcutInfoArray=Mb.toArray()}}Ba.a.count(y)||delete y[aa]}r.R7=R;r.Arn(b);return k?r.gWi(x.c(R)):r.I5d(x.c(R))})}MYb(){if(this.R7){this.Mka=null;const r=this.R7;for(let y in r){var b=y;const R=r[y];for(let aa in R){var k=aa;const ta=R[aa];ta.shortcutInfoArray&&this.nOe(parseInt(k),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let k=null;if(b&&!({Iv:k}=x.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.R7=k;this.MYb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,k,r){return this.R7&&(r=this.R7[r])&&(k=r[k])&&k.addinId===b?k:null}getShortcutInfoArray(b,k){return this.R7&&(k=this.R7[k])&&(b=k[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
k,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(k),r)}setShortcutInfoArray(b,k,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(k),r).then(()=>{this.MYb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,k){if(!this.Mka)return Promise.resolve(!0);var r=this.Mka[b];if(!r)return Promise.resolve(!0);var y=r[k];r=y.modifiers;y=y.keyCode;const R=this.getShortcutInfoArray(r.toString(),y.toString());if(!R||!R.length)return Promise.resolve(!0);let aa=0;for(const ta of R){if(ta.addinId===
b&&ta.action===k)break;++aa}if(aa>=R.length)return Promise.resolve(!0);R.splice(aa,1);return this.saveShortcutInfoArray(r,y,R).then(()=>{this.MYb();return Promise.resolve(!0)})}nOe(b,k,r){this.Mka||(this.Mka={});for(const y of r){r=y.addinId;const R=y.action;let aa=this.Mka[r];aa||(aa={});const ta={};ta.modifiers=b;ta.keyCode=k;aa[R]=ta;this.Mka[r]=aa}}Arn(b){b in this.Mka&&delete this.Mka[b]}isActionCustomized(b,k){return this.Mka&&(b=this.Mka[b])&&b[k]?!!b[k]:!1}getShortcutByCustomizedAction(b,
k){return this.Mka&&(b=this.Mka[b])?b[k]:null}getShortcutsPreferenceMappingTable(){return this.R7}static instance(){Hw.fQe||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Hw.fQe=new Hw,Hw.kka=n.AFrameworkApplication.af);return Hw.fQe}}Hw.fQe=null;Hw.kka=null;Object(m.a)(Hw,"AddinShortcutsPreferenceSettingHelper",null,[]);class HC{constructor(b,k){this.c9c=null;new rb.a;this.kMg=!0;this.obd=b;this.IHg=k}yPe(b){this.IHg.addHandler("GoalChangedEvent",b)}hPm(){this.IHg.raiseEvent("GoalChangedEvent")}nqf(b,
k){return this.c9c&&this.kMg?b in this.c9c?this.c9c[b]:"Formality"===k&&this.obd.Whf().formality?!1:!0:!0}RKn(b,k){k===this.obd.Whf().formality&&(this.c9c=b,this.hPm())}xlo(b){this.kMg=b}}Object(m.a)(HC,"GoalChangeSource",null,[254,255,256]);var RB=c(958),IC=c(906),GD=c(697);class HD{constructor(b,k,r,y,R,aa){this.vHa=k;this.Yxa=r;this.Jf=b;this.OJ=y;this.fg=R;this.mHj=aa;this.Yxa.yDb()&&this.initialize()}initialize(){return this.OJ.Qm().then(()=>{this.Jf.mb(this,RB.a.getTypeName());this.Jf.addHandler(this,
IC.a.getTypeName())}).catch(b=>{this.fg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}GF(b,k){if(k===uo.a.getTypeName()||k===GD.a.getTypeName())if(!b||!b.content)this.fg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(qm.a.getTypeNameFor(b.content)===RB.a.getTypeName()||qm.a.getTypeNameFor(b.content)===IC.a.getTypeName())if(qm.a.getTypeNameFor(b.content)===RB.a.getTypeName()){var r=b.content;this.fg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.vHa.RKn(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(qm.a.getTypeNameFor(b.content)===IC.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.mHj.xlo(!!r.supportType);return}this.fg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.fg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(m.a)(HD,"GoalsAnnotationHandler",null,[54]);class ID{constructor(b){this.Oa=b}yDb(){return this.Oa.$("EditorGoalsEnabled")}}Object(m.a)(ID,"GoalsGate",null,[253]);var kE=c(1164),JD=c(1165),SB=c(859);class Bs{}Bs.Pyd=0;Bs.Tyd="1.0";Bs.settingType="Goals";Object(m.a)(Bs,"GoalsConstants",null,[]);var fB=c(1033);class iA{constructor(b,k,r,y,R){this.RTb=null;this.Aei=!1;this.$Wg=b;this.qbd=k;this.fg=r;this.Yxa=y;this.lre=R;this.Yxa.yDb()?this.Fin():this.Yxa.yDb()&&this.yXf(Bs.Pyd,Bs.Tyd)}Fin(){new Promise(b=>
{this.$Wg.OXh(Bs.settingType,k=>{this.Gin(k)?(this.yXf(this.RTb.formality,this.RTb.version),b(this.RTb)):(this.yXf(Bs.Pyd,Bs.Tyd),b(null))})})}Gin(b){this.Aei=!0;if(!b||!b.Vkb)return this.fg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Vkb.properties;var k=b.getValue(wc.a.O$h);k=parseInt(k);b=b.getValue(wc.a.gNd);if(!this.qbd.U$f(b))return this.fg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.RTb=
b=Object.assign(new fB.a,{formality:k,version:b});this.fg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}yXf(b,k){b=Object.assign(new SB.a,{formality:b,version:k});this.lre.HYi(b)}byo(b){if(this.qbd.U$f(b.version)){var k=kE.a.ILk(b.version,b.formality.toString());this.$Wg.b$g(Object.assign(new JD.a,{Vkb:k,settingType:Bs.settingType}))?this.RTb=b:this.fg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.fg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}JUh(){this.Aei||this.fg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.RTb}}Object(m.a)(iA,"GoalsPersistenceHandler",null,[250]);class KD{constructor(b,k,r,y){this.fg=b;this.mre=k;this.qbd=r;this.Yxa=y;this.pbd=Object.assign(new fB.a,{formality:Bs.Pyd,version:Bs.Tyd});this.xHe=this.Yxa.yDb()}Whf(){this.xHe&&(this.xHe=!1,this.mre.JUh()&&(this.pbd=this.mre.JUh()));
return this.pbd}KQn(b){this.xHe=!1;this.qbd.U$f(b.version)?(this.Yxa.yDb()&&this.mre.byo(b),this.pbd=b):(this.fg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.pbd=Object.assign(new fB.a,{formality:Bs.Pyd,version:Bs.Tyd}))}}Object(m.a)(KD,"GoalsProvider",null,[251,252]);class TB{constructor(b,k,r,y){this.Jf=b;this.OJ=k;this.m4=r;this.fg=y}HYi(b){b=Object.assign(new uo.a,{parentPath:["Signal",SB.a.getTypeName()],items:[Object.assign(new xl.a,{body:b})]});
this.SAd(b)}SAd(b){this.OJ.Qm().then(()=>{this.LNe(b)}).catch(k=>{this.fg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",k)})}LNe(b){return this.Jf.activateAnnotation(RB.a.getTypeName(),TB.MXb).then(()=>{this.m4.getAugLoopRuntimeManager().submitOperation(Object.assign(new Sp.a,{operation:b}))}).catch(k=>{this.fg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",k)})}}TB.MXb="GoalSelected";Object(m.a)(TB,"GoalsSignalSender",null,[249]);class wy{constructor(){wy.vMe=
new RegExp(wy.i0j)}U$f(b){return!!b.match(wy.vMe)&&1===b.match(wy.vMe).length}}wy.i0j="[0-9]+[.]?[0-9]*";wy.vMe=null;Object(m.a)(wy,"GoalsValidator",null,[248]);class UB{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}zc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new wy).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new ID(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new KD(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new HC(this.W.resolve("WordEditor.Goals.IGoalReader"),new Fe.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new iA(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new HD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new TB(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){M.a.instance.Pc(new UB)}}
Object(m.a)(UB,"WordEditorGoalsPackage",null,[1,2]);var xy=c(744),JC=c(424);class VB{constructor(){this.annotation=null;this.languages=new kb.a(ka.a.Sj())}}Object(m.a)(VB,"CritiqueCountWrapper",null,[]);class Ax{constructor(){this.Dpa=new Fc.a}jFd(){return this.Dpa}F8h(b,k,r,y){if(this.Dpa.ub(r)){this.Dpa.J(r).annotation.count+=k;r=this.Dpa.J(r).languages;for(var R of y)r.add(R)}else R=G.a.create().toString(),b=Object.assign(new JC.a,{id:R,categoryName:b,count:k}),this.Dpa.add(r,Object.assign(new VB,
{annotation:b,languages:y}))}}Ax.Hi=389;Object(m.a)(Ax,"BaseCritiquesByTypeCounter",null,[235]);class KC extends Ax{constructor(b){super();this.mtb=new Ia.a;this.$le=new Ia.a;this.Bpd=b}GTl(b){const k=b.annotation;if(k&&xy.a(qm.a.getTypeNameFor(k.content))){const r=k.content;if(b.opType===uo.a.getTypeName()){this.Bpd.Etn(k.parentPath,r);b=r.M_.state;if(60!==b&&70!==b)return this.mtb.contains(k.id)&&this.mtb.remove(k.id),this.F2l(k.id,r),!0;this.mtb.add(k.id)}else if(b.opType===jb.a.getTypeName())if(this.mtb.contains(k.id))this.mtb.remove(k.id);
else return this.qyh(r.typeId,k.id)}return!1}FTl(b){if((b=b.annotation)&&xy.a(qm.a.getTypeNameFor(b.content))){const k=b.content,r=k.M_.state;if((60===r||70===r)&&!this.mtb.contains(b.id))return this.mtb.add(b.id),this.qyh(k.typeId,b.id)}return!1}F2l(b,k){this.$le.add(b);b=new kb.a(ka.a.Sj());k.language&&b.add(k.language);this.F8h(k.categoryName,1,k.typeId,b)}qyh(b,k){if(!this.$le.contains(k))return!1;if(!this.Dpa.ub(b))return v.ULS.sendTraceTag(589866503,Ax.Hi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Dpa.J(b).annotation.count)return v.ULS.sendTraceTag(589866504,Ax.Hi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.$le.remove(k);this.Dpa.J(b).annotation.count--;return!0}}Object(m.a)(KC,"AlCritiquesByTypeCounter",Ax,[259,235]);var eL=c(974);class BG extends Hr.a{constructor(b,k,r,y,R,aa,ta,Ya,xb){var Mb;super();this.Jf=b;this.Bpd=k;this.Ohe=
r;this.OCg=y;this.vHa=R;this.Lqa=aa;this.Hh=ta;this.S8=this.hBg=!1;this.NAe=new Fc.a;this.pUm=(cc,jc)=>{this.Bpd.EUl(jc)&&(this.S8=!0,this.rX())};this.qRm=(cc,jc)=>{this.Ohe.GTl(jc)&&this.RJb()};this.hyi=()=>{this.RJb()};this.JFf=(cc,jc)=>{this.Ohe.FTl(jc)&&this.RJb()};this.tib=()=>{this.RJb()};this.RJb=()=>{let cc=!1;this.Hh.Qd(()=>{var jc=this.Opl();const Mc=new rb.a;for(let fd of jc)jc=Object.assign(new eL.a,{id:fd.id,parentPath:Ho.a.Pyb,content:fd,annotationType:qm.a.getTypeNameFor(fd)}),Mc.add(jc),
cc||(cc=0<fd.count);this.Jf.QKn(Mc)},"CC:SATH");!this.hBg&&cc&&(Y.a.sendTelemetryEvent(Object.assign(Object.assign({},new ha.a),{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.hBg=!0)};this.Ncm=(cc,jc,Mc)=>{const fd=!this.vHa||this.vHa.nqf(cc,Mc);cc=this.Lqa&&this.Lqa.instance?this.Lqa.instance.zOd(cc,Mc,jc.substr(1,jc.length-2)):!0;return fd&&cc};null===Ya||void 0===Ya?void 0:Ya.yPe(this.tib);xb.koa(this,7);null===(Mb=this.Lqa)||void 0===Mb?void 0:Mb.execute(cc=>{cc.TPe(this.RJb)})}get index(){return 3}run(){this.S8&&
(this.RJb(),this.S8=!1)}BAi(){this.RJb()}FIk(b){let k=0;if(({value:k}=this.NAe.Bc(b.categoryName,0)).returnValue)if(k!==b.count)this.NAe.Z(b.categoryName,b.count);else return!1;else this.NAe.add(b.categoryName,b.count);return!0}Opl(){const b=new Fc.a;var k=this.Bpd.jFd();const r=this.Ohe.jFd();this.Q8f(b,k);this.Q8f(b,r);this.OCg&&(k=this.OCg.jFd(),this.Q8f(b,k));k=new rb.a;for(let y of b.values)this.FIk(y)&&k.add(y);return k}Q8f(b,k){for(let R of k){k=R.value.annotation;const aa=R.key;var r=this.UIn(R.value.languages);
if(!b.ub(k.categoryName)){var y=G.a.create().toString();y=Object.assign(new JC.a,{id:y,categoryName:k.categoryName,count:0,countsByTypeId:{}});b.add(k.categoryName,y)}this.Ncm(aa,r,k.categoryName)&&(r=b.J(k.categoryName),r.count+=k.count,r.countsByTypeId[aa]=(r.countsByTypeId[aa]?r.countsByTypeId[aa]:0)+k.count)}}UIn(b){const k=[];let r=0;for(let y of b)k[r++]=y;return x.c(k)}}Object(m.a)(BG,"CritiquesCounter",Hr.a,[257,258]);class CG{constructor(b){this.sY=b}jFd(){const b=new Fc.a,k=new kb.a(ka.a.Sj()),
r=Object.assign(new JC.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.sY.zlc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new VB,{annotation:r,languages:k}));return b}}Object(m.a)(CG,"DictationCritiquesByTypeCounter",null,[237,235]);class DG extends Ax{constructor(b){super();this.a6a=new Fc.a;this.Jf=b}EUl(b){const k=Ho.a.AHd(b.nodeId);if(!Ho.a.lf(k)){if(b.Kcb&&b.Kcb.length){let r=null;for(let y of b.Kcb)y.errorDetails.F_a()||(b=this.sQh(y),
Ho.a.lf(b)||(r||(r=new Fc.a),r.ub(b)||r.add(b,new rb.a),r.J(b).add(y)));this.ryh(k);r?this.KOn(k,r):this.a6a.remove(k)}else{if(!this.a6a.ub(k))return!1;this.ryh(k);this.a6a.remove(k)}return!0}return!1}Etn(b,k){var r;if(({value:r}=this.a6a.Bc(b,r)).returnValue)for(let R of r)if(b=R.value,0<b.count&&this.pdf(b.J(0))===k.categoryName)for(r=b.count-1;0<=r;r--){var y=b.J(r).end-b.J(r).begin;b.J(r).begin===k.range.start&&y===k.range.length&&(y=this.sQh(b.J(r)),this.Dpa.ub(y)&&(y=this.Dpa.J(y).annotation,
y.count=Math.max(0,y.count-1)),b.removeAt(r))}}ryh(b){if(this.a6a.ub(b))for(let r of this.a6a.J(b)){var k=r.key;b=r.value;this.Dpa.ub(k)&&(k=this.Dpa.J(k).annotation,k.count=Math.max(0,k.count-b.count))}}KOn(b,k){const r=new Fc.a,y=new Fc.a;for(let R of k){k=R.key;y.add(k,new kb.a(ka.a.Sj()));for(let aa of R.value){const ta=aa.end-aa.begin,Ya=this.pdf(aa);this.xvk(b,Ya,aa.begin,ta)?v.ULS.sendTraceTag(589866513,Ax.Hi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
k,b,aa.begin,ta):(r.ub(k)||r.add(k,new rb.a),r.J(k).add(aa),y.J(k).add(this.Qpl(aa)))}}this.a6a.Z(b,r);for(let R of this.a6a.J(b))0<R.value.count&&(b=this.pdf(R.value.J(0)),this.F8h(b,R.value.count,R.key,y.J(R.key)))}sQh(b){let k=null;b&&(b=Object(ia.a)(233,b.errorDetails))&&b.Ss&&(k=b.Ss.TypeId);return k}pdf(b){let k=null;b&&(b=Object(ia.a)(233,b.errorDetails))&&b.Ss&&(k=b.Ss.CategoryTitle);return k}Qpl(b){let k="";b&&b.errorDetails&&(k=yh.a.qg(b.errorDetails.lcid).name);return k}xvk(b,k,r,y){if((b=
this.Jf.vNh(b))&&0<b.count)for(let R of b)if(b=qm.a.getTypeNameFor(R.content),R&&xy.a(b)&&(b=R.content,b.categoryName===k&&b.range.start===r&&b.range.length===y))return!0;return!1}}Object(m.a)(DG,"WacCritiquesByTypeCounter",Ax,[234,235]);class oF{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}zc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new DG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new KC(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var k=b.$("DictationCorrectionsInEditorPaneIsEnabled");k&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new CG(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>
new BG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Pa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Pa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.$a("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Bo.a.instance,this.W.Pa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();
b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Hah(b.pUm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").B8j(b.qRm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").sah(b.JFf);k&&(k=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),k.$$g(b.hyi),k.aah(b.hyi))}}dispose(){}static main(){M.a.instance.Pc(new oF)}}Object(m.a)(oF,"WordEditorCritiqueCountsPackage",null,[1,2]);class pF{get name(){return"WordEditor.GraphicsEditor"}zc(){}init(){}dispose(){}static main(){M.a.instance.Pc(new pF)}}
Object(m.a)(pF,"PackageManager",null,[1,2]);var fL=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",
attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class EG{constructor(b){this.VDj={};this.Ub=b;this.wtb=new xc.a}gLa(b,k){const r=this.Ub.vbc,y=parseInt(b);return b&&y!==Kd.ActionManager.P6e?this.wtb.ub(r)?(b=this.wtb.J(r).BKc(y,k,2),32===b||1===b):!1:!1}LCa(b){const k=parseInt(b),r=this.Ub.vbc;return b&&k!==Kd.ActionManager.P6e?this.wtb.ub(r)?
32===this.wtb.J(r).BKc(k,this.VDj,1):!1:!0}UNi(b,k){this.wtb.Z(b,k)}q4i(b){b=parseInt(b);const k=this.Ub.vbc;return!!k&&!!this.wtb.J(k)&&this.wtb.J(k).Tbm(b)}}Object(m.a)(EG,"NonCanvasCuiUser",null,[961,232]);var pz=c(1188),WB=c(61),LD;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";
b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(LD||(LD={}));Object(m.b)("GalleryType",LD);class jv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(jv,"CommonGalleryButtonProps",null,[]);class mE extends jv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(mE,"AdditionalTableStyleGalleryButtonProps",jv,[]);class FG extends mE{constructor(){super()}}
Object(m.a)(FG,"AdditionalChangeColorsGalleryButtonProps",mE,[]);class GG extends jv{constructor(){super();this.character=null}}Object(m.a)(GG,"AdditionalCharacterCodeGalleryButtonProps",jv,[]);class HG extends jv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(HG,"AdditionalFontStyleGalleryButtonProps",jv,[]);class IG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}
Object(m.a)(IG,"AdditionalGalleryProperties",null,[]);class JG extends jv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(JG,"AdditionalIconButtonProperties",jv,[]);class KG extends jv{constructor(){super();this.styleDisplayName=null}}Object(m.a)(KG,"AdditionalInkThicknessGalleryButtonProps",jv,[]);class LG extends jv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(LG,
"AdditionalListGallerButtonProps",jv,[]);class MG extends jv{constructor(){super();this.text=null}}Object(m.a)(MG,"AdditionalPageNumberGalleryButtonProps",jv,[]);var LC=c(1115);const gL=(b,k)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(ia.a)(Object,r[b])){if((b=Object(ia.a)(String,r.value))&&b===k)return!1;b=Object(ia.a)(String,r.selectedKey);if(!k&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let y=null;for(let R=0;R<r.length;R++){const aa=Object(ia.a)(Object,
r[R]);if(Object(ia.a)(String,aa.key)===b){y=aa;break}}if(y&&Object(ia.a)(String,y.text)===k)return!1}}return!0},OG=(b,k,r,y)=>{if(0<(y&2)){y=[];switch(k){case "ToggleButtonModel":case "InkButtonModel":y.push(nE(b,r[Ig.a.On]));break;case "CheckboxModel":y.push(appChrome.actions.toggleCheckbox(b,r[Ig.a.On]));break;case "ComboBoxModel":if(n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!gL(b,r[ge.a.Value]))break;(k=r[ge.a.Key])?y.push(appChrome.actions.updateComboBoxKey(b,k,r[ge.a.Value])):y.push(appChrome.actions.updateComboBoxValue(b,r[ge.a.Value]));break;case "FontPickerModel":y.push(appChrome.actions.updateFontPickerSelectedFont(b,r[LC.a.SelectedFont]));break;case "SplitButtonModel":y.push(nE(b,r[Sd.a.On]));break;case "SpinButtonModel":y.push(appChrome.actions.updateSpinButton(b,r[rc.a.Number],Rg.a.j_b(r[rc.a.UnitType]),r[rc.a.Text],r[rc.a.MaxValue],r[rc.a.Alt]));break;
case "ColorPickerModel":y.push(appChrome.actions.updateColorPickerSelectedColor(b,r[pm.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":y.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[eh.a.Text]));break;case "CompoundButtonModel":r[Ig.a.Description]&&y.push(appChrome.actions.updateCompoundButtonDescription(b,r[Ig.a.Description]));Ig.a.On in r&&y.push(nE(b,r[Ig.a.On]));break;case "SliderModel":r.snapToStep?y.push(appChrome.actions.updateSliderSelectedValue(b,r[sb.Value])):
y.push(appChrome.actions.updateSliderValue(b,r[sb.Value],r[sb.MinValue]||0,r[sb.MaxValue],r[sb.Text]));break;case "FlyoutAnchorModel":Ki.a.ImageIsVisible in r&&y.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[Ki.a.ImageIsVisible]));Ig.a.On in r&&y.push(nE(b,r[Ig.a.On]));break;case "InputBoxModel":y.push(appChrome.actions.updateInputBoxValue(b,r[gf.a.Text]))}k=y;var R=Object(ia.a)(String,r[xj.a.iconColor]);void 0!==R&&null!==R&&k.push(appChrome.actions.updateIconColor(b,R));NG(b,r,y);k=y;(R=Object(ia.a)(Object,
r[xj.a.IconSet]))&&k.push(appChrome.actions.setControlIconSet(b,R));k=y;R=Object(ia.a)(String,r[xj.a.customTooltip]);void 0!==R&&null!==R&&k.push(appChrome.actions.setControlCustomTooltip(b,R));b=y;(r=Array.isArray(r[xj.a.rRf])?r[xj.a.rRf]:null)&&b.push.apply(b,r);return y}return null},XB=(b,k)=>appChrome.actions.updateControlEnabledDisabledState(b,k),nE=(b,k)=>appChrome.actions.toggleButton(b,k),NG=(b,k,r)=>{k=Object(ia.a)(String,k[xj.a.Icon]);void 0!==k&&null!==k&&r.push(appChrome.actions.setControlIcon(b,
k))};class PG{constructor(b,k,r,y){this.rm=y;this.Tqa=b;this.zz=k;this.EUb=r;this.wqc={}}p8m(b,k,r,y,R=null){const aa=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;y.push(aa);if(appChrome.selectors.isControlDefined(aa))b.GalleryStyle&&ni.d("setGalleryStyles")&&k.push(appChrome.actions.setGalleryStyles(aa,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(aa,Object.assign(new IG,{columns:b.Width,sections:[appChrome.api.gallerySection([],ta)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}r=0;y=!!n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(ni.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const xb=[],Mb=[],cc={};for(var Ya of b.GallerySections){ta.push(appChrome.api.gallerySection([],Ya.SectionId,Ya.Title));0===r&&Ya.GalleryButtons&&0<Ya.GalleryButtons.length&&
(r=Ya.GalleryButtons[0].Type);y&&this.eYh(Ya.GalleryButtons,R,cc);const jc=this.AOe(xb,Ya.GalleryButtons,cc);xb.push.apply(xb,this.mhf(jc,aa,Ya.SectionId,!1,r,R,!0,cc));Mb.push.apply(Mb,jc)}k.push(appChrome.actions.setGallerySections(aa,ta));k.push.apply(k,xb);k.push.apply(k,this.Sef(aa,LD[r],Mb,null,5===b.Type,!0,null,cc))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ya=y?this.eYh(b.GalleryItems,R):null,k.push.apply(k,this.mhf(this.AOe(k,b.GalleryItems,Ya),aa,ta,!1,r,
R,!1,Ya))}zGl(b,k){const r=[];let y=null,R=!1;if(!b)return null;const aa=this.Tqa.eVc(this.zz,b.commandId,k);r.push(XB(b.externalUxCommand,!aa));if(b.previewControlIds){const xb=[];for(let Mb=0;Mb<b.previewControlIds.length;Mb++){var ta={},Ya=b.previewControlIds[Mb];ta.SourceControlId=Ya;const cc=this.rm.getCommandByExternalUxId(Ya);this.JHd(cc||b,ta);ta[eh.a.On]&&(y=ta.SourceControlId,ta[eh.a.HighlightOn]&&(R=!0));NG(Ya,ta,r);if(ta=Object(ia.a)(kq.a,ta[eh.a.GalleryButtonProps]))xb.push(ta),aa&&(Ya=
this.Tqa.eVc(this.zz,ta.Command,k),ta.IsDisabled=!Ya)}0<xb.length&&r.push.apply(r,this.mhf(this.AOe(r,xb),b.externalUxCommand,b.externalUxCommand,!0,xb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,y));R&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",y),r.push(appChrome.actions.highlightSelectedFontStyle(y)))}return r}AOe(b,k,r=null){const y=[],R=[];for(let ta=0;ta<k.length;ta++){const Ya=k[ta],xb=xf.b(Ya.ExternalId)?Ya.Id:
Ya.ExternalId;y.push(xb);const Mb=r&&r[xb]?r[xb].result:-1;switch(Ya.Type){case 1:var aa=Ya;R.push(appChrome.api.createCharacterCodeGalleryButtonModel(xb,Object.assign(new GG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,character:aa.Character,style:aa.Style,title:aa.Alt})));break;case 2:aa=Ya;R.push(appChrome.api.createFontStylesGalleryButtonModel(xb,Object.assign(new HG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt,previewStyleLabel:aa.PreviewStyleLabel})));
break;case 3:aa=Ya;R.push(appChrome.api.createInkThicknessGalleryButtonModel(xb,Object.assign(new KG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt})));break;case 4:aa=Ya;R.push(appChrome.api.createIconGalleryButtonModel(xb,Object.assign(new JG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,icon:[aa.Icon],fullIconStyle:aa.FullIconStyle,previewIconStyle:aa.PreviewIconStyle,largePreviewIconStyle:aa.LargePreviewIconStyle,label:aa.LabelText,title:aa.Alt})));
break;case 5:aa=Ya;R.push(appChrome.api.createListGalleryButtonModel(xb,Object.assign(new LG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,infoAtLevel:aa.LevelInfo,ariaLabel:aa.Alt})));break;case 6:aa=Ya;R.push(appChrome.api.createTableStyleGalleryButtonModel(xb,Object.assign(new mE,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt,columns:aa.columns})));break;case 8:aa=Ya;R.push(appChrome.api.createChangeColorsGalleryButtonModel(xb,Object.assign(new FG,
{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt})));break;case 7:aa=Ya,R.push(appChrome.api.createPageNumberGalleryButtonModel(xb,Object.assign(new MG,{disabled:-1!==Mb?1>(Mb&1):aa.IsDisabled,text:aa.Text,title:aa.Alt})))}this.rm.addCommandToMaps(Object.assign(new WB.a(xb,Ya.Command),{queryCommandId:Ya.QueryCommand,menuItemId:Ya.MenuItemId}))}b.push(appChrome.actions.addControls(R));return y}mhf(b,k,r,y,R,aa=null,ta=!1,Ya=null){const xb=
[];y?xb.push(appChrome.actions.populateGalleryItems(k,b)):(this.wqc[k]=!1,ta||(y=!0,appChrome.selectors.isControlDefined(k)&&(y=appChrome.selectors.getGalleryState(k),y=y.disableIndividualButtons?y.disableIndividualButtons:!0),xb.push.apply(xb,this.Sef(k,LD[R],b,null,5===R,y,aa,Ya))),xb.push(appChrome.actions.updateGallerySectionItems(k,r,b)));return xb}hvl(b){return this.Sef(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}Sef(b,
k,r,y,R,aa=!0,ta=null,Ya=null){const xb=[];if(b in this.wqc){if(this.wqc[b])return delete this.wqc[b],xb;this.wqc[b]=!0}let Mb=null,cc=-1;if(r)({eMh:cc,returnValue:Mb}=this.t9g(k,r,xb,aa,ta,Ya));else if(y)for(const jc of y)(r=({eMh:cc}=this.t9g(k,jc.galleryButtons,xb,aa,null,Ya)).returnValue)&&(Mb=r);xb.push(appChrome.actions.updateGallerySelectedId(b,Mb));aa&&xb.push(XB(b,!1));R&&0<cc&&xb.push(appChrome.actions.updateListGalleryTextDirection(b,2===cc));return xb}dYh(b,k=null){const r={},y={};y.SourceControlId=
b;y.Location=k;b=this.rm.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=y,r;b=this.JHd(b,y);r.result=b;r.props=y;return r}eYh(b,k=null,r=null){r||(r={});for(const y of b)b=xf.b(y.ExternalId)?y.Id:y.ExternalId,r[b]=this.dYh(b,k);return r}t9g(b,k,r,y,R=null,aa=null){let ta,Ya=null;ta=-1;let xb=!1;for(const cc of k){var Mb=this.evl(b);k=aa&&aa[cc]&&-1!==aa[cc].result?aa[cc]:this.dYh(cc,R);const jc=k.result;k=k.props;y&&r.push(XB(cc,1>(jc&1)));(Mb=OG(cc,Mb,k,jc))&&r.push.apply(r,Mb);k[eh.a.On]&&
(Ya=cc,k[eh.a.HighlightOn]&&k[eh.a.HighlightOn]&&(xb=!0));void 0!==k[xj.a.labelText]&&null!==k[xj.a.labelText]&&(Mb=this.rm.getCommandByExternalUxId(cc),r.push(appChrome.actions.setControlLabel(Mb.externalUxCommand,k[xj.a.labelText])));k[eh.a.IsRtl]&&0>ta&&(ta=k[eh.a.IsRtl])}xb&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ya),r.push(appChrome.actions.highlightSelectedFontStyle(Ya)));return{returnValue:Ya,eMh:ta}}evl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}JHd(b,k){k.MenuItemId=b.menuItemId;return this.Tqa.Jna(this.zz,this.EUb,
b.commandId,b.queryCommandId,k)}}Object(m.a)(PG,"ReactGalleryPoller",null,[]);var hL=c(829),QG=c(661);class RG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(RG,"PopulateFontPickerDataProps",null,[]);var SG=c(302),qz=c(1771);class jA{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(m.a)(jA,
"CommonOptionalButtonProperties",null,[]);class oE extends jA{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(m.a)(oE,"OptionalButtonProperties",jA,[]);class TG extends jA{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(TG,"OptionalCompoundButtonProperties",jA,[]);class UG extends jA{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=
null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(UG,"OptionalFlyoutAnchorProperties",jA,[]);class VG extends oE{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(VG,"OptionalPersonaButtonProperties",oE,[]);class pE extends jA{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(pE,"OptionalToggleButtonProperties",jA,[]);var iL=c(1623),jL=c(1622),
kL=c(503);class WG{constructor(){this.bqh=this.actions=null;this.Pmj=!1}}Object(m.a)(WG,"PopulateActions",null,[]);class qF{W_h(b,k){switch(k){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.nHl(b);case "InkButtonModel":return this.mHl(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}nHl(b){const k=
{};k[Ig.a.On]=appChrome.selectors.getButtonToggleState(b);return k}mHl(b){const k={};k[Ig.a.On]=ni.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return k}}Object(m.a)(qF,"ReactStatePropsSelector",null,[]);class qE{constructor(b,k,r,y,R){this.Tqa=b;this.zz=k;this.EUb=r;this.rm=y;this.cJe={};this.rTj=new qF;this.gtb=R}H7i(b){const k=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&k in this.cJe}LHl(b,
k,r=null){const y=[],R={};if(!this.H7i(b)){const aa=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Tqa.Jna(this.zz,this.EUb,aa,aa,ta,this.Lxl(r))&1))if("FontPickerModel"===k)this.cJe[aa]=!0,y.push(qE.eGl(b,ta)),R[b.externalUxCommand]="FontPickerModel";else if(ta.MenuItems)switch(this.cJe[aa]=!0,k){case "ComboBoxModel":y.push(qE.cGl(b,ta));R[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":y.push.apply(y,
this.a2h(b.externalUxCommand,k,ta.MenuItems,R,r&&"location"in r?r.location:null))}}return Object.assign(new WG,{actions:y,bqh:R,Pmj:this.isShadowMenuOpen(r)})}a2h(b,k,r,y,R=null){const aa=[],ta=[],Ya=[],xb=[];for(let Mb=0;Mb<r.MenuSectionList.length;Mb++){const cc=Object(ia.a)(oi.a,r.MenuSectionList[Mb]);if(!cc)continue;let jc=null;const Mc=[];xf.c(cc.Title)||(jc=cc.Title);for(let fd=0;fd<cc.ControlList.length;fd++){const Td=Object(ia.a)(yj.a,cc.ControlList[fd]);if(!Td||Td.ExternalId)y&&this.Mnl(Td,
y),aa.push.apply(aa,this.dGl(Td,ta,Mc,xb,b,k,R))}r.UpdateDynamically&&Ya.push(appChrome.api.menuSection(Mc,jc,cc.Lang))}r.UpdateDynamically&&aa.push(appChrome.actions.updateMenu(b,Ya,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor));0<ta.length&&aa.splice(0,0,appChrome.actions.addControls(ta));0<xb.length&&ni.d("setStatefulSplitButtonMruBypassControls")&&aa.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,xb));return aa}Mnl(b,k){switch(b.ControlType){case 1:case 3:k[b.ExternalId]=
1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:k[b.ExternalId]="ToggleButtonModel";break;case 6:k[b.ExternalId]="CheckboxModel";break;case 7:k[b.ExternalId]="ColorPickerModel";b=Object(ia.a)(FA.a,b);b.McuLayout&&(k[b.McuExternalId]="ColorPickerModel");break;case 9:k[b.ExternalId]="FlyoutAnchorModel"}}dGl(b,k,r,y,R,aa,ta=null){const Ya=[];switch(b.ControlType){case 1:case 3:y=Object(ia.a)(Wg.a,b);this.a8m(y,Ya,k,r);y.MenuItemsStatefulData&&ni.d("setStatefulSplitButtonMenuItemsStatefulData")&&
Ya.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(R,y.MenuItemsStatefulData));break;case 2:this.G8m(Object(ia.a)(kL.a,b),Ya,k,r);break;case 6:this.b8m(Object(ia.a)(Nv.a,b),Ya,k,r);break;case 4:this.z8m(Object(ia.a)(Bk,b),Ya,k,r);break;case 7:this.d8m(Object(ia.a)(FA.a,b),Ya,k,r);break;case 9:R=Object(ia.a)(Oi.a,b);this.l8m(R,Ya,k,r);"StatefulSplitButtonModel"===aa&&y.push(R.ExternalId);break;case 8:this.gtb.p8m(Object(ia.a)($r.a,b),Ya,k,r,ta)}return Ya}a8m(b,k,r,y){y.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&k.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&k.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.Grd()&&((r=this.VLa(b))&&0<r.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qz.a(r)).iconSet)),b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(b.Description||Object(Jb.a)(ow,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new TG,{iconSet:(new qz.a(this.VLa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new oE,{iconSet:(new qz.a(this.VLa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,
customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus}))),this.rm.addCommandToMaps(Object.assign(new WB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&ni.d("setControlLanguage")&&k.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}b8m(b,k,r,y){y.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Grd()&&((r=this.VLa(b))&&0<r.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qz.a(r)).iconSet)),b.IsChecked&&k.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new pE,{iconSet:(new qz.a(this.VLa(b))).iconSet,
keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.rm.addCommandToMaps(Object.assign(new WB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}G8m(b,k,r,y){y.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Grd()&&((r=this.VLa(b))&&
0<r.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qz.a(r)).iconSet)),n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&k.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new pE,{iconSet:(new qz.a(this.VLa(b))).iconSet,
iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new pE,{iconSet:(new qz.a(this.VLa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.rm.addCommandToMaps(Object.assign(new WB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}z8m(b,
k,r,y){y.push(b.ExternalId);y=this.LFl(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&k.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,y,b.LabelText)):ni.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,y,b.LabelText,Object.assign(new VG,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}l8m(b,k,r,y){y.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&
k.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Grd()&&((r=this.VLa(b))&&0<r.length&&k.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qz.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&k.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&k.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{y=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;
const R=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new UG,{iconSet:(new qz.a(this.VLa(b))).iconSet,keytip:b.KeyTip,hideIcon:y,toggled:R,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.rm.addCommandToMaps(Object.assign(new WB.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new hL.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&k.push.apply(k,this.a2h(b.ExternalId,
"FlyoutAnchorModel",b.Menu,null));b.Lang&&k.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}d8m(b,k,r,y){b.McuLayout&&y.push(b.McuExternalId);y.push(b.ExternalId);y=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(y=this.rTj.W_h(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.rm.addCommandToMaps(Object.assign(new WB.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,
commandRevertId:b.CommandRevertId})),y=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.rm.addCommandToMaps(Object.assign(new WB.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const R=[];for(let aa=0;aa<b.Colors.length;aa++){const ta=b.Colors[aa];aa<y?r.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt)):R.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt))}0<r.length&&k.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,
r));k.push(appChrome.actions.populateColorPickerCells(b.ExternalId,R));b.SelectedColorId&&(0<r.length&&k.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),k.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}VLa(b){return b.Image32by32Class?this.rm.KRh(b.Image32by32Class):b.Image16by16Class?this.rm.KRh(b.Image16by16Class):b.ExternalImageId}LFl(b){return b?Object.assign(new jL.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,
isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new iL.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Lxl(b){let k=2;b&&"inputMethod"in b&&b.inputMethod&&(k=b.inputMethod);return k}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}Grd(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static eGl(b,k){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,y)=>{Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(R=>
{R.isFeatureEnabled(SG.a.dFb,!1).then(aa=>{let ta=k.fonts;aa||R.isFreemiumUpsellEnabled()||(ta=Th.a.Hag(ta,Ya=>Ya.fontType!==SG.a.ZMf));aa=Object.assign(new RG,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:aa,mruList:k.mruList,initialPinnedFontKeys:k.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});r(aa)}).catch(y)})}))}static cGl(b,k){const r=[];for(let y=0;y<k.MenuItems.MenuSectionList.length;y++){const R=k.MenuItems.MenuSectionList[y];R.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+
y.toString(),R.Title));for(let aa=0;aa<R.ControlList.length;aa++){const ta=Object(ia.a)(QG.a,R.ControlList[aa]);ta&&r.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}y<k.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+y.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(m.a)(qE,"ReactPopulateQueryCommandPoller",null,[]);class XG{constructor(b,k,r,
y,R){this.rm=r;this.Tqa=b;this.zz=k;this.EUb=y;this.gtb=R}KHl(b,k,r){const y=[];if(this.icm(k))b=this.GLl(b,k,r),void 0!==b&&null!==b&&y.push.apply(y,b);else if(b){var R=this.JHd(b,r);xj.a.visible in r&&y.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[xj.a.visible]));y.push(XB(b.externalUxCommand,1>(R&1)));void 0!==r[xj.a.labelText]&&null!==r[xj.a.labelText]&&y.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[xj.a.labelText]));void 0!==k&&null!==k&&(R=OG(b.externalUxCommand,
k,r,R),void 0!==R&&null!==R&&y.push.apply(y,R),"PeopleWell"===k&&this.x5j(b.externalUxCommand,r,y))}return y}Csl(b,k,r){const y=[];switch(k){case "FlyoutAnchorModel":var R=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var aa=appChrome.selectors.getSplitButtonState(b);if(aa=this.rm.getCommandByExternalUxId(aa.command))r=this.Tqa.eVc(this.zz,aa.commandId,r),y.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),y.push(XB(b,!1));return y;default:return null}k=
!1;for(aa in R)if(R=this.rm.getCommandByExternalUxId(aa),xf.c(R))k=!0;else if(r.SourceControlId=R.externalUxCommand,this.Tqa.eVc(this.zz,R.commandId,r))return y.push(XB(b,!1)),y;y.push(XB(b,!k));return y}GLl(b,k,r){switch(k){case "PreviewGalleryModel":return this.gtb.zGl(b,r);case "GalleryModel":return this.gtb.hvl(r)}return null}icm(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}JHd(b,k){k.MenuItemId=b.menuItemId;return this.Tqa.Jna(this.zz,this.EUb,b.commandId,b.queryCommandId,k)}x5j(b,
k,r){const y=k[Ki.a.LabelTextUserGeneratedPlaceholderReplacements];k=k[Ki.a.LabelText];y&&0<y.length&&(k=String.format.apply(null,[k].concat(y)));r.push(this.MPl(b,k))}MPl(b,k){return appChrome.actions.updatePeopleWell(this.znl(b),k)}znl(b){const k=[];var r={};b=this.rm.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Tqa.Jna(this.zz,this.EUb,"1285265560",b,r);r=r.MenuItems;if(!r)return k;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const y=r.ControlList[b],R=
{};R.name=y.Alt;R.id=y.MenuItemId;R.description=y.Description;R.color=y.ImageBackColor;R.joinTime=y.JoinTimeInMS;R.imageUrl=y.ImageUrl;R.activeStatus=y.ActiveStatus;R.isAnonymous=y.IsAnonymous;R.canJump=y.CanJump;R.upn=y.Upn;k.push(R)}return k}}Object(m.a)(XG,"ReactQueryCommandPoller",null,[]);var lL=c(1102);class YG{constructor(b,k,r){this.rm=b;this.zz=k;b=new lL.a;this.LXj=new qF;this.gtb=new PG(b,this.zz,r,this.rm);this.vYg=new qE(b,this.zz,r,this.rm,this.gtb);this.mYg=new XG(b,this.zz,this.rm,
r,this.gtb)}DBa(){const b=[];if(!ni.c())return b;b.push.apply(b,this.KPl());var k=this.Frl();if(0<k.length)b.push.apply(b,k);else if(k=appChrome.selectors.getActiveControlIds(),Object.keys(k).length){const r=this.Grl();for(const y of r)b.push(appChrome.actions.updateControlEnabledDisabledState(y,!0)),delete k[y];b.push.apply(b,this.ZId(k))}return b}fVc(b,k){ni.c()&&(b=this.ZId(b,k),appChrome.api.dispatch(b))}tMf(b,k,r=null){if(!xf.c(b)&&b.populationProps&&!this.vYg.H7i(b)){b=this.vYg.LHl(b,k,r);if(!b.Pmj){let y;
(y=b.actions).push.apply(y,this.ZId(b.bqh,ni.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}ZId(b,k=0){const r=[],y={};if(ni.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var R of appChrome.selectors.getActiveGroupIds())for(var aa of appChrome.selectors.getVisibleControlsInGroup(R))y[aa]=!0;for(let ta in b)R=ta,aa=b[ta],0===k&&y[R]&&(k=2),
r.push.apply(r,this.JPl(R,aa,k));return r}JPl(b,k,r=0){const y=[],R=this.rm.getCommandByExternalUxId(b);let aa={};appChrome.selectors.isControlDefined(b)&&(aa=this.LXj.W_h(b,k));aa[pz.a.zMb]=r;xf.c(R)?(aa.ExternalUxId=b,(b=this.mYg.Csl(b,k,aa))&&0<b.length&&y.push.apply(y,b)):(aa.MenuItemId=R.menuItemId,aa.SourceControlId=b);y.push.apply(y,this.mYg.KHl(R,k,aa));return y}KPl(){const b=[],k=!!n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1)),r=appChrome.selectors.getContextualTabIds();let y=[];k&&(y=appChrome.selectors.getActiveContextualTabIds());for(let aa=0;aa<r.length;aa++){var R=this.rm.Hif(r[aa]);if(R){R=this.zz.LCa(R);let ta=!0;k&&(ta=0<=Array.indexOf(y,r[aa]));k&&ta===R||b.push(appChrome.actions.activateDeactivateContextualTab(r[aa],R))}}return b}Frl(){var b=appChrome.selectors.getSelectedTabId();const k=[],r=this.rm.Hif(b);r&&(this.zz.LCa(r)||k.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return k}Grl(){var b=
appChrome.selectors.getActiveGroupIds();const k=[];for(const r of b)if(b=this.rm.zvl(r))for(const y of b)this.zz.LCa(y.commandId)||((b=y.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(y.externalUxGroupId)),k.push.apply(k,b));return k}}Object(m.a)(YG,"ReactRibbonRootPoller",null,[949]);class rE{constructor(b,k,r=null){this.zz=this.mya=this.D9a=null;this.jUb=k;b.FJa(this);this.vE=r}get Sma(){this.mya||(this.mya=new Date,this.mya.setTime(0));return this.mya}set Sma(b){this.mya=
b}get D7(){return 2}get vE(){return this.zz}set vE(b){this.zz=b}get dcc(){this.D9a||(this.D9a=new YG(this.jUb,this.vE,this.D7));return this.D9a}mbb(){const b=document.activeElement;Fd.a.isEditable(b)&&b.blur()}executeCommand(b,k,r,y,R,aa,ta,Ya=2){xf.c(this.vE)||(R=new If.a,R.CommandLocation=Ya,R.InvocationMethod=y,R.CommandTabName=r,k[pz.a.zMb]=Ya,this.vE.gLa(b,k,R,aa,ta),this.wym(b,k))}DBa(){return xf.c(this.vE)?[]:this.dcc.DBa()}xl(){const b=this.DBa();0<b.length&&(this.Sma=new Date,appChrome.api.dispatch(b))}P3c(){ni.c()&&
this.dcc.fVc({PeopleWell:"PeopleWell"},18)}E3c(){}wym(b,k){try{const r=Va.a.instance.Pa("Common.ISystemInitiatedFeedback");if(r&&k){const y=k.SourceControlId||k.launcherId||k.LegacyId||k.NewContextId;let R=(y?"_"+y:"")+(k.SqmControlId?"_"+k.SqmControlId:"");R=R.length?R:"_"+b;r.Jxf("Ribbon"+R)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}Object(m.a)(rE,"ReactRibbonRoot",null,[519,948]);var sE=c(1559);class ZG{constructor(b){this.JMe=this.Mre=!1;
this.q6a=null;this.ryg=!1;this.GO=null;this.tqa=!1;this.sEe=b;pf.a.instance.mb(Kb.a.ex,this.SHc(),Object(u.a)(this,this.kTm,"onContextualUIMouseDown"));(b=Va.a.instance.$a("Common.IActionContextProvider"))&&b.execute(k=>{this.GO=k});n.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&n.AFrameworkApplication.ta.Rb.KI?kj.a.get_instance().Gl(16,()=>{this.qua?this.initializeContextualUI(this.SHc()):kj.a.get_instance().Gl(7,()=>{this.initializeContextualUI(this.SHc())})}):
kj.a.get_instance().Gl(7,()=>{this.initializeContextualUI(this.SHc())})}get QZ(){return this.tqa}get qua(){return n.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&n.AFrameworkApplication.ta.Rb.KI?kj.a.get_instance().isCompleted(16)&&kj.a.get_instance().isCompleted(7):kj.a.get_instance().isCompleted(7)}Esk(){if(this.ryg)return!0;try{return Promise.resolve(null),this.ryg=!0}catch(b){return!1}}d8f(b){if(!this.qua||this.JMe)return this.zyf("Unable to launch contextual ui because ribbon hasn't loaded yet"),
!0;if(!this.Esk())return this.zyf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(n.AFrameworkApplication.qF)return this.zyf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.JMe=!0;let k=ib.a.Cg;switch(b){case 1:k=ib.a.showContextMenu;break;case 0:k=ib.a.showFloatie;break;case 2:k=ib.a.Xec}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.JMe=!1;Ib.c(k)},0)});return!1}s2h(b){return Sk.UISurfaces.vYa().then(k=>
{if(appChrome.api.isSmallDevice()&&k.getBlockedSmallScreenFloatieGroupList){k=k.getBlockedSmallScreenFloatieGroupList();const r=[];for(const y of b)Array.contains(k,y)||r.push(y);return r}return b})}showFloatie(b,k,r,y=null){this.d8f(0)||this.s2h(k).then(R=>{if(0>=R.length)return null;this.t_f(R).then(()=>{const aa={};aa.target=b;Sk.UISurfaces.vYa().then(ta=>{appChrome.api.dispatch(ta.showFloatie(aa,r,void 0,this.Zff(),y));this.tqa=!0;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",
!1)&&n.AFrameworkApplication.ya&&n.AFrameworkApplication.ya.processAction(ib.a.Cni,2);return null})});return null})}showContextMenu(b,k,r=null,y=null){this.d8f(1)||this.P5i(b,k,r,y)}P5i(b,k,r=null,y=null){this.t_f(null).then(()=>{const R={};R.target=b;y&&(R.directionalHint=y);Sk.UISurfaces.vYa().then(aa=>{appChrome.api.dispatch(aa.showContextMenu(R,k,r,void 0,this.Zff()));return null})})}Wec(b,k,r,y=null){this.d8f(2)||this.s2h(k).then(R=>{0>=R.length?this.P5i(b,r,y):this.t_f(R).then(()=>{const aa=
{};aa.target=b;const ta={};ta.target=b;Sk.UISurfaces.vYa().then(Ya=>{appChrome.api.dispatch(Ya.showContextualUI(aa,ta,r,void 0,y,this.Zff()));this.tqa=!0;return null})});return null})}zyf(b){v.ULS.sendTraceTag(561394519,340,15,b)}V4e(){this.qua&&Sk.UISurfaces.isLoaded()&&Sk.UISurfaces.vYa().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}tw(){this.qua&&Sk.UISurfaces.isLoaded()&&Sk.UISurfaces.vYa().then(b=>{this.tqa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}oEc(){this.qua&&
Sk.UISurfaces.isLoaded()&&Sk.UISurfaces.vYa().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.tqa=!1;return null})}initializeContextualUI(b){return Sk.UISurfaces.vYa().then(k=>{this.Mre||(k.initializeContextualUI(b),this.Mre=!0);return null})}t_f(b){if(!this.Mre)return this.initializeContextualUI(this.SHc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var k=[];k.push(appChrome.actions.setActiveFloatieGroups(b));
appChrome.api.dispatch(k);var r=[];Sk.UISurfaces.vYa().then(y=>{r.push.apply(r,this.sEe.dcc.ZId(y.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}SHc(){if(this.q6a)return this.q6a;this.q6a=sE.a("div");this.q6a.id="ReactContextualUIDiv";this.q6a.style.position="absolute";this.q6a.style.zIndex="1001";document.body.insertBefore(this.q6a,document.body.firstChild);return this.q6a}kTm(b){b.Ib&&b.Ib.target&&"input"===b.Ib.target.tagName.toLowerCase()&&Id.FocusManager.instance().iC("ribbon");
return!1}Zff(){return this.GO?this.GO.contentType:"Unknown"}}Object(m.a)(ZG,"ReactContextualUILauncher",null,[950]);class $G extends px.a{constructor(){super()}}Object(m.a)($G,"FloatieBuildOptions",px.a,[]);class aH extends Xy.a{constructor(){super()}}Object(m.a)(aH,"FloatieBuildContext",Xy.a,[]);var mL=c(658);class bH extends ma.Builder{constructor(b,k,r){super(b,k,r,null);if(xf.c(k))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}QSn(b){this.root=
b}Zmk(){const b=new aH,k=new LA.a;k.JWc=1;k.handler=Object(u.a)(this,this.RYm,"onReturnFloatieData");k.data=b;this.Bsa.A5d(k)}RYm(b){this.$mk(b.cWc,b.nCc);this.floatie.lKh=this;this.floatie.im();this.floatie.Lc.style.display="none";this.placeholder.appendChild(this.floatie.Lc);this.Xra.continueWith(()=>{this.Xra.result.IGb(this.floatie)},11);fj.a.instance.mb(Kb.a.pointerDown,this.floatie.Lc,Object(u.a)(this.floatie,this.floatie.$B,"onPointerDown"))}$mk(b,k){b=nj.a.Oea(b,nj.a.Jqj);if(xf.c(b))throw Error.create("No floatie element was present in the data");
b=new nj.a(b);this.QSn(new Eh(b.attributes[nj.a.id],b.attributes));b=nj.a.Oea(b.node,nj.a.vfe);this.LUe(b,k)}LUe(b,k){b=nj.a.Mv(b);for(let r=0;r<b.length;r++){if(this.bNa(b[r]))continue;const y=this.TUe(b[r],k);this.floatie.Rf(y)}}TUe(b,k){var r=new nj.a(b);b=new mL.Group(this.floatie,r.attributes[nj.a.id],r.attributes[nj.a.mRa],r.attributes[nj.a.Iic],r.attributes[nj.a.gRa],!1,r.name===nj.a.euj,!1,r.attributes);r=nj.a.Mv(r.node);for(let y=0;y<r.length;y++)b.Rf(this.std(r[y],k));return b}std(b,k){b=
new nj.a(b);var r=b.attributes[nj.a.id];b=nj.a.Mv(b.node);var y=2;2===b.length&&(y=3);r=new ke.a(this.floatie,r,y,2,1);for(y=0;y<b.length;y++){const aa=new nj.a(b[y]);var R=nj.a.Oea(aa.node,nj.a.inb);R=nj.a.Mv(R);this.XUe(r.cId(y+1),R,aa.attributes[nj.a.id],k)}return r}XUe(b,k,r,y){for(r=0;r<k.length;r++){if(this.bNa(k[r]))continue;const R=new nj.a(k[r]),aa=this.Lda(k[r],y);aa&&b.Rf(aa.JP(R.attributes[nj.a.Jic]))}}}Object(m.a)(bH,"FloatieBuilder",ma.Builder,[]);class MD{constructor(b,k){this.Uu=null;
this.LBk=b;this.jme=k}get floatie(){return this.Uu}pbb(b,k,r){k=new en.CuiHelper(Qk.a.Kab,Box4Intl.Box4Strings,null,null,k);const y=new $G;y.kG=r||{};y.kG.floatieshadingColor=!1;const R=new bH(y,document.body,this.LBk.SUi);R.Bsa=new Yy.a(b,k);R.Zmk();this.jme.execute(aa=>{R.floatie.vE=aa});R.floatie.Mon(Object(u.a)(this,this.CXd,"onFloatieDismissed"));R.floatie.Znn(Object(u.a)(this,this.hwl,"getHiddenFloatieGroups"));this.Uu=R.floatie;return this.floatie}hwl(){return[]}}Object(m.a)(MD,"AFloatieInitializer",
null,[]);class cH extends MD{constructor(b,k,r,y){super(k,r);this.mMf=()=>{this.floatie.xl()};this.Dh=b;this.MH=y}pbb(b,k,r){if(b=super.pbb(b,k,r))b.tbc=!0,b.K0d=!0,b.preventDismissOnScroll=!0;this.Dh.GVa(this.mMf);return b}nMc(b,k,r=null){this.MH.Ogh(()=>this.pbb(b,k,r))}CXd(){this.floatie.tbc=!0}}Object(m.a)(cH,"PasteFloatieInitializer",MD,[]);var rF=c(795);class Bx{kwa(b,k){this.ctk&&this.dZn(b,k,Bx.nAf,Bx.kb)}dZn(b,k,r,y){switch(r){case 1:case 6:case 2:case 3:case 4:Bx.s6e.show(y,b,k)}}asi(){switch(Bx.nAf){case 5:case 1:return!0;
default:return!1}}nRk(){return Bx.nAf}get ctk(){return 1!==Ka.App.xa.state}static get s6e(){return null!=Bx.ojg?Bx.ojg:Bx.ojg=Va.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static IAl(b){if(!b)return 0;if(2===Ka.App.xa.mode){const k=b.Qa.node,r=Wd.GraphIterator.Za(k);r.ro();return ui.e(r.currentNode)?2:n.AFrameworkApplication.Whc||!cj.isEmbeddedFileNode(k)||cj.isInvalid(k)?Me.a.sgm(b.Qa)||Me.a.grf(b.Qa)?6:1:3}return 4}static get kb(){return bh.a.instance.ib.kb}static get nAf(){return Bx.IAl(Bx.kb)}}
Object(m.a)(Bx,"SelectionContextMenuProvider",null,[1194]);var tE=c(1754);class uE{constructor(b,k){this.K0d=this.tbc=!1;this.XKc=!0;this.UK=b;this.rm=k}get isVisible(){return this.UK.QZ}get controls(){return null}tw(){this.UK.tw();return!0}z7e(){}t3a(b,k,r,y,R=null){this.UK.showFloatie(Object.assign(new tE.a,{x:b.x,y:b.y}),this.tbf(r),r,R)}FAb(){return new Sys.UI.Bounds(0,0,0,0)}g2(){return this.tw()}tbf(){return[]}}Object(m.a)(uE,"ReactFloatie",null,[278,279]);class dH{constructor(b){this.k9c=null;
this.UK=b}dispose(){}g2(){this.UK.oEc();return!0}showContextMenu(b,k){this.YKb(b,k.clientPoint,k.ig)}YKb(b,k,r){this.q3a(b,new Sys.UI.Bounds(k.x,k.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}q3a(b,k,r,y=null){this.k9c?this.UK.Wec(Object.assign(new tE.a,{x:k.x,y:k.y}),this.k9c.tbf(r),r,b):this.UK.showContextMenu(Object.assign(new tE.a,{x:k.x,y:k.y}),r,b,y);this.k9c=null}Xec(b,k,r,y){this.k9c=Object(ia.a)(uE,r);y.kwa(b,k);return!0}n_b(){}}Object(m.a)(dH,
"ReactContextMenuController",null,[698,10]);var nL=c(355);class eH{constructor(){this.Qga=this.text=this.lma=null}}Object(m.a)(eH,"BusinessBarButtonData",null,[]);class sF{constructor(){this.text=this.lma=null}}Object(m.a)(sF,"BusinessBarLinkData",null,[]);var fH=c(181);class tF{constructor(b,k,r,y){this.uFg=this.kTb=this.PCg=this.S6a=this.PAg=null;this.ns=b;this.spa=k;this.ga=r;this.Oa=y}RLf(){this.MAc();this.zud();this.NAc();this.Iwk()}zud(){}MAc(){const b=Ka.App.xa.jb.Xc;b&&(this.PAg=this.F4a(this.PAg,
1,2===Ka.App.xa.mode&&b.iqf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get Eom(){return Ka.App.Zgj?X.a.Ak:!1}tpm(){return n.AFrameworkApplication.ta&&1===n.AFrameworkApplication.ta.mode}Iwk(){this.Eom&&!this.kTb&&(this.kTb=this.spa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.kTb.id=15,this.kTb.closeable=!0,this.kTb.addButton(Box4Intl.Box4Strings.L_DownloadNow,Rh.AppFrame.Hio,""),Ib.a("NewBrowserSuggestionShown"),this.ns.qA(this.kTb,!1))}NAc(){let b=null;const k=
Ka.App.xa.jb.activeSection;if(k){const r=k.mUc;fH.a.ZNd(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=X.a.mi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=X.a.mi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):fH.a.T5h(k.tVa)||Ka.App.Fm||
this.tpm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.uFg=this.F4a(this.uFg,5,!!b,b)}c6i(b,k,r,y){b=this.spa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.Nqd(k,()=>{Qe.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});y&&(b.mka=y);this.ns.qA(b,!0)}QZn(b,k,r){this.c6i(b,k,r,null)}a_n(b){b=this.spa.create(null,b,null);b.closeable=!0;b.id=20;this.ns.qA(b)}nZn(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,k=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.S6a||(this.S6a=this.spa.create(b,k,null),this.S6a.closeable=!0,this.S6a.id=27,this.ns.qA(this.S6a))}LZl(){this.S6a&&(this.S6a=this.F4a(this.S6a,27,!1,""))}U0f(b){this.PCg=this.F4a(this.PCg,30,!0,b)}F4a(b,k,r,y,R=!1,aa="",ta=null,Ya=null,xb=null){r?b?b.message=y:(b=this.spa.create(aa,y,null),b.id=k,b.closeable=R,ta&&b.addButton(ta.text,ta.lma,ta.Qga),Ya&&b.Nqd(Ya.text,Ya.lma),xb&&(b.mka=xb),this.ns.qA(b,!1)):b&&(this.ns.removeEntry(b),b=null);return b}fOe(b){this.ns.qA(b,void 0)}}Object(m.a)(tF,
"BusinessBarController",null,[173]);class YB extends tF{constructor(b,k,r,y){super(b,k,r,y);this.kya=null}zUh(b,k,r=null,y=null,R=null,aa=2){this.kya||(this.kya=this.spa.create(k,r||"",null),this.kya.id=6,this.kya.image=aa,this.kya.RPd=!1,b&&(this.kya.errorCode=b),this.kya.closeable=!1,k=n.AFrameworkApplication.xE&&this.Oa.$("ShowFeedbackButtonOnKickoutBusinessBar"),y?(this.kya.addButton(y,R,""),k&&this.kya.s$g(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.c3h(b)})):k&&this.kya.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.c3h(b)},""),this.ns.qA(this.kya,void 0,null,null,null))}c3h(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Xb(ib.a.giveFeedback,2,{["ErrorCode"]:b})}static get Ue(){return De.PageReader.instance}}Object(m.a)(YB,"BusinessBarController",tF,[172,173]);class uF{static get pwi(){const b=A.a.Jj(yh.a.qg(n.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(uF,
"OdtUtils",null,[]);class gH extends YB{constructor(b,k,r,y){super(b,k,r,y);this.iob=this.uoc=this.iRg=this.xJa=this.oRg=this.a2g=null;this.PMj="https://go.microsoft.com/fwlink/?linkid=2134357"}RLf(){super.RLf();this.kwk()}zud(){const b=Ka.App.xa.jb.Xc;if(b){var k=Ka.App.TZ;if(Ka.App.zs||Ka.App.Fm||k&&n.AFrameworkApplication.Ju)this.a2g=this.F4a(this.a2g,4,YB.Ue.qPc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.oRg=this.F4a(this.oRg,3,YB.Ue.l7b(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,
!0),this.iRg=this.F4a(this.iRg,8,YB.Ue.zFk(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),YB.Ue.aQc(b)?this.xJa||(this.xJa=this.spa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.xJa.id=14,this.xJa.closeable=!0,this.xJa.image=3,this.xJa.addButton(Box4Intl.Box4Strings.L_LearnMore,Rh.AppFrame.ctm,""),this.ns.qA(this.xJa,!1)):this.xJa&&(this.ns.removeEntry(this.xJa),this.xJa=null)}}kwk(){if(jl.App.DOc){const b=
uF.pwi,k=this.spa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);k.id=9;k.closeable=!0;k.I4j(b);this.ns.qA(k,!0)}}RZn(b,k){if(Ka.App.xa.jb.Xc){const r=new eH;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.lma=()=>{b()};const y=new sF;y.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;y.lma=()=>{Qe.a.openWindow(4,n.AFrameworkApplication.rjb)};this.uoc=this.F4a(this.uoc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,
!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,y,()=>{k()})}}TZl(){this.uoc&&(this.uoc=this.F4a(this.uoc,25,!1,""))}XYn(){if(Ka.App.xa.jb.Xc){const b=new sF;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.lma=()=>{Qe.a.openWindow(4,this.PMj)};this.iob||(this.iob=this.spa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.iob.id=32,this.iob.closeable=!0,this.iob.image=3,this.iob.Nqd(b.text,
b.lma),this.ns.qA(this.iob,!1))}}jaa(b){return this.ns.jaa(b)}qA(b,k){this.ns.qA(b,k)}}Object(m.a)(gH,"BusinessBarController",YB,[266,172,173]);class hH{constructor(){this.menuTargetType=null}}Object(m.a)(hH,"MenuTargetDescriptor",null,[]);class Xs{static get Y1(){return null!=Xs.Fig?Xs.Fig:Xs.Fig=Va.a.instance.resolve("Box4.IContextMenuController")}static nKk(b){Xs.Y1.n_b(b,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(b,k){Xs.Y1.showContextMenu(b,k)}static YKb(b,k,r){Xs.Y1.YKb(b,
k,r)}static q3a(b,k,r,y=null){Xs.Y1.q3a(b,k,r,y)}static nMh(b,k,r,y){return Rf.a(b,k.toString(),y,r)}}Object(m.a)(Xs,"BaseContextMenu",null,[]);class wk extends Xs{constructor(b,k,r,y=!1,R,aa=null,ta){super();this.Xcn=k;this.Zm=r;this.ak=aa;this.pve=y;this.Vb(b);this.M5a=ta;wk.FUa[1]=Wa.a.U9d;wk.FUa[2]=Wa.a.qJd;wk.FUa[3]=Wa.a.B$d}get C1k(){return Oh.a.Eyd}get B1k(){return Oh.a.cxd}get D1k(){return Oh.a.L_d}get q6e(){return Oh.a.dFi}Vb(b){b.gb(Wa.a.wMf,lc.a.application,Object(u.a)(this,this.m0d,"populateContextMenu"),
96);b.gb(Wa.a.CGi,lc.a.application,Object(u.a)(this,this.m0d,"populateContextMenu"),96)}show(b,k,r){let y=null,R=new Sys.UI.Bounds(0,0,0,0);const aa=this.aHl(b);if(aa&&(b=b.Qa.node)&&(b=b.Be(Bb.InteractiveViewManager.instance.yd.Sb))){R=Rs.a.tq(b,aa.end);if(n.AFrameworkApplication.isRtl&&R.x>k.x||!n.AFrameworkApplication.isRtl&&R.x+R.width<k.x||R.y+R.height<k.y)R=Rs.a.tq(b,aa.end-1);k.x=R.x+(n.AFrameworkApplication.isRtl?0:R.width);k.y=R.y+R.height;y=6}Xs.q3a("ContextMenu",new Sys.UI.Bounds(k.x,k.y,
R.width,R.height),r,y)}m0d(b,k,r,y,R){if(1===r)return 32;b=R.$w;R=R.Ed;k=Object.assign(new Ci.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.UMk(k,b,R.IsShadowMenuOpen);R.MenuItems=k;return 32}DZ(b,k){return this.O0c(b)||wk.LAc(Wa.a.mergeCells)||wk.LAc(Wa.a.OEa)||this.F1f(b)||this.K5i(b,k)||wk.u6i()||wk.i6i(b).returnValue}O0c(b){return 2===Ka.App.xa.mode&&this.vOc(b)}eDc(b,k,r=null){if(fa.KA()&&2===Ka.App.xa.mode){k=this.M5a.Vsh(b.Qa);if(!k||!this.Blm()&&!this.Smm(k.errorDetails))return;
k=k.errorDetails}else{if(!this.O0c(b))return;k=this.FYh(b)}var y=yh.a.qg(k.lcid);const R=y?y.name:"UNKNOWN";y=Object(Jb.a)(pi.a,k)?k.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",k.errorType,k.proofingType,y,R);if(b=this.Xcn.A_b(b,k))r.push.apply(r,b),this.LDm(k,y)}Smm(b){return b&&(1===b.proofingType||2===b.proofingType)}Blm(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}LDm(b,k){const r=wk.FUa[b.proofingType];r&&(n.AFrameworkApplication.ya.processAction(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,k,b.proofingType,fa.KA()))}FYh(b){return this.Zm.Ala(b.Qa).errorDetails}vOc(b){return this.Zm.c6d(b)}S2b(){return null}Cxd(){}aHl(b){return this.vOc(b)?this.Zm.Ala(b.Qa):(b=this.S2b(b))?new Xb.a(b.Cs,b.cpEnd):null}F1f(b){if(2!==Ka.App.xa.mode||!b)return!1;b=Vy.a.qAa(b.toArray());
return!!wk.Sg.AS(b,14)}U6i(b,k){return 2===k||3===k&&!this.vOc(b)}K5i(b,k){return 3!==k||this.vOc(b)}RJk(){const b=[];b.push(Object.assign(new Wg.a,{ExternalId:this.C1k}));b.push(Object.assign(new Wg.a,{ExternalId:this.B1k}));b.push(Object.assign(new Wg.a,{ExternalId:this.D1k}));return b}XNk(){const b=[];this.pve&&b.push(Object.assign(new Wg.a,{ExternalId:this.q6e}));return b}static get hd(){return null!=wk.Wog?wk.Wog:wk.Wog=Va.a.instance.resolve("Box4.List.IListReader")}static get Sg(){return tm.ContextSetEditor.instance}static get rgm(){null==
wk.Iue&&(wk.Iue=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return wk.Iue}static get uSc(){null==wk.qnb&&(wk.qnb=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return wk.qnb}static get D1(){null==wk.KU&&(wk.KU=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return wk.KU}static LAc(b){return 32===n.AFrameworkApplication.ya.processAction(b,1)}static u6i(){return 2===
Ka.App.xa.mode&&!!Ka.App.Ev.eI&&Ka.App.Ev.eI.fPc(Wa.a.tZd.toString())}static w6i(b){if(1!==b.length||!b.Qa.Xk)return!1;b=Wd.GraphIterator.Za(b.Qa.node);b.Ab(11);b.mc();return b.fq(4)&&!wk.hd.Gs(b).listType?!0:!1}static i6i(b){let k=!1,r=!1;if(!b)return{returnValue:!1,Veb:k,BLc:r};if(wk.uSc)return wk.$Zn(b,r);if(!(b.MC||wk.rgm&&2===b.length&&b.Tc.contextId===lc.a.endOfParagraph))return{returnValue:!1,Veb:k,BLc:r};b=b.Qa.clone();k=32===n.AFrameworkApplication.ya.Vf(b,Wa.a.u1a,1,!0,null,null);r=32===
n.AFrameworkApplication.ya.Vf(b,Wa.a.insertHyperlink,1,!0,null,null);return{returnValue:k||r,Veb:k,BLc:r}}static $Zn(b,k){let r;k=b.Qa.clone();r=wk.D1&&Qm.l(k);let y=!r&&32===n.AFrameworkApplication.ya.Vf(k,Wa.a.u1a,1,!0,null,null);if(b.MC||2===b.length&&b.Tc.contextId===lc.a.endOfParagraph)k=!r&&32===n.AFrameworkApplication.ya.Vf(k,Wa.a.insertHyperlink,1,!0,null,null);else{k=!0;const R=b.length;for(let aa=0;aa<R;aa++){const ta=b.J(aa).clone();if(ta.contextId===lc.a.paragraph||ta.contextId===lc.a.Hd)(r=
wk.D1&&Qm.l(ta))||(k=32===n.AFrameworkApplication.ya.Vf(ta,Wa.a.insertHyperlink,1,!0,null,null)&&k);else if(ta.contextId!==lc.a.endOfParagraph)return k=y=!1,{returnValue:!1,Veb:y,BLc:k}}}return{returnValue:y||k,Veb:y,BLc:k}}static FVh(b){const k=Object.assign(new oi.a,{ControlList:[]});for(const r of b)k.ControlList.push(Object.assign(new Wg.a,{ExternalId:r}));return k}static aH(b){let k=[];for(const r of b)k.push(Object.assign(new Wg.a,{ExternalId:r}));return k}}wk.Iue=null;wk.qnb=null;wk.KU=null;
wk.FUa=[];Object(m.a)(wk,"AEditSurfaceContextMenu",Xs,[]);var oL=c(596),pL=c(847),qL=c(1684);class vE{static mGl(b,k,r){k=[];r.w$m.A_b(r.rjl(b),k);return k}static zrl(b,k,r){const y=[];if(r.O0c(b))return y;r.K.$("WordEditorIdeasCardsIsEnabled")&&!X.a.Ak||r.l4e.Cxd(b,null,k,y);return y}static qLl(b,k,r){const y=[];r.eDc(b,k,y);return y}}Object(m.a)(vE,"ContextMenuSectionHelper",null,[]);class Xp{static lrl(b,k,r){k=[];r.EWk(b)&&k.push(Object.assign(new Wg.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.vIl(b)}));
return k}static RAl(){return wk.LAc(Wa.a.mergeCells)?wk.aH(["MergeCells"]):wk.LAc(Wa.a.c$d)?wk.aH(["SplitCells"]):[]}static OOl(b,k,r){k=[];if(!r.Ph.Trh(b))return k;b=r.Ph.M1h(b);k.push(Object.assign(new Wg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));k.push(Object.assign(new Wg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return k}static lml(b,k,r){return n.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&r.Kc&&r.Kc.pvi(b.Qa.node)?wk.aH(["ShowCatchUpActivitiesForParagraph"]):[]}static esl(b){return tq.m6i(b)?wk.aH(["EditIllustration"]):[]}static ARl(b,k,r){return r.K.$("WordEditorWrapTextIsEnabled")&&tq.G0n(b)?[Object.assign(new Oi.a,{ExternalId:"WrapTextMenu"})]:[]}static SHd(b,k,r){return r.VWk(b)?wk.aH(["CreatePullQuote"]):[]}static ddf(b,
k,r){return r.DWk()?wk.aH(["RemoveContentControl"]):[]}static Snl(){return wk.aH(["NewComment"])}static Iml(b){let k=[];!tq.E1f(b)&&tq.h1f(b)&&Ae.SessionStatusManager.instance.pK&&b.dO&&k.push(Object.assign(new Oi.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return k}static Rxl(b,k,r){k=[];!tq.E1f(b)&&tq.h1f(b)&&Ae.SessionStatusManager.instance.pK&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.dO&&!n.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
k.push(...wk.aH(["ChangePicture"])):k.push(...r.gMk().ControlList),(b=tq.eUh())&&0<b.length&&(r=r.zPk(b),null!=r&&k.push(...r.ControlList)));return k}static YGl(){return wk.u6i()?wk.aH(["SetProofingLanguage"]):[]}static FIl(b,k,r){return r.Alm&&r.U_n(b)?wk.aH(["Rewrite"]):[]}static xzl(b){return wk.w6i(b)?wk.aH(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static VEl(){return tq.I6i()?wk.aH(["ParagraphOptions"]):[]}static Lwl(b){return tq.m6i(b)?wk.aH(["EditIllustration"]):[]}static jLl(b){return tq.E1f(b)?
wk.aH(["ShowSmartLookupPane"]):[]}static ZOl(b){return tq.z6i(b)?wk.aH(["ModernTranslatorSplitButton"]):[]}static Wvl(b,k,r){k=[];n.AFrameworkApplication.Ne("0j6hg566;iii68384");if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)&&b.MC){const y=b.Qa;if(y.contextId===lc.a.paragraph||y.contextId===lc.a.Wc||y.contextId===lc.a.Hd){b=b.Qa.node;if(!r.Tn.nc(b)||b.Ur||""===b.characterData)return k;r.D0b.gGd(b)&&k.push(...wk.aH(["CreateHeadingLink"]))}}return k}static getBookmark(b,
k,r){k=[];if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.MC){const y=b.Qa;(rf.SelectionEditor.zf(y)||rf.SelectionEditor.n_a(y))&&r.Mkk.gIc(b.Qa.node,b.Qa.cpBegin)&&(k.push(...wk.aH(["DeleteBookmarkContextMenu"])),n.AFrameworkApplication.Ne("bookmarks-edit-ex;bookmarks-edit-ex-cf"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&k.push(...wk.aH(["EditBookmarkNameContextMenu"])))}return k}static I$(b){let k=
!1,r=!1,y=[];({Veb:k,BLc:r}=wk.i6i(b)).returnValue&&(k?r?y.push(...wk.aH(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):y.push(...wk.aH(["OpenHyperlink"])):r&&((n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)||n.AFrameworkApplication.K.$("WordRecentLinksIsEnabled"))&&(n.AFrameworkApplication.K.$("IsO365CommercialHost")||n.AFrameworkApplication.K.$("IsO365ConsumerHost"))?y.push(...wk.aH(["InsertLinkFlyout"])):
y.push(...wk.aH(["InsertLink"]))));return y}static tnl(b,k,r){let y=[];if(!r.K5i(b,k))return y;2===Ka.App.xa.mode?(y.push(...r.RJk()),y.push(...r.XNk()),3===k&&r.vOc(b)&&y.push(Object.assign(new Wg.a,{ExternalId:"Delete"}))):n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)?(!n.AFrameworkApplication.protectFile&&!n.AFrameworkApplication.kM||n.AFrameworkApplication.izb)&&y.push(Object.assign(new Wg.a,{ExternalId:"Copy"})):n.AFrameworkApplication.protectFile||
y.push(Object.assign(new Wg.a,{ExternalId:"Copy"}));return y}static Gbf(b,k,r){return r.F1f(b)&&r.U6i(b,k)?wk.aH(["EditTableAltText"]):[]}static jUh(b,k,r){return r.OWk(b)?wk.aH(["ShowIntentSuggestion"]):[]}static $Ml(b,k,r){const y=[];r.F1f(b)&&!r.U6i(b,k)&&(y.push(Object.assign(new Oi.a,{ExternalId:"InsertTableMenu"})),y.push(Object.assign(new Oi.a,{ExternalId:"DeleteTableMenu"})),y.push(Object.assign(new Oi.a,{ExternalId:"SelectTableMenu"})));return y}static eNl(b,k,r){return tq.Wb.isFeatureEnabled(117)&&
r.l0n(b)?wk.aH(["UpdateTableOfContents"]):[]}static Osl(b){return tq.wZn(b)?wk.aH(["ShowHideEquationToolsPane"]):[]}}Object(m.a)(Xp,"ContextMenuSectionItemHelper",null,[]);class tq extends wk{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne,ye,ff,Gd=!1,oe=null,ze=null,ug,Yf,Aj,cn){super(b,k,r,Gd,void 0,oe,ug);this.qzd=cn;this.wDe=this.GO=null;this.DIg=!1;this.R5d=new Map;this.sD={};this.UFb={};this.ga=b;this.K=y;this.Ph=R;this.vV=Ya;this.PH=xb;this.Ms=Mb;this.Q_j=!!oe;this.l4e=cc;this.w$m=jc;
this.yCg=ne;this.G0=ye;this.Mkk=ff;this.nSa=Aj;this.fb=Yf;Td&&Td.execute(Vl=>{this.V_g=Vl});Mc&&Mc.execute(Vl=>{this.wDe=Vl});this.Kc=ta;this.uy=fd;ze&&ze.execute(Vl=>{this.GO=Vl});this.D3l();this.D8m();this.p9k();this.C8m()}get Tn(){return this.fb}get D0b(){return this.nSa}get q6e(){return this.Q_j?Oh.a.I_d:super.q6e}uXn(){const b=jl.App.En.jb.Fc.Cb.ib.kb;return this.O0c(b)&&2!==this.FYh(b).errorType}DZ(b,k){return super.DZ(b,k)||tq.I6i()||wk.w6i(b)||tq.h1f(b)||tq.z6i(b)}UMk(b,k,r){const y=[];let R=
null;try{R=jl.App.En.jb.Fc.Cb.ib.kb}catch(aa){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.t8m(R,k,y,this.hpl(R));b.MenuSectionList.push(...y);this.vOn(b);!r&&this.V_g&&this.V_g.pbn(b.MenuTargetDescriptor.menuTargetType,y)}hpl(b){return wk.LAc(Wa.a.mergeCells)?Sv.Wfg:b.VOd?Sv.Fcg:b.dO?Sv.Jeg:b.P7b()?Sv.scg:Sv.Ocg}hMk(b){b=tq.tMk(b);return Object.assign(new Wg.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}APk(b){return(b=
tq.Mpj(b))?Object.assign(new Wg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}gMk(){const b=Object.assign(new oi.a,{ControlList:[]}),k=tq.eUh();b.ControlList.push(this.hMk(k));return b}zPk(b){const k=Object.assign(new oi.a,{ControlList:[]});if(b&&0<b.length){b=this.APk(b);if(null==b)return null;k.ControlList.push(b)}return k}o8b(b){return b.dO||2<b.length||!b.length||2===b.length&&!rf.SelectionEditor.qk(b.Tc)||1===b.length&&rf.SelectionEditor.qk(b.Tc)?!1:this.Ruf(b.Qa)}Ruf(b){return ie.ParagraphReader.nc(b.node)?
""!==ie.ParagraphReader.text(b.node).trim():!1}l0n(b){var k=Wd.GraphIterator.Za(b.Qa.node);k=Object(ia.a)(oL.a,k.currentNode);return gh.a.instance.J(5)&&b.dO?!1:!!k&&k.Ur}p9k(){n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.uy.execute(b=>{b.isFeatureEnabled(pL.a.yui,!1).then(k=>{k||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");
this.DIg=k;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get Alm(){n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.DIg:!1}U_n(b){if(!this.o8b(b)||b.C6b||b.P7b())return!1;b=b.Qa;if(ie.ParagraphReader.em(b)||rf.SelectionEditor.zf(b)||rf.SelectionEditor.Dk(b)){b=
this.PH.OYa(b);b||(b=n.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}OWk(b){if(1!==b.length||X.a.Ak)return!1;const k=n.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(k&&this.uXn()||fa.KA()&&this.M5a.Vsh(b.Qa))return!1;const r=tq.Wb.isFeatureEnabled(63);return b.J(0).contextId===lc.a.Wc&&(k||r)&&0<this.Ms.LIc(b.J(0),0).count||k&&this.S2b(b)?!0:!1}EWk(b){return 1===
b.length&&this.yCg.BA(b.Qa.node).vma}vIl(b){var k,r;const y=null===(k=this.qzd)||void 0===k?void 0:k.uT(null===(r=null===b||void 0===b?void 0:b.Qa)||void 0===r?void 0:r.node);return qL.a.H1h(y)}get Ox(){return null!=this.ajg?this.ajg:this.ajg=Va.a.instance.Pa("WordEditor.Designer.IDesignerTaskPane")}VWk(b){if(!this.G0.cdi()||!this.Ox||this.Ox.isVisible||!(1===b.length||2===b.length&&rf.SelectionEditor.qk(b.Tc))||b.Wgb||!rf.SelectionEditor.Dk(b.Qa)&&b.Qa.contextId!==lc.a.paragraph||b.gmm()||this.yCg.BA(b.Qa.node).vma)return!1;
const k=ie.ParagraphReader.text(b.Qa.node),r=b.Qa.contextId===lc.a.paragraph?0:b.Qa.cpBegin,y=b.Qa.contextId===lc.a.paragraph?k.length:b.Qa.cpEnd-r;return 1>y||1500<y||A.a.lf(A.a.Nva(k.substr(r,y)))||1!=Qc.a.Odb(b.Qa.node)?!1:!0}DWk(){return cs.a.zci?32==this.ga.processAction(Wa.a.IXc,1):!1}S2b(b){return this.l4e.S2b(b)}Cxd(b,k,r,y=null){this.O0c(b)||this.l4e.Cxd(b,k,r,y)}rjl(b){return this.wDe?this.wDe.sjl(b):[]}vOn(b){const k=this.GO?this.GO.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new hH,
{menuTargetType:k})}static get Wb(){return null!=tq.pkg?tq.pkg:tq.pkg=Va.a.instance.resolve("Box4.IFeatureHelper")}static h1f(b){return n.AFrameworkApplication.JZ&&!b.C6b&&Va.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").Zom()}static THd(b){b=b?b.trim():null;let k=20;b&&0<b.length&&(b.length>k&&(k=A.a.Ty(b,k)?k-1:k),b=b.length>k?b.substr(0,k).trim()+"...":b);return b}static tMk(b){let k=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=tq.THd(b))&&0<b.length&&(k=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,
b));return k}static Mpj(b){b=tq.THd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static eUh(){const b=(new dq.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static m6i(b){const k=tq.Wb.isFeatureEnabled(48);return!b.zwd&&k&&!X.a.Ak&&(b.C6b||k&&b.dO)}static E1f(b){return n.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.P7b()}static z6i(b){return n.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&
!b.C6b&&!b.P7b()}static wZn(b){return b.pii()&&n.AFrameworkApplication.ta.Rb.YOc}static I6i(){return 2===jl.App.En.mode}static G0n(b){return b.dO}t8m(b,k,r,y){this.UFb[y].forEach(R=>{const aa=Object.assign(new oi.a,{ControlList:[]}),ta=aa.ControlList;R.forEach(Ya=>{Ya instanceof Ys?r.push(...this.R5d.get(Ya)(b,k,this)):ta.push(...this.sD[Ya](b,k,this))});(null===ta||void 0===ta?0:ta.length)&&r.push(aa)})}C8m(){this.R5d.set(Ys.ENb,vE.mGl);this.R5d.set(Ys.pfe,vE.zrl);this.R5d.set(Ys.bge,vE.qLl)}D8m(){this.sD[ji.zNb]=
Xp.tnl;this.sD[ji.ege]=Xp.$Ml;this.sD[ji.fge]=Xp.eNl;this.sD[ji.ofe]=Xp.lrl;this.sD[ji.Hfe]=Xp.RAl;this.sD[ji.bfe]=Xp.Gbf;this.sD[ji.Afe]=Xp.Rxl;this.sD[ji.L5c]=Xp.jUh;this.sD[ji.bdg]=Xp.Lwl;this.sD[ji.age]=Xp.jLl;this.sD[ji.hge]=Xp.ZOl;this.sD[ji.Ofe]=Xp.YGl;this.sD[ji.Sfe]=Xp.FIl;this.sD[ji.N5c]=Xp.xzl;this.sD[ji.Q5c]=Xp.VEl;this.sD[ji.Pfe]=Xp.SHd;this.sD[ji.y5c]=Xp.ddf;this.sD[ji.Dge]=Xp.ARl;this.sD[ji.qfe]=Xp.esl;this.sD[ji.hfe]=Xp.Iml;this.sD[ji.gge]=Xp.OOl;this.sD[ji.gfe]=Xp.lml;this.sD[ji.w5c]=
Xp.getBookmark;this.sD[ji.wfe]=Xp.Wvl;this.sD[ji.yfe]=Xp.I$;this.sD[ji.hnb]=Xp.Snl;this.sD[ji.L5c]=Xp.jUh;this.sD[ji.rfe]=Xp.Osl}D3l(){const b=[ji.Hfe,ji.bfe,ji.ege];this.UFb[Sv.Wfg]=[[ji.zNb],b,[ji.hnb],[Ys.ENb],[ji.y5c]];this.UFb[Sv.Jeg]=[[ji.zNb],[ji.hfe,ji.qfe,ji.Dge],b,[ji.hnb],[Ys.ENb]];this.UFb[Sv.scg]=[[ji.rfe],[ji.N5c,ji.Q5c],[ji.w5c,ji.hnb],[Ys.ENb]];this.UFb[Sv.Ocg]=[[ji.L5c],[ji.ofe],[Ys.bge],[Ys.pfe],[ji.zNb],[ji.Afe,ji.bdg,ji.age,ji.hge],[ji.Ofe,ji.Sfe,ji.Q5c],[ji.N5c],b,[ji.y5c],[ji.yfe,
ji.w5c,ji.wfe,ji.hnb],[ji.Pfe],[ji.gge],[ji.gfe],[ji.fge],[Ys.ENb]];this.UFb[Sv.Fcg]=[[ji.zNb],[ji.hnb]];this.UFb[Sv.Erj]=[[ji.L5c],[ji.ofe],[Ys.bge],[Ys.pfe],[ji.zNb],[ji.hfe],[ji.qfe],[ji.Dge],[ji.Afe],[ji.age],[ji.hge],[ji.Ofe],[ji.Sfe],[ji.rfe],[ji.N5c],[ji.Q5c],[ji.yfe],[ji.Hfe],[ji.bfe],[ji.ege],[ji.w5c],[ji.wfe],[ji.hnb],[ji.Pfe],[ji.y5c],[ji.gge],[ji.gfe],[ji.fge],[Ys.ENb]]}}Object(m.a)(tq,"EditSurfaceContextMenu",wk,[]);var Sv;(function(b){b[b.Wfg=1]="TABLE_MULTI_CELL";b[b.Ocg=2]="GENERIC";
b[b.Jeg=3]="PICTURE";b[b.scg=4]="EQUATION";b[b.Erj=5]="LEGACY";b[b.Fcg=6]="FLUID"})(Sv||(Sv={}));Object(m.b)("Scenarios",Sv);class Ys{}Ys.ENb=new Ys;Ys.pfe=new Ys;Ys.bge=new Ys;Object(m.a)(Ys,"Sections",null,[]);var ji;(function(b){b[b.L5c=1]="INTENT_SUGGESTION";b[b.zNb=2]="ESSENTIALS";b[b.Afe=3]="INSIGHT";b[b.bdg=4]="ILLUSTRATION";b[b.age=5]="SMART_LOOKUP";b[b.hge=6]="TRANSLATE";b[b.Ofe=7]="PROOFING";b[b.Sfe=8]="REWRITE_SUGGESTIONS";b[b.N5c=9]="LISTS";b[b.Q5c=10]="PARAGRAPH_OPTIONS";b[b.Hfe=11]=
"MERGE_SPLIT_CELLS";b[b.bfe=12]="ALT_TEXT";b[b.yfe=13]="HYPERLINK";b[b.w5c=14]="BOOKMARK";b[b.wfe=15]="HEADING_LINK";b[b.hnb=16]="COMMENT";b[b.Pfe=17]="PULL_QUOTE";b[b.Dge=18]="WRAP_TEXT";b[b.qfe=19]="DRAW_ANNOTATE";b[b.gge=20]="TRACK_CHANGE";b[b.gfe=21]="CATCHUP_ACTIVITIES";b[b.fge=22]="TABLE_OF_CONTENTS";b[b.ofe=23]="DESIGNER_REVIEW";b[b.ege=24]="TABLE_ITEMS";b[b.hfe=25]="CHANGE_PICTURE";b[b.rfe=26]="EQUATION_TOOLS";b[b.y5c=27]="CONTENT_CONTROL"})(ji||(ji={}));Object(m.b)("SectionItem",ji);class kA extends Xs{constructor(b,
k,r){super();this.Rl=null;this.t0d=(y,R,aa,ta,Ya)=>{if(1===aa)return 32;y=[];R=[];this.vXn()&&R.push("InsertTabStopMenuSplitButton");this.gXn()&&R.push("ClearAllTabStops");R.push("HideRuler");y.push(kA.FVh(R));R=Object.assign(new Ci.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});R.MenuSectionList.push(...y);Ya.MenuItems=R;return 32};this.ga=b;this.Om=k;this.BC=r;this.Vb()}get L7a(){return document.getElementById("WACHorizontalRuler")}get OM(){return this.Om&&this.Om.instance?
this.Om.instance.vj:1}get target(){return this.Rl}show(b,k){this.Rl=b;Xs.YKb("RulerContextMenu",b,k);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",kA.X2);b.set("Response","Ruler Context menu invoked.");Ga.Health.instance.recordKpiUsage(kA.kpiName,1,kA.l6,b)}WHl(){var b=0,k=(this.target.x-Qe.a.jcf(this.L7a))/this.OM;k=Vf.a.az(k,0);var r={},y=this.BC.P1b,R=Wd.GraphIterator.Za(y);R.rd();if(!Si.TableReader.Pv(R))return 32===this.ga.Xb(Wa.a.VDa,
2,r)&&(b=r.marginLeft),k-b;b={};R={};r=this.ga.Xb(Wa.a.EWc,2,b);var aa=this.ga.Xb(Wa.a.zIb,2,R);if(32!==r||32!==aa)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),k;b=b.ColumnWidths;aa=R.TablePosition;if(!aa||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),k;r=0;R=Wd.GraphIterator.Za(y);R.Ab(14)&&(R.kd(16),r=Jl.a(R,!0));y=aa.x/this.OM;for(R=0;R<r;R++)y+=b[R];return k-y}Vb(){this.ga.gb(Jc.a.t0d,
lc.a.application,this.t0d,96)}vXn(){var b={},k={},r=this.ga.Xb(Wa.a.VDa,2,b),y=this.ga.Xb(Wa.a.d2a,2,k);if(32===r&&32===y){y=k.Ws;r=Vf.a.Ri(y.gma,0);y=1===y.specialIndentType?Vf.a.Ri(y.HA,0):Vf.a.Ri(y.HA-y.Fba,0);const R=Vf.a.Ri(b.marginLeft,0);b=Vf.a.Ri(b.marginRight,0);const aa=Qe.a.jcf(this.L7a),ta=Qe.a.jOh(this.L7a);k.isRtl?(k=aa+this.OM*Math.max(b,b+r),r=ta-this.OM*Math.max(R,R+y)):(k=aa+this.OM*Math.max(R,R+y),r=ta-this.OM*Math.max(b,b+r));if(this.target.x>=k&&this.target.x<=r)return!0}return!1}gXn(){var b=
{};if(32!==this.ga.Xb(Jc.a.lIb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static FVh(b){const k=Object.assign(new oi.a,{ControlList:[]});for(let r of b)k.ControlList.push(Object.assign(new Wg.a,{ExternalId:r}));return k}}kA.l6="wwaengidc";kA.kpiName="WordRuler";kA.X2="RulerContextMenu";Object(m.a)(kA,"RulerContextMenu",Xs,[267]);let yy;class Mp{static get oc(){return null!=Mp.hug?Mp.hug:Mp.hug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get iR(){return null!=Mp.$tg?
Mp.$tg:Mp.$tg=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Uj(){return null!=Mp.kmg?Mp.kmg:Mp.kmg=Va.a.instance.resolve("Box4.IInsertionPointFormatting")}static $Ii(b,k,r){if(1===k)return(b?Mp.Vsk(r):Mp.vsk(r))?32:8;(b=Mp.gMl(b,r))&&Mp.Yek(b,r);return 32}static Yek(b,k){const r=new sf.GraphTransaction(15);r.Eb(k);Mp.Uj.z2a();Mp.iR.pM(b,k,!1);r.dispose()}static Vsk(b){b=Mp.oc.Ao(b);return!!b&&Mp.oc.rf(b)!==rj.StyleReader.wordStyleIdHeading1}static vsk(b){b=Mp.oc.Ao(b);return!!b&&
Mp.oc.rf(b)!==rj.StyleReader.Y4a}static gMl(b,k){const r=Mp.oc.Ao(k);return r?Mp.oc.Sx(k).wh(Mp.dMl(b,Mp.oc.rf(r))):null}static dMl(b,k){k=Mp.headingsList.indexOf(k);b=b?k-1:k+1;return 0<=b&&b<Mp.headingsList.count?Mp.headingsList.J(b):null}}Mp.headingsList=(yy=new rb.a,yy.add(rj.StyleReader.wordStyleIdHeading1),yy.add(rj.StyleReader.wordStyleIdHeading2),yy.add(rj.StyleReader.wordStyleIdHeading3),yy.add(rj.StyleReader.V4a),yy.add(rj.StyleReader.W4a),yy.add(rj.StyleReader.X4a),yy.add(rj.StyleReader.Xmb),
yy.add(rj.StyleReader.Ymb),yy.add(rj.StyleReader.Y4a),yy);Object(m.a)(Mp,"NavigationPaneEditor",null,[]);class ND extends Xs{constructor(){super();this.a2=null;this.m0d=(b,k,r,y,R)=>{if(1===r)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Xs.nMh("promoteHeading",Jc.a.d1d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Xs.nMh("demoteHeading",
Jc.a.ozd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");R.PopulationXML=b.toString();return 32};this.d1d=(b,k,r)=>Mp.$Ii(!0,r,this.a2.zb);this.ozd=(b,k,r)=>Mp.$Ii(!1,r,this.a2.zb)}show(b){ND.Ah||(this.n_b(),ND.Ah=!0);Xs.showContextMenu("mnuNavPaneWordEditor",b)}n_b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Jc.a.KGi;b.Command=""+ib.a.Nja;Xs.nKk(b);n.AFrameworkApplication.ya.pa(Jc.a.KGi,
lc.a.application,this.m0d);n.AFrameworkApplication.ya.pa(Jc.a.d1d,lc.a.view,this.d1d);n.AFrameworkApplication.ya.pa(Jc.a.ozd,lc.a.view,this.ozd)}}ND.Ah=!1;Object(m.a)(ND,"WordEditorNavigationPaneContextMenu",Xs,[268]);var rz=c(1425),kv=c(294),rL=c(485),sL=c(741),wE=c(1176),vF=c(1621),wF=c(970);class xE{constructor(){this.H6=this.Vei=!1;this.ZLb=2;this.Zs=0;this.c5a=1}}Object(m.a)(xE,"WrapTextPropertiesData",null,[]);class Kl extends wE.a{constructor(b=null){super(b);this.a0g=new vF.a;this.m7g=new xE;
this.A3g=new wF.a;this.Hre=!1}initialize(){super.initialize();this.jd.Z(Jc.a.mwf,rz.a.Dfb);this.jd.Z(Jc.a.qwf,rz.a.Dfb);this.jd.Z(Jc.a.swf,rz.a.Dfb);this.jd.Z(Jc.a.rPf,Kl.ROa);this.jd.Z(Jc.a.yWc,Kl.ROa);this.jd.Z(Jc.a.kPf,Kl.ROa);this.jd.Z(ib.a.CIb,Kl.ROa);this.jd.Z(Wa.a.N1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.M1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.L1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.P1d,
Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.O1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.K1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.W1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.V1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.U1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.R1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));
this.jd.Z(Wa.a.S1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.T1d,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.EPf,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.DPf,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.WOf,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.YOf,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.XOf,Object(u.a)(this,
this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.VOf,Object(u.a)(this,this.x_,"sectionPropertiesExecuteBridge"));this.jd.Z(Wa.a.f3a,Kl.IGm);this.jd.Z(Wa.a.UPa,Kl.v3m);this.jd.Z(Wa.a.vkb,Kl.uBk);this.jd.Z(Wa.a.Tja,Kl.ROa);this.jd.Z(Wa.a.NHb,Kl.ROa);this.jd.Z(Wa.a.UOa,Kl.ROa);this.jd.Z(Wa.a.Nra,Kl.ROa);this.jd.Z(Wa.a.Eva,Kl.ROa);this.jd.Z(Jc.a.mVc,Kl.ROa);this.jd.Z(Jc.a.EDd,rz.a.N$e);this.jd.Z(Jc.a.FDd,Object(u.a)(this,this.OMh,"genericFontSizeExecuteBridge"));this.Pm.Z(Jc.a.kVc,rz.a.vXa);
this.Pm.Z(Jc.a.lVc,rz.a.vXa);this.jd.Z(Wa.a.uKb,rz.a.UXa);this.jd.Z(Wa.a.tKb,rz.a.UXa);this.jd.Z(Wa.a.Kkb,rz.a.UXa);this.jd.Z(Wa.a.QPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Wa.a.OPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Wa.a.PPf,Object(u.a)(this,this.tE,"queryParaFormattingExecuteBridge"));this.jd.Z(Wa.a.rM,Kl.Pcn);this.Pm.Z(Jc.a.y2d,Kl.EXc);this.Pm.Z(Jc.a.z2d,Kl.EXc);this.Pm.Z(Jc.a.A2d,Kl.EXc);this.Pm.Z(Jc.a.w2d,Kl.EXc);this.Pm.Z(Jc.a.x2d,
Kl.EXc);this.jd.Z(Jc.a.y2d,Object(u.a)(this,this.g5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Jc.a.z2d,Object(u.a)(this,this.g5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Jc.a.A2d,Object(u.a)(this,this.g5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Jc.a.w2d,Object(u.a)(this,this.g5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Jc.a.x2d,Object(u.a)(this,this.g5c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(Jc.a.Pee,Kl.Aic);this.jd.Z(Jc.a.Qee,Kl.Aic);this.jd.Z(Jc.a.Ree,Kl.Aic);this.jd.Z(Jc.a.Tee,
Kl.Aic);this.jd.Z(Jc.a.Uee,Kl.Aic);this.jd.Z(Jc.a.Vee,Kl.Aic);this.jd.Z(Jc.a.woa,Kl.d2b);this.jd.Z(Jc.a.Z0f,Kl.d2b);this.jd.Z(Jc.a.$0f,Kl.d2b);this.jd.Z(Jc.a.S8d,Kl.d2b);this.jd.Z(Jc.a.T8d,Kl.d2b);this.jd.Z(Jc.a.U8d,Kl.d2b);this.jd.Z(Jc.a.Ajb,Object(u.a)(this,this.yen,"queryImageCropExecuteBridge"));this.jd.Z(Jc.a.hWc,Kl.jEd);this.jd.Z(Jc.a.C1d,Kl.jEd);this.jd.Z(Jc.a.D1d,Kl.jEd);this.jd.Z(Jc.a.E1d,Kl.jEd);this.jd.Z(Jc.a.OLc,Object(u.a)(this,this.YLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Jc.a.LLc,
Object(u.a)(this,this.YLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Jc.a.MLc,Object(u.a)(this,this.YLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Jc.a.NLc,Object(u.a)(this,this.YLd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Wa.a.cma,Object(u.a)(this,this.X7h,"ignoreAllExecuteBridge"));this.jd.Z(Wa.a.Nyb,Object(u.a)(this,this.X7h,"ignoreAllExecuteBridge"));this.jd.Z(Jc.a.yjb,Kl.yjb);this.jd.Z(Jc.a.b9d,rz.a.UXa);this.jd.Z(Wa.a.VPf,Object(u.a)(this,this.XJi,"queryTableBorderFormattingExecuteBridge"));
this.jd.Z(Wa.a.WPf,Object(u.a)(this,this.XJi,"queryTableBorderFormattingExecuteBridge"))}clearCache(){super.clearCache();this.Hre=!1;this.a0g=new vF.a;this.m7g=new xE;this.A3g=new wF.a}wdf(){const b=super.wdf();b.Cza=Kl.Cza;b.SVa=Kl.SVa;return b}X7h(b){const k=new kv.a;k.$Aa=!0;k.kL=b;return k}x_(){const b=new kv.a;b.dCb=!1;b.kL=Wa.a.VDa;b.Ed=this.a0g;b.C7b=!0;b.yfa=!0;return b}XJi(){const b=new kv.a;b.dCb=this.Hre;this.Hre=!0;b.kL=Wa.a.f2a;b.Ed=this.A3g;b.C7b=!0;b.yfa=!0;return b}g5c(){const b=new kv.a;
b.dCb=!1;b.kL=Jc.a.Zbc;b.Ed=this.m7g;b.C7b=!0;b.yfa=!0;return b}YLd(b,k){const r=new kv.a;r.Ed=new Di.DictionaryPropertySet;switch(b){case Jc.a.OLc:r.Ed.setValue(td.a.rfb,k[rc.a.Number]);break;case Jc.a.LLc:r.Ed.setValue(td.a.ofb,k[rc.a.Number]);break;case Jc.a.MLc:r.Ed.setValue(td.a.pfb,k[rc.a.Number]);break;case Jc.a.NLc:r.Ed.setValue(td.a.qfb,k[rc.a.Number])}return r}yen(){const b=new kv.a;b.Ed=new Di.DictionaryPropertySet;b.yfa=!0;return b}static get X2m(){return null!=Kl.Tpg?Kl.Tpg:Kl.Tpg=Va.a.instance.Pa("WordEditor.IPageCommandStringBuilder")}static get hz(){Kl.gra||
(Kl.gra=Va.a.instance.Pa("WordEditor.ITableBorderManager"));return Kl.gra}static ROa(b,k){b=new kv.a;b.Ed=k;return b}static v_c(b,k,r){k[Ig.a.Description]=b?b.FGm(r):null}static Cza(b,k){const r=Object(ia.a)(vF.a,b.Ed),y=Object(ia.a)(rL.a,b.Ed),R=Object(ia.a)(xE,b.Ed),aa=Object(ia.a)(wF.a,b.Ed);let ta=!0;const Ya=Kl.X2m;switch(b.Pib){default:ta=wE.a.Cza(b,k);break;case Wa.a.N1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";k[Ig.a.On]=!r.OFb;Kl.v_c(Ya,k,0);break;
case Wa.a.M1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";k[Ig.a.On]=1===r.OFb;Kl.v_c(Ya,k,1);break;case Wa.a.L1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";k[Ig.a.On]=2===r.OFb;Kl.v_c(Ya,k,2);break;case Wa.a.P1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";k[Ig.a.On]=3===r.OFb;Kl.v_c(Ya,k,3);break;case Wa.a.O1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";
k[Ig.a.On]=4===r.OFb;Kl.v_c(Ya,k,4);break;case Wa.a.K1d:k[xj.a.Icon]=r.iua?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";k[Ig.a.On]=5===r.OFb;break;case Wa.a.W1d:k[Ig.a.On]=!r.oHb;k[Ig.a.Description]=Ya?Ya.zUc(0):null;break;case Wa.a.V1d:k[Ig.a.On]=1===r.oHb;k[Ig.a.Description]=Ya?Ya.zUc(1):null;break;case Wa.a.U1d:k[Ig.a.On]=2===r.oHb;k[Ig.a.Description]=Ya?Ya.zUc(2):null;break;case Wa.a.R1d:k[Ig.a.On]=3===r.oHb;k[Ig.a.Description]=Ya?Ya.zUc(3):null;break;case Wa.a.S1d:k[Ig.a.On]=
4===r.oHb;k[Ig.a.Description]=Ya?Ya.zUc(4):null;break;case Wa.a.T1d:k[Ig.a.On]=5===r.oHb;break;case Wa.a.EPf:k[Ig.a.On]=!r.iua;break;case Wa.a.DPf:k[Ig.a.On]=r.iua;break;case Wa.a.WOf:k[Ig.a.On]=1===r.LC;break;case Wa.a.YOf:k[Ig.a.On]=2===r.LC;break;case Wa.a.XOf:k[Ig.a.On]=3===r.LC;break;case Wa.a.VOf:k[Ig.a.On]=0===r.wBk;break;case Wa.a.QPf:k[Ig.a.On]=y.Ws?!y.Ws.specialIndentType:!1;break;case Wa.a.OPf:k[Ig.a.On]=y.Ws?1===y.Ws.specialIndentType:!1;k[cl.a.Image16by16Class]=y.isRtl?ci.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):
ci.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Wa.a.PPf:k[Ig.a.On]=y.Ws?2===y.Ws.specialIndentType:!1;k[cl.a.Image16by16Class]=y.isRtl?ci.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):ci.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Jc.a.y2d:k[Ig.a.On]=1===R.c5a;break;case Jc.a.z2d:k[Ig.a.On]=8===R.c5a;break;case Jc.a.A2d:k[Ig.a.On]=9===R.c5a;break;case Jc.a.w2d:k[Ig.a.On]=3===R.c5a;break;case Jc.a.x2d:k[Ig.a.On]=4===R.c5a;break;case Jc.a.Ajb:k[Ig.a.On]=
b.Ed.ia(td.a.dua,!1);break;case Jc.a.yjb:k[ge.a.IsFreeForm]=!0;k[ge.a.Value]=b.Ed[Md.a.Value];break;case Wa.a.VPf:k[eh.a.On]=Kl.hz.hOh(k.MenuItemId)===aa.lineStyle;break;case Wa.a.WPf:k[eh.a.On]=Kl.hz.iOh(k.MenuItemId)===aa.TQc}return ta}static IGm(b,k){b=5;switch(k.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}k=new kv.a;k.Ed=b;return k}static v3m(b,
k){b=5;switch(k.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}k=new kv.a;k.Ed=b;return k}static uBk(b,k){b=0;switch(k.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}k=new kv.a;k.Ed=b;return k}static yjb(){const b=new kv.a;b.kL=Jc.a.yjb;b.Ed={};b.yfa=!0;b.C7b=!0;return b}static Aic(b,k){const r=new kv.a;r.Ed=new Di.DictionaryPropertySet;
let y=1;switch(b){case Jc.a.Tee:y=1;break;case Jc.a.Uee:y=8;break;case Jc.a.Vee:y=9;break;case Jc.a.Qee:y=3;break;case Jc.a.Ree:y=4}r.Ed.setValue(td.a.c5a,y);r.Ed.setValue(td.a.MEa,k[Ig.a.SourceControlId]);return r}static d2b(b,k,r){b=new kv.a;b.Ed=r.InvocationMethod;return b}static Pcn(b,k){b=new kv.a;b.Ed=k;return b}static EXc(){const b=new sL.a;b.kL=Jc.a.Zbc;return b}static jEd(){const b=new kv.a;b.Ed=new Di.DictionaryPropertySet;b.WOc=!0;return b}static SVa(b,k){let r=!0;switch(b.Pib){case Jc.a.hWc:b=
b.Ed.ia(td.a.rfb,0);k[rc.a.Number]=b;k[rc.a.UnitType]=7;break;case Jc.a.C1d:b=b.Ed.ia(td.a.ofb,0);k[rc.a.Number]=b;k[rc.a.UnitType]=7;break;case Jc.a.D1d:b=b.Ed.ia(td.a.pfb,0);k[rc.a.Number]=b;k[rc.a.UnitType]=7;break;case Jc.a.E1d:b=b.Ed.ia(td.a.qfb,0);k[rc.a.Number]=b;k[rc.a.UnitType]=7;break;default:r=wE.a.SVa(b,k)}return r}}Kl.gra=null;Object(m.a)(Kl,"CuiActionBridge",wE.a,[]);class xF extends yf.a{constructor(b){super();this.OBk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.tUn=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;
this.uzd=this.Gtb=this.G4=this.wTa=this.nHe=null;this.Ub=b;this.vg="<div id='AccessibilityHelpDialogBody'></div>";this.lg="AAccessibilityHelpDialog";this.Gd=6;this.We(0,CommonUIStrings.l_DialogClose)}get k4e(){return null}get h8d(){this.nHe||(this.nHe=this.N4l());return this.nHe}get t8n(){return 300}get kti(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get jti(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get eXa(){return this.Ub.Fs()}QPa(b){super.QPa(b);this.h8m()}gQa(){this.showDialog(this.PKa,
Object(u.a)(this,this.o1j,"accHelpDialogResultHandler"));this.$Da();this.setFocus()}setFocus(){this.G4?(this.Gtb=this.G4.tBodies[0].firstChild,this.xU(this.Gtb)):this.qG&&"none"!==this.qG.style.display?this.xU(this.qG):this.xU(this.mz)}Wja(){this.le.mb(Kb.a.ni,this.uzd,Object(u.a)(this,this.D7g,"accHelpDialogKeydownHandler"));if(this.G4){this.le.mb(Kb.a.oh,this.G4,Object(u.a)(this,this.Oaj,"tableOnKeyUpHandler"));const b=this.G4.tBodies[0].children;for(let k=0;k<b.length;k++)if(Af.a.addHandler(b[k],
Kb.a.focus,Object(u.a)(this,this.eVi,"rowOnFocusHandler")),Af.a.addHandler(b[k],Kb.a.blur,Object(u.a)(this,this.dVi,"rowOnBlurHandler")),X.a.Ak){const r=b[k].children;for(let y=0;y<r.length;y++)Af.a.addHandler(r[y],Kb.a.focus,Object(u.a)(this,this.nmh,"cellOnFocusHandler"))}}super.Wja()}dcb(){this.le&&(this.le.sc(Kb.a.ni,this.uzd,Object(u.a)(this,this.D7g,"accHelpDialogKeydownHandler")),this.G4&&this.le.sc(Kb.a.oh,this.G4,Object(u.a)(this,this.Oaj,"tableOnKeyUpHandler")));if(this.G4){const b=this.G4.tBodies[0].children;
for(let k=0;k<b.length;k++)if(Af.a.removeHandler(b[k],Kb.a.focus,Object(u.a)(this,this.eVi,"rowOnFocusHandler")),Af.a.removeHandler(b[k],Kb.a.blur,Object(u.a)(this,this.dVi,"rowOnBlurHandler")),X.a.Ak){const r=b[k].children;for(let y=0;y<r.length;y++)Af.a.removeHandler(r[y],Kb.a.focus,Object(u.a)(this,this.nmh,"cellOnFocusHandler"))}}super.dcb()}$Da(){this.eXa.scope.Er(this.Ub.EV);this.eXa.scope.Er(this.Ub.FV);this.eXa.scope.bindAction(this.Ub.EV,ib.a.Yxc);this.eXa.scope.bindAction(this.Ub.FV,ib.a.Xxc)}xWl(b){if(!this.eXa.Wj||
!this.eXa.Wj.a2)return 2;var k=this.eXa.Wj.a2;if(this.G4&&(k===this.mz&&b===ib.a.Yxc||k===this.wTa&&b===ib.a.Xxc))this.xU(this.Gtb);else if(k.id.startsWith("SelectableTableRow"))k=null,b===ib.a.Yxc?k=this.wTa:b===ib.a.Xxc&&(k=this.mz),k&&this.xU(k);else if(b===ib.a.Yxc)this.eXa.d$b();else if(b===ib.a.Xxc)this.eXa.b$b();else return 2;return 32}eVi(b){b.target.setAttribute(Ef.a.pab,Ef.a.Jo);Sys.UI.DomElement.removeCssClass(this.Gtb,"inactiveRowSelection");this.Gtb=b.target}dVi(b){b.target.removeAttribute(Ef.a.pab);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}nmh(b){(b=b.target.parentNode)&&b!==this.Gtb&&this.xU(b)}Oaj(b){return b.Ib.keyCode===tb.a.hs?(b.Ib.stopPropagation(),!0):!1}D7g(b){if(!b.Ib)return!1;const k=b.Ib.keyCode;if(b.eventName===Kb.a.ni){b=this.wxl(this.Gtb);let r=-1;const y=Ba.a.count(this.h8d)-1;k===Sys.UI.Key.down?r=b<y?b+1:0:k===Sys.UI.Key.up?r=0<b?b-1:y:k===Sys.UI.Key.home?r=0:k===Sys.UI.Key.end&&(r=y);-1!==r&&this.xU(this.G4.tBodies[0].children[r])}return!0}o1j(){}h8m(){this.uzd=
document.getElementById("AccessibilityHelpDialogBody")||this.qv;this.wPk();this.ePk();this.$Mk()}wPk(){if(this.k4e){var b=document.createElement("div");b.className="WACDialogSubtitle";var k=document.createElement("span");k.innerText=this.k4e;b.appendChild(k);this.pia.appendChild(b)}}ePk(){if(this.h8d&&!Ba.a.isEmpty(this.h8d)){this.G4=document.createElement("table");this.G4.className="SelectableDialogTable";var b=document.createElement("thead"),k=document.createElement("tr");k.setAttribute(Ef.a.Bh,
Ef.a.szc);b.appendChild(k);var r=Fd.a.MCc(14,this.OBk);k.appendChild(r);r=Fd.a.MCc(14,this.tUn);k.appendChild(r);this.G4.appendChild(b);b=document.createElement("tbody");k=0;r=this.h8d;for(let aa in r){var y=aa,R=r[aa];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(Ef.a.Bh,Ef.a.szc);ta.id="SelectableTableRow"+k++;y=Fd.a.MCc(15,y);ta.appendChild(y);R=Fd.a.MCc(15,R);ta.appendChild(R);b.appendChild(ta)}b.style.maxHeight=this.t8n+"px";this.G4.appendChild(b);this.uzd.appendChild(this.G4)}}$Mk(){if(this.jti&&
this.kti){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.wTa=document.createElement("a");this.wTa.innerText=this.jti;this.wTa.href=this.kti;this.wTa.target="_blank";this.wTa.id=this.pj("AccessibilityHelpDialogLink");this.wTa.className=id.AFrame.JQe;b.appendChild(this.wTa);this.fd.insertBefore(b,this.fd.lastChild)}}wxl(b){return Number.parseInvariant(b.id.substr(18))}B1(b,k,r,y=null){b&&k&&r&&(r=y?String.format(r,y):r,b[k]=r)}N_h(b,k){return X.a.wl?k:b}}Object(m.a)(xF,
"AAccessibilityHelpDialog",yf.a,[1042]);class ZB extends xF{constructor(b){super(b)}get PKa(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get k4e(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}N4l(){const b=this.N_h(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),k=this.N_h(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.B1(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.B1(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.B1(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.B1(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,k);this.B1(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);jl.App.uee&&this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.B1(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);n.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&
this.B1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(ZB.Wb&&ZB.Wb.isFeatureEnabled(63)||n.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.B1(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get Wb(){return null!=ZB.gkg?ZB.gkg:ZB.gkg=Va.a.instance.Pa("Box4.IFeatureHelper")}}Object(m.a)(ZB,
"AccessibilityHelpDialog",xF,[]);var iH=c(310);class yE{static get vg(){return yf.a.Rx(yE.tl,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}yE.tl="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(m.a)(yE,"ApplyStylesDialogHtml",null,[]);class MC extends yf.a{constructor(b,k){super();this.HG=null;this.wwc=!1;this.Tub=this.N5a=this.Qsc=this.Tsc=this.Kwc=null;this.Bfk=(r,y)=>{if(this.Gf.Sr){if(r){r=y.styleList;y=y.styleText;if(-1===r||A.a.mh(y)!==A.a.mh(this.HG[r]))r=this.f0h(y);y=this.HG[r];r=this.oc.Np();y=this.oc.rf(r.Bta(y));n.AFrameworkApplication.ya.Vf(this._context,Wa.a.applyStyle,2,!1,new iH.a,y)}this.Gf.RX()}};this.y_m=r=>{this.wwc?(this.wwc=!1,this.validate()):"value"===r.rawEvent.propertyName&&
(this.wwc=!0,this.gN.value!==this.Kwc&&(this.Kwc=this.gN.value,this.lgh()))};this.rWm=()=>{-1!==this.uja.selectedIndex&&(X.a.WB&&(this.wwc=!0),this.Kwc=this.HG[this.uja.selectedIndex],this.gN.value=this.HG[this.uja.selectedIndex],this.validate())};this.onKeyDown=r=>{X.a.iJ?r.keyCode!==tb.a.eB&&r.keyCode!==tb.a.g0||this.N5a||this.Tub||(this.Tub=new nd.a(0,1,1,this.kso),n.AFrameworkApplication.uc.fc(this.Tub)):X.a.WB&&r.keyCode===tb.a.eB&&(this.wwc=!0)};this.RF=()=>{this.N5a||(this.N5a=new nd.a(0,1,
1,this.Shk),n.AFrameworkApplication.uc.fc(this.N5a));this.Tub&&(n.AFrameworkApplication.uc.Ye(this.Tub),this.Tub=null)};this.Shk=()=>{this.N5a=null;this.lgh()};this.kso=()=>{this.Tub=null;this.validate()};this._context=b;this.Ic=k;this.lg="ApplyStylesDialog";this.Gf=this._context.view;this.wif();b=this.n6n();k="";this.HG.length>b&&(k=this.HG[b]);k={["styleText"]:k,["styleList"]:b};this.vg=yE.vg;this.Vh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.Bfk,k);this.uja=document.getElementById("styleList");
this.IMf();this.uja.selectedIndex=b;this.gN=document.getElementById("styleText");this.gN.focus();this.gN.select();this.thd=this.rWm;Af.a.addHandler(this.uja,"change",this.thd);this.shd=this.onKeyDown;Af.a.addHandler(this.gN,"keydown",this.shd);X.a.WB?(this.Tsc=this.y_m,Af.a.addHandler(this.gN,"propertychange",this.Tsc),this.Kwc=this.HG[b]):(this.Qsc=this.RF,Af.a.addHandler(this.gN,"keypress",this.Qsc))}get oc(){return null!=this.jug?this.jug:this.jug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}n6n(){var b=
this.Gf.Cb;if(!b||!b.ib)return Od.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.ib.kb;if(!b)return Od.b(579216409,3018,15,"CurrentSelection is null"),0;ie.ParagraphReader.em(b.Qa)&&(b=rf.SelectionEditor.Qj(b,!0,!1));b=b.Qa;if(!b||!rf.SelectionEditor.ju(b))return Od.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var k=Kk.FormattingReader.Qr(b);(k=Kk.FormattingReader.Eta(k))||(k=this.oc.Ao(b.node));if(!k)return 0;b=this.oc.DF(k);b=Array.indexOf(this.HG,
b);0>b&&(b=0);return b}IMf(){const b=this.HG.length;for(let k=0;k<b;k++){const r=document.createElement("OPTION");r.value=k.toString();r.text=this.HG[k];this.uja.add(r,null)}}wif(){var b=mi.a.Vw();if(b){b=(new sw.WACStyleSet).ZN(b);var k=b.yN,r=this.Ic.isFeatureEnabled(119)&&!!this.oc.sh;this.HG=[];for(let y=0;y<k;y++){const R=b.Pla(y);if(this.oc.isHidden(R))continue;const aa=this.oc.Xw(R);if(!r){if(3===aa)continue}else if(3===aa&&this.oc.rf(R)===hy.a.e5c)continue;Array.add(this.HG,this.oc.DF(R))}this.HG.sort(MC.uDk)}else Od.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Tsc&&Af.a.removeHandler(this.gN,"propertychange",this.Tsc);this.shd&&Af.a.removeHandler(this.gN,"keydown",this.shd);this.thd&&Af.a.removeHandler(this.uja,"change",this.thd);this.Qsc&&Af.a.removeHandler(this.gN,"keypress",this.Qsc);this.N5a&&n.AFrameworkApplication.uc.Ye(this.N5a);this.N5a=this.Qsc=this.uja=this.gN=this.shd=this.Tsc=this.thd=null;super.dispose()}lgh(){var b=this.gN.value,k=this.O2l(b);const r=-1===k?b:this.HG[k];b=b.length;const y=
r.length;this.Kwc=r;this.gN.value=r;this.uja.selectedIndex=k;y>b&&(X.a.iJ?this.gN.setSelectionRange(b,y):X.a.WB&&(k=this.gN.createTextRange(),k.collapse(!0),k.moveStart("character",b),k.moveEnd("character",y-b),k.select()));this.validate();this.gN.focus()}O2l(b){let k=0,r=this.HG.length,y=-1;for(b=A.a.mh(b);k<r;){const R=Math.floor((k+r)/2),aa=MC.OYe(b,this.HG[R]);if(!aa){y=R;break}0<aa?k=R+1:r=R}if(y>k)for(;!MC.OYe(b,this.HG[y-1])&&(y--,y!==k););return y}validate(){const b=-1===this.f0h(this.gN.value),
k=document.getElementById("badStyleError");b?(k.style.display="inline-block",k.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(k.style.display="none",k.innerText="");return!b}f0h(b){b=A.a.mh(b);const k=this.HG.length;for(let r=0;r<k;r++)if(b===A.a.mh(this.HG[r]))return r;return-1}static OYe(b,k){const r=Math.min(b.length,k.length);b=A.a.mh(b);k=A.a.mh(k);for(let y=0;y<r;y++){const R=A.a.charCodeAt(b,y),aa=A.a.charCodeAt(k,y);if(R!==aa)return R-aa}return b.length<=k.length?0:1}static uDk(b,
k){return MC.OYe(b,k)}}Object(m.a)(MC,"ApplyStylesDialog",yf.a,[]);class zE{static get vg(){return yf.a.Rx(zE.tl,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}zE.tl="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(m.a)(zE,"CreateNewStyleDialogHtml",null,[]);class Cs extends yf.a{constructor(b,k,r=!1){super(!1,!1,r);this.pz=null;this._context=b;this.ga=k;r=k=null;this.lg=Cs.id;if(this.Gf=b.view)r=this.Gf.Cb;r&&r.ib&&r.ib.kb&&(k=r.ib.kb.Qa);k?(b=k.node)?(this.xz=Cs.qh.pu(b))?(this.KC=(new sw.WACStyleSet).ZN(this.xz),(this.ZR=this.ndb.qCd(k))?(b=this.ZR.ia(Te.a.fontSize,22),16>b?Od.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=b?Od.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=b?Od.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Od.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.fTf(this.ZR)):Od.b(592737758,3018,10,"_newStyleProperties is null.")):Od.b(592737757,3018,10,"_pageContenNode is null."):Od.b(592725466,3018,10,"node is null."):Od.b(556917206,3018,10,"nodeContext is null.")}fTf(b){b.Vg(Hk.a.paragraphStyle,Hk.a.xB,...Jo.a.cH())}get ndb(){return this.pz||(this.pz=Va.a.instance.resolve("Box4.IFormattingReader"))}get oc(){return null!=
this.pug?this.pug:this.pug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}rgf(b){if(!b)return"";const k=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,r=b.yN;let y;for(y=1;y<=r;y++){const R=k+y;let aa=b.wh(R)||b.a4b(R);aa||(aa=b.wh(R+"Char")||b.a4b(R+"Char"));if(!aa)break}return k+y}ryc(b,k){const r=new sf.GraphTransaction(15);r.Eb(this.xz);r.Al=Wa.a.createNewStyle;if(k=mi.a.ryc(b,mi.a.JYh(k),null,this.xz))Od.b(593078046,3018,50,"User created linked style"),this.KC=(new sw.WACStyleSet).ZN(this.xz),
b=A.a.Nva(A.a.GZ(b)),b=this.KC.a4b(b),this.ga.Vf(this._context,Wa.a.applyStyle,2,!1,new iH.a,this.oc.rf(b));r.dispose();return k}emj(b){var k=A.a.Nva(b);const r=""===A.a.Nva(b),y=b.length>Cs.NHm,R=RegExp("[{|}|;|\\\\]").test(b);b=!!this.KC.Bta(b)||!!this.KC.a4b(k);k=null;if(r||y||R||b)k=r?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:y?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:R?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return k}static get qh(){return lk.PageNavigator.instance}}Cs.id="CreateNewStyleDialog";Cs.QUd=26;Cs.NHm=253;Cs.u$i=5;Cs.t$i=40;Object(m.a)(Cs,"ACreateNewStyleDialog",yf.a,[]);class jH extends Cs{constructor(b,k){super(b,k);this.kNk=r=>{this.Gf.Sr&&(r&&(r=new Map,r.set("Source","CreateNewStyleDialog"),r.set("Action","CreateStyle"),Ga.Health.instance.recordKpiUsage(Jo.a.$mb,0,Jo.a.LB,r),this.ryc(this.gN.value,this.ZR)||(r=new Map,r.set("Source","CreateNewStyleDialog"),r.set("Action","CreateStyle"),
r=Object.assign(new Xa.a,{extendedProperties:r}),Ga.Health.instance.recordKpiFailure(Jo.a.$mb,"CreateStyleFailed",!1,!0,r))),this.Gf.RX())};this.xz&&this.ZR&&(b=this.rgf(this.KC),k={["styleText"]:b},this.vg=zE.vg,this.Vh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.kNk,k),this.gN=document.getElementById("styleText"),this.xU(this.gN),k=document.getElementById("previewContainer"),this.uRn(this.ZR,b,k),this.P$c=document.getElementById("badStyleNameError"))}Wpl(b){const k=b.ia(Te.a.fontSize,
zj.a.VJ)>=2*Cs.QUd;b=oc.a.yQh(b,"97%",Cs.QUd,!1,!0,k)+" padding-left: "+Cs.u$i+"px;";k||(b=b+" line-height: "+Cs.t$i+"px;");return b}uRn(b,k,r){const y=document.createElement("div");y.innerText=k;b=this.Wpl(b);y.setAttribute("style",b);r.appendChild(y)}validate(){const b=this.emj(this.gN.value),k=!!b;k?(this.P$c.style.display="inline-block",this.P$c.innerText=b):(this.P$c.style.display="none",this.P$c.innerText="");return!k}}Object(m.a)(jH,"CreateNewStyleDialog",Cs,[]);var NC=c(344);class kH extends cf.StandardDialog{constructor(b){super();
this.Xu=b;this.jZn()}jZn(){this.Gd=1;this.wU(1);this.We(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Tv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.H3e.bind(this))}H3e(b){1===b&&this.Xu.dha("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(k=>{k.Ki?Od.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",k.exception,k.exception.stack):(this.Azn(),Od.b(524834399,3018,50,"User deleted saved styles via UI."))},
8)}Azn(){NC.a.Lmb="{}"}}Object(m.a)(kH,"DeleteSavedStylesConfirmationDialog",cf.StandardDialog,[]);class lH extends cf.StandardDialog{constructor(b,k){super();this.H3e=R=>{if(1===R){R=new Map;R.set("Source","DeleteStyleConfirmationDialog");R.set("Action","DeleteStyle");Ga.Health.instance.recordKpiUsage(Jo.a.$mb,0,Jo.a.LB,R);var aa=mi.a.Vw();R=new sf.GraphTransaction(15);R.Eb(aa);R.Al=Wa.a.Cyb;this.iR.oUk(this.Y2g)?Od.b(578359694,3018,50,"User deleted a style via UI."):(aa=new Map,aa.set("Source",
"DeleteStyleConfirmationDialog"),aa.set("Action","DeleteStyle"),aa=Object.assign(new Xa.a,{extendedProperties:aa}),Ga.Health.instance.recordKpiFailure(Jo.a.$mb,"DeleteStyleFailed",!1,!0,aa),Od.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));R.dispose()}};k||Od.b(590128417,3018,10,"styleId is null");let r=null,y=null;if(this.Gf=b.view)y=this.Gf.Cb;y&&(r=y.ib.kb.Qa);r?(b=r.node)?(this.xz=this.qh.pu(b))?(this.Y2g=new rb.a,this.Y2g.add(k),this.kZn(k)):Od.b(590128448,
3018,10,"_pageContenNode is null."):Od.b(590128419,3018,10,"node is null."):Od.b(590128418,3018,10,"nodeContext is null.")}get iR(){return null!=this.Ytg?this.Ytg:this.Ytg=Va.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get oc(){return null!=this.rug?this.rug:this.rug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get qh(){return null!=this.gqg?this.gqg:this.gqg=lk.PageNavigator.instance}kZn(b){const k=(new sw.WACStyleSet).ZN(this.xz);k?((b=k.wh(b))||Od.b(590128450,3018,10,"Style set doesn't contain style with given ID"),
b=this.oc.DF(b),this.Gd=4,this.wU(2),this.Tv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.H3e)):Od.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(lH,"DeleteStyleConfirmationDialog",cf.StandardDialog,[]);class AE{static get vg(){return yf.a.Rx(AE.tl)}}AE.tl="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(AE,
"DeleteStyleDialogHtml",null,[]);class mH extends yf.a{constructor(b){super();this.xz=this.HG=null;this.XUk=(k,r)=>{this.Gf.Sr&&(k?(k=r.styleList,-1!==k&&(k=this.HG[k],r=this.oc.Np(),k=this.oc.rf(r.Bta(k)),this.h4e.WUk(this._context,k),this.Gf.RX())):this.Gf.RX())};this._context=b;this.lg="DeleteStyleDialog";this.Gd=1;this.We(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.Gf=this._context.view;this.wif();this.vg=AE.vg;this.Vh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.XUk,
{["styleList"]:0});this.uja=document.getElementById("styleList");this.IMf();this.uja.selectedIndex=0;this.uja.focus()}get oc(){return null!=this.lug?this.lug:this.lug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get h4e(){return null!=this.bjg?this.bjg:this.bjg=Va.a.instance.resolve("WordEditor.UI.IDialogFactory")}IMf(){const b=this.HG.length;for(let k=0;k<b;k++){const r=document.createElement("OPTION");r.value=k.toString();r.text=this.HG[k];this.uja.add(r,null)}}wif(){if(this.xz=mi.a.Vw()){var b=
(new sw.WACStyleSet).ZN(this.xz),k=b.yN;this.HG=[];for(let y=0;y<k;y++){const R=b.Pla(y);if(!this.oc.isHidden(R)&&this.oc.oe(R,b)){var r=this.oc.Xw(R);if(2===r||1===r)R.hasProperty(wc.a.Gc)&&2!==r||(r=R.ia(wc.a.hF,null))&&0<r.length||this.HG.push(this.oc.DF(R))}}this.HG.sort()}else Od.b(578650370,3018,15,"PageContentNode is null")}}Object(m.a)(mH,"DeleteStyleDialog",yf.a,[]);var tL=c(765);class nH{constructor(b){this.customData=null;this.NN=b}}Object(m.a)(nH,"PropertySetChangedState",null,[]);class oH{static bbn(b,
k,r){if(b&&k){var y=new nH(k),R=(aa,ta,Ya)=>{r.abn(aa,ta,Ya,y)};b=new tL.a(k,b);b.srd=R;b.rud=R;b.j4d=R;b.wbc()}}}Object(m.a)(oH,"PropertySetChangedManager",null,[]);class pH{constructor(b){this.OY=b}abn(b,k,r,y){const R=this.OY[b.id.toString()];R&&R(b,k,r,y)}}Object(m.a)(pH,"PropertyChangedProcessor",null,[]);const OC=(b,k,r)=>{const y=lt.a.instance.P1b;if(y){const R=new sf.GraphTransaction(15);R.Eb(y);oH.bbn(b,k,new pH(r));R.dispose()}};class BE{static get vg(){return yf.a.Rx(BE.tl,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}BE.tl="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(BE,"MarginsDialogHtml",null,[]);class zp{static get m_(){return null!=zp.Upg?zp.Upg:zp.Upg=Va.a.instance.Pa("WordEditor.IPageCommands")}static EGm(b,k,r){zp.m_&&null!==r&&zp.m_.p7d(0,r)}static AGm(b,k,r){zp.m_&&null!==r&&zp.m_.p7d(3,r)}static CGm(b,k,r){zp.m_&&null!==r&&zp.m_.p7d(1,r)}static DGm(b,k,r){zp.m_&&null!==r&&zp.m_.p7d(2,r)}static F3m(b,k,r){zp.m_&&null!==r&&zp.m_.UPa(0,r)}static g3m(b,k,r){zp.m_&&null!==r&&zp.m_.UPa(1,r)}static fBk(b,k,r){zp.m_&&null!==r&&zp.m_.kYf(0,r)}static rBk(b,
k,r){zp.m_&&null!==r&&zp.m_.kYf(1,r)}static pBk(b,k,r){zp.m_&&null!==r&&zp.m_.kYf(2,r)}}Object(m.a)(zp,"PageLevelPropertyChangedHandlers",null,[]);class ju extends yf.a{constructor(b,k,r,y,R,aa){super();this.Ygb=aa;this.ita=(ta,Ya)=>{var xb=ju.vjb(ta);ta=Ka.App.Eaa;this.Ee.hasProperty(xb)?(xb=this.Ee.getValue(xb),Ya[rc.a.Number]=Rg.a.Yba(xb,ta)):Ya[rc.a.Number]=0;Ya[rc.a.UnitType]=ta};this.bwa=(ta,Ya)=>{this.Ee.setValue(ju.vjb(ta),Rg.a.PQa(Ya[rc.a.Number],Ya[rc.a.UnitType]));this.pp.xl()};this.GGm=
ta=>{let Ya=!1;1===ta&&(Math.abs(this.Ee.getValue(wc.a.marginTop))+Math.abs(this.Ee.getValue(wc.a.marginBottom))+Ka.App.Wwa<=this.iL.getValue(wc.a.ey)&&this.Ee.getValue(wc.a.marginLeft)+this.Ee.getValue(wc.a.marginRight)+Ka.App.Wwa<=this.iL.getValue(wc.a.Oo)?OC(this.$M,this.Ee,ju.YYa()):Ya=!0);this.dispose();Ya&&this.dwa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.BGm)};this.BGm=()=>{Va.a.instance.resolve("WordEditor.UI.IDialogFactory").Evh(this.$M,this.iL,this.ZO)};this.lg="MarginsDialog";
this.iL=k.clone();this.$M=b.clone();this.Ee=b.clone();this.ZO=r;this.DR=!1;this.pp=R;this.vg=BE.vg;r&&(this.Nob=Ko.a.i4a);this.Vh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.GGm,null);this.LCb();this.Ygb&&(this.GIe=document.getElementById("DialogMarginTopSpinner"),this.xU(this.GIe))}eU(){this.ptd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Jc.a.fUc,Jc.a.J1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.ptd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Jc.a.eUc,Jc.a.G1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.ptd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Jc.a.vZd,Jc.a.H1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.ptd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Jc.a.wZd,Jc.a.I1d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}LCb(){for(let b=0;b<ju.U7.length;b++)Mh.a.Vja(ju.U7[b],this.bwa,this.ita);
this.pp.iM("DialogMarginTopSpinner");this.pp.iM("DialogMarginBottomSpinner");this.pp.iM("DialogMarginLeftSpinner");this.pp.iM("DialogMarginRightSpinner")}dispose(){for(let b=0;b<ju.U7.length;b++)Mh.a.Gsa(ju.U7[b]);this.pp.VA("DialogMarginTopSpinner");this.pp.VA("DialogMarginBottomSpinner");this.pp.VA("DialogMarginLeftSpinner");this.pp.VA("DialogMarginRightSpinner");super.dispose()}ptd(b,k,r,y,R){r=ju.Lnk(k,r,y,R);this.VVa(r,b,k)}VVa(b,k,r){k=document.getElementById(k);this.pp.rza(r,b);b=this.pp.yYa(r,
"Medium");k.appendChild(b)}static YYa(){return ju.OY||(ju.OY=ju.EKa())}static EKa(){const b={};b[wc.a.marginTop.id.toString()]=zp.EGm;b[wc.a.marginBottom.id.toString()]=zp.AGm;b[wc.a.marginLeft.id.toString()]=zp.CGm;b[wc.a.marginRight.id.toString()]=zp.DGm;return b}static Lnk(b,k,r,y){let R=!0;if(k===Jc.a.fUc||k===Jc.a.eUc)R=!1;return Rf.l(b,k,r,y,[ju.Nnk(R),ju.Mnk(R)])}static Nnk(b){return Rf.n("inch",b?"0":"-22","22",".1")}static Mnk(b){return Rf.n("centimeter",b?"0":"-55.8","55.8","1")}static vjb(b){let k=
null;switch(b){case Jc.a.fUc:case Jc.a.J1d:k=wc.a.marginTop;break;case Jc.a.eUc:case Jc.a.G1d:k=wc.a.marginBottom;break;case Jc.a.vZd:case Jc.a.H1d:k=wc.a.marginLeft;break;case Jc.a.wZd:case Jc.a.I1d:k=wc.a.marginRight}return k}}ju.U7=[Jc.a.fUc,Jc.a.eUc,Jc.a.vZd,Jc.a.wZd,Jc.a.J1d,Jc.a.G1d,Jc.a.H1d,Jc.a.I1d];ju.OY=null;Object(m.a)(ju,"MarginsDialog",yf.a,[]);class CE{static get vg(){return yf.a.Rx(CE.tl,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}
CE.tl="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(CE,"PaperSizeDialogHtml",null,[]);class Rq extends yf.a{constructor(b,k,r,y,R,aa){super();this.Ygb=aa;this.ita=(ta,Ya)=>{var xb=this.vjb(ta);ta=Ka.App.Eaa;this.Ee.hasProperty(xb)?(xb=this.Ee.getValue(xb),Ya[rc.a.Number]=Rg.a.Yba(xb,ta)):Ya[rc.a.Number]=0;Ya[rc.a.UnitType]=ta};this.bwa=(ta,Ya)=>{this.Ee.setValue(this.vjb(ta),Rg.a.PQa(Ya[rc.a.Number],Ya[rc.a.UnitType]));this.pp.xl()};this.Q3m=ta=>{let Ya=!1;1===ta&&(this.Ee.getValue(wc.a.ey)>=Ka.App.Wwa+this.iL.getValue(wc.a.marginTop)+
this.iL.getValue(wc.a.marginBottom)&&this.Ee.getValue(wc.a.Oo)>=Ka.App.Wwa+this.iL.getValue(wc.a.marginLeft)+this.iL.getValue(wc.a.marginRight)?OC(this.$M,this.Ee,Rq.YYa()):Ya=!0);this.dispose();Ya&&this.dwa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.P3m)};this.P3m=()=>{Va.a.instance.resolve("WordEditor.UI.IDialogFactory").iwh(this.$M,this.iL,this.ZO)};this.lg="PaperSizeDialog";this.iL=k.clone();this.$M=b.clone();this.Ee=b.clone();this.ZO=r;this.DR=!1;this.pp=R;this.vg=CE.vg;r&&(this.Nob=
Ko.a.i4a);this.Vh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.Q3m,null);this.LCb();this.Ygb&&(this.GIe=document.getElementById("DialogWidthSpinner"),this.xU(this.GIe))}eU(){this.Qih("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Jc.a.zZd,Jc.a.Y1d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Qih("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Jc.a.yZd,Jc.a.X1d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}LCb(){for(let b=
0;b<Rq.U7.length;b++)Mh.a.Vja(Rq.U7[b],this.bwa,this.ita);this.pp.iM("DialogWidthSpinner");this.pp.iM("DialogHeightSpinner")}dispose(){for(let b=0;b<Rq.U7.length;b++)Mh.a.Gsa(Rq.U7[b]);this.pp.VA("DialogWidthSpinner");this.pp.VA("DialogHeightSpinner");super.dispose()}Qih(b,k,r,y,R){r=Rq.bok(k,r,y,R);this.VVa(r,b,k)}VVa(b,k,r){k=document.getElementById(k);this.pp.rza(r,b);b=this.pp.yYa(r,"Medium");k.appendChild(b)}vjb(b){let k=null;switch(b){case Jc.a.yZd:case Jc.a.X1d:k=wc.a.ey;break;case Jc.a.zZd:case Jc.a.Y1d:k=
wc.a.Oo}return k}static YYa(){return Rq.OY||(Rq.OY=Rq.EKa())}static EKa(){const b={};b[wc.a.Oo.id.toString()]=zp.F3m;b[wc.a.ey.id.toString()]=zp.g3m;return b}static bok(b,k,r,y){return Rf.l(b,k,r,y,[Rq.dok(),Rq.cok()])}static dok(){return Rf.n("inch",Rq.S7i,Rq.Brm,Rq.N1n)}static cok(){return Rf.n("centimeter",Rq.S7i,Rq.zrm,Rq.M1n)}}Rq.U7=[Jc.a.zZd,Jc.a.yZd,Jc.a.Y1d,Jc.a.X1d];Rq.S7i="0";Rq.Brm="22";Rq.N1n=".1";Rq.M1n="1";Rq.zrm="55.8";Rq.OY=null;Object(m.a)(Rq,"PaperSizeDialog",yf.a,[]);class qH{constructor(){this.m8i=
this.vEi=this.uEi=this.W3m=this.LKf=!1}}Object(m.a)(qH,"Box4PropertySetChangedState",null,[]);class Vk{static get A5b(){return null!=Vk.emg?Vk.emg:Vk.emg=Va.a.instance.Pa("Box4.IIndentationCommands")}static get Lki(){return null!=Vk.rog?Vk.rog:Vk.rog=Va.a.instance.Pa("Box4.IJustificationCommands")}static get NX(){return null!=Vk.Crg?Vk.Crg:Vk.Crg=Va.a.instance.Pa("Box4.ISpacingCommands")}static Kki(b,k,r){Vk.Lki&&r&&(null===k||11!==r||10!==k&&9!==k)&&Vk.Lki.tD(r)}static tmi(b,k,r){Vk.NX&&r&&Vk.NX.jC(r)}static vGk(b,
k,r){k!=r&&Vk.NX.fec(r)}static Nqm(b,k,r){k!=r&&Vk.NX.u_c(r)}static quo(b,k,r){k!=r&&Vk.NX.X_c(r)}static Lqm(b,k,r){k!=r&&Vk.NX.t_c(r)}static m_d(b,k,r,y){Vk.NX&&void 0!==r&&null!==r&&(b=Vk.CHc(y),!b.LKf&&y.NN.hasProperty(td.a.IDa)&&y.NN.hasProperty(td.a.JDa)&&(k=y.NN.getValue(td.a.JDa),y=y.NN.getValue(td.a.IDa),b.LKf=!0,Vk.NX.$ga(1,k,y)))}static l_d(b,k,r,y){Vk.NX&&void 0!==r&&null!==r&&(b=Vk.CHc(y),!b.W3m&&y.NN.hasProperty(td.a.GDa)&&y.NN.hasProperty(td.a.HDa)&&(k=y.NN.getValue(td.a.HDa),y=y.NN.getValue(td.a.GDa),
b.LKf=!0,Vk.NX.$ga(0,k,y)))}static i_d(b,k,r,y){Vk.A5b&&void 0!==r&&null!==r&&(b=Vk.CHc(y),!b.uEi&&y.NN.hasProperty(td.a.Zaa)&&y.NN.hasProperty(td.a.$aa)&&(k=y.NN.getValue(td.a.$aa),y=y.NN.getValue(td.a.Zaa),b.uEi=!0,Vk.A5b.Y0i(1,k,y)))}static j_d(b,k,r,y){Vk.A5b&&void 0!==r&&null!==r&&(b=Vk.CHc(y),!b.vEi&&y.NN.hasProperty(td.a.pva)&&y.NN.hasProperty(td.a.qva)&&(k=y.NN.getValue(td.a.qva),y=y.NN.getValue(td.a.pva),b.vEi=!0,Vk.A5b.Y0i(0,k,y)))}static xfc(b,k,r,y){Vk.A5b&&void 0!==r&&null!==r&&(b=Vk.CHc(y),
!b.m8i&&y.NN.hasProperty(td.a.Eba)&&y.NN.hasProperty(td.a.G_)&&(k=0,y.NN.hasProperty(td.a.gJ)&&(k=y.NN.getValue(td.a.gJ)),r=y.NN.getValue(td.a.G_),y=y.NN.getValue(td.a.Eba),b.m8i=!0,Vk.A5b.G7d(k,r,y)))}static CHc(b){b.customData||(b.customData=new qH);return b.customData}}Object(m.a)(Vk,"ParagraphLevelPropertyChangedHandlers",null,[]);class Yi extends yf.a{constructor(b,k,r,y,R,aa){super();this.WK=this.Qad=!1;this.lg="ParagraphDialog";Yi.NX=r;this.iw=aa;this.$M=b.clone();this.Ee=b.clone();if(this.ZO=
k)this.Nob=Ko.a.i4a}eU(){Yi.Rih(Yi.X2n,Yi.t8i,Wa.a.xac,Wa.a.Qbc,Wa.a.C3a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.iw);Yi.Rih(Yi.W2n,Yi.s8i,Wa.a.AZd,Wa.a.i2d,Wa.a.e1c,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.iw);Yi.Enk(Yi.V2n,Yi.B2f,this.iw);Yi.Hnk(Yi.Ctm,Yi.oSd,this.iw)}Qnf(){for(let b=0;b<Yi.P9d.length;b++)Mh.a.Vja(Yi.P9d[b],Object(u.a)(this,this.bwa,"setAdvancedControlValue"),Object(u.a)(this,this.ita,"getAdvancedControlValue"));Mh.a.Vja(Wa.a.v1a,Object(u.a)(this,
this.ykb,"setDropDownValue"),Object(u.a)(this,this.wjb,"provideDropDownValue"));Mh.a.Vja(Wa.a.uWc,Object(u.a)(this,this.ykb,"setDropDownValue"),Object(u.a)(this,this.wjb,"provideDropDownValue"));this.iw.xl()}dispose(){if(!this.WK){for(let b=0;b<Yi.P9d.length;b++)Mh.a.Gsa(Yi.P9d[b]);Mh.a.Gsa(Wa.a.v1a);Mh.a.Gsa(Wa.a.uWc);this.iw.VA(Yi.t8i);this.iw.VA(Yi.s8i);this.iw.VA(Yi.B2f);this.iw.VA(Yi.oSd);super.dispose();this.WK=!0}}ita(b,k){switch(b){case Wa.a.Qbc:case Wa.a.i2d:var r=b===Wa.a.Qbc?td.a.JDa:td.a.HDa;
b=b===Wa.a.Qbc?td.a.IDa:td.a.GDa;this.Ee.hasProperty(r)&&this.Ee.hasProperty(b)?(b=this.Ee.getValue(b),1===b?(k[rc.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,k[rc.a.Number]=Number.NaN,k[rc.a.UnitType]=5):(r=this.Ee.getValue(r),b=2===b?4:5,k[rc.a.Number]=r,k[rc.a.UnitType]=b)):(k[rc.a.Text]="",k[rc.a.Number]=Number.NaN,k[rc.a.UnitType]=Ka.App.M6?4:5);break;case Wa.a.F1d:r=!1,this.Ee.hasProperty(td.a.ua)&&this.Ee.hasProperty(td.a.WZ)&&2===this.Ee.getValue(td.a.WZ)&&(this.Efi()||this.Qad)&&(b=Yi.XT.WLa(this.Ee),
b>=Yi.KAf&&(k[rc.a.Number]=b,r=!0)),r||(k[rc.a.Text]="",k[rc.a.Number]=Number.NaN),k[rc.a.UnitType]=0}}bwa(b,k){var r=k[rc.a.Text],y=k[rc.a.Number],R=k[rc.a.UnitType];switch(b){case Wa.a.xac:case Wa.a.AZd:r===Box4Intl.Box4Strings.L_SpinnerAuto?(r=0,y=1):(r=y,y=4===R?2:4);k=b===Wa.a.xac?td.a.IDa:td.a.GDa;this.Ee.setValue(b===Wa.a.xac?td.a.JDa:td.a.HDa,r);this.Ee.setValue(k,y);break;case Wa.a.C3a:case Wa.a.e1c:R=b===Wa.a.C3a?td.a.JDa:td.a.HDa;b=b===Wa.a.C3a?td.a.IDa:td.a.GDa;k=k.Increment;""===r||k&&
r===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ee.setValue(R,0),this.Ee.setValue(b,4)):y||k||(this.Ee.setValue(R,0),this.Ee.setValue(b,1));break;case Wa.a.uZd:this.v0i(y);break;case Wa.a.Y9d:""===r&&this.v0i(Yi.KAf)}this.iw.xl()}v0i(b){this.Ee.setValue(td.a.WZ,2);this.Ee.setValue(td.a.ua,Yi.XT.Hff(b));this.Qad=!0;this.iw.iM(Yi.oSd)}wjb(b,k){switch(b){case Wa.a.uWc:this.Ldn(k)}}Ldn(b){let k=0;var r=!1;this.Ee.hasProperty(td.a.ua)&&this.Ee.hasProperty(td.a.WZ)||(r=!0);r||(2!==this.Ee.getValue(td.a.WZ)&&
(r=!0),k=Yi.XT.WLa(this.Ee),k<Yi.KAf&&(r=!0));r||(r=Yi.Ywf,this.Qad||this.Efi()||(Gc.a.OZ(k,1)?r="1.00":Gc.a.OZ(k,1.5)?r="1.50":Gc.a.OZ(k,2)&&(r="2.00")),b[mf.a.SelectedItemId]=r)}ykb(b,k){switch(b){case Wa.a.v1a:this.nLn(k)}}nLn(b){b=b.MenuItemId;b===Yi.Ywf?(this.Ee.setValue(td.a.WZ,2),this.Ee.setValue(td.a.ua,Yi.XT.Hff(3))):(b=parseFloat(b),this.Ee.setValue(td.a.WZ,2),this.Ee.setValue(td.a.ua,Yi.XT.Hff(b)));this.Qad=!1;this.iw.iM(Yi.oSd);this.iw.iM(Yi.B2f)}s_d(b){1===b&&OC(this.$M,this.Ee,Yi.YYa());
this.dispose()}r_d(){const b=Va.a.instance.resolve("Box4.UI.IBox4DialogFactory"),k=Va.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");b.y_b(this.$M,null,this.ZO,k)}Efi(){if(!this.Ee.hasProperty(td.a.ua)||!this.Ee.hasProperty(td.a.WZ)||2!==this.Ee.getValue(td.a.WZ))return!1;const b=Yi.XT.WLa(this.Ee);return!Gc.a.OZ(b,1)&&!Gc.a.OZ(b,1.5)&&!Gc.a.OZ(b,2)}static get XT(){return null!=Yi.Bog?Yi.Bog:Yi.Bog=Va.a.instance.resolve("Box4.ILineSpacingHelper")}static YYa(){return Yi.OY||
(Yi.OY=Yi.EKa())}static EKa(){const b={};b[td.a.ua.id.toString()]=Vk.tmi;b[td.a.HDa.id.toString()]=Vk.l_d;b[td.a.GDa.id.toString()]=Vk.l_d;b[td.a.JDa.id.toString()]=Vk.m_d;b[td.a.IDa.id.toString()]=Vk.m_d;return b}static Rih(b,k,r,y,R,aa,ta){r=Yi.fok(k,r,y,R,aa);Yi.ewb(r,b,k,ta)}static Enk(b,k,r){const y=Yi.Fnk(k);Yi.ewb(y,b,k,r)}static Hnk(b,k,r){const y=Yi.Jnk(k);Yi.ewb(y,b,k,r)}static ewb(b,k,r,y){k=document.getElementById(k);y.rza(r,b);b=y.yYa(r,"Medium");k.appendChild(b)}static fok(b,k,r,y,R){return Rf.l(b,
k,r,R,[Yi.yok(),Yi.xok()],[Box4Intl.Box4Strings.L_SpinnerAuto],y,Yi.b$d)}static Fnk(b){return Rf.l(b,Wa.a.uZd,Wa.a.F1d,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[Yi.Gnk()],null,Wa.a.Y9d,Yi.b$d)}static Gnk(){return Rf.n("none","1","132",".5")}static yok(){return Rf.n("point","0","1584","1")}static xok(){return Rf.n("line","0","327","1")}static Jnk(b){const k=Rf.e("DdlLineSpacing_Single","1.00",Wa.a.v1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),r=Rf.e("DdlLineSpacing_1.5",
"1.50",Wa.a.v1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),y=Rf.e("DdlLineSpacing_Double","2.00",Wa.a.v1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),R=Rf.e("DdlLineSpacing_Multiple",Yi.Ywf,Wa.a.v1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return Rf.k(b,Wa.a.v1a,Wa.a.uWc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,Yi.Dtm,[k,r,y,R])}}Yi.Dtm=150;Yi.b$d=70;Yi.KAf=1;Yi.t8i="DialogSpacingBeforeSpinner";Yi.s8i="DialogSpacingAfterSpinner";
Yi.B2f="DialogLineSpacingAtSpinner";Yi.X2n="ParagraphDialogSpacingBeforeSpinnerContainer";Yi.W2n="ParagraphDialogSpacingAfterSpinnerContainer";Yi.V2n="ParagraphDialogLineSpacingAtSpinnerContainer";Yi.Ctm="ParagraphDialogLineSpacingContainer";Yi.oSd="ParagraphDialogLineSpacingSelect";Yi.Ywf="multiple";Yi.P9d=[Wa.a.xac,Wa.a.AZd,Wa.a.uZd,Wa.a.Qbc,Wa.a.i2d,Wa.a.F1d,Wa.a.Y9d,Wa.a.e1c,Wa.a.C3a];Yi.NX=null;Yi.OY=null;Object(m.a)(Yi,"ParagraphDialog",yf.a,[]);class DE{static get vg(){return yf.a.Rx(DE.tl,
Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}DE.tl="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(m.a)(DE,"ParagraphDialogHtml",null,[]);const yF=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,zF=(b,k,r,y)=>{let R=Ka.App.Eaa;b.hasProperty(k)&&b.hasProperty(r)&&!y?(k=b.getValue(k),b=b.getValue(r),k?2===b?R=2:k=Rg.a.Yba(k,R):Ka.App.M6&&(R=2)):(k=Number.NaN,Ka.App.M6&&(R=2));return{wfc:k,t4a:R}},uL=b=>{let k="0";b.hasProperty(td.a.gJ)&&(b=b.getValue(td.a.gJ),(1===b||2===b||!b)&&(1===b?k="1":2===b?k="2":b||(k="0")));return k},EE=(b,k)=>{if(k.hasProperty(td.a.gJ)&&2===k.getValue(td.a.gJ)&&
k.hasProperty(td.a.G_)&&k.hasProperty(td.a.Eba)&&b.hasProperty(td.a.$aa)&&b.hasProperty(td.a.Zaa)){var r=b.getValue(td.a.$aa),y=b.getValue(td.a.Zaa);r=(new Tk.a(y,r)).mt;y=k.getValue(td.a.G_);k=k.getValue(td.a.Eba);k=(new Tk.a(k,y)).mt;b.setValue(td.a.$aa,r+k);b.setValue(td.a.Zaa,1)}},uH=(b,k)=>{var r;if(r=rH(b,k))r=k.hasProperty(td.a.G_)&&k.hasProperty(td.a.Eba);if(r){r=k.getValue(td.a.G_);const y=k.getValue(td.a.Eba);r=(new Tk.a(y,r)).mt;return sH(k)+tH(k)+b.getValue(wc.a.marginRight)+b.getValue(wc.a.marginLeft)+
r+Ka.App.Wwa<=b.getValue(wc.a.Oo)}return rH(b,k)?sH(k)+tH(k)+b.getValue(wc.a.marginRight)+b.getValue(wc.a.marginLeft)+Ka.App.Wwa<=b.getValue(wc.a.Oo):!0},sH=b=>{const k=b.getValue(td.a.$aa);b=b.getValue(td.a.Zaa);return(new Tk.a(b,k)).mt},tH=b=>{const k=b.getValue(td.a.qva);b=b.getValue(td.a.pva);return(new Tk.a(b,k)).mt},rH=(b,k)=>k.hasProperty(td.a.$aa)&&k.hasProperty(td.a.Zaa)&&k.hasProperty(td.a.qva)&&k.hasProperty(td.a.pva)&&b.hasProperty(wc.a.marginLeft)&&b.hasProperty(wc.a.marginRight)&&b.hasProperty(wc.a.Oo),
vL=b=>b.hasProperty(td.a.IUc)?b.getValue(td.a.IUc):!1,wL=b=>b.hasProperty(Jj.a.Yh)?b.getValue(Jj.a.Yh):!1,xL=b=>b.hasProperty(Jj.a.DM)?b.getValue(Jj.a.DM):!1,yL=b=>b.hasProperty(Jj.a.keepTogether)?b.getValue(Jj.a.keepTogether):!1;class hr extends Yi{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){super(b,r,aa,ta,Ya,Mb);this.vx=cc;this.vg=DE.vg;this.iL=k.clone();this.Vh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(u.a)(this,this.s_d,"paragraphDialogResultHandler"),null);this.Qnf();b=document.getElementById("ParagraphDialogAlignmentControl-Medium");
this.xU(b)}eU(){hr.Hih("ParagraphDialogIndentLeftSpinnerContainer","DialogIndentLeftSpinner",Wa.a.z5b,Wa.a.uIb,Wa.a.Afc,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.iw);hr.Hih("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",Wa.a.pMd,Wa.a.iWc,Wa.a.X9d,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.iw);hr.Cok(this.iw);const b=this.Ee.getValue(td.a.Zs);hr.imk(b,this.iw);hr.Eok(this.iw);super.eU()}Qnf(){for(let b=0;b<hr.rMd.length;b++)Mh.a.Vja(hr.rMd[b],
Object(u.a)(this,this.bwa,"setAdvancedControlValue"),Object(u.a)(this,this.ita,"getAdvancedControlValue"));Mh.a.Vja(Wa.a.tna,Object(u.a)(this,this.ykb,"setDropDownValue"),Object(u.a)(this,this.wjb,"provideDropDownValue"));Mh.a.Vja(Wa.a.Obc,Object(u.a)(this,this.ykb,"setDropDownValue"),Object(u.a)(this,this.wjb,"provideDropDownValue"));Mh.a.Vja(Wa.a.w1a,Object(u.a)(this,this.ykb,"setDropDownValue"),Object(u.a)(this,this.wjb,"provideDropDownValue"));Mh.a.Vja(Wa.a.Rbc,Object(u.a)(this,this.ykb,"setDropDownValue"),
Object(u.a)(this,this.wjb,"provideDropDownValue"));super.Qnf()}dispose(){if(!this.Cl){for(let b=0;b<hr.rMd.length;b++)Mh.a.Gsa(hr.rMd[b]);Mh.a.Gsa(Wa.a.tna);Mh.a.Gsa(Wa.a.Obc);Mh.a.Gsa(Wa.a.w1a);Mh.a.Gsa(Wa.a.Rbc);this.iw.VA("DialogIndentLeftSpinner");this.iw.VA("DialogIndentRightSpinner");this.iw.VA("ParagraphDialogAlignmentControl");this.iw.VA("ParagraphDialogSpecialIndentSelect");this.iw.VA("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}ita(b,k){var r=!1;switch(b){case Wa.a.uIb:case Wa.a.iWc:var y=
b===Wa.a.uIb?td.a.$aa:td.a.qva,R=b===Wa.a.uIb?td.a.Zaa:td.a.pva;r=Ka.App.Eaa;this.Ee.hasProperty(y)&&this.Ee.hasProperty(R)?(y=this.Ee.getValue(y),R=this.Ee.getValue(R),y?2===R?r=2:y=Rg.a.Yba(y,r):Ka.App.M6&&(r=2),k[rc.a.Number]=y):(k[rc.a.Text]="",k[rc.a.Number]=Number.NaN,Ka.App.M6&&(r=2));k[rc.a.UnitType]=r;r=!0;break;case Wa.a.j2d:y=td.a.G_;R=td.a.Eba;let aa=!1;r=Ka.App.Eaa;this.Ee.hasProperty(td.a.gJ)&&(aa=!this.Ee.getValue(td.a.gJ));this.Ee.hasProperty(y)&&this.Ee.hasProperty(R)&&!aa?(y=this.Ee.getValue(y),
R=this.Ee.getValue(R),y?2===R?r=2:y=Rg.a.Yba(y,r):Ka.App.M6&&(r=2),k[rc.a.Number]=y):(k[rc.a.Text]="",k[rc.a.Number]=Number.NaN,Ka.App.M6&&(r=2));k[rc.a.UnitType]=r;r=!0}r||super.ita(b,k)}bwa(b,k){var r=k[rc.a.Text],y=k[rc.a.Number],R=k[rc.a.UnitType],aa=!1;switch(b){case Wa.a.z5b:case Wa.a.pMd:r=y;2===R?aa=2:(aa=1,r=Rg.a.PQa(y,R));y=b===Wa.a.z5b?td.a.Zaa:td.a.pva;this.Ee.setValue(b===Wa.a.z5b?td.a.$aa:td.a.qva,r);this.Ee.setValue(y,aa);aa=!0;break;case Wa.a.Afc:case Wa.a.X9d:""===r&&(y=2===R?2:1,
r=b===Wa.a.Afc?td.a.Zaa:td.a.pva,this.Ee.setValue(b===Wa.a.Afc?td.a.$aa:td.a.qva,0),this.Ee.setValue(r,y));aa=!0;break;case Wa.a.C3a:case Wa.a.e1c:R=b===Wa.a.C3a?td.a.JDa:td.a.HDa;aa=b===Wa.a.C3a?td.a.IDa:td.a.GDa;const ta=k.Increment;""===r||ta&&r===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ee.setValue(R,0),this.Ee.setValue(aa,4)):y||ta||(this.Ee.setValue(R,0),this.Ee.setValue(aa,1));aa=!0;break;case Wa.a.BZd:""===r&&this.Ee.setValue(td.a.gJ,1);this.I1i(y,R);aa=!0;break;case Wa.a.a$d:""===r&&(this.Ee.setValue(td.a.gJ,
1),this.I1i(.1,R)),aa=!0}aa||super.bwa(b,k)}I1i(b,k){let r=b,y;2===k?y=2:(y=1,r=Rg.a.PQa(b,k));this.Ee.setValue(td.a.G_,r);this.Ee.setValue(td.a.Eba,y);this.iw.iM("ParagraphDialogSpecialIndentBySpinner")}wjb(b,k){let r=!1;switch(b){case Wa.a.Obc:this.Kdn(k);r=!0;break;case Wa.a.Rbc:this.Mdn(k),r=!0}r||super.wjb(b,k)}Mdn(b){let k="0";if(this.Ee.hasProperty(td.a.gJ)){const r=this.Ee.getValue(td.a.gJ);(1===r||2===r||!r)&&(1===r?k="1":2===r?k="2":r||(k="0"))}b[mf.a.SelectedItemId]=k}Kdn(b){if(this.Ee.hasProperty(td.a.Zs)){let k=
this.Ee.getValue(td.a.Zs);if(10===k||9===k)k=11;yF(k)&&(b[mf.a.SelectedItemId]=k.toString())}}ykb(b,k){let r=!1;switch(b){case Wa.a.tna:this.lPn(k);r=!0;break;case Wa.a.w1a:this.iRn(k),r=!0}r||super.ykb(b,k)}iRn(b){b=parseInt(b.MenuItemId);this.Ee.setValue(td.a.gJ,b);this.iw.iM("ParagraphDialogSpecialIndentSelect");b?(this.Ee.setValue(td.a.Eba,1),this.Ee.hasProperty(td.a.G_)?this.Ee.getValue(td.a.G_)||this.Ee.setValue(td.a.G_,720):this.Ee.setValue(td.a.G_,720)):(this.Ee.setValue(td.a.Eba,1),this.Ee.setValue(td.a.G_,
0));this.iw.iM("ParagraphDialogSpecialIndentBySpinner")}lPn(b){this.Ee.setValue(td.a.Zs,parseInt(b.MenuItemId));this.iw.iM("ParagraphDialogAlignmentControl")}s_d(b){let k="";1===b&&(EE(this.$M,this.$M),EE(this.Ee,this.$M),uH(this.iL,this.Ee)?OC(this.$M,this.Ee,hr.Qjf()):k=""!==k?k:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==k&&this.dwa(k,Object(u.a)(this,this.r_d,"paragraphDialogCreator"))}r_d(){Va.a.instance.resolve("Box4.UI.IBox4DialogFactory").y_b(this.$M,this.iL,this.ZO,
this.vx)}static Qjf(){return Yi.OY||(Yi.OY=hr.B1e())}static B1e(){const b=Yi.YYa();b[td.a.Zs.id.toString()]=Vk.Kki;b[td.a.Zaa.id.toString()]=Vk.i_d;b[td.a.$aa.id.toString()]=Vk.i_d;b[td.a.pva.id.toString()]=Vk.j_d;b[td.a.qva.id.toString()]=Vk.j_d;b[td.a.gJ.id.toString()]=Vk.xfc;b[td.a.Eba.id.toString()]=Vk.xfc;b[td.a.G_.id.toString()]=Vk.xfc;return b}static Hih(b,k,r,y,R,aa,ta){r=hr.tnk(k,r,y,R,aa);Yi.ewb(r,b,k,ta)}static Cok(b){const k=hr.Dok();Yi.ewb(k,"ParagraphDialogSpecialIndentBySpinnerContainer",
"ParagraphDialogSpecialIndentBySpinner",b)}static imk(b,k){b=hr.jmk(b);Yi.ewb(b,"ParagraphDialogAlignmentContainer","ParagraphDialogAlignmentControl",k)}static Eok(b){const k=hr.Fok();Yi.ewb(k,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",b)}static tnk(b,k,r,y,R){return Rf.l(b,k,r,R,[hr.wnk(),hr.vnk(),hr.unk()],null,y,Yi.b$d)}static Dok(){return Rf.l("ParagraphDialogSpecialIndentBySpinner",Wa.a.BZd,Wa.a.j2d,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
[hr.Bok(),hr.Aok(),hr.zok()],null,Wa.a.a$d,Yi.b$d)}static Bok(){return Rf.n("inch","0","22",".1")}static Aok(){return Rf.n("centimeter","0","55.88","1")}static zok(){return Rf.n("character","0","316.8",".5")}static wnk(){return Rf.n("inch","-11","22",".1")}static vnk(){return Rf.n("centimeter","-27.94","55.88","1")}static unk(){return Rf.n("character","-316.8","316.8",".5")}static jmk(b){return Rf.k("ParagraphDialogAlignmentControl",Wa.a.tna,Wa.a.Obc,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
150,hr.ENk(b))}static ENk(b){var k=Rf.e("DdlAlignment_Left","1",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),r=Rf.e("DdlAlignment_Center","2",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const y=Rf.e("DdlAlignment_Right","3",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),R=Rf.e("DdlAlignment_Justified","6",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),aa=Rf.e("DdlAlignment_Kashida","11",Wa.a.tna.toString(),
Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),ta=Rf.e("DdlAlignment_Distribued","7",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),Ya=Rf.e("DdlAlignment_ThaiDistribued","13",Wa.a.tna.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);k=[k,r,y,R,ta];r=5;if(n.AFrameworkApplication.lcid===yh.a.qg("AR-SA").LCID||11===b)k[r]=aa,r=6;if(n.AFrameworkApplication.lcid===yh.a.qg("TH-TH").LCID||13===b)k[r]=Ya;return k}static Fok(){const b=Rf.e("DdlSpecialIndent_None",
"0",Wa.a.w1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),k=Rf.e("DdlSpecialIndent_FirstLine","1",Wa.a.w1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),r=Rf.e("DdlSpecialIndent_Hanging","2",Wa.a.w1a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return Rf.k("ParagraphDialogSpecialIndentSelect",Wa.a.w1a,Wa.a.Rbc,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[b,k,r])}}hr.rMd=[Wa.a.z5b,Wa.a.pMd,Wa.a.w1a,Wa.a.BZd,Wa.a.tna,Wa.a.uIb,
Wa.a.iWc,Wa.a.Rbc,Wa.a.j2d,Wa.a.Obc,Wa.a.Afc,Wa.a.X9d,Wa.a.a$d];Object(m.a)(hr,"ParagraphDialog",Yi,[]);class vH extends Cs{constructor(b,k){super(b,k,!0);this.h7a=null;this.nLi=(r,y)=>{this.Gf.Sr&&(r?(r="string"===typeof y.styleText?y.styleText:null,(y=this.emj(r))?(this.h7a=y,y=this.rgf(this.KC),r=this.yAb(r,y),this.h7a=null,this.DR=!1,this.hide(),this.Vh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nLi,r),this.DR=!0):(this.hide(),y=new Map,y.set("Source","ReactCreateNewStyleDialog"),
y.set("Action","CreateStyle"),Ga.Health.instance.recordKpiUsage(Jo.a.$mb,0,Jo.a.LB,y),this.ryc(r,this.ZR)||(r=new Map,r.set("Source","ReactCreateNewStyleDialog"),r.set("Action","CreateStyle"),r=Object.assign(new Xa.a,{extendedProperties:r}),Ga.Health.instance.recordKpiFailure(Jo.a.$mb,"CreateStyleFailed",!1,!0,r)))):this.hide(),this.Gf.RX())};this.xz&&this.ZR&&(this.K8=!1,b=this.rgf(this.KC),b=this.yAb(b,b),this.Vh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nLi,b))}yAb(b,k){var r=this.ZR.ia(Te.a.fontSize,
zj.a.VJ)>=2*Cs.QUd;const y=oc.a.vdf(this.ZR,"97%",Cs.QUd,!1,!0,r);y["padding-left"]=Cs.u$i+"px";r||(y["line-height"]=Cs.t$i+"px");r={};r.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;r.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;r.styleName=b;r.previewContainerText=k;r.getPreviewStyle=()=>y;this.h7a&&(r.errorMessage=this.h7a);return{["id"]:this.lg,["bodyControls"]:r}}}Object(m.a)(vH,"ReactCreateNewStyleDialog",Cs,[]);class gB extends yf.a{constructor(b,
k=!1,r){super(!1,!1,k);let y=k=this.pz=null;this.lg=gB.id;this.Gf=b.view;this.nl=r;this.Gf&&(y=this.Gf.Cb);y&&y.ib&&y.ib.kb&&(k=y.ib.kb.Qa);k?(b=k.node)?(this.xz=gB.qh.pu(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}Wro(b){var k=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.Zil();const y=""===A.a.Nva(b),R=b.length>gB.LHm;r=r.includes(b);k=
k.test(b);b=b.startsWith("_");let aa=null;if(y||R||r||b||!k)aa=y?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:R?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:k?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return aa}abm(b,k){return b?b===k:!1}static get qh(){return lk.PageNavigator.instance}Zil(){const b=this.nl.nHc(!1);let k=
[];for(let r=0;r<b.count;r++){let y=b.J(r).ia(wc.a.Rs,"");k.push(y)}return k}}gB.id="BookmarkEditDialog";gB.LHm=40;Object(m.a)(gB,"AEditBookmarkDialog",yf.a,[]);class wH extends gB{constructor(b,k,r){super(b,!0,r);this.h7a=null;this.CSa="wwaengidc";this.Bqc="ReactCreateEditBookmarkNameDialog";this.xOg="EditBookmarkName";this.Ned="EditBookmarkNameDialog";this.eje=k;this.nl=r;this.xz&&(this.K8=!1,b=this.yAb(k.properties.ia(wc.a.Rs,null)),this.Vh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pLi.bind(this),
b))}pLi(b,k){if(this.Gf.Sr){if(b){b="string"===typeof k.BookmarkText?k.BookmarkText:null;var r;this.eje.hasProperty(wc.a.Rs)?r=this.eje.getValue(wc.a.Rs):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");k=this.Wro(b);this.abm(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):k?(this.h7a=k,r=this.yAb(b),this.h7a=null,this.DR=!1,this.hide(),this.Vh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pLi.bind(this),
r),this.DR=!0):(this.hide(),r=new Map,r.set("Source",this.Bqc),r.set("Action",this.xOg),Ga.Health.instance.recordKpiUsage(this.Ned,0,this.CSa,r),this.nuk(b)||(r=new Map,r.set("Source",this.Bqc),r.set("Action",this.xOg),r=Object.assign(new Xa.a,{extendedProperties:r}),Ga.Health.instance.recordKpiFailure(this.Ned,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.Gf.RX()}}nuk(b){b=A.a.Nva(A.a.GZ(b));try{const k=this.nl.vhj(this.eje,b);if(k)v.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");
else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),k}catch(k){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",k.Message),!1}}yAb(b){const k={};k.bookmarkValue=b;k.errorMessage=this.h7a;k.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.lg,["bodyControls"]:k}}}Object(m.a)(wH,"ReactEditBookmarkNameDialog",gB,[]);const FE=(b,k,r)=>{const y=[];
if(b.length!==k.length||r&&r.length!==k.length)return y;for(let R=0;R<b.length;R++){const aa={};aa.key=k[R];aa.text=b[R];aa.type="AppComboBoxItem";r&&(aa.ariaLabel=r[R]);y[R]=aa}return y},sz=(b,k,r,y,R)=>({["unitType"]:b,["unitPlaceholder"]:A.a.dMf(k),["minValue"]:r,["maxValue"]:y,["step"]:R}),AF=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),xH=(b,k,r)=>{let y=!1;b.hasProperty(k)&&
b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,k=5,y=!0):(b=b.getValue(k),k=2===r?4:5)):(b=Number.NaN,k=Ka.App.M6?4:5);return{wfc:b,t4a:k,b6b:y}};class hB{constructor(){this.OY=null}GEl(b){const k={};k.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=sz("Point",5,0,1584,1),y=sz("Line",4,0,327,1),R=[r,y];y=AF();var aa=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({wfc:Ya,t4a:ta,b6b:xb}=
xH(b,td.a.JDa,td.a.IDa));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Rg.a.j_b(ta),["validUnits"]:R,["numberFormatInfo"]:y,["validReservedValues"]:aa};xb?ta.reservedValue=aa[0]:ta.value=isNaN(Ya)?"":Ya;k.beforeSpacingSpinButtonProps=ta;({wfc:Ya,t4a:ta,b6b:xb}=xH(b,td.a.HDa,td.a.GDa));R={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Rg.a.j_b(ta),["validUnits"]:R,["numberFormatInfo"]:y,["validReservedValues"]:aa};xb?R.reservedValue=aa[0]:R.value=isNaN(Ya)?"":Ya;k.afterSpacingSpinButtonProps=R;if(aa=R=b.hasProperty(td.a.ua))aa=hB.XT.WLa(b),aa=b.hasProperty(td.a.ua)&&b.hasProperty(td.a.WZ)&&2===b.getValue(td.a.WZ)?!Gc.a.OZ(aa,1)&&!Gc.a.OZ(aa,1.5)&&!Gc.a.OZ(aa,2):!1;if(R){var Ya=hB.XT.WLa(b);
R=0;var xb=!1;b.hasProperty(td.a.ua)&&b.hasProperty(td.a.WZ)||(xb=!0);xb||(2!==b.getValue(td.a.WZ)&&(xb=!0),R=Ya,1>R&&(xb=!0));xb?R="":(Ya="multiple",aa||(Gc.a.OZ(R,1)?Ya="1.00":Gc.a.OZ(R,1.5)?Ya="1.50":Gc.a.OZ(R,2)&&(Ya="2.00")),R=Ya)}else R=null;Ya={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:FE([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};R?Ya.selectedKey=R:Ya.defaultSelectedKey="";k.lineSpacingComboBoxProps=Ya;R=0;Ya=!1;b.hasProperty(td.a.ua)&&b.hasProperty(td.a.WZ)&&2===b.getValue(td.a.WZ)&&aa&&(R=hB.XT.WLa(b),Ya=!0,1>R&&(R=Number.NaN));b=[sz("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:y,["validReservedValues"]:r};Ya?b.value=R:b.reservedValue=r[0];k.atSpinButtonProps=b;return k}YYa(){return this.OY||(this.OY=this.EKa())}EKa(){const b={};b[td.a.ua.id.toString()]=Vk.tmi;b[td.a.HDa.id.toString()]=Vk.l_d;b[td.a.GDa.id.toString()]=Vk.l_d;b[td.a.JDa.id.toString()]=Vk.m_d;b[td.a.IDa.id.toString()]=
Vk.m_d;return b}static get XT(){return null!=hB.Aog?hB.Aog:hB.Aog=Va.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(hB,"ReactParagraphDialog",null,[]);class yH extends yf.a{constructor(b,k,r,y,R,aa=Va.a.instance.$a("Box4.Settings.SpacingSettings")){var ta,Ya;super(!1,!1,!0);this.wO=this.l7g=null;this.r_d=()=>{Va.a.instance.resolve("Box4.UI.IBox4DialogFactory").y_b(this.$M,this.iL,this.ZO,this.vx)};this.s_d=(cc,jc)=>{var Mc,fd,Td,ne;if(jc&&(1===cc||2===cc)){if(jc.alignmentComboBoxProps){var ye=
parseInt(jc.alignmentComboBoxProps.selectedKey);isNaN(ye)||yF(ye)&&this.Ee.setValue(td.a.Zs,ye)}var ff=jc.bySpinButtonProps;ye=!!ff&&""!==ff.value;var Gd=jc.didChangeSpecialIndentationComboBoxValue;if(jc.specialIndentationComboBoxProps){var oe=parseInt(jc.specialIndentationComboBoxProps.selectedKey);1!==oe&&2!==oe&&oe||!(oe||Gd||ye)||this.Ee.setValue(td.a.gJ,oe)}if(ff){oe=ff.value;ff=Rg.a.Exb(ff.unitType.toLowerCase());let ze;0<=oe||(oe=0);2===ff?ze=2:(ze=1,oe=Rg.a.PQa(oe,ff));if(ye||Gd)this.Ee.setValue(td.a.G_,
oe),this.Ee.setValue(td.a.Eba,ze)}jc.beforeTextSpinButtonProps&&(Gd=jc.beforeTextSpinButtonProps,ye=Rg.a.Exb(Gd.unitType.toLowerCase()),Gd=""===Gd.value?Number.NaN:Gd.value,isNaN(Gd)||(oe=Gd,2===ye?ff=2:(ff=1,oe=Rg.a.PQa(Gd,ye)),this.Ee.setValue(td.a.$aa,oe),this.Ee.setValue(td.a.Zaa,ff)));jc.afterTextSpinButtonProps&&(Gd=jc.afterTextSpinButtonProps,ye=Rg.a.Exb(Gd.unitType.toLowerCase()),Gd=""===Gd.value?Number.NaN:Gd.value,isNaN(Gd)||(oe=Gd,2===ye?ff=2:(ff=1,oe=Rg.a.PQa(Gd,ye)),this.Ee.setValue(td.a.qva,
oe),this.Ee.setValue(td.a.pva,ff)));jc.beforeSpacingSpinButtonProps&&(ye=jc.beforeSpacingSpinButtonProps,Gd=Rg.a.Exb(ye.unitType.toLowerCase()),oe=ye.reservedValue,""!==ye.value&&(oe===Box4Intl.Box4Strings.L_SpinnerAuto?(Gd=1,ye=0):(Gd=4===Gd?2:4,ye=ye.value),this.Ee.setValue(td.a.JDa,ye),this.Ee.setValue(td.a.IDa,Gd)));jc.afterSpacingSpinButtonProps&&(ye=jc.afterSpacingSpinButtonProps,Gd=Rg.a.Exb(ye.unitType.toLowerCase()),oe=ye.reservedValue,""!==ye.value&&(oe===Box4Intl.Box4Strings.L_SpinnerAuto?
(Gd=1,ye=0):(Gd=4===Gd?2:4,ye=ye.value),this.Ee.setValue(td.a.HDa,ye),this.Ee.setValue(td.a.GDa,Gd)));if(jc.atSpinButtonProps||jc.lineSpacingComboBoxProps)if(ye=jc.atSpinButtonProps.value,1<ye)this.Ee.setValue(td.a.ua,ye),this.Ee.setValue(td.a.WZ,2);else if(ye=jc.lineSpacingComboBoxProps.selectedKey)ye="1.00"===ye?1:"1.50"===ye?1.5:"2.00"===ye?2:0,ye=1<=ye?ye:1,this.Ee.setValue(td.a.ua,ye),this.Ee.setValue(td.a.WZ,2);(null===(Mc=this.wO)||void 0===Mc?0:Mc.mua)&&jc.contextualSpacingCheckboxProps&&
this.Ee.setValue(td.a.IUc,jc.contextualSpacingCheckboxProps.checked);(null===(fd=this.vx)||void 0===fd?0:fd.UCa)&&jc.keepWithNextCheckboxProps&&this.Ee.setValue(Jj.a.Yh,jc.keepWithNextCheckboxProps.checked);(null===(Td=this.vx)||void 0===Td?0:Td.VFa)&&jc.widowOrphanCheckboxProps&&this.Ee.setValue(Jj.a.DM,jc.widowOrphanCheckboxProps.checked);(null===(ne=this.vx)||void 0===ne?0:ne.Cfa)&&jc.keepTogetherCheckboxProps&&this.Ee.setValue(Jj.a.keepTogether,jc.keepTogetherCheckboxProps.checked);EE(this.$M,
this.$M);EE(this.Ee,this.$M);jc="";uH(this.iL,this.Ee)?OC(this.$M,this.Ee,this.Qjf(this.jHe?this.jHe.EKa():{})):jc=""!==jc?jc:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==jc?this.dwa(jc,this.r_d):2===cc&&(Ib.c(Jc.a.Yec,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Xb(Jc.a.Yec,2,null))}};aa.execute(cc=>this.wO=cc);this.$M=b.clone();this.Ee=b.clone();this.iL=k.clone();this.ZO=r;this.ga=y;this.jHe=new hB;this.vx=R;b=this.jHe.GEl(this.Ee);k=sz("Inch",3,
-11,22,.1);r=sz("Inch",3,0,22,.1);aa=sz("Centimeter",1,-27.94,55.88,1);y=sz("Centimeter",1,0,55.88,1);var xb=sz("Character",2,-316.8,316.8,.5);R=sz("Character",2,0,316.8,.5);k=[k,aa,xb];y=[r,y,R];r=AF();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};aa=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,
Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];xb=["1","2","3","6","7"];let Mb=5;R=this.Ee.hasProperty(td.a.Zs)?this.Ee.getValue(td.a.Zs):0;if(10===R||9===R)R=11;if(n.AFrameworkApplication.lcid===yh.a.qg("AR-SA").LCID||11===R)b.isKashidaSupported=!0,aa[Mb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,xb[Mb]="11",Mb=6;if(n.AFrameworkApplication.lcid===yh.a.qg("TH-TH").LCID||13===R)b.isThaiSupported=!0,aa[Mb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,
xb[Mb]="13";aa={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:FE(aa,xb),["allowFreeForm"]:!1};yF(R)?aa.selectedKey=R.toString():aa.defaultSelectedKey="";b.alignmentComboBoxProps=aa;(null===(ta=this.vx)||void 0===ta?0:ta.Nlf)||(b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,
["forId"]:"PaginationGroup"});this.vx.UCa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:wL(this.Ee)},b.keepWithNextCheckboxProps=ta);this.vx.VFa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:xL(this.Ee)},b.widowOrphanCheckboxProps=ta);this.vx.Cfa&&(ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:yL(this.Ee)},b.keepTogetherCheckboxProps=ta);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};R=uL(this.Ee);ta="0"===R;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:FE([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:R,["allowFreeForm"]:!1};aa=Ka.App.Eaa;R=0;({wfc:R,t4a:aa}=zF(this.Ee,td.a.G_,td.a.Eba,ta));ta={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:Rg.a.j_b(aa),["validUnits"]:y,["numberFormatInfo"]:r};ta=this.c_f(R,ta);b.bySpinButtonProps=ta;y=Ka.App.Eaa;ta=0;({wfc:ta,t4a:y}=zF(this.Ee,td.a.$aa,td.a.Zaa,!1));y={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Rg.a.j_b(y),["validUnits"]:k,["numberFormatInfo"]:r};y=this.c_f(ta,y);b.beforeTextSpinButtonProps=y;y=Ka.App.Eaa;ta=0;({wfc:ta,
t4a:y}=zF(this.Ee,td.a.qva,td.a.pva,!1));k={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Rg.a.j_b(y),["validUnits"]:k,["numberFormatInfo"]:r};k=this.c_f(ta,k);b.afterTextSpinButtonProps=k;k={["id"]:"ParagraphDialog",["bodyControls"]:b};if(null===(Ya=this.wO)||void 0===Ya?0:Ya.mua)Ya={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:vL(this.Ee)},b.contextualSpacingCheckboxProps=Ya;k.dialogButtonsOption=9;k.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};k.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Vh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.s_d,k)}Qjf(b){return this.l7g||(this.l7g=this.B1e(b))}B1e(b){var k,
r,y,R;b[td.a.Zs.id.toString()]=Vk.Kki;b[td.a.Zaa.id.toString()]=Vk.i_d;b[td.a.$aa.id.toString()]=Vk.i_d;b[td.a.pva.id.toString()]=Vk.j_d;b[td.a.qva.id.toString()]=Vk.j_d;b[td.a.gJ.id.toString()]=Vk.xfc;b[td.a.Eba.id.toString()]=Vk.xfc;b[td.a.G_.id.toString()]=Vk.xfc;if(null===(k=this.wO)||void 0===k?0:k.mua)b[td.a.IUc.id.toString()]=Vk.vGk;if(null===(r=this.vx)||void 0===r?0:r.UCa)b[Jj.a.Yh.id.toString()]=Vk.Nqm;if(null===(y=this.vx)||void 0===y?0:y.VFa)b[Jj.a.DM.id.toString()]=Vk.quo;if(null===(R=
this.vx)||void 0===R?0:R.Cfa)b[Jj.a.keepTogether.id.toString()]=Vk.Lqm;return b}c_f(b,k){k.value=isNaN(b)?"":b;return k}}Object(m.a)(yH,"WordReactParagraphDialog",yf.a,[]);class GE{static get vg(){return yf.a.Rx(GE.tl,"Count: ","Width: ","Spacing: ")}}GE.tl="<div class='WACDialogRow' id='RowColumns'> <div class='WacDialogLabels' id='ColumnsDialogLabels'> <label id='ColumnsDialogCount' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='ColumnsDialogWidth' class='DialogSpinnerLabel' >{1}</label> <br/> <label id='ColumnsDialogSpacing class='DialogSpinnerLabel' >{2}</label> <br/> </div> <div class='WacSpinnerBoxes' id='ColumnsDialogSpinners'> <div id='ColumnsDialogCountSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogSpacingSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(GE,"ColumnsDialogHtml",null,[]);class rm extends yf.a{constructor(b,k,r,y){super();this.lg="ColumnsDialog";this.iL=k.clone();this.$M=b.clone();this.Ee=b.clone();this.ZO=r;this.DR=!1;this.pp=y;this.vg=GE.vg;r&&(this.Nob=Ko.a.i4a);this.Vh("Columns",Object(u.a)(this,this.tBk,"columnsDialogResultHandler"),null);this.LCb()}eU(){this.OUe("ColumnsDialogCountSpinnerContainer","DialogCountSpinner",Jc.a.mZd,Jc.a.t1d,"Columns Count",0,rm.L1n,rm.Arm,rm.JIk);this.OUe("ColumnsDialogWidthSpinnerContainer",
"DialogWidthSpinner",Jc.a.oZd,Jc.a.v1d,"Columns Width",Ka.App.Eaa,rm.J9d,rm.LRd,rm.ruo);this.OUe("ColumnsDialogSpacingSpinnerContainer","DialogSpacingSpinner",Jc.a.nZd,Jc.a.u1d,"Columns Spacing",Ka.App.Eaa,rm.I9d,rm.KRd,rm.y2n)}LCb(){for(let b=0;b<rm.U7.length;b++)Mh.a.Vja(rm.U7[b],Object(u.a)(this,this.bwa,"setAdvancedControlValue"),Object(u.a)(this,this.ita,"getAdvancedControlValue"));this.pp.iM("DialogCountSpinner");this.pp.iM("DialogWidthSpinner");this.pp.iM("DialogSpacingSpinner")}dispose(){for(let b=
0;b<rm.U7.length;b++)Mh.a.Gsa(rm.U7[b]);this.pp.VA("DialogCountSpinner");this.pp.VA("DialogWidthSpinner");this.pp.VA("DialogSpacingSpinner");super.dispose()}ita(b,k){var r=this.vjb(b);if(this.Ee.hasProperty(r))if(r==Jj.a.LC)b=this.Ee.getValue(r),k[rc.a.Number]=b,k[rc.a.UnitType]=0;else if(r==Jj.a.Mx){b=Ka.App.Eaa;r=this.Ee.getValue(Jj.a.iW);const y=this.Ee.getValue(Jj.a.LC);r=this.lAb(Jj.a.Mx,y,r,0);k[rc.a.Number]=Rg.a.Yba(r,b);k[rc.a.UnitType]=b}else r==Jj.a.iW&&(b=Ka.App.Eaa,r=this.Ee.getValue(r),
k[rc.a.Number]=Rg.a.Yba(r,b),k[rc.a.UnitType]=b);else k[rc.a.Number]=0,k[rc.a.UnitType]=0}bwa(b,k){var r=k[rc.a.Number];k=k[rc.a.UnitType];b=this.vjb(b);if(b==Jj.a.LC)this.Ee.setValue(b,r),this.Ee.setValue(Jj.a.iW,rm.mTk[r]),this.Ee.setValue(Jj.a.Mx,[rm.nTk[r]]);else if(b==Jj.a.iW){var y=this.Ee.getValue(Jj.a.LC);k=Rg.a.PQa(r,k);r=this.lAb(Jj.a.Mx,y,k,0);k=this.Kbh(Jj.a.Mx,y,r,k);r=k[0];k=k[1];r>=rm.J9d&&r<=rm.LRd&&(this.Ee.setValue(b,k),this.Ee.setValue(Jj.a.Mx,[r]))}else b==Jj.a.Mx&&(y=this.Ee.getValue(Jj.a.LC),
r=Rg.a.PQa(r,k),k=this.lAb(Jj.a.iW,y,0,r),k=this.Kbh(Jj.a.iW,y,r,k),r=k[0],k=k[1],k>=rm.I9d&&k<=rm.KRd&&(this.Ee.setValue(b,[r]),this.Ee.setValue(Jj.a.iW,k)));this.pp.xl()}lAb(b,k,r,y){var R=this.iL.getValue(wc.a.Oo),aa=this.iL.getValue(wc.a.marginLeft);const ta=this.iL.getValue(wc.a.marginRight);R=R-aa-ta;aa=0;b==Jj.a.iW?aa=(R-k*y)/(k-1):b==Jj.a.Mx&&(aa=(R-(k-1)*r)/k);return aa}Kbh(b,k,r,y){b==Jj.a.iW?y<rm.I9d?(y=rm.I9d,r=this.lAb(Jj.a.Mx,k,y,0)):y>rm.KRd&&(y=rm.KRd,r=this.lAb(Jj.a.Mx,k,y,0)):b==
Jj.a.Mx&&(r<rm.J9d?(r=rm.J9d,y=this.lAb(Jj.a.iW,k,0,r)):r>rm.LRd&&(r=rm.LRd,y=this.lAb(Jj.a.iW,k,0,r)));return[r,y]}tBk(b){let k=!1;var r=this.Ee.getValue(Jj.a.Mx);const y=this.Ee.getValue(Jj.a.LC),R=this.Ee.getValue(Jj.a.iW);let aa=0;for(let ta=0;ta<y;ta++)aa+=r[0];r=this.iL.getValue(wc.a.Oo)-this.iL.getValue(wc.a.marginLeft)-this.iL.getValue(wc.a.marginRight);1===b&&(13>=y&&(y-1)*R+aa<=r?OC(this.$M,this.Ee,rm.YYa()):k=!0);this.dispose();k&&this.dwa("The page does not fit the current columns sizes.  Please try changing them.",
Object(u.a)(this,this.sBk,"marginDialogCreator"))}sBk(){Va.a.instance.resolve("WordEditor.UI.IDialogFactory").zuh(this.$M,this.iL,this.ZO)}OUe(b,k,r,y,R,aa,ta,Ya,xb){r=rm.Dmk(k,r,y,R,aa,ta,Ya,xb);this.VVa(r,b,k)}VVa(b,k,r){k=document.getElementById(k);this.pp.rza(r,b);b=this.pp.yYa(r,"Medium");k.appendChild(b)}vjb(b){let k=null;switch(b){case Jc.a.mZd:case Jc.a.t1d:k=Jj.a.LC;break;case Jc.a.oZd:case Jc.a.v1d:k=Jj.a.Mx;break;case Jc.a.nZd:case Jc.a.u1d:k=Jj.a.iW}return k}static YYa(){return rm.OY||
(rm.OY=rm.EKa())}static EKa(){const b={};b[Jj.a.LC.id.toString()]=zp.fBk;b[Jj.a.Mx.id.toString()]=zp.rBk;b[Jj.a.iW.id.toString()]=zp.pBk;return b}static Dmk(b,k,r,y,R,aa,ta,Ya){return 0==R?Rf.l(b,k,r,y,[rm.Gmk(R,aa,ta,Ya)]):Rf.l(b,k,r,y,[rm.Fmk(Rg.a.Yba(aa,3),Rg.a.Yba(ta,3),Ya),rm.Emk(Rg.a.Yba(aa,1),Rg.a.Yba(ta,1),Ya)])}static Fmk(b,k,r){return Rf.n("inch",b.toString(),k.toString(),r.toString())}static Emk(b,k,r){return Rf.n("centimeter",b.toString(),k.toString(),r.toString())}static Gmk(b,k,r,y){return Rf.n(b.toString(),
k.toString(),r.toString(),y.toString())}}rm.U7=[Jc.a.t1d,Jc.a.v1d,Jc.a.u1d,Jc.a.mZd,Jc.a.oZd,Jc.a.nZd];rm.L1n=1;rm.Arm=13;rm.JIk=1;rm.J9d=720;rm.LRd=9360;rm.ruo=.1;rm.I9d=0;rm.KRd=7920;rm.y2n=.1;rm.mTk=[-1,0,720,720,720,720,720,720,520,360,245,144,72,0];rm.nTk=[-1,9360,4320,2635,1800,1296,965,720,720,720,720,720,720,720];rm.OY=null;Object(m.a)(rm,"ColumnsDialog",yf.a,[]);class zH{AJk(b){new MC(b,Va.a.instance.resolve("Box4.IFeatureHelper"))}jNk(b,k){n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA?
new vH(b,k):new jH(b,k)}x1k(b,k,r){new wH(b,k,r)}Evh(b,k,r){new ju(b,k,r,Va.a.instance.resolve("WordEditor.IPageCommands"),Va.a.instance.resolve("Common.IStandaloneRootController").M3,!!Ka.App.instance&&Ka.App.instance.Ygb)}iwh(b,k,r){new Rq(b,k,r,Va.a.instance.resolve("WordEditor.IPageCommands"),Va.a.instance.resolve("Common.IStandaloneRootController").M3,!!Ka.App.instance&&Ka.App.instance.Ygb)}zuh(b,k,r){new rm(b,k,r,Va.a.instance.resolve("Common.IStandaloneRootController").M3)}VIk(b){return new ZB(b)}y_b(b,
k,r,y){n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&n.AFrameworkApplication.K.$("ReactParagraphDialogIsEnabled")?new yH(b,k,r,n.AFrameworkApplication.ya,y):new hr(b,k,r,Va.a.instance.resolve("Box4.IIndentationCommands"),Va.a.instance.resolve("Box4.IJustificationCommands"),Va.a.instance.resolve("Box4.ISpacingCommands"),Va.a.instance.Ze("Box4.IFeatureHelper"),n.AFrameworkApplication.K,Va.a.instance.resolve("Box4.IParagraphIndentationReader"),Va.a.instance.resolve("Common.IStandaloneRootController").M3,
y)}TUk(){const b=Va.a.instance.Pa("Box4.IRoamingServiceRequestManager");null==b?Od.b(524834398,3018,10,"Roaming service not resolved."):new kH(b)}WUk(b,k){new lH(b,k)}I3e(b){return new mH(b)}}Object(m.a)(zH,"DialogFactory",null,[264,265]);class OD extends yf.a{constructor(b,k){super(!1,!1,!0);this.jCh="DoNotCheckSpellingCheckbox";this.wCh="DocumentChoiceGroup";this.m9c=0;this.$ki="LanguageList";this.documentContext="DocumentContext";this.Hq="RangeContext";this.HNn=(r,y)=>{if(gh.a.instance.J(9)){var R=
Db.a.instance.qo(Wa.a.o0i);if(1!==r)R.properties.Z("canceled","true");else{r=y[this.$ki].replace(OD.ofg,"");var aa=parseInt(r),ta=Boolean.parse(y[this.jCh]);y=y[this.wCh];y===this.documentContext?this.Qed.tLn(aa,ta):this.Qed.JQn(aa,ta);R.properties.Z("PreviousLCID",this.m9c.toString());R.properties.Z("ChangedLCID",aa.toString());R.properties.Z("NoProof",ta.toString());this.BOg.GNn(aa,this.m9c);Ib.d(Wa.a.o0i,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"SelectedLcid",string:r}),Object.assign(new ca.a,
{name:"NoProof",string:ta.toString()}),Object.assign(new ca.a,{name:"Context",string:y})]);Ka.App.xa.updateCommandUI(!0)}R.end()}};this.BOg=k;this.Qed=b}j1f(){const b=Array(2);b[0]={["key"]:this.Hq,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const k={showDocumentChoiceGroup:!0};k.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;k.documentChoiceGroupProps={["id"]:this.wCh,["defaultSelectedKey"]:this.$ql(),
["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.m9c=({adn:this.aCj}=this.Qed.QJl()).returnValue;k.languageListPropsProvider=this.Byl();k.spellingCheckboxProps={["id"]:this.jCh,["checked"]:!this.aCj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Vh(Box4Intl.Box4Strings.l_Language,this.HNn,{["id"]:"LanguageDialog",["bodyControls"]:k})}$ql(){return this.Qed.zf()?this.documentContext:this.Hq}Byl(){return()=>{let b,k;const r=({selectedIndex:b,
J8i:k}=this.BOg.Ayl(this.m9c)).returnValue;for(let y=0;y<r.length&&y<k;y++)r[y].value=OD.ofg+r[y].value;return{["id"]:this.$ki,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:k}}}}OD.ofg="recent-";Object(m.a)(OD,"ReactLanguageDialog",yf.a,[263]);class AH extends MD{constructor(b,k,r,y){super(k,r);this.mMf=()=>{this.floatie.xl()};this.Dh=b;this.MH=y}pbb(b,k,r){if(b=super.pbb(b,k,r))b.tbc=!0,b.K0d=!0,b.preventDismissOnScroll=!0;this.Dh.GVa(this.mMf);return b}nMc(b,k,r=null){this.MH.Ogh(()=>
this.pbb(b,k,r))}CXd(){this.floatie.tbc=!0}}Object(m.a)(AH,"ExternalContentFloatieInitializer",MD,[]);class BH{IHb(){om.instance.Ema&&(js.instance.D4a([1,0]),om.instance.nRd()&&zs.instance.D4a([1]))}}Object(m.a)(BH,"RulerUser",null,[261]);class CH{constructor(){this.whitelistedControlIds=null}}Object(m.a)(CH,"StatusBarProps",null,[]);class PD{constructor(b,k,r=!0){this.Gjd=!1;this.uEe=null;this.nda=k.nG;this.JIe=k.E9i;r?kj.a.get_instance().Gl(7,()=>{this.Vih(b,k)}):this.Vih(b,k)}Vih(b,k){window.setTimeout(()=>
{Bo.a.instance.Qd(()=>{Sk.UISurfaces.JLl().then(r=>{const y=Object.assign(new CH,{whitelistedControlIds:k.whitelistedControlIds});r.initializeNewStatusBar(b,y,this.JIe);this.uEe=r;this.Gjd=!0;window.setTimeout(()=>{Bo.a.instance.Qd(()=>{const R=[];if(k.kG){const aa=k.kG;for(let ta in aa)R.push(appChrome.actions.updateControlHiddenState(ta,aa[ta]));appChrome.api.dispatch(R)}this.IHb()},"RSB:I2")},0);return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");
return null})},"RSB:I1");if(k.Doa&&b){PD.nIg||(n.AFrameworkApplication.ya.pa(ib.a.G9i,zc.a.frame,Object(u.a)(this,this.H9i,"statusBarTabAction")),n.AFrameworkApplication.ya.pa(ib.a.F9i,zc.a.frame,Object(u.a)(this,this.H9i,"statusBarTabAction")),PD.nIg=!0);const r=Ko.a.Rnf(k.Doa,k.z_i,b,!1);r.XL=!0;this.fcc(r,ib.a.G9i,ib.a.F9i)}},0)}IHb(){this.Gjd&&this.nda&&window.setTimeout(()=>{this.nda(this.uEe.selectors.getStatusBarControlsMap(this.JIe),7)},0)}wkb(b,k){this.Gjd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,
k))},0)}kU(b){this.Gjd&&this.nda&&window.setTimeout(()=>{const k=this.uEe.selectors.getStatusBarControlsMap(this.JIe);if(k[b]){const r={};r[b]=k[b];this.nda(r,7)}},0)}fcc(b,k,r){const y=bc.KeyInputManager.lc(tb.a.px,0),R=bc.KeyInputManager.lc(tb.a.px,4);b.Er(y);b.Er(R);b.bindAction(y,k);b.bindAction(R,r)}H9i(){return 4}}PD.nIg=!1;Object(m.a)(PD,"ReactStatusBar",null,[]);class DH{constructor(){this.whitelistedControlIds=this.kG=this.nG=null;this.spm=!1;this.z_i=this.Doa=this.E9i=null}}Object(m.a)(DH,
"ReactStatusBarInitOptions",null,[]);var $B=c(472);class EH{constructor(b,k,r,y,R){this.jUb=this.JIa=this.Oa=null;this.m5n=()=>{const aa=Ka.App.xa.fp.getRegion(Rh.AppFrame.Doa);aa&&aa.dBf()};this.WWl=(aa,ta,Ya,xb,Mb)=>{if(!Mb)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ya)return 32;Mb&&2===Mb.length&&this.JIa&&this.JIa.wkb(Mb[0],Mb[0]);return 32};this.$3c=aa=>{Ka.App.xa.nG(aa)};this.ga=y;Bo.a.instance.Qd(()=>{this.Oa=R;this.jUb=
this.JIa=null;let aa={};n.AFrameworkApplication.O6i||(aa[$B.a.JCn]=!0);aa.GiveFeedback=!n.AFrameworkApplication.xE;this.Oa.$("OfficeOnlineInGallatinTextVisible")||(aa.CenterStatusLabel=!0);aa[$B.a.PDi]=!0;this.Oa.$("WPMPackageIsEnabled")&&this.Oa.$("WPMStatusBarLabelIsEnabled")||(aa[$B.a.sbg]=!0);this.Oa.$("AddInCommandsIsEnabled")||(aa[$B.a.B4j]=!0);this.Oa.$("WordEditorShowOcsConnectionStatus")||(aa[$B.a.mFf]=!0);aa[$B.a.Vuo]=!0;this.Oa.$("ReadingTimeIsEnabled")||(aa[$B.a.BLi]=!0);window.setTimeout(()=>
{this.R5l(b,aa)},0)},"SBU:I")}Vb(){this.ga.gb(Wa.a.s$d,lc.a.application,this.WWl,96)}R5l(b,k){this.jUb=Va.a.instance.Pa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(let R in k){var y=k[R];r[this.whf(R)]=y}this.JIa=new PD(b,Object.assign(new DH,{kG:r,nG:this.$3c,spm:!1,E9i:"WordEditorStatusBar",Doa:Rh.AppFrame.Doa,z_i:this.m5n}))}whf(b){let k="";if(this.jUb){const r=this.jUb.nef(b);r&&0<r.count&&(k=r.J(0))}return k&&""!==k?k:b}IHb(){this.JIa&&this.JIa.IHb()}wkb(b,k){this.JIa&&
this.JIa.wkb(this.whf(b),k)}kU(b){this.JIa&&this.JIa.kU(this.whf(b))}dispose(){}}Object(m.a)(EH,"StatusBarUser",null,[260,10]);var FH=c(1029);class BF{constructor(b){this.ga=b;this.ga.pa(ib.a.AYc,zc.a.frame,Object(u.a)(this,this.AYc,"reportFileMenuPageSwitch"));this.ga.pa(ib.a.VRi,zc.a.frame,Kd.ActionManager.Of)}AYc(b,k,r,y,R){this.ga.processAction(this.wtl(R[FH.a.$Zd]),2);return 32}}Object(m.a)(BF,"FileMenuSQMInformation",null,[988]);class GH extends BF{constructor(b){super(b);this.nnn()}nnn(){this.ga.pa(ib.a.lUf,
zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.PRi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.mUf,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.QRi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.RRi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.nUf,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.SRi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.TRi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.URi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.xSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.ySi,
zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.$Ri,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.aSi,zc.a.frame,Kd.ActionManager.Of)}wtl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return ib.a.lUf;case "tabHome":case "FileHomePage":return ib.a.PRi;case "menuJewelInfo":case "FileInfoPage":return ib.a.mUf;case "menuJewelNew":case "FileNewPage":return ib.a.QRi;case "menuJewelOpen":case "FileOpenPage":return ib.a.RRi;case "menuJewelPrint":case "FilePrintPage":return ib.a.nUf;case "menuJewelSaveAs":case "FileSaveAsPage":return ib.a.SRi;
case "menuJewelShare":case "FileSharePage":return ib.a.TRi;case "menuJewelTransform":case "FileTransformPage":return ib.a.URi}return ib.a.VRi}}Object(m.a)(GH,"WordEditorFileMenuSQMInformation",BF,[]);var HH=c(1027);class CF{constructor(b){this.ga=b;this.ga.pa(ib.a.BYc,zc.a.frame,Object(u.a)(this,this.BYc,"reportTabSwitch"));this.ga.pa(ib.a.sSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.uSi,zc.a.frame,Kd.ActionManager.Of)}BYc(b,k,r,y,R){this.ga.processAction(this.IIl(R[HH.a.w4f]),2);return 32}}
Object(m.a)(CF,"RibbonSQMInformation",null,[945]);class IH extends CF{constructor(b){super(b);this.Cpn()}Cpn(){this.ga.pa(ib.a.kSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.lSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.pUf,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.mSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.nSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.oSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.pSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.qSi,zc.a.frame,
Kd.ActionManager.Of);this.ga.pa(Jc.a.rSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.qUf,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.tSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(ib.a.vSi,zc.a.frame,Kd.ActionManager.Of);this.ga.pa(Jc.a.wSi,zc.a.frame,Kd.ActionManager.Of)}IIl(b){switch(b){case "tabAddins":case "Addins":return ib.a.kSi;case "tabHome":case "Home":return ib.a.mSi;case "tabInsert":case "Insert":return ib.a.nSi;case "tabDeveloper":case "Developer":return ib.a.lSi;case "tabPageLayout":case "Layout":return Jc.a.oSi;
case "tabReferences":case "References":return Jc.a.rSi;case "tabReview":case "Review":return Jc.a.qUf;case "tabView":case "View":return ib.a.vSi;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Jc.a.tSi;case "tabMailings":case "Mailings":return Jc.a.pSi;case "tabWordDesign":case "Design":return Jc.a.wSi;case "tabHelp":case "Help":return Jc.a.pUf;case "ctabPictureTools":case "Picture":return Jc.a.qSi}return ib.a.uSi}}Object(m.a)(IH,"WordEditorRibbonSQMInformation",
CF,[]);class JH{constructor(b=null,k=null,r=null){this.kG=b||{};this.Eej=k||[];this.Gej=r||{}}}Object(m.a)(JH,"RibbonTrimmingProperties",null,[]);class KH{constructor(b,k,r){this.Bsa=b;this.kG=k;this.hvf=r}}Object(m.a)(KH,"ReactRibbonJewelProperties",null,[]);class LH{constructor(){n.AFrameworkApplication.ya.pa(ib.a.ENa,zc.a.frame,Object(u.a)(this,this.ein,"reactFileMenuOpenFromTellMe"))}ein(b,k,r,y,R){if(1===r||!R)return 32;b=R.SourceControlId;17!==R.UILocation||"New"!==b&&"Open"!==b||(R=[],ni.d("setFileMenuSelectedPage")&&
("New"===b&&n.AFrameworkApplication.ta?2===n.AFrameworkApplication.ta.Rb.ko?R.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):R.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&n.AFrameworkApplication.ta&&(2===n.AFrameworkApplication.ta.Rb.ko?R.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):R.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),R.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(R));
return 32}Nli(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}bPa(){return!1}vGi(){}VBh(){}}Object(m.a)(LH,"ReactFileMenu",null,[310]);class MH{h0e(){const b=new LH,k=[];k.push(appChrome.actions.updateFileMenuExpandedValue(!1));k.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(k);return b}}Object(m.a)(MH,"ReactFileMenuFactory",null,[302]);class PC{constructor(b,k,r,y=!1){this.$Lb=b;this.gMg=this.$Lb.A_a;this.LWd=Va.a.instance.Pa("Common.IOfficeTrialExperience");
this.KFb=Va.a.instance.Pa("Common.IMacOfficeOffer");PC.Nje=!1;this.Wjm=y;this.ga=k;this.Ub=r}get wc(){return this.ga}get $h(){return this.Ub}gSe(){return this.gMg&&!!this.LWd&&!!this.KFb}bRa(b,k){this.$Lb.gq(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.gMg=!0;this.t8e(b,k)});Va.a.instance.$a("Common.IOfficeTrialExperience").execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.LWd=r;this.t8e(b,k)});Va.a.instance.$a("Common.IMacOfficeOffer").execute(r=>
{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.KFb=r;this.t8e(b,k)})}t8e(b,k){PC.Nje||(this.gSe()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,k),PC.Nje=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}PC.Nje=!1;Object(m.a)(PC,"RibbonDependencies",null,[757]);class DF{constructor(b,k,r){this.Upb=b;this.ga=k;this.Ub=r}}Object(m.a)(DF,"WoncaRibbonUserFactory",null,[92]);class NH{constructor(b,k){this.ble=
b;this.MWb=k}Qkb(b){this.ble.Qkb(b);this.MWb&&this.MWb.Qkb(b)}s_c(b){this.ble.s_c(b);this.MWb&&this.MWb.s_c(b)}b4c(b){this.ble.b4c(b);this.MWb&&this.MWb.b4c(b)}}Object(m.a)(NH,"RibbonCommandTrimmer",null,[105]);var zL=c(1218);class OH{constructor(b,k){this.Oa=b;this.zUb=k}Qkb(b){X.a.mi&&6>X.a.GZa&&(b.fseaInsertPicture=!0);this.Oa.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Oa.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Oa.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=
!0);Kg.a.zgi()||(b.InsertLoopComponentsForConsumers=!0);const k=this.Oa.$("InsertOnlinePictureEnabled"),r=n.AFrameworkApplication.Nrf();k||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);r&&k?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;n.AFrameworkApplication.Orf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=
!0);n.AFrameworkApplication.Sbe&&(b.btnOpenInClient=!0);n.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&n.AFrameworkApplication.K.$("DisablePrint")&&this.ehc(b)}s_c(b){b.menuJewel=!0;n.AFrameworkApplication.xE||(b.jbtnGiveFeedback=!0)}ehc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}b4c(b){delete b.menuJewel;n.AFrameworkApplication.rjb||(b.jbtnPrivacy=
!0);n.AFrameworkApplication.xYc||(b.jbtnReportAbuse=!0);n.AFrameworkApplication.Qae||(b.jbtnTermsOfUse=!0);n.AFrameworkApplication.zCd||(b.jbtnFileSharing=!0);gh.a.instance.J(4)&&n.AFrameworkApplication.Ujb||(b.jbtnShareRWC=!0);n.AFrameworkApplication.u9e||n.AFrameworkApplication.l$f||(b.jbtnVersion=!0);this.zUb.LWd&&this.zUb.LWd.jQm||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.zUb.KFb&&this.zUb.KFb.kWn||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);n.AFrameworkApplication.Sbe?
(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Ka.App.zs?"btnjOpenInClient":"btnjEditInClient"]=!0;n.AFrameworkApplication.Vdo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);n.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&n.AFrameworkApplication.K.$("DisablePrint")?this.ehc(b):n.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;n.AFrameworkApplication.kM&&(this.ehc(b),b.faShare=!0);if(n.AFrameworkApplication.protectFile||
X.a.mNa||!n.AFrameworkApplication.qLc&&!n.AFrameworkApplication.l9e&&!n.AFrameworkApplication.j$f)b.jbtnFileEmbed=!0;zL.a.s2l()||(b.btnjClose=!0);n.AFrameworkApplication.V7b?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):n.AFrameworkApplication.mRd()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);n.AFrameworkApplication.CQf||(b.faOpen=!0);b.jbtnFileSharing&&
b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Oa.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const k=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Hhi;if(b.faOpen&&b.faNew||!k)b.faHome=!0}}Object(m.a)(OH,"WoncaCommandTrimmer",
null,[105]);var AL=c(973);c(465);var BL=c(1028),CL=c(1134);class PH{constructor(b,k){this.N0=this.BJ=null;this._clientId=b;this.p9=k}t5k(){if(!xf.c(this.N0))return this.N0;this.I7e();this.N0.style.display="block";this.p9&&this.p9.$Y(Object(u.a)(this,this.onResize,"onResize"));return this.N0}onResize(){this.Uva()}Uva(){this.o7e()?(document.getElementById("application").style.minWidth="0px",(new CL.a(this.N0,null,n.AFrameworkApplication.isRtl)).KEn(this.N0)):n.AFrameworkApplication.ta.Rb.KI||BL.a.LEn(this.N0,
n.AFrameworkApplication.isRtl)}o7e(){return n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}I7e(){if(xf.c(this.BJ)){var b;({R4b:b}=Ko.a.ihc(!n.AFrameworkApplication.jQ)).returnValue&&(this.BJ=sE.a("div"),this.BJ.className=Ko.a.H7k,this.BJ.id=en.CuiHelper.VBd,b.appendChild(this.BJ),this.B7e(),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Q6&&!n.AFrameworkApplication.jQ&&this.C7e(),this.s5k())}}s5k(){xf.c(this.N0)&&(this.N0=sE.a("div"),this.N0.className=
Ko.a.J6f,this.N0.style.display="none",this.BJ.appendChild(this.N0))}B7e(){Sys.UI.DomElement.addCssClass(this.BJ,Ko.a.I7k);n.AFrameworkApplication.isRtl&&sE.b(this.BJ,"cui-rtl")}C7e(){Sys.UI.DomElement.addCssClass(this.BJ,"FlexBoxLayout")}}Object(m.a)(PH,"HeaderSkeleton",null,[]);var QC=c(634);class EF{constructor(){this.kjc=null}Nfo(){this.kjc||(this.kjc=Va.a.instance.Pa("Common.App.AccountSwitching.IAccountSwitching"))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}hil(){this.Nfo();
return this.kjc?this.kjc.getCustomAuthConfig():null}static Ucm(){return n.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(EF,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class FF{constructor(){this.J8b=this.cultureName=null}}Object(m.a)(FF,"HeaderCultureInfo",null,[]);var HE=c(1560);class QH{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(QH,"SearchInitializationSettings",null,[]);var RC=c(286);class RH{constructor(){this.saveStatus=
this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(RH,"DocumentTitleAppProps",null,[]);class SH{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;
this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(SH,"DocumentTitleCalloutAppProps",null,[]);class TH{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=
this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=
!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(TH,"HeaderAppProps",null,[]);class UH{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(UH,"HeaderControls",null,[]);class VH{constructor(){this.command=this.label=null}}Object(m.a)(VH,"WorkflowButtonAppProps",null,[]);var IE;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";
b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(IE||(IE={}));Object(m.b)("RenameDisableReason",IE);class WH{constructor(b=""){this.NWf=this.documentTitleAppProps=this.qbg=null;this.MXj=""!==b?b:ak.a.X7}DHl(b){const k=Va.a.instance.Pa("Common.IExternalUICommandDefinitionMapping").Mdb(b);if(k&&0<k.length)return k[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Sjf(){if(!this.qbg){const b=
QC.a();if(b){const k=this.DHl(b.command);k&&(this.qbg=Object.assign(new VH,{command:k,label:b.label}))}}return this.qbg}qpl(){return Object.assign(new UH,{workflowButton:this.Sjf()})}YTm(){kj.a.get_instance().EK(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;n.AFrameworkApplication.ya.Xb(ib.a.eGb,2,b)}aIl(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}Prl(){let b=null,k=null;var r=Va.a.instance.Pa("Common.IRenameProps");r?(r=r.iZh(),0!==r&&(b=this.aIl(r),k=IE[r])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new SH,{breadcrumbBrandName:n.AFrameworkApplication.Gt.breadcrumbBrandName,breadcrumbBrandUrl:n.AFrameworkApplication.Gt.breadcrumbBrandUrl,breadcrumbFolderName:n.AFrameworkApplication.Gt.breadcrumbFolderName,breadcrumbFolderUrl:n.AFrameworkApplication.Gt.breadcrumbFolderUrl,
hideDocumentTitleInput:n.AFrameworkApplication.ta.Rb.PZl,isVersionHistoryEnabled:this.xXn(),documentExtension:A.a.MLa(n.AFrameworkApplication.fileName),isMoveEnabled:32===n.AFrameworkApplication.ya.processAction(ib.a.eGb,1),onMove:Object(u.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:k,openBreadcrumbsInNewTab:n.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}iRh(){if(!this.documentTitleAppProps){const b=n.AFrameworkApplication.Gt.Hz;this.documentTitleAppProps=Object.assign(new RH,
{documentTitle:n.AFrameworkApplication.EEc?b:A.a.wI(b),onFirstRender:Object(u.a)(this,this.YTm,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(u.a)(this,this.Prl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}xXn(){return!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Fii}oVn(){return!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Eii}fXn(){const b=!QC.b()&&!n.AFrameworkApplication.hideHeader&&!n.AFrameworkApplication.Klf&&(n.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||
n.AFrameworkApplication.K.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}CGk(b){appChrome.getHeaderApi().then(k=>{k.setNavBarData(b.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}Bmn(b=!1){appChrome.getHeaderApi().then(k=>{const r=Va.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");k.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});k.setHeaderCommandHandler("OnFullyLoaded",
()=>{this.onFullyLoaded()});k.setHeaderCommandHandler("OnFlexPaneOpen",y=>{r.onFlexPaneOpen(y)});k.setHeaderCommandHandler("OnFlexPaneClose",y=>{r.onFlexPaneClose(y)});k.setHeaderCommandHandler("SetCookie",y=>Ea.a.set(y.cookieName,y.value));k.setHeaderCommandHandler("GetCookie",y=>this.spl(y));k.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(u.a)(this,this.Sjf,"getWorkflowButtonAppProps"));b||(k.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(u.a)(this,this.iRh,"getDocumentTitleAppProps")),
k.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.ZTm();return null}));HE.a.zQd()&&k.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(u.a)(this,this.VZh,"getSearchInitializationSettings"))})}ZTm(){Va.a.instance.$a("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.Gmb(!1,n.AFrameworkApplication.ya.mode)})}spl(b){b=Ea.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}vMl(){return RC.AppChromeOverrideUtilities.isEnabled?RC.AppChromeOverrideUtilities.CHd("suiteux-shell",
!1):this.MXj+n.AFrameworkApplication.Rga+"suiteux-shell"}onFirstRender(){Va.a.instance.$a("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.kUn.continueWith(Object(u.a)(this,this.CGk,"continueShellServiceDataAsync"),3)});kj.a.get_instance().EK(15)}onFullyLoaded(){kj.a.get_instance().EK(16)}zta(b=!1){a:{try{var k=yh.a.qg(n.AFrameworkApplication.lcid);if(k){var r=Object.assign(new FF,{cultureName:k.name,J8b:k.J8b});break a}}catch(y){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
n.AFrameworkApplication.lcid.toString())}r=Object.assign(new FF,{cultureName:"en-us",J8b:"en"})}k=Va.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new TH,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.J8b,isConsumer:!n.AFrameworkApplication.o$f,showAppLauncher:QC.h(),showMeControl:QC.g(),hideUserName:n.AFrameworkApplication.tLd,defaultDocumentTitleToLeft:n.AFrameworkApplication.Kyh,assetsContainerOverride:this.vMl(),controls:this.qpl(),
documentTitleAppProps:b?null:this.iRh(),showDocumentTitleControl:!b,showWorkflowButton:!!this.Sjf(),showChatControl:this.fXn(),showGoPremiumControl:QC.i(),showDiscoverPremiumButton:QC.f(),enableSearchControl:HE.a.Xlm(),onFlexPaneOpen:Object(u.a)(k,k.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(u.a)(k,k.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.oVn(),testTraffic:n.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(u.a)(this,this.onFirstRender,
"onFirstRender"),onFullyLoaded:Object(u.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:n.AFrameworkApplication.pVn()});!n.AFrameworkApplication.Whc||n.AFrameworkApplication.R1f?(r.userDisplayName=n.AFrameworkApplication.userName,r.emailAddress=n.AFrameworkApplication.K.lb("UserPrincipalName"),r.userID=n.AFrameworkApplication.K.lb("Puid")||"",r.signOutLink=n.AFrameworkApplication.R1f):n.AFrameworkApplication.signInUrl&&(r.signInLink=n.AFrameworkApplication.signInUrl);HE.a.zQd()&&
(k=this.VZh(),r.loadTellMeResources=k.loadTellMeResources,r.getTokenRequestDictionary=k.getTokenRequestDictionary,r.enableVanillaSearchBox=n.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=k.userRing);EF.Ucm()&&(k=new EF,r.shellAuthProviderConfigPromise=Object(u.a)(k,k.hil,"getAccountSwitchingConfig"));this.Bmn(b);return r}VZh(){if(!this.NWf){const b=new HE.a;let k=n.AFrameworkApplication.K.lb("Microsoft365Ring");k&&k.length||(k="generalAudience");this.NWf=Object.assign(new QH,
{loadTellMeResources:b.xvm(),getTokenRequestDictionary:Object(u.a)(b,b.uOl,"getTokenRequestDict"),userRing:k})}return this.NWf}}Object(m.a)(WH,"ReactSharedHeaderPropsHelper",null,[1108]);class GF{constructor(){this.label=this.value=null}}Object(m.a)(GF,"TextInfoSectionField",null,[]);var QD=c(743),DL=c(1039);class HF{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(HF,"CommandDefinition",null,[]);class XH{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=
this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(XH,"CommandDefinitionMapping",null,[]);const EL=b=>Object.assign(new XH,{getCommandByExternalUxId:k=>{const r=b.getCommandByExternalUxId(k);return r?Object.assign(new HF,{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new HF,{externalUxCommand:k})},getDoNothingCommand:()=>parseInt(ib.a.Cg),addCommandToMaps:Object(u.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(u.a)(b,b.addIconToMap,
"addIconToMap"),addTabToMap:Object(u.a)(b,b.addTabToMap,"addTabToMap")});var FL=c(1347);class YH{}Object(m.a)(YH,"RibbonInitState",null,[]);var ZH=c(447),GL=c(1299);class $H{constructor(){}flatten(b){const k=[];for(const r of b)k.push.apply(k,r);return k}}Object(m.a)($H,"ReactAsyncDispatcher",null,[]);var HL=c(1596);class aI{constructor(b,k){this.gXj=b;this.GAj=k}}Object(m.a)(aI,"ReactExecuteCommandContext",null,[]);class Tv{}Tv.Trigger="FontTrigger";Tv.Name="FontName";Tv.Action="FontAction";Tv.Level=
"FontLevel";Tv.IsPinned="FontIsPinned";Object(m.a)(Tv,"FontPickerLogProperties",null,[]);class bI{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb=null,cc=null){this.IY=null;this.m1g=!1;this.Zoe=[];this.i9c=-1;this.Ond=!1;this.uYj=0;this.elc=null;this.TXg=!1;this.bda=b;this.D9a=k;this.k_g=Object(ia.a)(948,b);this.rm=r;this.Ub=y;R&&(this.IY=new HL.a(R,y));this.FUj=aa;this.OEj=ta;this.Vt=Mb;this.ga=Ya;this.jrb={};this.Oa=xb;this.ahg=cc;xb&&(xb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||xb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&dj.a.instance.Yyc.CWR(()=>this.m1g=!0);xb&&(b=this.Oa.lb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Iv:this.elc}=x.d(b));this.elc||(this.elc={})}get hYi(){return!!window.appChrome&&!!appChrome.selectors}IWi(){-1!==this.i9c&&window.clearTimeout(this.i9c);this.i9c=window.setTimeout(()=>{for(this.i9c=-1;0<this.Zoe.length;){if(Mg.a.instance.hv){this.IWi();break}const b=this.Zoe.shift();b&&this.executeCommand(b.gXj,b.GAj)}},0)}executeCommand(b,
k){if(Mg.a.instance.hv){if(this.m1g){this.Zoe.push(new aI(b,k));this.IWi();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,k.modelType,Ba.a.toJSON(k.payload));if(this.Oa.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(k){const r=this.rm.getCommandByExternalUxId(b),y=k.modelType;this.ahg&&this.ahg.yym(b,k);r?this.y6k(b,
r,y,k):this.z6k(b,y,k);this.tvk(k);this.oGm(b,k)}}z6k(b,k,r){switch(k){case "GalleryModel":case "PreviewGalleryModel":this.QGh(r,b)}}Dno(b,k,r,y,R){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=k.menuItemId;b.CommandValueId=r.payload.commandValueId;this.Qda();break;case "ButtonPreviewPayload":b.MenuItemId=k.menuItemId;b.CommandValueId=r.payload.commandValueId;R=k.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=
k.menuItemId;b.CommandValueId=r.payload.commandValueId;R=k.commandRevertId;break;default:b.MenuItemId=k.menuItemId}else b.MenuItemId=k.menuItemId;b.SourceControlId=y;return R}Eno(b,k,r){if(k.payload)switch(k.payload.type){case "MenuOpenPayload":b=this.rm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.rm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=k.payload.executedControl;r.ControlId=k.payload.executedControl;
r.ParentControlId=k.payload.parentControl;r.CloseAllMenus=!0;this.Qda();break;case "TellMeSearchResultChangePayload":r.Value=k.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=k.payload.selectionContextJson}return b}y6k(b,k,r,y){var R=this.g8m(y,r),aa=k.commandId;const ta={},Ya={};switch(r){case "SplitButtonModel":if(this.HKc(y.payload,Object(u.a)(this,this.Eoo,"updateSplitButtonMenuState"),R))return;ta.MenuItemId=k.menuItemId;this.TZf(y,ta);break;case "StatefulSplitButtonModel":if(this.HKc(y.payload,
Object(u.a)(this,this.Moo,"updateStatefulSplitButtonMenuState"),R))return;r=y.payload.statefulData;R=y.payload.statefulMode;"color"===R?ta.Color=r:"icon"===R&&(r=this.rm.getCommandByExternalUxId(r))&&(ta.MenuItemId=r.menuItemId);break;case "FileMenu":ta.MenuItemId=k.menuItemId;ta.SourceControlId=b;y.payload&&"FileMenuPageSwitchPayload"===y.payload.type&&this.NUl(aa,y.payload,b);break;case "TellMe":aa=this.Eno(aa,y,ta);ta.SourceControlId=b;ta.Location=y.payload.location;break;case "ButtonModel":y.payload&&
"TabSwitchPayload"===y.payload.type?this.AWl(ta,y):aa=this.Dno(ta,k,y,b,aa);break;case "CompoundButtonModel":ta.MenuItemId=k.menuItemId;ta.CommandValueId=y.payload.commandValueId;ta.SourceControlId=b;this.TZf(y,ta);this.Qda();break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=k.menuItemId;ta.SourceControlId=b;this.TZf(y,ta);this.Qda();break;case "FontPickerModel":switch(y.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":aa=this.rm.getCommandByExternalUxId("FontPickerMenuClose").commandId;
ta[LC.a.FontPickerId]=y.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=y.payload.font;R=null;"string"===typeof r?(R=Oo.FontUtils.jOa(r),ta.CommandValueId=R,R=Oo.FontUtils.Rxd(R)):(r.data?(ta.CommandValueId=r.data.fontToApply,ta.MenuItemId=r.data.themeIndex,ta[LC.a.Formatting]=r.data):ta.CommandValueId=r.name,R=r);ta.SourceControlId=b;ta[LC.a.RequestUpdateMru]=R;Ya[Tv.Name]=y.payload.nameToLog?y.payload.nameToLog:"string"===typeof r?Oo.FontUtils.mOd(r)?"*"+r:Oo.FontUtils.Nqf(r)?"[EF]":
"[MF]":"";Ya[Tv.IsPinned]=y.payload.isPinned;Ya[Tv.Level]=y.payload.level;this.Xxf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=y.payload.font.name;ta[LC.a.Trigger]=y.payload.trigger;Ya[Tv.Trigger]=y.payload.trigger;Ya[Tv.Name]=y.payload.nameToLog;this.Xxf();break;case "FontPickerFontPinningPayload":r=y.payload.isPinned;ta.CommandValueId=y.payload.fontKey;ta[LC.a.IsPinned]=r;Ya[Tv.Name]=y.payload.nameToLog;Ya[Tv.Action]=r?"pin":"unpin";Ya[Tv.Level]=y.payload.level;this.Xxf();
break;default:return}break;case "ComboBoxModel":var xb=y.payload.type;switch(xb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Nec(y.payload.launcherId,R)&&(aa={},aa[y.payload.launcherId]=r,this.D9a.fVc(aa,ni.g(y.payload)),this.jrb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=y.payload.newValue;if(!r)return;r.value?(ta[ge.a.Value]=r.value,ta[ge.a.IsFreeForm]=!0):(ta[ge.a.Value]=r.text,ta.MenuItemId=r.key,ta.CommandValueId=r.commandValueId);
"ComboBoxPreviewPayload"===xb&&(aa=k.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":aa=k.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(y.payload.type){case "ZeroTermContextMenuClosePayload":r=Ba.a.WN(y.payload);for(xb of r)ta[xb]=y.payload[xb];break;default:this.HKc(y.payload,Object(u.a)(this,this.ilo,"updateFlyoutAnchorMenuState"),R),ta.launcherId=y.payload.launcherId}break;case "InkFlyoutAnchorModel":this.HKc(y.payload,Object(u.a)(this,this.gmo,"updateInkFlyoutAnchorMenuState"),
R);ta.launcherId=y.payload.launcherId;break;case "ColorPickerModel":switch(y.payload.type){case "ColorPickerPayload":ta[pm.Color]=y.payload.selectedColorId;break;case "ColorPickerPreviewPayload":aa=k.commandPreviewId;ta[pm.Color]=y.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":aa=k.commandRevertId;break;default:return}break;case "SpinButtonModel":ta[rc.a.Number]=y.payload.value;ta[rc.a.UnitType]=Rg.a.Exb(y.payload.unitType.toLowerCase());ta[rc.a.Text]=y.payload.reservedValue;
break;case "SliderModel":ta[sb.Value]=y.payload.value;break;case "InsertTableModel":ta[mb.a.Rows]=y.payload.rows;ta[mb.a.Columns]=y.payload.columns;break;case "CheckboxModel":ta[Ig.a.On]=y.payload.checked;ta.MenuItemId=k.menuItemId;break;case "PreviewGalleryModel":if(this.HKc(y.payload,Object(u.a)(this,this.Ono,"updatePreviewGalleryMenuState"),R)){ta.launcherId=y.payload.launcherId;break}this.QGh(y,b);return;case "DocumentTitleModel":switch(y.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=
y.payload.getNewDocumentTitle;break;case "MenuOpenPayload":aa={};aa[y.payload.launcherId]=r;this.D9a.fVc(aa,ni.g(y.payload));this.jrb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ta.MenuItemId=y.payload.url;this.xzm(y.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=y.payload.assetId;ta.SourceControlId=b;n.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ta.IsPremium=y.payload.isPremium||
!1);this.yzm(y.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=y.triggerTime;break;case "PeopleWell":ta.RenderTime=y.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=y.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=y.payload.commandValueId;this.MVl(y.payload);break;default:return}aa&&!this.isShadowMenuOpen(y.payload)&&(ta.CommandValueId||(ta.CommandValueId=ta.MenuItemId),k.legacyControlId&&(ta.LegacyId=k.legacyControlId),ta.SourceControlId||
(ta.SqmControlId=b),this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ta.launcherId&&(k=this.rm.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(k.commandId)),y.payload&&!xf.c(y.payload.PRIReadinessCheck)&&(ta.PRIReadinessCheck=y.payload.PRIReadinessCheck,this.TXg=!0),y.payload&&!xf.c(y.payload.shouldTakeFocus)&&(ta[pz.a.m3a]=y.payload.shouldTakeFocus),k=this.y9g(y,ta),xf.c(y.triggerTime)||(Ya.TriggerTime=y.triggerTime),y.payload&&
!xf.c(y.payload.userActionKey)&&(Ya.userActionKey=y.payload.userActionKey),this.$Zi(Ya,y,b,aa),this.k_g.executeCommand(aa,ta,this.getSelectedTabId(),k,!0,()=>{this.uti(ta,b)},Ya,ni.g(y.payload)))}$Zi(b,k,r,y){this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&y&&(r=k.payload&&!xf.c(k.payload.launcherId)?k.payload.launcherId:r,b.ControlId=this.KCl(r,y));this.Oa&&this.Oa.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&k.payload&&
"terminalParentControlId"in k.payload&&(b.TerminalParentControlId=k.payload.terminalParentControlId)}KCl(b,k){k=parseInt(k);k=Kd.ActionManager.oYe(k)||Kd.ActionManager.sda(k)||"";return!xf.c(k)&&k in this.elc?this.elc[k]:100<b.length?"":b}Xxf(){this.Vt&&this.Vt.execute(b=>{b.Jxf("ModernFontPickerExperience")})}y9g(b,k){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,k[pz.a.$w]=r);return r}uti(b,k){const r=Object(ia.a)(id.AFrame,n.AFrameworkApplication.ta);
if(this.Ub&&this.G4i(b)){if(!this.Ub.pg&&r){let y="null";if(b){const R=b.Value;delete b.Value;y=Ba.a.toJSON(b);xf.c(R)||(b.Value=R)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",k,y,r.F2a)}this.Ub.GKh()}(this.Ub&&this.Ub.pg&&this.Ub.pg.name!==id.AFrame.Tna&&r&&this.Ub.pg.name!==r.F2a||this.G4i(b))&&this.HAk(b)}G4i(b){return!!b&&!xf.c(b[pz.a.m3a])&&b[pz.a.m3a]}HAk(b){pz.a.$w in
b&&1===b[pz.a.$w]&&QD.ShyRibbon.Yab(1,0)}AWl(b,k){this.bda.xl();if(this.FUj&&this.ga){const r={};r[HH.a.w4f]=k.payload.tabId;this.ga.Xb(ib.a.BYc,2,r,this.Zea(k));xf.c(k.payload.inputMethod)||(this.ga.processAction(ib.a.sSi,2),this.Ond||this.n0n(k.payload.tabId))}k=k.payload.tabId;b.NewContextId=k;b.NewContextCommand=this.rm.Hif(k);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+k);if(this.Vt&&k){const r=k+"TabSwitchActivity";this.Vt.execute(y=>{y.Jxf(r)})}}HKc(b,k,r){const y=b.type;
return"MenuClosePayload"===y?!0:"MenuOpenPayload"===y?(k(b,r),!0):!1}MVl(b){b=b.type;"MenuOpenPayload"===b?n.AFrameworkApplication.K1c=!0:"MenuClosePayload"===b&&(n.AFrameworkApplication.K1c=!1)}g8m(b,k){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,y=this.rm.getCommandByExternalUxId(r);return y&&y.populationProps?((b=this.D9a.tMf(y,k,b.payload))&&r in this.jrb&&delete this.jrb[r],b):!1}ilo(b,
k){const r=b.launcherId;this.Nec(r,k)&&(k=appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Ghc(k,r,ni.g(b)))}gmo(b,k){const r=b.launcherId;this.Nec(r,k)&&(k=ni.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(r):appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Ghc(k,r,ni.g(b)))}Ono(b,k){const r=b.launcherId;this.Nec(r,k)&&(k=appChrome.selectors.getPreviewGalleryMenuItems(r),this.Ghc(k,r,ni.g(b)))}Eoo(b,k){const r=b.launcherId;this.Nec(r,k)&&(k=appChrome.selectors.getSplitButtonMenuItems(r),
this.Ghc(k,r,ni.g(b)))}Moo(b,k){const r=b.launcherId;this.Nec(r,k)&&(k=appChrome.selectors.getStatefulSplitButtonMenuItems(r),this.Ghc(k,r,ni.g(b)))}getSelectedTabId(){return this.hYi?appChrome.selectors.getSelectedTabId():null}Ghc(b,k,r){this.D9a.fVc(b,r);this.jrb[k]=new Date}Nec(b,k){let r=!0;b in this.jrb&&(r=this.jrb[b].getTime()<this.bda.Sma.getTime());return r&&!k&&this.hYi}QGh(b,k){const r={};var y=b.payload.selectedGalleryId;const R=this.rm.getCommandByExternalUxId(y);if(R){r.SourceControlId=
y;r.MenuItemId=R.menuItemId;r.SqmControlId=k;R.legacyControlId&&(r.LegacyId=R.legacyControlId);b.payload&&!xf.c(b.payload.shouldTakeFocus)&&(r[pz.a.m3a]=b.payload.shouldTakeFocus);this.hFl(b.payload,r);(y=this.Zea(b))||(y={});this.$Zi(y,b,k,R.commandId);const aa=this.y9g(b,r);this.k_g.executeCommand(R.commandId,r,this.getSelectedTabId(),aa,!0,()=>{this.uti(r,k)},y,ni.g(b.payload))}}hFl(b,k){"CharacterGalleryPayload"===b.type&&(k.MenuItemId=b.character)}TZf(b,k){b.payload&&"toggled"in b.payload&&(k[Ig.a.On]=
b.payload.toggled)}oGm(b,k){if("MenuOpen"===b){if(this.IY&&!("isShadowRendering"in k.payload&&k.payload.isShadowRendering))this.IY.onMenuOpen()}else if("MenuClose"===b&&this.IY)this.IY.onMenuClose()}Qda(){this.IY&&this.IY.pGf()}Zea(b){let k=null;xf.c(b.triggerTime)||(k={},k.TriggerTime=b.triggerTime);return k}NUl(b,k,r){if(this.OEj&&this.ga){const y={};y[FH.a.$Zd]=r;this.ga.Xb(ib.a.AYc,2,y)}this.Ghc(k.pageControlIdMap,b,ni.g(k))}yzm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ib.a.xSi,
2);break;case "FileNewPage":this.ga.processAction(ib.a.ySi,2)}}xzm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ib.a.$Ri,2);break;case "FileOpenPage":this.ga.processAction(ib.a.aSi,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}n0n(b){if(n.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Vt.execute(k=>{k.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Ond=!0;else{if(n.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.Vt.execute(k=>{k.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.uYj)){this.Ond=!0;return}n.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(ib.a.eLb,2)&&(this.Ond=!0)}}tvk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.TXg&&appChrome.PRIToastManager.dismissToast()}}Object(m.a)(bI,"ReactExecuteCommandHandler",null,[]);class cI{constructor(){this.fileMenu=null}get Imb(){return 0}get F0a(){return 0}get gDa(){return!1}Uva(){}Jcj(){}sZ(){return!1}B_i(){}g2(){return!1}EFa(b){return this.fileMenu&&
this.fileMenu.bPa(b)?!0:!1}get mha(){return!1}wkb(){}yOd(){return!1}get Nwd(){return null}set Nwd(b){}Ida(){}v$(){}Djf(){return null}$Ka(){}refresh(){}get controls(){return null}hcc(){return!1}mbb(){}xl(){}get vE(){return null}set vE(b){}E3c(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(m.a)(cI,"ReactRibbonExternal",null,[518,444,519]);class dI{constructor(b,k,r,y){this.Ub=b;this.ga=k;this.F6g=r;this.AUb=y}initialize(){this.ga.pa(ib.a.j5d,zc.a.frame,Object(u.a)(this,
this.CUi,"ribbonMoveForwardAction"));this.ga.pa(ib.a.i5d,zc.a.frame,Object(u.a)(this,this.BUi,"ribbonMoveBackwardAction"));this.ga.pa(ib.a.h5d,zc.a.frame,Object(u.a)(this,this.yUi,"ribbonEscAction"));var b=Ko.a.Rnf(this.AUb,null,this.F6g,!1);b.XL=!0;this.fcc(b,ib.a.j5d,ib.a.i5d);b.bindAction(bc.KeyInputManager.lc(tb.a.M4a,0),ib.a.h5d);b=this.Ub.re(id.AFrame.Tna);b.XL=!0;this.fcc(b,ib.a.AXa,ib.a.AXa);pf.a.instance.mb(Kb.a.ex,this.F6g,Object(u.a)(this,this.XYm,"onRibbonMouseDown"));b=Jn.a.instance;
ni.a("enterKeytipMode")&&b.ZOn(this.AUb,()=>{appChrome.api.enterKeytipMode(!1)});ni.a("exitKeytipMode")&&b.VOn(this.AUb,()=>{appChrome.api.exitKeytipMode();QD.ShyRibbon.Yab(1,0)});n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&(b=Object(ia.a)(Id.FocusManager,this.Ub))&&b.Z8j(Object(u.a)(this,this.IUm,"onFocusScopeChanged"))}IUm(b,k){if((b=Object(ia.a)(id.AFrame,n.AFrameworkApplication.ta))&&k.Zui&&n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima){const r=appChrome.selectors.getShyState();
r.isActive&&k.Zui.name===b.F2a&&QD.ShyRibbon.Yab(r.state,1)}}CUi(){return 4}BUi(){return 4}yUi(){ni.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&appChrome.selectors.getShyState().isActive&&QD.ShyRibbon.Yab(1,0),this.Ub.Kg(id.AFrame.Wo));return 4}fcc(b,k,r){const y=bc.KeyInputManager.lc(tb.a.px,0),R=bc.KeyInputManager.lc(tb.a.px,4);b.Er(y);b.Er(R);b.bindAction(y,k);b.bindAction(R,r)}XYm(b){b.Ib&&b.Ib.target&&"input"!==b.Ib.target.tagName.toLowerCase()&&
b.Ib.preventDefault();return!1}dispose(){this.ga.fz(ib.a.j5d,zc.a.frame,Object(u.a)(this,this.CUi,"ribbonMoveForwardAction"));this.ga.fz(ib.a.i5d,zc.a.frame,Object(u.a)(this,this.BUi,"ribbonMoveBackwardAction"));this.ga.fz(ib.a.h5d,zc.a.frame,Object(u.a)(this,this.yUi,"ribbonEscAction"))}}Object(m.a)(dI,"ReactRibbonFocusManager",null,[10]);class tz{constructor(b,k,r,y,R,aa,ta,Ya=null,xb=!0,Mb=null,cc=null){this.o7a=this.Ood=this.Zke=this.bda=null;this.O0g=[];this.Dkd=null;this.PIa=b;this.Fze=k;this.AUb=
r;this.Ub=y;this.ga=R;this.rm=aa;this.bda=Mb?Mb:new rE(Qq.instance,this.rm);this.uqc=ta;this.a_g=new cI;this.QIa=Ya;this.yHe=xb;new $H;this.zFg=cc;kj.a.get_instance().Gl(7,Object(u.a)(this,this.pQn,"setRibbonPostInteractiveReady"));kj.a.get_instance().Gl(7,Object(u.a)(this,this.hDm,"logRibbonLoadedActivity"));kj.a.get_instance().Gl(19,Object(u.a)(this,this.bym,"logAppLoadedActivity"));n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&
kj.a.get_instance().Gl(7,Object(u.a)(this,this.Ppn,"registerSubComponentReporting"));kj.a.get_instance().Gl(7,Object(u.a)(this,this.Wfn,"queueSettingsDependentActions"))}initialize(b,k,r=null){this.yHe||this.EK(5);r?r.then(()=>{this.kRi()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):ZH.a.o2c(ZH.a.o2c(Fj.Task.WAA(this.ani(b),this.$mi(tz.YAj)),()=>this.$mi(tz.rxj)),()=>this.ani(k)).continueWith(()=>{this.kRi()},11)}dispose(){this.Ogo();this.o7a&&this.o7a.VBh();
this.Dkd&&this.Dkd.dispose();for(const b of this.O0g)kj.a.get_instance().Gxk(b);n.AFrameworkApplication.ya.fz(ib.a.Dxn,zc.a.frame,Kd.ActionManager.Of)}$mi(b){return Va.a.instance.resolve("Common.ISharedDependencyLoader").k9b(n.AFrameworkApplication.Dw(b,2))}ani(b){return""===b?Fj.Task.C$(!0):Va.a.instance.resolve("Common.ISharedDependencyLoader").k9b(n.AFrameworkApplication.Dw(b,3))}U5l(){(this.QIa||this.uqc)&&appChrome.api.dispatch(this.X1h());this.jSn();ni.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(n.AFrameworkApplication.Q3);
this.bda.xl()}kRi(){this.U5l();this.yHe&&(appChrome.renderAppChrome(this.PIa,ni.e()),this.EK(10));this.H8g();this.MUe();this.yHe&&this.EK(5);this.w9h()}w9h(){this.Ub&&this.ga&&this.AUb&&(this.Dkd=new dI(this.Ub,this.ga,this.PIa,this.AUb),this.Dkd.initialize())}get $Yc(){return this.a_g}setCommandDefinitionMapping(){if(ni.a("setCommandDefinitionMapping")){const b=EL(this.rm);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&
ni.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,k)=>{0===k&&this.lbc()})}H8g(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(ia.a)(rE,this.bda);this.Zke=new bI(this.bda,b.dcc,this.rm,this.Ub,this.Fze,Va.a.instance.Pa("Common.IRibbonSQMInformation"),Va.a.instance.Pa("Common.IFileMenuSQMInformation"),n.AFrameworkApplication.ya,n.AFrameworkApplication.K,Va.a.instance.$a("Common.ISystemInitiatedFeedback"),null);this.Mjk();
this.NTl()}Mjk(){this.Ood=appChrome.api.bindCommandHandler((b,k)=>{this.Zke.executeCommand(b,k)})}Ogo(){this.Ood&&(this.Ood(),this.Ood=null)}jSn(){appChrome.api.initializeLogger(new il.a)}DBa(){return this.bda?this.bda.DBa():[]}lbc(){Bo.a.instance.Qd(()=>{let b=null;Bo.a.instance.Qd(()=>{b=this.DBa()},"RB:GA");b&&0<b.length&&(this.bda.Sma=new Date,Bo.a.instance.Qd(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.o7a&&Bo.a.instance.Qd(()=>{this.o7a.vGi()},"RB:J")},"RB:PFSU")}P3c(){this.bda.P3c()}IGb(){}V1j(b){b=
[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}X1h(){var b=n.AFrameworkApplication.K;const k=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(y=>{y&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",
!1));return null})}):k.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));k.push.apply(k,this.VRh());b=new FL.a(this.rm);this.QIa.kG&&(GL.a.Ydo(this.QIa.kG),k.push.apply(k,b.nEd(this.QIa.kG)));if(this.QIa.Eej)for(const r of this.QIa.Eej)k.push(appChrome.actions.updateGallerySectionHiddenState(r.dMh,r.ZMo,r.aPo));k.push.apply(k,b.VMh(this.QIa.Gej));return k}VRh(){const b=[];if(this.uqc&&this.uqc.kG){const r=this.uqc.kG;for(let y in r){var k=r[y];const R=this.rm.nef(y);if(R)for(let aa of R)b.push(appChrome.actions.updateControlHiddenState(aa,
k))}}return b}BFa(b){b&&this.bda.dcc.fVc(b,0)}tMf(b){this.bda.dcc.tMf(this.rm.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}nZk(){const b=n.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",k=n.AFrameworkApplication.K.appSettings;k&&appChrome.api.dispatch(this.zoo(b,"Shared"===(k.SharingStatus||"")))}Wfn(){n.AFrameworkApplication.K.gq(()=>{this.nZk()})}zoo(b,k){return appChrome.actions.updateSharingStatusIndicator(b,k)}WKl(b){return appChrome.actions.updateControlHiddenState(b,
!1)}XKl(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}EK(b){kj.a.get_instance().EK(b);this.O0g.push(b)}pQn(){ni.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new YH,{postRibbonInteractiveReady:!0})))}MUe(){this.uqc&&this.zFg&&(this.o7a=this.zFg.h0e(),this.a_g.fileMenu=this.o7a)}ysm(b,k){this.o7a&&this.o7a.Nli(b,k)}MVf(b,k,r){if(1===r)return 32;this.o1i(!0);this.lbc();n.AFrameworkApplication.ta.updateCommandUI();
return 32}NVf(b,k,r){if(1===r)return 32;this.o1i(!1);this.AQn();this.lbc();n.AFrameworkApplication.ta.updateCommandUI();return 32}AQn(){Ea.a.$Pa(n.AFrameworkApplication.K.lb("IsSimplifiedRibbonOnCookieName"),"true",Ea.a.YNa)}o1i(b){Ea.a.$Pa(n.AFrameworkApplication.K.lb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Ea.a.YNa)}hDm(){if(n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.hq){const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?
(b.execute(k=>{k.logActivity("SingleRibbonModeActivity",null)}),n.AFrameworkApplication.Gaa("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(k=>{k.logActivity("MultiRibbonModeActivity",null)}),n.AFrameworkApplication.Gaa("69a7h198;dfd7j584"))}}bym(){const b=Ea.a.ula(n.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const k=Va.a.instance.$a("Common.ISystemInitiatedFeedback");k&&(n.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?
(k.execute(r=>{r.logActivity("VNextStylesOn",null)}),k.execute(r=>{r.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):n.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&k.execute(r=>{r.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}Ppn(){kj.a.get_instance().Gl(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let r in b){var k=r;const y=b[r];if(y)for(const R of y)n.AFrameworkApplication.ya.p6(R)?
appChrome.api.reportRibbonSubComponentBehaviorMapped(k):n.AFrameworkApplication.ya.SOn(R,this.ANk(k));else appChrome.api.reportRibbonSubComponentBehaviorMapped(k)}}ANk(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}NTl(){if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ni.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&n.AFrameworkApplication.abc.ONe){const b=
n.AFrameworkApplication.abc.ONe,k=n.AFrameworkApplication.abc.i8g;k.payload||(k.payload={});const r=k.payload.launcherId?k.payload.launcherId:b;tz.EUi.ub(r)?tz.EUi.J(r)():"StatefulSplitButtonModel"===k.modelType?appChrome.PRIToastManager.dismissToast():(k.payload.PRIReadinessCheck=!0,this.Zke.executeCommand(b,k))}}}tz.YAj="common";tz.rxj="appChrome";tz.EUi=new DL.a(ka.a.mKc());Object(m.a)(tz,"ReactRibbonUser",null,[128,129,10]);class IF extends tz{constructor(b,k,r,y,R,aa,ta,Ya,xb=null,Mb=!0,cc=null,
jc=null){super(b,k,y,R,aa,ta,Ya,xb,Mb,cc,jc);this.dbd=null;this.Upb=r;this.Upb.execute(Mc=>{this.dbd=Mc});this.Upb.execute(Mc=>{this.bda.vE=Mc})}DBa(){return this.dbd?(this.dbd.clearCache(),super.DBa()):[]}IGb(b){if(!b)throw Error.argumentNull();this.Upb.execute(k=>{b.vE=k})}}Object(m.a)(IF,"ReactRibbonUser",tz,[]);var IL=c(967);class RD extends IF{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb=!0,cc=null,jc=null){super(k,b.PAa,y,Rh.AppFrame.coa,R.$h,R.wc,ta,Ya,xb,Mb,cc,jc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");
this.tse=b;this.p9=aa;R.bRa(()=>{this.ioo();n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?kj.a.get_instance().Gl(7,()=>{this.o9h()}):this.o9h()},null)}get uqf(){return!!n.AFrameworkApplication.K.appSettings.BootActivityNavigationId}o9h(){this.LLk();this.h0e();this.Dmn()}ioo(){this.PIa.classList.add("FlexBoxLayout");this.tse.yla().classList.add("cui-exth");this.tse.yla().classList.add("FlexBoxLayout");this.tse.yla().classList.add("ScrollableRibbon")}LLk(){n.AFrameworkApplication.jQ||
this.yPk()}yPk(){if(!n.AFrameworkApplication.jQ){var b=(new PH(RD.DUj,this.p9)).t5k(),k=Ko.a.Rnf(Rh.AppFrame.rMa,null,b,!0);k.XL=!0;this.fcc(k,ib.a.j5d,ib.a.i5d);k.bindAction(bc.KeyInputManager.lc(tb.a.M4a,0),ib.a.h5d);NB(1,()=>{this.Tvn(b)})}}Tvn(b){const k=new WH;appChrome.renderSharedHeader(b,k.zta()).then(Object(u.a)(this,this.X4e,"dismissFastViewHeader"))}bPi(){n.AFrameworkApplication.ta.Rb.Dii?appChrome.getHeaderApi().then(b=>{document.getElementById(n.AFrameworkApplication.Tcb).classList.remove("Placeholder");
return b.dismissPlaceholder()}):(new IL.a).X4e()}X4e(){this.uqf&&n.AFrameworkApplication.Gaa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.uqf&&n.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(kj.a.get_instance().Gl(12,Object(u.a)(this,this.bPi,"removeHeaderPlaceholder"),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.bPi()}fcc(b,k,r){const y=bc.KeyInputManager.lc(tb.a.px,
0),R=bc.KeyInputManager.lc(tb.a.px,4);b.Er(y);b.Er(R);b.bindAction(y,k);b.bindAction(R,r)}h0e(){const b=!!this.QIa&&"FileMenu"in this.QIa.Gej;n.AFrameworkApplication.ta.Rb.fNa&&!b&&NB(1,Object(u.a)(this,this.rvn,"renderFileMenu"))}rvn(){const b=[];if(n.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var k=[Object.assign(new GF,{label:CommonUIStrings.L_DiagnosticsSessionId,value:n.AFrameworkApplication.userSessionId}),Object.assign(new GF,{label:CommonUIStrings.L_DiagnosticsBuild,
value:n.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",k))}b.push.apply(b,this.VRh());k=document.createElement("div");document.body.appendChild(k);appChrome.renderFileMenu(k,b)}Dmn(){this.ga.pa(ib.a.xQa,lc.a.view,Object(u.a)(this,this.xQa,"tabSwitch"));this.ga.pa(ib.a.MVf,lc.a.view,Object(u.a)(this,this.MVf,"ribbonModeToggledToMLR"));this.ga.pa(ib.a.NVf,lc.a.view,Object(u.a)(this,this.NVf,"ribbonModeToggledToSLR"))}activateRibbonTab(b){this.V1j(b)}lbc(){kj.a.get_instance().isCompleted(7)&&
this.dbd&&(Ee.a.mark(4893),oc.a.Nno(),super.lbc(),Ee.a.mark(4894))}xQa(b,k,r,y,R){if(2===R[pz.a.$w]){if(r=Object(ia.a)(Yt.a,k))y=Object(ia.a)(Bw.a,r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(k),b,Ba.a.join(R," ",":")),8;if(y&&""!==y.sI)Me.a.ufa(k)&&Me.a.K6b()||(this.Ub.Kg(y.sI),appChrome.selectors.getShyState().isActive&&QD.ShyRibbon.Yab(0,1));else return v.ULS.sendTraceTag(38549529,
338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,Ba.a.join(R," ",":"),this.Yxl(r.view)),8}return 32}Yxl(b){return b?"is ContentEditableView: "+b.Dj+" is Editing View: "+b.$ta+" is FishbowlView: "+b.GCa+" is HtmlView: "+b.D_a+" is InteractiveView: "+b.ye+" is NavigationPaneView: "+b.ngi+" is PageView: "+b.yi+" is WordNavigationPaneHeadingsView "+b.rRd:"null view"}}RD.DUj="WACRibbon";Object(m.a)(RD,
"ReactRibbonUser",IF,[127,128,129,10]);class eI{constructor(b){this.ak=b}TKl(){return[h(Oh.a.u3f,this.ak.X6h,"Strikethrough"),h(Oh.a.N3f,this.ak.Y6h,"Subscript"),h(Oh.a.V3f,this.ak.Z6h,"Superscript"),h(Oh.a.raf,this.ak.O6h,"Format Painter"),h(Oh.a.l$h,this.ak.N6h,"Insert Footnote"),h(Oh.a.g$h,this.ak.L6h,"Insert Endnote"),h(Oh.a.J1f,this.ak.V6h,"Show/Hide \u00b6"),h(Oh.a.h8f,this.ak.Zlf,"Undo"),h(Oh.a.qRf,this.ak.U6h,"Redo"),h(Oh.a.RTe,this.ak.H6h,"Bold"),h(Oh.a.evf,this.ak.R6h,"Italic"),h(Oh.a.g8f,
this.ak.$6h,"Underline"),h(Oh.a.Wgo,this.ak.Zlf,"Undo"),h(Oh.a.skf,this.ak.P6h,"Grow Font Size"),h(Oh.a.L1f,this.ak.W6h,"Shrink Font Size"),h(Oh.a.Xal,this.ak.M6h,"Find"),h(Oh.a.jjh,this.ak.I6h,"Bullets"),h(Oh.a.kjh,this.ak.I6h,"Bullets"),h(Oh.a.kwi,this.ak.T6h,"Numbering"),h(Oh.a.lwi,this.ak.T6h,"Numbering"),h(Oh.a.cBh,this.ak.K6h,"Dictate"),h(Oh.a.Fui,this.ak.S6h,"New Comment")]}VKl(){return[h(Oh.a.CQe,this.ak.ALd,"Align Left"),h(Oh.a.BQe,this.ak.zLd,"Align Center"),h(Oh.a.DQe,this.ak.BLd,"Align Right"),
h(Oh.a.ovf,this.ak.CLd,"Justify"),h(Oh.a.G5f,this.ak.ALd,"Align Left"),h(Oh.a.E5f,this.ak.zLd,"Align Center"),h(Oh.a.H5f,this.ak.BLd,"Align Right"),h(Oh.a.F5f,this.ak.CLd,"Justify")]}QKl(){return[h(Oh.a.u3f,this.ak.X6h),h(Oh.a.N3f,this.ak.Y6h),h(Oh.a.V3f,this.ak.Z6h),h(Oh.a.raf,this.ak.O6h),h(Oh.a.l$h,this.ak.N6h),h(Oh.a.g$h,this.ak.L6h),h(Oh.a.wco,this.ak.C_l),h(Oh.a.skf,this.ak.P6h),h(Oh.a.L1f,this.ak.W6h),h(Oh.a.RTe,this.ak.H6h),h(Oh.a.evf,this.ak.R6h),h(Oh.a.g8f,this.ak.$6h),h(Oh.a.RAh,this.ak.K6h),
h(Oh.a.J1f,this.ak.V6h),h(Oh.a.yof,this.ak.z_l),h(Oh.a.Fui,this.ak.S6h),h(Oh.a.h8f,this.ak.Zlf),h(Oh.a.qRf,this.ak.U6h),h(Oh.a.V$k,this.ak.M6h)]}SKl(){return[h(Oh.a.CQe,this.ak.ALd),h(Oh.a.BQe,this.ak.zLd),h(Oh.a.DQe,this.ak.BLd),h(Oh.a.ovf,this.ak.CLd),h(Oh.a.G5f,this.ak.ALd),h(Oh.a.E5f,this.ak.zLd),h(Oh.a.H5f,this.ak.BLd),h(Oh.a.F5f,this.ak.CLd)]}RKl(){return[h(Oh.a.rnf,this.ak.Q6h),h(Oh.a.T2e,this.ak.J6h)]}UKl(){return[h(Oh.a.rnf,this.ak.Q6h,"Increase Indent"),h(Oh.a.T2e,this.ak.J6h,"Decrease Indent")]}}
Object(m.a)(eI,"ShortcutDiscoverySettings",null,[]);class fI{constructor(){this.hOg=X.a.sNa;this.ak=new rF.a(X.a.wl||X.a.mi);this.hVb=new eI(this.ak)}FJl(){let b=this.HJl();this.hOg&&(b=b.concat(this.IJl()));return b}GJl(){return this.Vhf(this.hVb.RKl())}yql(){let b=this.Aql();this.hOg&&(b=b.concat(this.Bql()));return b}zql(){return this.Cdf(this.hVb.UKl())}IJl(){return this.Vhf(this.hVb.SKl())}HJl(){return this.Vhf(this.hVb.QKl())}Bql(){return this.Cdf(this.hVb.VKl())}Aql(){return this.Cdf(this.hVb.TKl())}Vhf(b){const k=
[];b.forEach(r=>{k.push(appChrome.actions.setButtonSecondaryText(r.actionId,r.P3i))});return k}Cdf(b){const k=[];b.forEach(r=>{k.push(appChrome.actions.setControlCustomTooltip(r.actionId,this.iif(r.label,r.P3i)))});return k}iif(b,k){return b+" ("+k+")"}}Object(m.a)(fI,"ShortcutActionHelper",null,[]);class gI extends RD{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td=null,ne,ye){super(b,k,r,y,R,aa,ta,Ya,xb,!1,cc,Td);this.CHe=Mb.x8d();this.GWj=Mb.r0f();this.ak=jc;this.D1g=Mc;this.E1g=fd;this.Vt=
Va.a.instance.$a("Common.ISystemInitiatedFeedback");this.x6n();this.Hb=ne;this.Nqe=ye}r6l(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");kj.a.get_instance().EK(5);const b=this.uqf&&n.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;kj.a.get_instance().Gl(b,Object(u.a)(this,this.i5l,"initializeFullRibbon"),11);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.v5j()}x6j(){this.Hb.fc(new nd.a(5,1,n.AFrameworkApplication.K.rc("TickIntervalTimeForShortcutDiscovery",
1E3),()=>{this.PKl()}))}v5j(){this.Hb.fc(new nd.a(5,1,0,()=>{this.Nqe.execute(b=>{b.yPn()})}))}PKl(){const b=[],k=new fI;b.push(...k.FJl(),...k.yql());null!=n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableHeadingDiscovery",!1)&&b.push(...k.GJl(),...k.zql());appChrome.api.dispatch(b)}pml(){const b=[];this.D1g&&(b.push(appChrome.actions.setButtonSecondaryText(Oh.a.Eyd,this.ak.y_l)),b.push(appChrome.actions.setButtonSecondaryText(Oh.a.cxd,
this.ak.x_l)),b.push(appChrome.actions.setButtonSecondaryText(Oh.a.L_d,this.ak.A_l)));this.E1g&&b.push(appChrome.actions.setButtonSecondaryText(Oh.a.I_d,this.ak.B_l));return b}Vbk(){this.Vt&&this.Vt.execute(b=>{b.logActivity("WordShyRibbon",null)});return 32}ETn(){this.Vt&&appChrome.api.isSmallDevice()?this.Vt.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",null)}):this.Vt.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});n.AFrameworkApplication.ya.gb(ib.a.pch,zc.a.frame,
Object(u.a)(this,this.Vbk,"alwaysShowRibbonSurvey"),96)}i5l(){ld.a.instance.Xf(df.a.s6l,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(b=>{if(!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1)&&!n.AFrameworkApplication.K.$("CollabCornerCleanupIsEnabled")){var k=n.AFrameworkApplication.K.$("ShareMenuIsEnabled"),r=k?"ShareTopBar":"Share";this.CHe?b.push(this.WKl(r)):b.push(appChrome.actions.removePeripheralControl(r));
this.GWj?b.push(this.XKl()):b.push(appChrome.actions.removePeripheralControl("CopyLink"));k&&!this.CHe&&b.push(appChrome.actions.updateControlHiddenState("ShareMenu",!this.CHe))}this.QIa&&b.push.apply(b,this.X1h());(this.D1g||this.E1g)&&this.ak&&b.push.apply(b,this.pml());n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutDiscovery",!1)&&kj.a.get_instance().Gl(7,()=>{this.x6j()});b.push(appChrome.actions.setControlCustomTooltip(Oh.a.btm,CommonUIStrings.l_LoopsLearnMoreTooltip));
n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Ima&&this.ETn();appChrome.api.isSmallDevice()&&n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.KI&&!n.AFrameworkApplication.jQ&&n.AFrameworkApplication.Gaa("Microsoft.Office.Web.SessionSettings.IWacWordShyRibbonSettings");b.push.apply(b,this.DBa());b.push(appChrome.actions.setControlBehaviorAttached(!0));const y=Va.a.instance.resolve("WordEditor.IModeSwitcherControl");k=y.Cxl();n.AFrameworkApplication.Ne("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(r=appChrome.selectors.getModeSwitcherMode())&&r!==k.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${k.activeMode}, Actual: ${r}`);(r="Suggest"===k.activeMode)&&n.AFrameworkApplication.Ne("7aj80981;1e3dc950");n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowReviewTabInReviewMode",
!1)&&r||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===k.activeMode?appChrome.getUpdateAppModeAndTabsActions(k).then(R=>{appChrome.api.dispatch(b.concat(R));y.Rri();this.C9h()}):(b.push(appChrome.actions.updateModeSwitcher(k)),appChrome.api.dispatch(b),y.Rri(),this.C9h())})}C9h(){n.AFrameworkApplication.abc.Ngo();this.H8g();this.MUe();this.w9h();kj.a.get_instance().EK(7);ld.a.instance.Jja(df.a.Wyc,df.a.ZBn,(new Date).getTime())}x6n(){null!=
n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("CollabCornerFloodgateSurveyFileSharedStatusIsEnabled")&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",!1)&&2===n.AFrameworkApplication.Gt.L3i&&(this.NO=Va.a.instance.$a("Common.App.HostNotification.EditNotificationEventSource"))&&this.NO.execute(b=>{b.HVa(Object(u.a)(this,this.bej,"triggerCollabCornerFileSharedStatusSurvey"))})}bej(){const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");
b&&window.setTimeout(()=>b.execute(k=>{k.logActivity("ToggleCollabCornerFileSharedStatusSurvey","CollabCornerFloodgateSurveyFileSharedStatusIsEnabled");this.NO&&this.NO.execute(r=>{r.zcc(Object(u.a)(this,this.bej,"triggerCollabCornerFileSharedStatusSurvey"))})}),12E4)}BFa(b){if(b){const k=this.ZSh();try{super.BFa(b)}finally{null===k||void 0===k?void 0:k.dispose()}}}DBa(){const b=this.ZSh();try{return super.DBa()}finally{null===b||void 0===b?void 0:b.dispose()}}ZSh(){var b;let k=void 0;const r=null===
(b=Ka.App.ik)||void 0===b?void 0:b.ml;r&&(k=new sf.GraphTransaction(Ka.App.Gdi()&&Ka.App.Crf?0:2),k.set(r));return k}}Object(m.a)(gI,"ReactRibbonUser",RD,[]);var JL=c(1129);class hI extends DF{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,r);b=!1;n.AFrameworkApplication.K.$("HidePasteTextOnlyInRibbonChrome")||(b=!y.Xkb);this.pve=n.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&(X.a.L2||X.a.yp&&b);this.rm=R;this.sEe=aa;this.Hb=ta;this.Nqe=Ya}POk(b,k){const r=new PC(n.AFrameworkApplication.K,
this.ga,this.Ub,this.pve),y=new AL.a(r);return this.iPk(b,k,y,r)}iPk(b,k,r,y){var R=new NH(new OH(n.AFrameworkApplication.K,y),r);r=this.Q5l(R);const aa={};R.Qkb(aa);R=!X.a.L2;const ta=X.a.yp||X.a.gj;var Ya=X.a.wl;n.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ya=X.a.mi||Ya);Ya=new rF.a(Ya);b=new gI(b,k,WordEditorIntl.WordEditorStrings,this.Upb,y,b,this.rm,r,new JH(aa),new JL.a(null),this.sEe,Ya,R,ta,new MH,this.Hb,this.Nqe);b.r6l();return b}Q5l(b){const k={};b.s_c(k);b.b4c(k);
return new KH(null,k,"jewelWordEditor")}}Object(m.a)(hI,"WordEditorRibbonUserFactory",DF,[]);class JF{constructor(b,k){this.zz=b;this.Mgd=k}gLa(b,k,r,y=null,R=null){return this.Mgd.q4i(b)?this.Mgd.gLa(b,k,r,y,R):this.zz.gLa(b,k,r,y,R)}LCa(b,k=null){return this.Mgd.q4i(b)?this.Mgd.LCa(b):this.zz.LCa(b,k)}}Object(m.a)(JF,"RootCuiUser",null,[232]);class iI extends JF{constructor(b,k){super(b,k)}clearCache(){this.zz.clearCache()}}Object(m.a)(iI,"WordGeneralCuiUser",JF,[231,232]);class JE{static getSelectedText(){const b=
(new dq.a).Xhf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static THd(b){b=b?b.trim():null;let k=20;b&&0<b.length&&(b.length>k&&(k=A.a.Ty(b,k)?k-1:k),b=b.length>k?b.substr(0,k).trim()+"...":b);return b}}Object(m.a)(JE,"SearchUtils",null,[]);class Cx extends uE{constructor(b,k,r){super(b,r);this.CH=k}tbf(b){const k=[],r=bh.a.instance.ib.kb,y=!!this.CH&&this.CH.fPc(Wa.a.uWe.toString()),R=!!this.CH&&this.CH.fPc(Wa.a.AIb.toString()),aa=!y&&!r.C6b&&Cx.R2a.asi(),ta=!!this.CH&&this.CH.fPc(ib.a.newComment.toString())||
!!da.a.instance&&(3===da.a.instance.mode||2===da.a.instance.mode),Ya=r.pii()&&n.AFrameworkApplication.ta.Rb.YOc;var xb=!1;if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){xb=!!r&&(r.MC||2===r.length&&rf.SelectionEditor.qk(r.Tc));var Mb=JE.getSelectedText();xb=xb&&0<Mb.length&&60>Mb.length}b=(Mb=3===b||X.a.mi||n.AFrameworkApplication.kaf)&&Cx.s6e.DZ(r,b);Mb&&k.push(this.rm.SLa("ClipboardGroup")[0].externalUxGroupId);
aa&&(k.push(this.rm.SLa("TextFormattingGroup")[0].externalUxGroupId),k.push(this.rm.SLa("StylesGroup")[0].externalUxGroupId));xb&&k.push(this.rm.SLa("DefineGroup")[0].externalUxGroupId);y&&k.push(this.rm.SLa("PictureToolsGroup")[0].externalUxGroupId);R&&k.push(this.rm.SLa("TableToolsGroup")[0].externalUxGroupId);Ya&&k.push(this.rm.SLa("EquationToolsGroup")[0].externalUxGroupId);ta&&k.push(this.rm.SLa("CommentGroup")[0].externalUxGroupId);b&&k.push(this.rm.SLa("ContextMenuGroup")[0].externalUxGroupId);
return k}static get s6e(){return null!=Cx.njg?Cx.njg:Cx.njg=Va.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get R2a(){return null!=Cx.lrg?Cx.lrg:Cx.lrg=Va.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static nMc(b,k,r,y){b.Ijk(()=>Cx.pbb(k,r,y))}static pbb(b,k,r){return new Cx(b,k,r)}}Object(m.a)(Cx,"WordReactFloatie",uE,[]);class KF{constructor(){this.oca=this.mwc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").RLf();
const k=Ka.App.Ev.eI,r=Ka.App.xa;Cx.nMc(r,this.W.resolve("Common.IReactContextualUILauncher"),k,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.oca=this.W.Pa("Box4.IContextMenuController");const y=new cH(r,k,this.W.$a("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),R={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",
0)){case 1:R["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:R["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:R["floatie.gbUseSmartPasteButton"]=!1}y.nMc("PasteFloatieData",null,R);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new AH(r,k,this.W.$a("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).nMc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");kj.a.get_instance().Gl(7,()=>
{this.mwc=this.W.resolve("WordEditor.UI.StatusBarUser");this.mwc.Vb()})}dispose(){this.mwc&&(this.mwc.dispose(),this.mwc=null);this.oca&&(this.oca.dispose(),this.oca=null)}zc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new gH(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),n.AFrameworkApplication.ya,n.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();
let k=X.a.wl;n.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(k=X.a.mi||k);b.ha("Box4.UI.ShortcutHintMapping",()=>new rF.a(k));const r=X.a.yp||X.a.gj,y=n.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(X.a.L2||r),R=n.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new fa(Va.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Va.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Fe.a)).singleInstance();
b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new tq(n.AFrameworkApplication.ya,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),n.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,R?b.$a("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Pa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.$a("Box4.IPresenceDataManager"),b.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.$a("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
y,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Va.a.instance.$a("Common.IActionContextProvider"),Va.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Pa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Bx).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new Kl(n.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();
b.ha("WordEditor.UI.DialogFactory",()=>new zH).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new EG(Id.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new iI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new EH(Ka.App.xa.i3f,b.$a("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),n.AFrameworkApplication.ya,n.AFrameworkApplication.K,Ka.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new ND).singleInstance();const aa=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new rE(Qq.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),aa)).singleInstance();const ta=b.$a("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new hI(ta,n.AFrameworkApplication.ya,Id.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),n.AFrameworkApplication.uc,b.$a("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new OD(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");
b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new IH(n.AFrameworkApplication.ya)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new GH(n.AFrameworkApplication.ya)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new BH).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new kA(n.AFrameworkApplication.ya,Va.a.instance.$a("Common.IZoomManager"),lt.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();
b.ha("Common.IReactContextualUILauncher",()=>new ZG(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new dH(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){n.AFrameworkApplication.Ne("5b6i5792;30d4f535");Zh.instance.HEh();Zh.instance.Y6e();M.a.instance.Pc(new KF,6)}}Object(m.a)(KF,"WordEditorUIPackage",null,[1,2]);var KL=window.ExternalContentFloatieData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",
attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",
QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},iB={};iB.Gic=function(){function b(){return ta()&&(Td()||3<=(jc()?ne("version/"):0))}function k(){return 0<=window.navigator.userAgent.indexOf("Windows")}
function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function y(Lf){Lf=(new RegExp(Lf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var $h=-1;null!=Lf&&2<=Lf.length&&($h=parseFloat(Lf[1]),isNaN($h)&&($h=-1));return $h}function R(){jI||(jI=!0,kI=y("Windows Phone"));return 8<=kI}function aa(){return"function"==typeof navigator.msLaunchUri&&!r()&&!fd()&&!Ya()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ya(){return 0<=window.navigator.userAgent.indexOf("Edge/")}
function xb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Mb(){return xb()?8==window.document.documentMode:!1}function cc(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function jc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Mc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function fd(){var Lf=window.navigator.userAgent.toLowerCase();return 0<=Lf.indexOf("android")&&
0<=Lf.indexOf("chrome")}function Td(){return 3<=(cc()?ne("firefox/"):0)}function ne(Lf){var $h=window.navigator.userAgent.toLowerCase(),Cl=$h.indexOf(Lf);return 0<=Cl?parseInt($h.substring(Cl+Lf.length,$h.length)):0}function ye(Lf,$h,Cl,fl,qp){if(fl&&null!=$h)$h();else if(aa())navigator.msLaunchUri(Lf,$h,Cl);else if(!(Mc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Ya())Gd(Lf,$h,Cl);else if(Mc()&&qp)a:{try{window.open(Lf,
"_self")}catch(Kr){null!=Cl&&Cl();break a}null!=$h&&$h()}else ff(Lf,$h,Cl)}function ff(Lf,$h,Cl){var fl=document.getElementById("OICLinkTag");null==fl&&(fl=document.createElement("a"),fl.id="OICLinkTag",fl.style.visibility="hidden",fl.href="",0==(Yp.Options&Uv.SupportsTopTargetNavigation)||Yp.NoBrowserModalDialogs?fl.target="_blank":fl.target="_top",document.body.appendChild(fl),null!=fl.addEventListener&&fl.addEventListener("click",function(qp){null!=qp.stopPropagation&&qp.stopPropagation()},!1));
try{fl.href=Lf,fl.click()}catch(qp){null!=Cl&&Cl();return}null!=$h&&$h()}function Gd(Lf,$h,Cl){var fl=document.getElementById("OICFrame");null==fl&&(fl=document.createElement("iframe"),fl.className="ObjectInDialog",fl.style.visibility="hidden",fl.src="about:blank",document.body.appendChild(fl),fl.id="OICFrame");try{fl.contentWindow.location.href=Lf}catch(qp){null!=Cl&&Cl();return}null!=$h&&$h()}function oe(Lf){return 0!=(Lf.Options&Uv.SkipProtocolHandler)||Mb()}function ze(Lf){return Lf===jB.ReadOnly||
Lf===jB.ReadWrite}function ug(Lf,$h,Cl,fl){var qp;try{var Kr=new ActiveXObject("SharePoint.OpenDocuments.4");return(qp=Kr.ViewDocument3(window.self,Lf,$h,fl))?(SC(uz.O14ActiveX),bp.None):bp.Failed}catch(Lr){}if(Uv.O14Only===(Cl&Uv.O14Only))return Yp.DescriptiveUnattemptedEnums?bp.O14AttemptFailure:bp.Unattempted;try{return Kr=new ActiveXObject("SharePoint.OpenDocuments.3"),(qp=Kr.ViewDocument3(window.self,Lf,$h,fl))?(SC(uz.O12ActiveX),bp.None):bp.Failed}catch(Lr){}if(Uv.O12UpOnly===(Cl&Uv.O12UpOnly))return Yp.DescriptiveUnattemptedEnums?
bp.O12UpOnlyFail:bp.Unattempted;try{return Kr=new ActiveXObject("SharePoint.OpenDocuments.2"),(qp=ze($h)?Kr.ViewDocument2(window.self,Lf,fl):Kr.EditDocument2(window.self,Lf,fl))?(SC(uz.O11ActiveX),bp.None):bp.Failed}catch(Lr){}return Yp.DescriptiveUnattemptedEnums?bp.ActiveXUnattempted:bp.Unattempted}function Yf(Lf,$h,Cl,fl,qp){Lf==Sq.Visio&&Cl==jB.ReadWrite&&(Cl=jB.WriteOnly);Lf=qp;fl=fl||r()&&!R();fl||(fl="",fl=ze(Cl)?fl+"ofv|ofc|":fl+"ofe|",Lf+=cn(fl+"u|"));Lf+=cn($h);Yp.NewTelemetryDataIsEnabled&&
($h=-1!==Lf.indexOf("?")?"&":"?",$h+=Yp.SessionOrigin?"OR="+Yp.SessionOrigin+"&":"",$h+=Yp.ClickTime?"CT="+Yp.ClickTime+"&":"",$h+=Yp.CorrelationId?"CID="+Yp.CorrelationId:"",$h="?"!=$h?$h:"",$h="&"!=$h.slice(-1)?$h:$h.slice(0,-1),Lf+=cn($h));$h=window.location.href;Cl=$h.toLowerCase().indexOf("&wdlor=");-1!=Cl?(Cl+=7,fl=$h.indexOf("&",Cl),$h=-1==fl?$h.substr(Cl):$h.substring(Cl,fl)):$h=void 0;if(null!=$h&&"undefined"!=typeof $h){Cl="";try{Cl=decodeURIComponent($h)}catch(Kr){}0<Cl.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Cl)&&
(Lf=Lf+"|f|"+Cl)}return Lf}function Aj(Lf,$h,Cl,fl,qp,Kr){var Lr=lI(Lf);if(null==Lr)return aC(Yp.DescriptiveUnattemptedEnums?bp.ProtocolHandlerIsNull:bp.Unattempted,Yp.Application),!1;Lf=Yf(Lf,$h,Cl,fl,Lr);ye(Lf,Vl,st,qp,Kr);return!0}function cn(Lf){if(ta()&&Mc()){var $h="";try{$h=decodeURI(Lf)}catch(Cl){}if($h==Lf)return encodeURI(Lf)}return Lf}function Vl(){SC(uz.ProtocolHandler)}function st(){Yp.Options|=Uv.SkipProtocolHandler;mI(Yp,TC,UC)}function tt(){null!=LF&&LF(uz.RoamingProtocolHandler)}
function Rv(){null!=MF&&MF(bp.ControlNeeded)}function lE(){var Lf=document.getElementById("npSharePointPlugin");if(null==Lf){Lf="application/x-sharepoint";ta()&&3<=(jc()?ne("version/"):0)&&Iw("application/x-sharepoint-webkit",!0)&&(Lf="application/x-sharepoint-webkit");if(!Iw(Lf,!0))if(ta()&&Iw("application/officelive",!0))Lf="application/officelive";else return null;var $h=document.createElement("object");$h.id="npSharePointPlugin";$h.type=Lf;$h.style.width="0px";$h.style.height="0px";$h.style.setProperty("visibility",
"hidden","");document.body.appendChild($h);Lf=document.getElementById("npSharePointPlugin")}return Lf}function Iw(Lf,$h){var Cl=window.navigator.mimeTypes;if(null==Cl)return!1;Lf=Cl[Lf];return!Lf||$h&&!Lf.enabledPlugin?!1:!0}function KE(Lf){try{if(null!=new ActiveXObject(Lf))return!0}catch($h){}return!1}function NF(Lf){switch(Lf){case Sq.OneNote:return"OneNote.Notebook";default:return""}}function lI(Lf){if(Lf!=Sq.OneNote&&r()&&!R())return"office:";switch(Lf){case Sq.Excel:return"ms-excel:";case Sq.OneNote:return"onenote:";
case Sq.PowerPoint:return"ms-powerpoint:";case Sq.Visio:return"ms-visio:";case Sq.Word:return"ms-word:";case Sq.Project:return"ms-project:";case Sq.Publisher:return"ms-publisher:";case Sq.Infopath:return"ms-infopath:";case Sq.Access:return"ms-access:";default:return""}}function LL(Lf){switch(Lf){case Sq.Excel:return"root\\office15\\excel.exe";case Sq.PowerPoint:return"root\\office15\\powerpnt.exe";case Sq.Visio:return"root\\office15\\visio.exe";case Sq.Word:return"root\\office15\\winword.exe";case Sq.Project:return"root\\office15\\winproj.exe";
case Sq.Publisher:return"root\\office15\\mspub.exe";case Sq.Infopath:return"root\\office15\\infopath.exe";case Sq.Access:return"root\\office15\\msaccess.exe";default:return null}}function mI(Lf,$h,Cl){Yp=Lf;TC=$h;UC=Cl;if(Lf.DocumentUrl){var fl=Cl=$h=Lf.DocumentUrl;try{fl=decodeURIComponent(Lf.DocumentUrl)}catch(VC){}try{Cl=encodeURI(Lf.DocumentUrl)}catch(VC){}$h=$h+""+Lf.CorrelationIdForWinClient;fl+=Lf.CorrelationIdForWinClient;Cl+=Lf.CorrelationIdForWinClient;Lf.Mode===jB.ReadWrite&&Uv.CheckoutRequired===
(Lf.Options&Uv.CheckoutRequired)&&(Lf.Mode=jB.ForceCheckout);Uv.HostIsEditOnly===(Lf.Options&Uv.HostIsEditOnly)&&(Lf.Mode=jB.WriteOnly);if(oe(Lf)?0:ta()&&(Lf.Application==Sq.OneNote||Iw("application/x-sharepoint-protocolhandler",!1)||Iw("application/x-sharepoint-webkit-protocolhandler",!1))||aa()||fd()||!(b()||Td()||"ActiveXObject"in window&&!r()||Mc())||15<=LE())Aj(Lf.Application,Lf.EncodeUrl?Cl:$h,Lf.Mode,Lf.Application==Sq.OneNote,Lf.SilentExternalHandler,Lf.NavigateUsingWindowOpen);else{var qp;
if(qp=Mb())a:{var Kr=Lf.EncodeUrl?$h:fl,Lr=Lf.Mode,SD=NF(Lf.Application);try{qp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Kr,Lr,SD);break a}catch(VC){}qp=!1}if(qp)SC(uz.O15ActiveX);else{if(b()||Td()){var Ds=Lf.EncodeUrl?$h:fl;fl=Lf.Mode;qp=NF(Lf.Application);Kr=lE();if(null==Kr)Ds=Yp.DescriptiveUnattemptedEnums?bp.PluginIsNull:bp.Unattempted;else{Lr=!1;try{Lr=Kr.ViewDocument3(window.self,Ds,fl,qp)}catch(VC){}if(!Lr)try{Lr=ze(fl)?Kr.ViewDocument2(window.self,Ds,qp):
Kr.EditDocument2(window.self,Ds,qp)}catch(VC){}Lr?(SC(uz.NpapiPlugin),Ds=bp.None):Ds=bp.Failed}}else{try{Ds=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ds&&Ds.SaveSSOCreds()}catch(VC){}Ds=ug(Lf.EncodeUrl?$h:fl,Lf.Mode,Lf.Options,NF(Lf.Application))}if(Ds!=bp.None){if(fl=Lf.CouldUseRoamingApps)nI||(nI=!0,oI=y("Windows NT")),fl=6.1<=oI&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(xb()||Td()||Mc());if(fl&&Lf.Application!=Sq.OneNote){if(!iB.Gic.pzo()){aC(bp.ControlNeeded,Yp.Application);return}if(Lf.RoamingAppsLauncher){"undefined"==
typeof Lf.RoamingAppsLauncher||null==Lf.RoamingAppsLauncher?aC(Yp.DescriptiveUnattemptedEnums?bp.RoamingLauncherIsNull:bp.Unattempted,Yp.Application):"undefined"==typeof Lf.RoamingBitsUrl||null==Lf.RoamingBitsUrl?iB.Gic.PAo(Lf.DocumentUrl,Lf.RoamingAppsLauncher,Lf.Application,Lf.ApplicationParameters,TC,UC):iB.Gic.Frj(Lf.DocumentUrl,Lf.RoamingAppsLauncher,Lf.RoamingApplicationExe,Lf.ApplicationParameters,Lf.RoamingPlatform,Lf.RoamingBitsUrl,TC,UC);return}if(!Lf.ContinueIfLauncherIsNull){aC(bp.LauncherNeeded,
Yp.Application);return}}Uv.NoProtocolHandlerFallback==(Lf.Options&Uv.NoProtocolHandlerFallback)||oe(Lf)||xb()||ta()&&!(Yp.DescriptiveUnattemptedEnums?Ds>=bp.O14Unattempted&&Ds<=bp.DocumentUrlIsNull:Ds==bp.Unattempted)?aC(Ds,Yp.Application):Aj(Lf.Application,Lf.EncodeUrl?Cl:$h,Lf.Mode,Lf.Application==Sq.OneNote,Lf.SilentExternalHandler,Lf.NavigateUsingWindowOpen)}}}}else aC(Yp.DescriptiveUnattemptedEnums?bp.DocumentUrlIsNull:bp.Unattempted,Yp.Application)}function SC(Lf){null!=TC&&TC(Lf)}function aC(Lf,
$h){"undefined"==typeof $h&&($h=null);null!=UC&&UC(Lf,$h)}function LE(){var Lf=0;if(b()||Td()||Mc()){var $h=lE();try{null!=$h&&(Lf=$h.GetOfficeVersion())}catch(Cl){}}else KE("SharePoint.OpenDocuments.5")?Lf=15:KE("SharePoint.OpenDocuments.4")?Lf=14:KE("SharePoint.OpenDocuments.3")?Lf=12:KE("SharePoint.OpenDocuments.2")&&(Lf=11);return Lf}function pI(){return ta()&&(Iw("application/x-sharepoint",!0)||Iw("application/x-sharepoint-webkit",!0))}var qI="",rI="",sI="",TC,UC,LF,MF,Yp,nI,oI,jI,kI,jB={ReadWrite:0,
ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Uv={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},bp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},uz={Unknown:0,
NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Sq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:jB,OpenDocumentOptions:Uv,OpenDocumentFailureType:bp,OpenDocumentControl:uz,OfficeApplication:Sq,EditDocumentInClient:mI,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=
Sq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:LE,IsO14MacPluginInstalled:pI,
OfferOfficeInDialog:function(){return k()&&11>=LE()},OfferOfficeNoIntrusive:function(){return k()&&15>LE()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!pI()},InstallRoamingControl:function(){cc()?window.InstallTrigger.install({Office:{URL:rI}}):Gd(sI,null,null)},CanUseRoamingControl:function(){if(aa())return!0;if(Mc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(cc()){var Lf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Lf);var $h=document.createEvent("Events");$h.initEvent("RoamingOfficeInstalled",!0,!1);Lf.dispatchEvent($h);return!!Lf.getAttribute("installed")}if(xb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Cl){}return!1},InitUrls:function(Lf,$h,Cl){qI=Lf;rI=Cl;sI=$h},LaunchRoamingApps:function(Lf,$h,Cl,fl,qp,Kr){iB.Gic.Frj(Lf,$h,LL(Cl),fl,"x86",qI,qp,Kr)},LaunchRoamingApps2:function(Lf,
$h,Cl,fl,qp,Kr,Lr,SD){var Ds="";null!=fl&&(Ds+=" "+fl);null!=Lf&&(Ds+=' "'+Lf+'"');if(aa()||Mc())LF=Lr,MF=SD,Lr='office: "'+(Kr+'" "')+(Cl+'" "ROAMING"'),Lr+=' "'+$h+'"',Lr+=' "'+qp+'"',Lr+=" "+Ds,ye(Lr,tt,Rv,!1,!1);else if(cc())Lf=document.createElement("RoamingExtensionElement"),Lf.setAttribute("cabUrl",Kr),Lf.setAttribute("app",Cl),Lf.setAttribute("licensingEntitlements",$h),Lf.setAttribute("platform",qp),Lf.setAttribute("args",Ds),document.documentElement.appendChild(Lf),$h=document.createEvent("Events"),
$h.initEvent("RoamingOfficeLaunch",!0,!1),Lf.dispatchEvent($h),null!=Lr&&Lr(uz.RoamingFFExtension);else if(xb()){if(Lf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Lf)try{Lf.HrConfigureSingle(Kr,Cl,$h,qp,Ds),null!=Lr&&Lr(uz.RoamingActiveX)}catch(VC){}}else null!=SD&&SD(bp.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:ff,OpenDocumentWithProtocolHandler:Aj,OpenDocumentWithProtocolHandlerNoCallBack:function(Lf,$h,Cl,fl){var qp=lI(Lf);if(null==qp)return aC(Yp.DescriptiveUnattemptedEnums?
bp.ProtocolHandlerNoCallbackIsNull:bp.Unattempted,Yp.Application),!1;Lf=Yf(Lf,$h,Cl,fl,qp);ye(Lf,null,null,!1,!1);return!0}}}();iB.ClientUtils=iB.Gic;var ML=c(1437);class ME{constructor(b,k,r){this.ga=b;this.OKj=k;this.Z4=r}Vb(){this.ga.pa(ib.a.tryMacOffice,zc.a.frame,Object(u.a)(this,this.a0m,"onTryMacOffice"));this.ga.pa(ib.a.vfj,zc.a.frame,Object(u.a)(this,this.nCi,"onTryMacOfficeFromViewer"));this.ga.pa(ib.a.ufj,zc.a.frame,Object(u.a)(this,this.nCi,"onTryMacOfficeFromViewer"))}a0m(b,k,r,y,R){if(1===
r)return 32;R?(b=R.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Qe.a.Gm(Oa.a.HYa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&Qe.a.Gm(Oa.a.HYa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Pli();return 32}nCi(b,k,r){if(1===r)return 32;switch(b){case ib.a.vfj:Qe.a.Gm(Oa.a.HYa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case ib.a.ufj:Qe.a.Gm(Oa.a.HYa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Pli(){Qe.a.Gm(ME.LFm,
"_blank",void 0,"LaunchMacTrialWindow")}get r0c(){return this.OKj&&X.a.wl&&!X.a.htf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get kWn(){const b=this.r0c;b||n.AFrameworkApplication.Hm.ZJn();return b}get jWn(){return this.r0c}static get LFm(){return Oa.a.w6("522401")}}Object(m.a)(ME,"MacOfficeOffer",null,[1067]);class NE{constructor(b,k,r){this.ga=b;this.UKj=k;this.pR=null;(this.dpd=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(y=>{this.pR=y});this.Z4=r}Vb(){this.ga.pa(ib.a.tryOffice,zc.a.frame,Object(u.a)(this,this.b0m,"onTryOffice"));this.ga.pa(ib.a.K7f,zc.a.frame,Object(u.a)(this,this.K7f,"tryOfficeThroughTellMe"));this.ga.pa(ib.a.Bfj,zc.a.frame,Object(u.a)(this,this.Cfj,"tryOfficeThroughViewer"));this.ga.pa(ib.a.Afj,zc.a.frame,Object(u.a)(this,this.Cfj,"tryOfficeThroughViewer"))}b0m(b,k,r,y,R){if(this.dpd&&1===r)return this.isFreemiumUpsellEnabled&&
this.s0c?32:8;2===r&&(R?(b=R.SourceControlId,"btnjTryOfficeForWordEditor"===b?Qe.a.Gm(Oa.a.HYa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?Qe.a.Gm(Oa.a.HYa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.rwf()):this.rwf());return 32}K7f(b,k,r,y,R){if(this.dpd&&1===r)return this.isFreemiumUpsellEnabled&&this.s0c?32:8;2===r&&(R?(b=R.SourceControlId,Qe.a.Gm(Oa.a.w6("862405")+this.fFl(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
Qe.a.Gm(Oa.a.w6("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Cfj(b,k,r){if(this.dpd&&1===r)return this.isFreemiumUpsellEnabled&&this.s0c?32:8;if(2===r)switch(b){case ib.a.Bfj:Qe.a.Gm(Oa.a.HYa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case ib.a.Afj:Qe.a.Gm(Oa.a.HYa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get jQm(){return this.s0c}get iQm(){return this.s0c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get s0c(){return this.UKj&&!X.a.wl}get isFreemiumUpsellEnabled(){let b=
!1;this.pR&&(b=this.pR.isFreemiumUpsellEnabled());return b}rwf(b=null){let k=0;b&&(k=b);Qe.a.Gm(NE.lzl(k),"_blank",void 0,"LaunchOfficeOffer")}fFl(b){let k=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":k=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":k=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":k=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":k=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":k=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":k=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":k=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":k=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":k=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":k=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":k=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":k=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":k=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":k=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":k=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":k=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":k=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":k=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":k=29}return 0===k?"":String.format("&pc={0:D}",k)}static lzl(b){if(X.a.mi)switch(b){case 1:return Oa.a.w6("393806");case 2:return Oa.a.w6("393810");case 3:return Oa.a.w6("393809");case 5:return Oa.a.w6("393805")}else if(X.a.QL)switch(b){case 1:return Oa.a.w6("521979");
case 3:return Oa.a.w6("521980");case 5:return Oa.a.w6("521978");case 2:return Oa.a.w6("522490")}else{if(2===b)return Oa.a.w6("517778");if(1===b)return Oa.a.HYa(30)}return Oa.a.w6("522402")}}Object(m.a)(NE,"OfficeTrialExperience",null,[1065]);class tI{zc(b){b.register(NE,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Zd(()=>new NE(n.AFrameworkApplication.ya,n.AFrameworkApplication.Isf,n.AFrameworkApplication.lcid));b.register(ME,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Zd(()=>
new ME(n.AFrameworkApplication.ya,n.AFrameworkApplication.Wfi,n.AFrameworkApplication.lcid))}}Object(m.a)(tI,"OpenInClientConfiguration",null,[2]);var NL=c(1161);class zy{constructor(b,k,r,y,R,aa,ta){this.ag=b;this.characterPropertiesEditor=k;this.$V=r;this.S8e=y;this.Oj=R;this.Rd=aa;this.iMa=ta}F7l(b,k){var r;b=k.view;k=k.rk;if(!k||!this.ag.Ndi(k,!0)||this.S8e&&this.S8e.instance&&this.S8e.instance.KT(k))return 2;var y=zy.Iba?!zy.GI.wma(k):!0;this.$V&&y&&this.$V.shc(k.node,tb.a.hs,k.cpBegin);y=k.node;
(null===(r=this.iMa)||void 0===r?0:r.replaceText)&&this.iMa.YDb(y)?(r=y.qa.EXa(k.cpBegin),this.iMa.replaceText(y,r,r,lo.a.QQc)):this.characterPropertiesEditor.ifa(k,R=>new lo.a(R));if(this.Rd.og){r=new sf.GraphTransaction(15);try{r.Eb(k.node),this.Oj.toa(k.node,k.cpBegin,k.cpBegin+1,1)}finally{r&&r.dispose()}}y=k.node;r=k.cpEnd+1;" "===ie.ParagraphReader.text(y).charAt(r)&&(y=Re.a.createTextRange(y,r,r+1),this.characterPropertiesEditor.replaceTextRange(y,"\u00a0"));k=Re.a.Uc(k.node,r);b.Cb.setSelection(Ke.SelectionFactory.fo(k));
return 32}static get GI(){return null!=zy.Ulg?zy.Ulg:zy.Ulg=Va.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Iba(){null==zy.o1&&(zy.o1=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return zy.o1}}zy.o1=null;Object(m.a)(zy,"InsertLineBreakStrategy",null,[]);class ku{static get Ug(){return null!=ku.Cpg?ku.Cpg:ku.Cpg=Va.a.instance.resolve("Box4.IOutlineElementEditor")}static get Sg(){return tm.ContextSetEditor.instance}static get Oj(){return null!=
ku.Tsg?ku.Tsg:ku.Tsg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Rd(){return null!=ku.xtg?ku.xtg:ku.xtg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static c8l(b,k,r,y,R){if(R&&R.hasProperty(td.a.targetObject)){var aa=k.view.ld.Mc.Db(R.getValue(td.a.targetObject));aa=Re.a.create(aa)}else aa=ku.Sg.AS(k.rk,11);if(!aa)return 8;b=n.AFrameworkApplication.ya.Vf(aa,b,r,!0,y,R);if(32===b&&2===r){if(!k.view.ye)return 2;k=k.view;y=
k.Cb.Jg;if(y=ku.Sg.AS(y,11)){r=new Wh.a;r.set(y.node);r.rd();if(R&&R.hasProperty(td.a.targetObject))for(R=R.wg(td.a.targetObject);!r.currentNode.id.equals(R)&&r.mc()&&(xg.OutlineElementNavigator.Xd(r),11===r.Le););xg.OutlineElementNavigator.e3(r,!1,!1);R=rf.SelectionEditor.aBa(r,!0);R=ie.ParagraphReader.Cu(R)?Ke.SelectionFactory.xe(R,0):Ke.SelectionFactory.Sq(R);k.Cb.setSelection(R)}}return b}static VMd(b,k,r,y,R){b=b===Wa.a.EMc;k=k.node;if(R&&R.hasProperty(td.a.targetObject)&&!k.id.equals(R.wg(td.a.targetObject)))return 2;
if(1===r)return 32;r=new Wd.GraphIterator;r.set(k);r.Ab(10);ku.Ug.TB(r,b,!0);ku.Rd.og&&(r=xg.OutlineElementNavigator.Fe(r),ku.Oj.zKb(r,1));return 32}}Object(m.a)(ku,"InsertOutlineElementStrategy",null,[]);class kB{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){this.dY=k;this.dEj=b;this.Jw=aa;this.AG=R;this.Kh=r;this.bCj=y;this.Mk=ta;this.hb=Ya;this.Dy=xb;this.wlc=Mb}wNm(b,k,r,y,R){if(!k.view.ye)return 2;k=k.view;let aa=null;k.yi&&(aa=k);const ta=k.Cb.Jg;var Ya=!0;let xb=!1,Mb=null;if(!ta)return 2;const cc=
new sf.GraphTransaction(15);cc.Eb(k.ld);let jc=null;2===r&&(jc=new Wh.a,jc.set(ta.node),jc.rd(),Mb=new Nx.a(jc),xg.OutlineElementNavigator.Xd(jc),Ya=Ag.OutlineElementReader.isEmpty(jc,!1),{E4i:Ya,fnj:xb}=this.bCj.F4i(jc,Ya,gn.a.fBb,-1,ta));b=n.AFrameworkApplication.ya.Vf(ta,b,r,!1,y,R);Ya&&32===b&&2===r&&(xb||xg.OutlineElementNavigator.hDa(jc,!1,!rf.SelectionEditor.zf(ta),!1),xb&&Mb&&Mb.restore(jc),this.Jw.freeze(),(r=Ke.SelectionFactory.xo(jc.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,
"could not create selection for NewLineView."),k.Cb.setSelection(r),this.Jw.cFa(),this.dEj.zi.KF());aa&&(Ya||aa.qba(),aa.editingView&&aa.cO&&(aa.editingView.uH=!0));pu.GrippersManager.instance.PMb(1);cc.dispose();return b}newLine(b,k,r){b=!1;if(Pd.ImageReader.laa(k)||Pd.ImageReader.k_a(k))k=this.oHk(k),b=!0;const y=k;if((k=rf.SelectionEditor.zf(k))&&this.Mk.xh&&!this.Mk.Him(y))return 2;if(1===r)return 32;const R=y.node,aa=new Wd.GraphIterator;aa.set(R);aa.rd();xg.OutlineElementNavigator.Xd(aa);r=
new sf.GraphTransaction(15);r.Qu(aa);k?(this.wlc.instance&&this.wlc.instance.tFa(y),ie.ParagraphReader.nc(R)&&y.cpBegin===ie.ParagraphReader.textLength(R)&&Qm.m(y)&&9===ie.ParagraphReader.xBa(R)&&this.Jw.jIk(y),this.AG.aZf(aa,!0,y,R),Vh.ListReader.ei(aa)&&!Ag.OutlineElementReader.isEmpty(aa,!1)&&(k=ie.ParagraphReader.Rm(aa.currentNode))&&k.qa&&!k.qa.last.formatting&&kB.characterPropertiesEditor.aLa(k),this.dY&&this.dY.shc(R,tb.a.hs,y.cpBegin),b&&(xg.OutlineElementNavigator.Wr(aa,!1,!1),b=aa.Pb(2),
(b=this.Dy.xe(b,0))&&this.hb.setSelection(b))):this.Kh.TB(aa,!0,!0);r.dispose();Ka.App.xa&&Ka.App.xa.updateCommandUI();return 32}oHk(b){if(Pd.ImageReader.laa(b))var k=Re.a.Uc(b.node,b.cpBegin);else{k=ie.ParagraphReader.BP(b.node);var r=k.properties.wg(wc.a.Iq);b=b.node.properties.getValue(wc.a.runId);r=kB.ndf(b,r,k.qa);k=Re.a.Uc(k,r)}return k}static get characterPropertiesEditor(){return null!=kB.Qhg?kB.Qhg:kB.Qhg=Va.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static W9e(b,k){let r=0;for(;r<
k.length&&!(b<k[r]);)r++;return r}static ndf(b,k,r){let y=0;b=kB.W9e(b,k);let R=0;if(b===k.length)R=r.length-1;else for(;R<r.length;){k=r.J(R);if(k.formatting&&k.formatting.Ge===b)break;R++}R<r.length&&(y=r.J(R).cp);return y}}Object(m.a)(kB,"NewLineStrategy",null,[]);class bC{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td,ne){this.xm=null;this.Cja=b;this.K$c=ta;this.Egd=new kB(this,k,r,y,R,aa,Ya,cc,jc,Td);this.vKg=new zy(Ya,xb,k,Mb,Mc,fd,ne)}get zi(){return this.xm||(this.xm=this.Cja())}Vb(){const b=
n.AFrameworkApplication.ya,k=Object(u.a)(this.Egd,this.Egd.newLine,"newLine");b.gb(Wa.a.enter,lc.a.view,Object(u.a)(this.K$c.value,this.K$c.value.E5k,"enterView"),1124);b.gb(Wa.a.M3i,lc.a.view,Object(u.a)(this.K$c.value,this.K$c.value.qUn,"shiftEnterView"),1124);b.pa(Wa.a.newLine,lc.a.view,Object(u.a)(this.Egd,this.Egd.wNm,"newLineView"));b.pa(Wa.a.newLine,lc.a.Wc,k);b.pa(Wa.a.newLine,lc.a.image,k);b.pa(Wa.a.newLine,lc.a.Hd,k);b.pa(Wa.a.newLine,lc.a.anchoredObject,k);b.pa(Wa.a.newLine,lc.a.embeddedFile,
k);b.pa(Wa.a.newLine,lc.a.ink,k);b.pa(Wa.a.newLine,lc.a.paragraph,k);b.pa(Wa.a.newLine,lc.a.iFrame,k);b.pa(Wa.a.newLine,lc.a.unsupportedObject,k);b.Vc(Wa.a.newLine,1124);b.gb(Wa.a.SMd,lc.a.view,Object(u.a)(this.vKg,this.vKg.F7l,"insertLineBreakView"),1028);b.pa(Wa.a.EMc,lc.a.view,ku.c8l);b.pa(Wa.a.EMc,lc.a.outlineElement,ku.VMd);b.Vc(Wa.a.EMc,1092)}static get instance(){return null!=bC.bng?bC.bng:bC.bng=bC.Hl()}static Hl(){return new bC(()=>Va.a.instance.resolve("Box4.IUndoManager"),Va.a.instance.Pa("Box4.IAutoCorrectScheduler"),
Va.a.instance.resolve("Box4.IOutlineElementEditor"),Va.a.instance.resolve("Box4.List.ICursorMovementValidator"),Va.a.instance.resolve("Box4.List.IListEditor"),Va.a.instance.resolve("Box4.IInsertionPointFormatting"),Va.a.instance.Ze("Box4.Actors.IEnterViewStrategy"),mh.a.instance,Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Va.a.instance.$a("Box4.IExternalSelectionManager"),bh.a.instance,Va.a.instance.resolve("Box4.ISelectionFactory"),Va.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Va.a.instance.$a("Box4.IContentControlConverter"),Va.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)(bC,"EnterActor",null,[]);var OF=c(1350),PF=c(685);class Zj{static get paragraphEditor(){return null!=Zj.iqg?Zj.iqg:Zj.iqg=Va.a.instance.resolve("Box4.IParagraphEditor")}static get NX(){return null!=Zj.Brg?Zj.Brg:Zj.Brg=Va.a.instance.Pa("Box4.ISpacingCommands")}static get vLb(){return null!=Zj.Nrg?Zj.Nrg:Zj.Nrg=
Va.a.instance.Pa("Box4.Styles.IWACStyleReader")}static get XT(){return null!=Zj.Dog?Zj.Dog:Zj.Dog=Va.a.instance.Pa("Box4.ILineSpacingHelper")}static get Oj(){return null!=Zj.atg?Zj.atg:Zj.atg=Va.a.instance.Pa("Box4.TrackChange.ITrackChangeEditor")}static get Rd(){return null!=Zj.Btg?Zj.Btg:Zj.Btg=Va.a.instance.Pa("Box4.TrackChange.ITrackChangeManager")}static get wO(){return Va.a.instance.Pa("Box4.Settings.SpacingSettings")}static get en(){return Va.a.instance.Pa("WordEditor.ClientPagination.IClientPaginationSettings")}static Vb(){var b,
k,r,y;const R=n.AFrameworkApplication.ya;R.pa(Wa.a.Xwf,lc.a.view,em.a.Cv);R.Vc(Wa.a.Xwf,1028);R.pa(Wa.a.jC,lc.a.view,em.a.Cv);R.pa(Wa.a.jC,lc.a.paragraph,Zj.isd);R.Vc(Wa.a.jC,1036);if(null===(b=Zj.wO)||void 0===b?0:b.mua)R.pa(Wa.a.fec,lc.a.paragraph,Zj.hek),R.pa(Wa.a.fec,lc.a.view,em.a.Cv),R.Vc(Wa.a.fec,1036);if(null===(k=Zj.en)||void 0===k?0:k.UCa)R.pa(Wa.a.u_c,lc.a.paragraph,Zj.FRe),R.pa(Wa.a.u_c,lc.a.view,em.a.Cv);if(null===(r=Zj.en)||void 0===r?0:r.VFa)R.pa(Wa.a.X_c,lc.a.paragraph,Zj.ZRe),R.pa(Wa.a.X_c,
lc.a.view,em.a.Cv);if(null===(y=Zj.en)||void 0===y?0:y.Cfa)R.pa(Wa.a.t_c,lc.a.paragraph,Zj.ERe),R.pa(Wa.a.t_c,lc.a.view,em.a.Cv);R.pa(Wa.a.iPe,lc.a.view,Zj.fak);R.Vc(Wa.a.iPe,1036);R.pa(Wa.a.aTf,lc.a.view,Zj.Vun);R.Vc(Wa.a.aTf,1036);R.pa(Wa.a.hPe,lc.a.view,Zj.eak);R.Vc(Wa.a.hPe,1036);R.pa(Wa.a.$Sf,lc.a.view,Zj.Uun);R.Vc(Wa.a.$Sf,1036);R.pa(Wa.a.WPa,lc.a.view,em.a.Cv);R.pa(Wa.a.WPa,lc.a.paragraph,Zj.isd);R.Vc(Wa.a.WPa,1036);R.pa(Wa.a.VPa,lc.a.view,em.a.Cv);R.pa(Wa.a.VPa,lc.a.paragraph,Zj.isd);R.Vc(Wa.a.VPa,
1036);R.pa(Wa.a.$9d,lc.a.view,Zj.Z9d);R.pa(Wa.a.$9d,lc.a.paragraph,Zj.Z9d);R.Vc(Wa.a.$9d,1028);R.pa(Wa.a.A2f,lc.a.view,Zj.Z9d);R.pa(Wa.a.A2f,lc.a.paragraph,Zj.Z9d);R.Vc(Wa.a.A2f,1028);R.pa(Wa.a.O9d,lc.a.view,em.a.Cv);R.pa(Wa.a.O9d,lc.a.paragraph,Zj.Aeh);R.Vc(Wa.a.O9d,1028);R.pa(Wa.a.N9d,lc.a.view,em.a.Cv);R.pa(Wa.a.N9d,lc.a.paragraph,Zj.Aeh);R.Vc(Wa.a.N9d,1028)}static Aeh(b,k,r,y,R){if(1===r)return 32;b===Wa.a.O9d?b=Wa.a.WPa:b===Wa.a.N9d&&(b=Wa.a.VPa);return Zj.isd(b,k,r,y,Zj.s5m(R))}static s5m(b){var k=
b.indexOf(",");const r=b.substring(0,k);b=b.substring(k+1,b.length);k=new OF.a;k.value=parseFloat(r);k.unit=parseInt(b);return k}static Z9d(b,k,r,y,R){if(2===r){k=R[rc.a.Text];r=R[rc.a.Number];R=R.Increment;y=new OF.a;let aa=!1;""===k||R&&k===Box4Intl.Box4Strings.L_SpinnerAuto?(y.value=0,y.unit=Ka.App.M6?2:4,aa=!0):r||R||(y.value=0,y.unit=1,aa=!0);aa&&(n.AFrameworkApplication.ya.Xb(b===Wa.a.$9d?Wa.a.WPa:Wa.a.VPa,2,y),Ka.App.xa.updateCommandUI())}return 32}static isd(b,k,r,y,R){if(!({Ix:r}=em.a.T_f(r,
k)).returnValue)return r;k=k.node;switch(b){case Wa.a.jC:Zj.paragraphEditor.jC(k,new PF.a(2,R));break;case Wa.a.WPa:b=new PF.a(R.unit,R.value);Zj.paragraphEditor.$Jb(k,b);break;case Wa.a.VPa:b=new PF.a(R.unit,R.value),Zj.paragraphEditor.XJb(k,b)}y&&Qc.a.Slb&&(y.Mr|=Qc.a.Odb(k));return 32}static fak(b,k,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Zj.b0h(k);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),
8;b=(b=b.ia(wc.a.zj,240)/20)?b:Zj.fTk;Zj.NX.$ga(1,b,4);return 32}static Vun(b,k,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Zj.NX.$ga(1,0,4);return 32}static eak(b,k,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Zj.b0h(k);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(wc.a.ra,240)/20;Zj.NX.$ga(0,b?b:12,4);return 32}static Uun(b,
k,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Zj.NX.$ga(0,0,4);return 32}static FRe(b,k,r,y,R){if(2==r){if("boolean"!==typeof R)return 16;b=k.node;k=null;gh.a.instance.J(3)&&(k=b.Qz());Zj.paragraphEditor.FRe(b,R);k&&Zj.Oj.oM(b,k,Zj.Rd.og)}return 32}static ZRe(b,k,r,y,R){if(2==r){if("boolean"!==typeof R)return 16;b=k.node;k=null;gh.a.instance.J(3)&&(k=b.Qz());Zj.paragraphEditor.ZRe(b,R);k&&Zj.Oj.oM(b,k,Zj.Rd.og)}return 32}static ERe(b,
k,r,y,R){if(2==r){if("boolean"!==typeof R)return 16;b=k.node;k=null;gh.a.instance.J(3)&&(k=b.Qz());Zj.paragraphEditor.ERe(b,R);k&&Zj.Oj.oM(b,k,Zj.Rd.og)}return 32}static hek(b,k,r,y,R){if(2==r){if("boolean"!==typeof R)return 16;b=new Map;b.set("Value",R.toString());Ga.Health.instance.recordKpiUsage(bg.a.jQc.pbo,0,bg.a.LB,b);k=k.node;b=null;gh.a.instance.J(3)&&(b=k.Qz());k.hasProperty(wc.a.Et)&&k.removeProperty(wc.a.Et);Zj.XT.hFd(k)!==R&&k.setValue(wc.a.Et,R);(R=Zj.XT.s3b(k,!0))&&R.uk(4,!0);(R=Zj.XT.s3b(k,
!1))&&R.uk(4,!0);b&&Zj.Oj.oM(k,b,Zj.Rd.og)}return 32}static b0h(b){b=b.view;return b.ye&&(b=b.Cb)&&b.ib.kb?Zj.vLb.Ao(b.ib.kb.Qa.node):null}}Zj.fTk=12;Object(m.a)(Zj,"SpacingActor",null,[]);class uI{process(){}}Object(m.a)(uI,"NoOpFormattingViewOperationFinishedStageProcessor",null,[31]);class vI{constructor(b){this.ng=b}FMn(b,k){this.ng.z_(b,k.cache.$G);this.ng.Wv(b,k.cache.fontSize)}WLa(){return null}zBa(){return null}Y3b(){return null}qT(){return null}}Object(m.a)(vI,"FormattingStewardBridge",null,
[38]);class wI{zc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new uI).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",()=>new vI(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(m.a)(wI,"WoncaActorsConfiguration",null,[2]);class xI{constructor(b,k,r,y,R,aa,ta,Ya){this.ga=b;this.kzj=k;this.jzj=r;this.Jxg=y;this.ORj=R;this.xid=aa;this.TRj=ta;this.URj=Ya}get wc(){return this.ga}Llk(b){this.wc.Ona(b,this.kzj,null,null)}Jlk(b){this.wc.Ona(b,this.jzj,
null,null)}Q1(b,k,r){r?this.wc.Ona(b,this.Jxg,k,null):this.wc.Xb(this.Jxg,2,k)}U5m(b,k){this.wc.Ona(b,this.xid,k,null)}t7(b,k){this.wc.Ona(b,this.TRj,k,null)}ijb(b,k){this.wc.Ona(b,this.URj,k,null)}rLf(b,k=!1){const r=new Di.DictionaryPropertySet;r.setValue(td.a.PQ,b);r.setValue(td.a.vFi,!0);r.setValue(td.a.u_a,k);this.wc.Xb(this.ORj,2,r)}}Object(m.a)(xI,"ClipboardCommands",null,[1372]);class yI{}Object(m.a)(yI,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1254]);class zI{constructor(b){this.ga=
b}get wc(){return this.ga}Y0i(b,k,r){let y=0;b?1===b&&(y=Wa.a.RZa):y=Wa.a.QZa;b=new MB.a;b.unit=r;b.value=k;this.wc.Xb(y,2,b)}G7d(b,k,r){let y=0;1===b?y=Wa.a.tKb:2===b?y=Wa.a.Kkb:b||(y=Wa.a.uKb);b=new MB.a;b.unit=r;b.value=k;this.wc.Xb(y,2,b)}}Object(m.a)(zI,"IndentationCommands",null,[1307]);var OE;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=
7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]="numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(OE||(OE={}));Object(m.b)("Justification",OE);class AI{constructor(b){this.UHa={};this.ga=b;this.y3l()}get wc(){return this.ga}tD(b){b=this.UHa[OE[b]];void 0!==b&&null!==b&&this.wc.processAction(b,2)}y3l(){this.UHa.left=Wa.a.leftJustify;this.UHa.center=Wa.a.centerJustify;
this.UHa.right=Wa.a.rightJustify;this.UHa.both=Wa.a.fullJustify;this.UHa.lowKashida=Wa.a.JEb;this.UHa.mediumKashida=Wa.a.JEb;this.UHa.highKashida=Wa.a.JEb;this.UHa.distribute=Wa.a.vEc;this.UHa.thaiDistribute=Wa.a.S_c}}Object(m.a)(AI,"JustificationCommands",null,[1293]);class BI{constructor(b){this.ga=b}jC(b){this.ga.Xb(Wa.a.jC,2,b)}fec(b){this.ga.Xb(Wa.a.fec,2,b)}u_c(b){this.ga.Xb(Wa.a.u_c,2,b)}X_c(b){this.ga.Xb(Wa.a.X_c,2,b)}t_c(b){this.ga.Xb(Wa.a.t_c,2,b)}$ga(b,k,r){this.ga.Xb(b?Wa.a.WPa:Wa.a.VPa,
2,Object.assign(new OF.a,{value:k,unit:r}))}}Object(m.a)(BI,"SpacingCommands",null,[1190]);class CI{constructor(b,k,r){this.wc=b;this.XEc=k;this.X1k=r;this.d1m=(y,R,aa)=>{if(1===aa)return this.XEc.N9?32:8;this.XEc.ovm();this.X1k().rZn(this.XEc.lsl());return 32}}Vb(){this.wc.gb(Wa.a.Nib,lc.a.application,this.d1m,1028)}}Object(m.a)(CI,"EditorSettingsUIActor",null,[]);class DI extends yf.a{constructor(b,k){super(!1,!1,!0);this.Z1k=b;this.FNa=k;this.Y1k=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):
(this.Z1k.cjo(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}rZn(b){Object(gr.__awaiter)(this,void 0,void 0,function*(){var k=yield this.FNa.eFb;k={["id"]:"SettingsDialog",["uiLanguage"]:n.AFrameworkApplication.uiCulture,["selectedLanguage"]:yh.a.qg(n.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:k.TPc,["editorSettings"]:b};this.Vh(Box4Intl.Box4Strings.l_EditorSettings,this.Y1k,k);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}}
Object(m.a)(DI,"EditorSettingsDialog",yf.a,[]);class EI{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd){this.Csb=this.xtc=this.OOb=null;this.hIe=0;this.Ute=!1;this.sa=new Fe.a;this.cPd=!1;this.Rqb=null;this.nS=b;this.Jw=k;this.ng=r;this.yu=y;this.fb=R;this.AG=aa;this.Cf=ta;this.Yd=Ya;this.Mk=xb;this.Ic=Mb;this.Jd=cc;this.$m=jc;this.HV=Mc;this.DC=fd}get y3k(){return this.Ic?this.Ic.isFeatureEnabled(41):!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get saf(){return null!=
this.Ykg?this.Ykg:this.Ykg=Va.a.instance.resolve("Box4.IFormatPainterStrategy")}get rQ(){return this.Ute}set rQ(b){this.Ute!==b&&(this.Ute=this.cPd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}d8j(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}cGi(b){const k=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",k.contextId);this.reset();var r=k.node;b=this.kgi(b);if(this.saf.pWn(k.contextId,b))try{this.Csb=this.fb.WYa(r)}catch(y){throw v.ULS.sendTraceTag(22832029,
354,10,"GetParagraphProperties error: {0}",y.message),y;}this.xtc=this.DC.Ao(r);r=Kk.FormattingReader.Qr(k);r.hn&&(this.OOb=Object(ia.a)(ay.a,r.hn.clone()));this.hIe=b?lc.a.paragraph:k.contextId}Xdh(b){if(b){const y=this.kgi(b);if(this.$Od)if(b=b.BN().$y(),null===b||void 0===b?0:b.Xk)this.iab(b,y);else if(0==(null===b||void 0===b?void 0:b.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",b);else{if(b)for(var k=0;k<b.length;k++){var r=b.getContext(k);
if(null===r||void 0===r?0:r.zw){if(r)for(let R=0;R<r.length;R++)b.addContext(r.getContext(R))}else(null===r||void 0===r?0:r.Xk)?this.iab(r,y):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",r.contextId)}}else for(k=0;k<b.length;k++)r=b.J(k),(null===r||void 0===r?0:r.Xk)?this.iab(r,y):v.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",r.contextId)}}$dh(b,k){if(k){var r=b.node,y=r.qa.last,R=this.Yd.aLa(r),aa=R.Yf(R.Ob);
this.aeh(R,k,null);gh.a.instance.J(3)&&this.$m.eKb(r,y,b.cpBegin,b.cpEnd,aa,R,this.Jd.og)}}vek(b,k,r){if(k||r)0<Qm.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.HV.I1(b,y=>{this.aeh(y,k,r)})}aeh(b,k,r){var y,R,aa,ta;this.ng.hka(b);b.hn&&b.hn.removeProperty(Te.a.highlight);this.ng.nXe(b);if(r){let Ya=r.ai();if(null===(y=n.AFrameworkApplication.K)||void 0===y?0:y.$("StylesFlatteningCrashFixIsEnabled"))Ya=mi.a.uua(r)?null===(ta=null===(aa=null===(R=
this.DC)||void 0===R?void 0:R.Np())||void 0===aa?void 0:aa.zW(Ya))||void 0===ta?void 0:ta.clone():Ya.clone(),Ya.Vg(...Jo.a.cH());this.Bs(b,Ya)}this.Bs(b,k)}Bs(b,k){var r;if(k){var y=b.paragraph.Mc;if(y){var R=b.hn;R=R?Object(ia.a)(Sy.a,R.clone()):ay.a.fAa(1179725);for(const ta of k.Nj())if(ta!==wc.a.Jx&&ta!==wc.a.fieldInstruction&&ta!==Te.a.MA&&ta!==Te.a.P6&&ta!==wc.a.cgb&&ta!==Te.a.pE&&ta!==wc.a.languageHint&&ta!==wc.a.noProof){if(ta===Hk.a.xB){var aa=k.ia(Hk.a.xB,G.a.nil);if(aa!==G.a.nil)if(aa=
y.Db(aa)){if(aa=new tw.a(aa),aa=this.DC.DF(aa),aa===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(aa=this.DC.Sx(b.paragraph).Bta(aa)){(null===(r=n.AFrameworkApplication.K)||void 0===r?0:r.$("StylesFlatteningCrashFixIsEnabled"))?R.jI(aa.ai(),...Jo.a.cH()):R.Bs(aa.ai());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}R.setValue(ta,
k.wg(ta))}R.Gma?k=y.UQ(R,!0):(y.Lu(R),k=R);b.Bj=k.id}}}kgi(b){return!b.MC&&b.Tc.contextId!==lc.a.endOfParagraph}reset(){this.Csb=this.xtc=this.OOb=null;this.hIe=lc.a.none}iab(b,k){if(b.contextId===lc.a.Wc||b.contextId===lc.a.Hd)var r=this.Mk.naa(b);else if(b.contextId===lc.a.paragraph)r=this.Mk.bQd(b);else if(b.contextId===lc.a.endOfParagraph)r=this.Mk.KOd(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",
b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(ia.a)(xn.AParagraphNode,b.node);var y=!1;r&&(y=b.contextId===lc.a.Hd&&!!r&&!b.cpBegin&&b.cpEnd===this.fb.textLength(r));if(k=this.saf.BUn(this.hIe,b.contextId,k,y))try{ie.ParagraphReader.nc(r)?(this.xtc&&this.nS.pM(this.xtc,r,!0),this.yu.reh(r,this.Csb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(R){throw v.ULS.sendTraceTag(22832065,
354,10,"ApplyParagraphProperties error: {0}",R.message),R;}y=b;b.contextId===lc.a.paragraph?y=Re.a.createTextRange(r,0,ie.ParagraphReader.textLength(r)):b.contextId===lc.a.Wc&&(y=this.Jw.aif(b),y=bh.a.Rxb(y));if(y&&y.contextId===lc.a.Hd)try{this.vek(y,this.OOb,k?null:this.xtc)}catch(R){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",R.message),R;}if(b.contextId===lc.a.paragraph||b.contextId===lc.a.endOfParagraph){k=new Wd.GraphIterator;k.set(r);k.rd();k.kd(11);y=
Vh.ListReader.ei(k);const R=!ie.ParagraphReader.textLength(r);v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",y,R);y?(this.Cf.kD(k),k=k.currentNode,this.Cf.paa(k)&&(hj.a.ae.WL?this.$dh(b,this.OOb):this.AG.l7d(k,r,this.OOb))):this.y3k&&this.$dh(b,this.OOb)}}}get $Od(){null==this.Rqb&&(n.AFrameworkApplication.Ne("0b2ac141;84eff841"),this.Rqb=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",
!1):!1);return this.Rqb}}Object(m.a)(EI,"FormatPainter",null,[1339]);var OL=c(125);class cC{constructor(b,k,r,y,R,aa,ta,Ya=!1,xb,Mb,cc){this.led=!1;this.Aqe=new Lj.a;this.Rqb=null;this.RUl=()=>{this.LR.rQ=!1;return 32};this.SUl=(jc,Mc,fd)=>{jc=!1;if(Mc=this.BC.eta){switch(Mc.contextId){case lc.a.Hd:case lc.a.paragraph:case lc.a.endOfParagraph:case lc.a.Wc:jc=!0}jc&&rf.SelectionEditor.Dk(Mc)&&Qm.b(Mc)&&(this.nd.Zb($c.a.Vm,{["Reason"]:bd.a.eCc}),jc=!1);jc&&ie.ParagraphReader.HT(Mc)&&(this.nd.Zb($c.a.Vm,
{["Reason"]:bd.a.uN}),jc=!1)}if(1===fd||!jc)return jc?32:8;6!==this.ga.PG?(this.LR.rQ?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.LR.cGi(this.BC.kb),this.led||(this.Dh.FVa(this.cij),(fd=this.Dh.jb.zv)&&fd.yi&&fd.dah(this.bij),this.led=!0)),this.LR.rQ=!this.LR.rQ):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.LR.cGi(this.BC.kb),this.LR.rQ=
!1);return 32};this.QUl=(jc,Mc,fd,Td,ne)=>{if(6===this.ga.PG||this.LR.rQ){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.PG);jc=this.Dh.lq.jg("UserAction","FormatPainterApply");if(cC.Wb&&cC.Wb.Wx(124)){ne=ne?ne.KeepBrushActive:!1;fd=null;this.BC.kb&&2===this.BC.kb.trigger&&(ne=ne||this.LR.cPd,this.LR.cPd&&rf.SelectionEditor.Dm(this.BC.kb)&&(fd=rf.SelectionEditor.k2(this.BC.kb.Qa,!1)))&&(fd.trigger=2);this.LR.cPd=!1;if(ne||2!==this.BC.kb.trigger)Mc=
new sf.GraphTransaction(15),fd&&fd.Qa?(Mc.set(fd.Qa.node.Ui),this.hb.setSelection(fd)):Mc.set(this.BC.P1b.Ui),fd=this.$Od?Ke.SelectionFactory.fo(this.hb.Jg):this.BC.kb,this.LR.Xdh(fd),Mc.dispose();this.LR.rQ=ne}else ne=new sf.GraphTransaction(15),ne.set(this.BC.P1b.Ui),Mc=this.$Od?Ke.SelectionFactory.fo(this.hb.Jg):this.BC.kb,this.LR.Xdh(Mc),this.LR.rQ=!1,ne.dispose();jc.stop()}return 32};this.cij=()=>{this.gZd(this.LR.rQ)};this.bij=()=>{this.gZd(this.LR.rQ)};this.Dh=b;this.Ub=k;this.ga=r;this.nd=
y;this.BC=R;this.LR=aa;this.hb=ta;this.gKj=Ya;this.dw=xb;this.Kw=Mb;this.jCj=cc}get BGg(){return X.a.Ys||X.a.vQd?"url("+this.CSh()+"), pointer":'url("'+this.CSh()+'"), pointer'}CSh(){return this.Kw?this.dw.rta(Qk.a.Sh("FormatPainterText.cur"),Qk.a.Sh("FormatPainterTextDarkMode.cur"),new OL.a(qn.a.WP())):Qk.a.Sh("FormatPainterText.cur")}Vb(){const b=this.Ub.re(Rh.AppFrame.sF);b.bindAction(bc.KeyInputManager.lc(tb.a.M4a,0),Wa.a.qaf);b.bindAction(bc.KeyInputManager.lc(tb.a.mnb,6),Wa.a.VDd);this.gKj||
b.bindAction(bc.KeyInputManager.lc(tb.a.pnb,6),Wa.a.kYa);this.ga.gb(Wa.a.VDd,lc.a.view,this.SUl,1028);this.ga.gb(Wa.a.kYa,lc.a.view,this.QUl,1028);this.ga.gb(Wa.a.qaf,lc.a.view,this.RUl,1028);this.LR.d8j(()=>{this.S9f(this.LR.rQ)});this.Kw&&this.jCj.jrd(()=>{this.gZd(this.LR.rQ)})}S9f(b){const k=this.Dh.lq.jg("UserAction","FormatPainterUpdateCursor");this.gZd(b);this.Dh.updateCommandUI();k.stop()}aij(b,k){for(let r=0;r<b.length;r++)this.$hj(b[r],k);(b=this.Dh.jb.zv)&&b.ye&&this.$hj(b.Wg.editingElement,
k)}$hj(b,k){b.style.cursor=k?this.BGg:""}gZd(b){const k=document.querySelectorAll(".OutlineElement");if(1<k.length){const r=k[k.length-2].style.cursor===this.BGg;if(this.Dh.jb.isEditingAllowed||this.Dh.jb.Yx){if(b&&!r||!b&&r)this.aij(k,b),this.yij(b);b||!this.led||this.Aqe.count||(this.Dh.qQi(this.cij),(b=this.Dh.jb.zv)&&b.yi&&b.Ptn(this.bij),this.led=!1)}else r&&(this.aij(k,!1),this.yij(!1))}}yij(b){const k=this.Dh.jb.zv;k&&(b?this.Aqe.add(k.ld.xn):this.Aqe.remove(k.ld.xn))}static get Wb(){return null!=
cC.Zjg?cC.Zjg:cC.Zjg=Va.a.instance.Pa("Box4.IFeatureHelper")}get $Od(){null==this.Rqb&&(n.AFrameworkApplication.Ne("0b2ac141;84eff841"),this.Rqb=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.Rqb}}Object(m.a)(cC,"FormatPainterActor",null,[]);class Ay{constructor(b,k,r){this.Km=r}E5k(b,k,r,y,R){var aa;if(!({ve:r,selected:aa,Ix:xb}=this.O4i(k,r,!1)).returnValue)return xb;Ee.a.mark(5013);var ta=
Ay.Sg.qN(aa);for(var Ya=0;Ya<ta.length;++Ya){if(!ta[Ya].Sd)continue;const Mb=ta[Ya].iterator;Mb.ro();if(Nf.OutlineReader.Aw(Mb))return this.cGh(r,Mb)}ta=this.Jsl();if(aa.zw||rf.SelectionEditor.Dk(aa)||ie.ParagraphReader.em(aa)&&!rf.SelectionEditor.J6(aa)){if(Ay.Wb&&Ay.Wb.isFeatureEnabled(23)&&tm.ContextSetEditor.instance.K1f(aa).returnValue)return 8;var xb=this.dGh(k,r,b,y,R,ta)}else if(rf.SelectionEditor.qk(aa))xb=this.bGh(k,r,b,y,R,ta);else if(rf.SelectionEditor.zf(aa)){xb=new Wd.GraphIterator;
xb.set(aa.node);xb.Ab(10);Ya=sh.HyperlinkReader.aD(aa,!1);if(0<Ya.length){if(!Ya[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Ya[0].cpBegin,Ya[0].cpEnd),8;Ka.App.Uzb(Ya[0].hyperlink.url);return 32}Ei.TableCellReader.SZ(xb)&&(bf.returnToContainingCell(xb),Ei.TableCellReader.tfa(xb)&&(Ya=new Wd.GraphIterator,Ya.ed(xb),bf.returnToContainingRow(Ya),Nf.OutlineReader.Uz(xb,aa,!1)&&bm.a.hei(Ya)&&0>=aa.Fb&&(ta=Wa.a.EMc,bf.returnToContainingTable(xb),
xg.OutlineElementNavigator.Xd(xb),R||(R=new Di.DictionaryPropertySet),R.lh(td.a.targetObject,xb.currentNode.id))));xb=this.eGh(k,r,b,y,R,ta)}else rf.SelectionEditor.J6(aa)&&(xb=n.AFrameworkApplication.ya.Vf(k,Wa.a.newLine,2,!1,y,R));Ee.a.mark(5014);return xb}O4i(b,k,r){let y=null,R=null;if(1===k)return{returnValue:!1,ve:y,selected:R,Ix:32};if(!b.view.ye)return{returnValue:!1,ve:y,selected:R,Ix:2};y=b.view;return(R=y.Cb.Jg)&&Ay.ag.Ndi(R,r)?this.Km&&this.Km.instance&&this.Km.instance.KT(R)?{returnValue:!1,
ve:y,selected:R,Ix:4}:{returnValue:!0,ve:y,selected:R,Ix:2}:{returnValue:!1,ve:y,selected:R,Ix:2}}qUn(b,k,r,y,R){let aa,ta;if(!({ve:r,selected:aa,Ix:ta}=this.O4i(k,r,!0)).returnValue)return ta;const Ya=Ay.Sg.qN(aa);for(let xb=0;xb<Ya.length;++xb){if(!Ya[xb].Sd)continue;const Mb=Ya[xb].iterator;Mb.ro();if(Nf.OutlineReader.Aw(Mb))return this.cGh(r,Mb)}aa.zw||rf.SelectionEditor.Dk(aa)?ta=this.dGh(k,r,b,y,R,Wa.a.SMd):rf.SelectionEditor.qk(aa)?ta=this.bGh(k,r,b,y,R,Wa.a.SMd):rf.SelectionEditor.zf(aa)?
ta=this.eGh(k,r,b,y,R,Wa.a.SMd):rf.SelectionEditor.J6(aa)&&(ta=n.AFrameworkApplication.ya.Vf(k,Wa.a.newLine,2,!1,y,R));return ta}cGh(b,k){b.Cb.setSelection(Ke.SelectionFactory.xo(k.currentNode,!1));return 32}dGh(b,k,r,y,R,aa){const ta=new sf.GraphTransaction(15);ta.Al=r;ta.Eb(k.ld);k=new Di.DictionaryPropertySet;k.setValue(td.a.zEc,!0);k=n.AFrameworkApplication.ya.Vf(b,Wa.a.XG,2,!0,y,k);32===k&&(k=n.AFrameworkApplication.ya.Vf(b,aa,2,!1,y,R));ta.dispose();return k}bGh(b,k,r,y,R,aa){const ta=new sf.GraphTransaction(15);
ta.Al=r;ta.Eb(k.ld);k.Cb.setSelection(rf.SelectionEditor.Qj(k.Cb.ib.J(0),!1,!1));b=n.AFrameworkApplication.ya.Vf(b,aa,2,!1,y,R);ta.dispose();return b}eGh(b,k,r,y,R,aa){const ta=new sf.GraphTransaction(15,r);ta.Al=r;ta.Eb(k.ld);b=n.AFrameworkApplication.ya.Vf(b,aa,2,!1,y,R);ta.dispose();return b}static get Sg(){return tm.ContextSetEditor.instance}static get ag(){return mh.a.instance}static get Wb(){return null!=Ay.Vjg?Ay.Vjg:Ay.Vjg=Va.a.instance.Pa("Box4.IFeatureHelper")}}Object(m.a)(Ay,"AEnterViewStrategy",
null,[1366]);class FI extends Ay{constructor(b,k,r){super(b,k,r)}Jsl(){return Wa.a.newLine}}Object(m.a)(FI,"EnterViewStrategy",Ay,[]);class QF{constructor(b){this.kl=this.transaction=null;this.ve=b;this.pCc=this.Wn=0}}Object(m.a)(QF,"SelectAllArguments",null,[]);class lA{constructor(b,k,r,y){this.h7k=(R,aa,ta,Ya,xb)=>aa.view.yi?this.Ocb(aa,ta,this.n9i):this.pXi(R,aa,ta,Ya,xb);this.JVc=(R,aa)=>aa.Wn?1===aa.Wn?(aa.ve.Cb.K_c(aa.kl,R),aa.Wn=2,!0):2===aa.Wn?(aa.ve.Cb.ib.dXa=aa.kl.dXa,this.zi.KF(),aa.transaction.zEa(R),
aa.Wn=3,aa.transaction.dispose(),Ee.a.mark(5799),!0):!1:(aa.transaction=this.Hc.Rc(2),aa.transaction.Eb(aa.ve.ld),aa.Wn=1,!0);this.pXi=(R,aa,ta)=>{if(1===ta)return 32;if(!aa.view.ye)return 2;R=aa.view;return R.Cb&&R.Cb.ib&&R.Cb.ib.kb?this.n9i(R).inProgress?1:32:8};this.n9i=R=>{n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.tue&&R.yi&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");R=new Rr.a(null,this.gcn,new QF(R));R.ll("SelectAllInOutline");
R.run();return R};this.gcn=(R,aa)=>{if(!aa.Wn)return aa.kl=Ke.SelectionFactory.bGn(aa.ve.Cb.ib.kb),aa.transaction=this.Hc.Rc(2),aa.transaction.Eb(aa.ve.ld),aa.Wn=1,!0;if(1===aa.Wn){if(!aa.pCc)return aa.ve.Cb.setSelection(aa.kl.J(0),R),++aa.pCc,!0;if(aa.pCc<aa.kl.length)return aa.ve.Cb.t6j(aa.kl.J(aa.pCc),R),++aa.pCc,!0;aa.Wn=2}return 2===aa.Wn?(aa.ve.Cb.ib.dXa=aa.kl.dXa,this.zi.KF(),aa.transaction.zEa(R),aa.Wn=3,aa.transaction.dispose(),!0):!1};this.xTb=b;this.nya=k;this.Hc=r;this.tue=y}get d3m(){return this.xTb}get zi(){return this.nya.value}get aGn(){return this.tue?
this.h7k:this.pXi}Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.kwa,zc.a.frame,lA.O5i);b.pa(Wa.a.E_f,zc.a.frame,lA.O5i);b.gb(Wa.a.Ocb,lc.a.view,this.aGn,2);b.gb(Wa.a.NJa,lc.a.view,id.AFrame.Cg,100);b.gb(Wa.a.fBf,lc.a.view,lA.fBf,4)}Ocb(b,k,r){if(1===k)return 32;if(!b.view.ye)return 2;k=b.view;if(!k.Cb)return 8;const y=k.Cb.ib;if(!y||!y.length)return 8;Ee.a.mark(5798);Ka.App.xa.jb.isEditingAllowed||Ka.App.xa.jb.Yx||k.yi?b=rf.SelectionEditor.wgf(y):(Id.FocusManager.instance().iC(id.AFrame.Wo),b=
Ke.SelectionFactory.qXi(k.ld));if(!b)return 8;this.tue&&!y.dXa&&v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.d3m.ygb(rf.SelectionEditor.DQh(b))?r=r(k):(r=new QF(k),r.kl=b,r=new Rr.a(null,this.JVc,r),r.ll("ExpandSelection"),r.run());return r.inProgress?1:32}static get R2a(){return null!=lA.krg?lA.krg:lA.krg=Va.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static fBf(b,k,r){if(1===r)return 32;if(!k.view.ye)return 8;b=k.view;k=Ke.SelectionFactory.xo(b.root.graphNode,
!0);if(!k)return 8;b.Cb.setSelection(k);return 32}static O5i(){var b=Ka.App.xa.jb.zv;if(!b.ye)return 2;if(b.ye&&1!==Ka.App.xa.state){Ee.a.mark(4668);var k=b.Cb.ib.kb;if(!k&&n.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;k=rf.SelectionEditor.Oza(k);let r=k.x,y=k.y+k.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(k.y<b.y||k.y>b.y+b.height||k.x<b.x||k.x>b.x+b.width)r=b.x,y=b.y;lA.R2a.kwa(new Sys.UI.Point(r,y),1);Ee.a.mark(4669)}return 32}}Object(m.a)(lA,
"SelectAllHandlers",null,[1196]);class GI{R6d(){}}Object(m.a)(GI,"FontNameFormattingStrategyNoop",null,[1340]);var PL=c(764);class PE{constructor(b,k,r,y,R,aa){this.phh=this.thh=null;this.ru=b;this.ohh=k;this.xkk=r;this.Hkk=y;this.thh=R;this.phh=aa}}Object(m.a)(PE,"BookmarkHighlightContext",null,[]);class HI extends xd.a{constructor(){super()}get ama(){return!0}get nCb(){return 5}get ffb(){if(null!=this.hqa)return this.hqa;this.hqa=[];this.hqa.push(new Oe.a(vm.a.Vsd,vm.a.Vsd));this.hqa.push(new Oe.a(vm.a.UTe,
vm.a.UTe));this.hqa.push(new Oe.a(vm.a.Rzc,vm.a.Rzc));return this.hqa}uOa(b,k){this.ama&&Bo.a.instance.Qd(()=>{const r=this.Qy.JKa;var y=this.Qy.RRd;if(r)if(5===r.type){y=r.JF;if(r.mO&&r.mO.ru.includes(b))for(const R of k.e2a("*"))this.Qy.p2a(R);y&&y.ru.includes(b)&&this.z_c(k,r.action,y,b)}else y&&5===y.type&&3===r.action&&y.JF.ru.includes(b)&&this.z_c(k,0,y.JF,b)},"BHA:OPHC")}a0a(b){return Object(Jb.a)(PE,b)}oeb(b,k){if(b)for(let r of b.ru)k.add(r)}z_c(b,k,r,y){0===k&&b.htmlElement&&Bo.a.instance.Qd(()=>
{const R=b.e2a("*"),aa=R.length,ta=vm.a.Vsd;var Ya=y.id===r.thh,xb=y.id===r.phh;let Mb=!1;var cc=0,jc=[];let Mc=Array(aa);for(let ne=0;ne<aa;ne++){var fd=R[ne];const ye=fh.a(fd);Mc[ne]=ye;const ff=fd.classList;if(0!=Mc[ne]){const Gd=!ff.contains(vm.a.qI);let oe=jj.a.Db(fd,vm.a.Dab);oe&&jc.push(...oe);if(Ya){let ze;if((ze=jj.a.Db(fd,vm.a.Xsd))&&oe&&1===ze.length&&1===oe.length&&ze[0].equals(oe[0]))continue;ze&&(cc+=ze.length,1===ye?ff.add(vm.a.UTe):ff.add(ta));if(oe)for(let ug of oe)this.aOd(r,ug)&&
(cc--,Mb&&ff.add(vm.a.Rzc));0!==cc&&Gd&&ff.add(ta)}if(!Ya&&!xb&&r.Hkk.has(y.id))if((fd=jj.a.Db(fd,vm.a.Dab))&&Mb){ff.add(ta);for(let ze of fd)if(this.aOd(r,ze)){ff.add(vm.a.Rzc);break}}else Gd&&ff.add(ta)}Mb=!ff.contains(vm.a.LXa)}if(xb&&!Ya){Ya=new Set;for(var Td of jc)this.aOd(r,Td)&&Ya.add(Td);Mb=!1;for(jc=0;0!==Ya.size&&jc<aa;jc++){cc=R[jc];Td=cc.classList;if(0!=Mc[jc])if(xb=!1,cc=jj.a.Db(cc,vm.a.Dab)){for(let ne of cc)this.aOd(r,ne)&&(Ya.delete(ne),xb=!0);0!==Ya.size&&Td.add(ta);Mb&&xb&&Td.add(vm.a.Rzc)}else Td.contains(vm.a.qI)||
Td.add(ta);Mb=!Td.contains(vm.a.LXa)}}},"BHA:SPH")}aOd(b,k){for(let r of b.xkk)if(k.equals(r))return!0;return!1}}Object(m.a)(HI,"BookmarkHighlightActor",xd.a,[350]);var QE=c(1774),II=c(1581);class RE{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){var cc;this.eci=!1;this.rg=b;this.nB=k;this.fb=R;this.RU=aa;this.tj=ta;this.me=Ya;this.Ic=Mb;this.Oa=xb;this.eci=null!==(cc=null===xb||void 0===xb?void 0:xb.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==cc?cc:!1}oXf(b,
k,r,y){const R=b.V7g(k);if(R){var aa=Object(Jb.a)(II.a,b),ta=this.me.jg("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",aa,r)),Ya=k.rk.node,xb=()=>{r||this.gsn(k.rk,R.getId())};aa=RE.Fih();y=this.ejh(R.getId().toString(),Ya,y,r);try{b.gdh(y,k)}catch(Mb){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Mb.message);this.Bp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
return}this.rg.Mj(aa,2,y.toString(),{},!0,0,Mb=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.t1a(Mb,R,()=>{this.Bp(b.WHd())},xb,Ya,k,ta)},Mb=>{const cc=415===Mb.data.Df;let jc="";Mb&&Mb.data&&Mb.data.qj&&"X-CorrelationId"in Mb.data.qj&&Mb.data.qj["X-CorrelationId"]&&(jc=Mb.data.qj["X-CorrelationId"]);b.pna(`Graphics editor request failed. HttpStatus [${Mb.data.Df}], ResponseData [${Mb.data.Ie}], CorrelationId [${jc}]`,
R,Ya,xb,()=>{this.Bp(cc?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.WHd())},ta,cc)},null)}else this.Bp(b.WHd())}FHn(b,k,r){return new Promise((y,R)=>{var aa=b.rk,ta=null;ta=this.eci&&Ad.a.xsf(aa)?aa.getContext(0).node:aa.node;aa=RE.Fih();ta=this.ejh(k.toString(),ta,r,!1);ta.Ke(QE.a.f_e,"2");this.rg.Mj(aa,2,ta.toString(),{},!0,0,Ya=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");y(Ya.data.Ie)},
Ya=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ya.data.Df}, ResponseData ${Ya.data.Ie}`);this.Bp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);R(null)},null)})}ejh(b,k,r,y){const R=k.Di(),aa=new pa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");n.AFrameworkApplication.Ija(aa);aa.Ke(QE.a.strict,this.Ngm(k)?"true":"false");aa.Ke(Ri.a.nodeId,b);aa.Ke(Ri.a.cellId,R.Xl.toString());aa.Ke(Ri.a.fileId,
R.Es);aa.Ke(Ri.a.e2,r.toString());aa.Ke(QE.a.V6k,y?"true":"false");if(b=!!this.Ic&&this.Ic.isFeatureEnabled(48)){aa.Ke(Og.a.gGi,b.toString());if(b=this.Ic.isFeatureEnabled(94))aa.Ke(Og.a.d7m,b.toString()),aa.Ke(Og.a.ignoreMalformedColors,this.Ic.isFeatureEnabled(56).toString());this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&aa.Ke(Og.a.m7m,"true")}aa.Ke(Og.a.ygh,"true");pk.a.instance.Bvb(aa);return aa}Ngm(b){if(!this.nB)return!1;b=this.nB.pu(b);return!!b&&b.wg(wc.a.iuf)}gsn(b,
k){b.cpBegin===b.cpEnd-1&&this.tj.ucc(b.node,k,this.fb,this.RU)}Bp(b){const k=new cf.StandardDialog;k.Gd=0;k.my(pj.a.e6e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Ka.App.xa.updateCommandUI()}static Fih(){const b=new pa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");n.AFrameworkApplication.Ija(b);return b.toString()}}Object(m.a)(RE,"GraphicsEditorRequestManager",null,[349]);class JI extends zx{constructor(b,
k){super(b,k);this.DMa=Wa.a.insertHyperlink}c_a(b){null!=b&&0<b.length&&this.wc.Xb(this.DMa,2,b[0])}cpj(b,k,r){const y=yh.a.qg(n.AFrameworkApplication.lcid).name;return String.format(b,n.AFrameworkApplication.lcid,y,n.AFrameworkApplication.buildVersion,k,mz.Ege,r)+"&flipgrid=1&ted=1"}}Object(m.a)(JI,"InsertHubbleMediaHelper",zx,[]);class KI{constructor(b,k,r,y,R,aa){this.ga=b;this.Oa=k;this.Scd=r;this.$0=y;this.Y$c=R;this.Mk=aa}Vb(){this.ga.gb(Jc.a.SCi,lc.a.Wc,this.x1m.bind(this),1028);this.ga.gb(Jc.a.t$h,
lc.a.Wc,this.V7l.bind(this),1028)}V7l(b,k,r,y,R){if(1!==r){if(null==R)return 16;if(!k.Xk||!rf.SelectionEditor.zf(k))return 2;b=this.xsl(R);R=R.OriginalUrl;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Y$c.kdg(b,k,R)}return 32}uuj(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("OnlineVideoInserted",
"OnlineVideoFloodgateIsEnabled")})},5E3)}xsl(b){const k=new aB;k.MediaType=b.ContentType;k.Height=b.Height;k.Width=b.Width;k.IFrameHtml=b.Html;k.Title=b.Caption;k.Thumbnail=b.ThumbnailUrl;return k}x1m(b,k,r){var y,R;if(1!==r)k=A.a.cW(this.Oa.lb("UserId")).toString(),k=this.$0.cpj(this.Oa.appSettings.InsertVideoHubbleEndpoint,Ra.a.create().toString(),k),this.$0.DMa=Jc.a.t$h,k=this.Scd.KIc(k,!0),k.correlationId=Ra.a.create(),k.Ufa=5,k.X8d(null,this.$0),Y.a.sendTelemetryEvent(Object.assign(new ha.a,
{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]})),this.uuj();else if(!(k&&k.node&&KB.a(k.node))||cs.a.Hwd&&(null===(y=this.Mk)||void 0===y?0:y.mZ(k))||(null===(R=this.Mk)||void 0===R?0:R.fua(k)))return 2;return 32}}Object(m.a)(KI,"OnlineMediaActor",null,[]);class LI extends rt{constructor(b,k,r,y=null,R=!1){super(b,k,r,y,R);this.Hoc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}zHc(){const b={};b.insertMediaServiceEndpoint=
this.Tcd;b.iFrameId="mediaiframe";return b}X8d(b,k){this.XPb=b;this.Hoc=k;this.ync=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.zHc(),["componentIsVisibleCallback"]:this.Fsj.bind(this)};this.Vh(this.XPb,null,b)}Fsj(){this.a_=this.R2b(this.pj("mediaiframe"));this.EG=this.Wid.getInstance(this.a_.contentWindow,this.Tcd);this.EG.Ar(E.a.C9g,b=>{this.Twi(b,this.Hoc.c_a.bind(this.Hoc))});this.EG.Ar(E.a.insert,b=>{this.TXd(b,this.Hoc.c_a.bind(this.Hoc))});this.EG.Ar(E.a.FQh,this.Nyi.bind(this));
this.EG.Ar(E.a.getSessionId,this.Qyi.bind(this));this.EG.Ar(E.a.uOh,this.Myi.bind(this));this.EG.Ar(E.a.Ttd,this.Dxi.bind(this));this.ukb(3)}ukb(b){const k=[];k.push(Object.assign(new ca.a,{name:"DialogResult",string:Fu[b]}));k.push(Object.assign(new ca.a,{name:"DialogMode",string:this.Yff()}));k.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()}));k.push(Object.assign(new ca.a,{name:"Provider",string:xx[this.Ufa]||"Unknown"}));Y.a.sendTelemetryEvent(Object.assign(new ha.a,
{name:this.telemetryEventName,dataFields:k}))}}Object(m.a)(LI,"OnlineMediaDialog",rt,[]);class MI{constructor(b,k){this.zte=b;this.$0=k}KIc(b,k=!1){return new LI(b,this.zte,this.$0,null,k)}getInstance(){throw Error.notImplemented();}}Object(m.a)(MI,"OnlineMediaDialogFactory",null,[337]);class NI extends Qo{constructor(){super(1,3);this.UK=Va.a.instance.resolve("Common.IReactContextualUILauncher");this.xbj=!1}t3a(){n.AFrameworkApplication.ya.processAction(Jc.a.$ec,2)}dBd(){this.nKh&&!this.Uu&&(this.Uu=
this.lHa())}SBd(){if(this.Uu&&this.Uu.isVisible){var b=Object(ia.a)(km.Control,this.Uu.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.uw(b.Tdb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var k=b.getBoundingClientRect();0<k.top&&k.bottom<window.innerHeight&&(k=b.getAttribute(Ef.a.psd)||"",Ef.a.rL===k&&b.click())}}QZ(){return this.UK.QZ}}
Object(m.a)(NI,"ExternalContentFloatieManager",Qo,[]);class ir{constructor(){ir.G5l()}get oc(){return null!=this.qug?this.qug:this.qug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get qw(){return null}lhc(b){var k=null;if(!ie.ParagraphReader.yh(b))return{returnValue:!1,uka:k};if((b=this.oc.Ao(b.currentNode))&&2===this.oc.Xw(b)){const r=this.oc.rf(b);ir.oP.contains(r)&&(k=this.oc.DF(b),k=Object.assign(new Xv.a,{YF:this.key,contentId:b.id,contentObject:k}))}return{returnValue:!!k,
uka:k}}xAb(b,k){let r=null;k&&b.contentId.equals(k.contentId)||(r=b.contentObject);return r}static G5l(){ir.oP=new $m.a;ir.oP.add(rj.StyleReader.styleIdHeading1);ir.oP.add(rj.StyleReader.styleIdHeading2);ir.oP.add(rj.StyleReader.styleIdHeading3);ir.oP.add(rj.StyleReader.qwa);ir.oP.add(rj.StyleReader.qQa);ir.oP.add(rj.StyleReader.rQa);ir.oP.add(rj.StyleReader.Ofc);ir.oP.add(rj.StyleReader.K3a);ir.oP.add(rj.StyleReader.wordStyleIdHeading1);ir.oP.add(rj.StyleReader.wordStyleIdHeading2);ir.oP.add(rj.StyleReader.wordStyleIdHeading3);
ir.oP.add(rj.StyleReader.V4a);ir.oP.add(rj.StyleReader.W4a);ir.oP.add(rj.StyleReader.X4a);ir.oP.add(rj.StyleReader.Xmb);ir.oP.add(rj.StyleReader.Ymb);ir.oP.add(rj.StyleReader.Y4a);ir.oP.add(rj.StyleReader.b5a);ir.oP.add(rj.StyleReader.wic)}}ir.oP=null;Object(m.a)(ir,"ParagraphStyleDetailsProvider",null,[718,299]);class OI{constructor(b,k,r,y){this.qHa=b;this.CMj=k;this.KMj=r;this.LMj=y}JRf(){this.qHa.execute(b=>{b.ncc(this.CMj.value);b.ncc(new ir);b.ncc(this.LMj.value);b.w3(this.KMj.value)})}}Object(m.a)(OI,
"AccessibilityActor",null,[]);class PI{constructor(b,k,r){this.hg=null;this.B0c=(y,R,aa)=>{if(1===aa)return 32;this.hg=this.tmc.value.VIk(this.Ub);if(!this.hg)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.hg.gQa();return 32};this.E7g=y=>this.hg?this.hg.xWl(y):2;this.ga=b;this.tmc=k;this.Ub=r}Vb(){if(n.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=bc.KeyInputManager.lc(tb.a.lnb,5);this.Ub.re(id.AFrame.Wo).Er(b);this.Ub.re(id.AFrame.Qp).bindAction(b,
ib.a.B0c);this.ga.pa(ib.a.B0c,zc.a.frame,this.B0c);this.ga.pa(ib.a.Yxc,zc.a.frame,this.E7g);this.ga.pa(ib.a.Xxc,zc.a.frame,this.E7g)}}}Object(m.a)(PI,"AccessibilityHelpDialogActor",null,[]);var QL=c(1010),RL=c(1361);class QI{constructor(b,k){this.yHj=b.rc("WordHangForActionManagerThresholdTime",750);this.ga=k;this.nwj=QL.a.vF(26,5,new RL.a)}x3(){this.ga.x3(this)}j7(){}i7(b){const k=+b.endTime-+b.startTime;if(k>this.yHj){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=
Kd.ActionManager.sda(b.actionId))&&b.length||(b="UnknownAction");this.nwj.track(k,b+"_"+r)}}}Object(m.a)(QI,"ActionHangDetector",null,[32]);var RI=c(1427);class SI extends Tc{constructor(b){super(b,void 0,n.AFrameworkApplication.rXa,new Qi(b,!1))}get T0a(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get d9b(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get WQc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get lDc(){return n.AFrameworkApplication.rXa?
"UIFontDialogTextLarge":null}Rxf(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}Sxf(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}lRc(){v.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");n.AFrameworkApplication.ya.processAction(ib.a.gDh,2)}}Object(m.a)(SI,"DownloadACopyDialog",Tc,[]);var SE;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";
b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(SE||(SE={}));Object(m.b)("OfficeApplication",SE);var TD;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(TD||(TD={}));Object(m.b)("OpenDocumentMode",TD);class TI extends yf.a{constructor(){super(!1,!1,!0)}rZd(){var b=
{["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const k=Array(5);k[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};k[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};k[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};k[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};
k[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:k};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Vh("Send feedback to Microsoft",this.bPn.bind(this),b);return new Promise(r=>{this.BPj=r})}bPn(b,k){1===b&&this.TEa(k.selectedReason)}dispose(){super.dispose();this.BPj()}TEa(b){const k={},r={},y={},R={},aa={};k.appId=2155;k.manifestType="Fps";k.submitTime=(new Date).toISOString();k.source="Client";k.type="Survey";k.clientFeedbackId=
Ra.a.create().toString();aa.reason=b;let ta={},Ya={numberOfOptions:5};Ya.selectedRating=b;ta.rating=[Ya];R.surveySpecificData=JSON.stringify(ta);y.extendedManifestData=JSON.stringify(R);k.application=y;aa.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";k.survey=aa;k.telemetry=this.QUe();k.web=this.RUe();r["Content-Type"]="application/json";this.Djb(JSON.stringify(k),r)}J9(b,k,r,y){k&&b&&y&&r&&y in k&&(b[r]=k[y])}QUe(){const b=n.AFrameworkApplication.sessionStartInfoSettings,k={};k.officeBuild=n.AFrameworkApplication.buildVersion;
k.featureArea="Open In Desktop App";this.J9(k,b,"audienceGroup","AudienceGroup");this.J9(k,b,"osBuild","OsVersion");this.J9(k,b,"platform","Platform");this.J9(k,b,"processSessionId","WACSessionID");return k}RUe(){const b=n.AFrameworkApplication.sessionStartInfoSettings,k={};this.J9(k,b,"browser","Browser");this.J9(k,b,"browserVersion","BrowserVersion");this.J9(k,b,"dataCenter","WACDatacenter");return k}Djb(b,k,r=0){let y=0;3<r||(1===r?y=200:1<r&&(y=200+500*(r-1)),n.AFrameworkApplication.uc.fc(new nd.a(2,
1,y,()=>{n.AFrameworkApplication.af.Mj("https://petrol.office.microsoft.com/v1/feedback",2,b,k,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.Djb(b,k,r+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(m.a)(TI,"WordOpenInClientFeedbackDialog",yf.a,[]);var UI=c(1678);const WC=b=>{for(let k=0;k<b.children.length;k++){const r=b.children[k];r.style.position="relative";
r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},TE=b=>b.Ib.keyCode===tb.a.hs||b.Ib.keyCode===tb.a.KFa?(b.Af.click(),!0):!1,UD=(b,k,r,y,R,aa,ta)=>{const Ya=document.createElement("a");Ya.className="ProtocolLaunchingDialogButtonAnchor";Ya.className+=" OICDialog";Ya.id=b;Ya.setAttribute(Ef.a.Bh,Ef.a.J1);Ya.style.padding="0";Ya.style.margin="0";y&&VI(R,k,r,y,Ya);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=R;Ya.appendChild(b);Ya.tabIndex=
0;aa&&Sf.a.instance.mb(Kb.a.click,Ya,aa);ta&&bc.KeyInputManager.instance.mb(Kb.a.oh,Ya,ta);return Ya},VI=(b,k,r,y,R)=>{var aa=document.createElement("img");aa.alt=b;aa.className=ci.getImageClassWithCluster(r,y);aa.src=k;aa.setAttribute(Ef.a.Bh,Ef.a.Gz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(aa);aa=document.createElement("span");aa.className="ProtocolLaunchingDialogIconContainer";aa.appendChild(b);R.appendChild(aa)};class UE{static get vg(){return yf.a.Rx(UE.tl,
CommonUIStrings.l_OICLaunchDialogTitle)}}UE.tl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(UE,"OICLaunchDialogHtml",null,[]);class WI extends yf.a{constructor(b){super();this.AOb=this.Znb=null;this.WK=!1;this.Wp=b;this.vg=UE.vg;this.Gd=5;this.lg="OICLaunchDialog";this.showDialog("",Object(u.a)(this,this.xQm,"oicLaunchDialogResultHandler"));this.m0i();this.J3("ProtocolLaunchingDialogTitle");4!==n.AFrameworkApplication.ta.Rb.TKa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.xU(this.Znb);v.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}eU(){this.Znb=UD("BtnRichClient",this.Wp.wEc,this.Wp.XLc,this.Wp.Zmf,CommonUIStrings.l_OICLaunchRichClient,Object(u.a)(this,this.cBi,"onRichClientButtonClick"),TE);document.getElementById("OICLaunchRichClient").appendChild(this.Znb);WC(this.Znb);this.AOb=UD("BtnReturn",this.Wp.wEc,this.Wp.XLc,this.Wp.q8h,CommonUIStrings.l_OICReturnToOnlineClient,Object(u.a)(this,this.ZAi,"onReturnButtonClick"),
TE);document.getElementById("OICReturnToApp").appendChild(this.AOb);WC(this.AOb)}ZAi(){this.hide();this.Wp.Scc();return!0}cBi(){v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();n.AFrameworkApplication.ya.processAction(ib.a.sJb,2);return!0}xQm(){this.Wp.Scc()}dispose(){this.WK||(this.Znb&&(Sf.a.instance.sc(Kb.a.click,this.Znb,Object(u.a)(this,this.cBi,"onRichClientButtonClick")),bc.KeyInputManager.instance.sc(Kb.a.oh,this.Znb,TE)),this.AOb&&(Sf.a.instance.sc(Kb.a.click,
this.AOb,Object(u.a)(this,this.ZAi,"onReturnButtonClick")),bc.KeyInputManager.instance.sc(Kb.a.oh,this.AOb,TE)),super.dispose(),this.WK=!0)}}Object(m.a)(WI,"OICLaunchDialog",yf.a,[]);class VE{static get vg(){return yf.a.Rx(VE.tl,CommonUIStrings.l_OICDialogTitle)}}VE.tl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(VE,"ProtocolLaunchingDialogV2Html",null,[]);class XI extends yf.a{constructor(b){super();this.zOb=this.tRa=null;this.WK=!1;this.V5a=null;this.Wp=b;this.vg=VE.vg;this.Gd=5;this.lg="ProtocolLaunchingDialog";this.Nob="OICRetryDialog";n.AFrameworkApplication.uc.bCb&&n.AFrameworkApplication.uc.restart();n.AFrameworkApplication.uc.fc(new nd.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(u.a)(this,this.JOf,"protocolLaunchingDialogResultHandler"));this.m0i();this.J3("Issues");
this.HKh();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}eU(){const b=document.getElementById("Issues");if(b){VI("",this.Wp.wEc,this.Wp.XLc,this.Wp.Zmf,b);const k=document.createElement("span");k.className="WACDialogSectionTitle";k.innerText=5===this.Wp.GCi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(k);WC(b);b.style.display="none"}n.AFrameworkApplication.ta.Rb.e3h?
(this.zOb=UD("GiveFeedback",this.Wp.wEc,this.Wp.XLc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(u.a)(this,this.FXd,"onGiveFeedbackClick"),Object(u.a)(this,this.Syi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.zOb),WC(this.zOb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===n.AFrameworkApplication.ta.Rb.TKa||n.AFrameworkApplication.hYk?document.getElementById("ButtonEdit").style.display="none":(this.tRa=
UD("Edit",this.Wp.wEc,this.Wp.XLc,"",2===n.AFrameworkApplication.ta.Rb.ko?4===n.AFrameworkApplication.ta.Rb.TKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===n.AFrameworkApplication.ta.Rb.TKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(u.a)(this,this.tyi,"onEditClick"),Object(u.a)(this,this.wyi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.tRa),WC(this.tRa));0===n.AFrameworkApplication.ta.Rb.TKa&&
!n.AFrameworkApplication.Isf&&b&&(b.style.display="none")}IKh(){return this.V5a?(this.xU(this.V5a),!0):!1}HKh(){return this.tRa?(this.xU(this.tRa),!0):!1}wyi(b){return this.gGf(b,0)}Syi(b){return this.gGf(b,2)}YAi(b){return this.gGf(b,1)}gGf(b,k){let r=!1;if(b.Ib.keyCode===tb.a.hs||b.Ib.keyCode===tb.a.KFa)b.Af.click(),r=!0;else if(b.Ib.keyCode===Sys.UI.Key.down||b.Ib.keyCode===Sys.UI.Key.up)switch(k){case 1:r=this.HKh();break;case 0:r=this.IKh()}return r}tyi(){this.hide();4===n.AFrameworkApplication.ta.Rb.TKa?
(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Wp.Scc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Wp.CKc());return!0}FXd(){v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}NHf(){nL.Redirect.showHelp("OICFailure");return!0}AYd(){v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";n.AFrameworkApplication.ya.processAction(ib.a.sJb,2);return!0}JOf(){this.Wp.Scc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.V5a=UD("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(u.a)(this,this.AYd,"onRetryOICClick"),Object(u.a)(this,this.YAi,"onRetryOICKeyUp")),b.appendChild(this.V5a),WC(this.V5a),this.tRa||this.IKh())}}dispose(){this.WK||(this.tRa&&
(Sf.a.instance.sc(Kb.a.click,this.tRa,Object(u.a)(this,this.tyi,"onEditClick")),bc.KeyInputManager.instance.sc(Kb.a.oh,this.tRa,Object(u.a)(this,this.wyi,"onEditKeyUp"))),this.zOb&&(Sf.a.instance.sc(Kb.a.click,this.zOb,Object(u.a)(this,this.FXd,"onGiveFeedbackClick")),bc.KeyInputManager.instance.sc(Kb.a.oh,this.zOb,Object(u.a)(this,this.Syi,"onGiveFeedbackKeyUp"))),this.V5a&&(Sf.a.instance.sc(Kb.a.click,this.V5a,Object(u.a)(this,this.AYd,"onRetryOICClick")),bc.KeyInputManager.instance.sc(Kb.a.oh,
this.V5a,Object(u.a)(this,this.YAi,"onRetryOICKeyUp"))),super.dispose(),this.WK=!0)}}Object(m.a)(XI,"ProtocolLaunchingDialog",yf.a,[]);class WE extends cf.StandardDialog{constructor(b){super();this.Wp=b;this.lg="ProtocolLaunchingDialog";n.AFrameworkApplication.uc.bCb&&n.AFrameworkApplication.uc.restart();n.AFrameworkApplication.ta.Rb.e3h&&this.d4j(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(u.a)(this,this.FXd,"onGiveFeedbackClick"));WE.W4h?(this.Gd=12,this.We(1,CommonUIStrings.l_CloseFile),
this.We(2,CommonUIStrings.l_OICDialogContinueHere),this.We(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Gd=4,this.We(1,CommonUIStrings.l_OICDialogContinueHere),this.We(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Mhb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Wp.GCi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(u.a)(this,this.JOf,"protocolLaunchingDialogResultHandler"),null)}FXd(b){v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.Cyi(b)}AYd(){v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");n.AFrameworkApplication.ya.processAction(ib.a.sJb,2)}JOf(b){WE.W4h?3===b?this.bUi():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.bUi():(1===b||0===b)&&this.continueEditing()}closeDocument(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");n.AFrameworkApplication.ya.Xb(ib.a.close,2,Yd.a)}bUi(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(u.a)(this,this.AYd,
"onRetryOICClick"),0)}continueEditing(){4===n.AFrameworkApplication.ta.Rb.TKa||n.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===n.AFrameworkApplication.ta.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Wp.Scc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Wp.CKc())}static get W4h(){return n.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===n.AFrameworkApplication.ya.processAction(ib.a.close,
1)}}Object(m.a)(WE,"StandardProtocolLaunchingDialog",cf.StandardDialog,[]);class YI{}Object(m.a)(YI,"EditDocumentInClientParams",null,[]);class RF{static EDh(b,k,r,y,R,aa,ta=!1,Ya=!1,xb="",Mb=!1,cc=!1,jc=!1,Mc="",fd="",Td="",ne=!1){const ye=new YI;ye.DocumentUrl=b;ye.Mode=k;ye.Options=r;ye.Application=y;ye.SilentExternalHandler=ta;ye.EncodeUrl=Ya;ye.CorrelationIdForWinClient=xb;ye.NavigateUsingWindowOpen=Mb;ye.DescriptiveUnattemptedEnums=cc;ye.NoBrowserModalDialogs=jc;ye.SessionOrigin=Mc;ye.CorrelationId=
fd;ye.ClickTime=Td;ye.NewTelemetryDataIsEnabled=ne;MSOJS.ClientUtils.EditDocumentInClient(ye,R,aa)}}Object(m.a)(RF,"ClientUtils",null,[]);var SL=c(410),ZI=c(930);class dC{constructor(b){this.VTa=this.Rmc=this.Ukc=null;this.aoc=!1;this.Uye=this.WTg=null;this.U7c=this.C0=this.Jld="";this.application=this.Ay=0;this.k7n=this.h4f=!1;this.Jqo=b&&n.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");n.AFrameworkApplication.ya.p6(ib.a.sJb)||n.AFrameworkApplication.ya.pa(ib.a.sJb,zc.a.frame,Object(u.a)(this,
this.oBn,"retryOpenInClientAction"));this.n7i=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("SilentExternalHandler")}get GCi(){return this.Ay}NRn(b,k="",r=""){this.C0=r||Ra.a.create().toString();this.Jld=k||SL.a.uWh();this.U7c=b}oBn(b,k,r){return k.contextId!==zc.a.frame?2:1===r?32:this.sJb()}get options(){let b=0;n.AFrameworkApplication.oyn&&(b|=1);n.AFrameworkApplication.LCi&&(b|=4);this.d7n()&&(b|=64);return b}d7n(){return!(2===this.application&&n.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get wEc(){return n.AFrameworkApplication.pr}get XLc(){return n.AFrameworkApplication.mQ}get q8h(){return""}get Zmf(){return""}get j7n(){return n.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get H$n(){return this.WTg||
(this.WTg=Va.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.h4f||this.v6k()}Scc(){this.k7n||this.ZGh()}DLi(b){return this.Jqo&&X.a.mi?(new WI(this),32):this.Vqh(b)}Vqh(b){const k=({kmb:b}=this.esm(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===k,b);return k}begin(b,k,r,y,R,aa){this.Ukc=b;this.Rmc=k;this.VTa=aa;this.application=r;this.Ay=y;return n.AFrameworkApplication.nDh?(this.Kli(),32):n.AFrameworkApplication.Wma&&!n.AFrameworkApplication.i7h?
(n.AFrameworkApplication.y1f(),8):this.Egh(R)}get wQm(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}sJb(){this.wQm&&this.dym();return this.Vqh(this.aoc)}yYi(){const b=new ZI.a(E.a.openInClient);b.Values["ui-language"]=n.AFrameworkApplication.lcid.toString();b.Values[sq.a.Mxh]=n.AFrameworkApplication.userSessionId;return this.VTa.value.send(b)?32:8}dym(){Ga.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Xa.a,{inStaging:!0}))}pIn(b){const k=new ZI.a(E.a.zto);k.Values["ui-language"]=n.AFrameworkApplication.lcid.toString();k.Values[sq.a.Mxh]=n.AFrameworkApplication.userSessionId;k.Values[H.a.yto]=b;this.VTa.value.send(k)}esm(b){this.aoc=b;this.pIn(5===this.Ay?dC.j1m:dC.p1m);return 5===this.Ay?this.dsm():this.hsm()}dsm(){this.Tli();return{returnValue:32,kmb:"HostEditUrl,"}}hsm(){let b;var k=b="";n.AFrameworkApplication.u$g&&(k="|f|"+n.AFrameworkApplication.userSessionId);
const r=n.AFrameworkApplication.K.$("IsAssignmentMode")&&n.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||n.AFrameworkApplication.MPc||X.a.mNa,y=n.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),R=n.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(n.AFrameworkApplication.ya.fWd){var aa=n.AFrameworkApplication.ya.Zea(3588168074);aa&&this.NRn(aa.epochClickTime,aa.sessionOrigin,aa.correlationId);this.zoi()}if(n.AFrameworkApplication.jHi){b+="NewOrder,";
aa=8;this.VTa&&this.VTa.value&&this.VTa.value.isEnabled()&&n.AFrameworkApplication.Shc&&(b+="Post,",aa=this.yYi());if(32===aa)return{returnValue:aa,kmb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return n.AFrameworkApplication.Gt.sna?(v.ULS.shipAssertTag(5566816,211,!!n.AFrameworkApplication.Gt.sna),b+="HostUrl,",{returnValue:n.AFrameworkApplication.ta.f3(!0,n.AFrameworkApplication.Gt.sna),kmb:b}):this.Ukc?(v.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",n.AFrameworkApplication.userSessionId),b+="DocUrl,",RF.EDh(this.Ukc,this.Ay,this.options,this.application,Object(u.a)(this,this.vyi,"onEditInClientSuccess"),Object(u.a)(this,this.uyi,"onEditInClientFailure"),this.n7i,n.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),k,r,y,R,this.Jld,this.C0,this.U7c,n.AFrameworkApplication.ya.fWd),{returnValue:32,kmb:b}):{returnValue:8,kmb:b}}b+="OldOrder,";if(!this.Ukc&&n.AFrameworkApplication.Gt.sna)return this.VTa&&
this.VTa.value&&this.VTa.value.isEnabled()&&n.AFrameworkApplication.Shc?(b+="Post,",k=this.yYi()):(v.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),k=8),32!==k?(v.ULS.shipAssertTag(22595484,211,!!n.AFrameworkApplication.Gt.sna),b+="HostUrl,",{returnValue:n.AFrameworkApplication.ta.f3(!0,n.AFrameworkApplication.Gt.sna),kmb:b}):{returnValue:k,kmb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",n.AFrameworkApplication.userSessionId);
b+="DocUrl,";RF.EDh(this.Ukc,this.Ay,this.options,this.application,Object(u.a)(this,this.vyi,"onEditInClientSuccess"),Object(u.a)(this,this.uyi,"onEditInClientFailure"),this.n7i,n.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),k,r,y,R,this.Jld,this.C0,this.U7c,n.AFrameworkApplication.ya.fWd);return{returnValue:32,kmb:b}}pxn(b){n.AFrameworkApplication.Hm.setDw(8981,b)}vyi(b){this.pxn(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.j7n||this.Tli(),this.zoi()):this.h4f||this.closeApplication()}uyi(b,k=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,k);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.Rmc&&!this.aoc;let y=0;1===b&&(y=2);6<=b&&13>=b&&(y=1,1===k&&(this.h4f=!0));this.H$n.iQm?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",y),UI.a.instance.zNk(this.aoc?Object(u.a)(this,this.Cwi,
"oicErrorDialogHandlerCloseForced"):Object(u.a)(this,this.Dwi,"oicErrorDialogHandlerNoCloseForced"),r?Object(u.a)(this,this.rzi,"onLaunchDownload"):null,this.mBh(!1)?Object(u.a)(this,this.K0l,"iHaveOfficeButtonHandler"):null,y,k)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",y),UI.a.instance.xNk(this.aoc?Object(u.a)(this,this.Cwi,"oicErrorDialogHandlerCloseForced"):Object(u.a)(this,this.Dwi,"oicErrorDialogHandlerNoCloseForced"),r?Object(u.a)(this,this.rzi,"onLaunchDownload"):
null,y))}}zoi(){try{const b=[Object.assign(new ca.a,{name:"CorrelationId",string:this.C0}),Object.assign(new ca.a,{name:"SessionOrigin",string:this.Jld}),Object.assign(new ca.a,{name:"ClickTime",string:this.U7c}),Object.assign(new ca.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Ib.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}Tli(){n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.NA&&
n.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new WE(this):new XI(this)}Cwi(){this.closeApplication()}Dwi(){this.Scc()}rzi(){this.Kli()}K0l(){return this.mBh(!0)}mBh(b){const k=(X.a.L_a||X.a.Ys)&&!!n.AFrameworkApplication.Czd;k&&b&&(Qe.a.Gm(n.AFrameworkApplication.Czd,"_blank",void 0,"OpenInClient"),this.closeApplication());return k}}dC.p1m="OpenInDesktop";dC.j1m="OpenInBrowser";Object(m.a)(dC,"AOpenInClientOperation",null,[]);class SF extends dC{constructor(b,k,r=!1){super(r);this.HIj=
b;this.GIj=k}get q8h(){return this.GIj}get Zmf(){return this.HIj}v6k(){n.AFrameworkApplication.ya.Xb(ib.a.close,2,Yd.a)}ZGh(){}Egh(b){return this.DLi(b)}Kli(){v.ULS.shipAssertTag(5566817,211,!!this.Rmc);n.AFrameworkApplication.faa?n.AFrameworkApplication.ta.f3(!0,this.Rmc):Qe.a.Gm(this.Rmc,void 0,void 0,"LaunchDownload")}CKc(){n.AFrameworkApplication.ta.Rb.CKc()}}Object(m.a)(SF,"OpenInClientOperation",dC,[]);class $I extends SF{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.Hqn=
b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Ka.App.S_.forceOutbound(this.WCi,this.Hxm,b)};this.Hxm=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const k=new cf.StandardDialog;k.Gd=0;k.my(pj.a.pho,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.Fxm:this.Gxm)};this.Fxm=()=>{n.AFrameworkApplication.ya.Xb(ib.a.close,2,Yd.c)};this.Gxm=()=>{Ka.App.xa.refreshDocument(null)};this.WCi=b=>{n.AFrameworkApplication.K1c=
!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.DLi(b)}}xjk(b){Ka.App.ik.kOa.pQ||Ka.App.vd.cB.Bo?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.WCi(b)):Ug.a.XP(4,!0,this.Hqn,null,b)}Egh(b){this.xjk(b);return 32}ZGh(){Ka.App.xa.refreshDocument(null)}}Object(m.a)($I,"OpenInWordOperation",SF,[]);const aJ=(b,k)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");
b[Ig.a.On]=De.PageReader.instance.Ju(k);De.PageReader.instance.Ju(k)?b[Ig.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Ig.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},TL=(b,k,r,y,R)=>{if(!Ka.App.xa||!Ka.App.xa.jb||!n.AFrameworkApplication.Kp.Bdb)return 8;k=Ka.App.xa.jb.Xc;if(!k)return 8;if(b===Wa.a.l1d&&2===r){b=new sf.GraphTransaction(15);try{b.Eb(k),De.PageReader.instance.ubo(k)}finally{b&&b.dispose()}aJ(R,k)}return 32},UL=(b,k,r,y,R)=>{if(!Ka.App.xa||
!Ka.App.xa.jb)return 8;b=Ka.App.xa.jb.Xc;if(!b)return 8;R[Ig.a.Alt]=n.AFrameworkApplication.Kp.Bdb?"":CommonUIStrings.l_ProtectDocumentToolTip;aJ(R,b);return 32};class bJ extends RI.a{constructor(b,k){super(b,k);this.aNg=!1;this.Zzi=(r,y,R,aa,ta)=>{var Ya;if(y.contextId!==zc.a.frame)return 2;if(!(Ka.App.nBc||n.AFrameworkApplication.Gt.sna||n.AFrameworkApplication.Shc||this.aNg))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.aNg=!0,8;if(1===R)return Ae.SessionStatusManager.instance.Tj?
8:32;let xb=!1;void 0!==ta&&null!==ta&&(xb=ta);if(null===(Ya=n.AFrameworkApplication.K)||void 0===Ya?0:Ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new TI).rZd().then(()=>this.jHb(r,xb));else return this.jHb(r,xb);return 32};this.e_k=r=>{this.Uym();if(!n.AFrameworkApplication.MPc&&n.AFrameworkApplication.ta.Rb.L_f(ib.a.downloadACopy.toString()))this.Zva(!0,E.a.download,!0,{});else if(n.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let y=n.AFrameworkApplication.Xyb;
r&&r.FileDownloadUrl&&(y=r.FileDownloadUrl.toString());new SI(y)}else super.downloadACopy(0,null,2,null,null)};this.isk=r=>{super.workflow(0,null,2,null,r)};this.mS=Va.a.instance.$a("Common.ISystemInitiatedFeedback")}Vb(){super.Vb();this.ga.pa(Wa.a.openInClient,zc.a.frame,this.Zzi);n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Wa.a.openInClient,12288);var b=this.ga;b.gb(Wa.a.l1d,lc.a.application,
TL,4);b.gb(Wa.a.JPf,lc.a.application,UL,96);this.ga.pa(ib.a.PJf,zc.a.frame,this.Zzi)}jHb(b,k){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new $I).begin(Ka.App.nBc,n.AFrameworkApplication.Xyb,SE.Word,b===ib.a.PJf?TD.OpenInBrowser:TD.WriteOnly,k,new cg.a(()=>this.MW))}Msd(b){return bi.a.instance.Vza()?!0:Ka.App.xa.TVi(1,Rh.AppFrame.$zk,b)}downloadACopy(b,k,r,y,R){if(2===r){if(!n.AFrameworkApplication.Xyb&&!n.AFrameworkApplication.ta.Rb.L_f(ib.a.downloadACopy.toString()))return 8;
Ug.a.XP(2,!0,this.e_k,null,R);return 32}return super.downloadACopy(b,k,r,y,R)}Uym(){n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.mS&&this.mS.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,k,r,y,R){return 2===r?(Ug.a.XP(13,!0,this.isk,null,R),32):super.workflow(b,k,r,y,R)}}Object(m.a)(bJ,"AppFrameCommandUIActor",RI.a,[]);class cJ extends cf.StandardDialog{constructor(){super();
this.Gd=0;this.Mhb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(m.a)(cJ,"WheresTheSaveButtonDialog",cf.StandardDialog,[]);const VL=(b,k,r)=>{if(1===r)return 32;new cJ;return 32};var TF=c(566),UF=c(1331);class Mr extends Il.a{constructor(b,k,r,y,R,aa,ta=null){var Ya,xb,Mb;super();this.Bua=ta;this.Uyj=50;this.Vyj=56;this.gXg="px";this.Ixj=
"aria-label";this.lGa="BookmarkIndicator";this.WIg="HighlightBookmarkedContent";this.SHj="HighlightBookmark";this.CSa="wwaengidc";this.Jkk="Bookmark_24";this.fb=b;this.kg=r;this.Lj=k;this.V4=y;this.wC=R;this.x1g=null===(Ya=n.AFrameworkApplication.K)||void 0===Ya?void 0:Ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",!1);this.Zyj=null===(xb=n.AFrameworkApplication.K)||void 0===xb?void 0:xb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);
this.Qyj=null===(Mb=n.AFrameworkApplication.K)||void 0===Mb?void 0:Mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.wC&&this.wC.zPe(this.nD.bind(this));this.OH=aa}SUn(b){if(b.Vj){for(let k of b.Ag.Ji)if(this.M_f(k))return!0;return!1}return this.M_f(b.htmlElement)}HKb(b){let k=!1;n.AFrameworkApplication.Ne("bookmarks-core-ex;bookmarks-core-ex-cf");this.Zyj&&(n.AFrameworkApplication.Ne("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf"),this.x1g?Bo.a.instance.Qd(()=>
{k=this.SUn(b)},"BIA:SCIVE"):Bo.a.instance.Qd(()=>{k=this.M_f(b.htmlElement)},"BIA:SCI"));return k}M_f(b){return Mr.IHe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}Nxb(b){const k=[];Bo.a.instance.Qd(()=>{const r=b.Fwb(0,this.OH?this.Vyj:this.Uyj,this.zoom);k.push(this.XWa(b.o7,r,b.J4c[0].y-b.B2[0].y))},"BIA:CIs");return k}XWa(b,k,r){const y=b.Ng.ownerDocument,R=Uh.a.createElement(y,tk.a.div);R.className=this.OH?Mr.Yyj:Mr.fje;Mr.fje;
R.style.left=k+this.gXg;R.style.top=r+this.gXg;this.OH?(k=Uh.a.createElement(y,tk.a.div),ni.a("renderIcon")&&appChrome.api.renderIcon(this.Jkk,k),k.setAttribute("role","img"),k.setAttribute("alt","Bookmark")):(k=Uh.a.createElement(y,tk.a.KZa),k.src=Qk.a.Sh(Mr.u7c),k.alt="Bookmark");k.title="Bookmark";k.setAttribute(this.Ixj,"Bookmark");R.appendChild(k);b={context:new PE([],R,new Set,new Set,null,null),gQm:b,container:R};this.OH||(this.Lj.mb(Kb.a.CQ,k,this.onMouseEnter),this.Lj.mb(Kb.a.uK,k,this.nna));
this.kg.uE(Kb.a.click,R,this.j1a.bind(this),b);return R}joh(){const b=Object.assign(new hi.a,{action:1,type:5,JF:null,mO:this.e6a});this.e6a=null;this.V4.rH(b)}nD(b,k){this.e6a&&(k.Lcb.Af.classList.contains("BookmarkHighlightSelected")||this.joh())}onMouseEnter(b){if(null==b)return!1;b=b.Af;b.parentElement.classList.add(Mr.txg);b.src=Qk.a.Sh(Mr.Syj);return!0}nna(b){if(null==b)return!1;b=b.Af;b.parentElement.classList.remove(Mr.txg);b.src=Qk.a.Sh(Mr.u7c);return!0}j1a(b){this.k2a(this.WIg,this.SHj);
if(null==b){var k=new Map;k.set("Source",this.lGa);k=Object.assign(new Xa.a,{additionalValues:k});Ga.Health.instance.recordKpiFailure(this.WIg,"Unable to highlight bookmarked content",!1,!0,k);return!1}n.AFrameworkApplication.Ne("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.Qyj){k=b.Dp.context;if(Mr.fEb(k,this.e6a))return!0;k=this.kwl(b.Dp.gQm,k,b.Dp.container);b=Object.assign(new hi.a,{action:0,type:5,JF:k,mO:this.e6a});this.e6a=k;this.V4.rH(b);return!0}return!1}kwl(b,k,r){k={rhh:new Set,
EKf:new Set,uhh:null,STe:null};const y=this.fb.ww(b.zb,!0,!1);let R=[];if(y)for(let aa of y)R.push(aa);this.r5j(b,k,R);k=new PE(R,r,k.rhh,k.EKf,k.uhh,k.STe);this.e6a&&this.e6a.ru===R&&(r.className+=String.format(" {0}",Mr.Tyj),this.e6a=k);return k}r5j(b,k,r){n.AFrameworkApplication.Ne("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf");if(this.x1g&&b.Vj){var y=new Set;for(let aa of b.Ag.Ji)aa.querySelectorAll("*").forEach(y.add,y);b=Array.from(y.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let R=[];k.EKf.add(r[0].id);k.uhh=r[0].id;k.STe=r[0].id;b.forEach(aa=>{let ta=jj.a.Db(aa,vm.a.Xsd);if(ta)for(let Ya of ta)R.push(Ya),k.rhh.add(Ya);if(!R.length)return!0;aa=jj.a.Db(aa,vm.a.Dab);if(!aa)return!0;R=UF.a.MXc(R,aa)});for(b=this.fb.eh(r[r.length-1],!1,!0);R.length&&b;){k.EKf.add(b.id);k.STe=b.id;r.push(b);y=b;if(this.bbm())this.Bua.value.Ii(b).htmlElement.querySelectorAll("."+vm.a.Usd).forEach(aa=>{(aa=jj.a.Db(aa,vm.a.Dab))&&(R=UF.a.MXc(R,aa))});else for(let aa of y.xD)aa.htmlElement.querySelectorAll("."+
vm.a.Usd).forEach(ta=>{(ta=jj.a.Db(ta,vm.a.Dab))&&(R=UF.a.MXc(R,ta))});y=b=this.fb.eh(b,!1,!0)}}k2a(b,k){const r=new Map;r.set("Source",this.lGa);r.set("Action",k);Ga.Health.instance.recordKpiUsage(b,0,this.CSa,r)}static fEb(b,k){return!!k&&!!b&&b.ohh===k.ohh}bbm(){n.AFrameworkApplication.Ne("bookmarks-navpane-fix;bookmarks-navpane-fix-cf");return n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksNavPaneFixIsEnabled",!1)}}Mr.txg="WordBookmarkIndicatorContainerHovered";
Mr.Tyj="WordBookmarkIndicatorContainerSelected";Mr.u7c="BookmarkDefault.png";Mr.Syj="BookmarkHover.png";Mr.IHe=!0;Mr.fje="WordBookmarkIndicatorContainer";Mr.Yyj="WordBookmarkSvgIndicatorContainer";Object(m.a)(Mr,"BookmarkIndicatorActor",Il.a,[292]);class dJ{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb=null,cc=null,jc=null,Mc=null,fd=null,Td=null,ne=null){this.X0="_";this.Jie="Bookmark";this.syj=/^BOOKMARK\d+$/i;this.lGa="BookmarkRibbonOptions";this.Oyj="BookmarkFloatieOptions";this.$Ag="CreateBookmarkOnRange";
this.aBg="CreateBookmarkOnView";this.ZAg="CreateBookmarkOnIP";this.eme="CreateBookmark";this.CSa="wwaengidc";this.P1g="ShowHideBookmarksOnDocument";this.kCg="DeleteBookmark";this.ICj="DeleteBookmarkAction";this.QWj="ShowHideBookmarks";this.O1g="ShowBookmarksFloatie";this.NWj="ShowBookmarksFloatieAction";this.NDg="EditBookmark";this.EDj="EditBookmarkAction";this.Tzc="BookmarksUsage";this.Nkk="InsertTabSwitchActivity";this.A8l="Insert";this.ZNb=b;this.ga=k;this.hb=r;this.nl=y;this.Ax=R;this.X4=aa;this.Hc=
ta;this.UK=Ya;this.Vt=cc;this.sxg=xb;this.He=Mb;this.F4=fd;this.Bn=jc;this.Zc=Mc;this.fB=Td;this.Mk=ne}get fy(){return this.Ax.value}Vb(){this.Lpf()&&(this.ga.pa(Jc.a.AKa,lc.a.view,this.AKa.bind(this)),this.ga.gb(ib.a.xQa,lc.a.application,this.Kdo.bind(this),96),this.ga.pa(Jc.a.AKa,lc.a.Hd,this.LJk.bind(this)),this.ga.pa(Jc.a.AKa,lc.a.Wc,this.KJk.bind(this)),this.ga.pa(Jc.a.deleteBookmark,lc.a.view,this.deleteBookmark.bind(this)),this.ga.pa(Jc.a.o6e,lc.a.view,this.w1k.bind(this)),this.ga.gb(Jc.a.F5i,
lc.a.view,this.WZn.bind(this),1028),this.ga.gb(Jc.a.r1d,lc.a.application,this.r1d.bind(this),96),this.ga.gb(Jc.a.K8d,lc.a.Wc,this.K8d.bind(this),1028),this.ga.gb(Wa.a.pSd,lc.a.view,this.pSd.bind(this),1028),this.ga.gb(Jc.a.xLd,lc.a.view,this.xLd.bind(this),1028),this.ga.Vc(Jc.a.AKa,1028))}Kdo(b,k,r,y,R){return R&&R.NewContextId===this.A8l?(this.o9b(this.Nkk),32):2}AKa(b,k,r,y,R){var aa,ta;b=this.hb.Jg;if(!b||b.contextId===lc.a.anchoredObject)return 2;if(1===r)return Me.a.ufa(k)||cs.a.Hwd&&(null===
(aa=this.Mk)||void 0===aa?0:aa.mZ(b))||(null===(ta=this.Mk)||void 0===ta?0:ta.fua(b))?8:32;k=this.hb.ib.kb;if(!k||this.He.Dm(k))return 2;this.sRc(R,"User is trying to create bookmark from UILocation : {0}");this.k2a(this.aBg,this.eme);if(k&&this.nl.wqd(this.yLa(),k))return this.o9b(this.Tzc),32;R=new Map;R.set("Source",this.lGa);R=Object.assign(new Xa.a,{additionalValues:R});Ga.Health.instance.recordKpiFailure(this.aBg,"Unable to create bookmark",!1,!0,R);return 8}LJk(b,k,r,y,R){if(1===r)return 32;
if(lc.a.Hd!==k.contextId)return 8;this.sRc(R,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.kb;if(!b)return 2;this.k2a(this.$Ag,this.eme);if(this.nl.wqd(this.yLa(),b))return this.o9b(this.Tzc),32;b=new Map;b.set("Source",this.lGa);b=Object.assign(new Xa.a,{additionalValues:b});Ga.Health.instance.recordKpiFailure(this.$Ag,"Unable to create bookmark for range",!1,!0,b);return 8}KJk(b,k,r,y,R){if(1===r)return 32;if(lc.a.Wc!==k.contextId)return 8;this.sRc(R,"User is trying to create bookmark from UILocation : {0}");
b=this.hb.ib.kb;if(!b)return 2;this.He.Dm(b)&&(k=b.Qa,this.He.Lgb(k)?(b=this.He.k2(k,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.He.k2(k,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.k2a(this.ZAg,this.eme);if(this.nl.wqd(this.yLa(),b))return this.o9b(this.Tzc),32;b=new Map;b.set("Source",this.lGa);b=Object.assign(new Xa.a,{additionalValues:b});Ga.Health.instance.recordKpiFailure(this.ZAg,
"Unable to create bookmark for IP",!1,!0,b);return 8}r1d(b,k,r,y,R){1===r&&32;R[Ig.a.On]=Mr.IHe;return 32}WZn(b,k,r,y,R){if(1===r)return 32;this.k2a(this.P1g,this.QWj);(b=R[Ig.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Mr.IHe=b;b=lk.PageNavigator.instance.tT(this.fy);if(null!==b)return this.YWc(b),this.ZNb.nG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.lGa);b=Object.assign(new Xa.a,{additionalValues:b});Ga.Health.instance.recordKpiFailure(this.P1g,
"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,k,r,y,R){if(this.Lpf()){b=this.hb.ib.kb;if(!b)return 2;b=b.Qa;b=this.nl.gIc(b.node,b.cpBegin);if(1===r)return b?32:8;this.sRc(R,"User is trying to delete bookmark from UILocation : {0}");this.UK.QZ&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.UK.tw());this.k2a(this.kCg,this.ICj);b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");
if(b&&this.nl.uSf(b.id))return this.sxg&&this.sxg.joh(),this.o9b(this.Tzc),32;r=new Map;r.set("Source",this.lGa);r=Object.assign(new Xa.a,{additionalValues:r});Ga.Health.instance.recordKpiFailure(this.kCg,"Unable to delete bookmark",!1,!0,r);return 8}return 2}w1k(b,k,r,y,R){if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.hb.ib.kb;if(!b)return 2;b=b.Qa;b=this.nl.gIc(b.node,b.cpBegin);if(1===r)return b?
32:8;this.sRc(R,"User is trying to edit bookmark from UILocation : {0}");this.UK.QZ&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.UK.tw());this.k2a(this.NDg,this.EDj);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.F4.value.x1k(k,b,this.nl),this.o9b(this.Tzc),32;k=new Map;k.set("Source",this.lGa);k=Object.assign(new Xa.a,{additionalValues:k});Ga.Health.instance.recordKpiFailure(this.NDg,
"Unable to edit bookmark",!1,!0,k);return 8}return 2}sRc(b,k){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,k,b.UILocation)}K8d(b,k,r,y,R){if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===r&&32;this.k2a(this.O1g,this.NWj);if(k.contextId===lc.a.Wc)return b=Array(1),b.push("Bookmarks"),this.UK.showFloatie(R.location,b,1),32;R=new Map;R.set("Source",this.Oyj);R=Object.assign(new Xa.a,{additionalValues:R});Ga.Health.instance.recordKpiFailure(this.O1g,
"Unable to show bookmark floatie",!1,!0,R);return 8}return 2}pSd(b,k,r,y,R){let aa;return 1===r?(Bo.a.instance.Qd(()=>{aa=this.ga.Vf(k,Wa.a.insertHyperlink,r,!0,y,R);32!==aa&&(aa=this.ga.Vf(k,Jc.a.AKa,r,!0,y,R))},"BA:LFE"),aa):8}xLd(b,k,r){var y;if(1===r)return 32;if(b=this.hb.ib.kb){b=b.Qa.node;if(k=this.wHh(b))return k.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.nl.gIc(b,0)){b=this.fB.Yja.get(null===(y=b.id)||void 0===y?void 0:y.toString());
y=lk.PageNavigator.instance.tT(this.fy).Mc.Db(b);if(y=this.wHh(y))return y.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}wHh(b){let k;b=this.Bn.Sk(b).Ii(this.Zc.yd.Sb);b.T6b&&(b=b.htmlElement.querySelectorAll("div."+Mr.fje),0<b.length&&(k=b[0]));return k}YWc(b){const k=TF.b(b);if(k){var r=this.Hc.Rc(2);try{for(r.Eb(b);k.moveNext();){if(!ie.ParagraphReader.yh(k.iterator))continue;
const y=k.currentNode;this.D0k(y)&&this.X4.S5b(y,!0)}}finally{r&&r.dispose()}}}D0k(b){for(let r=0;r<b.qa.length;r++){const y=b.qa.J(r);if(null!=y.Lh)for(let R=0;R<y.Lh.length;R++){var k=y.Lh.J(R);if(null!=k&&(k=b.Mc.Db(k.sn).ia(wc.a.Rs,""),!A.a.lf(k)&&!k.startsWith(this.X0)))return!0}}}yLa(){var b=this.nl.nHc(!1);let k=[];for(let r=0;r<b.count;r++){let y=b.J(r).ia(wc.a.Rs,"");this.syj.test(y)&&k.push(y)}return 0<k.length?(k.sort((r,y)=>r.localeCompare(y,void 0,{numeric:!0})),b=parseInt(k[k.length-
1].substring(this.Jie.length)),this.Jie+(b+1)):this.Jie+1}k2a(b,k){const r=new Map;r.set("Source",this.lGa);r.set("Action",k);Ga.Health.instance.recordKpiUsage(b,0,this.CSa,r)}o9b(b){this.Lpf()&&this.Vt&&this.Vt.execute(k=>{k.logActivity(b,null)})}Lpf(){n.AFrameworkApplication.Ne("bookmarks-core-ex;bookmarks-core-ex-cf");return n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(m.a)(dJ,"BookmarkActor",null,[]);class eJ{constructor(b,
k,r){this.wc=b;this.kXk=k;this.Bg=r;this.nYe=this.nYe.bind(this)}Vb(){this.wc.pa(Jc.a.mwf,lc.a.view,this.nYe);this.wc.gb(Jc.a.t1d,lc.a.view,Mh.a.TQ,96);this.wc.gb(Jc.a.v1d,lc.a.view,Mh.a.TQ,96);this.wc.gb(Jc.a.u1d,lc.a.view,Mh.a.TQ,96);this.wc.pa(Jc.a.mZd,lc.a.view,Mh.a.HF);this.wc.pa(Jc.a.oZd,lc.a.view,Mh.a.HF);this.wc.pa(Jc.a.nZd,lc.a.view,Mh.a.HF)}nYe(b,k,r,y,R){return 1===r?32:(b=this.Bg.S$(k.rk))?(R=3===R.$w,this.kXk.value.zuh(this.cHl(b),this.yQl(b),R),32):2}cHl(b){const k=new Di.DictionaryPropertySet;
k.setValue(Jj.a.LC,this.Bg.Yg(b));k.setValue(Jj.a.Mx,this.Bg.Jea(b));k.setValue(Jj.a.iW,this.Bg.oAb(b));return k}yQl(b){const k=new Di.DictionaryPropertySet;k.setValue(wc.a.marginLeft,this.Bg.DI(b));k.setValue(wc.a.marginRight,this.Bg.eK(b));k.setValue(wc.a.Oo,this.Bg.ev(b));return k}}Object(m.a)(eJ,"ColumnsDialogActor",null,[]);class fJ{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.Qo=b;this.dqa=k;this.ng=r;this.us=y;this.qm=R;this.Yd=aa;this.Hc=ta;this.Ce=Ya;this.ga=xb;this.hKj=Mb;this.kwe=cc}get $cm(){return this.hKj}Vb(){this.ga.gb(Wa.a.O0f,
lc.a.view,this.g7l.bind(this),96);this.ga.gb(Wa.a.IXc,lc.a.view,this.IXc.bind(this),4)}g7l(b,k,r,y,R){b=this.Qo.getById(R);if(!b)return 8;k=b.contentControlNode;if(!k)return 8;if(k.ia(wc.a.V5,!1))return 2;r=this.Qo.Pol(b);if(!r)return 8;y=this.Hc.Rc(7);y.Eb(r.node);if(!this.$cm)return(R=b.a0d)||(R=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Yd.replaceTextRange(r,R),this.ksd(b),k.setValue(wc.a.V5,!0),y.dispose(),32;R=new Di.DictionaryPropertySet;R.setValue(td.a.h3h,r);var aa=
k.ia(wc.a.LZe,"");aa=this.dqa.r2h(aa);if(!aa)return this.us.replaceTextRange(r,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.ksd(b),k.setValue(wc.a.V5,!0),y.dispose(),32;R.setValue(td.a.Xjf,aa);if(1<aa.length&&!b.Tf)return y.dispose(),8;this.hIk(R);k.setValue(wc.a.V5,!0);y.dispose();return 32}IXc(b,k,r){var y=k.view.ye?k.view:null;if(!y||!y.Cb)return 8;if(cs.a.MFk)return this.vrn(y,r);k=y.Cb.ib.J(0);b=this.qm.Hea(k.Qa,k.Tc,1);if(!b||0==b.count)return 8;var R=this.qm.Hea(k.Qa,
k.Tc,3);k=new xc.a;if(R&&0<R.count){for(var aa of R)k.add(aa.id,aa);for(aa=b.count-1;0<=aa;aa--)k.ub(b.J(aa).id)&&b.removeAt(aa);0==b.count&&(aa=R.J(0),b.add(aa))}for(aa=0;aa<b.count;aa++)R=b.J(aa),k.add(R.id,R);if(1===r){for(r=b.count-1;0<=r;r--)if(y=b.J(r),aa=k.J(y.parentId),this.sOd(y,aa))return 32;return 8}if(2===r){r=this.Hc.Rc(15);r.Eb(y.ld);for(y=b.count-1;0<=y;y--)aa=b.J(y),R=k.J(aa.parentId),this.sOd(aa,R)&&this.Qo.Njb(aa.id);r.dispose();return 32}return 2}vrn(b,k){const [r,y]=this.jKl(b.Cb.ib);
if(0===r.length)return 8;if(1===k){for(var R of r){var aa=y.get(R.parentId);if(this.sOd(R,aa))return 32}return 8}if(2===k){k=this.W1n(r,y);R=this.Hc.Rc(15);R.Eb(b.ld);for(aa of k)b=y.get(aa.parentId),this.sOd(aa,b)&&this.Qo.Njb(aa.id);R.dispose();return 32}return 2}jKl(b){var k,r,y=[];for(const aa of b)y.push(...(null!==(k=this.qm.Hea(aa.Qa,aa.Tc,1))&&void 0!==k?k:[]));if(0===y.length)return[y,new Map];k=[];for(const aa of b)k.push(...(null!==(r=this.qm.Hea(aa.Qa,aa.Tc,3))&&void 0!==r?r:[]));b=new Map(y.map(aa=>
[aa.id,aa]));if(0===k.length)return[y,b];const R=new Map(k.map(aa=>[aa.id,aa]));y=y.filter(aa=>!R.has(aa.id));b=new Map([...b,...R]);return 0==y.length?[[k[0]],b]:[y,b]}ksd(b){const k=this.us.jHd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);k?this.kwe&&(b=this.Ce.Sx(b.start.node).wh("Placeholder Text"))&&(this.ng.hka(k.formatting),this.ng.Skb(k.formatting,b)):v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}hIk(b){this.ga.Xb(Wa.a.showPlaceholderGlossary,
2,b)}sOd(b,k){return b.pfa&&b.hlm&&(!k||k.isEditable)}W1n(b,k){const r=(y,R)=>null==y||null==R||y.id===R.id?!1:y.id===R.parentId||r(k.get(y.parentId),R);return b.slice().sort((y,R)=>r(y,R)?1:r(R,y)?-1:0)}}Object(m.a)(fJ,"ContentControlActor",null,[]);class VD{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.kak=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it",
"status updates. Thank you."];this.Mao="Interested in this feature?"}Vb(){this.ga.pa(Jc.a.x2e,lc.a.view,this.l$l.bind(this))}l$l(b,k,r){2===r&&(Object(Ib.c)(Jc.a.x2e),b=new cf.StandardDialog,b.Gd=4,b.We(1,this.primaryButtonText),b.We(2,this.secondaryButtonText),b.hyc(this.kak,null),b.Tv(this.Mao,null,0,this.p$));return 32}p$(b){1===b&&(Object(Ib.a)("CountMeIn_CustomizeRibbon",!0),A.a.$W(VD.Skj)&&Qe.a.Gm(VD.Skj))}}VD.Skj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";
Object(m.a)(VD,"CustomizeRibbonActor",null,[]);var By=c(1041);class VF extends yf.a{constructor(b,k,r){super(!1,!1,!0);this.XPg=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,By.a.FQe,By.a.EQe,By.a.GQe];this.Jxj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,By.a.tbk,By.a.sbk,By.a.vbk];this.Lvg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Yec=()=>{new VF(this.ga,this.CJe,this.imc)};this.Axl=
()=>{const y=[];for(let R of this.CJe)y.push(this.V3(R));return y};this.Koo=y=>{const R=new Set;this.Spa="";for(let aa of y)if(""!==aa.position){const ta=this.zWh(aa.position);if(0>ta||22<ta){this.Spa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(R.has(ta)){this.Spa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.abo(aa)),R.add(ta)}else{this.Spa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Spa&&(this._tabStops=
[],this.CJe=y)};this.FRk=(y,R)=>{try{if(1===y){if(""!==this.Spa)throw Error.create(this.Spa);R.DefaultTabStop&&(this.imc=By.a.ZVf(R.DefaultTabStop),this.aso(this.imc));if(32!==this.ga.Xb(Jc.a.HMb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Rg.a.GA(this.imc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(aa){this.dwa(aa.message,this.Yec)}};this.ga=b;this.CJe=k;this._tabStops=[];this.imc=r;this.Spa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.zHc()};
this.Vh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.FRk,b)}V3(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}zWh(b){return Math.floor(100*parseFloat(b))/100}abo(b){return new gy.a(Rg.a.GA(this.zWh(b.position)),By.a.NMl(b.alignment),By.a.LMl(b.leader),1)}aso(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var k={};if(32===this.ga.Xb(Wa.a.VDa,2,k)){var r=k.marginLeft;const y=Vf.a.Ri(k.marginRight,0);r=Vf.a.Ri(r,0);
k=Vf.a.Ri(k.Oo,0);if(Vf.a.Y$(b,0,!1)>=k-y-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}zHc(){return{["getInitState"]:this.Axl,["updateState"]:this.Koo,["validPositions"]:this.O_h(-Infinity,Infinity,"Position"),["validAlignments"]:this.yPh(this.Lvg,this.Lvg,null,"Alignment"),["validLeaders"]:this.yPh(this.XPg,this.XPg,this.Jxj,"Leader"),["defaultTabStopSpinButtonProps"]:this.O_h(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.imc,["DefaultTabStop"]:"DefaultTabStop",
["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,
["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}O_h(b,k,r){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:r,["unitType"]:"Inch",["validUnits"]:[sz("Inch",3,b,k,.1)],["numberFormatInfo"]:AF()}}yPh(b,k,r,y){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:y,["options"]:FE(b,k,r)}}}Object(m.a)(VF,"CustomTabDialog",
yf.a,[]);class gJ{constructor(b,k,r){this.$9b=(y,R,aa,ta,Ya)=>{if(2!==aa)return 8;if(!Ya)return 16;y=Ya.tabStop;Ya=Ya.value;if(!y)return 16;Ib.c(Jc.a.$9b);Ya=new gy.a(Ya,y.Kba,y.Vma,y.x4f);R=R.node;this.Fxa.q2a(R,y);this.Fxa.MMd(R,Ya);return 32};this.h_c=(y,R,aa,ta,Ya)=>{if(2===aa){if(!Ya)return 16;this.Fxa.MMd(R.node,Ya);return 32}return 8};this.lIb=(y,R,aa,ta,Ya)=>{y=this.Fxa.wLi(R.node);if(!("customTabs"in Ya))return Ya.customTabs=y,32;R=Ya.customTabs;if(!R||0>=R.length||!y||0>=y.length)return Ya.customTabs=
null,32;aa=[];for(let xb of R)for(let Mb of y)if(Mb.WEa===xb.WEa&&Mb.x4f===xb.x4f&&Mb.Kba===xb.Kba){aa.push(xb);break}Ya.customTabs=aa;return 32};this.q2a=(y,R,aa,ta,Ya)=>{if(2===aa){if(!Ya)return 16;Ib.c(Jc.a.q2a);this.Fxa.q2a(R.node,Ya);return 32}return 8};this.UIb=(y,R)=>{this.Fxa.UIb(R.node);return 32};this.HMb=(y,R,aa,ta,Ya)=>{if(2===aa){if(!Ya)return 16;y=Ya.tabStops;aa=Ya.defaultTabStopLength;R=R.node;ta=!1;let xb=this.Fxa.uwn(R,y);Ya.defaultTabStopLengthSaved||(ta=this.IJ.lLn(R,aa),Ya.defaultTabStopLengthSaved=
!0);xb&&Ib.d(Jc.a.HMb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Custom Tab Stops Count",string:y.length.toString()})]);if(null==ta)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.lYc&&this.lYc.Oai(),this.Rd.ys(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Ib.d(Jc.a.HMb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Default Tab Stop Length",string:aa.toString()})]));return 32}return 8};this.Q5i=
(y,R,aa)=>{if(2!==aa)return 8;y={};if(32!==this.ga.Xb(Jc.a.EL,2,y))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;R={};if(32!==this.ga.Xb(Wa.a.VDa,2,R))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;y=By.a.ZVf(Rg.a.mC(y.defaultTabStop));aa={};aa.defaultTabStopLength=y;aa.sectionPropertiesData=R;if(32!==this.ga.Xb(Jc.a.R$f,2,aa))return v.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),
16;if(!aa.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.Fxa.dwa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;R={};if(32!==this.ga.Xb(Jc.a.lIb,2,R))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(R=R.customTabs)||(R=[]);R=By.a.MMl(R);new VF(this.ga,R,y);Ib.c(Jc.a.Yec,!0);return 32};this.Rjm=(y,R,aa,ta,Ya)=>{if(2!==aa)return 8;if(!Ya)return 16;if(Ya.isParagraphValid)return 32;
aa={};if(32!==this.ga.Vf(R,Wa.a.d2a,2,!1,null,aa))return 16;y=Ya.sectionPropertiesData;R=Ya.defaultTabStopLength;var xb=aa.Ws;ta=xb.gma;xb=1===xb.specialIndentType?xb.HA:xb.HA-xb.Fba;const Mb=y.marginLeft,cc=y.marginRight;aa.isRtl?(aa=Vf.a.Ri(Math.max(cc,cc+ta),0),ta=Vf.a.Ri(Math.max(Mb,Mb+xb),0)):(aa=Vf.a.Ri(Math.max(Mb,Mb+xb),0),ta=Vf.a.Ri(Math.max(cc,cc+ta),0));y=Vf.a.Ri(y.Oo,0);R=Vf.a.Y$(R,0,!1);Ya.isParagraphValid=R<y-aa-ta;return 32};this.ga=b;this.Fxa=k;this.IJ=r}get Rd(){return null!=this.ftg?
this.ftg:this.ftg=Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lYc(){return null!=this.Uqg?this.Uqg:this.Uqg=Va.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}Vb(){const b=Ka.App.a4a.Bxd(k=>Xt.OutlineElementGeneralizer.qla(k.ib,!0),!0);this.ga.pa(Jc.a.lIb,lc.a.view,b);this.ga.gb(Jc.a.lIb,lc.a.paragraph,this.lIb,96);this.ga.pa(Jc.a.q2a,lc.a.view,b);this.ga.gb(Jc.a.q2a,lc.a.paragraph,this.q2a,96);this.ga.pa(Jc.a.UIb,lc.a.view,b);this.ga.gb(Jc.a.UIb,
lc.a.paragraph,this.UIb,96);this.ga.pa(Jc.a.h_c,lc.a.view,b);this.ga.gb(Jc.a.h_c,lc.a.paragraph,this.h_c,96);this.ga.pa(Jc.a.$9b,lc.a.view,b);this.ga.gb(Jc.a.$9b,lc.a.paragraph,this.$9b,96);this.ga.pa(Jc.a.HMb,lc.a.view,b);this.ga.gb(Jc.a.HMb,lc.a.paragraph,this.HMb,96);this.ga.pa(Jc.a.R$f,lc.a.view,b);this.ga.gb(Jc.a.R$f,lc.a.paragraph,this.Rjm,96);this.ga.pa(Jc.a.Yec,lc.a.view,this.Q5i);this.ga.pa(Jc.a.E$h,lc.a.view,this.Q5i)}}Object(m.a)(gJ,"CustomTabActor",null,[]);var XL=c(129),XE=c(637);class hJ{constructor(b,
k,r,y,R,aa,ta,Ya,xb){this.ga=b;this.tpd=r;this.pGa=(this.fVb=R)&&y;this.Go=aa;this.BV=ta;this.kCj=Ya;this.Kw=xb;this.Fxj=k;this.fVb&&ni.a("isSharedUXDarkModeOn")?(this.Go.yL=appChrome.api.isSharedUXDarkModeOn(),this.Uoi(!0)):this.Go.yL=!1;this.pGa?this.Dni(!0):this.Go.O3a=!1;n.AFrameworkApplication.FK(()=>{this.pTc()});this.pGa&&ni.a("dispatch")&&appChrome.api.dispatch(this.faj([]))}Vb(){this.pGa&&(this.ga.pa(Jc.a.qbo,lc.a.view,this.URk.bind(this)),this.ga.pa(Jc.a.h0c,lc.a.view,this.h0c.bind(this)),
this.ga.gb(Jc.a.BWc,lc.a.view,this.BWc.bind(this),96));this.fVb&&(this.ga.pa(Jc.a.e8d,lc.a.view,this.e8d.bind(this)),this.ga.gb(Jc.a.h2d,lc.a.view,this.h2d.bind(this),96))}a$l(b){if(!this.ZVn(b))return!1;const k=Qn.a.instance.Rc(2);try{k.Eb(b.root);const r=Wd.GraphIterator.Za(b.root.graphNode),y=Xj.a.$p(r);for(;y.moveNext();){const R=Object(ia.a)(XL.a,y.currentNode);R&&R.fH(b.Sb,20,!0)}}finally{k&&k.dispose()}return!0}ZVn(b){return b&&b.root&&b.Sr?b.yi||b.yrf||b.rei||b.Dj:!1}ryn(){let b=!1;this.tpd.forEach(k=>
{this.a$l(k)&&(b=!0)});return b}rbo(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Go.yL?"dark":"light");return this.Go.yL?XE.a.myc(1):XE.a.KOi(1)}w6f(){const b=this.Go.Oda;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.ryn()||(b?!XE.a.myc(0):!XE.a.KOi(0)))return!1;this.kCj.Zgn(b);return!0}faj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Go.yL));
b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.q0h(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Go.O3a?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(k){v.ULS.sendTraceTag(527282835,3023,10,k)}return b}URk(){return this.w6f()?
32:8}e8d(b,k,r){if(1===r)return 32;b=this.BV.jg("UserAction","sharedUXDarkModeToggle");if(ni.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),ni.a("isSharedUXDarkModeOn")?this.Go.yL=appChrome.api.isSharedUXDarkModeOn():this.Go.yL=!this.Go.yL,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Go.yL);else return 8;appChrome.getHeaderApi().then(y=>{y.hasOwnProperty("refreshThemeOverride")&&
y.refreshThemeOverride()});this.rbo()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.pGa&&!this.Go.O3a&&(this.w6f()||v.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));k={};k.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Ka.App.xa.nG(k);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Go.yL));this.pGa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Go.yL));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.ri);return 32}h0c(b,k,r){if(1===r)return 32;b=this.BV.jg("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Go.O3a=!this.Go.O3a;if(!this.w6f())return 8;k={};k.DarkModeSwitchBackground=this.Kw?"ButtonModel":"ToggleButtonModel";Ka.App.xa.nG(k);b.stop();v.ULS.sendTraceTag(555885378,3023,50,"{0}",b.ri);v.ULS.sendTraceTag(529388309,
3023,50,"User in new canvasMode: {0}",this.Go.O3a);return 32}h2d(b,k,r,y,R){if(1===r)return 32;if(!R)return 2;ni.a("isSharedUXDarkModeOn")&&(this.Go.yL=appChrome.api.isSharedUXDarkModeOn());R&&(R[Ig.a.On]=this.Go.yL);return 32}BWc(b,k,r,y,R){if(1===r)return 32;if(!R)return 2;!this.Kw&&R&&(R[Ig.a.On]=this.Go.O3a);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Go.yL));this.pGa&&this.faj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",
this.q0h(!1)));appChrome.api.dispatch(b);return 32}q0h(b){const k={};this.Go.O3a?b?k["default"]="MoonMonochromatic_16":(k["default"]="MoonMonochromatic_20",k.icon32="MoonMonochromatic_32"):b?k["default"]="SunMonochromatic_16":(k["default"]="SunMonochromatic_20",k.icon32="SunMonochromatic_32");return k}pTc(){this.fVb&&this.Uoi(!1);this.pGa&&this.Dni(!1)}Uoi(b){var k;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.Go.yL?"dark":"light",this.Go.CAa);
b&&this.Go.yL!=(null===(k=this.Fxj)||void 0===k?void 0:k.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Go.yL?"dark":"light",this.Go.CAa)}Dni(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Go.Oda?"dark":"light",this.Go.TRk)}}Object(m.a)(hJ,"DarkModeActor",null,[]);var iJ=c(1531);class YE{constructor(){this.Height=this.Width=
0}static construct(b,k){const r=new YE;r.Width=b;r.Height=k;return r}}Object(m.a)(YE,"ViewportInfo",null,[]);class WF extends mp.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Tl(){return 85}static construct(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){const jc=new WF;jc.ContractVersion=b;jc.DocumentContent=k;jc.EnhancementId=r;jc.World=
y;jc.ScalingFactor=R;jc.DesktopViewportInfo=YE.construct(aa,ta);jc.MobileViewportInfo=YE.construct(Ya,xb);jc.MinParagraphCount=Mb;jc.ContentCulture=cc;return jc}}Object(m.a)(WF,"SwayPreviewRequest",mp.a,[]);var YL=c(599);class XC{static get vg(){return yf.a.Rx(XC.tl,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,XC.yDn,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}
XC.yDn=Qk.a.Sh("progress.gif");XC.tl="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(XC,"DigitalPrintDialogHtml",null,[]);class lv{constructor(b,k,r,y){this.fontFamily=b;this.PYc=k;this.fontWeight=r;this.fontStyle=y}}Object(m.a)(lv,"FontInfo",null,[]);class Nr{constructor(b,k,r,y){this.styleName=b;this.title=k;this.Lao=r;this.vZl=y}}Object(m.a)(Nr,"StyleVisualInfo",null,[]);class eC extends yf.a{constructor(b,k,r,y,R=!0){super();this.R4=this.$n=this.Oia=this.c1=this.Sbd=this.r3g=this.ond=this.tJe=this.uJe=this.LIe=this.CVb=this.YIa=this.r1=this.TUb=null;this.lMe=this.LEe=
!1;this.Kad=null;this.g0k=()=>{this.nWi(0)};this.f0k=(aa,ta)=>{this.nWi(ta)};this.gCi=aa=>{this.xUh(aa)===Sys.UI.Key.enter&&(this.aJf(aa),aa.preventDefault(),aa.stopPropagation())};this.Kyi=aa=>{((aa=aa.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===aa.id||aa.id===ej.a.t6c)||X.a.Ak)&&this.YIa&&this.hKb(this.YIa)};this.Lyi=aa=>{const ta=this.xUh(aa);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.wWl(ta)||(aa.preventDefault(),
aa.stopPropagation(),this.RUm(ta))};this.fHf=()=>{this.lMe||(this.lMe=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Af.a.removeHandler(this.r1,Kb.a.scroll,this.fHf))};this.NHf=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.aJf=aa=>{aa.preventDefault();aa.stopPropagation();n.AFrameworkApplication.ya.processAction(Wa.a.kBh,2);aa.target?(aa="button"===aa.target.tagName.toLowerCase()?aa.target:aa.target.parentNode)&&aa.id!==this.TUb&&(v.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.TUb,aa.id),this.Cmh(aa),this.pwh()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.RXk=aa=>{const ta=(new Date).getTime()-this.HCg;ld.a.instance.Xf(df.a.TXk,ta);aa?this.dIn():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),n.AFrameworkApplication.ya.processAction(Wa.a.jBh,2))};
this.bIn=()=>{this.f0n();try{const aa=eC.BCh.Z7k(),ta=WF.construct(2,aa,this.TUb,"VerticalWorld",.3,1366,600,330,280,20,eC.BCh.oPb.name);n.AFrameworkApplication.af.Mj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Ka.App.webServiceBase,n.AFrameworkApplication.rootQuerySignature),2,YL.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.can,this.HHi,ta)}catch(aa){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",aa.message)}};
this.can=aa=>{var ta=null;({group:ta}=vi.a.g8(aa.data.Ie)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.XTd(aa.data,df.a.w7n),this.cbb(),this.d1i(this.tJe,ta.PreviewHtml),this.d1i(this.ond,ta.PreviewHtmlMobile)):this.HHi(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.HHi=()=>{this.g0n();this.uJe.style.background="#E6E6E6";this.r3g.style.background="#E6E6E6"};this.vg=XC.vg;this.lg="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.bTj=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.XPb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.oYj=r;this.Hnc=y;this.We(1,this.bTj);this.Vh(this.XPb,this.RXk,null);this.S4l();this.k6n();this.HCg=(new Date).getTime();R&&Ug.a.XP(14,!1,this.g0k,this.f0k,null);this.a6l();this.w3l();this.Zum();this.yxf();this.Pum();this.pwh()}get hta(){return this.Kad}nWi(b){if(!this.LEe){const k=
(new Date).getTime()-this.HCg;ld.a.instance.Xf(df.a.SXk,k);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",qh.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.eWa.disabled=!1}}S4l(){this.CVb=document.getElementById("digitalPrintStatusMessageDiv");this.LIe=document.getElementById("digitalPrintStatusMessageIconDiv");this.uJe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.tJe=document.getElementById("swayDesktopPreviewHtmlHolder");this.ond=document.getElementById("swayMobilePreviewHtmlHolder");this.r3g=document.getElementById("swayMobilePreviewWrapperDiv");this.r1=document.getElementById("swayGallery");this.r1.setAttribute("tabindex","0");Af.a.addHandler(this.r1,Kb.a.scroll,this.fHf);this.r1.setAttribute(Ef.a.Bh,Ef.a.ofh);this.c1=document.getElementById("digitalPrintLearnMoreLink");this.c1.href="https://go.microsoft.com/fwlink/?linkid=871972";Af.a.addHandler(this.c1,
Kb.a.click,this.NHf);this.Oia=new rb.a;this.Sbd=document.getElementById("homeWrapper");this.J3("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Hnc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}a6l(){this.$n=new rb.a;this.$n.add(new Nr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.$n.add(new Nr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.$n.add(new Nr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.$n.add(new Nr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.$n.add(new Nr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.$n.add(new Nr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.$n.add(new Nr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.$n.add(new Nr("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.$n.add(new Nr("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.$n.add(new Nr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.$n.add(new Nr("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.$n.add(new Nr("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.$n.add(new Nr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.$n.add(new Nr("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.$n.add(new Nr("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.$n.add(new Nr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.$n.add(new Nr("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.$n.add(new Nr("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.$n.add(new Nr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.$n.add(new Nr("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.$n.add(new Nr("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.$n.add(new Nr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}w3l(){this.R4=
new rb.a;this.R4.add(new lv("universc","universc","normal","normal"));this.R4.add(new lv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.R4.add(new lv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.R4.add(new lv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.R4.add(new lv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.R4.add(new lv("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.R4.add(new lv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.R4.add(new lv("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.R4.add(new lv("ArialNova","ArialNova","normal","normal"));this.R4.add(new lv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.R4.add(new lv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.R4.add(new lv("RockwellNova","RockwellNova","normal","normal"));
this.R4.add(new lv("SabonNRegLT","SabonNRegLT","normal","normal"));this.R4.add(new lv("DaytonaThin","DaytonaThin","100","normal"))}Zum(){const b=document.createElement("style");b.setAttribute("type","text/css");let k="";for(let r of this.R4)k+=String.format(this.oYj,r.fontFamily,r.PYc,r.fontWeight,r.fontStyle);b.innerText=k;this.Sbd.appendChild(b)}Pum(){const b=document.createElement("style");b.setAttribute("type","text/css");const k=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Qk.a.Sh("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Qk.a.Sh("SwayPreviewFrameHC.svg"));b.innerText=k+r;X.a.yp&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Sbd.appendChild(b)}xUh(b){return b?b.keyCode:window.event.keyCode}hide(){this.jSf();super.hide()}jSf(){if(this.r1&&!this.LEe){for(let b=0;b<this.Oia.count;b++)Af.a.removeHandler(this.Oia.J(b),
Kb.a.click,this.aJf),Af.a.removeHandler(this.Oia.J(b),Kb.a.ni,this.gCi);Af.a.removeHandler(this.r1,Kb.a.ni,this.Lyi);Af.a.removeHandler(this.r1,Kb.a.focus,this.Kyi);Af.a.removeHandler(this.c1,Kb.a.click,this.NHf);this.lMe||Af.a.removeHandler(this.r1,Kb.a.scroll,this.fHf);this.LEe=!0}}yxf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Qk.a.ylk());this.Sbd.appendChild(b);for(let k of this.$n)this.DMk(this.r1,k);this.xU(this.r1);
this.Cmh(this.r1.firstChild);this.r1.firstChild.focus();Af.a.addHandler(this.r1,Kb.a.ni,this.Lyi);Af.a.addHandler(this.r1,Kb.a.focus,this.Kyi)}DMk(b,k){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(Ef.a.pab,Ef.a.rL);r.setAttribute("title",k.title);r.setAttribute(Ef.a.Bh,Ef.a.rfh);r.id=k.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",k.styleName);
b.src=Qk.a.Sh("swayPublish.png");b.setAttribute(Ef.a.Bh,Ef.a.Gz);b.setAttribute("unselectable","on");b.setAttribute(Ef.a.Fz,Ef.a.Jo);b.id=k.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=k.title;b.className=k.Lao;b.setAttribute(Ef.a.Fz,Ef.a.Jo);b.setAttribute("unselectable","on");b.setAttribute(Ef.a.Bh,Ef.a.Gz);r.appendChild(b);const y=document.createElement("label");y.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;y.className=k.vZl;y.setAttribute(Ef.a.Fz,
Ef.a.Jo);b.setAttribute("unselectable","on");y.setAttribute(Ef.a.Bh,Ef.a.Gz);r.appendChild(y);Af.a.addHandler(r,Kb.a.click,this.aJf);Af.a.addHandler(r,Kb.a.ni,this.gCi);this.Oia.add(r)}RUm(b){const k=this.hta;this.Xdl(b,k,!n.AFrameworkApplication.isRtl)||this.Zdl(b,k,!n.AFrameworkApplication.isRtl)||this.Udl(b,k)||this.Vdl(b,k)}wWl(b){return b===Sys.UI.Key.tab?(this.hta&&this.hta!==this.YIa&&(this.hta.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Kad=this.YIa),!0):!1}Xdl(b,
k,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=k.nextSibling)||this.r1.firstChild,this.hKb(b),!0):!1}Zdl(b,k,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=k.previousSibling)||this.r1.lastChild,this.hKb(b),!0):!1}Udl(b,k){return b===Sys.UI.Key.down?(b=this.Oia.indexOf(k),k=b+2,k<this.Oia.count?(b=this.Oia.J(k))&&this.hKb(b):(k=b%2+1,k=2<=k?0:k,(b=this.Oia.J(k))&&this.hKb(b)),!0):!1}Vdl(b,k){b===Sys.UI.Key.up&&(b=this.Oia.indexOf(k),k=b-2,0<=k?(b=this.Oia.J(k))&&
this.hKb(b):(k=b?20+b-1:this.Oia.count-1,(b=this.Oia.J(k))&&this.hKb(b)))}hKb(b){this.hta&&this.hta.id!==this.YIa.id&&(this.hta.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Kad=b;this.hta.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.hta.focus()}k6n(){this.eWa.className="WACDialogButtonNormal swayPrintToWebButton";this.eWa.setAttribute("tabindex","0");this.mz.className="WACDialogButtonNormal swayCancelButton";
this.mz.setAttribute("tabindex","0");this.eWa.disabled=!0}Cmh(b){this.hta&&(this.hta.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.YIa&&(this.YIa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.YIa.setAttribute(Ef.a.pab,Ef.a.rL));this.TUb=b.id;this.YIa=b;this.YIa.setAttribute(Ef.a.pab,Ef.a.Jo);this.Kad=b;this.hta.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}pwh(){Mg.a.instance.fc(new nd.a(2,
1,50,this.bIn))}d1i(b,k){b.innerHTML=k}dIn(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.TUb));n.AFrameworkApplication.ya.processAction(Wa.a.lBh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Ka.App.webServiceBase,n.AFrameworkApplication.rootQuerySignature,n.AFrameworkApplication.userSessionId,this.TUb);Qe.a.openWindow(4,b)}XTd(b,k){ld.a.instance.Xf(k,+b.HS-+b.gH)}g0n(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.cbb();this.CVb.innerText=b;this.CVb.style.display="block"}f0n(){this.cbb();this.LIe.style.display="block";this.CVb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.CVb.style.display="block"}cbb(){this.uJe.style.background="";this.ond.style.background="";Fd.a.iZ(this.tJe);Fd.a.iZ(this.ond);this.CVb.style.display="none";this.LIe.style.display="none"}static get BCh(){return null!=eC.hjg?eC.hjg:eC.hjg=
Va.a.instance.Pa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(eC,"DigitalPrintDialog",yf.a,[]);class XF{constructor(b,k){this._context=this.Nk=null;this.nke=0;this.R7c=!1;this.o2g=null;this.digitalPrint=(r,y,R,aa,ta)=>{if(1===R)return n.AFrameworkApplication.kM?8:32;this.o2g=ta.SourceControlId;if(n.AFrameworkApplication.K.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=y;if(XF.rim())return v.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.f0e(),32;switch(this.nke){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.f0e();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.R7c=!1,this.Nk=(new Kn.a).create(),this.Nk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Nk.rM(CommonUIStrings.l_DefaultDialogTitle,this.ywk,null),n.AFrameworkApplication.af.Mj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Ka.App.webServiceBase,n.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.Awk,this.zwk,null)}return 32};this.ywk=()=>{this.R7c=!0;v.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.Awk=r=>{if(!this.R7c){this.Nk.close();var y=null;this.XTd(r.data,df.a.v7n);({group:y}=vi.a.g8(r.data.Ie)).returnValue?(r=y.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.nke=r.HasLicense?1:2,2===this.nke?this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.f0e()):this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.zwk=r=>{this.R7c||(this.Nk.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.XTd(r.data,df.a.u7n),this.efc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.F4=k}Vb(){n.AFrameworkApplication.protectFile?v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):n.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&n.AFrameworkApplication.K.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.gb(Wa.a.digitalPrintToSway,lc.a.view,this.digitalPrint,4),this.ga.gb(Wa.a.kBh,lc.a.view,Kd.ActionManager.uZ,4),this.ga.gb(Wa.a.lBh,
lc.a.view,Kd.ActionManager.uZ,4),this.ga.gb(Wa.a.jBh,lc.a.view,Kd.ActionManager.uZ,4),this.ga.gb(ib.a.Bzd,lc.a.view,Kd.ActionManager.uZ,4))}f0e(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.o2g);new eC(this._context,this.ga,n.AFrameworkApplication.K.lb("SwayFontDownloadUrlTemplate"),n.AFrameworkApplication.K.lb("FileSource"))}efc(b){const k=new cf.StandardDialog;k.Gd=0;k.fha(CommonUIStrings.l_DefaultDialogTitle,
b,null)}XTd(b,k){ld.a.instance.Xf(k,+b.HS-+b.gH)}static rim(){return"OneDriveWOPI"===n.AFrameworkApplication.K.lb("FileSource")}}Object(m.a)(XF,"DigitalPrintActor",null,[]);class jJ{constructor(){this.g5g=null}Toi(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}Mfj(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.hki(b.errorDetails))return!1;this.g5g=Object(ia.a)(pi.a,b.errorDetails).typeId;return!0}r8d(b){return this.hki(b)?
Object(ia.a)(pi.a,b).typeId===this.g5g:!1}hki(b){if(!b)return v.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(ia.a)(pi.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(jJ,"DoNotCheckThisCritiqueTypeStrategy",null,[335]);class kJ extends yf.a{constructor(b,k,r){super(!1,!1,!0);this.wc=b;this.gla=r;this.qDj="DocumentChoiceGroup";this.dEg="EmbededContent";
this.xJg="HyperLink";this.rxe=r.s6a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.zHc()};this.ezj=this.D7k.bind(this);this.We(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Vh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.ezj,b)}zHc(){const b=Array(2);b[0]={["key"]:this.dEg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.xJg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const k={};k.documentChoiceGroupProps={["id"]:this.qDj,["defaultSelectedKey"]:this.rxe?this.dEg:this.xJg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};k.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;k.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;k.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return k}D7k(b,k){1===b?(this.rxe!==k.isExternalContentSelected&&(b=k.isExternalContentSelected?Jc.a.jLa:Jc.a.Scb,this.wc.processAction(b,2),this.rxe=k.isExternalContentSelected,Y.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]}))),this.gla.ZDn(k.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)(kJ,"ExternalContentDefaultSettingsDialog",yf.a,[]);class Or{constructor(b,k,r,y,R){this.UK=Va.a.instance.resolve("Common.IReactContextualUILauncher");this.$nb=Ig.a.On;this.$ec=()=>{const aa=Array(1);aa.push("ExternalContent");var ta=Va.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").RLa();ta=Object.assign(new tE.a,{x:ta.x,y:ta.y});this.UK.showFloatie(ta,aa,1);return 32};this.iCb=()=>{this.UK.QZ&&this.UK.tw();return 32};this.BJi=(aa,ta,Ya,xb,Mb)=>{if(ta="object"===
typeof Mb?Mb:null)aa===Jc.a.gPf?(aa=Or.jTa!==Jc.a.jLa&&Or.jTa!==Jc.a.Scb,ta[this.$nb]=Or.jTa===Jc.a.jLa||aa):aa===Jc.a.hPf&&(ta[this.$nb]=Or.jTa===Jc.a.Scb);return 32};this.oHh=(aa,ta,Ya)=>{1!==Ya&&(aa===Jc.a.Scb&&Or.jTa!==Jc.a.Scb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.xm.undo()&&(ta=new Ru.a(1,n.AFrameworkApplication.isRtl),ta.YUc="ExternalContent",Or.Rcb.VWc(ta))):aa===Jc.a.jLa&&Or.jTa!==Jc.a.jLa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.WEg.jLi()),Or.jTa=aa);Y.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ca.a,{name:"behavior",string:Ya.toString()}),Object.assign(new ca.a,{name:"ActionId",int64:aa})]}));return 32};this.ga=b;this.xm=k;this.WEg=y;this.EJj=R;this.dzj=this.E7k.bind(this);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.WEg.fNi(()=>{this.reset()})}Vb(){this.ga.gb(Jc.a.gPf,lc.a.view,this.BJi,97);this.ga.gb(Jc.a.hPf,lc.a.view,this.BJi,97);this.ga.gb(Jc.a.nHh,lc.a.view,this.dzj,1028);this.ga.gb(Jc.a.jLa,lc.a.view,this.oHh,1028);this.ga.gb(Jc.a.Scb,lc.a.view,this.oHh,1028);this.EJj||(this.ga.gb(Jc.a.$ec,lc.a.view,this.$ec,96),this.ga.gb(Jc.a.iCb,lc.a.view,this.iCb,96))}BZn(b){new kJ(this.ga,b,Or.gla)}E7k(b,k,r){1!==r&&this.BZn(Or.jTa);return 32}static get Rcb(){return null!=Or.Ajg?Or.Ajg:Or.Ajg=Va.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get gla(){Or.Sxa||
(Or.Sxa=Va.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Or.Sxa}reset(){Or.jTa=null!=Or.gla?Or.gla.s6a?Jc.a.jLa:Jc.a.Scb:Jc.a.jLa}}Or.jTa=Jc.a.jLa;Or.Sxa=null;Object(m.a)(Or,"ExternalContentActor",null,[]);class fC extends Tw{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc){super(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc);this.bNc=Mc;this.HBd=!1;this.KKg=null}sXc(){this.HBd||(super.sXc(),this.HBd=!0)}Ice(){this.HBd&&(super.Ice(),fC.JDh&&this.KKg&&fC.JDh.removeHandler(fe.a.xza,
this.KKg),this.HBd=!1)}IMb(){if(this.bNc){this.qsa.QZ&&this.qsa.tw();const b=new Ru.a(0,n.AFrameworkApplication.isRtl);b.location=this.I1a.RLa();this.showFloatie(null,b)}else this.qsa.QZ&&n.AFrameworkApplication.ya.processAction(Jc.a.iCb,2),n.AFrameworkApplication.ya.processAction(Jc.a.$ec,2);this.j8b=!1}tw(b){!this.Zue&&(b&&(this.I1a.$of(),this.Ngj()),this.qsa.QZ||this.PHa)&&(this.PHa=!b,this.Ice(),this.bNc?this.qsa.tw():n.AFrameworkApplication.ya.processAction(Jc.a.iCb,2))}showFloatie(b,k){k||(k=
new Ru.a(0,n.AFrameworkApplication.isRtl));k.location||(k.location=this.I1a.RLa());if(!k.location)return!1;this.PHa&&(this.PHa=!1,this.sXc());this.bNc?(b=Array(1),b.push("ExternalContent"),this.qsa.showFloatie(this.I1a.RLa(),b,1)):n.AFrameworkApplication.ya.processAction(Jc.a.$ec,2);return!0}BDc(){if(!this.j8b){const b=new nd.a(3,1,this.myh,()=>{this.IMb()},196);Mg.a.instance.fc(b);this.j8b=!0}}Jga(){this.bNc?this.qsa.QZ&&this.qsa.tw():n.AFrameworkApplication.ya.processAction(Jc.a.iCb,2);this.BDc()}KJb(){this.bNc?
this.qsa.QZ&&this.qsa.tw():n.AFrameworkApplication.ya.processAction(Jc.a.iCb,2);this.BDc()}static get JDh(){return null!=fC.mjg?fC.mjg:fC.mjg=Va.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(fC,"ExternalContentFloatieEventManager",Tw,[]);class gC extends xi{constructor(b,k,r,y,R){super(b,k,r,y,R)}skh(){if(!this.hb||!this.hb.ib||!this.hb.ib.kb)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.hb.ib.kb.Qa,
k=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&k&&!r.HI){do r=this.qYh(r);while(r&&!r.HI&&Object(Jb.a)(xn.AParagraphNode,r)&&!r.characterData.trim().length)}let y="";const R=Object(ia.a)(xn.AParagraphNode,r);R&&(y=R.characterData.length===b.cpBegin||k?R.characterData.trimEnd():R.characterData.substring(0,b.cpBegin).trimEnd());k=R?y.length:b.cpBegin;b=Object.assign(new uk,{vva:Object(ia.a)(57,(R?Object(ia.a)(57,R):Object(ia.a)(57,r))||b.node),Yac:k});return this.Eef(b)}xTh(b,k){let r=null;const y=Object(ia.a)(154,
b.vva.Ii(k.Sb));if(!y)return null;if(Object(Jb.a)(xn.AParagraphNode,b.vva)){const R=Object(ia.a)(xn.AParagraphNode,b.vva);if(R.EP){if(b=Object(ia.a)(Ex.a,ie.ParagraphReader.ULa(R)))(b=Object(ia.a)(154,b.Ii(k.Sb)))&&(r=b.getBounds()),r&&(r.height+=gC.oKh,r.width-=gC.rdl);return r}k=Object(ia.a)(53,y);if(!k)return null;try{if(r=this.ira.eZ(b.Yac,k,0<b.Yac,!1,!1,!1))r.height+=gC.oKh}catch(aa){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
aa),r=null}}r||(r=y.getBounds());return r}}gC.oKh=65;gC.rdl=100;Object(m.a)(gC,"ExternalContentFloatiePositionProvider",xi,[]);class lJ{constructor(b,k,r,y,R,aa){this.uUf=(ta,Ya,xb)=>{if(1===xb)return n.AFrameworkApplication.protectFile||n.AFrameworkApplication.kM||n.AFrameworkApplication.Ama||Ae.SessionStatusManager.instance.Tj?8:32;if(ta===Wa.a.print)ta=1;else if(ta===Jc.a.KEc)ta=0;else if(ta===Jc.a.kAd)ta=2;else return 8;return this.JDn(ta)};this.ga=b;this.F4=k;this.KQb=r;this.cDj=y;this.VCg=R;
this.uzj=aa}Vb(){n.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.cDj||n.AFrameworkApplication.kM?(document.body.classList.add("WACStopPrinting"),""!==this.VCg&&this.uzj.a_n(this.VCg)):(this.ga.pa(Wa.a.print,lc.a.application,this.uUf),this.ga.pa(Jc.a.KEc,lc.a.application,this.uUf),this.ga.pa(Jc.a.kAd,lc.a.application,this.uUf))}JDn(b){const k=n.AFrameworkApplication.rootQuerySignature;if(!k||""===k||Ka.App.vd&&Ka.App.vd.cB.Bo)return 8;this.KQb.cOd=!1;this.KQb.Qmj.start();Ug.a.XP(5,!0,
Object(u.a)(this.KQb,this.KQb.Vxn,"requestFileDownload"),Object(u.a)(this.KQb,this.KQb.TGb,"onForceSaveFailed"),b);return 32}}Object(m.a)(lJ,"FileDownloadActor",null,[]);class mJ extends uj{constructor(b,k=null){super(b,!0,k,!1)}get ymf(){return null}get T0a(){return n.AFrameworkApplication.rXa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get d9b(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get xrd(){return null}}
Object(m.a)(mJ,"DownloadAsPdfDialog",uj,[]);class lu{constructor(){this._url=this.Ru=null;this.vUa=this.uUa=0;this.G$a=!1;this.makeRequest=()=>{n.AFrameworkApplication.af.Mj(this._url,1,null,null,!0,2,this.bHb,this.pna,null)};this.bHb=b=>{lu.IYc();const k=b.data.Kga;let r=null;if(k)try{r=k.selectSingleNode("/docdata/status")}catch(y){}r&&("InProgress"===r.text&&22>this.uUa++||"ServiceBusy"===r.text&&3>this.vUa++)?this.oEa(1E3*(this.uUa+this.vUa)):this.Ru(!0,r?r.text:null,b.data)};this.pna=b=>{this.G$a?
(lu.Lya||(lu.p8a=new Date,lu.Lya=!0,lu.iS=1),18E4>(new Date).getTime()-lu.p8a.getTime()?this.retryOnFailure(4<=lu.iS?2E4:1E3):this.jZa(b.data)):4>lu.iS?this.retryOnFailure(2E3):this.jZa(b.data)}}send(b,k,r){this._url=b;this.Ru=k;this.G$a=r;this.makeRequest(null)}oEa(b){b=new nd.a(2,1,b,this.makeRequest);n.AFrameworkApplication.uc.fc(b)}retryOnFailure(b){this.oEa(b);lu.iS++}jZa(b){this.Ru(!1,null,b)}static t$(b,k){(new lu).send(b,k,!1)}static IYc(){lu.Lya=!1;lu.iS=0}}lu.p8a=null;lu.Lya=!1;lu.iS=0;
Object(m.a)(lu,"ClientRequestWithRetry",null,[]);class nJ extends Tc{constructor(b){super(b,void 0,n.AFrameworkApplication.rXa)}get T0a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get d9b(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get WQc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get lDc(){return n.AFrameworkApplication.rXa?"UIFontDialogTextLarge":null}Rxf(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}Sxf(){v.ULS.sendTraceTag(7628379,
324,50,"ODT download dialog link clicked")}lRc(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get FQc(){return uF.pwi}get nhb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get ysi(){return!n.AFrameworkApplication.rXa}}Object(m.a)(nJ,"DownloadAsOdtDialog",Tc,[]);class oJ{constructor(b,k){this.n7a=this.pVa=null;this.v3a=r=>{1===Ka.App.xa.state||this.pVa||(this.pVa=(new Kn.a).create(),r=r.customData,this.eym(r),1===r?this.pVa.message=this.dpb.OP.isEnabled?
n.AFrameworkApplication.rXa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:r?2===r&&(this.pVa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.pVa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.pVa.rM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.cOd=!0};this.l7=(r,y,R)=>{this.n3f("Success. Save and Conversion Complete.");R=new pa.QueryStringBuilder(R.request.get_url());
n.AFrameworkApplication.Ija(R);R=R.toString();const aa=this.kyn(R);this.Ska(aa);2!==aa&&this.dpb.Lan();!r||y?this.N3(aa):this.cOd?(this.cOd=!1,this.n7a=null):(this.n7a&&n.AFrameworkApplication.uc.Ye(this.n7a),this.n7a=null,this.sZk(R,aa))};this.cOd=!1;this.dpb=b;this.Qmj=k.UNa("UserAction","WordEditorForceSaveAndPrint")}Ska(b){this.pVa&&(this.rym(b),this.pVa.close(),this.pVa=null)}N3(b){if(1!==Ka.App.xa.state){this.qzm(b);const k=new cf.StandardDialog;k.Gd=0;k.We(1,CommonUIStrings.l_DialogClose);
k.my(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}kIl(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}Vxn(b){var k=n.AFrameworkApplication.rootQuerySignature;k&&""!==k?(k="WordViewer/request."+this.y7k(b)+"?"+k+"&type="+this.kIl(b)+"&rndm="+Ra.a.create(),1===b&&this.dpb.wYn()&&(k+="&useNamedAction=1"),
n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&Oo.FontUtils.i8d()&&(1===b||!b)&&(0<Oo.FontUtils.Zxh&&(k+="&cfcVer="+Oo.FontUtils.Zxh),Oo.FontUtils.Yxh&&(k+="&cfcUrl="+Oo.FontUtils.Yxh),Oo.FontUtils.$xh&&(k+="&cfcEncData="+Oo.FontUtils.$xh)),lu.t$(k,this.l7),this.n7a||(this.n7a=new nd.a(2,1,500,this.v3a),this.n7a.customData=b,n.AFrameworkApplication.uc.fc(this.n7a))):(this.n3f("failed. QuerySignature is empty."),this.N3(b))}y7k(b){return 2===b?"odt":"pdf"}TGb(){this.n3f("Failed. force save failed.")}kyn(b){if(0<
b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}n3f(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.Qmj.stop()}sZk(b,k){const r=new rb.a;r.add("access_token");r.add("access_token_ttl");1!==Ka.App.xa.state&&(1===k?this.dpb.K_n(b,r):k?2===k&&new nJ(b):new mJ(b))}dispose(){}eym(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,
203,50,"Download Attempt: Pdf");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}rym(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");
break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}qzm(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(oJ,"FileDownloadManager",null,[]);class hC{get key(){return"LIST"}get qw(){return Box4Intl.Box4Strings.l_ListContentTitle}lhc(b){let k=
null;const r=hC.hd.Gs(b);if(!r)return{returnValue:!1,uka:k};b=this.tzl(b,r);k=Object.assign(new Xv.a,{YF:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,uka:k}}xAb(b,k){b=b.contentObject;const r=this.fyl(b.Cw),y=new Ge.a;k?(k=k.contentObject,k.level!==b.level?(y.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),y.add(r)):k.id.equals(b.id)&&k.Cw.listType===b.Cw.listType||y.add(r)):(y.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),y.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),y.add(r));return y.toArray().join(" ")}fyl(b){let k="";const r=b.listStyle;if(!b.listType)k=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.jq);else if(1===b.listType)switch(r){case 1:k=this.ljh;break;case 2:k=this.spk;break;case 3:k=this.tpk;break;default:k=this.ljh}return k}static get hd(){return null!=hC.Sog?hC.Sog:hC.Sog=Va.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(hC,"ListDetailsProvider",null,[718,299]);class pJ{constructor(){this.Cw=this.listId=
this.id=null;this.level=0}}Object(m.a)(pJ,"ListItemInfo",null,[]);class qJ extends hC{constructor(b){super();this.O4=b}get ljh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get spk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get tpk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}tzl(b,k){const r=this.O4.Uw(b);return Object.assign(new pJ,{id:b.currentNode.id,listId:new G.a(Ra.a.nil,r.listID),Cw:k,level:r.level+1})}}Object(m.a)(qJ,"FlatListDetailsProvider",hC,[]);class rJ{constructor(b,k){this.ga=
b;this.Cf=k}get oc(){return null!=this.mug?this.mug:this.mug=Va.a.instance.Pa("Box4.Styles.IWACStyleReader")}Vb(){}}Object(m.a)(rJ,"FormattingActor",null,[]);var ZL=c(1144),YC=c(1266),$L=c(1627);class sJ{constructor(b,k,r,y,R,aa,ta,Ya){this.Gb=b;this.GVj=k;this.Hc=r;this.hqb=y;this.sm=R;this.Oa=aa;this.Ic=ta;this.FKj=Ya}t1a(b,k,r,y,R,aa,ta){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.ri});this.hqb.then(()=>
{this.GVj(b.data.Ie);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.ri});ta.stop()})}pna(b,k,r,y,R,aa,ta){aa.stop();R();ta?(this.K6m(k,r),v.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:Pd.ImageReader.aeb(k.Gb)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Pd.ImageReader.aeb(k.Gb)})}gdh(b,k){b.Ke(QE.a.f_e,"1");if(this.Ic&&this.Ic.isFeatureEnabled(48)){var r=
this.sm.Sm(k.rk);r=this.sm.ul(r);b.Ke(Og.a.Gq,YC.a[r]);5===r&&this.Bdk(b,k)}this.FKj&&b.Ke(Og.a.dMd,"true")}V7g(){return new $L.a(this.Gb.id,this.Gb)}WHd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}K6m(b,k){const r=this.Hc.Rc(7,Wa.a.WSl);r.Eb(k);b.Gb.setValue(wc.a.ash,!0);r.dispose()}Bdk(b,k){var r=k.rk;k=this.sm.Sm(r);var y=r.node;const R=(r=this.sm.CBa(k,y.Mc,!1))?this.sm.uBa(r):"";if(""===R)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");y=(y=this.sm.CBa(k,y.Mc,!0))?this.sm.uBa(y):"";b.Ke(Og.a.Cac,R);b.Ke(Og.a.Umj,y);r=r.ia(Hk.a.pIh,"");""!==r&&b.Ke(Og.a.extension,r);b.Ke(Og.a.width,this.sm.mE(k).toString());b.Ke(Og.a.height,this.sm.AF(k).toString());b.Ke(Og.a.bVc,this.sm.seb(k).toString());r=this.Oa.$("WordEditorImageCropIsEnabled");b.Ke(Og.a.pxh,r.toString());r&&(b.Ke(Og.a.top,this.sm.Fla(k).toString()),b.Ke(Og.a.bottom,this.sm.Cla(k).toString()),b.Ke(Og.a.left,this.sm.Dla(k).toString()),
b.Ke(Og.a.right,this.sm.Ela(k).toString()));r=this.Oa.$("WordEditorImageRotateIsEnabled");b.Ke(Og.a.$Ui,r.toString());r&&(b.Ke(Og.a.angle,this.sm.AZ(k).toString()),b.Ke(Og.a.flipH,this.sm.a4(k,wc.a.RKc,!1)?"true":"false"),b.Ke(Og.a.flipV,this.sm.a4(k,wc.a.$Kc,!1)?"true":"false"));b.Ke(Og.a.oEh,"true")}}Object(m.a)(sJ,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[338]);class tJ{constructor(){this.sHa=null}Kjk(b){this.sHa=b}teardown(){null!=this.sHa&&(this.sHa.teardown(),this.sHa=null);this.JDe=
null}getGraphicData(){return this.sHa?this.sHa.getGraphicData():null}Jqn(){null!=this.JDe&&this.setGraphicData(this.JDe)}setGraphicData(b){this.JDe=b;if(this.sHa)try{this.sHa.setGraphicData(b)}catch(k){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",k.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.sHa?this.sHa.hasEdits():!1}}Object(m.a)(tJ,
"GraphicsEditorGC2HostUser",null,[340]);var aM=c(1628),bM=c(1332),cM=c(604),dM=c(1420),eM=c(1056);class uJ{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=k=>b.loadScript(k);this.preloadScript=k=>{b.preloadScript(k)}}}Object(m.a)(uJ,"GC2ScriptLoader",null,[]);class YF{constructor(b,k,r){this.Pke=b;this._context=k;this.NIa=r}closeEditor(){this.Pke&&(this.Pke(),this.Pke=null)}logActivity(b,k,r,y){Ib.a(b,k,r,y)}logTrace(b,k,r,y){v.ULS.sendTraceTag(575522531,3001,YF.SEm(k),y)}isEnabled(b){const k=
n.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return k.$("ModernFontPickerIsEnabled");
case "SnapToAspectRatio":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.SnapToAspectRatio",!1);case "SVG":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsUseSVG",!1);case "ShapeLocksSchema":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);case "RenderOnlyWhenViewDirty":return k.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsRenderOnlyWhenDirty",!1);default:return!1}}getFontPickerFonts(b){const k=`${Va.a.instance.resolve("Box4.IFontServiceParser").gYa}/${"hier_officeFontsPreview.ttf"}`;
b("msofp_hier",k);b=Oo.FontUtils.Zaf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getFonts(b){const k=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=k?"msofp_hier":"msofp",y=`${Va.a.instance.resolve("Box4.IFontServiceParser").gYa}/${k?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,y);Oo.FontUtils.C8g();Oo.FontUtils.c9g({});
b=Oo.FontUtils.Yaf(()=>!1,(R,aa)=>aa).MenuSectionList;k&&0<b.length&&(b.pop(),b.push(this.REk()));return b}REk(){const b=Oo.FontUtils.Zaf(()=>!1,()=>"").fonts.map((k,r)=>{const y=k.name;k=k.displayName;const R=Oo.FontUtils.Lma(y);return Object.assign(new QG.a,{MenuItemId:Oo.FontUtils.lXi+r,CommandValueId:y,LabelText:k||y,Styles:{["optionText"]:{["fontFamily"]:k&&!R?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:y})});return Object.assign(new oi.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const k=this._context.rk;var r=Pd.ImageReader.Sm(k);if(this.ugm(r,k,b)&&(r=Pd.ImageReader.a4(r,td.a.una,""),r.length))return Promise.resolve(r);r=new pa.QueryStringBuilder("/we/GetImage.ashx?");r.fXb(k.node.Di().Es);r.Ke(Og.a.Gyd,b);n.AFrameworkApplication.Ija(r);r.Ke(Ri.a.Wmb,"1");pk.a.instance.Bvb(r);r.Ke(Og.a.kyh,"true");const y=r.toString();return new Promise((R,aa)=>{this.NIa.Mj(y,1,null,null,!1,2,ta=>{R(ta.data.Ie)},ta=>{aa(ta.data.Df.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=Qk.a.Sh("progress.gif");b.PictureInvalid=Qk.a.Sh("CancelRequest.32x32x32.png");return b}getTheme(){const b=lk.PageNavigator.instance.pu(this._context.view.ld).properties.ia(wc.a.abe,"");return 0===b.length?[]:b.split(" ").map(k=>Ka.App.FZb[k])}static SEm(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}ugm(b,k,r){const y=k.node.Mc;k=Pd.ImageReader.fHd(b,y,!1);b=Pd.ImageReader.fHd(b,
y,!0);return r===k||r===b}}Object(m.a)(YF,"GraphicsEditorApp",null,[343]);class vJ extends yf.a{constructor(b,k,r,y,R){super(!1,!1,!0);this.closeEditor=()=>{this.wsh();this.dispose()};this.p$=aa=>{this.wsh(2===aa)};this.E7a=b;this.uHj=k;this.OJg=r;this._context=y;this.NIa=R}SZn(){return new Promise((b,k)=>{this.Vh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.p$,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(r,y)=>this.Ukk(y),["onload"]:r=>{this.onLoad(r,b,k)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.E7a.Jqn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,k,r){b?(this.E7a.Kjk(b),k(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}Ukk(b){const k=n.AFrameworkApplication.K;var r=eM.a();r.loadScriptWithRetryHandler=b;const y=new YF(this.closeEditor,this._context,this.NIa),R={["bootConfig"]:Object.assign(new bM.a,
{scriptBaseUrl:RC.AppChromeOverrideUtilities.isEnabled?RC.AppChromeOverrideUtilities.TGd(n.AFrameworkApplication.lcid):n.AFrameworkApplication.Q3+n.AFrameworkApplication.lcid+"/",isMLRRibbonMode:n.AFrameworkApplication.ta.Rb.Pec}),["scriptLoader"]:new uJ(new dynamicScriptLoader.DynamicScriptLoader(r)),["publicPath"]:n.AFrameworkApplication.Q3,["appSettings"]:k.appSettings,["logger"]:new il.a,["featureGateManager"]:Object.assign(new cM.a,{getBooleanFeatureGate:Object(u.a)(k,k.getBooleanFeatureGate,
"getBooleanFeatureGate"),getIntFeatureGate:Object(u.a)(k,k.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(u.a)(k,k.getStringFeatureGate,"getStringFeatureGate")}),["app"]:y,["resolveScript"]:(aa,ta)=>dM.a.resolveScript(aa,ta)};k.$("DynamicBundlesIsEnabled")&&(r=n.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||n.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",R.dynamicBundlesPath=RC.AppChromeOverrideUtilities.isEnabled?RC.AppChromeOverrideUtilities.zdc+
r:k.lb("StaticContentUrl")+r);return new Promise((aa,ta)=>{b("gc2",n.AFrameworkApplication.Dw("gc2.js",5),"anonymous",5,!1).then(()=>{aa(R)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");ta(null)})})}wsh(b){b=this.E7a.hasEdits()&&!b;this.uHj(b?this.E7a.getGraphicData():null,!!this.OJg,this.OJg,b)}}Object(m.a)(vJ,"ReactGraphicsEditorDialog",yf.a,[]);class wJ{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc,fd,Td=!1){this.hMh=Td;this.hqb=
this._context=null;this.TZn=(ne,ye,ff,Gd,oe)=>{const ze=!!oe&&Object(Jb.a)(G.a,oe);try{if(1===ff){const ug=ye.view;return this.tj.Nda(ye)&&ug.features.S$d?32:8}this.aLj=4===(null===oe||void 0===oe?void 0:oe.InputMethod)?!0:!1;Ka.App.instance&&Ka.App.instance.EDb&&(this.hMh||ZL.a.u1b(()=>{this.hMh=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${ze}`);performance.mark("LaunchStart");this._context=ye;this.hqb=(new vJ(this.E7a,this.rGf,ze?oe:null,ye,this.rg)).SZn().then(()=>
{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${ze}`)}).catch(()=>{this.OBh()});if(!ze){const ug=cn=>{this.hqb.then(()=>{this.vBi(cn,!1)})};if(n.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===n.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return ug(JSON.stringify({elements:[]})),32;let Yf=null;Yf=lk.PageNavigator.instance.pu(ye.view.ld);const Aj=Yf.properties.ia(wc.a.iMh,"");if(0<Aj.length)return ug(Aj),32;this.rre.FHn(ye,G.a.create(),
Ra.a.create()).then(cn=>{const Vl=this.Hc.Rc(0,Wa.a.vKc);Vl.Eb(Yf);Yf.setValue(wc.a.iMh,cn);Vl.dispose();ug(cn);return null}).catch(cn=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",cn.toString(),ze);this.OBh()})}return 32}catch(ug){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",ug.toString(),ze),8}};this.wUl=(ne,ye,ff,Gd,oe)=>{if(!ye.view.features.S$d)return 32;
v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.FDh(oe,ye);return 32};this.xUl=(ne,ye,ff)=>{if(1===ff)return ye.view.features.S$d?32:8;if(2===ff){ne=Pd.ImageReader.Sm(ye.rk);if(!ne)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.FDh(ne,ye);return 32}return 2};this.vBi=(ne,ye=!0)=>{this.E7a.setGraphicData(ne);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");ne=performance.getEntriesByName("EditorLaunch");
v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${ye} Duration: ${ne[ne.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.rGf=(ne,ye,ff,Gd)=>{var oe;this.E7a.teardown();if(ye&&this._context){var ze=this._context.view.Cb.Jg,ug=ze.node;ze.Xk&&ie.ParagraphReader.nc(ug)&&(ze=null===(oe=this.iP)||void 0===oe?void 0:oe.BA(ug),27==(null===ze||void 0===
ze?void 0:ze.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Gd,Gd?" Everything deleted: "+(0==(null===ne||void 0===ne?void 0:ne.json.length)):""))}if(Gd)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(ne)if(Gd=ne.json,oe=ne.width,ug=ne.height,Gd.length||ye)if(!Gd.length&&ye)if(ye=this._context.rk){ye=ye.node;if(Pd.ImageReader.G6(ye)){if(!this.tj.brn(ye,new Wd.GraphIterator,mh.a.instance,
iJ.DeleteActor.QWb)){v.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.tj.ucc(ye,ff,this.fb,this.RU)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ze=new aM.a(this._context,n.AFrameworkApplication.ta.tMa,!0,this.tj,this.Oa,lk.PageNavigator.instance),
ne=Ra.a.create(),ff=new II.a(ze,Gd,this.tJ,this.xm,ne,Qn.a.instance,ye,ff,this.tj,this.sm,oe,ug,this.Oa,this.RU,this.Ic,Ka.App.instance.EDb,Ka.App.instance.bnf),this.rre.oXf(ff,this._context,ye,ne),this.oFa(),this.aLj&&this.Hdo();else v.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};
this.ga=b;this.Oa=k;this.rre=r;this.tj=y;this.tJ=R;this.xm=aa;this.E7a=new tJ;this.Hc=Ya;this.fb=xb;this.RU=Mb;this.sm=cc;this.Ic=Mc;this.rg=jc;this.iP=fd}Vb(){let b=!0;this.Oa.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Ic&&this.Ic.isFeatureEnabled(48));b&&!X.a.Ak&&(this.ga.gb(Jc.a.graphicsEditor,lc.a.view,this.TZn,4),this.ga.gb(Wa.a.p6e,lc.a.view,this.wUl,4),this.ga.gb(Jc.a.HDh,lc.a.view,this.xUl,4))}OBh(){const b=new cf.StandardDialog;b.Gd=0;b.my(pj.a.e6e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,
WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Ka.App.xa.updateCommandUI()}FDh(b,k){var r=b.ia(Gh.a.z3,1);const y=b.ia(Hk.a.HZ,0);r&&1!==y?b.ia(wc.a.ash,!1)?(k=new cf.StandardDialog,k.Gd=0,k.my(pj.a.e6e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Ka.App.xa.updateCommandUI(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Pd.ImageReader.aeb(b)})):
(this.ga.Xb(Jc.a.graphicsEditor,2,b.id),this.hqb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.hqb=new Promise(R=>{R(null)})),r=Ra.a.create(),b=new sJ(b,this.vBi,Qn.a.instance,this.hqb,this.sm,this.Oa,this.Ic,Ka.App.instance.eua(this.sm.ul(b))),this.rre.oXf(b,k,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}oFa(){const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b?b.execute(k=>
{k.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):v.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}Hdo(){const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b?b.execute(k=>{k.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(wJ,"GraphicsEditorActor",null,[]);var fM=c(538);class xJ{constructor(b,k,r){this.CSa="wwaengidc";this.$8c="CreateLinkForHeading";
this.RBj="CreateLinkForHeadingAction";this.WDj="\ufffc";this.nSa=b;this.ga=k;this.fb=r}Vb(){this.ga.pa(Jc.a.SCc,lc.a.paragraph,this.k1e.bind(this));this.ga.pa(Jc.a.SCc,lc.a.Hd,this.k1e.bind(this));this.ga.pa(Jc.a.SCc,lc.a.Wc,this.k1e.bind(this));this.ga.Vc(Jc.a.SCc,1028)}k1e(b,k,r){if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)){b=k.node;if(1===r)return this.Gfi(b)?32:8;this.Akn(this.$8c,this.RBj);if(!this.Gfi(b))return v.ULS.sendTraceTag(528815444,
3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(wc.a.Nc);if(!r)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",this.$8c),r=Object.assign(new Xa.a,{additionalValues:r}),Ga.Health.instance.recordKpiFailure(this.$8c,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.lvh(r);return 32}return 8}lvh(b){b=String.format('{{"{0}":"{1}"}}',fM.a.heading,b);const k={};k.nav=btoa(b);
k.mode="copy";this.ga.Xb(ib.a.$cb,2,k)}Gfi(b){return!this.fb.nc(b)||this.fb.WNc(b)||this.fb.fPd(b)||b.Ur||""===b.characterData||b.characterData===this.WDj||!this.nSa.gGd(b)?!1:!0}Akn(b,k){const r=new Map;r.set("Source",this.$8c);r.set("Action",k);Ga.Health.instance.recordKpiUsage(b,0,this.CSa,r)}}Object(m.a)(xJ,"HeadingsActor",null,[]);class yJ{YWn(b){return ie.ParagraphReader.tka(this.VSh(b))}m_c(b,k,r){if(b=ie.ParagraphReader.ULa(this.VSh(b)))k=b.Be(k),Object(Jb.a)(333,k)&&(ty.m(b)?k.zRn(r):k.m_c())}VSh(b){return b&&
b.Xk&&b?b.node:null}}Object(m.a)(yJ,"IFrameFocusStrategy",null,[334]);class zJ{constructor(b){this.wub=null;this.pcd=b}Toi(){v.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}Mfj(b){if(!b)return v.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),
!1;this.wub=A.a.mbe(b.errorDetails.token,b.errorDetails.lcid);this.pcd.add(this.wub,b.errorDetails.lcid);return!0}r8d(b){return b?b.token?A.a.mbe(b.token,b.lcid)===this.wub:(v.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(zJ,"IgnoreAllProofingErrorStrategy",null,[335]);var gM=c(1341),AJ=c(550);class BJ{constructor(b,k){this.filename=b;this.blob=k}}Object(m.a)(BJ,"UploadBlobParameters",
null,[]);class CJ extends Tj{constructor(b,k,r,y,R,aa,ta,Ya=null){super(b,k,r,null,R,aa,!1);this.gMj="DragAndDrop";this.xFg="FileName";this.AFg=0;this.M5g=null;this.Gde=this.q0b=!1;this.HDg=y;this.vXg=Ya}get X2(){return this.gMj}get fileExtension(){return this.xFg}get fileSize(){return this.AFg}get Qkj(){return this.M5g}C1c(b){const k=new BJ(this.HDg.name,this.HDg);b.D$i(k);this.M5g=b.E$a}pLa(b,k){this.vXg&&this.vXg();super.pLa(b,k)}fso(b){const k=!!b&&this.Rwa(b.name,null)&&this.Q$f(b,null);b&&(this.xFg=
b.name,this.AFg=b.size);k||this.MTd();return k}}Object(m.a)(CJ,"DragDropInsertImageUploader",Tj,[]);class Pr{constructor(b,k,r,y,R){this.RUd=this.SUd=this.kVd=this.lVd=0;this.ga=null;this.W5e=(aa,ta,Ya)=>{if(Ka.App.Fzd)return 8;aa=ta.node;return 1===Ya?aa?32:2:2===Ya?(Ya=Pd.ImageReader.Sm(ta),ta=Pd.ImageReader.fJc(Ya,ta.node.Di().Ad,n.AFrameworkApplication.K,n.AFrameworkApplication.ta.tMa),ht(ta),32):2};this.n8l=(aa,ta,Ya)=>{const xb=this.tj.Nda(ta);if(2===Ya&&xb){if(Wa.a.qQ===aa||Wa.a.pud===aa)n.AFrameworkApplication.Wma?
n.AFrameworkApplication.y1f():this.eOk(ta);return 32}return 1!==Ya||Wa.a.qQ!==aa&&Wa.a.pud!==aa?2:xb?32:2};this.TCb=(aa,ta,Ya,xb,Mb)=>this.tj.Nda(ta)?1===Ya?32:this.tj.Jof(ta,Mb)?32:2:2;this.VQn=()=>{if(this.hb&&this.hb.ib&&this.hb.ib.kb){const aa=this.hb.ib.kb.Qa;aa&&this.hb.setSelection(Ke.SelectionFactory.xe(aa.node,aa.cpBegin))}};this.e1k=(aa,ta,Ya,xb,Mb)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((aa=Mb.DataTransfer)&&aa.files&&0<aa.files.length){v.ULS.sendTraceTag(578380440,
307,50,String.format("{0} files to drop",aa.files.length));for(Ya=0;Ya<aa.files.length;Ya++)xb=aa.files[Ya],0<=A.a.mh(xb.type).indexOf("image")&&this.C7l(xb,ta)&&(xb=this.hb.ib.kb.Qa,this.hb.setSelection(Ke.SelectionFactory.xe(xb.node,xb.cpBegin+1)));this.ZFa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.k7m=(aa,ta,Ya,xb,Mb)=>{if(2===Ya)return n.AFrameworkApplication.ya.Vf(ta.rk,aa,Ya,!0,xb,Mb);if(!ta.view.ye)return 8;aa=ta.view;if(!aa.Cb)return 8;
aa=Pr.Sg.qN(aa.Cb.Jg);return 1===aa.length&&this.pN(aa[0])?(this.mCm(),this.QPc||Pr.YLf(!0),32):8};this.rTl=(aa,ta,Ya)=>{if(!this.pN(ta))return 8;const xb=Pd.ImageReader.Sm(ta),Mb=Pd.ImageReader.mE(xb),cc=Pd.ImageReader.AF(xb);aa=aa===Wa.a.tKd;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:aa});if(1===Ya)return this.Ue.G2||Pd.ImageReader.I_a(xb)?2:aa&&Mb<this.SUd&&cc<this.RUd||!aa&&Mb>this.lVd&&cc>this.kVd?32:2;Ya=aa?1.1:.9;this.setSize(xb,ta,Mb*Ya,cc*Ya,!0);return 32};this.Jbc=
(aa,ta,Ya,xb,Mb)=>{if(!this.Eza(ta))return 8;aa=Pd.ImageReader.Sm(ta);ta=Pd.ImageReader.ZLa(aa);Ya=Pd.ImageReader.YLa(aa);if(0>=ta||0>=Ya)return 2;aa=Pd.ImageReader.mE(aa)/ta*100;Mb.setValue(td.a.WLc,aa);return 32};this.r5b=(aa,ta,Ya,xb,Mb)=>{if(!this.Eza(ta))return 8;aa=Pd.ImageReader.Sm(ta);if(1===Ya)return this.Ue.G2||Pd.ImageReader.I_a(aa)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Ya=Mb.ia(td.a.WLc,-1)/100;xb=Mb.ia(td.a.l8h,!1);const cc=Mb.ia(td.a.Vmf,!0);Mb=Mb.ia(td.a.Wmf,
!0);if(0>=Ya)return Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dDb}),2;const jc=Pd.ImageReader.ZLa(aa),Mc=Pd.ImageReader.YLa(aa),fd=Pd.ImageReader.mE(aa),Td=Pd.ImageReader.AF(aa);if(0>=jc||0>=Mc)return Pr.Kc.Zb($c.a.a0,{["Reason"]:bd.a.dDb}),2;xb?(xb=cc?Ya*fd:fd,Ya=Mb?Ya*Td:Td):(xb=cc?Ya*jc:fd,Ya=Mb?Ya*Mc:Td);this.setSize(aa,ta,xb,Ya);gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(ta.node);this.ZFa();return 32};this.qIb=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);aa=Pd.ImageReader.AF(aa);
if(0>=aa)return 2;Mb.setValue(td.a.YBa,aa);return 32};this.YBa=(aa,ta,Ya,xb,Mb)=>{if(!this.Eza(ta))return 8;aa=Pd.ImageReader.Sm(ta);if(1===Ya)return this.Ue.G2||Pd.ImageReader.I_a(aa)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Ya=Mb.ia(td.a.YBa,0);Mb=Pd.ImageReader.G_a(aa);if(0>=Ya)return Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dDb}),2;xb=Pd.ImageReader.ZLa(aa);const cc=Pd.ImageReader.YLa(aa),jc=Pd.ImageReader.mE(aa);var Mc=Pd.ImageReader.AF(aa);Mc=jc/Mc;if(0>=xb||0>=cc)if(Pr.Kc.Zb($c.a.a0,
{["Reason"]:bd.a.dDb}),this.N4i(aa))return 2;this.setSize(aa,ta,Mb?Ya*Mc:jc,Ya);gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(ta.node);Ka.App.xa.updateCommandUI();return 32};this.rIb=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);aa=Pd.ImageReader.mE(aa);if(0>=aa)return 2;Mb.setValue(td.a.ZBa,aa);return 32};this.ZBa=(aa,ta,Ya,xb,Mb)=>{if(!this.Eza(ta))return 8;aa=Pd.ImageReader.Sm(ta);if(1===Ya)return this.Ue.G2||Pd.ImageReader.I_a(aa)?2:32;v.ULS.sendTraceTag(20459939,322,
50,"Change image absolute width.");Ya=Mb.ia(td.a.ZBa,0);Mb=Pd.ImageReader.G_a(aa);if(0>=Ya)return Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dDb}),2;xb=Pd.ImageReader.ZLa(aa);const cc=Pd.ImageReader.YLa(aa);var jc=Pd.ImageReader.mE(aa);const Mc=Pd.ImageReader.AF(aa);jc=Mc/jc;if(0>=xb||0>=cc)if(Pr.Kc.Zb($c.a.a0,{["Reason"]:bd.a.dDb}),this.N4i(aa))return 2;this.setSize(aa,ta,Ya,Mb?Ya*jc:Mc);gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(ta.node);Ka.App.xa.updateCommandUI();return 32};this.tIb=(aa,ta,Ya,xb,
Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);aa=Pd.ImageReader.G_a(aa);Mb.setValue(td.a.QW,aa);return 32};this.QW=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);if(1===Ya&&this.Ue.G2)return 2;gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(ta.node);Mb&&(ta=Mb.ia(td.a.QW,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.tj.Z_i(aa,ta),Ka.App.xa.updateCommandUI());return 32};this.c2a=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);
aa=Pd.ImageReader.pT(aa);Mb.setValue(td.a.mfb,aa);return 32};this.mfb=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;if(1===Ya)return this.Ue.G2?2:32;if(gh.a.instance.J(4)&&Ka.App.vd.Pp&&(aa=ta.node.ia(Gh.a.sK,ml.a.Eq),aa!==ml.a.Eq&&(aa=Ka.App.vd.Mq.feb(aa),AJ.CoauthLockEditor.getInstance().o3a(aa))))return Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),2;aa=Pd.ImageReader.Sm(ta);Mb=Mb.ia(td.a.mfb,null);this.tj.iNn(aa,ta,Mb);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Rd.ys(13);return 32};
this.b2a=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;aa=Pd.ImageReader.Sm(ta);aa=Pd.ImageReader.sBa(aa);Mb.setValue(td.a.PW,aa);return 32};this.PW=(aa,ta,Ya,xb,Mb)=>{if(!this.pN(ta))return 8;if(1===Ya)return this.Ue.G2?2:32;if(gh.a.instance.J(4)&&Ka.App.vd.Pp&&(aa=ta.node.ia(Gh.a.sK,ml.a.Eq),aa!==ml.a.Eq&&(aa=Ka.App.vd.Mq.feb(aa),AJ.CoauthLockEditor.getInstance().o3a(aa))))return Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),2;aa=Pd.ImageReader.Sm(ta);Mb=Mb.ia(td.a.PW,null);this.tj.hNn(aa,ta,Mb);v.ULS.sendTraceTag(21297029,
322,50,"Change image alt text description.");this.Rd.ys(13);return 32};this.tj=b;this.Km=k;this.Rd=r;this.zi=y;this.hb=R}get Ue(){return De.PageReader.instance}get x$(){return this.Km.instance}get wc(){return this.ga}$5l(){this.lVd=Vf.a.rn(1,0);this.kVd=Vf.a.rn(1,1);this.SUd=Vf.a.rn(1920,0);this.RUd=Vf.a.rn(1280,1)}Vb(b){this.ga=b;const k=this.k7m,r=this.n8l,y=this.TCb,R=this.rTl;b.gb(Wa.a.qQ,lc.a.view,r,1284);b.pa(Wa.a.TCb,lc.a.Wc,y);b.pa(Wa.a.TCb,lc.a.image,y);b.Vc(Wa.a.TCb,1284);b.gb(Wa.a.pud,
lc.a.view,r,1284);b.gb(Wa.a.uWe,lc.a.view,k,1028);this.Qq(b,Wa.a.tKd,R);this.Qq(b,Wa.a.N1f,R);this.Qq(b,Wa.a.Jbc,this.Jbc);this.Qq(b,Wa.a.qIb,this.qIb);this.Qq(b,Wa.a.rIb,this.rIb);this.Qq(b,Wa.a.c2a,this.c2a);this.Qq(b,Wa.a.b2a,this.b2a);this.Qq(b,Wa.a.r5b,this.r5b);this.Qq(b,Wa.a.X6d,this.YBa);this.Qq(b,Wa.a.Y6d,this.ZBa);this.Qq(b,Wa.a.q_c,this.mfb);this.Qq(b,Wa.a.fKb,this.PW);this.Qq(b,Wa.a.tIb,this.tIb);this.Qq(b,Wa.a.QW,this.QW);this.Qq(b,Wa.a.W5e,this.W5e);b.gb(Wa.a.tDh,lc.a.view,this.e1k,
4);b.Vc(Wa.a.tKd,4);b.Vc(Wa.a.N1f,4);b.Vc(Wa.a.Jbc,69);b.Vc(Wa.a.qIb,69);b.Vc(Wa.a.rIb,69);b.Vc(Wa.a.tIb,69);b.Vc(Wa.a.c2a,69);b.Vc(Wa.a.b2a,69);b.Vc(Wa.a.QW,4);b.Vc(Wa.a.r5b,4);b.Vc(Wa.a.X6d,4);b.Vc(Wa.a.Y6d,4);b.Vc(Wa.a.q_c,4);b.Vc(Wa.a.fKb,4);this.$5l();this.QPc&&bh.a.instance.tB(this.ask)}Qq(b,k,r){b.pa(k,lc.a.image,r);b.pa(k,lc.a.Ozb,r);b.pa(k,lc.a.Hd,r);b.pa(k,lc.a.anchoredObject,r)}eOk(b){new Tj(b,Mg.a.instance,n.AFrameworkApplication.K,null,this.zi,this.ga)}pso(b){return this.Ue.G2?(Pr.Kc.Zb($c.a.Vm,
{["Reason"]:bd.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.C8k}),!1):Pr.ag.mZ(b)?(Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.dE}),!1):this.x$&&this.x$.KT(b)?(Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.externalSelection}),!1):!0}zgm(b){const k=Pd.ImageReader.Sm(b);return k&&5===Pd.ImageReader.ul(k)&&this.Ddi(b,k)}Ddi(b,k){(k=!Pd.ImageReader.i3b(k)&&!Pd.ImageReader.xPd(k))||Pr.Kc.Zb($c.a.Vm,{["Reason"]:bd.a.hsh});return k&&this.pso(b)}C7l(b,k){k=new CJ(k,Mg.a.instance,n.AFrameworkApplication.K,
b,this.zi,this.ga,this.hb,this.VQn);if(!k.fso(b))return Ga.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new gk.a(document.body,Object(u.a)(k,k.sac,"onUploadFrameInitialized"),Object(u.a)(k,k.Kwa,"uploadResponseReceived"),n.AFrameworkApplication.K,!1,void 0,Fn.a(n.AFrameworkApplication.K));return!0}pN(b){return this.zgm(b)}Eza(b){const k=Pd.ImageReader.Sm(b);if(!k)return!1;const r=
Va.a.instance.Pa("Box4.IFeatureHelper"),y=Pd.ImageReader.ul(k);return 5===y||10===y||48===y||11===y||r&&r.isFeatureEnabled(48)&&4===y?this.Ddi(b,k):!1}get QPc(){var b;return null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}ask(){Pr.YLf(!0)}setSize(b,k,r,y,R=!1){gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(k.node);const aa=Pd.ImageReader.G_a(b);let ta=1;r>this.SUd?ta=this.SUd/r:r<this.lVd&&(ta=this.lVd/
r);let Ya=1;y>this.RUd?Ya=this.RUd/y:y<this.kVd&&(Ya=this.kVd/y);if(aa||R)ta=Math.min(ta,Ya),Ya=Math.min(ta,Ya);1!==ta&&(r*=ta);1!==Ya&&(y*=Ya);this.z5e(b,k,r,y)}z5e(b,k,r,y){this.tj.dRn(b,k,r,y)}mCm(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}ZFa(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("WordInsertImageApplied",
"WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}N4i(b){const k=Pd.ImageReader.ZLa(b);b=Pd.ImageReader.YLa(b);return 0>=k||0>=b}static get Sg(){return tm.ContextSetEditor.instance}static get ag(){return mh.a.instance}static get Kc(){return Db.a.instance}}Pr.YLf=null;Object(m.a)(Pr,"ImageActor",null,[]);var ZF=c(1142),$F=c(1143),ZE=c(691),DJ=c(539),hM=c(490),iM=c(1422);class Zp extends Pr{constructor(b,k,r,y,R,aa,ta,Ya){super(b,k,y,aa,ta);this.TQg=!1;this.iya=this.i9=null;this.Xv=(xb,Mb,cc,jc,Mc)=>
{if(!this.pN(Mb))return 8;if(1===cc)return this.Ue.G2?2:32;xb=parseInt(Mc);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+xb);this.ald.Zfn(Mb,Pd.ImageReader.Sm(Mb),xb);this.hRc(Mb);this.ZFa();return 32};this.N4d=(xb,Mb,cc)=>{if(!this.pN(Mb))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");xb=Pd.ImageReader.Sm(Mb);if(1===cc)return this.Ue.G2?2:32;cc=Pd.ImageReader.beb(xb);1===cc?(cc=new sf.GraphTransaction(15),cc.Eb(Mb.node),Pd.ImageReader.i6b()?xb.setValue(wc.a.CHb,""):
this.DJ.Nrn(xb),cc.dispose(),this.Buc.create(xb,Mb).Xv(ed.a.hTi),this.hRc(Mb)):2===cc&&this.Buc.create(xb,Mb).Xv(ed.a.hTi);return 32};this.XUl=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;xb=Pd.ImageReader.Sm(Mb);if(1===cc)return this.Ue.G2||Pd.ImageReader.X6b(xb)?2:32;Mc&&(this.DJ.A2c(xb,Mb),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Ka.App.xa.updateCommandUI());this.ZFa();return 32};this.YUl=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;if(1===cc)return this.Ue.G2?2:32;xb=Pd.ImageReader.Sm(Mb);
if(Mc){cc=Pd.ImageReader.dOd(Pd.ImageReader.Sm(Mb));v.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+cc);jc=Mc.ia(td.a.rfb,0);const fd=Mc.ia(td.a.ofb,0),Td=Mc.ia(td.a.pfb,0);Mc=Mc.ia(td.a.qfb,0);const ne=Pd.ImageReader.Fla(xb),ye=Pd.ImageReader.Cla(xb),ff=Pd.ImageReader.Dla(xb),Gd=Pd.ImageReader.Ela(xb);if(jc===ne&&fd===ye&&Td===ff&&Mc===Gd)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;cc?(new ZF.a(xb,new $F.a)).VKn(jc,
fd,Td,Mc,this.uTm,Mb):this.ald.Ofn(Mb,Pd.ImageReader.Sm(Mb),jc,fd,Td,Mc);this.hRc(Mb);Ka.App.xa.updateCommandUI()}return 32};this.BKd=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;jc=Pd.ImageReader.Sm(Mb);if(1===cc)return this.Ue.G2||Pd.ImageReader.X6b(jc)?2:32;if(Mc){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.DJ.dua()||this.DJ.A2c(jc,Mb);switch(xb){case Jc.a.OLc:xb=Mc.ia(td.a.rfb,-1);cc=0;break;case Jc.a.LLc:xb=Mc.ia(td.a.ofb,-1);cc=1;
break;case Jc.a.MLc:xb=Mc.ia(td.a.pfb,-1);cc=2;break;case Jc.a.NLc:xb=Mc.ia(td.a.qfb,-1);cc=3;break;default:return 8}this.DJ.Ylo(xb,cc);this.hRc(Mb);Ka.App.xa.updateCommandUI()}return 32};this.Ajb=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;Pd.ImageReader.Sm(Mb);Mc&&(xb=this.DJ.dua(),Mc.setValue(td.a.dua,xb));return 32};this.Ibc=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;Mb=Pd.ImageReader.Sm(Mb);if(Mc){if(this.DJ.dua())({top:Td,bottom:cc,left:xb,right:Mb}=this.DJ.eql());else{jc=Vf.a.uf(Pd.ImageReader.mE(Mb),
0);var fd=Vf.a.uf(Pd.ImageReader.AF(Mb),1);var Td=Math.max(Pd.ImageReader.Fla(Mb),0);cc=Math.max(Pd.ImageReader.Cla(Mb),0);xb=Math.max(Pd.ImageReader.Dla(Mb),0);Mb=Math.max(Pd.ImageReader.Ela(Mb),0);jc=1E5*jc/(1E5-(xb+Mb));fd=1E5*fd/(1E5-(Td+cc));Td=Math.floor(Td*fd/1E5);cc=Math.floor(cc*fd/1E5);xb=Math.floor(xb*jc/1E5);Mb=Math.floor(Mb*jc/1E5)}Mc.setValue(td.a.rfb,Td);Mc.setValue(td.a.ofb,cc);Mc.setValue(td.a.pfb,xb);Mc.setValue(td.a.qfb,Mb)}return 32};this.z4b=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;
if(1===cc){if(this.Ue.G2)return 2;this.NEm();return 32}xb=Pd.ImageReader.Sm(Mb);this.DJ.dua()&&this.DJ.A2c(xb,Mb);xb=Mc.ia(td.a.MEa,"");Mc=Mc.ia(td.a.c5a,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:Mc,["SourceControlId"]:xb});switch(Mc){case 1:this.DJ.WRn(Mb);break;case 8:this.DJ.T7d(Mb,1,1);break;case 9:this.DJ.T7d(Mb,1,3);break;case 3:this.DJ.T7d(Mb,2,void 0,!0);break;case 4:this.DJ.T7d(Mb,2,void 0,!1)}this.ZFa();Ka.App.xa.updateCommandUI();return 32};this.Zbc=(xb,Mb,
cc,jc,Mc)=>{if(!this.pN(Mb))return 8;xb=Pd.ImageReader.Sm(Mb);Mb=Pd.ImageReader.laa(Mb);cc=Pd.ImageReader.H6(xb);jc=Pd.ImageReader.YJc(xb);xb=Pd.ImageReader.Lv(xb);return this.Mfn(Mb,cc,jc,xb,Mc)?32:8};this.$Ul=(xb,Mb,cc,jc,Mc)=>{if(!this.Eza(Mb))return 8;jc=Pd.ImageReader.Sm(Mb);if(1===cc)return Ae.SessionStatusManager.instance.Tj?8:this.Ue.G2||Pd.ImageReader.Z6b(jc)?2:32;this.DJ.dua()&&this.DJ.A2c(jc,Mb);if(Mc){var fd=Mc.ia(td.a.TLc,0);const Td=Pd.ImageReader.dOd(jc);v.ULS.sendTraceTag(22052889,
322,50,"SetImageRotateAction: {0}, isCanvas: {1}",fd,Td);cc=Pd.ImageReader.AZ(jc);let ne=Pd.ImageReader.lGd(jc),ye=Pd.ImageReader.LAb(jc);switch(fd){case 0:cc=Mc.ia(td.a.jK,0);break;case 2:cc-=90;cc=dd.c(cc);break;case 1:cc+=90;cc=dd.c(cc);break;case 4:ne=!ne;break;case 3:ye=!ye;break;case 5:cc+=Mc.ia(td.a.jK,0),cc=dd.c(cc)}Td?(new ZF.a(jc,new $F.a)).uQn(cc,ne,ye,this.bZm,Mb):fd?this.Buc.create(jc,Mb).FPn(cc,ne,ye):(Mc=Ra.a.create(),fd=new sf.GraphTransaction(15,Wa.a.imageRotate),fd.Eb(Mb.node),this.DJ.rNn(jc,
cc),this.ald.Vfn(Mb,Pd.ImageReader.Sm(Mb),cc,Mc),fd.dDa(Mc,1),fd.Al=xb,fd.dispose());this.ZFa();this.hRc(Mb);Ka.App.xa.updateCommandUI()}return 32};this.sIb=(xb,Mb,cc,jc,Mc)=>{if(!this.pN(Mb))return 8;xb=Pd.ImageReader.Sm(Mb);xb=Pd.ImageReader.AZ(xb);if(0>xb)return 2;Mc.setValue(td.a.jK,xb);return 32};this.bZm=(xb,Mb,cc,jc)=>{if(xb){const Mc=new sf.GraphTransaction(15,Wa.a.imageRotate);Mc.Eb(jc.node);Mb.setValue(td.a.dZb,JSON.stringify(cc));Mb.setValue(td.a.gu,xb);this.DJ.a7d(Mb,cc.rotationAngle,
cc.c5b,cc.jic);this.bAb(Mb);Mc.dispose()}};this.OYm=(xb,Mb,cc,jc)=>{if(xb){const Mc=new sf.GraphTransaction(15);Mc.Eb(jc.node);Mb.setValue(td.a.dZb,JSON.stringify(cc));Mb.setValue(td.a.gu,xb);this.DJ.K6d(Mb,cc.xce,cc.u3c);this.bAb(Mb);Mc.dispose()}};this.uTm=(xb,Mb,cc,jc)=>{if(xb){const Mc=new sf.GraphTransaction(15);Mc.Eb(jc.node);Mb.setValue(td.a.dZb,JSON.stringify(cc));Mb.setValue(td.a.gu,xb);this.DJ.lNn(Mb,Math.round(cc.hea*ZE.a.Lbb),Math.round(cc.Dka*ZE.a.Lbb),Math.round(cc.Eka*ZE.a.Lbb),Math.round(cc.Fka*
ZE.a.Lbb));this.bAb(Mb);Mc.dispose()}};this.nVc=(xb,Mb,cc,jc,Mc)=>{if(!this.Eza(Mb))return 8;if(1===cc)return 32;xb=Mb.contextId===lc.a.view?De.PageReader.instance.nHd(Mb):lk.PageNavigator.instance.pu(Mb.node);if(!xb)return 8;cc=Pd.ImageReader.Sm(Mb);Mb=this.wo.RXh(qn.a.oT(Mb),cc);Zp.fGi.Jdc=Mb;this.ZOc&&this.recentColors.K9f(Mb);Mb=Zp.fGi.fEd(xb,Ka.App.FZb);if(!Mb)return 8;Mc.MenuItems=Mb;return 32};this.N7=(xb,Mb,cc,jc,Mc)=>{if(!this.Eza(Mb))return 8;if((jc=Pd.ImageReader.Sm(Mb))&&Pd.ImageReader.Xx(jc))return 2;
if(1===cc)return 32;if(2!==cc)return 2;if(!Mc)return v.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;cc=new sf.GraphTransaction(15);cc.Eb(Mb.node);const fd=Zp.Dgc.Zza(Mb.node,Mc);this.wo.N7(jc,Mc,Mb,fd);this.bAb(jc);cc.dispose();xb==Wa.a.B_c&&this.recentColors.X$a(Mc);this.b6c();this.ZFa();return 32};this.jga=(xb,Mb,cc)=>{if(!this.Eza(Mb))return 8;if(1===cc)return 32;Ka.App.xa.tw();Zp.h6a=new Vu.a("PictureBorder",Wa.a.B_c);Zp.h6a.D0c(0);return 32};this.aha=(xb,Mb,cc,
jc,Mc)=>{if(!this.Eza(Mb))return 8;if(1===cc)return 32;if((xb=Pd.ImageReader.Sm(Mb))&&Pd.ImageReader.Xx(xb))return 2;if(!Mc)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;cc=new sf.GraphTransaction(15);cc.Eb(Mb.node);this.wo.aha(xb,Mc,Mb);this.bAb(xb);cc.dispose();this.b6c();this.ZFa();return 32};this.h3a=(xb,Mb,cc,jc,Mc)=>{if(!this.Eza(Mb))return 8;if(1===cc)return 32;if((xb=Pd.ImageReader.Sm(Mb))&&Pd.ImageReader.Xx(xb))return 2;if(!Mc)return v.ULS.sendTraceTag(571287760,
322,10,"SetPictureBorderStyle: actionData null"),8;cc=new sf.GraphTransaction(15);cc.Eb(Mb.node);this.wo.h3a(xb,Mc,Mb);this.bAb(xb);cc.dispose();this.b6c();this.ZFa();return 32};this.X3d=(xb,Mb,cc)=>{if(!this.Eza(Mb))return 8;if(1===cc)return 32;xb=Pd.ImageReader.Sm(Mb);cc=new sf.GraphTransaction(15);cc.Eb(Mb.node);Pd.ImageReader.L4b(xb)&&(this.wo.X3d(xb),this.bAb(xb));cc.dispose();this.b6c();this.ZFa();return 32};this.DJ=b;this.Buc=r;this.ald=R;Zp.Dh=Ya;Pr.YLf=Zp.l7m}get recentColors(){return null!=
this.Qqg?this.Qqg:this.Qqg=Va.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get wo(){this.i9||(this.i9=new DJ.a);return this.i9}Vb(b){super.Vb(b);this.Qq(b,Wa.a.Xv,this.Xv);b.Vc(Wa.a.Xv,4);this.Qq(b,Wa.a.N4d,this.N4d);this.Qq(b,Jc.a.Pee,this.z4b);b.Vc(Jc.a.Pee,4);this.Qq(b,Jc.a.Qee,this.z4b);this.Qq(b,Jc.a.Ree,this.z4b);this.Qq(b,Jc.a.Tee,this.z4b);this.Qq(b,Jc.a.Uee,this.z4b);this.Qq(b,Jc.a.Vee,this.z4b);this.Qq(b,Jc.a.Zbc,this.Zbc);b.Vc(Jc.a.Zbc,101);this.Qq(b,Jc.a.imageCrop,this.XUl);b.Vc(Jc.a.imageCrop,
4);this.Qq(b,Jc.a.Ajb,this.Ajb);b.Vc(Jc.a.Ajb,101);this.Qq(b,Jc.a.f8h,this.YUl);this.Qq(b,Jc.a.OLc,this.BKd);this.Qq(b,Jc.a.LLc,this.BKd);this.Qq(b,Jc.a.MLc,this.BKd);this.Qq(b,Jc.a.NLc,this.BKd);this.Qq(b,Jc.a.hWc,this.Ibc);b.Vc(Jc.a.hWc,101);this.Qq(b,Jc.a.C1d,this.Ibc);b.Vc(Jc.a.C1d,101);this.Qq(b,Jc.a.D1d,this.Ibc);b.Vc(Jc.a.D1d,101);this.Qq(b,Jc.a.E1d,this.Ibc);b.Vc(Jc.a.E1d,101);this.Qq(b,Wa.a.imageRotate,this.$Ul);b.Vc(Wa.a.imageRotate,4);this.Qq(b,Wa.a.sIb,this.sIb);b.Vc(Wa.a.sIb,101);this.Qq(b,
Wa.a.nVc,this.nVc);b.Vc(Wa.a.nVc,4);this.Qq(b,Wa.a.N7,this.N7);b.Vc(Wa.a.N7,4);this.Qq(b,Wa.a.B_c,this.N7);b.Vc(Wa.a.B_c,4);this.Qq(b,Wa.a.RJf,this.jga);b.Vc(Wa.a.RJf,4);this.Qq(b,Wa.a.Dva,this.Dva.bind(this));b.Vc(Wa.a.Dva,4);this.Qq(b,Wa.a.aha,this.aha);b.Vc(Wa.a.aha,4);this.Qq(b,Wa.a.vIb,this.vIb.bind(this));b.Vc(Wa.a.vIb,4);this.Qq(b,Wa.a.h3a,this.h3a);b.Vc(Wa.a.h3a,4);this.Qq(b,Wa.a.uEf,this.X3d);b.Vc(Wa.a.uEf,4)}z5e(b,k,r,y){v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+
Pd.ImageReader.dOd(b));this.DJ.dua()&&this.DJ.A2c(b,k);if(Pd.ImageReader.Xx(b)){b=Ra.a.create();const R=new sf.GraphTransaction(15);R.Eb(k.node);this.ald.Ufn(k,Pd.ImageReader.Sm(k),r,y,b);R.dDa(b,1);R.dispose()}else Pd.ImageReader.Tec(b)?(new ZF.a(b,new $F.a)).eQn(r,y,this.OYm,k):(super.z5e(b,k,r,y),this.Rd.ys(13))}pN(b){if(!b.Xk)return!1;var k=b.node;return(k=Ka.App.instance&&Ka.App.instance.EDb?k instanceof gj.a||k instanceof iM.a?k:null:Object(ia.a)(gj.a,k))&&ty.o(k)?(Pr.Kc.Zb(gM.a.Vm,{["Reason"]:ix.a.uN}),
!1):super.pN(b)}static l7m(b){b&&!Zp.jsb&&(Zp.Dh.GVa(Zp.oib),Zp.jsb=!0)}Mfn(b,k,r,y,R){return R?(R.Vei=b,R.H6=k,R.ZLb=r,R.Zs=y,R.c5a=Zp.BRl(R),!0):!1}hRc(b){gh.a.instance.J(4)&&Ka.App.vd.Pp&&Ka.App.vd.Mq.KG(b.node)}NEm(){this.TQg||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.TQg=!0)}bAb(b){const k=hM.a.instance.xBd(b);this.DJ.Z6d(b,k[0],k[1],k[2],k[3])}Dva(b,k,r,y,R){2===r&&(b=Pd.ImageReader.Sm(k),this.wo.ruj(R,b));return 32}vIb(b,k,r,y,R){2===r&&(b=Pd.ImageReader.Sm(k),this.wo.quj(R,
b));return 32}b6c(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Va.a.instance.$a("Common.ISystemInitiatedFeedback");b&&b.execute(k=>{k.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Dgc(){return null!=Zp.Jsg?Zp.Jsg:Zp.Jsg=Ti.a.instance}static get fGi(){Zp.VU||(Zp.VU=new Wu.a("PictureBorder"),Zp.VZa(Zp.VU));return Zp.VU}static BRl(b){if(b.Vei)b=1;else switch(b.ZLb){case 2:b=
b.H6?3:4;break;case 1:b=1===b.Zs?8:3===b.Zs?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static VZa(b){b.uda(3,Wa.a.N7);b.uda(4,Wa.a.N7);b.uda(5,Wa.a.B_c);b.uda(6,Wa.a.N7);b.tXb(Uu.a.instance,1)}get ZOc(){null==this.iya&&(n.AFrameworkApplication.Ne("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.iya=n.AFrameworkApplication.K?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);
return this.iya}}Zp.jsb=!1;Zp.VU=null;Zp.h6a=null;Zp.oib=()=>{Zp.Dh.ycc(Zp.oib);Zp.jsb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))};Object(m.a)(Zp,"ImageActor",Pr,[]);class Fm{static get paragraphEditor(){return null!=Fm.lqg?Fm.lqg:Fm.lqg=Va.a.instance.resolve("Box4.IParagraphEditor")}static get gy(){return null!=Fm.xqg?Fm.xqg:Fm.xqg=Va.a.instance.resolve("Box4.IParagraphIndentationReader")}static get p_(){return Fm.paragraphEditor.xp}static get zi(){return null!=
Fm.Ltg?Fm.Ltg:Fm.Ltg=Va.a.instance.resolve("Box4.IUndoManager")}static Vb(){const b=n.AFrameworkApplication.ya;b.pa(Wa.a.fIb,lc.a.view,em.a.Cv);b.pa(Wa.a.fIb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.fIb,1036);b.pa(Wa.a.Dyb,lc.a.view,em.a.Cv);b.pa(Wa.a.Dyb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.Dyb,1036);b.pa(Wa.a.$bb,lc.a.view,em.a.Cv);b.pa(Wa.a.$bb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.$bb,1036);b.pa(Wa.a.tcc,lc.a.view,em.a.Cv);b.pa(Wa.a.tcc,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.tcc,1036);b.pa(Wa.a.OXc,lc.a.view,em.a.Cv);
b.pa(Wa.a.OXc,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.OXc,1036);b.pa(Wa.a.RZa,lc.a.view,em.a.Cv);b.pa(Wa.a.RZa,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.RZa,1036);b.pa(Wa.a.xfb,lc.a.view,em.a.Cv);b.pa(Wa.a.xfb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.xfb,1036);b.pa(Wa.a.QZa,lc.a.view,em.a.Cv);b.pa(Wa.a.QZa,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.QZa,1036);b.pa(Wa.a.c7d,lc.a.view,Fm.W9d);b.pa(Wa.a.c7d,lc.a.paragraph,Fm.W9d);b.Vc(Wa.a.c7d,1028);b.pa(Wa.a.TYf,lc.a.view,Fm.W9d);b.pa(Wa.a.TYf,lc.a.paragraph,Fm.W9d);b.Vc(Wa.a.TYf,1028);
b.pa(Wa.a.tKb,lc.a.view,em.a.Cv);b.pa(Wa.a.tKb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.tKb,1036);b.pa(Wa.a.Kkb,lc.a.view,em.a.Cv);b.pa(Wa.a.Kkb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.Kkb,1036);b.pa(Wa.a.uKb,lc.a.view,em.a.Cv);b.pa(Wa.a.uKb,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.uKb,1036);b.pa(Wa.a.Q9d,lc.a.view,em.a.Cv);b.Vc(Wa.a.Q9d,1028);b.pa(Wa.a.L_c,lc.a.view,em.a.Cv);b.pa(Wa.a.L_c,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.L_c,1036);b.pa(Wa.a.M_c,lc.a.view,em.a.Cv);b.pa(Wa.a.M_c,lc.a.paragraph,Fm.Qja);b.Vc(Wa.a.M_c,1036)}static W9d(b,
k,r,y,R){2===r&&""===R[rc.a.Text]&&(b=b===Wa.a.c7d?Wa.a.RZa:Wa.a.QZa,k=new MB.a,k.value=0,k.unit=Ka.App.M6?2:1,n.AFrameworkApplication.ya.Xb(b,2,k),Ka.App.xa.updateCommandUI());return 32}static Qja(b,k,r,y,R){if(!({Ix:r}=em.a.T_f(r,k)).returnValue)return r;k=k.node;switch(b){case Wa.a.fIb:Fm.p_.COf(k,!0);break;case Wa.a.Dyb:Fm.p_.COf(k,!1);break;case Wa.a.$bb:Fm.p_.$bb(k);break;case Wa.a.tcc:Fm.p_.uba(k,0);break;case Wa.a.OXc:Fm.p_.Ckb(k,0);break;case Wa.a.xfb:case Wa.a.RZa:r=new Wd.GraphIterator;
r.set(k);r.Ab(11);let aa=R.value;R=R.unit;b===Wa.a.xfb&&(aa=(new Tk.a(R,aa)).mt+Fm.gy.zF(k).mt,R=1);Fm.p_.iwa(r,R,aa);break;case Wa.a.QZa:Fm.p_.gKb(k,R.unit,R.value);break;case Wa.a.tKb:R?(b=(new Tk.a(R.unit,R.value)).mt,Fm.p_.uba(k,b)):Fm.gy.UFd(k).mt||Fm.p_.uba(k,Nf.OutlineReader.EL(k));break;case Wa.a.Kkb:R?(b=(new Tk.a(R.unit,R.value)).mt,Fm.p_.Ckb(k,b)):Fm.gy.zF(k).mt||Fm.p_.Ckb(k,Nf.OutlineReader.EL(k));break;case Wa.a.uKb:Fm.p_.uba(k,0);break;case Wa.a.L_c:b=R;b=(new Tk.a(b.unit,b.value)).mt;
Fm.p_.JZf(k,1,b);break;case Wa.a.M_c:b=R,b=(new Tk.a(b.unit,b.value)).mt,Fm.p_.JZf(k,2,b)}Fm.zi.KF();y&&Qc.a.Slb&&(y.Mr|=Qc.a.Odb(k));return 32}}Object(m.a)(Fm,"IndentationActor",null,[]);var EJ=c(315),jM=c(50),$E=c(451),kM=c(1186);class Hq{constructor(b){this.LTa=this.kza=this.Gsc=null;this.U6g=!1;this.O0d=k=>{if(this.kza)if(k===ib.a.N0d)Id.FocusManager.instance().getRegion(id.AFrame.S1a).d$b();else if(k===ib.a.M0d)Id.FocusManager.instance().getRegion(id.AFrame.S1a).b$b();else return 2;else return 2;
return 32};this._frame=b}C4n(){if(this.U6g)this.Sli();else{const b=Hb.a.create(n.AFrameworkApplication.K.lb("WopiBootstrapUrl"));b.VV((k,r)=>{r.succeeded?(this.U6g=!0,this.Sli()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Zb.a.cT(b)}}Sli(){if(this.Gsc)v.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.dpa;this.kza=document.createElement("div");b.parentNode.insertBefore(this.kza,b);this.LTa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,
{fileName:n.AFrameworkApplication.K.lb("FileName"),reactRoot:this.kza});this.LTa.setWebpackPublicPath(n.AFrameworkApplication.Q3);this.LTa.renderDocumentPanel()}}jyl(b){const k={};k.Container=b;k.BootstrapperUrl=n.AFrameworkApplication.K.lb("WopiBootstrapUrl");k.ApplicationUrl=this._frame.Smb;b={};b.HostName=n.AFrameworkApplication.K.lb("FileSource");b.HostSessionId=n.AFrameworkApplication.K.lb("HostSessionId");b.UserId=n.AFrameworkApplication.K.lb("UserId");b.DocumentClickTime=new Date(this._frame.Nhb);
b.SessionContext="";b.WdParams={};k.SessionInformation=b;b={};b.FileName=n.AFrameworkApplication.K.lb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};k.WopiPrecheckInfo=b;k.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.Nhb;k.Diagnostics=b;b={};b.WopiSrc=n.AFrameworkApplication.K.lb("WopiSrc");b.AccessToken=n.AFrameworkApplication.K.lb("AccessToken");
b.AccessTokenTtl=n.AFrameworkApplication.K.lb("AccessTokenTtl");k.WopiInfo=b;k.FnOnInitializeSuccess=r=>{Hq.SV=r;this.LTa.setMaxPage(Hq.SV.GetPageCount());this.LTa.setCurrentPage(Hq.SV.GetCurrentPage());this.LTa.setPageControlVisible(!0);Hq.SV.RegisterEventHandler("PageChanged",y=>{this.LTa.setCurrentPage(y.newPage)});Hq.SV.RegisterEventHandler("BrowserEvent",y=>{27===y.keyCode?this.closeViewer():y.button&&1!==y.button||this.kza.click()});r=this._frame.Nhb-(new Date).getTime();v.ULS.sendTraceTag(38355488,
323,50,"previewPanel: Load finished - {0}",r);this.Vb();Id.FocusManager.instance().zK(id.AFrame.S1a,!0);this.buildFocusRegion();this.$Da(Id.FocusManager.instance().re(id.AFrame.S1a));this.kza.click()};k.FnOnInitializeFailure=(r,y)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),y.toString());this.closeViewer()};return k}buildFocusRegion(){const b=Id.FocusManager.instance();var k=b.getRegion(id.AFrame.S1a);k=[2,3];const r=b.re(id.AFrame.S1a),y=new Gg.DOMFocusListing(()=>
this.kza);y.fEa=!0;for(let R of k)y.Rn(R);k=b.aka(()=>this.kza,r,y);k.fPa();k.$T=!0;k.HWa=!0;y.qy(y.Cea)}Vb(){n.AFrameworkApplication.ya.pa(ib.a.N0d,zc.a.frame,this.O0d);n.AFrameworkApplication.ya.pa(ib.a.M0d,zc.a.frame,this.O0d)}$Da(b){b.Er(Id.FocusManager.instance().EV);b.Er(Id.FocusManager.instance().FV);b.bindAction(Id.FocusManager.instance().EV,ib.a.N0d);b.bindAction(Id.FocusManager.instance().FV,ib.a.M0d)}loadViewer(b){b=this.jyl(b);this.Gsc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);
this.Gsc.Complete(b.WopiInfo)}closeViewer(){Id.FocusManager.instance().RQ(id.AFrame.S1a);Hq.SV&&(Hq.SV.Dispose(),Hq.SV=null,n.AFrameworkApplication.ya.fz(ib.a.N0d,zc.a.frame,this.O0d),n.AFrameworkApplication.ya.fz(ib.a.M0d,zc.a.frame,this.O0d));this.Gsc&&(this.kza.parentNode.removeChild(this.kza),this.kza=this.Gsc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");n.AFrameworkApplication.ya.processAction(Wa.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,
323,50,"previewPanel: Download to PDF Called");n.AFrameworkApplication.ya.processAction(Jc.a.KEc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");n.AFrameworkApplication.ya.processAction(ib.a.downloadACopy,2)}zoomInAction(){if(Hq.SV){let b=Hq.SV.GetZoomLevel();b+=.2;Hq.SV.SetZoomLevel(b)}}zoomOutAction(){if(Hq.SV){let b=Hq.SV.GetZoomLevel();b-=.2;Hq.SV.SetZoomLevel(b)}}setPage(b){if(Hq.SV){const k=Hq.SV.GetPageCount();1>b?(Hq.SV.SetCurrentPage(1),this.LTa.setCurrentPage(1)):
1<=b&&b<=k?Hq.SV.SetCurrentPage(b):(Hq.SV.SetCurrentPage(k),this.LTa.setCurrentPage(k))}}static getInstance(b){Hq.HDe||(Hq.HDe=new Hq(b));return Hq.HDe}}Hq.SV=null;Hq.HDe=null;Object(m.a)(Hq,"PreviewPanelActor",null,[]);class uq{static get wmj(){return null!=uq.Vtg?uq.Vtg:uq.Vtg=n.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName")}static Vb(b,k){b.gb(Wa.a.IIb,zc.a.frame,uq.Nnj,128);b.pa(Wa.a.bae,zc.a.frame,uq.Nnj);uq.PD=k;b.pa(Jc.a.yQc,zc.a.frame,uq.yQc);b.pa(Jc.a.AQc,zc.a.frame,uq.AQc);
b.gb(Jc.a.xWc,zc.a.frame,uq.xWc,96);b.gb(Jc.a.KWc,zc.a.frame,uq.KWc,96)}static Nnj(b,k,r){if(k.contextId!==zc.a.frame)return 2;k=jl.App.En;switch(b){case Wa.a.IIb:if(!k.Smb)return 8;if(1===r)return Ae.SessionStatusManager.instance.Tj?8:32;b=(new Date).getTime();dj.a.instance.Dln(b);k.Nhb=b;n.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Ug.a.XP(3,!0,uq.C$m,null,k):Ug.a.XP(3,!0,uq.pui,null,k);return 32;case Wa.a.bae:return 32;default:return 2}}static pui(b){$E.a()?uq.nQl(b):uq.haj(b)}static nQl(b){const k=
{};k[H.a.jmf]=uq.wmj;n.AFrameworkApplication.gQ().execute(r=>{r.Av(E.a.kmf);r.Cho(E.a.kmf);r.fC(E.a.kmf,y=>{uq.bvk(y,b)});r.sendMessage(E.a.rwl,k)})}static bvk(b,k){b.Values[H.a.jmf]===uq.wmj&&("true"===b.Values[H.a.v7h]?uq.haj(k):(uq.Lko(),uq.D7n()))}static Lko(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};n.AFrameworkApplication.Ne("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",
!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static D7n(){n.AFrameworkApplication.Ju=!0;Ka.App.xa.b8(1);Ka.App.xa.jb.zv&&Ka.App.xa.jb.zv.yi&&Ka.App.xa.jb.zv.$nf();n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Ka.App.xa.updateCommandUI();kM.PageView.dej(n.AFrameworkApplication.K)}static haj(b){try{const k=new Fc.a;let r,y;n.AFrameworkApplication.Mmj?(r=Ka.App.hostUrl,y=
3):(r=b.Smb,y=1);b.Nhb&&k.add(n.AFrameworkApplication.QAf,b.Nhb.toString());n.AFrameworkApplication.gqf&&k.add(n.AFrameworkApplication.d_e,"1");n.AFrameworkApplication.SVe&&k.add(n.AFrameworkApplication.jFk,"1");k.add(EJ.a.D$f,EJ.a.userSessionData);k.add(n.AFrameworkApplication.R0d,n.AFrameworkApplication.userSessionId);const R=n.AFrameworkApplication.K.lb(n.AFrameworkApplication.Cha);R&&k.add(n.AFrameworkApplication.lgj,R);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");$E.b(n.AFrameworkApplication.K)?
$E.d("view",k,$E.c):(r=Oa.a.V9g(r,k),n.AFrameworkApplication.Mmj?Qe.a.Gm(r,Qe.a.fpa(y),void 0,"AuthenticationLostDuringSession"):Qe.a.openWindow(y,r,!1,void 0,jM.a.WQi))}catch(k){}}static C$m(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Va.a.instance.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("previewPanel")).catch(()=>{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");
uq.pui(b)}).then(()=>{Hq.getInstance(b).C4n()})}static yQc(b,k,r){if(1===r)return 32;uq.PD.e_i(1);Ka.App.xa.updateCommandUI();return 32}static AQc(b,k,r){if(1===r)return 32;uq.PD.e_i(0);Ka.App.xa.updateCommandUI();return 32}static xWc(b,k,r,y,R){if(1===r)return 32;R[Ig.a.On]=1===uq.PD.Qw;return 32}static KWc(b,k,r,y,R){if(1===r)return 32;R[Ig.a.On]=!uq.PD.Qw;return 32}}uq.PD=null;Object(m.a)(uq,"MainViewModeActor",null,[]);class FJ{constructor(b,k,r){this.HGm=(y,R,aa,ta,Ya)=>1===aa?32:(y=this.Jk.S$(R.rk))?
(Ya=3===Ya.$w,this.F4.value.Evh(this.dHl(y),this.EBb(y),Ya),32):2;this.ga=b;this.F4=k;this.Jk=r}Vb(){this.ga.pa(Jc.a.qwf,lc.a.view,this.HGm);this.ga.gb(Jc.a.J1d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Jc.a.G1d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Jc.a.H1d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Jc.a.I1d,lc.a.view,Mh.a.TQ,96);this.ga.pa(Jc.a.fUc,lc.a.view,Mh.a.HF);this.ga.pa(Jc.a.eUc,lc.a.view,Mh.a.HF);this.ga.pa(Jc.a.vZd,lc.a.view,Mh.a.HF);this.ga.pa(Jc.a.wZd,lc.a.view,Mh.a.HF)}dHl(b){const k=new Di.DictionaryPropertySet;
k.setValue(wc.a.marginTop,this.Jk.Hla(b));k.setValue(wc.a.marginBottom,this.Jk.xta(b));k.setValue(wc.a.marginLeft,this.Jk.DI(b));k.setValue(wc.a.marginRight,this.Jk.eK(b));return k}EBb(b){const k=new Di.DictionaryPropertySet;k.setValue(wc.a.Oo,this.Jk.ev(b));k.setValue(wc.a.ey,this.Jk.yA(b));return k}}Object(m.a)(FJ,"MarginsDialogActor",null,[]);class aG{constructor(b){this.B2c=(k,r,y)=>{if(1===y)return 32;k=n.AFrameworkApplication.ta;if(!k)return 32;k.Gzc();aG.$Dn(k);return 32};this.ga=b}Vb(){this.ga.pa(Jc.a.B2c,
lc.a.view,this.B2c)}static $Dn(b){const k=n.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");var r=n.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");r=Ea.a.ula(k,!r);Ea.a.$Pa(k,(!r).toString(),Ea.a.YNa);r?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Ib.d(Jc.a.B2c,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"ModernUxExperimentPreference",
string:(!r).toString()})]);b.refreshDocument(null)}}Object(m.a)(aG,"ModernUxActor",null,[]);var lM=c(1032),Qr=c(1624);class GJ{constructor(b,k){this.H9d=Rg.a.GA(1)/6;this.UE=b;this.Jd=k}get Bg(){return Al.a.instance}zAl(b){var k=Ka.App.rsf,r=k?1:3,y=n.AFrameworkApplication.numberFormat;let R=Qr.a.r_[b].Frb;var aa=Qr.a.r_[b].Drb;var ta=Qr.a.r_[b]._marginLeft;b=Qr.a.r_[b].Erb;R=k?Rg.a.vMb(R):Rg.a.mC(R);aa=k?Rg.a.vMb(aa):Rg.a.mC(aa);ta=k?Rg.a.vMb(ta):Rg.a.mC(ta);b=k?Rg.a.vMb(b):Rg.a.mC(b);k=A.a.hBa(R,
r,y);aa=A.a.hBa(aa,r,y);ta=A.a.hBa(ta,r,y);r=A.a.hBa(b,r,y);y={};y.top=k;y.bottom=aa;y.left=ta;y.right=r;return y}FGm(b){const k=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,y=WordRibbonStrings.PageMarginsLeft,R=WordRibbonStrings.PageMarginsRight;b=this.zAl(b);return[[k,b.top,r,b.bottom],[y,b.left,R,b.right]]}zUc(b){var k=Ka.App.rsf,r=k?1:3;const y=n.AFrameworkApplication.numberFormat;let R=Qr.a.Mna[b].Iqa;b=Qr.a.Mna[b].AIa;R=k?Rg.a.vMb(R):Rg.a.mC(R);b=k?Rg.a.vMb(b):Rg.a.mC(b);
k=A.a.hBa(b,r,y);r=A.a.hBa(R,r,y);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,k,r)}Vb(){const b=n.AFrameworkApplication.ya;b.gb(Wa.a.f3a,lc.a.view,Object(u.a)(this,this.MPn,"setPredefinedMarginsView"),4);b.gb(Wa.a.UPa,lc.a.view,Object(u.a)(this,this.NPn,"setPredefinedPageSizeView"),4);b.gb(Wa.a.setOrientation,lc.a.view,Object(u.a)(this,this.ePn,"setOrientationView"),4);b.gb(Wa.a.VDa,lc.a.view,Object(u.a)(this,this.VDa,"querySectionProperties"),96);b.pa(Wa.a.e3a,lc.a.view,Object(u.a)(this,
this.q7d,"setMarginView"));b.pa(Wa.a.c3a,lc.a.view,Object(u.a)(this,this.q7d,"setMarginView"));b.pa(Wa.a.Zga,lc.a.view,Object(u.a)(this,this.q7d,"setMarginView"));b.pa(Wa.a.d3a,lc.a.view,Object(u.a)(this,this.q7d,"setMarginView"));b.pa(Wa.a.rZf,lc.a.view,Object(u.a)(this,this.X0i,"setPaperSizeView"));b.pa(Wa.a.qZf,lc.a.view,Object(u.a)(this,this.X0i,"setPaperSizeView"));b.pa(Wa.a.vkb,lc.a.view,Object(u.a)(this,this.vkb,"setColumnsCount"));b.pa(Wa.a.E6d,lc.a.view,Object(u.a)(this,this.E6d,"setColumnsWidths"));
b.pa(Wa.a.D6d,lc.a.view,Object(u.a)(this,this.D6d,"setColumnsSpaces"))}MPn(b,k,r,y,R){if(1===r)return 32;if(r=this.Bg.S$(k.rk)){if(0<=R&&R<Qr.a.r_.length){k=new sf.GraphTransaction(15);k.Eb(r);k.Al=b;b=Qr.a.r_[R].Frb;y=Qr.a.r_[R].Drb;const aa=Qr.a.r_[R]._marginLeft;R=Qr.a.r_[R].Erb;this.a_d(b,y,this.Bg.yA(r))&&this.a_d(aa,R,this.Bg.ev(r))?(this.UE.e3a(r,b),this.UE.c3a(r,y),this.UE.Zga(r,aa),this.UE.d3a(r,R),this.Jd.ys(11)):this.dwa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);k.dispose()}else return 2;
return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk);return 2}a_d(b,k,r){return r>=b+k+Ka.App.Wwa}NPn(b,k,r,y,R){if(1===r)return 32;if(r=this.Bg.S$(k.rk)){if(0<=R&&R<Qr.a.Mna.length)k=new sf.GraphTransaction(15),k.Eb(r),k.Al=b,b=(y=this.Bg.BPd(r))?Qr.a.Mna[R].Iqa:Qr.a.Mna[R].AIa,R=y?Qr.a.Mna[R].AIa:Qr.a.Mna[R].Iqa,this.a_d(this.Bg.xta(r),this.Bg.Hla(r),R)&&this.a_d(this.Bg.DI(r),this.Bg.eK(r),b)?(this.UE.pZf(r,b),this.UE.oZf(r,R),this.Jd.ys(11)):
this.dwa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),k.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk);return 2}ePn(b,k,r,y,R){if(1===r)return 32;if(r=this.Bg.S$(k.rk)){k=this.Bg.BPd(r);y=new sf.GraphTransaction(15);y.Eb(r);y.Al=b;this.UE.n0i(r,R);if(R&&!k||!R&&k){b=this.Bg.ev(r);R=this.Bg.yA(r);this.UE.pZf(r,R);this.UE.oZf(r,b);b=this.Bg.Hla(r);R=this.Bg.xta(r);const aa=this.Bg.DI(r),ta=this.Bg.eK(r);k?(this.UE.e3a(r,
n.AFrameworkApplication.isRtl?aa:ta),this.UE.c3a(r,n.AFrameworkApplication.isRtl?ta:aa),this.UE.Zga(r,n.AFrameworkApplication.isRtl?R:b),this.UE.d3a(r,n.AFrameworkApplication.isRtl?b:R)):(this.UE.e3a(r,n.AFrameworkApplication.isRtl?ta:aa),this.UE.c3a(r,n.AFrameworkApplication.isRtl?aa:ta),this.UE.Zga(r,n.AFrameworkApplication.isRtl?Math.abs(b):R),this.UE.d3a(r,n.AFrameworkApplication.isRtl?R:b));this.Jd.ys(11)}y.dispose();return 32}v.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",
k.rk);return 2}vkb(b,k,r,y,R){if(1===r)return 32;r=this.Bg.S$(k.rk);if(!r)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk),2;k=new sf.GraphTransaction(15);k.Eb(r);k.Al=b;if(0>R||13<R)return 2;this.UE.bKb(r,R);k.dispose();return 32}E6d(b,k,r,y,R){if(1===r)return 32;r=this.Bg.S$(k.rk);if(!r)return v.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk),2;k=new sf.GraphTransaction(15);k.Eb(r);k.Al=b;b=R[0];
if(720>b||9360<b)return 2;this.UE.dec(r,R);k.dispose();return 32}D6d(b,k,r,y,R){if(1===r)return 32;r=this.Bg.S$(k.rk);if(!r)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk),2;k=new sf.GraphTransaction(15);k.Eb(r);k.Al=b;if(0>R||7920<R)return 2;this.UE.zKn(r,R);k.dispose();return 32}VDa(b,k,r,y,R){if(b=this.Bg.S$(k.rk))return R.marginTop=this.Bg.Hla(b),R.marginBottom=this.Bg.xta(b),R.marginLeft=this.Bg.DI(b),R.marginRight=this.Bg.eK(b),R.Oo=this.Bg.ev(b),
R.ey=this.Bg.yA(b),R.iua=this.Bg.BPd(b),R.LC=this.Bg.Yg(b),R.iW=this.Bg.oAb(b),R.OFb=this.yAl(R),R.oHb=this.oEl(R),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk);return 2}yAl(b){let k=5;for(let r=0;r<Qr.a.r_.length;r++)if(Qr.a.r_[r].Frb===b.marginTop&&Qr.a.r_[r].Drb===b.marginBottom&&Qr.a.r_[r]._marginLeft===b.marginLeft&&Qr.a.r_[r].Erb===b.marginRight){k=r;break}return k}oEl(b){let k=5;b=new lM.a(Math.min(b.Oo,b.ey),Math.max(b.Oo,b.ey));for(let r=
0;r<Qr.a.Mna.length;r++)if(this.u3m(b,Qr.a.Mna[r])){k=r;break}return k}u3m(b,k){return Gc.a.Lbi(b.AIa,Math.max(k.AIa-this.H9d,0),k.AIa+this.H9d)&&Gc.a.Lbi(b.Iqa,Math.max(k.Iqa-this.H9d,0),k.Iqa+this.H9d)}q7d(b,k,r,y,R){if(1===r)return 32;if(r=this.Bg.S$(k.rk)){k=new sf.GraphTransaction(15);k.Eb(r);switch(b){case Wa.a.e3a:this.UE.e3a(r,R);break;case Wa.a.c3a:this.UE.c3a(r,R);break;case Wa.a.Zga:this.UE.Zga(r,R);break;case Wa.a.d3a:this.UE.d3a(r,R)}this.Jd.ys(11);k.dispose();return 32}v.ULS.sendTraceTag(520618518,
3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk);return 2}X0i(b,k,r,y,R){if(1===r)return 32;if(r=this.Bg.S$(k.rk)){k=new sf.GraphTransaction(15);k.Eb(r);let aa=y=0;switch(b){case Wa.a.rZf:aa=R;this.UE.pZf(r,aa);y=this.Bg.yA(r);break;case Wa.a.qZf:y=R,this.UE.oZf(r,y),aa=this.Bg.ev(r)}this.UE.n0i(r,y<aa);this.Jd.ys(11);k.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",k.rk);return 2}dwa(b){if(!ej.a.wL){const k=new cf.StandardDialog;
k.Gd=0;k.yU(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(m.a)(GJ,"PageActor",null,[332]);class HJ{constructor(b){this.ga=b}get wc(){return this.ga}p7d(b,k){let r=0;b?1===b?r=Wa.a.Zga:2===b?r=Wa.a.d3a:3===b&&(r=Wa.a.c3a):r=Wa.a.e3a;this.wc.Xb(r,2,k)}UPa(b,k){let r=0;1===b?r=Wa.a.qZf:b||(r=Wa.a.rZf);this.wc.Xb(r,2,k)}kYf(b,k){let r=0;switch(b){case 0:r=Wa.a.vkb;break;case 1:r=Wa.a.E6d;break;case 2:r=Wa.a.D6d}this.wc.Xb(r,2,k)}}Object(m.a)(HJ,"PageCommands",null,[331]);class IJ{constructor(b,
k,r){this.t3m=(y,R,aa,ta,Ya)=>1===aa?32:(y=this.Jk.S$(R.rk))?(Ya=3===Ya.$w,this.F4.value.iwh(this.eHl(y),this.EBb(y),Ya),32):2;this.ga=b;this.F4=k;this.Jk=r}Vb(){this.ga.pa(Jc.a.swf,lc.a.view,this.t3m);this.ga.gb(Jc.a.Y1d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Jc.a.X1d,lc.a.view,Mh.a.TQ,96);this.ga.pa(Jc.a.zZd,lc.a.view,Mh.a.HF);this.ga.pa(Jc.a.yZd,lc.a.view,Mh.a.HF)}eHl(b){const k=new Di.DictionaryPropertySet;k.setValue(wc.a.Oo,this.Jk.ev(b));k.setValue(wc.a.ey,this.Jk.yA(b));return k}EBb(b){const k=new Di.DictionaryPropertySet;
k.setValue(wc.a.marginTop,Math.abs(this.Jk.Hla(b)));k.setValue(wc.a.marginBottom,Math.abs(this.Jk.xta(b)));k.setValue(wc.a.marginLeft,this.Jk.DI(b));k.setValue(wc.a.marginRight,this.Jk.eK(b));return k}}Object(m.a)(IJ,"PaperSizeDialogActor",null,[]);class ZC{constructor(b,k,r,y,R=Va.a.instance.$a("Box4.Settings.SpacingSettings")){this.ga=b;this.F4=k;this.d1=r;this.vx=y;this.wO=null;R.execute(aa=>this.wO=aa)}Vb(){this.ga.gb(Wa.a.T8b,lc.a.view,Object(u.a)(this,this.g4m,"paragraphDialogViewHandler"),
1028);this.ga.pa(Wa.a.T8b,lc.a.paragraph,Object(u.a)(this,this.f4m,"paragraphDialogHandler"));this.ga.gb(Wa.a.i2d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.Qbc,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.F1d,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.uWc,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.C3a,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.e1c,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.AZd,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.xac,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.uZd,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.Y9d,lc.a.view,
Mh.a.HF,96);this.ga.gb(Wa.a.v1a,lc.a.view,Mh.a.HF,96)}f4m(b,k,r,y,R){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=k.node;k=this.kfj(k);R=3===R.$w;this.F4.value.y_b(this.yJc(b),this.EBb(k),R,this.vx);return 32}g4m(b,k,r,y,R){b=k.view.Cb;if(!b||ZC.ag.t6b(b.Jg))return 8;if(ZC.Sg.Swa(ie.ParagraphReader.HT,b.Jg))return ZC.Kc.Zb($c.a.vf,{["Reason"]:bd.a.uN}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.ib.kb;k=this.kfj(k);R=3===R.$w;if(1===r.length&&rf.SelectionEditor.zf(r.J(0)))return r=
r.J(0).node,this.F4.value.y_b(this.yJc(r),this.EBb(k),R,this.vx),32;b=[];for(y=0;y<r.length;y++){const aa=r.J(y);(!y&&rf.SelectionEditor.qk(aa)||ie.ParagraphReader.em(aa)||rf.SelectionEditor.Dk(aa))&&b.push(aa.node)}if(!b.length)return 8;r=Array(b.length);for(y=0;y<b.length;y++)r[y]=this.yJc(b[y]);r=Jz.APropertySet.mUh(r);this.F4.value.y_b(r,this.EBb(k),R,this.vx);return 32}yJc(b){var k,r,y,R;const aa=new Di.DictionaryPropertySet;aa.setValue(td.a.Zs,ie.ParagraphReader.Lv(b));const ta=this.d1.zBa(b);
var Ya=ta.lineSpacing;aa.setValue(td.a.WZ,Ya.unit);aa.setValue(td.a.ua,Ya.value);Ya=ta.beforeSpacing;aa.setValue(td.a.IDa,Ya.unit);aa.setValue(td.a.JDa,Ya.value);Ya=ta.afterSpacing;aa.setValue(td.a.GDa,Ya.unit);aa.setValue(td.a.HDa,Ya.value);(null===(k=this.wO)||void 0===k?0:k.mua)&&aa.setValue(td.a.IUc,ta.Et);(null===(r=this.vx)||void 0===r?0:r.UCa)&&aa.setValue(Jj.a.Yh,ie.ParagraphReader.Yh(b));(null===(y=this.vx)||void 0===y?0:y.VFa)&&aa.setValue(Jj.a.DM,ie.ParagraphReader.ric(b));(null===(R=this.vx)||
void 0===R?0:R.Cfa)&&aa.setValue(Jj.a.keepTogether,ie.ParagraphReader.keepTogether(b));return aa}static get ag(){return mh.a.instance}static get Sg(){return tm.ContextSetEditor.instance}static get Kc(){return Db.a.instance}}Object(m.a)(ZC,"AParagraphDialogActor",null,[]);class JJ extends ZC{constructor(b,k,r,y,R,aa){super(b,k,r,aa);this.Jk=y;this.kp=R;this.F4h=(ta,Ya,xb,Mb,cc)=>{const jc=Ya.view.Cb,Mc=jc.ib.kb.Qa;return 1===xb&&jc.ib.kb.MC&&ie.ParagraphReader.oK(Mc.node)&&!Vh.ListReader.sr?8:Mh.a.HF(ta,
Ya,xb,Mb,cc)}}Vb(){super.Vb();this.ga.gb(Wa.a.uIb,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.iWc,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.Obc,lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.z5b,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.pMd,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.Afc,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.X9d,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.tna,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.w1a,lc.a.view,this.F4h,96);this.ga.gb(Wa.a.BZd,lc.a.view,this.F4h,96);this.ga.gb(Wa.a.a$d,lc.a.view,Mh.a.HF,96);this.ga.gb(Wa.a.j2d,
lc.a.view,Mh.a.TQ,96);this.ga.gb(Wa.a.Rbc,lc.a.view,Mh.a.TQ,96)}kfj(b){return this.Jk.S$(b.rk)}yJc(b){const k=super.yJc(b);var r=this.kp.qT(b);const y=this.kp.zF(b);k.setValue(td.a.Zaa,1);k.setValue(td.a.$aa,r.mt-y.mt);r=this.kp.cZa(b);k.setValue(td.a.pva,r.unit);k.setValue(td.a.qva,r.value);b=this.kp.Y3b(b);b.specialIndentType&&(k.setValue(td.a.gJ,b.specialIndentType),k.setValue(td.a.Eba,b.unit),k.setValue(td.a.G_,b.value));return k}EBb(b){const k=new Di.DictionaryPropertySet;k.setValue(wc.a.Oo,
this.Jk.ev(b));k.setValue(wc.a.ey,this.Jk.yA(b));k.setValue(wc.a.marginTop,Math.abs(this.Jk.Hla(b)));k.setValue(wc.a.marginBottom,Math.abs(this.Jk.xta(b)));k.setValue(wc.a.marginLeft,this.Jk.DI(b));k.setValue(wc.a.marginRight,this.Jk.eK(b));return k}}Object(m.a)(JJ,"ParagraphDialogActor",ZC,[]);class KJ extends Sys.EventArgs{constructor(b,k){super();this.node=b;this.DPd=k}}Object(m.a)(KJ,"AfterPasteEventArgs",Sys.EventArgs,[]);class LJ{constructor(b){this.due=this.kue=null;this.Y$c=b}get qDd(){return null!=
this.Kkg?this.Kkg:this.Kkg=Va.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get pdm(){this.kue||(this.kue=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate(io.a.gAh,!1));return this.kue}get xOd(){this.due||(this.due=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$(io.a.mAh));return this.due}Vbn(b){if(b&&Ag.OutlineElementReader.Nh(b.fta)&&Ag.OutlineElementReader.Nh(b.fhb)){this.pcn(b);var k=new Wh.a;for(k.ed(b.fta);k&&k.currentNode;){const r=
this.BHd(k),y=ie.ParagraphReader.nc(r);y&&ie.ParagraphReader.tbb(r)&&this.Tbn(r);const R=k.currentNode.id===b.fhb.currentNode.id;y&&(this.pdm||this.xOd)&&r.Ui.Nea(r.type).E2d(new KJ(r,R));if(R)break;xg.OutlineElementNavigator.Wr(k,!1,!1)}}}Tbn(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const k=b.Zac;b=Re.a.Uc(b,0);Ir.RNc(k)?this.qDd.K_d(b,k):this.Y$c.K_d(b,k)}pcn(b){if(b.fta.currentNode&&
b.fhb.currentNode&&b.fta.currentNode.id===b.fhb.currentNode.id){const k=this.BHd(b.fta);ie.ParagraphReader.nc(k)?this.Ybn(k,b.W5m,b.V5m):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}Ybn(b,k,r){v.ULS.shipAssertTag(590956771,307,0<=k);v.ULS.shipAssertTag(590958592,307,0<=r);var y=ie.ParagraphReader.text(b);if(""!==y){var R=Re.a.createTextRange(b,k,r);R=sh.HyperlinkReader.aD(R,!1);if(1===R.length){const aa=R[0];R=y.substring(k,r).trim();y=y.substring(aa.cpBegin,
aa.cpEnd).trim();k=R===y;R=Re.a.createTextRange(b,aa.cpBegin,aa.cpEnd);if(aa.hyperlink&&k&&!sh.HyperlinkReader.oNa(y))b=aa.hyperlink.url;else if(k)b=y;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}Ir.RNc(b)?this.qDd.BMa(R,b,!1):this.Y$c.BMa(R,b,!1)}else v.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",
R.length)}}BHd(b){const k=xg.OutlineElementNavigator.Fe(b);xg.OutlineElementNavigator.Xd(b);return k}}Object(m.a)(LJ,"PastedContentsProcessorPostMergeAfterPaste",null,[330]);class bG extends Tu{constructor(b,k,r,y,R,aa,ta,Ya){super(y);this.qGe=7;this.rB=this.onc=null;this.Mse=0;this.Jse=b;this.Mk=k;this.Zm=r;this.me=R;this.rwj=ta;this.dUa=Ya;this.q1=this.me.UNa("UserAction","WordIgnoreAll")}s_f(b){this.Jse.Toi();this.onc=this.Zm.Ala(b);this.dUa.Y7h(this.onc,null,!1);return this.Jse.Mfj(this.onc)?
(this.q1.start(),this.rB=new sf.GraphTransaction(15),this.rB.Eb(b.node),!0):!1}V0d(b){this.bIb(b.node);return!0}FVc(b){this.bIb(b);return!0}W0d(b){this.bIb(b.node)}j5f(b){this.rB.dispose();this.onc.errorDetails.fmb(b.actionId);this.q1.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.Mse,this.q1.ri,this.onc.errorDetails.proofingType));return!0}yfc(b,k){if(super.yfc(b,k))return!0;b=b.role;return 9===
b||10===b||13===b||7===b||8===b}HYh(b){if(b&&b.type!==this.qGe){const k=Wd.GraphIterator.Za(b);return k.Ab(this.qGe)?k.kd(this.qGe):b}return b}wgm(b,k){return this.Jse.r8d(k.errorDetails)&&!this.Mk.naa(Re.a.createTextRange(b,k.begin,k.end))}bIb(b){if(b){var k=this.Zm.q2(b,r=>this.wgm(b,r));this.rwj?this.Zm.Qjb(b,k,!0):0<k.length&&(b.uk(4,!0),this.Zm.tGb(b));this.Mse+=k.length}}}Object(m.a)(bG,"IgnoreAllCallbackSteps",Tu,[]);class MJ{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc){this.sWc=(fd,Td,ne,
ye,ff)=>{if(1===ne)return 32;fd=this.PH.OYa(Td.view.Cb.Jg);if(fd=yh.a.qg(fd))ff[cl.a.LabelText]=fd.displayName;return 32};this.cma=(fd,Td,ne,ye,ff,Gd)=>{const oe=new bG(this.wIj,this.Mk,this.Zm,this.He,this.me,this.vV,0,this.dUa);return new No(fd,Td,ne,ye,ff,Gd,oe,this.ga,this.hb,this.He,"IgnoreAllOperation")};this.Nyb=(fd,Td,ne,ye,ff,Gd)=>{const oe=new bG(this.mDj,this.Mk,this.Zm,this.He,this.me,this.vV,1,this.dUa);return new No(fd,Td,ne,ye,ff,Gd,oe,this.ga,this.hb,this.He,"DoNotCheckThisCritiqueType")};
this.ga=b;this.Mk=k;this.hb=r;this.He=y;this.Zm=R;this.PH=aa;this.me=ta;this.wIj=Ya;this.mDj=xb;this.XRb=Mb.UOc;this.vV=Mb;this.dUa=cc;this.Lue=jc;this.M5a=Mc}Vb(){this.Lue&&(fa.KA()?this.ga.gb(Wa.a.cma,lc.a.Wc,this.g1l.bind(this),1028):this.ga.vS(Wa.a.cma,lc.a.view,this.cma,1028));this.XRb&&this.ga.vS(Wa.a.Nyb,lc.a.view,this.Nyb,1028);this.ga.gb(Jc.a.sWc,lc.a.view,this.sWc,96)}g1l(b,k,r,y,R){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.M5a.zkf(R?
R:k,null,hb.b.IgnoreAll);return 32}}Object(m.a)(MJ,"ProofingActor",null,[]);var mA=c(1172),mM=c(1626);class nA{constructor(b,k,r,y,R,aa,ta,Ya,xb){this.Wp=this.UIa=this.Rmd=this.Smd=null;this.AD=this.$q=this.Gp=0;this.v7a=this.u7a=!1;this.w9=this.RRa=this.QRa=this.PRa=this.B6a=0;this.Sld=null;this.ica=this.wV=this.rq=this.$O=0;this.$l=null;this.vqb=0;this.tj=r;this._image=b;this._context=k;this.wed=!1;(b=nA.qh.pu(k.node))&&b.wg(wc.a.iuf)&&(this.wed=!0);this.lpc=y.$("ImageDataURLPresentationIsEnabled");
this.pSj=y.$("WordOartPostRequestIsEnabled");this.Oa=y;this.Oq=R;this.me=aa;this.Jd=ta;this.xm=Ya;this.tJ=xb;this.q5l()}q5l(){this.Wp="";this.Gp=Pd.ImageReader.mE(this._image);this.$q=Pd.ImageReader.AF(this._image);this.w9=Pd.ImageReader.seb(this._image);this.AD=Pd.ImageReader.AZ(this._image);this.u7a=Pd.ImageReader.lGd(this._image);this.v7a=Pd.ImageReader.LAb(this._image);this.B6a=Math.max(Pd.ImageReader.Fla(this._image),0);this.PRa=Math.max(Pd.ImageReader.Cla(this._image),0);this.QRa=Math.max(Pd.ImageReader.Dla(this._image),
0);this.RRa=Math.max(Pd.ImageReader.Ela(this._image),0);this.$l=Ra.a.nil;this.UIa=null;this.vqb=Pd.ImageReader.ul(this._image)}rtd(b,k){return(new mM.a(this.Oq,this.vqb,this.Oa,this.Gp,this.$q,this.AD,this.w9,this.B6a,this.PRa,this.QRa,this.RRa,this.u7a,this.v7a,this.wed)).build(this._context.node,this._image,b,k)}resize(b,k){this.Wp="Resize";this.m$d();Ee.a.mark(this.G3b());this.Gp=b;this.$q=k;this.sendMessage(!1,Object(u.a)(this,this.t1a,"onRequestSuccess"))}Xv(b){this.Wp="Styles";this.m$d();Ee.a.mark(this.G3b());
this.w9=b;this.sendMessage(!1,Object(u.a)(this,this.t1a,"onRequestSuccess"))}FPn(b,k,r){this.Wp="Rotation";this.m$d();this.AD=b;this.u7a=k;this.v7a=r;this.sendMessage(!1,Object(u.a)(this,this.t1a,"onRequestSuccess"))}EPn(b,k){this.Wp="SwordRequestManager";this.m$d();this.UIa=b;this.AD=k.angle;this.Gp=k.width;this.$q=k.height;this.w9=k.styleId;this.B6a=k.top;this.PRa=k.bottom;this.QRa=k.left;this.RRa=k.right;this.$l=k.e2;this.sendMessage(!1,Object(u.a)(this,this.t1a,"onRequestSuccess"))}sendMessage(b,
k){if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Hbb(r);const y=Pd.ImageReader.Nla(this._image,this.Oa,this.Oq);y?mA.a.Ikb(this._image,y,4):this._image.setValue(Gh.a.QDd,!0);r.dispose()}this.u9i(b);Ee.a.mark(this.G3b());b=new pa.QueryStringBuilder(this.rtd(b,!0));this.lpc&&b.Ke(Og.a.kyh,"true");this.pSj?(r=new pa.QueryStringBuilder("WordOart.ashx"),n.AFrameworkApplication.af.Mj(r.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},
!0,0,k,Object(u.a)(this,this.HIf,"onRequestFail"),null)):n.AFrameworkApplication.af.Mj(b.toString(),1,"",null,!0,0,k,Object(u.a)(this,this.HIf,"onRequestFail"),null)}Hbb(b){b=this.$l&&this.$l!==Ra.a.nil?new sf.GraphTransaction(7,Wa.a.imageRotate):new sf.GraphTransaction(15);b.Eb(this._context.node);return b}get Wqj(){const b=new sf.GraphTransaction(3);b.Eb(this._context.node);return b}b5d(){this.pFc();this.PAd();const b=this.Wqj;var k=Pd.ImageReader.jBa(this._image,this._context.node.Mc,this.Oa,this.Oq);
this._image.setValue(Gh.a.QDd,!1);this._image.setValue(td.a.PLc,k);this._image.setValue(td.a.jK,-1);this._image.setValue(Gh.a.z3,1);k=Pd.ImageReader.Nla(this._image,this.Oa,this.Oq);this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(td.a.d0d),this._image.removeProperty(td.a.c0d),k&&mA.a.Ikb(this._image,k,3));b.dispose();nA.Bp();this.UIa&&this.UIa()}HIf(b){if(5===this.vqb){const k=Object.assign(new Xa.a,{extendedProperties:new Map});k.extendedProperties.set("status",
b.data.status.toString());k.extendedProperties.set("httpStatus",b.data.Df.toString());Ga.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,k)}v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:b.data.status,["HttpStatus"]:b.data.Df,["Id"]:b.data.id,["ResponseData"]:b.data.Ie},YC.a[this.vqb]);this.b5d()}u9i(b){this.me&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Smd=this.me.jg("WebServiceCall",
b))}pFc(){this.Smd&&(this.Smd.stop(),this.Smd=null)}m$d(){if(this.me){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Wp,YC.a[this.vqb]);this.Rmd=this.me.jg("WebServiceCall",b)}}PAd(){this.Rmd&&(this.Rmd.stop(),this.Rmd=null)}static get qh(){return lk.PageNavigator.instance}static Bp(){const b=new cf.StandardDialog;b.Gd=0;b.my(pj.a.i7m,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Ka.App.xa&&Ka.App.xa.updateCommandUI()}}Object(m.a)(nA,
"RenderedImageEditOperation",null,[342]);var cG=c(317),aF=c(529);class NJ extends nA{constructor(b,k,r,y,R,aa,ta,Ya,xb){super(b,k,r,y,R,aa,ta,Ya,xb)}sendMessage(b,k){Object(cG.a)(()=>{let r;r=this.Hbb(r);this._image.setValue(Gh.a.z3,0);r.dispose()});this.u9i(b);Ee.a.mark(this.G3b());b=new pa.QueryStringBuilder("WordOart.ashx");this.PJg=this.Beb(!0,!1);b=new aF.a(b.toString(),2,this.Beb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,
null,null,null,null,null,["Content-Type"],null,"text");n.AFrameworkApplication.af.send(b).bEa(k,r=>{this.HIf(r)})}t1a(b){try{const k=JSON.parse(b.data.yPa);this.tHj=k[Og.a.uKc];this.I0j=k[Og.a.width];this.LHj=k[Og.a.height];this.Vvg=k[Og.a.Qyc];this.$mc=Array(4);this.$mc[0]=k[Og.a.tcb];this.$mc[1]=k[Og.a.ucb];this.$mc[2]=k[Og.a.vcb];this.$mc[3]=k[Og.a.scb];this.cOg=void 0!==k[Og.a.i8b]?"true"===k[Og.a.i8b].toLowerCase():null;Object(cG.a)(()=>{this.R3c();this._context.node.Di().contentReplicator.forceOutbound(()=>
{this.zbl()},null,null)})}catch(k){v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",k.message,this.Wp,Pd.ImageReader.ul(this._image)),this.b5d()}}QXd(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}R3c(){let b;b=this.Hbb(b);this._image.setValue(Jj.a.afa,this.tHj);this.Vvg&&this._image.setValue(Jj.a.Ird,this.Vvg);this._image.setValue(Jj.a.IBa,this.I0j);this._image.setValue(Jj.a.JBa,this.LHj);
this._image.setValue(Jj.a.oZa,this.$mc);this.CIj&&this._image.setValue(td.a.o5b,this.CIj);mA.a.Ikb(this._image,this.PJg,3);this._image.setValue(wc.a.qcb,this.PJg);this.cOg?this._image.setValue(Jj.a.fgb,this.cOg):this._image.removeProperty(Jj.a.fgb);this.vxk();b.dispose()}vxk(){this._image.removeProperty(td.a.gu);this._image.removeProperty(td.a.jK);this._image.removeProperty(td.a.d0d);this._image.removeProperty(td.a.c0d)}zbl(){this.tJ.AEa(this._context);if(this.$l&&this.$l!==Ra.a.nil){const b=this._context.node.Di(),
k=new G.a(this.$l,1);this.xm.MZb(b,k)}this.Jd.ys(13);this.pFc();this.PAd();Ee.a.mark(this.F3b());Object(cG.a)(()=>{let b;b=this.Hbb(b);this._image.setValue(Gh.a.z3,1);b.dispose()});this.UIa&&this.UIa()}Beb(b,k){b=new pa.QueryStringBuilder(this.rtd(b,k));b.Ke(Og.a.dMd,"true");return b.toString()}G3b(){return 51511}F3b(){return 51512}}Object(m.a)(NJ,"RenderedGraphicEditOperation",nA,[]);class OJ extends nA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb){super(b,k,r,y,R,aa,ta,Ya,xb);this.UEg=null;this.QXd=cc=>
{const jc=this.rtd(!0,!1);let Mc;Mc=this.Hbb(Mc);this._image.setValue(wc.a.Jrd,this.Sld);var fd=Va.a.instance.Pa("Box4.IFeatureHelper");fd&&fd.isFeatureEnabled(48)&&this._image.setValue(wc.a.WBd,this.UEg);this.Oa.$("WordEditorImageRotateIsEnabled")&&this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.tj.a7d(this._image,this.AD,this.u7a,this.v7a);const Td=Pd.ImageReader.Nla(this._image,this.Oa,this.Oq),ne=()=>{Td&&mA.a.Ikb(this._image,Td,3);mA.a.Ikb(this._image,jc,3);this.tj.Z6d(this._image,
Rg.a.tF(this.$O),Rg.a.tF(this.wV),Rg.a.tF(this.rq),Rg.a.tF(this.ica));this._image.setValue(wc.a.qcb,jc);Pd.ImageReader.Xx(this._image)||this._image.setValue(wc.a.$Ba,1);this.tj.K6d(this._image,this.Gp,this.$q);this.Oa.$("WordEditorImageRotateIsEnabled")&&!this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.tj.a7d(this._image,this.AD,this.u7a,this.v7a);2===cc.data.status&&Pd.ImageReader.RZ(cc.data.Ie)&&(this._image.setValue(td.a.gu,cc.data.Ie),cc.data.request&&this._image.setValue(td.a.o5b,
mA.a.ZFc("POST"===cc.data.request.get_httpVerb()?cc.data.request.get_body():cc.data.request.get_url())));this.UIa&&this.UIa();this.tJ.AEa(this._context);if(this.$l&&this.$l!==Ra.a.nil){const ye=this._context.node.Di(),ff=new G.a(this.$l,1);this.xm.MZb(ye,ff)}this.Jd.ys(13);this.pFc();this.PAd();Ee.a.mark(this.F3b())};if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.$l&&this.$l!==Ra.a.nil&&(fd=this._context.node.Di())&&fd.contentReplicator){Mc.dispose();fd.contentReplicator.forceOutbound(()=>
{let ye;ye=this.Hbb(ye);ne();ye.dispose()},null,null);return}ne();Mc.dispose()};this.REe=Mb}G3b(){return 51511}F3b(){return 51512}t1a(b){try{var k=JSON.parse(b.data.Ie);const R=Sys.Net.XMLDOM("string"===typeof k[Og.a.och]?k[Og.a.och]:null);this.Sld="string"===typeof k[Og.a.Krd]?k[Og.a.Krd]:null;const aa=Va.a.instance.Pa("Box4.IFeatureHelper");aa&&aa.isFeatureEnabled(48)&&(this.UEg="string"===typeof k[Og.a.A1b]?k[Og.a.A1b]:null);X.a.Ak&&R.setProperty("SelectionNamespaces","xmlns:mc='"+ed.a.Sbk+"'");
const ta=R.selectSingleNode("/mc:AlternateContent");if(!ta)throw Ik.a.argument("Alternate content element could not be retrieved!");const Ya=ta.firstChild;if(!Ya)throw Ik.a.argument("Alternate content choice element could not be retrieved!");const xb=Ya.firstChild;if(!xb)throw Ik.a.argument("Drawing element could not be retrieved!");var r=xb.firstChild;if(!r)throw Ik.a.argument("Inline element could not be retrieved!");k=b=null;const Mb=RegExp("effectExtent"),cc=RegExp("extent");for(let Mc of r.childNodes)-1!==
Mc.nodeName.search(Mb)&&(b=Mc),-1!==Mc.nodeName.search(cc)&&(k=Mc);if(!b||!k)throw Ik.a.argument("Effect extent or extent could not be retrieved!");this.$O=parseInt(b.selectSingleNode("@l").text);this.wV=parseInt(b.selectSingleNode("@r").text);this.rq=parseInt(b.selectSingleNode("@t").text);this.ica=parseInt(b.selectSingleNode("@b").text);const jc=dd.c(this.AD);if(45<=jc&&135>=jc||225<=jc&&315>=jc){const Mc=parseInt(k.selectSingleNode("@cx").text);var y=parseInt(k.selectSingleNode("@cy").text);r=
Mc/2;y/=2;this.$O-=r-y;this.wV+=r-y;this.rq-=y-r;this.ica+=y-r}}catch(R){v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",R.message,this.Wp,YC.a[this.REe]);this.b5d();return}this.sendMessage(!0,this.QXd)}}Object(m.a)(OJ,"RenderedDrawingEditOperation",nA,[]);class PJ extends nA{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){super(b,k,r,y,R,aa,ta,Ya,xb);this.i9=null;this.QXd=jc=>{const Mc=this.rtd(!0,!1);let fd;fd=this.Hbb(fd);this._image.setValue(wc.a.CHb,
this.Sld);const Td=Pd.ImageReader.Nla(this._image,this.Oa,this.Oq),ne=()=>{Td&&mA.a.Ikb(this._image,Td,3);mA.a.Ikb(this._image,Mc,3);this.tj.Z6d(this._image,Rg.a.tF(this.$O),Rg.a.tF(this.wV),Rg.a.tF(this.rq),Rg.a.tF(this.ica));this._image.setValue(wc.a.qcb,Mc);Pd.ImageReader.Xx(this._image)||this._image.setValue(wc.a.$Ba,1);this._image.setValue(wc.a.bVc,this.w9);this._image.setValue(td.a.V1l,-1);this.Ic.isFeatureEnabled(94)&&Pd.ImageReader.L4b(this._image)&&this.wo.X3d(this._image);this._image.setValue(Gh.a.QDd,
!1);this.tj.K6d(this._image,this.Gp,this.$q);this.Oa.$("WordEditorImageRotateIsEnabled")&&this.tj.a7d(this._image,this.AD,this.u7a,this.v7a);this.Oa.$("WordEditorImageCropIsEnabled")&&this.tj.RYf(this._image,this.B6a,this.PRa,this.QRa,this.RRa);2===jc.data.status&&Pd.ImageReader.RZ(jc.data.Ie)&&(this._image.setValue(td.a.gu,jc.data.Ie),jc.data.request&&this._image.setValue(td.a.o5b,mA.a.ZFc("POST"===jc.data.request.get_httpVerb()?jc.data.request.get_body():jc.data.request.get_url())));this.UIa&&this.UIa();
this.tJ.AEa(this._context);if(this.$l&&this.$l!==Ra.a.nil){const ye=this._context.node.Di(),ff=new G.a(this.$l,1);this.xm.MZb(ye,ff)}this.Jd.ys(13);this.pFc();this.PAd();Ee.a.mark(this.F3b())};if(this.Oa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.$l&&this.$l!==Ra.a.nil){const ye=this._context.node.Di();if(ye&&ye.contentReplicator){fd.dispose();ye.contentReplicator.forceOutbound(()=>{let ff;ff=this.Hbb(ff);ne();ff.dispose()},null,null);return}}ne();fd.dispose()};this.REe=Mb;this.Ic=
cc}G3b(){return 7988}F3b(){return 7989}get wo(){this.i9||(this.i9=new DJ.a);return this.i9}t1a(b){try{const k=b.data.Kga;this.Sld=b.data.Ie;X.a.Ak&&k.setProperty("SelectionNamespaces","xmlns:pic='"+ed.a.g7m+"'");const r=k.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.$O=parseInt(r.selectSingleNode("@l").text);this.wV=parseInt(r.selectSingleNode("@r").text);this.rq=parseInt(r.selectSingleNode("@t").text);this.ica=parseInt(r.selectSingleNode("@b").text)}catch(k){b=Object.assign(new Xa.a,
{extendedProperties:new Map});b.extendedProperties.set("exception",k.message);b.extendedProperties.set("operation",this.Wp);Ga.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",k.message,this.Wp,YC.a[this.REe]);this.b5d();return}this.pFc();Ee.a.mark(this.F3b());this.sendMessage(!0,this.QXd)}}Object(m.a)(PJ,"RenderedPictureEditOperation",
nA,[]);class QJ{constructor(b,k,r,y,R,aa,ta,Ya){this.tj=b;this.Oa=k;this.Oq=r;this.me=y;this.Jd=R;this.xm=aa;this.tJ=ta;this.Ic=Ya}create(b,k){const r=Pd.ImageReader.ul(b);return jl.App.instance.eua(r)?new NJ(b,k,this.tj,this.Oa,this.Oq,this.me,this.Jd,this.xm,this.tJ):10===r||11===r||48===r||4===r?new OJ(b,k,this.tj,this.Oa,this.Oq,this.me,this.Jd,this.xm,this.tJ,r):5===r?new PJ(b,k,this.tj,this.Oa,this.Oq,this.me,this.Jd,this.xm,this.tJ,r,this.Ic):null}}Object(m.a)(QJ,"Factory",null,[329]);class RJ{constructor(){this.AEc=
b=>{const k=window.performance.now(),r=mi.a.Vw();if(r){b=TF.a(b.customData,r);b=Pm.a.Lr(b,r);var y=0,R=new sf.GraphTransaction(3);try{for(R.Eb(r);b.moveNext();){if(!ie.ParagraphReader.yh(b.iterator))continue;const aa=b.currentNode;this.TCh(aa)&&(y++,aa.uk(4,!0));const ta=window.performance.now()-k;if(2500<y||100<ta){this.rtb=null;this.MWc(aa);break}}}finally{R&&R.dispose()}}else Od.b(570450380,3018,10,"PageContentNode not found")};this.rtb=null}Oai(){const b=mi.a.Vw();this.YWc(b);this.MWc(null)}MWc(b){this.rtb&&
(n.AFrameworkApplication.uc.Ye(this.rtb),this.rtb=null);this.rtb=new nd.a(1,1,1,this.AEc,198);this.rtb.customData=b;n.AFrameworkApplication.uc.fc(this.rtb)}YWc(b){const k=TF.b(b);if(k){var r=new sf.GraphTransaction(3);try{for(r.Eb(b);k.moveNext();){if(!ie.ParagraphReader.yh(k.iterator))continue;const y=k.currentNode;this.TCh(y)&&y.uk(4,!0)}}finally{r&&r.dispose()}}}TCh(b){b=b.xD;for(let k of b)if(k.T6b)return 0<k.BLb;return!1}}Object(m.a)(RJ,"RenderParagraphsContainingTabs",null,[]);class SJ{constructor(b,
k){this.Fne=!0;this.Vlc=null;this.L_k=()=>{this.Vlc=null;this.Fne=!0;this.VIa&&this.VIa.VQa(!Ka.App.iK())};this.E4a=(r,y,R)=>{if(1===R)return 32;2===R&&(r=!1,Ka.App.iK()?this.Fne=!1:this.Fne?r=!0:this.upo(),this.VIa&&this.VIa.VQa(r));return 32};this.ga=b;this.VIa=k}Vb(){this.ga.gb(ib.a.E4a,lc.a.application,this.E4a,1124)}upo(){this.Vlc?n.AFrameworkApplication.uc.Ye(this.Vlc):this.Vlc=new nd.a(4,1,5E3,this.L_k);n.AFrameworkApplication.uc.fc(this.Vlc)}}Object(m.a)(SJ,"SaveStatusActor",null,[]);class TJ{constructor(b,
k){this.Uvb=(r,y,R)=>{r=mi.a.nEb(y);if(1===R||r)return r?8:32;this.F4.value.AJk(y);return 32};this.createNewStyle=(r,y,R)=>{r=mi.a.nEb(y);if(1===R||r)return r?8:32;this.F4.value.jNk(y,this.ga);return 32};this.I3e=(r,y,R)=>{r=mi.a.nEb(y)||this.bVn();if(1===R||r)return r?8:32;this.F4.value.I3e(y);return 32};this.ga=b;this.F4=k}get xWf(){return null!=this.erg?this.erg:this.erg=Va.a.instance.Pa("Box4.ISaveStyleManager")}get Ayn(){return this.zyn||(this.zyn=Va.a.instance.Pa("Box4.IResetAndDeleteStyleManager"))}get Hj(){return null!=
this.Wrg?this.Wrg:this.Wrg=Va.a.instance.Pa("Box4.Styles.StyleSettings")}get oc(){return null!=this.Aug?this.Aug:this.Aug=Va.a.instance.resolve("Box4.Styles.IWACStyleReader")}Vb(){this.ga.gb(Wa.a.Uvb,lc.a.view,this.Uvb,1028);this.ga.gb(Wa.a.createNewStyle,lc.a.view,this.createNewStyle,4);this.ga.gb(Wa.a.Cyb,lc.a.view,this.I3e,4);this.ga.gb(Wa.a.wWf,lc.a.view,this.xEn.bind(this),4);this.ga.gb(Wa.a.SUf,lc.a.view,this.TUf.bind(this),4);this.ga.gb(Wa.a.E3e,lc.a.view,this.UUk.bind(this),4)}xEn(b,k,r){b=
mi.a.nEb(k)||this.gVn();if(1===r||b)return b?8:32;this.xWf.wEn();return 32}TUf(b,k,r){b=mi.a.nEb(k)||this.eVn();if(1===r||b)return b?8:32;this.Ayn.TUf();return 32}UUk(b,k,r){b=mi.a.nEb(k)||this.aVn();if(1===r||b)return b?8:32;this.F4.value.TUk();return 32}aVn(){return"{}"===NC.a.Lmb?!0:!1}eVn(){if(0==NC.a.d3.size)return!0;var b=NC.a.d3;const k=this.oc.Np();let r=0;for(let y of b.values())b=k.wh(y),this.oc.oe(b,k)||r++;return 0==r?!0:!1}gVn(){var b=NC.a.Lmb,k=NC.a.d3;const r=this.oc.Np();if(0==k.size)return!0;
if(!({Iv:b}=x.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=k.size)return!1;for(let R of k.values()){k=r.wh(R);var y=b[R];if(null==y)return!1;if(y=mi.a.vId(y)){if(this.Hj.dX||(k=mi.a.cIc(k,r)),mi.a.wOc(k,y))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}bVn(){var b=mi.a.Vw();if(!b)return Od.b(577368330,3018,15,"PageContentNode is null"),
!0;b=(new sw.WACStyleSet).ZN(b);const k=b.yN;for(let y=0;y<k;y++){var r=b.Pla(y);if(this.oc.isHidden(r)||!this.oc.oe(r,b))continue;const R=this.oc.Xw(r);if(2===R||1===R)if(!r.hasProperty(wc.a.Gc)||2===R)if(r=r.ia(wc.a.hF,null),!(r&&0<r.length))return!1}return!0}}Object(m.a)(TJ,"StylesActor",null,[]);class bF{constructor(b){this.aae=(k,r,y)=>{k=n.AFrameworkApplication.ta;if(1===y)return 1!==k.mode||Ae.SessionStatusManager.instance.Tj?2:32;Ga.Health.instance.recordKpiUsage("SwitchToClassicViewMode",
0,bF.LB,null);const R={};R[H.a.jmf]=n.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName");R[H.a.v7h]="true";n.AFrameworkApplication.gQ().execute(aa=>{aa.sendMessage(E.a.K5n,R)});return n.AFrameworkApplication.ya.processAction(Wa.a.IIb,2)};this.ga=b}Vb(){this.ga.pa(Jc.a.aae,lc.a.view,this.aae)}}bF.LB="wwaengidc";Object(m.a)(bF,"SwitchToClassicViewModeActor",null,[]);class UJ{constructor(b,k,r,y,R,aa,ta,Ya,xb){this.angle=r;this.styleId=y;this.width=b;this.height=k;this.top=R;this.bottom=
aa;this.left=ta;this.right=Ya;this.e2=xb}}Object(m.a)(UJ,"SWordData",null,[]);class VJ{constructor(b,k){this.el=this.QR=this.Vp=null;this.eFe=this.dTb=!1;this.$O=this.wV=this.ica=this.rq=this.w9=this.$q=this.Gp=this.AD=0;this.$l=null;this.l7=()=>{this.eFe=!1;this.dTb&&this.tFc()};this.sm=b;this.Buc=k;this.v9h()}v9h(){this.wV=this.$O=this.ica=this.rq=this.w9=this.$q=this.Gp=this.AD=-1;this.$l=Ra.a.nil}tFc(){this.eFe||(this.yso(),this.yOk(),this.dTb=!1)}yOk(){this.el=new UJ(this.Gp,this.$q,this.AD,
this.w9,this.rq,this.ica,this.$O,this.wV,this.$l);this.Buc.create(this.QR,this.Vp).EPn(this.l7,this.el);this.eFe=!0;let b;Object(Jb.a)(3,this.QR)?b=YC.a[Pd.ImageReader.ul(this.QR)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");v.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Gp,this.$q,this.AD,this.w9,this.rq,this.ica,this.$O,this.wV,b);this.v9h()}yso(){this.Gp=-1!==this.Gp?this.Gp:this.QR.ia(td.a.ZBa,-1);this.$q=-1!==this.$q?this.$q:this.QR.ia(td.a.YBa,-1);this.Gp=-1!==this.Gp?this.Gp:this.sm.mE(this.QR);this.$q=-1!==this.$q?this.$q:this.sm.AF(this.QR);this.AD=-1!==this.AD?this.AD:this.sm.AZ(this.QR);this.w9=-1!==this.w9?this.w9:this.sm.seb(this.QR);this.rq=-1!==this.rq?this.rq:this.sm.Fla(this.QR);this.ica=-1!==this.ica?this.ica:this.sm.Cla(this.QR);this.$O=-1!==
this.$O?this.$O:this.sm.Dla(this.QR);this.wV=-1!==this.wV?this.wV:this.sm.Ela(this.QR)}Vfn(b,k,r,y){this.Vp=b;this.AD=r;this.dTb=!0;this.QR=k;this.$l=y;this.tFc()}Ufn(b,k,r,y,R){this.Vp=b;this.dTb=!0;this.QR=k;this.$l=R;this.QR.setValue(td.a.ZBa,r);this.QR.setValue(td.a.YBa,y);this.tFc()}Zfn(b,k,r){this.Vp=b;this.dTb=!0;this.QR=k;this.w9=r;this.tFc()}Ofn(b,k,r,y,R,aa){this.Vp=b;this.rq=r;this.ica=y;this.$O=R;this.wV=aa;this.dTb=!0;this.QR=k;k=b=0;({width:b,height:k}=this.sm.KAb(this.QR));this.Gp=
b-(R+aa)/1E5*b;this.$q=k-(r+y)/1E5*k;this.tFc()}}Object(m.a)(VJ,"SWordRequestManager",null,[269]);class WD{constructor(b,k,r,y=null,R=null,aa=null,ta=null,Ya=null,xb=null,Mb=null){this.xm=null;this.k6g=!1;this.b8n=(cc,jc,Mc,fd,Td)=>{if(1===Mc)return 32;const ne=cc===Wa.a.F_f;if(!jc.view.ye)return 2;const ye=jc.view,ff=ye.Cb,Gd=ff.Jg;if(!Gd||WD.ag.mZ(Gd))return 2;if(this.Km&&this.Km.instance&&this.Km.instance.KT(Gd))return 4;cc=null;var oe=Kd.ActionManager.Yua;let ze=!1;var ug=rf.SelectionEditor.zf(Gd);
if(Gd.zw){if(ff.ib.JI&&(oe=Gd.getContext(0),cc=new Wd.GraphIterator,cc.set(oe.node),cc.ro(),oe=ne?Wa.a.VWf:Wa.a.W5d),oe=this.yJe.ran(oe),oe===Kd.ActionManager.Yua){var Yf=WD.Sg.AS(Gd,16);Yf?(ne&&(oe=Wa.a.UVd),cc=new Wd.GraphIterator,cc.set(Yf.node),cc.rd()):oe=ne?Wa.a.XF:Wa.a.FN}}else if(Gd.Xk)if(cc=new Wd.GraphIterator,cc.set(Gd.node),rf.SelectionEditor.Pt(cc),Nf.OutlineReader.cNa(Gd))oe=ne?Wa.a.VWf:Wa.a.W5d;else{if(this.Hse&&this.Hse.YWn(Gd))return this.Hse.m_c(Gd,ye.Sb,ne),32;oe=ne?this.yJe.OSl(cc,
Gd,oe,jc):this.yJe.NSl(cc,Gd,oe,jc);Ag.OutlineElementReader.Nh(cc)&&Gd.contextId===lc.a.Wc&&(ze=Ag.OutlineElementReader.Uz(cc,Gd,!1));Yf=Vh.ListReader.ei(cc)&&ze;oe!==Kd.ActionManager.Yua||Ei.TableCellReader.Mma(cc)||Yf||(this.k6g||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.k6g=!0),n.AFrameworkApplication.ya.processAction(Wa.a.P9h,2),this.n$h(jc))}else return 2;if(!ne&&oe===Kd.ActionManager.Yua&&Ei.TableCellReader.Mma(cc))if(bf.returnToCell(cc),Ei.TableCellReader.ZMa(cc)||
Si.TableReader.Rei(cc)&&Ei.TableCellReader.zfi(cc)){if(oe=this.U1j(),!oe)return 2}else oe=Wa.a.jui;if(oe===Kd.ActionManager.Yua)return 2;switch(oe){case Wa.a.jui:case Wa.a.UVd:fd=oe===Wa.a.UVd;ug&&this.r0&&this.dY&&(ug=this.r0.G9e(Gd,-1,!0,tb.a.px))&&this.dY.BWi(ug);Mc=32;bf.returnToCell(cc);bf.moveToNextOrPreviousCell(cc,fd)&&(ug=!0,fd=!1,Nf.OutlineReader.qlf(cc)||(af.OutlineNavigator.jBf(cc,!1),xg.OutlineElementNavigator.Fe(cc),ie.ParagraphReader.Cu(cc.currentNode)&&(ug=!1,ie.ParagraphReader.textLength(cc.currentNode)||
(fd=!0)),fd||bf.returnToCell(cc)),fd?cc=Ke.SelectionFactory.xe(cc.currentNode,0):(cc=Ke.SelectionFactory.Sq(cc.currentNode),!ug&&rf.SelectionEditor.qk(cc.Tc)&&(ug=cc.toArray(),Array.removeAt(ug,ug.length-1),cc=new lj.Selection(ug,cc.Uf))),ff.setSelection(cc));break;case Wa.a.VWf:case Wa.a.W5d:oe===Wa.a.W5d?af.OutlineNavigator.Kti(cc,!1):af.OutlineNavigator.Kti(cc,!0);ff.setSelection(Ke.SelectionFactory.Sq(cc.currentNode));Mc=32;break;case Wa.a.i1c:Mc=n.AFrameworkApplication.ya.Vf(jc,oe,Mc,!0,fd,Td);
break;default:if(Mc=n.AFrameworkApplication.ya.Vf(jc,oe,Mc,!0,fd,Td),!ze&&ug&&(oe===Wa.a.XF||oe===Wa.a.FN)){const Aj=rf.SelectionEditor.Oza(ff.ib.kb).y;Ka.App.jcc(()=>{this.ZLm(ff,ye,Aj)})}}32===Mc&&jc.view.ye&&this.zi.KF();return Mc};this.Cja=b;this.yJe=k;this.Km=r;this.r0=y;this.dY=R;this.BJe=aa;this.iGa=ta;this.Ic=Ya;this.Hc=xb;this.Hse=Mb}get zi(){return this.xm||(this.xm=this.Cja())}Vb(){const b=n.AFrameworkApplication.ya,k=this.b8n;b.gb(Wa.a.tab,lc.a.view,k,1124);b.gb(Wa.a.F_f,lc.a.view,k,1124);
b.pa(Wa.a.P9h,lc.a.view,Kd.ActionManager.Of)}ZLm(b,k,r){if(b&&k){var y=b.ib.kb;rf.SelectionEditor.Oza(y).y<r?(k=rf.SelectionEditor.pGc(k,y,!1),k=rf.SelectionEditor.dta(k,{hC:!1,Xs:!1,jE:!1,jG:!0})):k=rf.SelectionEditor.NCd(k,y,!1);b.setSelection(k)}}U1j(){return Wa.a.f_a}n$h(){}rSc(b,k,r){if(b&&k){var y=b.ib.kb;rf.SelectionEditor.Oza(y).y<r?(k=rf.SelectionEditor.pGc(k,y,!1),k=rf.SelectionEditor.dta(k,{hC:!1,Xs:!1,jE:!1,jG:!0})):k=rf.SelectionEditor.dta(y,{hC:!1,Xs:!1,jE:!1,jG:!0});b.setSelection(k)}}static get ag(){return mh.a.instance}static get Sg(){return tm.ContextSetEditor.instance}}
Object(m.a)(WD,"TabActor",null,[]);class dG{constructor(b){this.tpc=b}get xp(){return this.tpc}ran(b){return b}OSl(b,k,r,y){const R=y.view,aa=R.Cb.ib.kb;if(Ei.TableCellReader.Mma(b))return this.Oei(b,y)?Wa.a.XF:Wa.a.UVd;xg.OutlineElementNavigator.Xd(b);if(rf.SelectionEditor.zf(k))Ag.OutlineElementReader.Uz(b,k,!1)&&this.Q4i(b)?r=Wa.a.fIb:rf.SelectionEditor.kPc(R,aa)&&this.xp.Kwb(b)?r=Wa.a.XF:rf.SelectionEditor.kPc(R,aa)&&(r=Wa.a.XF);else if(rf.SelectionEditor.Dk(k)){if(!this.xp.Kwb(b))return r;rf.SelectionEditor.ggb(k)?
r=Wa.a.XF:rf.SelectionEditor.Eji(k)&&(r=this.Q4i(b)?Wa.a.fIb:Wa.a.XF)}else this.xp.Kwb(b)&&(r=Wa.a.XF);return r}NSl(b,k,r,y){if(Ei.TableCellReader.SZ(b))return this.Oei(b,y)?Wa.a.FN:r;xg.OutlineElementNavigator.Xd(b);if(rf.SelectionEditor.zf(k))Ag.OutlineElementReader.Uz(b,k,!1)&&(!Vh.ListReader.ei(b)&&Ag.OutlineElementReader.isEmpty(b,!1)?r=Kd.ActionManager.Yua:this.$Un(b)?r=Wa.a.$bb:this.a4i(b)?r=Wa.a.Dyb:this.xp.YYb(b)&&(r=Wa.a.FN));else if(rf.SelectionEditor.Dk(k)){if(!this.xp.YYb(b))return r;
rf.SelectionEditor.ggb(k)?r=Wa.a.FN:rf.SelectionEditor.Eji(k)&&(r=this.a4i(b)?Wa.a.Dyb:Wa.a.FN)}else this.xp.YYb(b)&&(r=Wa.a.FN);return r}Q4i(b){return Vh.ListReader.ei(b)?!1:0<Ag.OutlineElementReader.r2(b)?!0:!1}a4i(b){if(Vh.ListReader.ei(b))return!1;const k=Ag.OutlineElementReader.r2(b);b=Nf.OutlineReader.EL(b.currentNode);return k<b?!0:!1}$Un(b){return Vh.ListReader.ei(b)?!1:0<Ag.OutlineElementReader.zF(b)?!0:!1}static nr(){return new dG(gn.a.fBb)}Oei(b,k){if(this.Nkm){k=k.view;const r=k.Cb.ib.kb,
y=new Wd.GraphIterator;y.ed(b);xg.OutlineElementNavigator.Xd(y);if(Vh.ListReader.ei(y)&&rf.SelectionEditor.kPc(k,r))return!0}return!1}get Nkm(){var b;n.AFrameworkApplication.Ne("egdi3422;7g6fa693");return null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(dG,"TabActorPromoteDemoteStrategy",null,[289]);class iC extends WD{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc){super(b,k,r,y,R,aa,ta,Ya,xb,
Mb);this.NTc=(fd,Td)=>{fd=Td.property;!this.lYc||fd!==wc.a.Oo&&fd!==wc.a.marginLeft&&fd!==wc.a.marginRight||this.lYc.Oai()};this.EL=(fd,Td,ne,ye,ff)=>{fd=Nf.OutlineReader.EL(this.REl(Td));ff.defaultTabStop=fd;return 32};this.fTb=cc;this.ga=Mc;this.UA();this.ga.pa(Jc.a.EL,lc.a.view,this.EL)}get lYc(){return null!=this.Tqg?this.Tqg:this.Tqg=Va.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}UA(){this.fTb.ml.Ve(10).qp(this.NTc)}n$h(b){const k=b.view,r=k.Cb;b=r.Jg;if(this.iGa&&this.Hc){var y=
this.Hc.Rc(15);y.Eb(b.node);b.contextId===lc.a.Hd&&n.AFrameworkApplication.ya.processAction(Wa.a.XG,2);this.iGa.$Md(r.Jg);y.dispose();var R=rf.SelectionEditor.Oza(r.ib.kb).y;Ka.App.jcc(()=>{this.rSc(r,k,R)})}}REl(b){return b.view.Cb.ib.kb.Qa.node}static get instance(){return null!=iC.Kng?iC.Kng:iC.Kng=iC.Hl()}static Hl(){return new iC(()=>Va.a.instance.resolve("Box4.IUndoManager"),dG.nr(),Va.a.instance.$a("Box4.IExternalSelectionManager"),Va.a.instance.resolve("Box4.IAutoCorrectRules"),Va.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Va.a.instance.Pa("Box4.ITabPresenterFactory"),Va.a.instance.Pa("Box4.IBlobEditor"),Va.a.instance.Pa("Box4.IFeatureHelper"),Va.a.instance.Pa("Box4.Graph.GraphTransactionFactory"),Va.a.instance.Pa("Box4.Actors.IIFrameFocusStrategy"),Ka.App.ik,Va.a.instance.Pa("Box4.ITabRenderer"),n.AFrameworkApplication.ya)}}Object(m.a)(iC,"TabActor",WD,[]);class mv{static get Qs(){return null!=mv.khg?mv.khg:mv.khg=Va.a.instance.resolve("Box4.IAppFrame")}static initialize(){dr.a.J7b=mv.Jlm;dr.a.zae=mv.nvo}static Jlm(b){return!Si.TableReader.Kgm(b)}static oib(){mv.Qs.ycc(mv.oib);
mv.jsb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static nvo(b){var k,r,y;b&&((null===(k=lt.a.instance.kb)||void 0===k?0:k.QCa)||(null===(r=lt.a.instance.kb)||void 0===r?0:r.Bw)||(null===(y=lt.a.instance.kb)||void 0===y?0:y.tEb))&&!mv.jsb&&(mv.Qs.GVa(mv.oib),mv.jsb=!0)}}mv.jsb=!1;Object(m.a)(mv,"TableActor",null,[]);var nM=c(899);class eG{sbl(b,
k,r,y){return b?this.T$k(k,r,y):this.tbl(k,r,y)}nJh(b,k,r,y,R){return b?this.Wal(k,r,y,R):this.Kal(k,r,y,R)}Hal(b){let k=!1;var r=b.Uf?b.Oe.Tc:b.Oe.Qa;b=new Wd.GraphIterator;b.set(r.node);b.Ab(14);r=null;Ei.TableCellReader.oaa(b)?Ei.TableCellReader.KDb(b)||(k=!0,r=bf.moveToNextRow(b)):r=bf.moveToNextColumn(b);return{returnValue:r,qMm:k}}Ral(b){var k=b.Uf?b.Oe.Tc:b.Oe.Qa;const r=new Wd.GraphIterator;r.set(k.node);r.Ab(14);k=null;Ei.TableCellReader.tfa(r)?Ei.TableCellReader.sfa(r)||(k=new Wd.GraphIterator,
k.set(b.Qza.node),k.Ab(14),b=bm.a.Rr(k),bm.a.Rr(r)>b?(bf.moveToPreviousRow(r),bf.moveToLastColumn(r),k=r.currentNode):k=bf.moveToPreviousRow(r)):k=bf.moveToPreviousColumn(r);return k}AJh(b,k){var r=b.Uf?b.Oe.Tc:b.Oe.Qa;b=new Wd.GraphIterator;b.set(r.node);b.Ab(14);r=null;k?Ei.TableCellReader.sfa(b)||(r=bf.moveToPreviousRow(b)):Ei.TableCellReader.KDb(b)||(r=bf.moveToNextRow(b));return r}IEb(b,k,r){for(;Ei.TableCellReader.gg(b);)if(k){if(r&&b.bua(1)||!r&&b.jua(1))return null;r?bf.moveToPreviousColumn(b):
bf.moveToNextColumn(b)}else{if(Ei.TableCellReader.U2(b.currentNode)){const y=new Wd.GraphIterator;y.ed(b);if(this.IEb(y,!0,!0)||this.IEb(y,!0,!1)){b.ed(y);break}}else{if(!r&&bf.moveToControllingCell(b,2))break;if(r&&bf.moveToControllingCell(b))break}if(r&&Ei.TableCellReader.sfa(b)||!r&&Ei.TableCellReader.KDb(b))return null;r?bf.moveToPreviousRow(b):bf.moveToNextRow(b)}return b.currentNode}M1b(b,k){if(!bm.a.isTableRow(b))return null;b=Wd.GraphIterator.Za(b.currentNode);b.Ab(14);let r;const y=Si.TableReader.LA(b.origin);
do r=k?bf.moveToPreviousRow(b):bf.moveToNextRow(b);while(y&&r&&bm.a.UMa(b));return r}Thb(b,k,r,y,R){let aa=null;xg.OutlineElementNavigator.Xd(b);const ta=Ag.OutlineElementReader.isRtl(b.currentNode);if(r)if(bf.returnToCell(b),k=Ei.TableCellReader.oaa(b),r=Ei.TableCellReader.tfa(b),R||!ta&&r||ta&&y&&k)bf.returnToContainingRow(b),(y=this.M1b(b,!0))?aa=Ke.SelectionFactory.xo(y,!k):R&&(xg.OutlineElementNavigator.Xd(b),R=new Wh.a,R.ed(b),(b=xg.OutlineElementNavigator.e3(R,!1,!1))&&(aa=Ke.SelectionFactory.xo(b,
!1)));else{do ta?bf.moveToNextColumn(b):bf.moveToPreviousColumn(b);while(Ei.TableCellReader.gg(b)&&!Ei.TableCellReader.sfa(b));Ei.TableCellReader.gg(b)||(aa=Ke.SelectionFactory.xo(b.currentNode,!ta))}else Ag.OutlineElementReader.Uz(b,k,ta)||rf.SelectionEditor.zf(k)||bf.returnToCell(b),aa=Ke.SelectionFactory.xo(b.currentNode,!ta);return aa}Shb(b,k,r,y,R){let aa=null;xg.OutlineElementNavigator.Xd(b);const ta=Ag.OutlineElementReader.isRtl(b.currentNode);if(r)if(bf.returnToCell(b),r=Ei.TableCellReader.oaa(b),
k=Ei.TableCellReader.tfa(b),R||!ta&&y&&r||ta&&!y&&k)bf.returnToContainingRow(b),(y=this.M1b(b,!1))?aa=Ke.SelectionFactory.xo(y,k):(xg.OutlineElementNavigator.Xd(b),y=new Wh.a,y.ed(b),(b=xg.OutlineElementNavigator.Wr(y,!1,!1))&&(aa=Ke.SelectionFactory.xo(b,!0)));else{do ta?bf.moveToPreviousColumn(b):bf.moveToNextColumn(b);while(Ei.TableCellReader.gg(b)&&!Ei.TableCellReader.oaa(b));Ei.TableCellReader.gg(b)||(aa=Ke.SelectionFactory.xo(b.currentNode,ta))}else Ag.OutlineElementReader.Uz(b,k,!ta)||rf.SelectionEditor.zf(k)||
bf.returnToCell(b),aa=Ke.SelectionFactory.xo(b.currentNode,ta);return aa}}Object(m.a)(eG,"ATableCellSelectionStrategy",null,[1387]);class WJ extends eG{constructor(){super()}Kal(b,k,r,y){let R=b.kb,aa=null;if(b.Bw)if(k)if(2===R.Oe.jna&&!R.Uf&&R.Oe.Tc.equals(R.Qza))R=Ke.SelectionFactory.Bwh(R.Qza.node,!1);else{var ta=({qMm:b}=this.Hal(R)).returnValue;ta&&(Ei.TableCellReader.rr(ta)&&(ta=Wd.GraphIterator.Za(ta),ta.Ab(14),ta=!b&&this.IEb(ta,!0,!1)?ta.currentNode:b||bf.moveToNextRow(ta)?this.IEb(ta,!1,
!1):null),ta&&(aa=Ke.SelectionFactory.fo(Pv.TableNodeContext.create(ta),R.Uf)))}else R=b.Mba,b=Wd.GraphIterator.Za(R.Oe.Tc.node),b.Ab(14),Ei.TableCellReader.BCa(b.currentNode)&&bf.moveToLastGhostCell(b,2),(ta=bf.moveToNextColumn(b))?(b=Ei.TableCellReader.U2(ta),Ei.TableCellReader.rr(ta)&&!b&&(ta=Wd.GraphIterator.Za(ta),ta.Ab(14),ta=bf.moveToControllingCell(ta)),b?R=Ke.SelectionFactory.xo(R.Oe.Tc.node,!1):aa=Ke.SelectionFactory.xo(ta,!0)):(ta=R.Oe.Tc.node,aa=Ke.SelectionFactory.xo(ta,!1));else b=k&&
R.Uf||!k&&!R.yua?R.Oe.Tc:R.Oe.Qa,bm.a.Nma(b.node)&&(b=Wd.GraphIterator.Za(b.node),(ta=this.M1b(b,!1))?aa=k?Ke.SelectionFactory.fo(Pv.TableNodeContext.create(ta),R.Uf):Ke.SelectionFactory.xo(ta,!0):R=rf.SelectionEditor.Qj(Ke.SelectionFactory.Sq(b.currentNode),!1,!0));return aa?aa:y?rf.SelectionEditor.L1b(R,!1,k,!0):rf.SelectionEditor.dta(R,{hC:!k,Xs:k,jE:r,jG:!0})}Wal(b,k,r,y){let R=b.kb;var aa=null;if(b.Bw)k?1===R.Oe.jna&&R.Uf&&R.Oe.Qa.equals(R.Qza)||(aa=this.Ral(R),(aa=this.lJh(R,aa))||R.Uf&&(R=
R.HGc())):(R=b.Mba,aa=Ke.SelectionFactory.xo(R.Oe.Qa.node,!0));else if(k){var ta=(R.Uf?R.Oe.Tc:R.Oe.Qa).node;b=Wd.GraphIterator.Za(ta);rf.SelectionEditor.Pt(b);bm.a.Nma(ta)&&(R.Uf&&1===R.Oe.jna&&R.yua?(aa=bm.a.wA(ta).toArray(),(aa=this.lJh(R,0<=aa.length-2?aa[aa.length-2]:null))||R.Uf&&(R=R.HGc())):(ta=this.M1b(b,!0))?aa=Ke.SelectionFactory.fo(Pv.TableNodeContext.create(ta),R.Uf):R=Ke.SelectionFactory.xo(b.currentNode,!0))}else aa=rf.SelectionEditor.Qj(R,!0,!1);return aa?aa:y?rf.SelectionEditor.L1b(R,
!0,k,!0):rf.SelectionEditor.cBa(R,{hC:!k,Xs:k,jE:r,jG:!0})}lJh(b,k){if(!k)return null;var r=k;Ei.TableCellReader.rr(k)&&(r=Wd.GraphIterator.Za(k),r.Ab(14),r=this.IEb(r,!0,!0)?r.currentNode:Ei.TableCellReader.Aea(k));return r?Ke.SelectionFactory.fo(Pv.TableNodeContext.create(r),b.Uf):null}tbl(b,k,r){let y=k.kb,R=null;if(k.Bw){var aa=k.oW>k.YEa;if(r)if(2===k.length&&1===k.Mba.Oe.jna&&aa)y=rf.SelectionEditor.Qj(y,!0,!1);else{if(k=this.AJh(y,!0))Ei.TableCellReader.rr(k)&&(k=Wd.GraphIterator.Za(k),k.Ab(14),
k=this.IEb(k,!1,!0)),k&&(R=Ke.SelectionFactory.fo(Pv.TableNodeContext.create(k),y.Uf));R||y.Uf&&(y=y.HGc())}else aa&&(y=k.Mba)}else k=r&&y.Uf?y.Oe.Tc:y.Oe.Qa,bm.a.Nma(k.node)&&(k=Wd.GraphIterator.Za(k.node),(aa=this.M1b(k,!0))?R=r?Ke.SelectionFactory.fo(Pv.TableNodeContext.create(aa),y.Uf):Ke.SelectionFactory.xo(aa,!0):r&&(y=Ke.SelectionFactory.xo(k.currentNode,!0)));return R?R:rf.SelectionEditor.Ibb(b,y,!1,r,r)}T$k(b,k,r){let y=k.kb,R=null;if(k.Bw){const aa=k.oW<k.YEa;if(r)if(2===k.length&&1===k.Mba.Oe.jna&&
aa)y=rf.SelectionEditor.Qj(y,!1,!1);else{if(k=this.AJh(y,!1))Ei.TableCellReader.rr(k)&&(k=Wd.GraphIterator.Za(k),k.Ab(14),k=this.IEb(k,!1,!1)),k&&(R=Ke.SelectionFactory.fo(Pv.TableNodeContext.create(k),y.Uf))}else aa&&(y=k.Mba)}else k=!r||y.Uf?y.Oe.Tc:y.Oe.Qa,bm.a.Nma(k.node)&&(k=Wd.GraphIterator.Za(k.node),(k=this.M1b(k,!1))&&(R=r?Ke.SelectionFactory.fo(Pv.TableNodeContext.create(k),y.Uf):Ke.SelectionFactory.xo(k,y.yua)));return R?R:rf.SelectionEditor.Ibb(b,y,!0,r,r)}}Object(m.a)(WJ,"TableCellSelectionStrategy",
eG,[]);class XJ{constructor(b){this.rM=(k,r,y,R,aa)=>{if(1===y)return 32;k=(new Kn.a).create();r="";switch(aa.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;aa=CommonUIStrings.l_DefaultDialogTitle;break;default:aa=CommonUIStrings.l_DefaultDialogTitle}k.message=r;k.rM(aa,null,null);return 32};this.ga=b}Vb(){this.ga.gb(Wa.a.rM,lc.a.view,this.rM,1028)}}Object(m.a)(XJ,"UIAutomationActor",null,[]);class YJ{constructor(b,k,r,y){this.fb=b;this.iGa=k;this.kkc=r;this.S4=
y}C7f(b,k,r){return this.kkc.Bjm(k)?r?!0:b&&this.fb.yh(b)?(b=this.rw(b.currentNode),this.iGa.v$h(b),!0):!1:!1}Mkf(b,k){return this.kkc.X5k(b,k)}Rkf(b){b&&this.fb.yh(b)&&(b=this.rw(b.currentNode),this.iGa.$Md(b))}rw(b){return Re.a.rw(b)}CEa(b,k,r){this.S4.kFi&&this.kkc.ydi(r)&&(this.S4.CEa(b,k),b.setValue(td.a.Pdi,!0))}m7d(){}aPd(b){return this.kkc.aPd(b)}get eQd(){return this.kkc.eQd}jC(){}$ga(){}G7d(){}get o5i(){return!1}}Object(m.a)(YJ,"WordEditorPasteStewardBridge",null,[230]);class ZJ{constructor(b){this.sa=
new Fe.a;this.QVi="WordFileSaveAsButtonClicked";this.qvo=()=>{this.sa.raiseEvent(this.QVi,null);return 32};this.ga=b}Vb(){n.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.pa(Jc.a.Knj,zc.a.frame,this.qvo)}Z9j(b){this.sa.addHandler(this.QVi,b)}}Object(m.a)(ZJ,"WordFileSaveAsActor",null,[]);class $J extends Vp{constructor(){super()}gzc(b,k,r,y,R,aa,ta){return pq.a.bbc(k,r,y,R,aa,ta)}}Object(m.a)($J,"WordIndentationActorExtension",Vp,[]);class fG{constructor(){this.fed=null}get name(){return"WordEditor.Actors"}init(){var b;
Bb.InteractiveViewManager.instance.editingView.i0b=!0;n.AFrameworkApplication.ya.pa(Jc.a.nuo,zc.a.frame,VL);this.W.resolve("WordEditor.Actors.DeleteActor").Vb(n.AFrameworkApplication.ya);bC.instance.Vb();Fm.Vb();uq.Vb(n.AFrameworkApplication.ya,this.W.resolve("WordEditor.IMainViewModeManager"));Zj.Vb();iC.instance.Vb();nM.a.Vb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Vb(n.AFrameworkApplication.ya);this.W.resolve("WordEditor.Actors.ExternalContentActor").Vb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Vb();
n.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Vb();n.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Vb();n.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&n.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.vV.lQd=!0);n.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Vb();n.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Vb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Vb();this.W.resolve("Common.IOfficeTrialExperience").Vb();this.W.resolve("Common.IMacOfficeOffer").Vb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Vb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Vb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Vb();
this.W.resolve("WordEditor.Actors.FileDownloadActor").Vb();this.W.resolve("WordEditor.Actors.StylesActor").Vb();(null===(b=n.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Vb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Vb();this.W.resolve("WordEditor.Actors.ProofingActor").Vb();this.W.resolve("WordEditor.Actors.PageActor").Vb();this.W.resolve("WordEditor.Actors.DarkModeActor").Vb();
this.W.resolve("WordEditor.Actors.ImageActor").Vb(n.AFrameworkApplication.ya);this.W.resolve("WordEditor.Actors.FormattingActor").Vb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Vb();this.W.resolve("WordEditor.Actors.ContentControlActor").Vb();this.W.resolve("WordEditor.Actors.CustomTabActor").Vb();this.W.resolve("WordEditor.Actors.BookmarkActor").Vb();this.W.resolve("WordEditor.Actors.HeadingsActor").Vb();this.W.resolve("Box4.Indicator.IIndicatorManager").Kjb(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));
this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Vb();this.W.resolve("WordEditor.Actors.AccessibilityActor").JRf();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Vb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Vb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Vb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").x3();
this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Vb();n.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.qmn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb();this.V4.Jjb(this.Pyj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");n.AFrameworkApplication.Ne("ContainsBookmarkAutomationFix;ContainsBookmarkAutomationFix-cf");const k=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContainsBookmarkFixIsEnabled",
!1);n.AFrameworkApplication.Ne("bookmarks-core-ex;bookmarks-core-ex-cf");(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&k?b.T4h(!1):b.sZe(!1))&&Ka.App.xa.jb.kFh();Ka.App.xa.updateCommandUI();mv.initialize()}dispose(){}qmn(){this.Ic.io.isCompleted?this.Ic&&this.Ic.isFeatureEnabled(48)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb():this.Ic.io.continueWith(()=>{this.Ic&&this.Ic.isFeatureEnabled(48)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb(),
Ka.App.xa.updateCommandUI())})}get Vjm(){if(null==this.fed)if(this.Ic)if(this.Ic.io.isCompleted)this.fed=this.Ic.isFeatureEnabled(30)&&this.Ic.isFeatureEnabled(2);else return!1;else this.fed=!1;return this.fed}zc(b){var k;this.W=b;this.Ic=b.Pa("Box4.IFeatureHelper");this.vV=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.vV.UOc=n.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",
!1);(new wI).zc(b);b.ha("Box4.IClipboardCommands",()=>new xI(n.AFrameworkApplication.ya,Wa.a.FUe,Wa.a.Wzc,Wa.a.Q1,Wa.a.qLf,Wa.a.paste,Wa.a.t7,Wa.a.ijb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const r=b.resolve("Common.IAppSettingsManager");return new Ox(!0,r.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const r=b.resolve("Common.IAppSettingsManager"),y=R=>!R.u6b;return new NL.a(r.$("ExternalPasteImprovementsEnabled"),
r.$("PasteComplexTablesIsEnabled"),r.$("PasteTableCellMarginImprovementsIsEnabled")||r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedHtmlTableCellMarginsHandlingIsEnabled",!1),r.$("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,r.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,R=>R.u6b,()=>!1,y,y,y,y,void 0,()=>this.Vjm,R=>!R.u6b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",
()=>new YJ(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new LJ(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",
()=>new yI).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new zI(n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new AI(n.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new BI(n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new HJ(n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new TJ(n.AFrameworkApplication.ya,
b.Ze("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(k=n.AFrameworkApplication.K)||void 0===k?0:k.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new VD(n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",()=>new XF(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new oJ(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),
new ML.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new lJ(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),n.AFrameworkApplication.K.$("DisablePrint"),n.AFrameworkApplication.K.lb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new JJ(n.AFrameworkApplication.ya,b.Ze("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),
Al.a.instance,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new FJ(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"),Al.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",()=>new eJ(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"),Al.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>
new OB.a(b.$a("Common.ISystemInitiatedFeedback"),PL.a.O2b())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new IJ(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"),Al.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new zJ(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();b.register(jJ,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",
()=>new MJ(n.AFrameworkApplication.ya,mh.a.instance,Va.a.instance.resolve("Box4.ISelectionManager"),or.a.instance,Va.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Va.a.instance.resolve("Box4.ILanguageReader"),Va.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Va.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Va.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.vV,Va.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
n.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Va.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").LD.loadScript("EditorSettingsManager")).then(()=>{const r=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");r.q3l();r.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new CI(n.AFrameworkApplication.ya,
b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new DI(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();n.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&n.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Vb()});b.ha("WordEditor.Actors.PageActor",()=>new GJ(Va.a.instance.resolve("Box4.IWordSectionEditor"),Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).as("WordEditor.IPageCommandStringBuilder").singleInstance();
b.ha("WordEditor.Actors.DarkModeActor",()=>new hJ(n.AFrameworkApplication.ya,n.AFrameworkApplication.K,Ka.App.Tba,!!Ka.App.instance&&Ka.App.instance.zCa,!!Ka.App.instance&&Ka.App.instance.oPc,Va.a.instance.resolve("Box4.IDarkModeState"),Va.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Va.a.instance.resolve("Box4.DarkModeEventsManager"),!!Ka.App.instance&&Ka.App.instance.Cma)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new qJ(b.resolve("WordEditor.IFlatListEditor")));
b.ha("WordEditor.Actors.AccessibilityActor",()=>new OI(b.$a("Box4.Accessibility.IAccessibilityContextManager"),b.Ze("WordEditor.FlatListDetailsProvider"),b.Ze("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ze("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new bJ(n.AFrameworkApplication.ya,b.$a("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new Zp(b.resolve("WordEditor.IImageEditor"),
b.$a("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IAppFrame"),n.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new ZJ(n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",
()=>new QJ(b.resolve("WordEditor.IImageEditor"),n.AFrameworkApplication.K,n.AFrameworkApplication.ta.tMa,Va.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new iJ.DeleteActor(Va.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),
Va.a.instance.$a("Box4.ContentControlConfigSettings"),Va.a.instance.$a("Box4.IContentControlEditor"),Va.a.instance.resolve("Box4.IDynamicRangeEditor"),Va.a.instance.$a("WordEditor.Bookmark.IBookmarkManager"),Va.a.instance.resolve("Box4.IHyperlinkEditor"),Va.a.instance.resolve("Box4.IHyperlinkStrategy"),Va.a.instance.resolve("Box4.IParagraphReader"),Va.a.instance.resolve("Box4.IParagraphIndentationReader"),Va.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Va.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new VJ(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),n.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new WJ).as("Box4.ITableCellSelectionStrategy").singleInstance();n.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new EI(b.resolve("Box4.Styles.IWACStyleEditor"),
b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),mh.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();
b.ha("Box4.Actors.FormatPainterActor",()=>new cC(Ka.App.xa,Id.FocusManager.instance(),n.AFrameworkApplication.ya,Db.a.instance,lt.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Ka.App.instance&&Ka.App.instance.Cma,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new rJ(n.AFrameworkApplication.ya,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",
()=>new XJ(n.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new SJ(n.AFrameworkApplication.ya,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new FI(b.Pa("Box4.IAutoCorrectScheduler"),b.Ze("Box4.IUndoManager"),b.$a("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new lA(De.PageReader.instance,b.Ze("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
n.AFrameworkApplication.K.$("QoETinyWinsSelectAllEnabled"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",()=>new fJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Styles.IWACStyleReader"),n.AFrameworkApplication.ya,n.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),gh.a.instance.J(10))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new PI(n.AFrameworkApplication.ya,b.Ze("WordEditor.UI.IDialogFactory"),Id.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new GI).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",
()=>new RE(n.AFrameworkApplication.af,lk.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Va.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),n.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",
()=>new wJ(n.AFrameworkApplication.ya,n.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),n.AFrameworkApplication.af,this.Ic,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new RJ).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new gJ(n.AFrameworkApplication.ya,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new xJ(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),n.AFrameworkApplication.ya,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>
new dJ(Ka.App.xa,n.AFrameworkApplication.ya,bh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new cg.a(()=>Ka.App.xa.jb.Xc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),or.a.instance,this.W.$a("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),Bb.InteractiveViewManager.instance,this.W.Ze("WordEditor.UI.IDialogFactory"),
this.W.resolve("Box4.BookmarkParagraphMapping"),mh.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var r,y;return new Mr(b.resolve("Box4.IParagraphReader"),pf.a.instance,Sf.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(y=null===(r=Ka.App.instance)||void 0===r?void 0:r.XB)&&void 0!==y?y:!1,new cg.a(()=>Ka.App.xa.jb.Fc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new yJ).singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new gC(bh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Bb.InteractiveViewManager.instance,Qe.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new Or(n.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),n.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new NI).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new QI(n.AFrameworkApplication.K,n.AFrameworkApplication.ya)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new fC(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),
Bb.InteractiveViewManager.instance,Lu.a.instance(),n.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ka.App.ik.ml.Ve(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new $J).as("Box4.Actors.IIndentationActorExtension").singleInstance();n.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new aG(n.AFrameworkApplication.ya)).singleInstance());
n.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new bF(n.AFrameworkApplication.ya)).singleInstance();(new tI).zc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new MI(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",
()=>new JI(n.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new KI(n.AFrameworkApplication.ya,n.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),mh.a.instance)).singleInstance();this.Pyj=new HI;this.V4=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){M.a.instance.Pc(new fG)}}
Object(m.a)(fG,"WordEditorActorsPackage",null,[1,2]);class aK{constructor(b){this.Ypc=!1;this.Tyi=()=>{this.Ypc=!0;this.Ps.tTf(this.Tyi)};this.Ps=b;this.Ps.CXb(this.Tyi)}}Object(m.a)(aK,"GraphFullyConnectedGetter",null,[352]);class qg{constructor(){this.VPg=Object.assign(new xk.a,{})}x3j(b,k){let r;const y=b&1023;({value:r}=this.VPg.Bc(y,0)).returnValue||qg.dSl().contains(y)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,y);r+=k;this.VPg.Z(y,r);return r}static dSl(){qg.fnd||
(qg.fnd=new Ia.a,qg.pc(0),qg.pc(1),qg.pc(2),qg.pc(3),qg.pc(4),qg.pc(5),qg.pc(6),qg.pc(7),qg.pc(8),qg.pc(9),qg.pc(10),qg.pc(11),qg.pc(12),qg.pc(13),qg.pc(14),qg.pc(15),qg.pc(16),qg.pc(17),qg.pc(18),qg.pc(19),qg.pc(20),qg.pc(21),qg.pc(22),qg.pc(23),qg.pc(24),qg.pc(25),qg.pc(26),qg.pc(27),qg.pc(28),qg.pc(29),qg.pc(30),qg.pc(31),qg.pc(32),qg.pc(33),qg.pc(34),qg.pc(35),qg.pc(36),qg.pc(37),qg.pc(38),qg.pc(39),qg.pc(40),qg.pc(41),qg.pc(42),qg.pc(43),qg.pc(44),qg.pc(45),qg.pc(46),qg.pc(47),qg.pc(48),qg.pc(49),
qg.pc(50),qg.pc(51),qg.pc(52),qg.pc(53),qg.pc(54),qg.pc(55),qg.pc(56),qg.pc(57),qg.pc(58),qg.pc(59),qg.pc(60),qg.pc(61),qg.pc(62),qg.pc(63),qg.pc(64),qg.pc(65),qg.pc(66),qg.pc(67),qg.pc(68),qg.pc(69),qg.pc(70),qg.pc(71),qg.pc(72),qg.pc(73),qg.pc(74),qg.pc(75),qg.pc(76),qg.pc(77),qg.pc(78),qg.pc(79),qg.pc(80),qg.pc(81),qg.pc(82),qg.pc(83),qg.pc(84),qg.pc(85),qg.pc(86),qg.pc(87),qg.pc(88),qg.pc(89),qg.pc(90),qg.pc(91),qg.pc(92),qg.pc(93),qg.pc(94),qg.pc(95),qg.pc(96),qg.pc(97),qg.pc(98),qg.pc(99),qg.pc(100),
qg.pc(101),qg.pc(102),qg.pc(103),qg.pc(104),qg.pc(105),qg.pc(106),qg.pc(107),qg.pc(108),qg.pc(109),qg.pc(110),qg.pc(111),qg.pc(112),qg.pc(113),qg.pc(114),qg.pc(115),qg.pc(116),qg.pc(117),qg.pc(118),qg.pc(119),qg.pc(120),qg.pc(121),qg.pc(122),qg.pc(124),qg.pc(126),qg.pc(127),qg.pc(128),qg.pc(129),qg.pc(130),qg.pc(131),qg.pc(132),qg.pc(133),qg.pc(134),qg.pc(135),qg.pc(136),qg.pc(140),qg.pc(145),qg.pc(146),qg.pc(147));return qg.fnd}static pc(b){qg.fnd.add(b&1023)}}qg.fnd=null;Object(m.a)(qg,"LanguagePerParagraphModel",
null,[]);class bK{constructor(){this.H0f=!1;this.vud=this.uud=this.uNb=0;this.bki=!0;this.Kxo=0}}Object(m.a)(bK,"UpdateWordCountStateResult",null,[]);class cK extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(m.a)(cK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class dK{constructor(){this.Fmh=this.Emh=this.wordCount=-1;this.azb=this.kih=0;this.$yb=1;this.FEi=1033}}Object(m.a)(dK,"WordCountCache",null,[]);class eK extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(m.a)(eK,"WordCountChangedEventArg",Sys.EventArgs,[]);class fK{constructor(){this.qic=this.Uza=0}}Object(m.a)(fK,"CharsCountResult",null,[]);class gK{constructor(){this.cp=0;this.sic=null;this.P5=this.Q5=0}}Object(m.a)(gK,"TextChunkResult",null,[]);class hK{constructor(){this.ynj=this.Q5=this.P5=this.wordCount=0}}Object(m.a)(hK,"WordCountStateForParagraph",null,[]);class gG{constructor(){this.Ioa=this.nQ=this.Q5=this.P5=this.o_=this.wordCount=0;this.currentNode=null;this.oW=-1;this.cp=0;
this.GLf=[];this.$yb=this.azb=this.dWa=this.BLf=this.CLf=0;this.AH=this.tei=!1;this.cnb=new rb.a;this.i0a=new rb.a}}Object(m.a)(gG,"WordCountState",null,[]);class $p{constructor(b,k,r,y,R,aa){this.d4n=1E3;this.sa=new Fe.a;this.avb=null;this.lhe=0;this.IFj="\ue000";this.Jmc=!1;this.Cme=this.rme=this.w9c=0;this.uBg=this.CBg=null;this.nme=this.mme=this.wme=0;this.mB=k;this.TDj=new RegExp(xn.AParagraphNode.IB,"g");this.hd=b;this.taskManager=y;this.am=r;this.sVa=aa;this.TSa=R.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");
this.nVj=R.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.YSi()}get Opm(){return!!this.avb}get RKa(){return this.Jmc}set RKa(b){this.Jmc=b}get nqd(){return this.lhe}set nqd(b){this.lhe=b}get tNa(){return!this.lhe}get WC(){return this.w9c}get fyb(){return this.rme}get kyb(){return this.Cme}get wRk(){return this.CBg}get $1e(){return this.uBg}get qDc(){return this.wme}get oDc(){return this.mme}get O_b(){return this.nme}CXb(b){this.sa.addHandler($p.vee,b)}tTf(b){this.sa.removeHandler($p.vee,
b)}XPe(b){this.sa.addHandler($p.Pag,b)}Pun(b){this.sa.removeHandler($p.Pag,b)}jzd(){this.izd();this.YSi()}YSi(){this.wme=this.nme=this.mme=this.Cme=this.rme=this.w9c=-1}l3e(){this.q$d(this.d4n)}u1c(){const b=new gG;b.tei=!0;this.izd();this.B5e(b)}q$d(b,k=null){this.tNa&&(this.Opm&&(k=null,this.izd()),k||(k=new gG),b=new nd.a(3,1,b,Object(u.a)(this,this.N_k,"doWordCountTask"),this.Zaj),b.customData=k,this.I7j(b))}izd(){this.avb&&(this.taskManager.Ye(this.avb),this.avb=null)}Jkj(b,k,r,y,R,aa=!0,ta=
-1,Ya=-1,xb=-1,Mb=1033){const cc=new bK;cc.uNb=r;cc.uud=R;cc.vud=y;if(!b.cp&&k.Y4c&&aa&&!this.dZh(k))return $p.Opo(b,k.Y4c),cc.bki=!0,cc;y=0<=Ya&&0<=xb?{Fd:Ya,endCp:xb}:void 0;r=this.Pil(k,y);y&&(Ya=y.Fd,xb=y.endCp);r=0<=xb?r.substring(0,xb):r;xb=0<=Ya&&0<=xb?r.substring(Ya,xb):r;y=b.cp>=Ya?b.cp:Ya;R=b.GLf||[];aa=0<b.CLf?b.CLf:0;let jc=0<b.BLf?b.BLf:0,Mc=[];b.AH=!1;do{this.sVa.update();if(!b.tei&&(cc.uNb+Mc.length/2>$p.Uuo||this.sVa.Whb())){let ne;R=(ne=R).concat.apply(ne,Mc);b.cp=y;b.GLf=R;b.BLf=
jc;b.CLf=aa;b.oW=ta;b.currentNode=k;this.q$d($p.jyo,b);cc.H0f=!0;b.AH=!0;return cc}if((!y||y===Ya)&&0<r.length&&y<r.length){R.push(Qx.a.instance.djf(r,y));var fd=this.dZh(k);if(0<=ta&&!y&&fd){b.wordCount+=1;cc.uNb+=1;const ne=this.hd.XN(fd);fd=this.mB.B$b(ne,fd);fd=$p.nxd(fd);b.Q5+=fd.Uza+1;b.P5+=fd.Uza-fd.qic}}fd=this.z2h(r,y,$p.cxk);y=fd.cp;let Td;Mc=(Td=Mc).concat.apply(Td,fd.sic);aa+=fd.Q5;jc+=fd.P5}while(-1!==y);b=this.F1j(b,R,Mc,r,xb,cc.uNb,cc.uud,cc.vud,k,-1===ta,Mb);cc.uNb=b.wordCount;cc.uud=
b.P5;cc.vud=b.Q5;cc.Kxo=b.ynj;return cc}mCh(b,k){const r=ie.ParagraphReader.textLength(k,5);if(r){k=Qm.e(k);var y=0;for(let R=0;R<k.length;R++)if(this.nfb&&5===k[R].li&&b.nQ++,$p.FUn(k[R])){y++;break}k.length!==r?b.o_++:b.o_+=y}}$3i(b){this.nqd=this.dVn(b.dWa,b.wordCount)?1:0;return!!this.nqd}xCi(b){this.w9c=b.wordCount;this.rme=b.nQ;this.Cme=b.Ioa;this.nme=b.Q5;this.mme=b.P5;this.wme=b.o_;this.CBg=b.cnb;this.uBg=b.i0a;this.cLi(b)}cLi(b){this.sa.raiseEvent($p.vee,new eK(b))}bLi(){this.sa.raiseEvent($p.Pag,
new cK(!1))}dVn(b,k){if(X.a.Ak||X.a.Ys||X.a.jH)return!1;(k/=2)||(k=1);return(k?b/k:0)>$p.MHm?!0:!1}get nfb(){const b=!this.yzf||1===this.yzf&&this.nVj;return this.TSa&&b}QVh(b,k){let r=1033,y=0;b=k.Bff(b);k=new qg;for(let R=0;R<b.length;R++){const aa=k.x3j(b[R].lcid,b[R].end-b[R].begin);y<aa&&(y=aa,r=b[R].lcid)}return r}N_k(b){this.avb=null;this.B5e(b.customData)}F1j(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){var jc;k=(jc=k).concat.apply(jc,r);r=Qx.a.instance.A2h(k,y);b.wordCount+=r.wordCount;const Mc=$p.nxd(R);
R=Mc.Uza-Mc.qic;jc=Mc.Uza;b.P5+=R;b.Q5+=jc;aa+=r.wordCount;ta+=Mc.Uza-Mc.qic;Ya+=Mc.Uza;b.dWa+=r.dWa;({v1k:k,Xbo:y}=$p.E1j(k,y));b.azb+=k;b.$yb+=y;b.i0a.add(cc);b.cnb.add(r.wordCount);Mb&&$p.hqk(jc,R,xb,r,k,y,cc);b.cp=0;b.GLf=[];b=new hK;b.P5=ta;b.Q5=Ya;b.wordCount=aa;b.ynj=r.wordCount;return b}Pil(b,k){let r=this.ywn(b);r=ie.ParagraphReader.Ezb(b,5,r,k);return this.Orn(r)}ywn(b){var k=ie.ParagraphReader.text(b);b=Qm.e(b);if(0<b.length){k=k.split("");for(let y=0;y<b.length;++y){let R=!0;var r=!0;
const aa=b[y];if(1===aa.li)r=aa,r=22!==r.kind&&2!==r.kind;else if(5===aa.li)R=!1;else if(7===aa.li||10===aa.li)k[aa.Ob.cp]=this.IFj,R=!1;if(R){if(aa.Ob.cp>=k.length)return"";k[aa.Ob.cp]=r?" ":"C"}}k=k.join("")}return k}Orn(b){return b.replace(this.TDj,"")}z2h(b,k,r){const y=b.length-k<=r;var R=y?b.length:k+r;const aa=new gK;if(R<k)return aa.cp=-1,aa;aa.sic=Qx.a.instance.kcf(b,k,R);R=$p.nxd(b.substr(k,R));aa.Q5=R.Uza;aa.P5=R.Uza-R.qic;if(!aa.sic.length&&!y)return r===b.length-k?aa:this.z2h(b,k,b.length-
k);aa.cp=y||!aa.sic.length?-1:aa.sic[aa.sic.length-1].cp;return aa}I7j(b){this.avb=b;this.taskManager.fc(this.avb)}dZh(b){if(b=b.kW){const k=this.hd.XN(b);if(k&&k.ur)return b}return null}static FUn(b){return 11===b.li}static Opo(b,k){b.wordCount+=k.wordCount;b.P5+=k.Emh;b.Q5+=k.Fmh;b.dWa+=k.kih;b.azb+=k.azb;b.$yb+=k.$yb;b.i0a.add(k.FEi);b.cnb.add(k.wordCount)}static hqk(b,k,r,y,R,aa,ta){const Ya=new dK;Ya.wordCount=y.wordCount;Ya.Fmh=b;Ya.Emh=k;Ya.kih=y.dWa;Ya.azb=R;Ya.$yb=aa;Ya.FEi=ta;r.Y4c=Ya}static nxd(b){const k=
b.length,r=new fK;for(let R=0;R<k;R++){var y=b.charCodeAt(R);r.Uza++;if(55296<=y&&56319>=y&&(y=R+1<k?b.charCodeAt(R+1):0,56320<=y&&57343>=y)){R++;continue}A.a.xaa(b.charAt(R))&&r.qic++}return r}static E1j(b,k){let r=0,y=0;for(let R=0;R<b.length;++R){const aa=b[R],ta=aa.NK;(3===ta||2===ta)&&aa.cp<k.length&&(++r,A.a.D6b(k.charCodeAt(aa.cp))&&++y)}return{v1k:y,Xbo:r}}}$p.vee="wctek";$p.Pag="wcac";$p.jyo=1;$p.cxk=400;$p.Uuo=90;$p.MHm=.1;Object(m.a)($p,"WordCountManagerBase",null,[356]);class iK extends $p{constructor(b,
k,r,y,R,aa,ta,Ya,xb,Mb,cc){super(b,k,r,R,xb,Mb);this.kLh=this.vnd=this.mja=null;this.ona=()=>{this.l3e()};this.hb=y;this.nd=ta;this.E3g=Ya;this.PH=cc;this.hb.tB(this.ona);this.Bve=xb.$("ReadingTimeIsEnabled")}get Zaj(){return 66}W5l(){if(this.mja)return!0;if(!this.hb||!this.hb.ib)return this.nd&&(Ka.App.iOd||n.AFrameworkApplication.Tk?this.nd.Zb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.nd.Zb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.hb.ib.clone();this.mja=b.BN(!0);if(!this.mja||!this.mja.$y())return this.izd(),!1;this.E3g&&(this.vnd=this.E3g.create(k=>b.BN(k),this.am));this.mja.moveNext();return!0}get yzf(){return 1}sGk(b){return b===lc.a.Hd||b===lc.a.paragraph?!0:this.nfb&&(b===lc.a.Ozb||b===lc.a.image||b===lc.a.anchoredObject)}B5e(b){this.sVa.reset();if(this.W5l()){for(this.nfb&&this.vnd&&(this.vnd.I_k(b,this.sVa)||this.q$d(1,b));this.mja.current;){const y=-1===b.oW?0:b.oW;let R=0;var k=this.mja.current;if(!this.sGk(k.contextId)){this.mja.moveNext();
continue}if(this.nfb&&Pd.ImageReader.Wfb(k)){b.nQ++;this.mja.moveNext();continue}if(!ie.ParagraphReader.nc(k.node)){this.mja.moveNext();continue}const aa=k.node;if(this.RKa&&this.kLh&&this.kLh.a3b(aa))this.mja.moveNext();else{if(this.nfb&&k.Sd){var r=Wd.GraphIterator.Za(aa);for(r.Pb(6);!r.qr;)Pd.ImageReader.Ov(r.currentNode)&&b.nQ++,r.xi(6)}r=this.Bve?this.QVh(aa,this.PH):1033;k=this.Jkj(b,aa,0,0,0,this.ePd(k),y,k.cpBegin,k.cpEnd,r);if(k.bki&&(R+=1,100<R)){b.oW=y+1;this.q$d(1,b);return}if(k.H0f)return;
this.mCh(b,aa);this.mja.moveNext()}}this.vnd=this.mja=null;this.$3i(b)?(this.w9c=-1,this.bLi()):this.xCi(b)}}ePd(b){let k=!1;b.contextId===lc.a.paragraph?k=!0:b.contextId===lc.a.Hd&&(k=b.cpEnd-b.cpBegin===b.node.characterData.length);return k}}Object(m.a)(iK,"SelectionWordCountManager",$p,[]);class cF{constructor(b,k){this.ORb=!1;this.kub=null;b&&k&&(this.PVb=b(!1),this.Yc=k,this.PVb.moveNext())}I_k(b,k){if(!b||!this.PVb||!this.PVb.current)return!0;do{const r=this.PVb.current;if(r.contextId===lc.a.tableRow||
r.contextId===lc.a.tableCell){for(this.kub||this.d6l(r.node);this.kub.moveNext();)if(14===this.kub.currentNode.type&&b.Ioa++,k.update(),k.Whb())return!1;this.MIk(r,b);this.kub=null}this.PVb.moveNext()}while(this.PVb.current);return!0}MIk(b,k){const r=this.Yc.Zf(b.node);r.Ab(14);b.contextId===lc.a.tableRow&&(bm.a.hei(r)&&(this.ORb=!0),bm.a.EPd(r)&&this.ORb&&(this.ORb=!1,k.Ioa++));b.contextId===lc.a.tableCell&&(Ei.TableCellReader.MNc(r)&&(this.ORb=!0),Ei.TableCellReader.ZMa(r)&&this.ORb&&(this.ORb=
!1,k.Ioa++))}d6l(b){this.kub=Pm.a.Zp(b);14===b.type?this.kub.Xm(cF.jGc,b):this.kub.Xm(cF.jGc,null)}static jGc(b){return b.parentNode?!0:!1}}Object(m.a)(cF,"TableCountSelectionTraverser",null,[357]);class jK{constructor(b){this.TSa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,k){return this.TSa?new cF(b,k):null}}Object(m.a)(jK,"TableCountSelectionTraverserFactory",null,[351]);class kK extends $p{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){super(b,k,r,R,xb,Mb);this.Wuo=jc=>{if(jc.qr)return!0;
jc=jc.role;return 1===jc||2===jc||this.nfb&&6===jc||3===jc||4===jc||5===jc||!this.RKa&&(7===jc||8===jc)};this.ga=y;this.mRj=aa;this.WZj=ta;this.bBg=Ya;this.PH=cc;this.ga.gb(Jc.a.wnj,lc.a.application,Kd.ActionManager.Of,64);this.ga.gb(Jc.a.xnj,lc.a.application,Kd.ActionManager.Of,64);this.Bve=xb.$("ReadingTimeIsEnabled")}get Zaj(){return 63}get yzf(){return 0}B5e(b){var k,r;this.sVa.reset();b.AH=!1;var y=this.mRj();De.PageReader.instance.ygb(y)||(this.jzd(),this.bLi());y=this.am.pBa(y,7,7).currentNode;
var R=this.oMk(b.currentNode,y);y=this.WZj(R,y);y.Xm(this.Wuo,null);let aa=R=0;for(var ta=0;y.moveNext();)if(y.currentNode&&this.hd.paa(y.currentNode)){var Ya=this.hd.XN(y.currentNode);if(Ya.ur){var xb=this.hd.PYa(y.currentNode);if(xb&&(xb=xb.qa.last,(null===xb||void 0===xb?0:xb.Xh)&&(jl.App.MX&&xb.fi||cs.a.psa&&(null===(r=null===(k=xb.formatting)||void 0===k?void 0:k.cache)||void 0===r?0:r.AEb))))continue;b.wordCount+=1;if(Ya=this.mB.B$b(Ya,y.currentNode))Ya=$p.nxd(Ya),b.Q5+=Ya.Uza+1,b.P5+=Ya.Uza-
Ya.qic;R+=1;aa+=b.Q5;ta+=b.P5}}else if(this.nfb&&y.currentNode&&Pd.ImageReader.Ov(y.currentNode))b.nQ++;else if(this.nfb&&y.currentNode&&Si.TableReader.eX(y.currentNode))b.Ioa++;else if(y.currentNode&&ie.ParagraphReader.nc(y.currentNode)){Ya=y.currentNode;xb=this.Bve?this.QVh(Ya,this.PH):1033;ta=this.Jkj(b,Ya,R,aa,ta,!0,-1,-1,-1,xb);if(ta.H0f){b.AH=!0;n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.mCh(b,Ya);
R=ta.uNb;aa=ta.vud;ta=ta.uud}this.$3i(b)?(this.jzd(),this.qxn(),this.cLi(b)):this.xCi(b)}oMk(b,k){b?(b=this.bBg(b),b.Ab(7)):b=this.bBg(k);return b}qxn(){switch(this.nqd){case 1:this.ga.processAction(Jc.a.wnj,2);break;case 2:this.ga.processAction(Jc.a.xnj,2)}}}Object(m.a)(kK,"TotalWordCountManager",$p,[]);class lK{constructor(){this.$Xi=this.ZXi=this.hXf=this.aYi=this.gdj=this.hdj=this.edj=this.fdj=0}get ewi(){return this.p3b(this.aYi,this.hdj,"WC")}get yPm(){return this.p3b(this.ZXi,this.edj,"NumCharsNoSp")}get zPm(){return this.p3b(this.hXf,
this.fdj,"NumCharsWithSp")}get EPm(){return this.p3b(this.$Xi,this.gdj,"NumParagraphs")}p3b(b,k,r){const y=this.F4c(k,r).toLocaleString();return 0<this.hXf?(b=this.S$f(b,k,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),y)):y}S$f(b,k,r){b=this.F4c(b,r);return b>k?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),k):b}F4c(b,k){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",k);return Math.max(b,0)}}Object(m.a)(lK,"DocumentStats",null,[]);class dF{static d0e(b){return yf.a.Rx(dF.tl,
WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.ewi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.yPm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.zPm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.EPm)}}dF.tl="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(dF,"DocumentStatsDialogHtml",null,[]);class mK extends yf.a{constructor(b){super();this.WK=!1;this.n0k=()=>{};this.Fx=b}qZn(){this.lg="DocumentStatsDialog";this.vg=dF.d0e(this.Fx);this.Gd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.n0k);this.J3("DocumentStatsTable")}eU(){}dispose(){this.WK||(super.dispose(),this.WK=!0)}}Object(m.a)(mK,"DocumentStatsDialog",yf.a,[]);class nK{constructor(b,k,r,y,R,aa,ta,Ya,xb){this.N2g=this.Boc=this.Jmc=this.NRb=this.Hwe=
!1;this.vac=()=>{this.yde()};this.rna=()=>{this.yde()};this.qRn=()=>{this.N2g=!0;return 32};this.ZPf=()=>this.Ps.tNa?32:8;this.LWc=(Mb,cc,jc,Mc,fd)=>{if(1===jc)return this.Ps.tNa?32:8;fd[Ig.a.On]=this.$uf;return 32};this.nbe=(Mb,cc,jc)=>{if(1===jc)return this.Ps.tNa?32:8;this.$uf?this.xYk():this.n3k();Ka.App.xa.nG({ShowWordCount:"CheckboxModel"});return 32};this.nfc=(Mb,cc,jc)=>{if(1===jc)return Me.a.ufa(cc)?8:this.Ps.tNa?32:8;if(this.N2g)return n.AFrameworkApplication.ya.processAction(Jc.a.qZd,2),
32;Mb=this.me.jg("UserAction","Show Word Count Dialog");Mb.start();this.Ps.u1c();this.lP.u1c();this.Ps.WC!==this.lP.WC?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");cc=this.PKk();(new mK(cc)).qZn();Mb.stop();return 32};this.ZVc=(Mb,cc,jc,Mc,fd)=>{fd||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===jc)return 32;if(!this.Ps.tNa)return fd[cl.a.Visible]=
!1,32;fd[cl.a.Visible]=!0;this.$uf?(Mb=this.Ps.WC,0>Mb?Mb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Mb?(cc=this.lP?this.lP.WC:-1,Mb=0<cc?this.sKl(Mb,cc):String.format(1===Mb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.F5d(Mb))):Mb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.F5d(Mb))):Mb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;fd[cl.a.LabelText]=Mb;return 32};
this.Ule=ta;this.Vle=aa;this.Ps=b;this.lP=k;this.nwc=r;this.QXj=R;this.lP.XPe(this.vac);this.Ps.XPe(this.vac);this.lP.CXb(this.rna);this.Ps.CXb(this.rna);this.me=Ya;this.RKa=y;this.TSa=xb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get $2e(){return!X.a.N2}Vb(){const b=n.AFrameworkApplication.ya;b.pa(Jc.a.nbe,lc.a.application,this.nbe);b.pa(Jc.a.nfc,lc.a.view,this.nfc);b.gb(Jc.a.LWc,lc.a.application,this.LWc,96);b.gb(Jc.a.ZVc,lc.a.application,this.ZVc,96);b.gb(Jc.a.ZPf,lc.a.application,
this.ZPf,96);b.pa(Jc.a.FEh,lc.a.application,this.qRn)}get RKa(){return this.Jmc}set RKa(b){this.Jmc=b;this.Ps.RKa=b;this.lP.RKa=b}n3k(){this.Ps.tNa&&(this.P2i(!0),this.yde(),this.Ps.u1c())}PKk(){const b=new lK;b.hdj=this.Ps.WC;b.fdj=this.Ps.O_b;b.edj=this.Ps.oDc;b.gdj=this.Ps.qDc;b.aYi=this.lP.WC;b.ZXi=this.lP.oDc;b.hXf=this.lP.O_b;b.$Xi=this.lP.qDc;return b}Dsl(){return this.Ule("WACWordCountEnabled",this.$2e)}O6d(b){this.Vle("WACWordCountEnabled",b?"true":"false",Ea.a.YNa)}get $uf(){this.NRb||(this.Hwe=
this.Dsl(),this.NRb=!0);return this.Hwe}P2i(b){this.O6d(b);this.Hwe=b;this.NRb=!0}xYk(){this.Ps.jzd();this.lP.jzd();this.P2i(!1);this.yde()}get hJ(){return null!=this.Frg?this.Frg:this.Frg=(()=>this.nwc())()}yde(){this.Boc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.tQk()),this.Boc=!0);this.hJ&&this.hJ.kU(this.QXj)}tQk(){const b={["words"]:this.Ps.WC,["charsWithSpaces"]:this.Ps.O_b,["charsWithNoSpaces"]:this.Ps.oDc,["paragraphs"]:this.Ps.qDc};this.TSa&&(b.images=this.Ps.fyb,
b.tables=this.Ps.kyb);return b}F5d(b){try{return b.toLocaleString()}catch(k){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",k.toString(),k.stack))}return b.toString()}sKl(b,k){k>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),k=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.F5d(k),this.F5d(b))}}Object(m.a)(nK,"WordCountActor",
null,[]);class oK extends Hr.a{constructor(b,k,r,y){super();this.l3=(R,aa)=>{if(aa.property===Te.a.mo||aa.property===Te.a.wn)R=aa.node,aa=jl.App.En.jb.Fc,aa.Sr&&aa.ld&&aa.ld.Mc&&R.Mc&&R.Mc.id===aa.ld.Mc.id&&this.OFh(R)};this.gAi=(R,aa)=>{this.OFh(aa.node)};this.dXm=(R,aa)=>{aa.property!==td.a.Rv&&aa.property!==wc.a.Vr||this.rX()};this.xXd=()=>{this.rX()};this.U0=b;this.Ps=k;this.Tp=r;this.TSa=y.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}ez(){var b=this.Tp.Ve(12);b.qp(this.l3);b.Wt(this.gAi);
b.Zu(this.gAi);b=this.Tp.Ve(22);b.qp(this.dXm);b.Wt(this.xXd);b.Zu(this.xXd);this.TSa&&this.Fon();this.U0.koa(this,7)}Fon(){var b=[19,14];for(let k of b)b=this.Tp.Ve(k),b.Wt(this.xXd),b.Zu(this.xXd)}get index(){return 1}run(){this.Ps.l3e()}OFh(b){b.Y4c=null;this.rX()}}Object(m.a)(oK,"WordCountAppEventCoordinator",Hr.a,[]);class hG{}hG.G1j="AccurateWordCountButton";Object(m.a)(hG,"WordCountConstants",null,[]);class pK{constructor(b,k){this.Ps=b;this.lP=k}getInstance(b){switch(b){case 1:return this.lP;
case 0:return this.Ps;default:return this.Ps}}}Object(m.a)(pK,"WordCountManagerFactory",null,[229]);class iG{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}zc(b){this.W=b;const k=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new jK(k)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new hp.a(10,Qe.a.kf);const y=new kK(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Io.a,n.AFrameworkApplication.ya,n.AFrameworkApplication.uc,()=>jl.App.En.jb.Fc.ld,Pm.a.Lr,Wd.GraphIterator.Za,k,r,Va.a.instance.resolve("Box4.ILanguageReader"));r=new iK(Va.a.instance.resolve("Box4.List.IListReader"),Va.a.instance.resolve("Box4.IListMarkerUtility"),new Io.a,bh.a.instance,n.AFrameworkApplication.uc,Ev.a.instance,Db.a.instance,Va.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),k,r,Va.a.instance.resolve("Box4.ILanguageReader"));return new pK(y,r)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new aK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Ka.App.xa.jb;b.Xta?this.hha():b.zda(()=>{this.hha()})}hha(){if(Ka.App.ik){var b=Ka.App.ik.ml;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var k=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
y=Va.a.instance.resolve("Common.IAppSettingsManager");(new nK(k,r,()=>Va.a.instance.Pa("WordEditor.IStatusBarUser"),this.Irl(),hG.G1j,Ea.a.$Pa,Ea.a.ula,Va.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),y)).Vb();(new oK(Fl.GraphTransactionManager.instance,k,b,y)).ez();k.l3e()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}Irl(){var b=
jl.App.En.jb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Fc;if(!b)return v.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ld;return b?b.ia(wc.a.RKa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){M.a.instance.Pc(new iG)}}Object(m.a)(iG,"PackageManager",null,[1,2]);var oM=c(1892);class qK{constructor(b){this.wGe=null;b.$a("Common.App.SearchCommon.SearchHostRuntime").execute(k=>{this.wGe=k})}m_i(b){this.wGe&&this.wGe.dff().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(qK,"DocumentContentExtractionManager",null,[326]);class Sh{}Sh.R1n="mso_smartLookup";Sh.channelId="SmartLookup";Sh.Q1n="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Sh.U7i="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Sh.V7i="https://uci.cdn.office.net/mirrored/smartlookup/";Sh.P1n="https://hedwigtestserver.blob.core.windows.net/builds/";Sh.O1n="http://localhost:8080/";Sh.Y0c="current";Sh.T7i="next";Sh.N3m=2;Sh.Jac=1;Sh.$ib=CommonUIStrings.L_SmartLookupPaneTitle;
Sh.ny="InsightsTaskPane";Sh.c5f="InsightsTaskPaneData";Sh.xmf="InsightsContentFrame";Sh.width=400;Sh.nKm="ApplicationPropertiesRequest";Sh.AKm="SelectionRequest";Sh.uKm="PageRendered";Sh.mKm="ApplicationProperties";Sh.zKm="Selection";Sh.CKm="Telemetry";Sh.BKm="TakeFocus";Sh.tKm="LostFocus";Sh.qKm="Keyboard";Sh.rKm="LegalAgreed";Sh.Ixo="WordWac";Sh.M0m="OneNoteWAC";Sh.eLf="yes";Sh.lbj="appCorrelationId";Sh.R9n="clientCorrelationId";Sh.mbj="message";Sh.jmi="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)(Sh,"InsightsConstants",null,[]);var XD=c(1551);class $C{}Object(m.a)($C,"ActivityContractInfo",null,[]);class Es{}Object(m.a)(Es,"BrowserPaneDataField",null,[]);class aD{}Object(m.a)(aD,"BrowserPaneTelemetryEvent",null,[]);class Wl{static ZA(b,k){const r=new aD;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new $C,{success:!0});const y=[],R=new Es;R.name="Message";R.dataType=0;R.value=b;b=new Es;b.name="Level";b.dataType=0;b.value=Wl.getLevelString(k);Array.add(y,
R);Array.add(y,b);r.dataFields=y;Wl.sendTelemetryEvent(r)}static rYi(b,k){const r=new aD;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new $C,{success:!0});b=[];const y=new Es;y.name="AppCorrelationId";y.dataType=0;y.value=k;Array.add(b,y);r.dataFields=b;Wl.sendTelemetryEvent(r)}static JHn(b,k,r,y,R,aa){const ta=new aD;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new $C,{success:!0});const Ya=[],xb=new Es;xb.name="IsNetworkConnected";xb.dataType=
0;xb.value=b?"true":"false";b=new Es;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=k?"true":"false";k=new Es;k.name="EntryPoint";k.dataType=0;k.value=r;r=new Es;r.name="RuntimeVersion";r.dataType=0;r.value=y;y=new Es;y.name="IsFirstRelease";y.dataType=1;y.value=R?"true":"false";R=new Es;R.name="IsZeroTerm";R.dataType=1;R.value=aa?"true":"false";aa=new Es;aa.name="IsClientSideRendering";aa.dataType=1;aa.value="false";Array.add(Ya,xb);Array.add(Ya,k);Array.add(Ya,b);Array.add(Ya,r);Array.add(Ya,
y);Array.add(Ya,R);Array.add(Ya,aa);ta.dataFields=Ya;Wl.sendTelemetryEvent(ta)}static kXf(b,k,r){const y=new aD;y.eventName="CDNDownloadLatency";y.isActivity=!0;y.activityContract=Object.assign(new $C,{duration:r,success:!0});r=[];const R=new Es;R.name="CDNHostname";R.dataType=0;R.value=b;b=new Es;b.name="Filename";b.dataType=0;b.value=k;Array.add(r,R);Array.add(r,b);y.dataFields=r;Wl.sendTelemetryEvent(y,1)}static Pdc(b,k,r,y,R,aa,ta,Ya){const xb=new aD;xb.eventName="LaunchPane";xb.isActivity=!0;
xb.activityContract=Object.assign(new $C,{duration:k,success:!0});k=[];const Mb=new Es;Mb.name="AppCorrelationId";Mb.dataType=0;Mb.value=b;b=new Es;b.name="EntryPoint";b.dataType=0;b.value=r;r=new Es;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const cc=new Es;cc.name="UxVersion";cc.dataType=0;cc.value=y;y=new Es;y.name="FeatureGates";y.dataType=0;y.value=R;R=new Es;R.name="IsFirstRelease";R.dataType=1;R.value=aa?"true":"false";aa=new Es;aa.name="IsZeroTerm";aa.dataType=1;aa.value=ta?
"true":"false";ta=new Es;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Ya?"true":"false";Array.add(k,Mb);Array.add(k,b);Array.add(k,r);Array.add(k,cc);Array.add(k,y);Array.add(k,R);Array.add(k,aa);Array.add(k,ta);xb.dataFields=k;Wl.sendTelemetryEvent(xb)}static sendTelemetryEvent(b,k=2){if(b.isFeedbackActivity)Wl.uzm(b.eventName);else{var r=-1<b.eventName.indexOf(Wl.kbj)?b.eventName:Wl.kbj+b.eventName,y=Wl.Mql(b.dataFields);b.isActivity?(b=Object.assign(new Jh.a,{name:r,samplingPolicy:k,
dataFields:y,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),Y.a.sendActivityEvent(b)):(b=Object.assign(new ha.a,{name:r,samplingPolicy:k,dataFields:y}),Y.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Mql(b){const k=[];if(b&&0<b.length)for(const r of b)(b=Ji.a.Kea(r.name,r.value,Wl.NHk(r.dataType)))&&Array.add(k,b);return k}static NHk(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static uzm(b){const k=Va.a.instance.Pa("Common.ISystemInitiatedFeedback");k?k.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Wl.kbj="Office.Insights.SmartLookup.";Object(m.a)(Wl,"TelemetryUtils",null,[]);var bD;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.prefetch=99]="prefetch"})(bD||(bD={}));Object(m.b)("EntryPoint",bD);var ut=c(1492),Vv=c(1503);class Ot{static D2(b,k,r,y,R,aa){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;if(R.value.QXn())return Wl.ZA("Skipping Serplet launch",10),
32;k=aa;if(!k)return 8;b=Ot.hAb();if(r=k.CommandValueId)try{k=x.a(r)}catch(ta){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=k;k.selection||(k.neighborhood?r=Object.assign(new ut.a,{selection:k}):(k=R.value.QAb(),r.selection=Object.assign(new Vv.a,{neighborhood:k.neighborhood,mentionStart:k.mentionStart,mentionLength:k.mentionLength})));r.selection.clientDetectedLanguage=R.value.dUh();return Ot.w1b(aa,null,r,b,0,R)}static w1b(b,
k,r,y,R,aa){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";r&&(ta.entryPoint=bD[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,Ot.iT("Show insights",y,ta));k?aa.value.h_n(k,y,R):r&&aa.value.i_n(r,y,R);return 32}static iT(b,k,r=null){b={["appCorrelationId"]:k,["message"]:b};if(r)for(let y in r)b[y]=r[y];return x.c(b)}static hAb(){return Ra.a.create().toString()}}Object(m.a)(Ot,"InvokingPaneUtils",null,[]);class rK{}Object(m.a)(rK,"LaunchDataInDoc",null,[]);var mu=c(1506);class jG{constructor(b,
k,r,y,R,aa,ta,Ya,xb){this.Mmc=this.Ybd=this.$v=null;this.kB=b;this.ga=k||n.AFrameworkApplication.ya;this.Ro=r;this.Ub=y;this.zNg=Ya;this.Bsc=R;this.Oa=aa;this.Hb=ta;this.c5l();this.JSa=new cg.a(()=>new Gl.a(xb.value,Object(u.a)(this,this.aBb,"getMoreInfoEventReceived")))}Vb(){this.ga.pa(ib.a.S8l,zc.a.frame,Object(u.a)(this,this.f_n,"showInsights"));this.ga.pa(ib.a.T8l,zc.a.frame,Object(u.a)(this,this.g_n,"showInsightsForTellMe"));this.ga.pa(ib.a.definitions,zc.a.frame,Object(u.a)(this,this.gZn,"showDefinitions"));
this.ga.pa(ib.a.i3e,zc.a.frame,Object(u.a)(this,this.hZn,"showDefinitionsForTellMe"));this.ga.pa(ib.a.g1f,zc.a.frame,Object(u.a)(this,this.g1f,"showInsightsForSuggestion"));this.zNg&&(this.ga.pa(ib.a.nfa,zc.a.frame,Object(u.a)(this,this.D2,"invokeSmartLookupPane")),this.ga.pa(ib.a.$Mc,zc.a.frame,Object(u.a)(this,this.$Mc,"invokeInDocSerplet")),this.ga.pa(ib.a.FNd,zc.a.frame,Object(u.a)(this,this.FNd,"invokeSerpletRibbon")),this.ga.pa(ib.a.aNc,zc.a.frame,Object(u.a)(this,this.aNc,"invokeSerpletContextMenu")),
this.ga.pa(ib.a.wpf,zc.a.frame,Object(u.a)(this,this.wpf,"invokeSerpletTellMeZeroTerm")),this.ga.pa(ib.a.vpf,zc.a.frame,Object(u.a)(this,this.vpf,"invokeSerpletTellMeNotes")),this.ga.pa(ib.a.BNd,zc.a.frame,Object(u.a)(this,this.BNd,"invokeImageSerpletContextMenu")),this.ga.pa(ib.a.GNd,zc.a.frame,Object(u.a)(this,this.GNd,"invokeSynonymsSerpletContextMenu")),this.ga.pa(ib.a.ANd,zc.a.frame,Object(u.a)(this,this.ANd,"invokeDictionarySerpletContextMenu")),this.ga.pa(ib.a.INd,zc.a.frame,Object(u.a)(this,
this.INd,"invokeZeroTermSerpletContextMenu")),this.ga.pa(ib.a.zNd,zc.a.frame,Object(u.a)(this,this.zNd,"invokeDefinitionSearchFromFloatie")),this.ga.pa(ib.a.ENd,zc.a.frame,Object(u.a)(this,this.ENd,"invokeSerpletBrowseFiles")),this.ga.pa(ib.a.CNd,zc.a.frame,Object(u.a)(this,this.CNd,"invokeInDocSerpletWithLaunchData")),this.ga.pa(ib.a.t2d,zc.a.frame,Object(u.a)(this,this.t2d,"queryToggleSerplet")),this.ga.pa(ib.a.b7d,zc.a.frame,Object(u.a)(this,this.b7d,"setInDocSearchParameter")),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.ga.pa(ib.a.$ai,zc.a.frame,Object(u.a)(this,this.z$l,"invokeSmartLookupPaneConversations")),this.ga.pa(ib.a.xNd,zc.a.frame,Object(u.a)(this,this.xNd,"invokeAutoLaunchSearchRequest"))),this.onn().continueWith(()=>{n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.updateCommandUI(!0)}))}l9g(){this.ga.gb(ib.a.vCa,zc.a.frame,Object(u.a)(this,this.vCa,"invokeFilesSerplet"),4);this.ga.gb(ib.a.ppf,zc.a.frame,Object(u.a)(this,this.vCa,"invokeFilesSerplet"),4);this.ga.gb(ib.a.Vai,zc.a.frame,
Object(u.a)(this,this.p$l,"invokeLinkFilesSerplet"),4);if(this.Oa.$("IsTellMeUpSellEnterpriseEnabled")&&this.Oa.$("SmartLookupTokenPrefetchIsEnabled")){const b=nd.a.j$(0,Object(u.a)(this,this.kHi,"prefetchToken"),0,177);this.Hb.fc(b)}}rPe(){ni.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.pa(ib.a.vCa,zc.a.frame,Object(u.a)(this,this.qpf,"invokeFilesSerpletUnavailable")),this.ga.pa(ib.a.ppf,zc.a.frame,Object(u.a)(this,
this.qpf,"invokeFilesSerpletUnavailable")),this.ga.pa(ib.a.Vai,zc.a.frame,Object(u.a)(this,this.qpf,"invokeFilesSerpletUnavailable")))}kHi(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.mhc().then(k=>{let r=1;if(k)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.AXf("SmartLookupFiles: Token prefetch succeeded",!0),k=6E4*this.Oa.rc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.AXf("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Oa.rc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.AXf("SmartLookupFiles: Token prefetch max retry count reached",!1);return}k=6E4*this.Oa.rc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}k=new nd.a(3,1,k,Object(u.a)(this,
this.kHi,"prefetchToken"),177);k.data=r.toString();this.Hb.fc(k)})}AXf(b="",k=!1){this.Bsc.execute(r=>{r&&r.skb("PrefetchToken",k,0,"SmartLookup",b)})}mhc(){return this.Bsc?new Promise(b=>{this.Bsc.execute(k=>{if(k){var r=Date.now();k.getToken("SmartLookup",this.Oa.lb("SmartLookupShredderServiceEndpoint")).then(y=>{b(!!y&&0<y.length);k.skb("TryGetTokenInternal",!!y&&0<y.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}onn(){const b=new zh.a;if(this.Oa.$("BrowserSupportsInsightsPaneSSO"))this.l9g(),
b.Eg(!0);else{if(!this.Bsc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Eg(!1),this.rPe(),b.task;this.Bsc.execute(k=>{k?k.getToken("SmartLookup",this.Oa.lb("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.l9g(),b.Eg(!0)):this.rPe()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.Eg(!1),this.rPe())})}return b.task}f_n(b,k,r,y,R){if(1===r)return n.AFrameworkApplication.ta&&
n.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!n.AFrameworkApplication.qCc?8:this.kB.value.gfi()?32:8;b=Ot.hAb();k=this.kB.value.QAb();return this.zNg?(k=Object.assign(new Vv.a,{neighborhood:k.neighborhood,mentionStart:k.mentionStart,mentionLength:k.mentionLength}),k=Object.assign(new ut.a,{selection:k,userIntent:null,entryPoint:0,launchData:Object.assign(new mu.a,{landingTab:"All"})}),Ot.w1b(R,null,k,b,0,this.kB)):Ot.w1b(R,k,null,b,0,this.kB)}gZn(b,k,r,y,R){if(1===r)return this.kB.value.gfi()?
32:8;b=Ot.hAb();k=this.kB.value.QAb();return Ot.w1b(R,k,null,b,1,this.kB)}g_n(b,k,r,y,R){return 1===r?32:this.$Gh(R,0)}hZn(b,k,r,y,R){return 1===r?32:this.$Gh(R,1)}$Gh(b,k){const r=Ot.hAb(),y=b.CommandValueId;let R;try{R=x.a(y)}catch(aa){return v.ULS.sendTraceTag(6295941,1303,15,Ot.iT(String.format("Insights parameters [{0}] is not in proper format.",y),r)),8}return Ot.w1b(b,R,null,r,k,this.kB)}g1f(b,k,r,y,R){if(1===r)return 32;if(!R)return 8;b=R.query?R.query:"";k=Ot.hAb();r=new XD.a;r.neighborhood=
b;r.mentionStart=0;r.mentionLength=b.length;return Ot.w1b(R,r,null,k,0,this.kB)}p$l(b,k,r,y){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;const R=n.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),aa=this.kB.value.LYa();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new mu.a,{landingTab:"File"}),entryPoint:R?32:10}))}vCa(b,k,r,y){if(1===r)return Ae.SessionStatusManager.instance.pK?
32:8;const R=n.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),aa=this.kB.value.LYa();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new mu.a,{landingTab:R?"Slide":"File"}),entryPoint:R?20:10}))}qpf(){return 2}$Mc(b,k,r,y,R){if(1===r)return Ae.SessionStatusManager.instance.Tj?8:32;const aa=this.kB.value.LYa();R=void 0===R||null===R?18:19;return this.D2(b,k,r,y,Object.assign(new ut.a,
{selection:Object.assign(new Vv.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new mu.a,{landingTab:"Indoc"}),entryPoint:R}))}CNd(b,k,r,y,R){R=R.CommandValueId;if(!R||R&&this.Mmc&&R.query===this.Mmc.query&&R.matchCase===this.Mmc.matchCase&&R.matchWholeWordOnly===this.Mmc.matchWholeWordOnly)return 32;const aa=this.kB.value.LYa();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:aa.neighborhood,
mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new mu.a,{landingTab:"Indoc",data:Object.assign(new rK,{type:4,query:R.query,matchCase:R.matchCase,matchWholeWord:R.matchWholeWordOnly})}),entryPoint:18}))}t2d(b,k,r,y,R){R&&(R[Ig.a.On]=this.kB.value.RDb);return 32}b7d(b,k,r,y,R){if(b=R.CommandValueId)this.Mmc=b;return 32}z$l(b,k,r){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;b=this.kB.value.LYa();b=Object.assign(new ut.a,{selection:Object.assign(new Vv.a,
{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new mu.a,{landingTab:"All"})});this.kB.value.ZRd(b);return 32}xNd(b,k,r){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;b=this.kB.value.LYa();b=Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new mu.a,{landingTab:"All",data:n.AFrameworkApplication.Xyb})});
k=Ot.hAb();this.kB.value.TJb(b,k);return 32}FNd(b,k,r,y){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;const R=this.kB.value.fUh();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:R.mentionLength}),entryPoint:4,launchData:Object.assign(new mu.a,{landingTab:"All"})}))}aNc(b,k,r,y){return this.D2(b,k,r,y,Object.assign(new ut.a,{entryPoint:5,launchData:Object.assign(new mu.a,{landingTab:"All"})}))}wpf(b,
k,r,y){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;const R=this.kB.value.LYa();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:0}),launchData:Object.assign(new mu.a,{landingTab:"All"}),entryPoint:26}))}ANd(b,k,r,y){return 1===r?(b=this.kB.value.QAb())&&0<b.mentionLength?32:8:this.D2(b,k,r,y,Object.assign(new ut.a,{entryPoint:22,launchData:Object.assign(new mu.a,{landingTab:"All"})}))}zNd(b,
k,r,y){return 1===r?(b=this.kB.value.QAb())&&0<b.mentionLength?32:8:this.D2(b,k,r,y,Object.assign(new ut.a,{entryPoint:7,launchData:Object.assign(new mu.a,{landingTab:"All"})}))}BNd(b,k,r,y){return this.D2(b,k,r,y,Object.assign(new ut.a,{launchData:Object.assign(new mu.a,{landingTab:"Image"}),entryPoint:9}))}GNd(b,k,r,y){return this.D2(b,k,r,y,Object.assign(new ut.a,{launchData:Object.assign(new mu.a,{landingTab:"All"}),entryPoint:24}))}vpf(b,k,r,y){return this.D2(b,k,r,y,Object.assign(new ut.a,{launchData:Object.assign(new mu.a,
{landingTab:"Notes"}),entryPoint:33}))}INd(b,k,r,y){if(1===r)return Ae.SessionStatusManager.instance.pK?32:8;const R=this.kB.value.LYa();return this.D2(b,k,r,y,Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:R.neighborhood,mentionStart:R.mentionStart,mentionLength:0}),launchData:Object.assign(new mu.a,{landingTab:"All"}),entryPoint:27}))}D2(b,k,r,y,R){return Ot.D2(b,k,r,y,this.kB,R)}ENd(b,k,r){if(1===r)return 32;this.$v||this.JSa.value.fk("Browse File from Search pane",!0);
if(!this.Ybd||""===this.Ybd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Qe.a.Gm(this.Ybd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}aBb(b){this.$v||3!==b.state||(this.$v=b,this.Ybd=this.$v.dba)}c5l(){const b=this.Ub.re(Sh.ny);b.parent=id.AFrame.Qp;b.wda(Object(u.a)(this,this.Odc,"sendIFrameTakeFocusMessage"));this.Ro.wS(Sh.ny)}Odc(){document.activeElement.blur();n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Dgb||(this.kB.value.jMn(),
this.kB.value.HHn())}dispose(){this.kB.value&&this.kB.value.dispose()}}Object(m.a)(jG,"InsightsActor",null,[10]);const kG=b=>{b=b.split("-");return b[b.length-1]},qM=()=>{var b=eF();if(b)return Promise.resolve(b);b=YD().replace("SearchWeb","searchweb");b=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Sh.T7i+"/":b+Sh.Y0c+"/";b+="version.json";if(X.a.maa)return pM(b);try{const k=new Sys.Net.WebRequest;k.set_httpVerb("GET");k.set_url(b);
b={};b.method=k.get_httpVerb();return"function"!==typeof window.fetch?(Wl.ZA("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(k.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Wl.ZA("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=x.b(JSON.stringify(r));return r.version?r.version:""},r=>{Wl.ZA("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(k){return Wl.ZA("InsightsUtils - Failed to download version.json: "+k.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+k.toString()),Promise.resolve("")}},pM=b=>{const k=n.AFrameworkApplication.af;return new Promise(r=>{const y=new aF.a(b,1,null,null,!0,2,null);k.send(y).bEa(R=>{R&&R.data?R.data.Ie||(Wl.ZA("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
R.data.Df,10),r("")):(Wl.ZA("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const aa=x.b(R.data.Ie);aa.version&&r(aa.version)}catch(aa){Wl.ZA("InsightsUtils - Failed to deserialize version: "+aa.toString(),10),r("")}},R=>{R&&R.data?Wl.ZA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+R.data.Df,10):Wl.ZA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);r("")})})},fF=()=>n.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),gF=()=>{const b=YD();return fF()||n.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?b+eF()+"/":n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Sh.T7i:b+Sh.Y0c},eF=()=>fF()?"dev":n.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?
n.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/")[1]:n.AFrameworkApplication.K.lb("SmartLookupClientVersion"),lG=b=>{var k=3===n.AFrameworkApplication.ta.Rb.ko?"wordwac":2===n.AFrameworkApplication.ta.Rb.ko?"pptwac":"excelwac";var r=yh.a.qg(n.AFrameworkApplication.lcid);const y=r?r.name:"en-us";r=YD();const R=lB();k="main_ssr_wac.html?appName="+k+"&culture="+y;return"LOCAL"===R?r+k:r+((""!==b?b:Sh.Y0c)+"/")+k},rM=b=>YD()+(""!==b?b:Sh.Y0c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
YD=()=>{switch(lB()){case "LOCAL":return Sh.O1n;case "PR":const b=n.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/");return Sh.P1n+b[0]+"/";case "INT":return Sh.Q1n;case "EDOG":return Sh.U7i;default:return Sh.V7i}},sM=()=>{if(!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(lB()){case "EDOG":return Sh.U7i;case "PROD":return Sh.V7i;default:return""}},lB=()=>{if(n.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(n.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(n.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(n.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")&&n.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc"))return"PR";if(fF())return"LOCAL";switch(Object(ia.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=n.AFrameworkApplication.K.lb("UserPrincipalName");b=A.a.mh(b);const k=
n.AFrameworkApplication.K.Hv("SmartLookupINTEnabledForSKITeam")?n.AFrameworkApplication.K.NB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(k,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},sK=()=>{let b;b=n.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":n.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":n.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":lB();const k=n.AFrameworkApplication.K.lb("IntentServiceEndpoint"),r=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==k)return k+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return n.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class tK{sendTelemetryEvent(b){Wl.sendTelemetryEvent(b)}}Object(m.a)(tK,"OtelTelemetrySink",null,[348]);class uK{}Object(m.a)(uK,"ApplicationProperties",null,[]);class vK{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(vK,"CurrentDocumentProperties",null,[]);class wK{}Object(m.a)(wK,"EnterpriseUserInfo",null,[]);class xK{}Object(m.a)(xK,"FeatureGates",
null,[]);class mG{constructor(b,k){this.mu=this.Fi=null;this.qqi=!0;this.Uub=k;this.uy=b;this.uy.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(y=>{this.qqi=y}).catch(y=>{Wl.ZA("SearchHelper - Failed to check if Feedback feature is enabled: "+y.toString(),15)})});b=sK();k=n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(n.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.mu=
{};const r=this.CKl();if(r&&0<r.length)for(let y=0;y<r.length;y++){const R=r[y],aa=this.NKl(R);switch(aa.toLowerCase()){case "true":this.mu[R]=!0;break;case "false":this.mu[R]=!1;break;default:this.mu[R]=aa}}this.mu.EnableInDocumentSearch=k;this.mu.EnableInDocumentSearchReplace=!0;this.mu.EnableInDocumentParamLocalSearch=!0;this.mu.EnableInDocumentQuerySuggest=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.mu.EnableInDocumentQuestionGeneration=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.mu.EnableInDocumentGlobalEncoder=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.mu.EnableInDocumentExperiment1=
k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.mu.EnableInDocumentExperiment2=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.mu.EnableInDocumentExperiment3=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.mu.EnableZeroTermAutoRefresh=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.mu.EnableTap3SZeroTerm=n.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.mu.EnableLocalSearch=!0;
this.mu.EnableInDocumentStickyFilters=!0;this.mu.IntentServiceEndpoint=b;this.mu.EnablePDFShredding=n.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.mu.FilterNonPPTFilesForReuseSlides=n.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.mu.UXBundleVersion=eF();this.mu.SmartLookupServicePath=gF();this.mu.EnableAcronymSearch=!0;this.mu.UseAltAnswerEndpoint1=
n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.mu.UseAltAnswerEndpoint2=n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.mu.UseAltAnswerEndpoint3=n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.mu.UseNextUXVersion=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.mu.IgnoreNeighborhoodContext=n.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.mu.ShowDebugInfo="INT"===lB();this.mu.DebugCommands=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.mu.ChangeGates=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.mu.QnaInMixSection=!0;this.mu.EnableNoteSearch=n.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.mu.EnableWikiL2=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.mu.EnableFilteringOutRedundantKPE=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.mu.EnableZeroTermEntitySuggestion=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.mu.RankingModels=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.mu.EnableClientSideRendering=!0}else this.Fi=new xK,this.Fi.EnableInDocumentSearch=k,this.Fi.EnableInDocumentSearchReplace=!0,this.Fi.EnableInDocumentParamLocalSearch=!0,this.Fi.EnableInDocumentQuerySuggest=k&&
n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Fi.EnableInDocumentQuestionGeneration=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Fi.EnableInDocumentGlobalEncoder=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.Fi.EnableInDocumentExperiment1=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Fi.EnableInDocumentExperiment2=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1),this.Fi.EnableInDocumentExperiment3=k&&n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Fi.EnableZeroTermAutoRefresh=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Fi.EnableTap3SZeroTerm=n.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Fi.EnableLocalSearch=!0,this.Fi.EnableInDocumentStickyFilters=!0,this.Fi.IntentServiceEndpoint=b,this.Fi.EnablePDFShredding=n.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Fi.FilterNonPPTFilesForReuseSlides=n.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Fi.UXBundleVersion=eF(),this.Fi.SmartLookupServicePath=gF(),this.Fi.EnableAcronymSearch=
!0,this.Fi.UseAltAnswerEndpoint1=n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Fi.UseAltAnswerEndpoint2=n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Fi.UseAltAnswerEndpoint3=n.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Fi.UseNextUXVersion=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Fi.IgnoreNeighborhoodContext=n.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Fi.ShowDebugInfo="INT"===lB(),this.Fi.DebugCommands=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Fi.ChangeGates=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Fi.QnaInMixSection=!0,this.Fi.EnableNoteSearch=n.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Fi.EnableWikiL2=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Fi.EnableFilteringOutRedundantKPE=
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Fi.EnableZeroTermEntitySuggestion=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Fi.RankingModels=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Fi.EnableClientSideRendering=!0,this.Fi.SharedSerpletFeatureGate1=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Fi.SharedSerpletFeatureGate2=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Fi.SharedSerpletFeatureGate3=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Fi.SharedSerpletFeatureGate4=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Fi.SharedSerpletFeatureGate5=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Fi.SharedSerpletFeatureGate6=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Fi.SharedSerpletFeatureGate7=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Fi.SharedSerpletFeatureGate8=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Fi.SharedSerpletFeatureGate9=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Fi.SharedSerpletFeatureGate10=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Fi.SharedSerpletFeatureGate11=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Fi.SharedSerpletFeatureGate12=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Fi.SharedSerpletFeatureGate13=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Fi.SharedSerpletFeatureGate14=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Fi.SharedSerpletFeatureGate15=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Fi.SharedSerpletFeatureGate16=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Fi.SharedSerpletFeatureGate17=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Fi.SharedSerpletFeatureGate18=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Fi.SharedSerpletFeatureGate19=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Fi.SharedSerpletFeatureGate20=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Fi.SharedSerpletFeatureGate21=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Fi.SharedSerpletFeatureGate22=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Fi.SharedSerpletFeatureGate23=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Fi.SharedSerpletFeatureGate24=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Fi.SharedSerpletFeatureGate25=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Fi.SharedSerpletFeatureGate26=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Fi.SharedSerpletFeatureGate27=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Fi.SharedSerpletFeatureGate28=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Fi.SharedSerpletFeatureGate29=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Fi.SharedSerpletFeatureGate30=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Fi.SharedSerpletFeatureGate31=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Fi.SharedSerpletFeatureGate32=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Fi.SharedSerpletFeatureGate33=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Fi.SharedSerpletFeatureGate34=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Fi.SharedSerpletFeatureGate35=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Fi.SharedSerpletFeatureGate36=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Fi.SharedSerpletFeatureGate37=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Fi.SharedSerpletFeatureGate38=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Fi.SharedSerpletFeatureGate39=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Fi.SharedSerpletFeatureGate40=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Brc=Va.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.IFb=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Fhb=mG.isEnterpriseUser();this.QNa=n.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint");this.ozf=Oa.a.t2(n.AFrameworkApplication.K.lb("AppCatalogUrl")||"");this.IFm=n.AFrameworkApplication.K.lb("UserPrincipalName");(this.Fhb||this.IFb)&&this.B_h()}NKl(b){return n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+
b,"")}CKl(){const b=n.AFrameworkApplication.K.eYa,k=n.AFrameworkApplication.K.NB("SmartLookupFlightKeywordList"),r=[];if(b&&k&&0<k.length)for(let R in b){var y={key:R,value:b[R]};y=y&&y.key?y.key:"";for(let aa=0;aa<k.length;aa++)if(-1<y.toLowerCase().indexOf(k[aa].toLowerCase())){const ta=y.split(".");ta&&4===ta.length&&Array.add(r,ta[ta.length-1])}}return r}lif(b,k,r,y){return new Promise(R=>{this.Mmm().then(aa=>{const ta=new uK;ta.anid="";ta.applicationName=3===n.AFrameworkApplication.ta.Rb.ko?
"WORD":"POWERPNT";ta.applicationVersion=n.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:Ot.hAb();ta.themePlatform="web";ta.lcid=n.AFrameworkApplication.lcid;ta.launchUtcTime=(new Date).toUTCString();n.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=x.c(this.mu):ta.featureGates=x.c(this.Fi);var Ya=yh.a.qg(n.AFrameworkApplication.lcid);Ya=Ya?Ya.name:null;ta.market=kG(Ya);ta.uiLanguage=Ya;ta.sessionId=n.AFrameworkApplication.userSessionId;ta.themeId=r;ta.parentalControl=
"yes";ta.processorOnlyMode=aa;ta.isEditingAllowed=k.isEditingAllowed();ta.isFeedbackEnabled=this.qqi;ta.isClientSideRendering=18===y||19===y||15===y;ta.disableClipboard=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&n.AFrameworkApplication.kM&&!n.AFrameworkApplication.izb;ta.accessToken=this.Fhb||this.IFb?this.B_h():"";aa=new wK;aa.CountryCode=kG(Ya);aa.ServiceEndpoint=this.QNa;aa.IsGoLocal=n.AFrameworkApplication.K.$("IsGoLocalEnvironment");
aa.IsEnabled=this.Fhb;aa.IsEnterpriseEnabled=this.Fhb;aa.TenantRoot=this.ozf;aa.Upn=this.IFm;Ya=lB();aa.IsEUDB="PROD"===Ya&&""!==n.AFrameworkApplication.K.lb("IntentServiceEndpoint");ta.enterpriseUserInfo=aa;aa=new vK;aa.filePath=n.AFrameworkApplication.K.lb("EditDocInClientUrl");aa.docName=n.AFrameworkApplication.K.lb("FileName");aa.author=99!==y?k.author():null;aa.createdDate=99!==y?k.createdDate():null;ta.currentDocument=aa;R(ta)})})}Mmm(){return new Promise(b=>{this.uy?this.uy.execute(k=>{k.isFeatureEnabled(Sh.R1n,
!0).then(r=>{b(!r)}).catch(r=>{Wl.ZA("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}u6m(b){this.Brc&&(this.Fhb||this.IFb)&&this.B1h(this.QNa).then(k=>{b(k)})}B_h(){if("Dev Box"===n.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const b=this.IFb?"Search":"SmartLookup";return this.Brc?
this.Brc.tOl(b,this.QNa,this.IFb):""}B1h(b){if("Dev Box"===n.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(r=>{r(window.SearchPaneShredderTokenOverride)});const k=this.IFb?"Search":"SmartLookup";return this.Brc?this.Brc.getToken(k,b,this.IFb):Promise.resolve("")}LJc(){return this.Uub?this.Uub.getVersion():""}mtl(){return n.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?
x.c(this.mu):x.c(this.Fi)}static isEnterpriseUser(){const b=n.AFrameworkApplication.K.lb("SovereignEnvironmentName"),k=n.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&k}}Object(m.a)(mG,"SearchHelper",null,[327]);class jC{constructor(){jC._instance=""}getVersion(){return jC._instance}vSn(b){jC._instance=b}}jC._instance=null;Object(m.a)(jC,"SmartLookupVersion",null,[]);class yK{}Object(m.a)(yK,"ConfigurationProvider",null,[]);class cD{constructor(b){cD._instance=
b}dff(){return cD._instance}}cD._instance=null;Object(m.a)(cD,"SearchHostRuntime",null,[]);class nG{constructor(){this.Eca=this.dOb=this.W=null}get name(){return"Common.App.Insights"}zc(b){this.W=b;const k=Jg.a.Lq(Va.a.instance.$a("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=n.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||n.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(jG,"Common.App.Insights.InsightsActor").singleInstance().Zd(()=>new jG(b.Ze("Common.App.Insights.IInsightsManager"),
n.AFrameworkApplication.ya,Jn.a.instance,Id.FocusManager.instance(),b.$a("Common.App.SearchCommon.ISearchOAuthManager"),n.AFrameworkApplication.K,Mg.a.instance,r,new cg.a(()=>k.result)));b.register(326,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Zd(()=>new qK(b));r&&(b.register(jC,"Common.App.Insights.SmartLookupVersion").singleInstance().Zd(()=>new jC),b.register(327,"Common.App.SearchCommon.ISearchHelper").singleInstance().Zd(()=>new mG(Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Pa("Common.App.Insights.SmartLookupVersion"))))}init(){n.AFrameworkApplication.JZ&&(this.dOb=this.W.Pa("Common.App.Insights.InsightsActor"),this.dOb.Vb())}S0k(){this.l9l()}l9l(){qM().then(b=>{if(""!==b){const k=this.W.Pa("Common.App.Insights.SmartLookupVersion");k&&k.vSn(b)}this.lAd();this.dOb=this.W.resolve("Common.App.Insights.InsightsActor");b=rM(b);b=Hb.a.create(b);b.VV((k,r)=>{r.succeeded?this.vTn()&&this.prefetchZeroTerm():Wl.ZA("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
r.gC,10);this.dOb.Vb()});Zb.a.cT(b)})}vTn(){const b=Object.assign(new yK,{channelId:Sh.channelId,approvedOriginPattern:fF()?"^(http)?://(localhost:8080)$":n.AFrameworkApplication.K.lb("SmartLookupApprovedOriginPattern")});var k=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),y=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),R=new rb.a;k&&R.add(k);r&&R.add(r);y&&R.add(y);k=sK();try{const aa=new tK,
ta=SmartLookupHostRuntime.setup(b,R.toArray(),!0,k,aa);this.W.register(cD,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Zd(()=>new cD(ta));return!0}catch(aa){return Wl.ZA("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+aa,10),!1}}prefetchZeroTerm(){if(n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=
Va.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime");if(b){const k=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");k.lif(null,r,0,99).then(y=>{b.dff().prefetchZeroTerm(y,n.AFrameworkApplication.userSessionId,gF(),!0,"Indoc",null)})}else Wl.ZA("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}lAd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const k=lG(b.LJc());
b=b.LJc();b=YD()+(""!==b?b:Sh.Y0c)+"/scripts/microsoft.office.smartlookup.ssr.js";const r=sM();X.a.maa?this.R0k(k,b):(this.P0k(k,r),this.Q0k(b,r))}P0k(b,k){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const y={};y.method=r.get_httpVerb();r.set_url(b);const R=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),y).then(()=>{""!==k&&Wl.kXf(k,b,(new Date).getTime()-R);this.W.Pa("Common.App.Insights.SmartLookupVersion")})}catch(aa){Wl.ZA("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
aa.toString(),10)}}Q0k(b,k){var r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const y={};y.method=r.get_httpVerb();r.set_url(b);let R=-1;if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Mg.a.instance.fc(new nd.a(5,1,r,()=>{const aa=Hb.a.create(b);aa.BPe(()=>{R=Date.now()});aa.VV((ta,Ya)=>{Ya.succeeded?""!==k&&Wl.kXf(k,b,Date.now()-
R):Wl.ZA("InsightsPackage - Failed to prefetch JS file.",10)});Zb.a.cT(aa)}));else{R=Date.now();try{window.fetch(r.getResolvedUrl(),y).then(()=>{""!==k&&Wl.kXf(k,b,Date.now()-R)})}catch(aa){Wl.ZA("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+aa.toString(),10)}}}R0k(b,k){if(X.a.maa){var r=n.AFrameworkApplication.af;b=new aF.a(b,1,null,null,!0,2,null);r.send(b).bEa(y=>{y&&y.data?y.data.Ie?this.W.Pa("Common.App.Insights.SmartLookupVersion"):Wl.ZA("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
y.data.Df,10):Wl.ZA("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},y=>{y&&y.data?Wl.ZA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+y.data.Df,10):Wl.ZA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});n.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(k=new aF.a(k,1,null,null,!0,2,null),r.send(k).bEa(y=>{y&&y.data?y.data.Ie||Wl.ZA("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
y.data.Df,10):Wl.ZA("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},y=>{y&&y.data?Wl.ZA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+y.data.Df,10):Wl.ZA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.dOb&&this.dOb.dispose()}}Object(m.a)(nG,"InsightsPackage",null,[1,2]);var zK=c(1534);class AK{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(AK,"DocumentContentParams",null,[]);var hF=c(1775),BK=c(532),ZD=c(735),vt;(function(b){b.kRa="SearchProvider";b.knb="TextSummarization"})(vt||(vt={}));Object(m.b)("WorkflowType",vt);var Gu;(function(b){b.Success="Success";b.pdg="Invoked";b.Error="Error"})(Gu||(Gu={}));Object(m.b)("LogType",Gu);var Wv;(function(b){b.Woj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.hzo="BlockedByClassifier";
b.ldg="InvalidAnnotation";b.Ptj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Wv||(Wv={}));Object(m.b)("ErrorReason",Wv);class iF{constructor(b){this.ACh=b;this.OGf=this.OGf.bind(this);this.YTc=this.YTc.bind(this);this.B$n=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}submitDocumentContentExtractionSignal(){return Object(gr.__awaiter)(this,void 0,void 0,function*(){try{this.MFn=Date.now();this.nkb=Ra.a.create().toString();
this.log({zH:vt.kRa,logType:Gu.pdg,success:!0,correlationId:this.nkb});var b=lB().toLowerCase();b="int"===b||"local"===b;yield this.activateAnnotation();const k=new Zq.l({parentPath:["Signal",hF.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new hF.SearchProviderSignal({correlationId:this.nkb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:k});this.gXi=window.setTimeout(()=>{this.onError(vt.kRa,Gu.Error,Wv.Timeout)},
1500)}catch(k){window.clearTimeout(this.gXi),this.onError(vt.kRa,Gu.Error,Wv.Other,this.ERh(k))}})}generateDocumentSummary(){return Object(gr.__awaiter)(this,void 0,void 0,function*(){try{this.A$n=Date.now();if(!iF.b8b)return null;this.log({zH:vt.knb,logType:Gu.pdg,success:!0});yield this.activateAnnotation();const b=new Zq.l({parentPath:["Signal",ZD.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new ZD.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});
this.W5f=window.setTimeout(()=>{this.onError(vt.knb,Gu.Error,Wv.Timeout)},this.B$n);return new Promise(k=>{this.Tfc=k})}catch(b){window.clearTimeout(this.W5f),this.onError(vt.knb,Gu.Error,Wv.Other,this.ERh(b))}})}static get b8b(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}activateAnnotation(){return Object(gr.__awaiter)(this,void 0,void 0,function*(){if(!this.Z5b){yield Ho.a.Qm();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,
k=[b(Object.assign(new BK.a,{annotationType:hF.SearchProviderAnnotation.getTypeName(),handler:this.OGf}))];iF.b8b&&k.push(b(Object.assign(new BK.a,{annotationType:ZD.TextSummaryAnnotation.getTypeName(),handler:this.YTc})));yield Promise.all(k);this.Z5b=!0}})}YTc(b){if(this.Tfc)if(this.Ggi(b)){if(b=b.items[0],ZD.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.W5f),b=b.body,b.status!==ZD.Result.Success){let k;switch(b.status){case "BlockedByPrefilter":k=Wv.BlockedByPrefilter;break;
case "BlockedByQualityCheck":case "BlockedByPostfilter":k=Wv.BlockedByQualityCheck;break;default:k=Wv.Other}this.onError(vt.knb,Gu.Error,k,`[TextSummary] workflow failed with status: ${b.status}`)}else this.log({zH:vt.knb,logType:Gu.Success,success:!0}),this.Tfc(b.summary),this.Tfc=null}else this.log({zH:vt.knb,logType:Gu.Error,success:!1,JFc:Wv.ldg});else window.clearTimeout(this.W5f)}OGf(b){if(this.Ggi(b)&&(b=b.items[0],hF.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.gXi),
(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.nkb)this.log({zH:vt.kRa,logType:Gu.Error,JFc:Wv.Woj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.nkb!==b.correlationId)this.log({zH:vt.kRa,logType:Gu.Error,JFc:Wv.Ptj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",
workflowExecutionTime:b.workflowExecutionTime});else{var k=this.Ouh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({zH:vt.kRa,logType:Gu.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.nkb=void 0;this.ACh.m_i(k)}else this.onError(vt.kRa,Gu.Error,Wv.ldg)}Ggi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){var k=b.zH===vt.kRa?this.MFn:this.A$n;const r=Date.now(),y=k?r-k:-1;k=[Object.assign(new ca.a,{name:"WorkflowType",
string:b.zH}),Object.assign(new ca.a,{name:"LogType",string:b.logType}),Object.assign(new ca.a,{name:"ErrorReason",string:b.JFc}),Object.assign(new ca.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ca.a,{name:"Message",string:b.message}),Object.assign(new ca.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ca.a,{name:"StartTime",int64:k}),Object.assign(new ca.a,{name:"EndTime",int64:r}),Object.assign(new ca.a,{name:"Duration",int64:y})];Object(Ib.a)("AugloopSearchProviderData",
b.success,y,k)}ERh(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}Ouh(b="",k="",r=""){return Object.assign(new AK,{documentContentKey:b,dataCenterEndpoint:k,documentContentTableName:r})}onError(b,k,r,y){if(b===vt.kRa){if(!this.nkb)return;this.log({zH:b,logType:k,success:!1,correlationId:this.nkb,message:y,JFc:r});this.nkb=void 0;this.D8k()}b===vt.knb&&this.Tfc&&(this.log({zH:b,logType:k,success:!1,message:y,JFc:r}),this.Tfc(null),this.Tfc=null)}D8k(){this.ACh.m_i(this.Ouh())}}Object(m.a)(iF,
"AugloopSearchProviderManager",null,[]);class jF{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(jF,"DocumentContentSearchResults",null,[]);class oG{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,k,r,y,R){this.selectRange(k,r,y,R)}search(){}searchV2(b,k){this.search(b,r=>{k(Object.assign(new jF,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,k){this.search(b.query,k)}searchWithParamV2(b,
k){this.searchWithParam(b,r=>{k(Object.assign(new jF,{results:r,totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return new Promise(b=>{b(null)})}extractDocumentObjects(){}getId(){return"DocumentContentExecutor"}}
Object(m.a)(oG,"BaseDocumentContentExecutor",null,[1004,275]);var pG=c(1919),CK=c(1417);class kF{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(kF,"DocumentContentSearchParams",null,[]);class qG{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(qG,"DocumentSelection",null,[]);var dD=c(682);class rG{constructor(){this.vGc=this.yYe=0}}Object(m.a)(rG,
"CommentFindResultIndexInfo",null,[]);const sG=(b,k)=>{var r;if(null===(r=n.AFrameworkApplication.K)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.FindPaneSafeCollapseToIp",!1))b.setSelection(rf.SelectionEditor.Qj(b.ib.kb,!0,!1));else{r=b.ib.kb;if(!r||!r.length)return null;r=r.Qa;k=k.xe(r.node,r.gl);b.setSelection(k)}};class DK{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=
this.subdocumentType=0}}Object(m.a)(DK,"DocumentContentSearchResult",null,[]);var tM=c(1736);class EK{constructor(){this.Izb=this.CYe=null}}Object(m.a)(EK,"CommentFindResults",null,[]);class FK{constructor(){this.end=this.begin=0}}Object(m.a)(FK,"FindResultOffset",null,[]);class Cy{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc){this.Pje=this.Ru=this.Rpe=this.jA=null;this.K4g=0;this.St=null;this.hlc=new rb.a;this.Wzg=null;this.CG=b;this.fb=k;this.Etb=r;this.$ca=R;this.OQb=aa;this.Lnc=ta;this.ki=Ya;this.ga=
xb;this.hb=Mb;this.Dy=cc}get qka(){return this.Wzg}initialize(){this.jA=oA.FindManager.createInstance(this,this.$ca,Vn.a.instance,!1,!0)}search(b,k){this.jA.mWa();this.stf(b)?(this.Ru=k,this.St=new rb.a,b=this.$0e(b),this.jA.find(b)):k(null)}searchV2(b,k){n.AFrameworkApplication.Vl("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");this.jA.mWa();if(this.stf(b)){this.Sei()&&this.ga.Xb(ib.a.b7d,2,{CommandValueId:b});this.Pje=k;this.K4g=b.totalResultLimit;this.St=new rb.a;b=this.$0e(b);
this.Wzg=new xk.a;this.jA.find(b);k=this.$ca.tVc(b.text);k=this.$ca.xHb(k);b=this.OQb.M3b(k.join("|"),b);k=this.ki.kT();for(let R=0;R<k.length;R++){const aa=k[R];var r=pG.a.FHd(aa.text[0]).split("\n");r=1===r.length?r[0]:r.join(" ");var y=this.Lnc.wKc(r,b);if(y)for(let ta of y)y=tM.a.createInstance(ta.begin,ta.end,G.a.Pf(aa.objectId),R,32,!1),this.hlc.add(y),this.qka.ub(R)||this.qka.add(R,Object.assign(new EK,{CYe:r,Izb:[]}));else v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",
!r,!b)}}else k(null)}get fJh(){null==this.Rpe&&(this.Rpe=oA.FindManager.createInstance(this,this.$ca,Vn.a.instance));return this.Rpe}Sei(){var b;return null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}oPd(){var b;return null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}highlight(b){var k=this.stf(b);
b=k?this.$0e(b):null;var r={};this.Sei()&&this.ga.Xb(Jc.a.YPf,2,r);if(r[Ig.a.On]){if(k){k={};r={};var y={};this.ga.Xb(Jc.a.z1d,2,k);this.ga.Xb(ib.a.y1d,2,r);this.ga.Xb(ib.a.A1d,2,y);if(b.text!=k.CommandValueId||b.matchCase!=r[Ig.a.On]||b.matchWholeWord!=y[Ig.a.On])sG(this.hb,this.Dy),this.ga.Xb(ib.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.fJh,r.mWa(),k&&r.find(b)}selectNextPrevHighlight(b){const k=this.fJh;return 0<k.Fj.yha?(b?k.mJd():
k.nJd(),k.Fj.TNe-1):-1}$0e(b){let k=Fs.a.none;b.matchCase&&(k|=Fs.a.matchCase);b.matchWholeWordOnly&&(k|=Fs.a.wholeWordOnly);return Zv.a.createQuery(b.query,k)}stf(b){return b&&!!b.query&&0<b.query.length}W7d(){}w6d(){}reset(){}Y9e(){}I1b(){if(this.Ru){var b=this.Puh(this.St);this.Ru(b)}if(this.Pje){b=new jF;const k=this.St.count+this.hlc.count>this.K4g;b.totalResultCount=this.St.count+this.hlc.count;b.hasTooManyResults=k;k||(this.St.IA(this.St.count,this.hlc),b.results=this.Puh(this.St));this.Pje(b);
this.hlc.clear()}}Puh(b){const k=[];var r=Object.assign(new dD.a,{MZa:!1,NZa:this.oPd(),OZa:!0});r=this.fb.NLa(this.CG.value,r);for(let R of b){var y=R.begin;let aa=R.end,ta;b=-1;let Ya=null,xb=0;if(32===R.type){Ya=Cy.Iqh;xb=3;b=r.count+R.hfb;const Mb=({begin:y,end:aa}=zK.a.SOi(this.qka.J(R.hfb).CYe,y,aa)).returnValue;ta=this.Etb.f1e(Mb,y,aa,vz.a(R.type));this.qka.J(R.hfb).CYe=Mb;this.qka.J(R.hfb).Izb.push(Object.assign(new FK,{begin:y,end:aa}))}else{!this.oPd()||2!==R.type&&4!==R.type||(xb=2===R.type?
1:2,Ya=Cy.Clf);for(y=0;y<r.count;y++)if(r.J(y).id===R.nodeId){b=y;break}ta=this.Etb.$xd(R)}0<=b&&(b=Object.assign(new DK,{snippet:ta.a_e,subdocumentId:Ya,subdocumentType:xb,startOffsetInSnippet:ta.lVf,endOffsetInSnippet:ta.iVf-1,paragraphIndex:b,startOffsetInParagraph:R.begin-ta.lVf,endOffsetInParagraph:R.end-ta.iVf-1}),k.push(b))}k.sort((R,aa)=>R.paragraphIndex===aa.paragraphIndex?R.startOffsetInParagraph-aa.startOffsetInParagraph:R.paragraphIndex-aa.paragraphIndex);return k}update(){}qLa(b,k){switch(b){case 0:k&&
0<k.length&&!this.St&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.St=new rb.a);for(let r of k)this.St.add(r)}}Jkb(){}dispose(){}}Cy.Iqh="Comment";Cy.Clf="HeaderFooter";Cy.W1l="Image";Object(m.a)(Cy,"WordDocumentSearchProcessor",null,[276,10,277]);class GK extends oG{constructor(b,k,r,y,R,aa,ta,Ya,xb,Mb,cc,jc,Mc){super();this.Oa=Mb;this.HUa=null;this.l3=(fd,Td)=>{fd=Td.node;Td=Td.property;this.Y_f(fd)&&Td===Te.a.mo&&this.VBb(fd,3)};this.fga=(fd,Td)=>{fd=Td.node;!Td.vqf&&
this.Y_f(fd)&&this.VBb(fd,1)};this.Cib=(fd,Td)=>{fd=Td.node;this.Y_f(fd)&&this.VBb(fd,2)};this.CG=b;this.fb=k;this.Zc=r;this.hb=y;this.Dy=R;this.pl=Ya;this.Ub=xb;this.F9=aa;this.oB=ta;this.ki=cc;this.kJj=jc;this.YZg=G.a.create();this.x3d(this.l3,this.fga,this.Cib);Mc.execute(fd=>{this.kld=fd})}get sO(){return!this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}oPd(){var b;return null===(b=n.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",
!1)}submitDocumentContentExtractionSignal(){this.kld&&this.kld.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.kld?this.kld.generateDocumentSummary():Promise.resolve(null)}getAllParagraphsInDocument(){var b=Object.assign(new dD.a,{MZa:!1,NZa:!1,OZa:!0});const k=this.fb.NLa(this.CG.value,b);b=new rb.a;for(var r of k)b.add(this.vHd(r));for(let y of this.ki.kT())r=pG.a.FHd(y.text[0]).split("\n"),r=1===r.length?r[0]:r.join(" "),b.add(r);return b.toArray()}extractDocumentObjects(b){var k=
Object.assign(new dD.a,{MZa:!1,NZa:!1,OZa:!0}),r=this.fb.NLa(this.CG.value,k);k=[];for(let y=0;y<r.count;++y)k.push(...this.jxl(r.J(y),y));r={};r.images=k;b(r)}selectRange(b,k,r,y,R){const aa=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.j3a();if(0>b||0>k||0>r||0>y||b>r||b===r&&k>y)throw Error("Provided select range offsets incorrect");const fd=Object.assign(new dD.a,{MZa:!1,NZa:!1,OZa:!0}),Td=this.fb.NLa(this.CG.value,fd);if(r>=
Td.count){const ne=Va.a.instance.resolve("Common.Comments.ICommentModel").kT(),ye=r-Td.count;if(ye<ne.length){R=-1;if(this.F9.qka.ub(ye)){const Gd=this.F9.qka.J(ye).Izb;for(var Ya=0;Ya<Gd.length;Ya++)if(Gd[Ya].begin===k){R=Ya;break}}this.HUa=-1!==R?Object.assign(new rG,{yYe:ye,vGc:R}):null;const ff=ne[ye];n.AFrameworkApplication.ya.processAction(Jc.a.WS,2);n.AFrameworkApplication.ya.Xb(Jc.a.q$,2,null);n.AFrameworkApplication.ya.Xb(Jc.a.selectComment,2,Object.assign(new CK.a,{commentId:ff.id,F3:2,
sO:this.sO}))}}else{this.HUa=null;var xb=Td.J(b),Mb=Td.J(r);if(!this.kRd(xb,k)||!this.kRd(Mb,y))throw Error("Provided select range offsets incorrect");n.AFrameworkApplication.ya.processAction(Jc.a.WS,2);this.Hcj(xb);var cc=this.Dy.xe(xb,k);Ya=this.Dy.KB(cc,Re.a.Uc(Mb,y+1));if(R){const ne=Ya.toArray();k=[];for(const ye of ne)k.push(this.vHd(ye.node));k.join(" ").includes(R)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var jc=this.pl.value.zv,Mc=this.hb.ib.kb;
Mc&&Mc.equals(Ya)&&this.Zc.uoa(jc,null);this.Zc.uoa(jc,Ya);ta.duration=Date.now()-aa;this.logMessage(ta)}}catch(fd){ta.success=!1,ta.message=fd.stack,ta.duration=Date.now()-aa,this.logMessage(ta)}}search(b,k){this.j3a();this.F9.search(Object.assign(new kF,{query:b}),k)}searchV2(b,k){this.j3a();this.F9.searchV2(Object.assign(new kF,{query:b}),k)}selectNextPrevHighlight(b){this.j3a();return this.F9.selectNextPrevHighlight(b)}searchWithParam(b,k){this.j3a();this.F9.search(b,k)}searchWithParamV2(b,k){this.j3a();
this.F9.searchV2(b,k)}highlight(b){this.j3a();this.F9.highlight(Object.assign(new kF,{query:b}))}highlightWithParam(b){this.j3a();this.F9.highlight(b)}getRevision(){return this.YZg.toString()}getSelectedText(){const b=this.kJj.getSelectedText();return Object.assign(new Vv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new dD.a,{MZa:!1,NZa:this.oPd(),OZa:!0}),k=({ru:aa}=this.oKl(b)).returnValue;if(k)return k;var r=
this.hb.ib.kb;if(!r||!r.length)return null;k=r.Qa;r=r.Tc;let y=-1,R=-1;var aa=aa||this.fb.NLa(this.CG.value,b);b=null;for(let ta=0;ta<aa.count;ta++){const Ya=aa.J(ta);-1===y&&k.node.id===Ya.id&&(y=ta,b=Ya);-1===R&&r.node.id===Ya.id&&(R=ta)}aa=null;5===(null===b||void 0===b?void 0:b.OAa)&&(aa=Cy.Clf);return Object.assign(new qG,{subdocumentId:aa,startParagraphIndex:y,startParagraphOffset:k.gl,endParagraphIndex:R,endParagraphOffset:r.zt})}clearDocumentSelection(){sG(this.hb,this.Dy)}selectRangeV2(b,
k,r,y,R,aa){const ta=Date.now(),Ya={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.j3a();if(0>k||0>r||0>y||0>R||k>y||k===y&&r>R)throw Error("Provided select range offsets incorrect");var xb=Object.assign(new dD.a,{MZa:!1,NZa:!0,OZa:!0});const jc=this.fb.NLa(this.CG.value,xb);if(b==Cy.Iqh)this.jGn(r,y,jc.count);else{xb=this.HUa=null;xb=b==Cy.W1l?this.bxl(jc.J(k),r):this.TNl(jc.J(k),jc.J(y),r,R,b,aa,Ya);var Mb=this.pl.value.zv,cc=this.hb.ib.kb;(null===
cc||void 0===cc?0:cc.equals(xb))&&this.Zc.uoa(Mb,null);this.Zc.uoa(Mb,xb)}Ya.duration=Date.now()-ta;this.logMessage(Ya)}catch(jc){Ya.success=!1,Ya.message=jc.stack,Ya.duration=Date.now()-ta,this.logMessage(Ya)}}bxl(b,k){const r=this.Dy.xe(b,k);return this.Dy.KB(r,Re.a.Uc(b,k+1))}TNl(b,k,r,y,R,aa,ta){if(!this.kRd(b,r)||!this.kRd(k,y))throw Error("Provided select range offsets incorrect");R==Cy.Clf?n.AFrameworkApplication.ya.Xb(Jc.a.khb,2,new Ry.a(b)):n.AFrameworkApplication.ya.processAction(Jc.a.WS,
2);this.Hcj(b);b=this.Dy.xe(b,r);k=this.Dy.KB(b,Re.a.Uc(k,y+1));if(aa){y=k.toArray();b=[];for(const Ya of y)b.push(this.vHd(Ya.node));b.join(" ").includes(aa)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}return k}jGn(b,k,r){const y=Va.a.instance.resolve("Common.Comments.ICommentModel").kT();k-=r;if(k<y.length){r=-1;if(this.F9.qka.ub(k)){const R=this.F9.qka.J(k).Izb;for(let aa=0;aa<R.length;aa++)if(R[aa].begin===b){r=aa;break}}this.HUa=-1!==r?Object.assign(new rG,
{yYe:k,vGc:r}):null;b=y[k];n.AFrameworkApplication.ya.processAction(Jc.a.WS,2);n.AFrameworkApplication.ya.Xb(Jc.a.q$,2,null);n.AFrameworkApplication.ya.Xb(Jc.a.selectComment,2,Object.assign(new CK.a,{commentId:b.id,F3:2,sO:this.sO}))}}j3a(){this.Ub&&(this.Ub.pg&&this.Ub.pg.name===Sh.ny||this.Ub.Kg(Sh.ny))}goo(){this.YZg=G.a.create()}vHd(b){if(b.pDb)return"";b=this.fb.text(b);return xn.AParagraphNode.nU(b," ")}kRd(b,k){b=this.vHd(b);return k<b.length}VBb(b,k){switch(k){case 1:case 2:case 3:this.goo()}}logMessage(b){const k=
[Object.assign(new ca.a,{name:"Message",string:b.message})];Object(Ib.a)(b.activityName,b.success,b.duration,k)}Y_f(b){return!b.pDb&&this.COc(b)}COc(b){const k=this.CG.value;return!!k&&!!k.Ad&&!!b.Mc&&b.Mc.id.equals(k.Ad.id)}Hcj(b){this.fb.WNc(b)?32===n.AFrameworkApplication.ya.Xb(Jc.a.Mib,2,new Ry.a(b))&&n.AFrameworkApplication.ya.processAction(Jc.a.T$e,2):n.AFrameworkApplication.ya.Xb(Jc.a.q$,2,null)}x3d(b,k,r){this.oB&&(this.oB.qp(b),this.oB.Wt(k),this.oB.Zu(r))}oKl(b){let k=null;var r=this.Ub?
this.Ub.pg.name:"";if(!this.ki.Js||r!==id.AFrame.hr&&r!==id.AFrame.CL)return{returnValue:null,ru:k};r=Array.indexOf(this.ki.kT(),this.ki.Js);if(0>r)return{returnValue:null,ru:k};k=this.fb.NLa(this.CG.value,b);var y=pG.a.FHd(this.ki.Js.text[0]).split("\n");b=0;y=(1===y.length?y[0]:y.join(" ")).length-1;this.HUa&&r===this.HUa.yYe&&this.F9.qka.ub(r)&&this.F9.qka.J(r).Izb.length>this.HUa.vGc&&(b=this.F9.qka.J(r).Izb[this.HUa.vGc].begin,y=this.F9.qka.J(r).Izb[this.HUa.vGc].end);return{returnValue:Object.assign(new qG,
{startParagraphIndex:k.count+r,startParagraphOffset:b,endParagraphIndex:k.count+r,endParagraphOffset:y,subdocumentId:"Comment"}),ru:k}}jxl(b,k){const r=[];if(12!=b.type)return r;r.push(...this.Hxl(b,k));r.push(...this.rul(b,k));return r}rul(b,k){const r=[];b=Wd.GraphIterator.Za(b);if(!b.EA())return r;for(var y=b.Ud();y;)19!==y.type?y=b.Ht():((y=y.properties)&&Pd.ImageReader.dOc(y)&&r.push(this.Pdj(y,k,0)),y=b.Ht());return r}Hxl(b,k){const r=[],y=b.Mc;if(y){if(!b.hasProperty(Te.a.wn))return r;var R=
b.ia(Te.a.wn,null);if(!R)return r;b=b.ia(Te.a.km,null);for(let ta=0;ta<R.length;++ta){var aa=R[ta];if(!aa)continue;aa=y.Db(aa);if(!aa||!Pd.ImageReader.dOc(aa))continue;let Ya=0;0!=ta&&b&&ta-1<b.length&&(Ya=b[ta-1]);r.push(this.Pdj(aa,k,Ya))}return r}}Pdj(b,k,r){const y=b.ia(td.a.gu,""),R={};R.base64Encoding=y;R.width=Pd.ImageReader.bD(b);R.height=Pd.ImageReader.yI(b);R.altText=Pd.ImageReader.pT(b);R.description=Pd.ImageReader.sBa(b);return{data:R,startParagraphIndex:k,endParagraphIndex:k,startOffsetInParagraph:r,
endOffsetInParagraph:r+1}}}Object(m.a)(GK,"WordDocumentContentExecutor",oG,[]);class lF{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(lF,"BaseDocumentHelper",null,[314]);class HK extends lF{constructor(b){super();this.Agl=b}get dAd(){const b=this.Agl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Ka.App.xa.jb.isEditingAllowed}author(){var b;return null===(b=this.dAd)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=
this.dAd)||void 0===b?void 0:b.creationDate}}Object(m.a)(HK,"WordDocumentHelper",lF,[]);class IK{constructor(b){this.Opi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.tof(b.htmlText)}getId(){return"InsertContentExecutor"}tof(b){return this.executeCommand(Wa.a.Ora,b)}executeCommand(b,k){const r=new Di.DictionaryPropertySet;r.setValue(td.a.PQ,k);r.setValue(td.a.Xva,!1);k=this.Opi.processAction(b,1);32===k&&(k=this.Opi.Xb(b,2,r));return k}}Object(m.a)(IK,"WordInsertContentExecutor",null,[274,275]);
class JK{constructor(b,k,r){this.Wlc="undefined";this.A$l=(y,R,aa,ta,Ya)=>Ot.D2(y,R,aa,ta,this.kB,Ya);this.O8d=(y,R,aa,ta,Ya)=>{if(1===aa)return this.iKj?32:8;y=JE.getSelectedText();y=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,JE.THd(y));Ya[cl.a.LabelText]=y;return 32};this.kB=b;this.ga=k||n.AFrameworkApplication.ya;this.Oa=r;this.SJj=(this.gw=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.S2)&&!!this.Oa&&this.Oa.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");
this.iKj=!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)}Vb(){this.ga.gb(Jc.a.tgh,zc.a.frame,this.A$l,1028);this.ga.gb(Jc.a.O8d,zc.a.frame,this.O8d,1028);this.SJj&&(this.Wlc=Ka.App.xa.Bu.getWindowMode(),this.pFh(this.Wlc),Ka.App.xa.Bu.registerBoundingWindowRectsChanged("SearchPane",(b,k)=>{k!==this.Wlc&&(this.Wlc=k,this.pFh(this.Wlc))}))}pFh(b){"DP"===b&&Sk.UISurfaces.fu().then(k=>{k.selectors.getTabbedTaskPaneCount()||this.ga.Xb(Jc.a.tgh,
2,{SourceControlId:"smartlookupAuto"});return null})}}Object(m.a)(JK,"WordInsightsActor",null,[]);class eD{constructor(){this.XO=null}LYa(){return this.QAb()}fUh(){return this.QAb()}dUh(){return null}h_n(b,k,r){this.XO||(this.XO=this.Lxd());this.XO.tO(b,k,r)}i_n(b,k,r){this.XO||(this.XO=this.Lxd());this.XO.H6i(b,k,r)}TJb(b,k){this.XO||(this.XO=this.Lxd());this.XO.TJb(b,k)}ZRd(b){this.XO||(this.XO=this.Lxd());this.XO.ZRd(b)}HHn(){this.XO&&this.XO.Odc()}jMn(){this.XO&&this.XO.Q6d()}QXn(){var b=n.AFrameworkApplication.K.rc("SmartLookupLaunchThrottleThresholdInMilliseconds",
1500);b=window.performance.now()-eD.Ali<=b;b||(eD.Ali=window.performance.now());return b}dispose(){this.XO&&(this.XO.dispose(),this.XO=null)}get RDb(){return this.XO?this.XO.isVisible:!1}}eD.Ali=0;Object(m.a)(eD,"InsightsManager",null,[1036,10]);class $D{constructor(b,k,r,y,R,aa=!0,ta=null,Ya=null){this.n4=this.eN=this.MHa=null;this.sqc=!1;this.Eca=null;this.Ub=k;this.dSb=aa;this.hDg=Ya?Ya:new lF;this.uy=ta;this.Ro=b;this.dSb&&(Va.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime")&&(this.Eca=
Va.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").dff()),this.U9a=Va.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Uub=this.U9a.LJc())}l1a(b){if(this.dSb){b=b.rawEvent;try{var k=x.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,15,this.iT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(k.actionType){case 101:b=0;this.eN&&(b=this.eN.entryPoint);this.U9a.lif(this.n4,this.hDg,this.k4b(),b).then(r=>{k.data=r;this.mjb(k)});break;
case 118:k.data=this.eN?this.eN:Object.assign(new ut.a,{selection:Object.assign(new Vv.a,{neighborhood:this.MHa.neighborhood,mentionStart:this.MHa.mentionStart,mentionLength:this.MHa.mentionLength})});this.mjb(k);break;case 103:b=x.a(Object(ia.a)(String,k.data));Wl.sendTelemetryEvent(b);break;case 206:this.U9a.B1h(k.data).then(r=>{k.data=r;this.mjb(k)});break;case 112:k.data.shiftPressed?(X.a.gj&&document.activeElement.blur(),this.Ro.zKd(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.iT("Serplet UX lost focus through Ctrl + Shift + F6"))):
(this.Ro.DKc(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,50,this.iT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.$la()}}}yZc(b){if(this.Eca){var k=0;this.eN&&(k=this.eN.entryPoint);this.U9a.lif(this.n4,this.hDg,this.k4b(),k).then(r=>{Wl.rYi("SearchFromHost",this.n4);this.eN.launchData||(this.eN.launchData=new mu.a);const y=gF();try{this.Eca.search(this.eN,r,n.AFrameworkApplication.userSessionId,y,b),this.U9a.u6m(R=>{Wl.rYi("SearchFromHostWithToken",this.n4);this.Eca.searchAuthenticatedProviders(this.eN,
r,n.AFrameworkApplication.userSessionId,y,null,R)})}catch(R){Wl.ZA("BaseSmartLookupPane - Fail to search from host. Error: "+R,10)}}).catch(r=>{Wl.ZA("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Pdc(b){if(this.dSb){var k=Wl,r=k.Pdc,y=this.n4;b=Math.round(window.performance.now()-b);var R=this.eN?bD[this.eN.entryPoint]:"",aa=this.U9a.LJc(),ta=this.U9a.mtl(),Ya=this.eN?this.eN.entryPoint:0;r.call(k,y,b,R,aa,ta,n.AFrameworkApplication.MQe,this.sqc,
18===Ya||19===Ya||15===Ya)}}}Object(m.a)($D,"BaseSmartLookupPane",null,[307,10]);class aE{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(aE,"InsightsMessage",null,[]);class bE extends aE{constructor(b,k){super(b);this.messageContent=null;this.messageContent=k}}Object(m.a)(bE,"InsightsMessageWithContent",aE,[]);class KK extends bE{constructor(b){super(Sh.mKm,b)}}Object(m.a)(KK,"InsightsMessageAppProperties",bE,[]);class LK extends bE{constructor(b){super(Sh.zKm,b)}}Object(m.a)(LK,
"InsightsMessageSelection",bE,[]);class MK extends aE{constructor(){super(Sh.BKm)}}Object(m.a)(MK,"InsightsMessageTakeFocus",aE,[]);class cE extends $D{constructor(b,k,r,y,R=null,aa=null,ta=null,Ya=!0,xb=null,Mb=null){super(k,r,R,aa,ta,Ya,xb,Mb);this.W7c=this.lA=this.ih=null;this.$hd=!1;this.Ucd=b;this.Zoc=this.dSb?lG(this.Uub):n.AFrameworkApplication.U8l;this.fZ();this.SRf();this.Ep=y;this.YBg=0}get isVisible(){return!1}fZ(){this.ih=this.Ucd.gDc();n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb.Dgb&&
this.ih.Pon(b=>{b===this.ih&&(this.Q6d(),this.Odc())});this.Ynf(this.ih.oQa.bhh);this.ih.xl()}Ynf(b){b.style.overflow="hidden";const k=mg.a.createElement("iframe");Sys.UI.DomElement.addCssClass(k,"InsightsPaneIFrame");k.setAttribute("Unselectable","off");this.lA=k;b.appendChild(this.lA);this.lA.id=Sh.xmf}SRf(){Af.a.addHandler(this.lA,"load",Object(u.a)(this,this.U$b,"onIFrameLoad"));Af.a.addHandler(this.lA,"error",Object(u.a)(this,this.xib,"onIFrameError"));$addHandler(window,"message",Object(u.a)(this,
this.l1a,"onIFrameMessage"))}r8f(){Af.a.removeHandler(this.lA,"load",Object(u.a)(this,this.U$b,"onIFrameLoad"));Af.a.removeHandler(this.lA,"error",Object(u.a)(this,this.xib,"onIFrameError"));$removeHandler(window,"message",Object(u.a)(this,this.l1a,"onIFrameMessage"))}dispose(){this.lA&&(this.r8f(),this.lA.parentNode.removeChild(this.lA),this.lA=null);this.ih&&(this.Ucd.Lyb(this.ih),this.ih=null)}tO(b,k,r){this.n4=k;this.W7c=null;this.YBg=r;this.sqc=!b.mentionLength;this.$hd=!1;v.ULS.sendTraceTag(6295947,
1303,50,this.iT("Start to show Insights"));this.MHa=b;this.Zoc&&this.Zoc.length?this.lA.src=this.Zoc:(this.lA.src=cE.Zvi,v.ULS.sendTraceTag(6295948,1303,15,this.iT("The Insights URL config setting is null or empty")));this.Ep.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.ih.fX||this.ih.XRf(Object(u.a)(this,this.SVm,"onInsightsTaskPaneHidden"));this.dSb&&this.yZc(!1);b=window.performance.now();this.Ucd.showTaskPane(this.ih);this.ih.xl();this.Pdc(b)}H6i(b,k,r){this.eN=b;this.tO(Object.assign(new XD.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),k,r)}TJb(){}ZRd(){}Odc(){this.lA.src===this.Zoc&&this.$hd&&(this.Ub.Kg(Sh.ny),this.mjb(new MK))}Q6d(){this.lA&&Id.FocusManager.IK(this.lA.contentWindow)}Q2e(){this.lA.src=cE.Zvi;this.ih.im()}$la(){this.Ucd.hideTaskPane(this.ih);this.Q2e()}SVm(b){b===this.ih&&this.$la()}U$b(){v.ULS.sendTraceTag(6295951,1303,50,this.iT("The iframe is successfully loaded in Insights task pane"))}xib(){v.ULS.sendTraceTag(6295952,
1303,15,this.iT("The iframe failed to load in Insights task pane"))}l1a(b){const k=b.rawEvent;if(k.source===this.lA.contentWindow)if(this.dSb)super.l1a(b);else{let r;try{r=x.a(k.data)}catch(y){v.ULS.sendTraceTag(6295953,1303,15,this.iT("Message data [{0}] failed to deserialize.",k.data));return}if(xf.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.iT("Message data [{0}] is in wrong format.",k.data));else switch(r.messageType){case Sh.nKm:this.mjb(new KK(this.Qxl()));break;case Sh.AKm:this.mjb(new LK(this.MHa));
break;case Sh.uKm:this.$hd=!0;this.Q6d();this.Odc();v.ULS.sendTraceTag(6295955,1303,50,this.iT("Insights pane rendering is completed"));break;case Sh.CKm:b=r.messageContent;this.W7c=b.clientCorrelationId;this.n4!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.iT("App correlation ID on client {0} does not match one on server {1}",this.n4,b.appCorrelationId));break;case Sh.tKm:r.messageContent?(X.a.gj&&document.activeElement.blur(),this.Ro.zKd(0,null,2,null,null),v.ULS.sendTraceTag(6604741,
1303,50,this.iT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Ro.DKc(0,null,2,null,null),v.ULS.sendTraceTag(6604742,1303,50,this.iT("Insights UX lost focus through Ctrl + F6")));break;case Sh.qKm:r.messageContent.keyCode===tb.a.M4a&&this.$la();break;case Sh.rKm:try{this.$hd=!1,localStorage.setItem(Sh.jmi,"true")}catch(y){v.ULS.sendTraceTag(17961859,1303,10,this.iT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}Qxl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.n4;3===n.AFrameworkApplication.ta.Rb.ko?b.applicationName=Sh.Ixo:4===n.AFrameworkApplication.ta.Rb.ko&&(b.applicationName=Sh.M0m);b.applicationVersion=n.AFrameworkApplication.buildVersion;var k=yh.a.qg(n.AFrameworkApplication.lcid);k=k?k.name:null;b.market=kG(k);b.uiLanguage=k;b.sessionId=n.AFrameworkApplication.userSessionId;b.parentalControl=Sh.eLf;b.clientType="user";b.legalAgreed=this.$yl();b.defaultDefineTab=1===this.YBg?"true":null;return b}iT(b,...k){const r={};this.n4&&(r[Sh.lbj]=this.n4);
this.W7c&&(r[Sh.R9n]=this.W7c);r[Sh.mbj]=String.format.apply(null,[b].concat(k));return x.c(r)}k4b(){return 5}$yl(){try{const b=localStorage.getItem(Sh.jmi);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,1303,10,this.iT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}mjb(b){b=x.c(b);this.lA.contentWindow.postMessage(b,Oa.a.N$(this.Zoc))}}cE.Zvi="about:blank";Object(m.a)(cE,"InsightsPane",$D,[]);class NK{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(NK,
"SmartLookupTaskPaneProps",null,[]);class OK{}Object(m.a)(OK,"ActionDescriptor",null,[]);class PK extends $D{constructor(b,k,r,y=null,R=null,aa=null,ta=!0,Ya=null,xb=null){super(k,r,y,R,aa,ta,Ya,xb);this.RJe=!!n.AFrameworkApplication.ta&&!!n.AFrameworkApplication.ta.Rb&&n.AFrameworkApplication.ta.Rb.yuf;this.xu=this.HEe=!1;this.TNj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.RNj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.WNj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.VNj=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ta||Wl.ZA("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.KTa=b;this.CJg=lG(this.Uub)}get isVisible(){return this.xu}TJb(b,k){this.eN=b;this.MHa=b=Object.assign(new XD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.sqc=!b.mentionLength;this.n4=k;this.yZc(!1)}ZRd(b){this.eN=b;this.gfc(Object.assign(new XD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}tO(b,k){this.n4=k;this.gfc(b,!0)}H6i(b,k,r){this.eN=b;this.tO(Object.assign(new XD.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),k,r)}$la(){this.vba();this.KTa.hideTaskPane()}gfc(b,
k){Ae.SessionStatusManager.instance.pK&&this.Eca?(this.MHa=b,this.sqc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?n.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.KTa.updateTaskPane(null),k&&this.lIn()):(k&&this.yZc(!1),this.HEe=!this.HEe,this.KTa.updateTaskPane(this.AB())):(k&&this.yZc(this.isVisible),this.KTa.showTaskPane(this.AB())),this.Pdc(b)):(this.KTa.showTaskPane(this.AB()),Wl.JHn(Ae.SessionStatusManager.instance.pK,!!this.Eca,this.eN?
bD[this.eN.entryPoint]:"",this.U9a.LJc(),n.AFrameworkApplication.MQe,this.sqc))}lIn(){if(!this.eN){const b=Object.assign(new Vv.a,{neighborhood:this.MHa.neighborhood,mentionStart:this.MHa.mentionStart,mentionLength:this.MHa.mentionLength});this.eN=Object.assign(new ut.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.yZc(this.isVisible)}RHn(){const b=new OK;b.transactionId=this.n4;b.actionType=15;b.channelId=Sh.channelId;this.mjb(b)}l1a(b){const k=b.rawEvent;document.getElementById(Sh.ny)&&
k.source!==document.getElementById(Sh.ny).contentWindow||(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)?this.oin(b):super.l1a(b))}oin(b){const k=b.rawEvent;let r;try{r=x.b(k.data)}catch(y){v.ULS.sendTraceTag(545604257,1303,15,this.iT("Message data from Serplet [{0}] failed to deserialize.",k.data));return}switch(r.actionType){case 32:Fd.a.GBb()>=this.TNj?this.KTa.updateTaskPane(this.u1e(this.RNj)):Fd.a.GBb()>=this.WNj&&this.KTa.updateTaskPane(this.u1e(this.VNj));
break;case 33:this.KTa.updateTaskPane(this.u1e(r.data));break;default:super.l1a(b)}}dispose(){}initialize(){this.fZ();this.eha()}fZ(){this.KTa.gDc()}eha(){const b=this.Ub.re(Sh.ny);b.parent=id.AFrame.Qp;b.XL=!0}qMn(){this.Ub.Kg(Sh.ny)}vba(){this.Z_a()&&this.Ub.Kg(this.Ub.NS)}SRf(){$addHandler(window,"message",Object(u.a)(this,this.l1a,"onIFrameMessage"))}r8f(){$removeHandler(window,"message",Object(u.a)(this,this.l1a,"onIFrameMessage"))}Z_a(){return!!this.Ub.pg&&this.Ub.pg.name===Sh.ny}mjb(b){b=x.c(b);
document.getElementById(Sh.ny)&&document.getElementById(Sh.ny).contentWindow.postMessage(b,Oa.a.N$(this.CJg))}iT(b,...k){const r={};this.n4&&(r[Sh.lbj]=this.n4);r[Sh.mbj]=String.format.apply(null,[b].concat(k));return x.c(r)}k4b(){return ni.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}fCi(){if(this.Eca)this.Eca.onPaneThemeChanged(this.k4b());return ni.a("getTheme")?appChrome.api.getTheme():null}Odc(){}Q6d(){document.getElementById(Sh.ny)&&Id.FocusManager.IK(document.getElementById(Sh.ny).contentWindow)}xib(){Wl.ZA("ReactSmartLookupPane - Iframe component failed to load.",
10)}U$b(){n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Wl.ZA("ReactSmartLookupPane - Onload detected no network.",50)}AB(){var b=new NK;b.src=this.CJg;b.id=Sh.ny;b.refreshPane=this.HEe;b.onError=Object(u.a)(this,this.xib,"onIFrameError");b.onLoad=Object(u.a)(this,this.U$b,"onIFrameLoad");b.title=Sh.$ib;Ae.SessionStatusManager.instance.pK?this.Eca||(b.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,
b.errorType=1):(b.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,b.errorType=0);b=Object.assign(new Dp.a,{title:Sh.$ib,hideHeader:!1,width:Sh.width,location:Sh.N3m,contentProps:b,isModernPane:!0,onOpen:()=>{this.qMn();this.xu=!0;this.SRf();ni.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(u.a)(this,this.fCi,"onThemeIdChanged"));n.AFrameworkApplication.ta.updateCommandUI();if(this.Eca)this.Eca.onPaneStateChanged(!0)},onClose:()=>{this.RHn();
this.vba();this.xu=!1;this.r8f();ni.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(u.a)(this,this.fCi,"onThemeIdChanged"));n.AFrameworkApplication.ta.updateCommandUI();if(this.Eca)this.Eca.onPaneStateChanged(!1)}});this.RJe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}u1e(b){const k=this.AB();k.resizeWidth=b;return k}}Object(m.a)(PK,"ReactSmartLookupPane",$D,[]);class QK{gDc(){const b=new en.CuiHelper(Qk.a.Kab,WordEditorIntl.WordEditorStrings);
return Om.a.instance.w1e(Sh.ny,Sh.Jac,Sh.width,Sh.c5f,b)}showTaskPane(b){Om.a.instance.showTaskPane(b)}hideTaskPane(b){Om.a.instance.hideTaskPane(b)}Lyb(b){Om.a.instance.Lyb(Sh.ny,b)}}Object(m.a)(QK,"WordInsightsPaneHandler",null,[293]);class RK{gDc(){Om.a.instance.FKa()}showTaskPane(b){Sk.UISurfaces.fu().then(k=>{k.showTaskPane(Sh.ny,b);return null})}updateTaskPane(b=null){Sk.UISurfaces.fu().then(k=>{k.setSelectedTaskPane(Sh.ny);b&&k.updateTaskPane(Sh.ny,b);return null})}hideTaskPane(){Sk.UISurfaces.fu().then(b=>
{b.hideTaskPane(Sh.ny,2);return null})}}Object(m.a)(RK,"WordReactSmartLookupPaneHandler",null,[290]);class SK extends eD{constructor(b,k){super();this.Ow=b;this.hb=k}Lxd(){const b=!!n.AFrameworkApplication.ta&&!!n.AFrameworkApplication.ta.Rb&&n.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Rb&&n.AFrameworkApplication.ta.Rb.xtf?new PK(new RK,Jn.a.instance,Id.FocusManager.instance(),Va.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),
Va.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Va.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Va.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new cE(new QK,Jn.a.instance,Id.FocusManager.instance(),Va.a.instance.resolve("Common.Utils.IAriaNotifier"),Va.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Va.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Va.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Va.a.instance.$a("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Va.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}QAb(){return this.Ow.getSelectedText()}dUh(){if(!this.hb||!this.hb.ib||1>this.hb.ib.length)return null;var b=this.hb.ib.kb.Qa;b=null==b?null:Kk.FormattingReader.Qr(b);return(b=null==b?null:yh.a.qg(Kk.FormattingReader.language(b)))?b.name:""}LYa(){return this.Ow.Xhf()}fUh(){return this.Ow.Xhf()}gfi(){return this.Ow.Scm()}}
Object(m.a)(SK,"WordInsightsManager",eD,[]);var uM=c(171);class TK{}Object(m.a)(TK,"CommandMetadataResponse",null,[]);class kC{constructor(){this.zmf=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){uM.PrivacyDialogManager.L8d()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const k=
new TK;b.iconNames&&(k.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return k;try{k.label=appChrome.selectors.getControlLabel(b.commandId);if(k.svgData&&""!==k.svgData)return k;const r=appChrome.selectors.getControlIconSet(b.commandId),y=Array(2);y[0]=r["default"];y[1]=r.icon32;k.svgData=this.getCommandIconSvg(y)}catch(r){return null}return k}getCommandIconSvg(b){if(!this.zmf)return"";for(let k=0;k<b.length;k++){const r=b[k];if(r in this.zmf)return this.zmf[r]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const k=
{SourceControlId:"GiveFeedback"};k.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=kC.T8k;k.telemetryGroup=r;k.appData=b;return k}}kC.k6h="FA000000012";kC.queryPrefix="AssetID=";kC.T8k="SearchPane";Object(m.a)(kC,"BaseSerpletExecutor",null,[295,275]);class UK extends kC{constructor(b,k,r){super();this.ga=b;this.hb=k;this.Dy=r}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Xb(Wa.a.YEb,2,null);break;case 1:this.ga.Xb(Jc.a.dLb,
2,null);break;case 2:this.ga.Xb(Wa.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Xb(ib.a.ENd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Xb(ib.a.Cdc,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const k={};k.CommandValueId=b;k.SourceControlId="Insights";this.ga.Xb(ib.a.U9e,2,k)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};
sG(this.hb,this.Dy);this.ga.Xb(ib.a.U9e,2,b)}openFindTaskPane(b){const k={};k.CommandValueId=b;k.SourceControlId="Insights";this.ga.Xb(ib.a.findInDocument,2,k)}openNavigationPane(){this.ga.Xb(Jc.a.bfc,2,null)}openSerpletTaskPane(){this.ga.Xb(ib.a.$ai,2,null)}sendAutoLaunchSearchRequest(){this.ga.Xb(ib.a.xNd,2,null)}getAllIcons(){const b={};for(const r of Object.keys(window))if(r.startsWith("word")){var k=window[r];k&&(k=k.icons,null!==k&&void 0!==k&&k.length&&k.forEach(y=>b[y.id]=JSON.stringify(y)))}return b}}
Object(m.a)(UK,"WordSerpletExecutor",kC,[]);class VK extends nG{constructor(){super();this.ZBe=null;this.fx=()=>{n.AFrameworkApplication.JZ&&(this.S0k(),Ho.a.Qm().then(()=>this.ZBe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){n.AFrameworkApplication.JZ&&(this.ZBe.Pa("WordEditor.Insights.WordInsightsActor").Vb(),n.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&n.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?
n.AFrameworkApplication.K.gq(this.fx):super.init())}zc(b){super.zc(b);this.ZBe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new dq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new IK(n.AFrameworkApplication.ya)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new UK(n.AFrameworkApplication.ya,bh.a.instance,
b.resolve("Box4.ISelectionFactory"))).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new iF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const k=new Cy(new cg.a(()=>Ka.App.xa?Ka.App.xa.jb.Xc:null),b.resolve("Box4.IParagraphReader"),zK.a.instance,n.AFrameworkApplication.K,
ks.a.instance,oM.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),n.AFrameworkApplication.ya,bh.a.instance,b.resolve("Box4.ISelectionFactory"));k.initialize();return new GK(new cg.a(()=>Ka.App.xa?Ka.App.xa.jb.Xc:null),b.resolve("Box4.IParagraphReader"),Bb.InteractiveViewManager.instance,bh.a.instance,b.resolve("Box4.ISelectionFactory"),k,Ka.App.ik.ml.Ve(12),new cg.a(()=>Ka.App.xa.jb),Id.FocusManager.instance(),n.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),
b.resolve("Common.App.Insights.IInsightsSelection"),b.$a("WordEditor.Insights.IAugloopSearchProviderManager"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new SK(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();b.ha("WordEditor.Insights.WordInsightsActor",()=>new JK(b.Ze("Common.App.Insights.IInsightsManager"),n.AFrameworkApplication.ya,
n.AFrameworkApplication.K)).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new HK(b.$a("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(m.a)(VK,"WordInsightsPackage",nG,[]);class vM{}Object(m.a)(vM,"ScalingStep",null,[]);class WK{constructor(b,k,r){this.Gpc=!1;this.GO=null;this.Bwc=this.PRb=!1;this.NUa=[];this.K4d=y=>{this.D8&&this.D8!==y&&appChrome.api.dispatch(this.QZh(!1))};k.execute(y=>{this.GO=y});b.tB(Object(u.a)(this,this.AZm,"onProcessSetSelectionFinished"));
this.Vt=r}S3b(b,k,r){const y=[];for(const R of b)y.push(appChrome.actions.addScalingStepInTab("Home",{type:k,controlId:R},r));return y}lYh(b){const k=[];for(let r=0;4>r;r++)k.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));k.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return k}QZh(b){const k=[];if(b)switch(this.D8){case "Image":k.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor",
"Home"));k.push(...this.lYh("PictureStyles"));k.push(...this.S3b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.NUa.slice().reverse();b.push("TextAlignmentAnchor");k.push(...this.S3b(b,"MoveToOverflow"));break;case "Table":this.Bwc||k.push(...this.lYh("TableStyles"));k.push(...this.S3b(this.NUa,"DropLabel",this.Bwc?0:void 0));b=this.NUa.slice().reverse();k.push(...this.S3b(b,"MoveToOverflow"));break;case "Hyperlink":k.push(...this.S3b(["EditHyperlink",
"RemoveHyperlink"],"DropLabel")),b=this.NUa.slice().reverse(),k.push(...this.S3b(b,"MoveToOverflow"))}else for(const r of this.NUa)k.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return k}B3c(b){let k={};for(const r of b)try{k[r]=appChrome.selectors.getModelType(r)}catch(y){this.Faa("Error","GetModelType failed for "+r)}Ka.App.xa.TDd(k)}Vio(b){if(0!==b.length){var k=[],r={},y=!1;for(const R of b)try{if(appChrome.selectors.isControlDefined(R))r[R]=appChrome.selectors.getModelType(R);
else{y=!0;break}}catch(aa){this.Faa("Error","GetModelType failed for "+R);y=!0;break}if(y)this.D8=void 0,this.Qce(!1);else{if("Image"===this.D8&&!this.PRb)k.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.PRb=!0;else if(this.PRb){k.push(appChrome.actions.updateGroupHiddenState("Font",!1));y=appChrome.selectors.getVisibleControlsInGroup("Font");for(const R of y)r[R]=appChrome.selectors.getModelType(R);this.PRb=!1}Ka.App.xa.TDd(r);this.NUa=b;r=[];for(const R of b)appChrome.selectors.isControlDisabled(R)&&
r.push(R);0<r.length&&this.Faa("Disabled",r.join(","));0<this.NUa.length&&(k.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),k.push(appChrome.actions.updateControlsInGroup("Adaptive",this.NUa)),k.push(...this.QZh(!0)),this.Gpc=!0);appChrome.api.dispatch(k)}}}Qce(b){if(b||this.Gpc){var k=[];k.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Gpc=b;if("Image"===this.D8||this.PRb){b=!b;k.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");
this.B3c(r)}this.PRb=!b}appChrome.api.dispatch(k)}}dhc(){this.Gpc&&this.Vt&&this.Vt.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}AZm(b,k){!n.AFrameworkApplication.ta.Rb.Pec&&"Home"===appChrome.selectors.getSelectedTabId()&&this.GO&&k.kl&&k.kl.kb&&0!==k.kl.length?(b=()=>{let r=[],y=!1;var R=this.GO.contentType,aa=appChrome.selectors.getActiveContextualTabIds();R.includes("Image")?(this.K4d("Image"),this.D8&&"Image"===this.D8?y=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.D8="Image")):R.includes("Table")&&0<=aa.indexOf("Table")?(R=!(lt.a.instance.kb.QCa||lt.a.instance.kb.Bw||lt.a.instance.kb.tEb),(aa="Table"===this.D8&&R!==this.Bwc)?this.K4d("TableCellEdit"):this.K4d("Table"),!this.D8||"Table"!==this.D8||aa?(R?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.Bwc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.Bwc=!1),this.D8="Table"):y=!0):R.includes("Hyperlink")&&(this.K4d("Hyperlink"),this.D8&&"Hyperlink"===this.D8?y=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.D8="Hyperlink"));y?this.Gpc||(this.B3c(this.NUa),this.Qce(!0),this.dhc()):0<r.length?(this.Vio(r),this.dhc()):this.Qce(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.Qce(!1)}Faa(b,k){b={Time:(new Date).getTime(),Event:b,Message:k,Scenario:"AdaptiveTabGroup"};
k=new Jh.a;k.name="Events";k.dataFields=Ji.a.WJ(b);k.durationMs=window.performance.now();Y.a.xEa(k,"TellMeWAC.")}}Object(m.a)(WK,"AdaptiveTabGroupUpdater",null,[]);class XK{constructor(){this.W=null;this.sRm=()=>{n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new WK(this.W.resolve("Box4.ISelectionManager"),this.W.$a("Common.IActionContextProvider"),this.W.$a("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}zc(b){this.W=b}init(){NB(1,this.sRm)}dispose(){}}Object(m.a)(XK,"PackageManager",null,[1,2]);const wM=(b,k,r)=>1===r?32:2===r?(c.e(5).then(c.bind(null,1910)).then(y=>{y.createAndShowDevToolsMenu()}),32):2;class tG{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))n.AFrameworkApplication.ya.pa(Jc.a.R0f,zc.a.frame,wM),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(5).then(c.bind(null,1910))}dispose(){}zc(){}static main(){M.a.instance.Pc(new tG)}}Object(m.a)(tG,"WordDevToolsPackage",null,[1,2]);c(577);class uG{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(uG,"FormattingData",null,[]);class YK extends uG{constructor(){super();this.hyperlinkData=null}}Object(m.a)(YK,"RichContentCommandData",
uG,[]);class Ui{constructor(){Ui.Xi.add(Jc.a.P3a);Ui.Xi.add(Jc.a.ALb);Ui.Xi.add(Jc.a.Zfc);Ui.Xi.add(Jc.a.UX);Ui.Xi.add(Jc.a.oEf);Ui.Xi.add(Jc.a.sNf);Ui.Xi.add(Jc.a.deleteComment);Ui.Xi.add(Jc.a.LDc);Ui.Xi.add(Jc.a.t3e);Ui.Xi.add(Jc.a.d9d);Ui.Xi.add(Jc.a.d4a);Ui.Xi.add(Jc.a.R0f);Ui.Xi.add(Jc.a.dLb);Ui.Xi.add(Jc.a.X0f);Ui.Xi.add(Jc.a.KEc);Ui.Xi.add(Jc.a.kAd);Ui.Xi.add(Wa.a.digitalPrintToSway);Ui.Xi.add(Wa.a.openInClient);Ui.Xi.add(Wa.a.print);Ui.Xi.add(Wa.a.l1d);Ui.Xi.add(Wa.a.JPf);Ui.Xi.add(Wa.a.IIb);
Ui.Xi.add(Wa.a.YEb);Ui.Xi.add(ib.a.Dcj);Ui.Xi.add(ib.a.tellMe);Ui.Xi.add(ib.a.d2c);Ui.Xi.add(ib.a.Cdc);Ui.Xi.add(ib.a.giveFeedback);Ui.Xi.add(ib.a.B0c);Ui.Xi.add(ib.a.J0f);Ui.Xi.add(ib.a.Gag);Ui.Xi.add(ib.a.$cb);Ui.Xi.add(ib.a.newComment);Ui.Xi.add(ib.a.bYe);Ui.Xi.add(ib.a.ENa);Ui.Xi.add(ib.a.mUf);Ui.Xi.add(ib.a.lUf);Ui.Xi.add(ib.a.nUf);Ui.Xi.add(ib.a.Bzd);Ui.Xi.add(ib.a.Nja);Ui.Xi.add(ib.a.t9d);Ui.Xi.add(ib.a.W5i);Ui.Xi.add(ib.a.close);Ui.Xi.add(ib.a.g2d);Ui.Xi.add(ib.a.s1d);Ui.Xi.add(ib.a.CZd);
Ui.Xi.add(ib.a.m9d);Ui.Xi.add(ib.a.s9d);Ui.Xi.add(ib.a.ZHb);Ui.Xi.add(ib.a.renameFile);Ui.Xi.add(ib.a.E5b);Ui.Xi.add(ib.a.x1f);Ui.Xi.add(ib.a.jfc);Ui.Xi.add(ib.a.downloadACopy);Ui.Xi.add(ib.a.xdc);Ui.Xi.add(ib.a.r0d);Ui.Xi.add(ib.a.CIb);Ui.Xi.add(ib.a.ZJi);Ui.Xi.add(ib.a.xph);Ui.Xi.add(ib.a.wvd);Ui.Xi.add(ib.a.aYe);Ui.Xi.add(ib.a.zph);Ui.Xi.add(ib.a.yph);Ui.Xi.add(ib.a.bYe);Ui.Xi.add(ib.a.xvd);Ui.Xi.add(Jc.a.Zee);Ui.Xi.add(Jc.a.Bbg);Ui.Xi.add(Jc.a.zoomToPageWidth);Ui.Xi.add(Jc.a.ZWf);Ui.Xi.add(Jc.a.yjb);
Ui.Xi.add(Jc.a.B2d);Ui.Xi.add(Jc.a.Iha);Ui.Xi.add(ib.a.wfb);Ui.Xi.add(ib.a.Wbb);Ui.Xi.add(ib.a.ofc);Ui.Xi.add(ib.a.soj);Ui.Xi.add(ib.a.fKi);Ui.Xi.add(Wa.a.LHb);Ui.Xi.add(Wa.a.jga)}}Ui.Xi=new Set;Object(m.a)(Ui,"CommentRibbonCommands",null,[]);class ZK{constructor(b,k,r,y,R,aa){this.vvi=b;this.vi=k;this.eq=r;this.ir=y;this.mf=R;this.$$n=aa;this.BUb=null;this.lxa=new xc.a(0);this.Wnb=new xc.a(0);this.kje=new xc.a(0);this.SLe=!1;this.s4l();this.Bpn()}Tbm(b){return this.BUb&&this.eq.Ry?!Ui.Xi.has(b):
!1}BKc(b,k,r){if(b===ib.a.Cg)return 32;if(!this.lxa.ub(b)&&!this.Wnb.ub(b)||!this.BUb)return 2;const y=this.Wnb.ub(b);var R=y?this.Wnb.J(b):this.lxa.J(b);const aa=y?2:this.kje.J(r);y||1!==aa||(this.ufm(Ka.App.xa.fp.pg.name)||Ka.App.xa.fp.Kg(this.vi.pn?id.AFrame.hr:id.AFrame.CL),Ka.App.xa.updateCommandUI(!0));r=new YK;if(this.ir.ADb)switch(R){case 1:r.highlight={color:this.OYh(k.Color)};break;case 6:r.fontColor={color:this.OYh(k.Color)}}R=this.BUb.executeCommand(R,aa,r);2===R&&y&&(b===Wa.a.Gbc?k[Ig.a.On]=
!!r.bold:b===Wa.a.Mbc?k[Ig.a.On]=!!r.italic:b===Wa.a.Ybc?k[Ig.a.On]=!!r.underline:b===Wa.a.Sbc?k[Ig.a.On]=!!r.strikethrough:b===Wa.a.GX?k[Ig.a.On]=!!r.highlight:b===Wa.a.Ks&&(k[Ig.a.On]=!!r.fontColor));return 2===R?32:1===R?2:8}Imn(b){this.BUb=b;this.BUb.registerSelectionChangeHandler(()=>{this.SLe||(this.SLe=!0,Ka.App.xa.updateCommandUI(!0),this.SLe=!1)});this.BUb.registerKeypressHandler(k=>{if(k.shortKey)switch(k.key){case tb.a.MNb:case tb.a.uge:case tb.a.zge:case tb.a.oRa:Ka.App.xa.updateCommandUI(!0)}k.key!==
tb.a.eB&&k.key!==tb.a.g0||Ka.App.xa.updateCommandUI(!0)})}Bpn(){this.vvi.UNi(id.AFrame.hr,this);this.vvi.UNi(id.AFrame.CL,this)}s4l(){this.lxa.Z(Wa.a.bold,0);this.lxa.Z(Wa.a.setItalic,3);this.lxa.Z(Wa.a.strikethrough,4);this.lxa.Z(Wa.a.underline,5);this.ir.ADb&&(this.lxa.Z(Wa.a.GX,1),this.lxa.Z(Wa.a.ika,1),this.lxa.Z(Wa.a.Ks,6),this.lxa.Z(Wa.a.S5,6),this.lxa.Z(Wa.a.Yga,6));this.Wnb.Z(Wa.a.Gbc,0);this.Wnb.Z(Wa.a.Mbc,3);this.Wnb.Z(Wa.a.Sbc,4);this.Wnb.Z(Wa.a.Ybc,5);this.kje.Z(1,0);this.kje.Z(2,1)}ufm(b){return b===
id.AFrame.hr||b===id.AFrame.CL}OYh(b){return b?Uo.a.PC(this.$$n.Zza(this.mf.ld,b)):""}}Object(m.a)(ZK,"CommentRibbonCommandHandler",null,[227,228]);class vG{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").rQf?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Dga("OnCommentRenderedOnce",
()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}zc(b){this.W=b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new ZK(this.W.Pa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.CommentsSettings"),jl.App.En.jb.Fc,Ti.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",
()=>new Ui).singleInstance()}static main(){M.a.instance.Pc(new vG)}}Object(m.a)(vG,"PackageManager",null,[1,2]);var xM=c(1814);class dE{constructor(b,k){this.SSk=2E3;this.Y7g=null;this.TKf=b.GEi;this.maxLength=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.SSk);k&&k.execute(r=>{this.Y7g=r})}tcf(b){b=this.gml(b,this.maxLength);return{semantic:tr.ObjectSemantic.CanvasContext,type:tr.ObjectSchemaType.WordCanvasContext,value:b}}gml(b,k){try{return this.fml(b,
k)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",r),null}}tKl(b,k){const r={NXa:[],Zua:0,selection:{start:null,end:null},cursor:null,tiles:[]},y=b.length;for(let aa=0;aa<y;aa++){const ta=b.J(aa);var R=ta.node;if(!ie.ParagraphReader.nc(R)||Array.contains(r.NXa,R.xn))continue;r.NXa.push(R.xn);const Ya=ie.ParagraphReader.textLength(R);if(r.Zua+Ya>k)break;R=this.TKf.Cxb(R);r.tiles.push(R);r.Zua+=Ya;1!==y||r.cursor||(r.cursor=dE.tql(ta,r.tiles.length-
1));null===r.selection.start&&0===aa&&(r.selection.start=this.p1h(ta,!0,r.tiles.length-1));null===r.selection.end&&aa===y-1&&(r.selection.end=this.p1h(ta,!1,r.tiles.length-1))}return r}MBl(b,k,r){const y={r2c:[],fcj:[],Zua:0};var R=b.J(0).node;let aa=b.J(b.length-1).node;for(b=k;0<b&&(R||aa);){var ta=dE.FIi(R,!0,b,r);if(R=ta.node)R=this.TKf.Cxb(R),y.r2c.push(R),b-=ta.Zua,R=ta.node,r=ta.NXa;ta=dE.FIi(aa,!1,b,r);if(aa=ta.node)r=this.TKf.Cxb(aa),y.fcj.push(r),b-=ta.Zua,aa=ta.node,r=ta.NXa}y.Zua=k-b;
return y}hml(b,k){let r=0;var y=this.tKl(b,k);const R={tiles:y.tiles,selection:y.selection,cursor:y.cursor};r+=y.Zua;y=y.NXa;r<k&&(b=this.MBl(b,k-r,y),R.tiles.unshift.apply(R.tiles,b.r2c),R.tiles.push.apply(R.tiles,b.fcj),R.selection.start&&(R.selection.start.index+=b.r2c.length),R.selection.end&&(R.selection.end.index+=b.r2c.length),R.cursor&&(R.cursor.index+=b.r2c.length));return R}fml(b,k){var r;if(!b)return null;b=this.hml(b,k);return{contentType:null===(r=this.Y7g)||void 0===r?void 0:r.contentType,
formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}p1h(b,k,r){if(b.contextId===lc.a.Hd||b.contextId===lc.a.paragraph||b.contextId===lc.a.Wc){if(k&&-1!==b.gl)return{index:r,offset:b.gl};if(!k&&-1!==b.zt)return{index:r,offset:b.zt}}return null}static tql(b,k){return b.contextId===lc.a.Wc?{index:k,offset:b.gl}:null}static FIi(b,k,r,y){y={node:null,Zua:0,NXa:y};if(!b||0>=r||!y.NXa)return y;do y.node=ie.ParagraphReader.eh(b,k,!1,!1),y.Zua=y.node?ie.ParagraphReader.textLength(y.node):0,b=y.node;
while(y.node&&(Array.contains(y.NXa,y.node.xn)||!ie.ParagraphReader.nc(y.node)||!y.Zua));y.node&&(y.Zua>r?y.node=null:y.NXa.push(y.node.xn));return y}}Object(m.a)(dE,"Box4CanvasContextProvider",null,[226]);class wG{get name(){return"Box4.CanvasContext"}init(){}dispose(){}zc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new dE(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.$a("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){M.a.instance.Pc(new wG)}}
Object(m.a)(wG,"Box4CanvasContextPackage",null,[1,2]);class $K{constructor(b,k){this.YD=null;this.oz={};this.Hb=b;this.pf=k;this.RMe=new Map;this.SMe=new Map;this.Ipd=new Map}start(){this.YD=new nd.a(0,2,3E4,this.oDn.bind(this),216);this.Hb.fc(this.YD)}stop(){this.YD&&this.Hb.Ye(this.YD)}M6j(b,k){this.RMe.set(b,k)}N6j(b,k){this.SMe.set(b,k)}oDn(){if(this.pf.Bo)v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var b=50;this.oz.ScanTime=Date.now();this.oz.NumWatchDogs=
this.Ipd.size;this.Ipd.forEach((k,r)=>{this.oz[r]={["WatchDogStatus"]:k.yLm()};k.Cpm()||(b=15)});v.ULS.sendTraceTag(520974674,306,b,JSON.stringify(this.oz))}}fAn(){this.mHi(this.RMe);this.CEb&&this.mHi(this.SMe)}get Bbk(){return this.RMe.size+this.SMe.size===this.Ipd.size}mHi(b){b.forEach((k,r)=>{k.execute(y=>{y?(this.Ipd.set(r,y),this.YD||this.start()):v.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",r)})})}get CEb(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WaitForRealEditEnabledForRADS",
!1)}}Object(m.a)($K,"WatchDogManager",null,[21]);class xG{constructor(){this.W=this.qVa=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.rNa&&(this.qVa=this.W.resolve(this.name),this.p6l())}dispose(){this.qVa&&this.qVa.stop()}zc(b){this.rNa&&(this.W=b,b.ha(this.name,this.pQk.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance())}static main(){M.a.instance.Pc(new xG)}Mso(){if(!this.qVa.Bbk){let b=[],k=0;this.Wkd.forEach((r,y)=>{r&&(this.W.Pa(y)||(b[k++]=y))});
0<b.length&&v.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}pQk(){return new $K(n.AFrameworkApplication.uc,this.W.resolve("Common.ISessionStatus")||Ae.SessionStatusManager.instance)}z7j(){let b=new nd.a(1,1,12E4,this.Mso.bind(this),216);n.AFrameworkApplication.uc.fc(b)}F7j(){this.Wkd=new Map;this.Xkd=new Map;this.Xkd.set("WordEditor.RunawayDataLossMonitorWatchDog",(Ka.App.Fm||Ka.App.zs)&&this.K7b);this.Xkd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",this.FPd)}p6l(){this.F7j();
this.CEb?this.S$g(this.Xkd,this.qVa.N6j.bind(this.qVa)):this.Wkd=new Map([...this.Wkd,...this.Xkd]);this.S$g(this.Wkd,this.qVa.M6j.bind(this.qVa));this.qVa.fAn();this.z7j()}S$g(b,k){b.forEach((r,y)=>{r&&k(y,this.W.$a(y))})}get rNa(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WatchDogManagerIsEnabled",!1)}get FPd(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsWatchDogEnabled",!1)}get K7b(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossWatchDogEnabled",
!1)}get CEb(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WaitForRealEditEnabledForRADS",!1)}}Object(m.a)(xG,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");
Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");F.main();Type.registerNamespace("Common.App.WopiIdentity");sa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");zb.main();Object(xM.a)(!1);yc.main();Lc.main();Gb.main();tG.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Ce.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Ed.main();Type.registerNamespace("Common.App.WildFire");le.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Wb.main();Type.registerNamespace("Common.App.HostNotification");rh.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Se.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");qf.main();Type.registerNamespace("CNT");Wf.main();Type.registerNamespace("Common.App.NewAndOpen.Core");M.a.instance.Pc(new dn);Type.registerNamespace("Common.App.NewAndOpen.UX");M.a.instance.Pc(new kf);Type.registerNamespace("Common.App.OneDriveFilePickerApi");hm.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Mj.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");dc.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");Nc.main();Type.registerNamespace("CADWLTR");sd.main();Type.registerNamespace("Common.App.DirectPrint");M.a.instance.Pc(new Nj);Type.registerNamespace("Common.App.SearchOAuthManager");Bh.main();yi.main();vh.main();zg.main();zi.main();kh.main();nk.main();M.a.instance.Pc(new Rd);qe.main();ok.main();
Hm.main();M.a.instance.Pc(new wq);Type.registerNamespace("Common.App.SaveStatus");M.a.instance.Pc(new rk);Type.registerNamespace("Common.App.EventsCacheManager");Um.main();Type.registerNamespace("CUIB");Sr.main();Type.registerNamespace("CommandUI.TaskPane");try{M.a.instance.Pc(new xa(Ka.App.xa.jb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}go.main();Type.registerNamespace("Common.App.Insights");Br;M.a.instance.Pc(new fn);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");gp("Begin");M.a.instance.Pc(new Ek);try{M.a.instance.Pc(new kk(kj.a.get_instance(),Ka.App.xa.jb,Ka.App.xa.Rb))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}Dr.main();M.a.instance.Pc(new $a);Rm.main();pn.main();Em.main();Ls.main();wo.main();Tl.main();Yu.main();Zu.main();M.a.instance.Pc(new fs);lw.main();mw.main();cx.main();
Cv.main();wG.main();vG.main();M.a.instance.Pc(new Hp);M.a.instance.Pc(new qB);Iz.main();mt.main();Ah.main();M.a.instance.Pc(new xB);M.a.instance.Pc(new Rz);zu;Vs.main();f.main();gc.main();Do.main();Cp;M.a.instance.Pc(new Zz);M.a.instance.Pc(new iv);Ws.main();BC.main();EC.main();M.a.instance.Pc(new eA);M.a.instance.Pc(new QB);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Hw;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");UB.main();oF.main();pF.main();fL;KF.main();KL;window.MSOJS=iB;fG.main();iG.main();M.a.instance.Pc(new VK);M.a.instance.Pc(new XK);(()=>Object(gr.__awaiter)(void 0,void 0,void 0,function*(){n.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield c.e(22).then(c.bind(null,1915)).then(b=>{b.initializeOnDemandPackage()}))}))();xG.main()},1919:function(C,O,c){C=c(0);var l=c(8),e=c(1546);
class a{static get lIm(){return 50}static FHd(m){if(""===m)return"";let v=0,u="";try{const n=e.a.P2b(m);for(const x of n.ops)if(a.MF(x))v||(u+=a.Ytl(x.attributes.atmention.fullName)),v+=1;else{const A=x.insert?x.insert:"";" "!==A&&0<A.length&&(v=0,u+=A)}}catch(n){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return u}static aol(m){m=a.FHd(m);return 0<m.length&&m.split(" ").length<=a.lIm?m:null}static Ytl(m){let v="";
m&&(m=m.split(" "),0<m.length&&(v=m[0]));return v}static MF(m){return!!m.attributes&&!!m.attributes.atmention}}Object(C.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(O,"a",function(){return h});class h extends a{constructor(){super()}static sAb(m,v,u=!1){if(!m)return null;m=m.text&&0<m.text.length?m.text[0]:"";v=!v||!v.Kf||""===v.Kf;return 0<m.length&&v&&!u?a.aol(m):null}}Object(C.a)(h,"CommentSmartReplyHelpers",a,[])},705:function(C,O,c){Object.defineProperty(O,"__esModule",{value:!0});var l=
c(79);l.__exportStar(c(923),O);l.__exportStar(c(1195),O);l.__exportStar(c(924),O);l.__exportStar(c(1196),O);l.__exportStar(c(1197),O);l.__exportStar(c(1198),O);C.exports.getChangeGateDictionary||Object.defineProperty(C.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return C.exports.NOh}});C.exports.getFeatureGateDictionary||Object.defineProperty(C.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return C.exports.PRh}});C.exports.makeGetTypedFeatureGate||Object.defineProperty(C.exports,
"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return C.exports.Mqi}});C.exports.makeTypedIsChangeGateEnabled||Object.defineProperty(C.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return C.exports.Rqi}})},848:function(C,O,c){function l(){return c(848)}function e(qb){for(var rb=[],nb=1;nb<arguments.length;nb++)rb[nb-1]=arguments[nb];return e.W2c.apply(e,Object(ba.__spreadArray)([qb,void 0],rb,!1))}function a(qb){return h(qb)&&"WorkerError"===qb.name&&"object"===typeof qb.info}
function h(qb){return null==qb?!1:qb instanceof Error?!0:"string"===typeof qb.name&&"string"===typeof qb.message&&(null==qb.stack||"string"===typeof qb.stack)}function m(qb){if(h(qb))var rb=qb;else{rb=Error;var nb="(non-Error object) ".concat;a:{var Tb=typeof qb;switch(Tb){case "function":case "symbol":case "undefined":qb="<".concat(Tb,">");break a;case "object":qb=JSON.stringify(qb);break a;default:qb="".concat(qb)}}rb=rb(nb.call("(non-Error object) ",qb))}return rb}function v(qb){var rb=qb.name,
nb=a(qb)?qb.Xik:qb.message,Tb=qb.stack;a(qb)?(qb=qb.info,qb=Object(ba.__assign)(Object(ba.__assign)({},qb),{error:qb.error?v(qb.error):void 0})):qb=void 0;return{name:rb,message:nb,stack:Tb,info:qb}}function u(qb){return h(qb)?{qfa:!0,value:v(qb)}:{qfa:!1,value:qb}}function n(qb){if("WorkerError"===qb.name){var rb=qb.message;var nb=qb.info;nb=Object(ba.__assign)(Object(ba.__assign)({},nb),{error:nb.error?n(nb.error):void 0});rb=new qa(rb,nb)}else(rb=Ma[qb.name])?rb=new rb(qb.message):(rb=Error(qb.message),
rb.name=qb.name);null!=qb.stack&&(rb.stack=qb.stack);return rb}function x(qb){return qb.qfa?n(qb.value):qb.value}function A(){return"undefined"!==typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function H(qb){if(Ia)throw new TypeError("setConfig has already been called");Ia=qb}function E(){var qb=null!==Ia&&void 0!==Ia?Ia:{};return{createTimeout:qb.createTimeout,createMode:qb.createMode,importScriptUrls:qb.importScriptUrls?
Object(ba.__spreadArray)([],qb.importScriptUrls,!0):void 0,typedWorkersUrl:qb.typedWorkersUrl,typedWorkersName:qb.typedWorkersName,$mf:qb.$mf}}function L(qb){var rb,nb;return null!==(nb=null!==(rb=null===qb||void 0===qb?void 0:qb.createTimeout)&&void 0!==rb?rb:null===Ia||void 0===Ia?void 0:Ia.createTimeout)&&void 0!==nb?nb:3E5}function M(qb){var rb,nb;qb=null!==(nb=null!==(rb=null===qb||void 0===qb?void 0:qb.createMode)&&void 0!==rb?rb:null===Ia||void 0===Ia?void 0:Ia.createMode)&&void 0!==nb?nb:
"Thread";return"ThreadOrLocal"===qb?A()?"Thread":"Local":qb}function F(qb){setTimeout(function(){throw qb;})}function J(){return"undefined"!==typeof self&&"__typed_workers_thread"in self?self:void 0}function I(qb){var rb=J();void 0!==rb?(qb={kind:1,error:u(qb)},rb.postMessage(qb)):console.warn(qb)}function K(qb){var rb;try{(null!==(rb=null===Ia||void 0===Ia?void 0:Ia.sLo)&&void 0!==rb?rb:I)(qb)}catch(nb){console.warn(qb),F(nb)}}function N(qb){var rb=J();void 0!==rb&&rb.postMessage({kind:2,stats:qb})}
function G(qb){var rb;try{(null!==(rb=null===Ia||void 0===Ia?void 0:Ia.OKo)&&void 0!==rb?rb:N)(qb)}catch(nb){F(nb)}}function P(qb,rb){return qb.then(function(nb){rb();return nb},function(nb){rb();return Promise.reject(nb)})}function S(qb,rb,nb){if(1073741824<qb)return nb;var Tb=setTimeout(rb,Math.max(0,qb));return{resolve:function(Zb){clearTimeout(Tb);nb.resolve(Zb)},reject:function(Zb){clearTimeout(Tb);nb.reject(Zb)}}}function W(){var qb=Object.create(null);qb.key=void 0;delete qb.key;return qb}
function X(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(qb){return!1}}function Y(qb,rb){var nb=W(),Tb=za("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(Zb,Hb){var Sa;return"then"===Hb?void 0:null!==(Sa=Zb[Hb])&&void 0!==Sa?Sa:Zb[Hb]=qb(Hb)}:function(Zb,Hb){var Sa;return null!==(Sa=Zb[Hb])&&void 0!==Sa?Sa:Zb[Hb]=qb(Hb)};if(!rb)return new Proxy(nb,{get:Tb});rb.forEach(function(Zb){return Tb(nb,Zb)});return nb}function ca(qb){throw qb;}function ha(){return{status:"Pending",
start:Xa()}}function ra(qb,rb,nb){"Pending"===qb.status&&(qb.status=rb,qb.end=Math.max(qb.start,null!==nb&&void 0!==nb?nb:Xa()))}function sa(qb,rb){function nb(Tb){ra(qb,a(Tb)&&"Timeout"===Tb.info.gZ?"Timeout":"Error");throw Tb;}try{return rb().then(function(Tb){var Zb;return null!==(Zb=ra(qb,"Success"))&&void 0!==Zb?Zb:Tb},nb)}catch(Tb){nb(Tb)}}function oa(qb,rb,nb){var Tb,Zb,Hb,Sa=null!==(Tb=null===qb||void 0===qb?void 0:qb.start)&&void 0!==Tb?Tb:Infinity;Tb=Sa<rb?rb:Sa>nb?nb:Sa;Sa=null!==(Zb=null===
qb||void 0===qb?void 0:qb.end)&&void 0!==Zb?Zb:Infinity;nb=Sa<rb?rb:Sa>nb?nb:Sa;return{status:null!==(Hb=null===qb||void 0===qb?void 0:qb.status)&&void 0!==Hb?Hb:"Pending",start:Math.round(1E3*(Tb-rb))/1E3,end:Math.round(1E3*(nb-rb))/1E3,duration:Math.round(1E3*(nb-Tb))/1E3}}function ka(qb,rb,nb){nb="def"in nb?nb:e(nb);var Tb=nb.def,Zb=nb.args;return"function"!==typeof Tb?Promise.reject(new qa("Loading an InsideScript to create a local worker is unimplemented",{gZ:"InternalError",eD:{type:"Endpoint",
hLb:"Inside",id:qb.options.id}})):Promise.resolve().then(function(){return sa(rb.Sof=ha(),function(){return Tb.apply(void 0,Object(ba.__spreadArray)([{config:E(),importTypedWorkers:l,connection:qb}],Zb,!1)).then(function(){})})})}function ia(qb,rb,nb,Tb,Zb){var Hb=new MessageChannel,Sa=Hb.port2,ua;return Promise.all([Tb({port:Hb.port1,options:qb,createMode:rb}),sa(nb.Txd=ha(),function(){return fb.Txd({port:Sa,options:qb,createMode:rb},function(Fa){return Zb(ua=Fa)})})]).then(function(){return ua},
function(Fa){ua?ua.close("Force"):Sa.close();return Promise.reject(Fa)})}function La(qb,rb,nb,Tb){return ia(qb,"Local",rb,function(Zb){return ka(Zb,rb,nb)},Tb)}function va(qb,rb,nb,Tb){rb.cyd=ha();try{var Zb=new ib(qb,nb)}catch(Hb){return ra(rb.cyd,"Error"),Promise.reject(Hb)}ra(rb.cyd,"Success");return ia(qb,"Thread",rb,function(Hb){return Zb.E0e(Hb,rb)},Tb).then(function(Hb){Hb.pXl()?Zb.terminate():Hb.uPj=Zb.terminate.bind(Zb);return Hb},function(Hb){Zb.terminate();return Promise.reject(Hb)})}function Ga(qb,
rb,nb){void 0===nb&&(nb=function(){});var Tb=M(qb),Zb="local"in rb?"Local"===Tb?rb.local:rb.bao:rb,Hb="Local"===Tb?La:va,Sa={id:qb.id,createMode:Tb,C1e:ha()};rb=sa(Sa.C1e,function(){return Hb({id:qb.id,createTimeout:qb.createTimeout,createMode:qb.createMode,importScriptUrls:qb.importScriptUrls,$mf:qb.$mf},Sa,Zb,nb)});return P(rb,function(){var ua=Sa.createMode;var Fa=Sa.C1e,Pa=Sa.Sof,Ea=Sa.Txd,lb=Sa.cyd,zb=Fa.status,Xb=Fa.start;Fa=Fa.end;ua="Pending"!==zb&&void 0!==Fa?{id:Sa.id,createMode:ua,C1e:{status:zb,
ODo:Xb,duration:Math.round(1E3*(Fa-Xb))/1E3},cyd:"Thread"===ua?oa(lb,Xb,Fa):void 0,Txd:oa(Ea,Xb,Fa),Sof:oa(Pa,Xb,Fa)}:void 0;ua&&G(ua)})}function Oa(qb,rb){if(0===rb)importScripts.apply(void 0,qb);else for(var nb=0;nb<qb.length;nb++)a:{for(var Tb=void 0,Zb=qb[nb],Hb=rb,Sa=0;Sa<=Hb;Sa+=1)try{Tb=importScripts;if(0<Sa){var ua=Zb,Fa=String(Sa),Pa=ua.indexOf("?");if(0>Pa)var Ea="".concat(ua,"?").concat("retries","=").concat(Fa);else{var lb=ua.slice(0,Pa+1),zb=ua.slice(Pa+1).split("&");for(ua=0;ua<zb.length&&
("="!==zb[ua][7]||"retries"!==zb[ua].slice(0,7));ua+=1);zb[ua]="".concat("retries","=").concat(Fa);Ea=lb+zb.join("&")}}else Ea=Zb;Tb(Ea);break a}catch(Xb){Tb=Xb}throw Tb;}}function Za(){return"undefined"!==typeof WorkerGlobalScope}function ja(){return self.name}c.r(O);var ba=c(79),qa=function(qb){function rb(nb,Tb){var Zb=this.constructor,Hb;var Sa=qb.call(this,"".concat(nb,"; info = ").concat(JSON.stringify(Object(ba.__assign)(Object(ba.__assign)({},Tb),{error:null===(Hb=Tb.error)||void 0===Hb?void 0:
Hb.message}))))||this;Sa.Xik=nb;Sa.info=Tb;Sa.name="WorkerError";nb=Zb.prototype;Object.getPrototypeOf(Sa)!==nb&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(Sa,nb):Sa.__proto__=nb);return Sa}Object(ba.__extends)(rb,qb);return rb}(Error),Ma={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},Ia;e.W2c=function(qb,rb){for(var nb=[],Tb=2;Tb<arguments.length;Tb++)nb[Tb-2]=arguments[Tb];return{def:qb,args:nb,transferables:null!==rb&&void 0!==rb?rb:[]}};var wa=c(705),za=Object(wa.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample",
"OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(wa.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var pa,Ba=-1,Ra=function(){function qb(rb,nb){function Tb(){var Pa;return null===(Pa=Sa.onClose)||void 0===Pa?void 0:Pa.call(Sa)}var Zb,Hb,Sa=this;this.eD=rb;this.port=nb;this.isClosed=!1;this.exports={};this.w3c=W();var ua=(Zb={},Zb[0]=this.UXd.bind(this),Zb[1]=this.onResult.bind(this),Zb[2]=function(Pa){var Ea;Pa=Pa.ygl;null===(Ea=Sa.EVm)||void 0===Ea?void 0:Ea.call(Sa,
Y(Sa.jOk.bind(Sa),Pa),Y(Sa.PJk.bind(Sa),Pa))},Zb[3]=Tb,Zb),Fa=(Hb={},Hb[0]=this.DZm.bind(this),Hb[1]=this.uBi.bind(this),Hb[2]=Tb,Hb[3]=Tb,Hb);this.port.onmessage=function(Pa){Pa=Pa.data;return ua[Pa.kind](Pa)};this.port.onmessageerror=function(Pa){Pa=Pa.data;return Fa[Pa.kind](Pa)}}qb.prototype.RLn=function(rb){this.exports=rb;if(null!==pa&&void 0!==pa?pa:pa=X())rb=void 0;else{for(var nb=W();null!=rb;){for(var Tb=0,Zb=Object.getOwnPropertyNames(rb);Tb<Zb.length;Tb++){var Hb=Zb[Tb];try{"function"===
typeof rb[Hb]&&(nb[Hb]=!0)}catch(Sa){}}rb=Object.getPrototypeOf(rb)}rb=Object.getOwnPropertyNames(nb)}this.port.postMessage({kind:2,ygl:rb})};qb.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;this.port.postMessage({kind:3});this.port.close();for(var rb in this.w3c){var nb=this.w3c[rb],Tb=nb.reject;nb=nb.yZ;var Zb={gZ:"Connection",eD:this.eD,yZ:nb};nb=new qa("Importing Endpoint closed while waiting for ".concat(nb," result"),Zb);Tb(nb)}}};qb.prototype.UXd=function(rb){var nb=this,Tb=
rb.Mda,Zb=rb.yZ,Hb=rb.args;rb=Promise.resolve().then(function(){var Sa=nb.exports[Zb];if(Sa)return Sa.apply(nb.exports,Hb);Sa={gZ:"Connection",eD:nb.eD,Mda:Tb,yZ:Zb};throw new qa("Exporting Endpoint received a ".concat(0<=Tb?"call":"post"," to unknown function ").concat(Zb),Sa);});0<=Tb?rb.then(function(Sa){return nb.vXf(Tb,Zb,!0,Sa)},function(Sa){return nb.vXf(Tb,Zb,!1,Sa)}):rb.catch(function(Sa){Sa=m(Sa);Sa={gZ:"UnhandledError",eD:nb.eD,error:Sa,Mda:Tb,yZ:Zb};K(new qa("Exporting Endpoint's ".concat(Zb,
" implementation threw or rejected"),Sa))})};qb.prototype.vXf=function(rb,nb,Tb,Zb){Zb=u(Zb);rb={kind:1,Mda:rb,yZ:nb,Nfm:Tb,NTi:Zb};try{this.port.postMessage(rb,void 0)}catch(Hb){this.uBi(rb,m(Hb))}};qb.prototype.uBi=function(rb,nb){var Tb=rb.Mda,Zb=rb.yZ;rb=rb.NTi;var Hb=nb?"Exporting Endpoint failed to send ".concat(Zb," result"):"Importing Endpoint failed to deserialize ".concat(Zb," result");nb=new qa(Hb,{gZ:"MessageError",eD:this.eD,error:nb,Mda:Tb,yZ:Zb});rb.qfa?K(nb):this.vXf(Tb,Zb,!1,nb)};
qb.prototype.Bae=function(rb){var nb=this.w3c[rb];nb&&delete this.w3c[rb];return nb};qb.prototype.iKn=function(rb,nb,Tb,Zb){var Hb=this;return 1073741824<Tb?Zb:S(Tb,function(){var Sa=Hb.Bae(rb);if(Sa){var ua={gZ:"Timeout",eD:Hb.eD,timeout:Tb,Mda:rb,yZ:nb};Sa.reject(new qa("Importing Endpoint's call to ".concat(nb," timed out"),ua))}},Zb)};qb.prototype.gHn=function(rb,nb,Tb,Zb){var Hb=this;return new Promise(function(Sa,ua){var Fa=Ba+=1,Pa={kind:0,Mda:Fa,yZ:rb,args:nb};Hb.w3c[Fa]=Object(ba.__assign)(Object(ba.__assign)({},
Hb.iKn(Fa,rb,Tb,{resolve:Sa,reject:ua})),{yZ:rb});try{Hb.port.postMessage(Pa,Zb)}catch(Ea){if(Sa=Hb.Bae(Fa))ua=m(Ea),Fa={gZ:"MessageError",eD:Hb.eD,error:ua,Mda:Fa,yZ:rb},Sa.reject(new qa("Importing Endpoint failed to send call to ".concat(rb),Fa))}})};qb.prototype.YHn=function(rb,nb,Tb,Zb){nb={kind:0,Mda:-1,yZ:rb,args:nb};try{this.port.postMessage(nb,Zb)}catch(Hb){Zb=m(Hb),Zb={gZ:"MessageError",eD:this.eD,error:Zb,Mda:-1,yZ:rb},Tb(new qa("Importing Endpoint failed to post to ".concat(rb),Zb))}};
qb.prototype.DZm=function(rb){var nb,Tb=rb.Mda;rb=rb.yZ;var Zb={gZ:"MessageError",eD:this.eD,Mda:Tb,yZ:rb};rb=new qa("Exporting Endpoint failed to deserialize ".concat(0<=Tb?"call":"post"," to ").concat(rb),Zb);Tb=0<=Tb?this.Bae(Tb):void 0;(null!==(nb=null===Tb||void 0===Tb?void 0:Tb.reject)&&void 0!==nb?nb:K)(rb)};qb.prototype.onResult=function(rb){var nb=rb.Mda,Tb=rb.yZ,Zb=rb.Nfm;rb=rb.NTi;0<=nb?(Tb=this.Bae(nb))&&(Zb?Tb.resolve:Tb.reject)(x(rb)):(Zb={gZ:"InternalError",eD:this.eD,Mda:nb,yZ:Tb},
K(new qa("Exporting Endpoint sent a result for a post to ".concat(Tb),Zb)))};qb.prototype.jOk=function(rb){function nb(){for(var Zb=[],Hb=0;Hb<arguments.length;Hb++)Zb[Hb]=arguments[Hb];return nb.W2c.apply(nb,Object(ba.__spreadArray)([void 0],Zb,!1))}var Tb=this;nb.W2c=function(Zb){for(var Hb,Sa,ua,Fa=[],Pa=1;Pa<arguments.length;Pa++)Fa[Pa-1]=arguments[Pa];Tb.isClosed||(Pa=null!==(ua=null!==(Hb=nb.AAi)&&void 0!==Hb?Hb:null===(Sa=Tb.hDl)||void 0===Sa?void 0:Sa.call(Tb))&&void 0!==ua?ua:ca,Tb.YHn(rb,
Fa,Pa,Zb))};return nb};qb.prototype.PJk=function(rb){function nb(){for(var Zb=[],Hb=0;Hb<arguments.length;Hb++)Zb[Hb]=arguments[Hb];return nb.W2c.apply(nb,Object(ba.__spreadArray)([void 0],Zb,!1))}var Tb=this;nb.W2c=function(Zb){for(var Hb,Sa,ua,Fa=[],Pa=1;Pa<arguments.length;Pa++)Fa[Pa-1]=arguments[Pa];if(Tb.isClosed)return Hb={gZ:"Connection",eD:Tb.eD,yZ:rb},Promise.reject(new qa("".concat(Tb.eD.hLb," Endpoint's call.").concat(rb," called after close"),Hb));Pa=null!==(ua=null!==(Hb=nb.EVe)&&void 0!==
Hb?Hb:null===(Sa=Tb.dml)||void 0===Sa?void 0:Sa.call(Tb))&&void 0!==ua?ua:Infinity;return Tb.gHn(rb,Fa,Pa,Zb)};nb.EVe=void 0;return nb};return qb}(),fb=function(){function qb(rb,nb,Tb){function Zb(Hb){return function(){var Sa="Outside"===rb.hLb?"inside":"outside",ua={gZ:"Connection",eD:rb};throw new qa("".concat(rb.hLb," Endpoint's ").concat(Hb," referenced before the ").concat(Sa," Endpoint started"),ua);}}this.EVe=Infinity;this.AAi=ca;this.hcd=rb;this._state=nb;this.createMode=Tb;Object.defineProperties(this,
{post:{configurable:!0,enumerable:!1,get:Zb("post")},call:{configurable:!0,enumerable:!1,get:Zb("call")}})}qb.YAg=function(rb,nb,Tb){var Zb=nb.port,Hb=nb.options;nb=nb.createMode;var Sa={type:"Endpoint",hLb:rb,id:null===Hb||void 0===Hb?void 0:Hb.id};try{var ua=new Ra(Sa,Zb);var Fa=new qb(Sa,ua,nb)}catch(Pa){return Promise.reject(Pa)}return(new Promise(function(Pa,Ea){var lb;ua.dml=function(){return Fa.EVe};ua.hDl=function(){return Fa.AAi};ua.EVm=function(Pb,yc){Object.defineProperties(Fa,{post:{configurable:!0,
enumerable:!1,writable:!1,value:Pb},call:{configurable:!0,enumerable:!1,writable:!1,value:yc}});Xb.resolve()};ua.onClose=function(){return Fa.close("Force")};var zb=L(Hb),Xb=S(zb,function(){var Pb="Outside"===rb?"inside":"outside",yc={gZ:"Timeout",eD:Sa,timeout:zb};Pb=new qa("".concat(rb," Endpoint timed out waiting for the ").concat(Pb," to start"),yc);Xb.reject(Pb)},{resolve:Pa,reject:Ea});Fa.a8c=function(){Xb.resolve()};try{var ub=Tb(Fa)}catch(Pb){return Xb.reject(Pb)}null===(lb=Fa._state)||void 0===
lb?void 0:lb.RLn(ub)})).then(function(){Fa.a8c=void 0;return Fa},function(Pa){Fa.a8c=void 0;Fa.close();return Promise.reject(Pa)})};qb.prototype.pXl=function(){return void 0===this._state};qb.prototype.close=function(rb){var nb;if(this._state){if(this.a8c)if("Force"===rb)this.a8c();else{var Tb={gZ:"Connection",eD:this.hcd};throw new qa("".concat(this.hcd.hLb," Endpoint's close called during creation"),Tb);}rb=this._state;this._state=void 0;try{rb.close(),null===(Tb=this.uPj)||void 0===Tb?void 0:Tb.call(this),
null===(nb=this.onClose)||void 0===nb?void 0:nb.call(this)}catch(Zb){Tb={gZ:"Connection",eD:this.hcd,error:m(Zb)},K(new qa("".concat(this.hcd.hLb," Endpoint's close threw an error"),Tb))}}};qb.Txd=function(rb,nb){void 0===nb&&(nb=function(){});return qb.YAg("Outside",rb,nb)};qb.E0e=function(rb,nb){return qb.YAg("Inside",rb,nb)};return qb}(),Va=-1,ib=function(){function qb(rb,nb){var Tb;try{var Zb=void 0;var Hb="def"in nb?nb:e(nb),Sa=Hb.def,ua=Hb.args,Fa=Hb.transferables;if("function"!==typeof Sa)var Pa=
[Sa,ua,Fa,void 0];else{var Ea="__generatedInsideInit".concat(Va+=1),lb="var ".concat(Ea," = ").concat(Sa.toString(),";");Pa=[{scriptUrl:void 0,insideInitName:Ea},ua,Fa,lb]}this.script=Pa[0];this.args=Pa[1];this.transferables=Pa[2];Zb=Pa[3];this.Rsd=URL.createObjectURL(new Blob(void 0===Zb?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[Zb,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));nb={};null!=rb.id&&(nb.name=rb.id);this.worker=new Worker(this.Rsd,nb)}catch(zb){throw null===(Tb=this.worker)||void 0===Tb?void 0:Tb.terminate(),this.sUi(),zb;}}qb.prototype.sUi=function(){void 0!==this.Rsd&&(URL.revokeObjectURL(this.Rsd),this.Rsd=void 0)};qb.prototype.E0e=function(rb,nb){var Tb=this,Zb=rb.port,Hb=rb.options,Sa={type:"Thread",hLb:"Outside",id:Hb.id},ua=this.worker;rb=new Promise(function(Fa,Pa){Tb.m_b={resolve:Fa,reject:Pa};Fa={config:E(),port:Zb,
options:Hb,script:Tb.script,args:Tb.args,featureGateDictionary:Object(wa.getFeatureGateDictionary)(),XEo:Object(wa.getChangeGateDictionary)()};ua.postMessage(Fa,Object(ba.__spreadArray)([Zb],Tb.transferables,!0));ua.onerror=function(Ea){Ea.preventDefault();if(h(Ea.error))if(a(Ea.error))var lb=Ea.error;else lb={gZ:"UnhandledError",eD:Sa,error:Ea.error},lb=new qa("".concat("worker.onerror"," received an unhandled error"),lb);else null==Ea.message?(lb={gZ:"UnhandledError",eD:Sa},lb=new qa("".concat("worker.onerror",
" received a non-error (worker script fetch probably failed)"),lb)):(lb={gZ:"UnhandledError",eD:Sa},Ea="".concat(Ea.message," at ").concat(Ea.filename,":").concat(Ea.lineno,":").concat(Ea.colno),lb=new qa("".concat("worker.onerror"," received an unhandled error: ").concat(Ea),lb));Tb.m_b?Tb.m_b.reject(lb):K(lb)};ua.onmessage=function(Ea){var lb,zb;Ea=Ea.data;switch(Ea.kind){case 0:return nb.Sof=Ea.jx,void 0===Ea.error?null===(lb=Tb.m_b)||void 0===lb?void 0:lb.resolve():null===(zb=Tb.m_b)||void 0===
zb?void 0:zb.reject(x(Ea.error));case 1:return K(x(Ea.error));case 2:return G(Ea.stats)}}});return P(rb,function(){return void(Tb.m_b=void 0)})};qb.prototype.terminate=function(){var rb;if(this.worker){var nb=this.worker;this.worker=void 0;null===(rb=this.m_b)||void 0===rb?void 0:rb.resolve();nb.terminate();this.sUi()}};return qb}(),Xa="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};c.d(O,"WorkerError",
function(){return qa});c.d(O,"isThreadingSupported",function(){return A});c.d(O,"setConfig",function(){return H});c.d(O,"dispatchWorkerError",function(){return K});c.d(O,"paramInsideDef",function(){return e});c.d(O,"Endpoint",function(){return fb});c.d(O,"createWorker",function(){return Ga});c.d(O,"importScriptsWithRetry",function(){return Oa});c.d(O,"isWorkerThread",function(){return Za});c.d(O,"workerName",function(){return ja})},923:function(C,O,c){function l(){return"undefined"===typeof __get_feature_gate_dictionary_variable?
h:__get_feature_gate_dictionary_variable()}function e(m,v){var u;return null!==(u=l()[m])&&void 0!==u?u:v}Object.defineProperty(O,"__esModule",{value:!0});O.BYf=O.getIntFeatureGate=O.yWh=O.getBooleanFeatureGate=O.getStringFeatureGate=O.PRh=void 0;var a=c(1009),h={};O.PRh=l;O.getStringFeatureGate=e;O.getBooleanFeatureGate=function(m,v){var u;m=null===(u=e(m))||void 0===u?void 0:u.trim().toLowerCase();return"true"===m?!0:"false"===m?!1:v};O.yWh=function(m,v){var u;m=null===(u=e(m))||void 0===u?void 0:
u.trim().toLowerCase();if(void 0===m)return v;if("infinity"===m||"+infinity"===m)return Infinity;if("-infinity"===m)return-Infinity;u=parseFloat(m);return isNaN(u)?v:u};O.getIntFeatureGate=function(m,v){var u;m=null===(u=e(m))||void 0===u?void 0:u.trim();if(void 0===m)return v;u=parseInt(m,10);return isNaN(u)?v:u};O.BYf=function(m){var v=a.globalThis.Xvj;a.globalThis.Xvj=m;return v}},924:function(C,O,c){function l(){return"undefined"===typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}
Object.defineProperty(O,"__esModule",{value:!0});O.hYf=O.isChangeGateEnabled=O.NOh=void 0;var e=c(1009);O.NOh=l;O.isChangeGateEnabled=function(a){var h;return null!==(h=l()[a])&&void 0!==h?h:!0};O.hYf=function(a){var h=e.globalThis.Wvj;e.globalThis.Wvj=a;return h}},933:function(C,O,c){c.d(O,"a",function(){return l});C=c(0);class l{constructor(){this.method=this.api=0}}Object(C.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16817908/wdjs/WordEditorDS.box4.dll1.js.map